new function(){xui.builtinFontIcon={"xui-icon-xui":"&#xe6a7;","xui-icon-placeholder":"&#xe668;","xui-icon-empty":"&#xe668;","xui-icon-loading":"&#xe678;","xui-icon-star":"&#xe69c;","xui-icon-smill":"&#xe69a;","xui-icon-trash":"&#xe6a1;","xui-icon-error":"&#xe666;","xui-icon-back":"&#xe64e;","xui-icon-bold":"&#xe650;","xui-icon-bgcolor":"&#xe64f;","xui-icon-breaklink":"&#xe652;","xui-icon-clock":"&#xe657;","xui-icon-circle":"&#xe651;","xui-icon-bigup":"&#xe658;","xui-icon-code":"&#xe659;","xui-icon-dialog":"&#xe65a;","xui-icon-bullet":"&#xe65b;","xui-icon-date":"&#xe65c;","xui-icon-dragadd":"&#xe661;","xui-icon-dragmove":"&#xe662;","xui-icon-dragcopy":"&#xe663;","xui-icon-dropdown":"&#xe664;","xui-icon-dragstop":"&#xe665;","xui-icon-file":"&#xe667;","xui-icon-file-expand":"&#xe669;","xui-icon-file-fold":"&#xe66a;","xui-icon-filter":"&#xe66b;","xui-icon-font":"&#xe66c;","xui-icon-forecolor":"&#xe66e;","xui-icon-formatbrush":"&#xe66f;","xui-icon-formatclear":"&#xe670;","xui-icon-indent":"&#xe671;","xui-icon-html":"&#xe672;","xui-icon-italic":"&#xe673;","xui-icon-link":"&#xe675;","xui-icon-inserthr":"&#xe676;","xui-icon-menu":"&#xe677;","xui-icon-minus":"&#xe679;","xui-icon-menu-checked":"&#xe67a;","xui-icon-mobile":"&#xe67b;","xui-icon-mouse":"&#xe67c;","xui-icon-outdent":"&#xe689;","xui-icon-picture":"&#xe68a;","xui-icon-print":"&#xe68c;","xui-icon-numbers":"&#xe68d;","xui-icon-right":"&#xe68e;","xui-icon-search":"&#xe68f;","xui-icon-question":"&#xe690;","xui-icon-remove":"&#xe693;","xui-icon-sort":"&#xe699;","xui-icon-sort-checked":"&#xe69b;","xui-icon-strikethrough":"&#xe69d;","xui-icon-sub":"&#xe69e;","xui-icon-super":"&#xe69f;","xui-icon-transparent":"&#xe6a0;","xui-icon-triangle-down":"&#xe6a2;","xui-icon-triangle-left":"&#xe6a3;","xui-icon-triangle-right":"&#xe6a4;","xui-icon-triangle-up":"&#xe6a5;","xui-icon-undo":"&#xe6a6;","xui-icon-redo":"&#xe691;","xui-icon-upload":"&#xe6a8;","xui-icon-zoomin":"&#xe6a9;","xui-icon-zoomout":"&#xe6ac;","xui-icon-underline":"&#xe6aa;","xui-load-error":"&#xe6ab;","xui-refresh":"&#xe6ae;","xui-uicmd-arrowdrop":"&#xe6af;","xui-uicmd-check":"&#xe6b0;","xui-uicmd-check-checked":"&#xe6b1;","xui-uicmd-add":"&#xe6ad;","xui-uicmd-close":"&#xe6b2;","xui-uicmd-cmdbox":"&#xe6b3;","xui-uicmd-date":"&#xe6b4;","xui-uicmd-color":"&#xe6b5;","xui-uicmd-delete":"&#xe6b6;","xui-uicmd-dotted":"&#xe6b7;","xui-uicmd-datetime":"&#xe6b8;","xui-uicmd-helpinput":"&#xe6b9;","xui-uicmd-getter":"&#xe6ba;","xui-uicmd-file":"&#xe6bb;","xui-uicmd-info":"&#xe6bc;","xui-uicmd-land":"&#xe6bd;","xui-uicmd-max":"&#xe6be;","xui-uicmd-min":"&#xe6bf;","xui-uicmd-location":"&#xe6c0;","xui-uicmd-opt":"&#xe6c1;","xui-uicmd-pop":"&#xe6c2;","xui-uicmd-pin":"&#xe6c3;","xui-uicmd-radio":"&#xe6c4;","xui-uicmd-radio-checked":"&#xe6c5;","xui-uicmd-popbox":"&#xe6c6;","xui-uicmd-refresh":"&#xe6c7;","xui-uicmd-restore":"&#xe6c8;","xui-uicmd-remove":"&#xe6c9;","xui-uicmd-time":"&#xe6ca;","xui-uicmd-select":"&#xe6cb;","xui-uicmd-save":"&#xe6cc;","xui-uicmd-toggle":"&#xe6cd;","xui-uicmd-toggle-checked":"&#xe6ce;","xui-icon-alignleft":"&#xe6d2;","xui-icon-aligncenter":"&#xe6d0;","xui-icon-alignjustify":"&#xe6d1;","xui-icon-alignright":"&#xe6cf;","xui-icon-singleleft":"&#xe694;","xui-icon-singleright":"&#xe695;","xui-icon-singleup":"&#xe696;","xui-icon-singledown":"&#xe692;","xui-icon-smalldown":"&#xe697;","xui-icon-smallup":"&#xe698;","xui-icon-arrowleft":"&#xe64c;","xui-icon-arrowright":"&#xe64b;","xui-icon-arrowtop":"&#xe64d;","xui-icon-arrowbottom":"&#xe6d3;","xui-icon-circleleft":"&#xe654;","xui-icon-circleright":"&#xe655;","xui-icon-circleup":"&#xe656;","xui-icon-circledown":"&#xe653;","xui-icon-doubleleft":"&#xe65e;","xui-icon-doubleright":"&#xe660;","xui-icon-doubleup":"&#xe65f;","xui-icon-doubledown":"&#xe65d;","xui-icon-first":"&#xe66d;","xui-icon-prev":"&#xe68b;","xui-icon-next":"&#xe67d;","xui-icon-last":"&#xe674;","xui-icon-number":"&#xe67e;","xui-icon-number0":"&#xe680;","xui-icon-number1":"&#xe67f;","xui-icon-number2":"&#xe681;","xui-icon-number3":"&#xe682;","xui-icon-number4":"&#xe683;","xui-icon-number5":"&#xe686;","xui-icon-number6":"&#xe687;","xui-icon-number7":"&#xe684;","xui-icon-number8":"&#xe685;","xui-icon-number9":"&#xe688;"};if(xui.browser.ie678){xui.__iefix2=xui.builtinFontIcon}};xui.Class("xui.UIProfile","xui.Profile",{Instance:{renderId:null,_render:function(){var j=this,g=j.boxing(),n,a=xui.$cache.profileMap;if(j.beforeRender&&false===g.beforeRender(j)){return}if(!j.renderId){var o=xui.Dom.byId(j.$domId);if(!o){return}if(j.domId!=j.$domId){o.id=j.domId}a[j.domId]=a[j.$domId]=j;if(!o.$xid){xui.UI.$addEventsHandler(j,o,true)}if(j._elset){for(var e=1,d=j._elset.length;e<d;e++){xui.UI.$addEventsHandler(j,j._elset[e].node,true)}}if(xui.browser.ie&&xui.browser.ver<10&&"selectable" in j.properties){xui.setNodeData(o,"_onxuisel",j.properties.selectable?"true":"false")}j.rendered=j.renderId=o.$xid;o=null}if(j.CA&&!xui.isEmpty(j.CA)){g.setCustomAttr(j.CA)}if(j.CS&&!xui.isEmpty(j.CS)){g.setCustomStyle(j.CS)}if(xui.browser.isTouch){if((n=j.box.$Behaviors.DroppableKeys)&&n.length){xui.arr.each(n,function(l){g.getSubNode(l,true).each(function(w){var u=j.box.getDropKeys(j,w.$xid);if(u){var x=xui.$cache.droppable,r=u.split(/[^\w-]+/);for(var s=0,q=r.length;s<q;s++){x[r[s]]=x[r[s]]||[];x[r[s]].push(w.$xid)}}})})}}if(xui.browser.fakeTouch||(xui.browser.isTouch&&(xui.browser.isAndroid||xui.browser.isBB))){var b={auto:1,scroll:1},c;xui.each(j.box.$Appearances,function(q,l){c="";if(b[q.overflow]){c="xy"}else{if(b[q["overflow-x"]]){c+="x"}if(b[q["overflow-y"]]){c+="y"}}if(c){j.getSubNode(l,true).$touchscroll(c)}});if("overflow" in j.properties){if(xui.browser.fakeTouch){xui.asyRun(function(){var q="",l=j.getRoot();if(l&&!l.isEmpty()){if(l.isScrollBarShowed("x")){q+="x"}if(l.isScrollBarShowed("y")){q+="y"}if(q){l.$touchscroll(q)}}})}else{if(b[j.properties.overflow]){g.setOverflow(j.properties.overflow,true)}}}}if(n=j.RenderTrigger){for(var e=0,d=n.length;e<d;e++){n[e].call(j)}delete j.RenderTrigger}if(j.onRender){g.onRender(j)}xui.tryF(j.$onrender,[],j);if(arguments[0]===true&&(n=j.LayoutTrigger)){for(var e=0,d=n.length;e<d;e++){n[e].call(j)}if(j.onLayout){g.onLayout(j)}}if(!j.properties.lazyAppend){if(j.children){for(var e=0,m;m=j.children[e++];){if(m[0]._render){m[0]._render(true)}}}if(j.$attached){for(var e=0,m;m=j.$attached[e++];){if(m._render){m._render(true)}if((n=m._render_holder||m._inline_holder)&&n.$afterAttached){xui.tryF(n.$afterAttached,[m],n)}else{xui.tryF(j.$afterAttached,[m],j)}}delete j.$attached}if(j.exchildren){var f=[];for(var e=0,m;m=j.exchildren[e++];){g.append(m[0],m[1])}delete j.exchildren}if(j.exmodules){var f=[];for(var e=0,m;m=j.exmodules[e++];){m[0].show(null,g,m[1],false)}delete j.exmodules}}j.renderCompleted=1},__gc:function(a,f){var e=this,d,b=xui.toArr(arguments);if(e.destroyed){return}if(e.$beforeDestroy){xui.each(e.$beforeDestroy,function(j){xui.tryF(j,b,e)});xui.breakO(e.$beforeDestroy,2)}xui.tryF(e.$ondestory,b,e);if(e.onDestroy){e.boxing().onDestroy()}if(e.destroyTrigger){e.destroyTrigger()}if(!e.serialId){return}if(d=e._$composed){xui.each(d,function(j){j.__gc(a,f)})}e.clearCache();if(!e.$noReclaim){d=xui.$cache.reclaimId;(d[e.key]||(d[e.key]=[])).push(e.serialId)}else{delete e.$noReclaim}delete xui.$cache.profileMap[e.domId];delete xui.$cache.profileMap[e.$domId];var g;if(e.alias&&e.host&&(g=e.host[e.alias])&&(g=g._nodes)&&(g.length===0||g.length===1&&g[0]==e)){e.host[e.alias]=null;if(!(e.host===window&&xui.browser.ie&&xui.browser.ver<=8)){delete e.host[e.alias]}}e.unLinkAll();if(e.LayoutTrigger){e.LayoutTrigger.length=0}if(e.RenderTrigger){e.RenderTrigger.length=0}if((d=e.children).length){d=xui.copy(d);for(var c=0;c<d.length;c++){d[c][0].__gc(a,f);d[c].length=0}d.length=0}e.destroyed=true;if(e.$afterDestroy){xui.each(e.$afterDestroy,function(j){xui.tryF(j,b,e)});xui.breakO(e.$afterDestroy,2)}if(e.afterDestroy){e.boxing().afterDestroy(e)}xui.breakO([e.properties,e.events,e.CF,e.CB,e.CC,e.CA,e.CS,e],2);e.destroyed=true},linkParent:function(b,d,a){var c=this;c.unlinkParent();if(!c.destroyed){c.parent=b;c.childrenId=d;c.link(b.children,"$parent",[c,d],a)}return c},unlinkParent:function(){var a=this;delete a.parent;delete a.childrenId;a.unLink("$parent");return a},getRootNode:function(){return xui.getNodeData(this.renderId,"element")},getRoot:function(){var a=this;return a.renderId?(a["*"]||(a["*"]=xui([a.renderId],false))):xui([],false)},getAllNodes:function(){return this.getRoot().query().merge(this.getRoot())},getContainer:function(a){if(a!==true&&(a=typeof a=="string"?a:null)){a=this.getSubIdByItemId(a)}return this.box._CONTAINERKEY?this.getSubNodes(this.box._CONTAINERKEY,a):this.keys.PANEL?this.getSubNodes(this.keys.PANEL,a):this.getRoot()},getEmSize:function(d){var c=this,a=c.getRoot(),b=a.get(0);return(!d&&c._nodeEmSize)||(b&&(c._nodeEmSize=a._getEmSize()))||xui.CSS._getDftEmSize()},adjustSize:function(c,d,a){var g=this,b=g.getRootNode();if(b&&(c||(b=b.style))){var e=function(){xui.UI.$tryResize(g,c?g.properties.width:b.width,c?g.properties.height:b.height,true,a)};if(d){xui.asyRun(e)}e()}},$px:function(d,c,a){var b=this;return xui.CSS.$px(d,c||function(){return b.getEmSize()},a)},$em:function(d,c,a){var b=this;return xui.CSS.$em(d,c||function(){return b.getEmSize()},a)},$px2em:function(d,c,a){var b=this;return xui.CSS.$px2em(d,c||function(){return b.getEmSize()},a)},$em2px:function(d,c,a){var b=this;return xui.CSS.$em2px(d,c||function(){return b.getEmSize()},a)},$forceu:function(e,a,d,b){var c=this;return xui.CSS.$forceu(e,a,d||function(){return c.getEmSize()},b)},$addpx:function(d,c,f){var e=this;return xui.CSS.$addpx(d,c,f||function(){return e.getEmSize()})},$isEm:function(a){return xui.CSS.$isEm(a)},$isPx:function(a){return xui.CSS.$isPx(a)},$picku:function(a){return xui.CSS.$picku(a)},$addu:function(a){return xui.CSS.$addu(a)},_cacheR1:/^\w[\w_-]*$/,setDomId:function(d){var a=this,b=xui.$cache.profileMap;if(typeof d=="string"&&(a._cacheR1.test(d)||d==a.$domId)&&!xui.Dom.byId(d)){if(a.domId!=a.$domId){delete b[a.domId]}a.domId=d;if(a.renderId){a.getRootNode().id=d}if(b[a.$domId]){b[d]=a}}return a},getDomId:function(){return this.domId},clearCache:function(){var c=this,b=c.$_egetter;for(var a in b){b[a].length=0;delete b[a]}b=c.$_domid;for(var a in b){b[a].__gc(true,true);delete b[a]}delete c["*"];return c},_getEV:function(m,c,b){var r=this,n=c+"+"+b,j=r.$_egetter||(r.$_egetter={}),a;if(j[n]){Array.prototype.push.apply(m,j[n]);return}else{a=j[n]=[]}var e=xui.$cache.profileMap,q,o;if((q=e[c])&&(q=q.events)&&(q=q[b])){for(var f=0,d=q.length;f<d;f++){if(typeof q[q[f]]=="function"){a.push(m[m.length]=q[q[f]])}}}o=c.split(":")[0].split("-")[1];if(typeof(((q=r._CB)&&(o?(q=q[o]):1))&&(q=q[b]))=="function"){a.push(m[m.length]=q)}else{if(typeof(((q=r.CB)&&(o?(q=q[o]):1))&&(q=q[b]))=="function"){a.push(m[m.length]=q)}else{if(typeof(((q=r.behavior)&&(o?(q=q[o]):1))&&(q=q[b]))=="function"){a.push(m[m.length]=q)}}}},_cacheR2:/<!--\x03([^>^\s]*)\x04-->/g,toHtml:function(f){var E=this,d=E.properties,A=E.box,s={},B,x="xui.UIProfile",w="xui.Module",e,r,n,g,j,D,C,q;if(E.destroyed){return""}if(A["xui.svg"]){A._RenderSVG(E);return""}else{q=A._prepareData(E);if(A._dynamicTemplate){A._dynamicTemplate(E)}B=A._build(E,q);if((!d.lazyAppend||f)&&(j=E.children)){for(r=0,n=j.length;r<n;r++){g=j[r];if(g&&g[0]){if(g[0][w]){var u=new xui.UI.MoudluePlaceHolder({host:g[0].host,alias:g[0].alias});u.get(0)._module=g[0];g[0]=u.get(0)}if(g[0][x]){e=g[1]||"";D=s[e]||(s[e]=[]);D[D.length]=g[0].toHtml(f)}}}}return B.replace(E._cacheR2,function(l,c){return s[c]?s[c].join(""):""})}},_buildItems:function(c,b,f){var d=this,e=d.box,g=e._rpt(d,xui.UI.$doTemplate(d,xui.get(xui.$cache.template,[e.KEY,d._hash]),b,c)),a=xui.UI.$toDom(d,g.replace(d._cacheR2,""),f);if(d.CA&&!xui.isEmpty(d.CA)){d.boxing().setCustomAttr(d.CA,undefined,a)}if(d.CS&&!xui.isEmpty(d.CS)){d.boxing().setCustomStyle(d.CS,undefined,a)}return a},serialize:function(s,x,f){var u,j,n={},w=this,e=(u=w.box._beforeSerialized)?u(w):w,a={alias:e.alias,key:e.key,host:e.host},g=e.moduleClass+"["+e.moduleXid+"]";if(a.host===w){delete a.host}else{if(e.host&&!x){if(s!==false){a.host="@this"}else{delete a.host}}}if(typeof e.theme=="string"){a.theme=e.theme}if(e.$domId!=e.domId){a.domId=e.domId}var q={},d=e.box.$DataStruct,b=xui.absObj.$specialChars;xui.merge(q,e.properties,function(m,c){return(c in d)&&d[c]!==m&&!b[c.charAt(0)]});if(!xui.isEmpty(q)){a.properties=q}if(!xui.isEmpty(u=this.getEvents())){a.events=u}var l=e.box.$EventHandlers;xui.filter(a.events,function(m,c){return m!=l[c]});if(xui.isEmpty(a.events)){delete a.events}if(!xui.isEmpty(e.CB)){a.CB=xui.copy(e.CB)}if(!xui.isEmpty(e.CC)){a.CC=xui.copy(e.CC)}if(!xui.isEmpty(e.CF)){a.CF=xui.copy(e.CF)}if(!xui.isEmpty(e.CS)){a.CS=xui.clone(e.CS,function(m,c){return !((c+"").charAt(0)=="$"&&!m)})}if(!xui.isEmpty(e.CA)){a.CA=xui.copy(e.CA)}if(typeof e.theme=="string"){a.theme=e.theme}if(false!==f&&e.children&&e.children.length){if(e.box.KEY!="xui.UI.SVGPaper"){xui.arr.stableSort(e.children,function(c,m){c=(c[0].properties.tabindex||0);m=(m[0].properties.tabindex||0);return c>m?1:c==m?0:-1})}u=a.children=[];xui.arr.each(e.children,function(m,c,r,o){c=m[0];if(c.moduleClass&&c.moduleXid&&(r=xui.SC.get(c.moduleClass))&&(r=r.getInstance(c.moduleXid))&&r["xui.Module"]){o=c.moduleClass+"["+c.moduleXid+"]";if(o!==g){if(n[o]){return}else{n[o]=1;c=r}}}j=[c.serialize(false,x)];if(m[1]){j[1]=m[1]}u[u.length]=j})}if(false!==f&&e.exchildren&&e.exchildren.length){a.exchildren=e.exchildren}n=null;return s===false?a:xui.serialize(a)},_applySetAction:function(b,e,f,d,a,c){if(this.renderId){return b.call(this,e,f,d,a,c)}},getKey:function(c,b){var a;if(c.charAt(0)=="!"){c=xui.use(c).id()}if(c.indexOf(":")==-1){c=(a=xui.$cache.profileMap[c])&&(a.$domId)}if(c){c=c.split(":")[0];if(b){c=c.split("-")[1]||"KEY"}}return c||""},getSubId:function(b){var a;if(b.charAt(0)=="!"){b=xui.use(b).id()}if(b.indexOf(":")==-1){b=(a=xui.$cache.profileMap[b])&&(a.$domId)}return b?b.split(":")[2]:""},pickSubId:function(b){var a=this,c,d=a.cache_subid||(a.cache_subid={});if((d[b]||(d[b]=[]))[0]){return d[b].shift()}d=a.subId||(a.subId={});c=(d[b]||(d[b]=new xui.id)).next();return c},reclaimSubId:function(c,a){var b=this.cache_subid||(this.cache_subid={});(b[a]||(b[a]=[])).push(c)},_cacheR3:/\./g,_cacheH1:{},getClass:function(c,a){c=this.keys[c]||c;var b=this,d=c+":"+(a||"");return b._cacheH1[d]||(b._cacheH1[d]=c.replace(b._cacheR3,"-").toLowerCase().replace("xui-ui","xui")+(a||""))},_getSubNodeId:function(d,c,b){var a=this.$domId.split(":");a[0]=d;a[2]=xui.isSet(c)?(c+""):"";if(b){a[2]+="_"+b}d=a.join(":");return d==this.$domId?xui.$cache.profileMap[d].domId:d},getSubNode:function(c,b,a){var e=this;if(!e.renderId){return xui()}var c=e.keys[c]||c,f,d=e.$_domid||(e.$_domid={});if(b===true){if(c==e.keys.KEY){f=xui([e.renderId])}if(!f||!f.get(0)){f=xui([e.renderId]).query("*","id",new RegExp("^"+c+":"+e.serialId+(a?("_"+a):"")))}}else{if(!xui.isSet(b)&&d[c]&&d[c]._nodes.length==1){return d[c]}f=xui(e._getSubNodeId(c,b,a));if(f._nodes.length==1&&!xui.isSet(b)){d[c]=f}}return f},getSubNodes:function(f,b,s){var l=this,m=[],r=!xui.isArr(f),n=!xui.isArr(b),m,c,q,g=Array.prototype.push;if(b===true||xui.isNull(b)){if(!r){m=[];for(var e=0;c=f[e++];){m.push(l.keys[c]||c)}f="("+m.join("|")+")"}g.apply(m,l.getSubNode(f,true,s).get())}else{if(r){if(n){g.apply(m,l.getSubNode(f,b,s).get())}else{for(var d=0;q=b[d++];){g.apply(m,l.getSubNode(f,q,s).get())}}}else{for(var e=0;c=f[e++];){if(n){g.apply(m,l.getSubNode(c,b,s).get())}else{for(var d=0;q=b[d++];){g.apply(m,l.getSubNode(c,q,s).get())}}}}}return xui(m)},getSubNodeByItemId:function(b,c,a){return(c=this.getSubIdByItemId(c))?this.getSubNode(b,c,a):xui()},getItemByItemId:function(c){var b=this,a;if(xui.isNumb(c)){c=xui.get(b.properties.items,[c,"id"])}if((a=b.ItemIdMapSubSerialId)&&(a=a[c])){return b.SubSerialIdMapItem[a]}a=b.queryItems(b.properties.items,function(e,d){return e.id==c},1,1);return a&&a[0]},getItemByItemCaption:function(a){var c=this,b;if(xui.isNumb(a)){a=xui.get(c.properties.items,[a,"caption"])}if((b=c.ItemIdMapSubSerialId)&&(b=b[a])){return c.SubSerialIdMapItem[b]}b=c.queryItems(c.properties.items,function(e,d){return e.caption==a},1,1);return b&&b[0]},getSubIdByItemId:function(c){var b=this,a;if(xui.isNumb(c)){c=xui.get(b.properties.items,[c,"id"])}return(a=this.ItemIdMapSubSerialId)&&a[c]},getItemByDom:function(a){return this.SubSerialIdMapItem&&this.SubSerialIdMapItem[this.getSubId(typeof a=="string"?a.charAt(0)=="!"?((a=xui.use(a).get(0))&&a.id):a:a.id)]},getItemIdByDom:function(b){var a;return(a=this.getItemByDom(b))&&a.id},queryItems:function(d,c,b,l,a){var g=[],e=arguments.callee,j=e.f||(e.f=function(o,n,m,s,f,q){xui.arr.each(o,function(u,r){if(n===true||n.call(null,u,r,o)){q.push(f?[u,r,o]:u);if(s){return false}}if(m&&u.sub&&u.sub.length){j(u.sub,n,m,s,f,q)}})});j(d,c,b,l,a,g);return g}},Static:{getFromDom:function(a){if((a=(a&&a.KEY=="xui.Dom")?a.get(0).id:typeof a=="string"?a.charAt(0)=="!"?((a=xui.use(a).get(0))&&a.id):a:(a&&a.id))&&(a=xui.Event._getProfile(a))&&a["xui.UIProfile"]){return a}}}});xui.Class("xui.UI","xui.absObj",{Before:function(b,a,c){xui.absBox.$type[b.replace("xui.UI.","").replace("xui.","")]=xui.absBox.$type[b]=b;return true},After:function(){var C=this,o=arguments.callee,A,B,a,x,n,g,f,l,r,s,q,m;xui.absObj.After.apply(this,arguments);if(C.Behaviors&&C.Behaviors.PanelKeys&&C.$DataModel&&C.$DataModel.dataField){delete C.$DataModel.dataField;delete C.$DataStruct.dataField;delete C.prototype.setDataField;delete C.prototype.getDataField}C._ctrlId=new xui.id();C._idCache=[];C.$cssKeys={};B=C.$Keys;B.KEY=B.$key=C.KEY;C.addTemplateKeys(xui.toArr(B,true));s="$Behaviors";a={};if((B=C.$parent)&&(l=B.length)){while(l--){q=B[l][s];for(g in q){if(typeof q[g]=="object"){if(xui.isArr(q[g])){x=a[g]||(a[g]=[]);x.push.apply(x,q[g])}else{x=a[g]||(a[g]={});xui.merge(x,q[g])}}else{a[g]=q[g]}}}}C[s]=a;s="$Templates";a={};if((B=C.$parent)&&(l=B[0])){for(g in l[s]){if(g.charAt(0)!="$"){a[g]=l[s][g]}}}C[s]=xui.clone(a);s="$Appearances";a={};if((B=C.$parent)&&(l=B.length)){while(l--){q=B[l];for(g in q[s]){B=q[s][g];x=a[g]||(a[g]={});xui.merge(x,B)}}}C[s]=a;C.setTemplate(C.Templates);delete C.Templates;C.setBehavior(C.Behaviors||{});delete C.Behaviors;C.setAppearance(C.Appearances);delete C.Appearances;if(B=C.PublicAppearance){xui.UI.$cache_css_before+=C.buildCSSText(B);delete C.PublicAppearance}},Instance:{animate:function(f,g){var b=this.get(0),l,c=b.getRootNode(),d=xui.getNodeData(c,"_inthread"),e=xui.getNodeData(c,"_animationreset"),l;if(d&&xui.Thread.isAlive(d)){xui.Thread.abort(d,"force");xui.setNodeData(c,"_inthread",null)}if(typeof e=="function"){e();xui.setNodeData(c,"_animationreset",null)}if(f&&(l=xui.AnimBinder.getFromName(f===true?"blinkAlert":f))){return l.apply(c,g)}else{if(!f){f="blinkAlert"}var j=(xui.isHash(f)&&f.endpoints)?f:xui.Dom.$preDefinedAnims[f];if(j&&j.endpoints){var a;if(xui.isFun(g)){if(xui.isFun(j.onEnd)){a=function(){j.onEnd.apply(this,arguments);g.apply(this,arguments)}}else{a=g}}else{if(xui.isFun(j.onEnd)){a=j.onEnd}}return b.getRoot().animate(j.endpoints,j.onStart,a,j.duration||200,null,j.type||"linear",null,j.unit,j.restore,j.times).start()}}},hoverPop:function(e,j,g,m,l,f){var d=this.get(0),a=d.boxing(),c;if(!d.box.$EventHandlers.beforeHoverEffect){a.getRoot().hoverPop(e,j,g,m,l,f);return this}e=xui(e);c=xui.UIProfile.getFromDom(e.id());if(c&&c.key==="xui.UI.PopMenu"){c=c.boxing()}else{c=null}if(!xui.isDefined(j)){j="outer"}var b=f||(a.getRoot().xid()+":"+e.xid());a.each(function(n){n.$beforeHover=j===null?null:function(q,o,r,s,w){if(r.$force){return}if(w=="mouseover"){xui.resetRun(b,null);var u=xui.getData([b,"$ui.hover.pop"])&&xui.getNodeData(e.get(0)||"empty","$ui.hover.parent")==s;if(!u){xui.setData([b,"$ui.hover.pop"],{item:o});xui.setNodeData(e.get(0)||"empty","$ui.hover.parent",s);if(!g||false!==g(q,e,r,s,o)){if(c){c.pop(s,j,l)}else{e.popToTop(s,j,l)}e.onMouseover(function(){xui(s).onMouseover(true)},"hoverPop");e.onMouseout(function(){xui(s).onMouseout(true)},"hoverPop")}}}else{xui.resetRun(b,function(){xui.setData([b,"$ui.hover.pop"]);xui.setNodeData(e.get(0)||"empty","$ui.hover.parent",0);if(!m||false!==m(q,e,r,s,"host",o)){if(c){c.hide()}else{e.hide()}e.onMouseover(null,"hoverPop").onMouseout(null,"hoverPop")}})}}});if(e){e.onMouseover(j===null?null:function(n){if(n.$force){return}if(!xui.getData([b,"$ui.hover.pop"])){return}xui.resetRun(b,null)},"hoverPop");e.onMouseout(j===null?null:function(n,o,q){if(o.$force){return}if(!xui.getData([b,"$ui.hover.pop"])){return}xui.resetRun(b,function(){xui.setData([b,"$ui.hover.pop"]);xui.setNodeData(e.get(0)||"empty","$ui.hover.parent",0);var r=xui.getData([b,"$ui.hover.pop"]);if(!m||false!==m(n,e,o,q,"pop",r&&r.item)){if(c){c.hide()}else{e.hide()}e.onMouseover(null,"hoverPop").onMouseout(null,"hoverPop")}})},"hoverPop");e.css("display","none")}return this},setTheme:function(c){if(typeof c!="string"||!c){c=null}var b,a=[];this.each(function(d){if(c!=d.theme){if(c===null){delete d.theme}else{d.theme=c}a.push(d)}});xui.UI.pack(a,false).refresh();return this},getTheme:function(){return this.get(0)&&this.get(0).theme},getModule:function(b){var a=this.get(0);if(a){return a.getModule(b)}},destroy:function(a,c){var b=this;this.each(function(j,f){if(j.destroyed){return}var e=function(){if(j.beforeDestroy&&false===j.boxing().beforeDestroy(a,c)){return}if(j.$beforeDestroy){xui.each(j.$beforeDestroy,function(l){xui.tryF(l,[a,c],j)});xui.breakO(j.$beforeDestroy,2)}if(j.renderId){j.getRoot().remove(true,c)}else{j.__gc(a,c)}xui.arr.removeFrom(b._nodes,f);if(j.$afterDestroy){xui.each(j.$afterDestroy,function(l){xui.tryF(l,[a,c],j)});xui.breakO(j.$afterDestroy,2)}};var g=j.properties,d=a?null:xui.Dom._getEffects(g.hideEffects,0);if(d){xui.Dom._vAnimate(j.getRoot(),false,e)}else{e()}},null,true)},isDestroyed:function(){return !!(this.get(0)?this.get(0).destroyed:1)},_toDomElems:function(){var a=[];xui.arr.each(this._nodes,function(b){if(!b.renderId){a.push(b)}});if(a.length){xui.UI.pack(a,false).render()}a.length=0;xui.arr.each(this._nodes,function(b){a.push(b.renderId)});return a},_ini:function(g,b,q,B,a,j,l,f,m){var u=this,A=u.constructor,d,o="default",e,E=xui.UI.__resetDftProp,D=A.__resetDftProp,C=A.$adjustProp,s=A.$DataStruct,r,x;if(g&&g["xui.Profile"]){d=g;r=d.alias||A.pickAlias();xui.UIProfile.apply(d,[q,u.$key,r,A,null,b])}else{if(g&&g.key&&xui.absBox.$type[g.key]){e=g;g=null;r=e.alias||A.pickAlias()}else{r=A.pickAlias()}d=new xui.UIProfile(q,u.$key,r,A,g,b,e)}for(var w in s){if(!(w in d.properties)){x=D&&(w in D)?D[w]:E&&(w in E)?E[w]:s[w];d.properties[w]=typeof x=="object"?xui.clone(x,true):x}}if(typeof(C)=="function"){C(d)}d.keys=A.$Keys;d.CS=a?xui.copy(a):(d.CS||{});d.CB=l?xui.copy(l):(d.CB||{});d.CC=j?xui.copy(j):(d.CC||{});d.CF=f?xui.copy(f):(d.CF||{});d.CA=m?xui.copy(m):(d.CA||{});if(typeof B=="string"){d.theme=B}d.template=A.getTemplate();d.behavior=A.$Behaviors;if(!d.serialId){d.serialId=A._pickSerialId()}d.$domId=d.key+":"+d.serialId+":";d.domId=d.domId||d.$domId;d.RenderTrigger=xui.copy(A.$RenderTrigger);d.LayoutTrigger=xui.copy(A.$LayoutTrigger);d.link(xui.UI._cache,"UI").link(A._cache,"self").link(xui._pool,"xui");x=d.children;d.children=[];if(x&&x.length){for(var w=0,n;n=x[w++];){if(!n[0]["xui.UIProfile"]){n[0]=xui.create(n[0]).get(0)}if(n[0]["xui.UIProfile"]){n[0].linkParent(d,n[1])}else{if(n[0]["xui.Module"]){n[0].getUIComponents().each(function(c){c.linkParent(d,n[1])})}}}}u._nodes.push(d);d.Instace=u;u.n0=d;if(A.$onInited){xui.tryF(A.$onInited,[],d)}return u},busy:function(d,c,b,a,e){c=typeof c=="string"?c:"Loading...";if(d===true){xui.Dom.busy()}return this.each(function(f){xui.resetRun(f.$xid+":busy",function(n,m,l){if(!n.box){return}var r=n.keys,q;m=r[m]||r.BORDER||r.PANEL||r.KEY;var g=n.getSubNode(m,l);if(g.isEmpty()){return}if(!n.$busy||n.$busy.isEmpty()){q=n.$busy=xui.create('<button class="xui-node xui-node-div xuicon xui-icon-loading xui-cover xui-custom" style="position:absolute;text-align:center;left:0;top:0;z-index:10;border:0;padding:0;margin:0;width:100%;height:100%;"><div class="xui-node xui-node-div xui-coverlabel xui-custom"></div></button>')}q=n.$busy;q.first().html(c,false);g.append(q);q.removeClass(/^xui-rand-css-/);q.query("style").remove(false);if(e){var o="xui-rand-css-"+xui.rand();q.addClass(o);xui.CSS._appendSS(q.get(0),"."+o+":before{"+e+"}",o,true)}var j=g.get(0);q._parentOST=j.scrollTop||0;q._parentOSL=j.scrollLeft||0;q._parentOverflow=j.style.overflow||"";q._busyP=g.xid();j.scrollTop=j.scrollLeft=0;j.style.overflow="hidden"},50,[f,b,a])})},free:function(){xui.Dom.free();return this.each(function(b){xui.resetRun(b.$xid+":busy");if(node=b.$busy){var a=xui(node._busyP).get(0);if(a){a.scrollTop=node._parentOST||0;a.scrollLeft=node._parentOSL||0;a.style.overflow=node._parentOverflow||""}node._parentOST=node._parentOSL=node._parentOverflow=node._busyP=null;node.remove();delete b.$busy}})},adjustSize:function(b,c,a){return this.each(function(d){d.adjustSize(b,c,a)})},reLayout:function(a){return this.each(function(c){if(!c.renderId){return}delete c._nodeEmSize;var b=c.properties;if((!c.$noB)&&b.border&&c.boxing()._border){c.boxing()._border(null,false)}c.$forceRelayout=1;if(b.position=="absolute"&&b.dock&&b.dock!="none"){c.boxing().adjustDock(a)}else{if(a){c._resize_h=c._resize_w=-1}xui.UI.$tryResize(c,b.width,b.height,a)}delete c.$forceRelayout})},toHtml:function(c){var b=[];xui.arr.each(this._nodes,function(a){b[b.length]=a.toHtml(c)});return b.join("")},render:function(c){var j=this,g=[],f,e,b,d=j._nodes,q,m=[],r=xui.Dom.byId;xui.UI.$trytoApplyCSS();for(f=0;b=d[f++];){if(!b.renderId&&!xui.Dom.byId(b.domId)&&!xui.Dom.byId(b.$domId)){g[g.length]=b}}if(e=g.length){for(f=0;f<e;f++){if(b=g[f].toHtml()){m[m.length]=b}}if(m.length){xui.UI.$toDom(j.get(0),m.join(""))}}for(f=0;b=d[f++];){b._render(c)}m.length=g.length=0;return j},renderOnto:function(c,j,d){c=xui(c);if(c.isEmpty()){return this}var l=this,g=l.get(0),e=arguments.callee,m=e.paras||(e.paras=function(o){var n=o.cssRegion();n.tabindex=o.attr("tabIndex");if(n.tabindex<=0){delete n.tabindex}n.zIndex=o.css("zIndex");n.position=o.css("position");return n}),a=c.attr("style").replace(/\s*(left|top|width|height|right|bottom|position|z-index)\s*\:\s*[\w-.]+\s*/g,""),f=c.attr("class"),b=c.id();xui.merge(g.properties,m(c),"all");g.properties.dock="none";if(a){l.setCustomStyle("KEY",a)}if(f){l.setCustomClass("KEY",f)}if(b){l.setDomId(b)}if(d||b){l.setHost(j||window,d||b)}l.render(true);c.replace(l.getRoot());return l},setDomId:function(a){this.get(0).setDomId(a);return this},hide:function(a){return this.each(function(d){if(d.renderId){var c=d.properties,b=a?null:xui.Dom._getEffects(c.hideEffects,0);d.getRoot().hide(function(){c.top=c.left=Math.round(parseFloat(xui.Dom.HIDE_VALUE)||0);c.dockIgnore=true},b)}})},popUp:function(g,d,c,a,f){var e=this.get(0),b=e.getRoot();if(b=b.get(0)){xui(b).pop(g,d,c,a,f)}},show:function(c,b,e,d,a){return this.each(function(q){var l=q.properties,j=q.boxing(),f,g=q.getRoot();e=(e||e===0)?(e||0):null;d=(d||d===0)?(d||0):null;if(e!==null){l.left=e}if(d!==null){l.top=d}if(xui.getNodeData(q.renderId,"_xuihide")){f=1;l.dockIgnore=false;g.show(e&&q.$forceu(e),d&&q.$forceu(d),null,a);if(l.position=="absolute"&&l.dock&&l.dock!="none"){xui.UI.$dock(q,false,true)}}else{c=c||q.parent;if(!c&&(!q.renderId||(q.getRootNode().id||"").indexOf(xui.Dom._emptyDivId)===0)){c=xui("body")}}var m=c,r;if(m){if(m["xui.UIProfile"]){r=m.renderId;m=m.boxing()}else{if(m["xui.UI"]){r=(r=m.get(0))&&r.renderId}else{r=(m=xui(m))&&m._nodes[0]}}if(r){m.append(j,b);if(!f){g.show(e&&q.$forceu(e),d&&q.$forceu(d))}}}})},clone:function(){return arguments.callee.upper.apply(this,["domId"])},refresh:function(B){var d,x,D,u,n,l,o,E,r,a,w,G,f,j,g,q,C,m,e,F,A,c,H=this;return H.each(function(L,J){if(!L.renderId){return}m=L.box;var K=L.host,I=L.alias;if(L.host&&L.host["xui.Module"]){L.host.$ignoreAutoDestroy=true}l=L.$xid;o=L.$inDesign;E=L.locked;r=L.serialId;j=L.moduleClass;g=L.moduleXid;a=L._render_conf;w=L._render_holder;G=L._inline_conf;f=L._inline_holder;q=L.$afterRefresh;c=L.$handleCustomVars;if(c){A=c()}if(typeof L.boxing().getUIValue=="function"){F=L.boxing().getUIValue();if((L.boxing().getValue()+" ")==(F+" ")){F=null}}if(D=!!L.parent){u=L.parent.boxing();d=L.childrenId}else{u=L.getRoot().parent()}x=B?xui.Dom.getEmptyDiv(L.$inDesign).get(0):xui.$getGhostDiv();L.boxing().getChildren().reBoxing().each(function(N){x.appendChild(N)});x=null;e=xui.copy(L.children);L.boxing().removeChildren();n=L.serialize(false,true);C=L.$refreshTrigger;var s=xui.create("span");L.getRoot().replace(s);L.$noReclaim=1;var b=L.Instace;L.boxing().destroy(true,true);xui.merge(L,n,"all");delete L.destroyed;L.$xid=l;L.$inDesign=o;L.locked=E;L.$handleCustomVars=c;L.serialId=r;L.moduleClass=j;L.moduleXid=g;if(a){L._render_conf=a}if(w){L._render_holder=w}if(G){L._inline_conf=G}if(f){L._inline_holder=f}if(e){L.children=e}var M=new m(L).render();if(b){xui.merge(b,M,"all");M.get(0).Instace=b;M=b}H[J]=M.get(0);if(C){C.call(C.target,M.get(0))}if(D){u.append(M,d)}else{u.append(M)}if(K){M.setHost(K,I)}xui.arr.each(e,function(N){delete N[0].$dockParent;M.append.apply(M,N)});s.replace(M.get(0).getRoot());s.remove();s=null;if(F){M.setUIValue(F,true,null,"refresh")}if(q){M.get(0).$afterRefresh=q;q(M.get(0))}if(c&&A){L.$handleCustomVars(A)}if(M.host&&M.host["xui.Module"]){delete M.host.$ignoreAutoDestroy}})},append:function(j,a,d,c){var o=this.get(0),b=o.properties;var g,l,m=arguments[4],f=arguments[5];d=!!d;if(c){if(c["xui.UI"]){c=c.get(0)}xui.arr.each(o.children,function(r,q){if(r[0]===c){g=q;return false}});if(xui.isNumb(g)){g=d?g:(g+1);l=c.getRoot();if(l.isEmpty()){l=null}}}else{g=d?0:-1}if(xui.isHash(j)||xui.isStr(j)){j=xui.create(j)}if(j["xui.UIProfile"]){j=j.boxing()}if(!o.box){return true}if(o.box._IllegalDetect){o.box._IllegalDetect(o,j,true)}if(o.box.$beforeAppend&&false===o.box.$beforeAppend(o,j,a,d,c)){return}if(o.beforeAppend&&false===this.beforeAppend(o,j,a,d,c)){return}if(!j){return}if(j["xui.Module"]){if(a!==false){var e=g;j.getUIComponents().each(function(q){q.linkParent(o,a,c?(e++):e)})}if(o.renderId){f=m?f:o.getContainer(a);if(f&&(!f.isEmpty())&&(!b.lazyAppend||f.css("display")!="none")){if(!c){f[d?"prepend":"append"](j)}else{if(l){l[d?"addPrev":"addNext"](j)}}}}else{xui.arr.insertAny(o.exmodules||(o.exmodules=[]),[j,a],g,true)}}else{if(a!==false){if(j["xui.UI"]){var e=g;j.each(function(q){if(q.linkParent){q.linkParent(o,a,c?(e++):e)}})}}if(o.renderId){var n;f=m?f:o.getContainer(a);if(f&&(!f.isEmpty())&&(!b.lazyAppend||f.css("display")!="none")){if(o.parent&&xui.get(o,["properties","dock"])!="none"&&"absolute"==xui.get(o,["properties","position"])&&!xui.get(o,["properties","dockIgnore"])&&!xui.get(o,["properties","dockFloat"])){if(j["xui.absBox"]){n=j.reBoxing().parent()}}if(!c){f[d?"prepend":"append"](j)}else{if(l){l[d?"addPrev":"addNext"](j)}}if(n&&n.get(0)){n.onSize()}}}else{if(!j["xui.UI"]){xui.arr.insertAny(o.exchildren||(o.exchildren=[]),[j,a],g,true)}}}if(o.box.$afterAppend){o.box.$afterAppend(o,j,a,d,c)}if(o.afterAppend){this.afterAppend(o,j,a,d,c)}return this},getParent:function(){var a=this.get(0);if(a){return a.parent&&a.parent.boxing()}},getChildrenId:function(){var a=this.get(0);if(a){return a.childrenId}},getChildren:function(b,l){if(l===false||l=="include"){var c=this.get(0),d={},m=[],j,o=c.moduleClass,n=c.moduleXid,g=function(f){if(f.moduleClass&&f.moduleXid){if(f.moduleClass!==o&&f.moduleXid!==n){if(d[j=f.moduleClass+"'"+f.moduleXid+"]"]){return null}else{d[j]=1;var a=f.getModule();if(a&&a.moduleClass&&a.moduleXid&&a.moduleClass!==o&&a.moduleXid!==n){return g(a)}else{if(a){return a}}}}}return f},e=function(a){xui.arr.each(a.children,function(f,q){q=g(f[0]);if(q){m.push(q);if(q["xui.UIProfile"]&&q.children&&q.children.length){e(q)}}})};xui.arr.each(c.children,function(a,f){if((b&&typeof(b)=="string")?a[1]===b:1){f=g(a[0]);if(f){m.push(f);if(f["xui.UIProfile"]&&f.children&&f.children.length){e(f)}}}});return m}else{var m=[],e=function(a){xui.arr.each(a.children,function(f){m.push(f[0]);if(f[0].children&&f[0].children.length){e(f[0])}})};xui.arr.each(this.get(0).children,function(a){if((b&&typeof(b)=="string")?a[1]===b:1){m.push(a[0]);if((l===true||l=="penetrate")&&a[0].children&&a[0].children.length){e(a[0])}}});return xui.UI.pack(m)}},removeChildren:function(a,c,b){return this.each(function(g){var j=xui.copy(g.children),f=g.box.$DataModel.valueSeparator||";",e,d;xui.arr.each(j,function(l){e=0;if(!a||a===true){e=1}else{if(xui.isStr(a)||xui.isArr(a)){d=xui.isArr(a)?a:(a+"").split(f);e=xui.arr.indexOf(d,l[1])!=-1||xui.arr.indexOf(d,l[0])!=-1||xui.arr.indexOf(d,l[0].boxing())!=-1}else{e=l[0]==a["xui.UI"]?a.get(0):a}}if(e){if(g.beforeRemove&&false===g.boxing().beforeRemove(g,l[0],l[1],c)){return}l[0].unlinkParent();if(g.afterRemove){g.boxing().afterRemove(g,l[0],l[1],c)}if(c&&!l[0].destroyed){l[0].boxing().destroy(true,b)}}})})},draggable:function(b,e,c,a,d){return this.each(function(f){f.getSubNode(f.keys[c]||"KEY",true).removeClass("xui-ui-selectable").addClass("xui-ui-unselectable").beforeMousedown(b?function(m,j,l){if(xui.Event.getBtn(j)!="left"){return}if(m.properties.disabled){return}var g=g?typeof(g)=="function"?xui.tryF(getTarget,[],f):xui(g):null;if(!g||!g.get(0)){g=xui(l)}a=a||{};a.dragKey=b;a.dragData=typeof e=="function"?e():e;xui.merge(a,{dragCursor:"pointer",dragType:"icon",dragDefer:2});g.startDrag(j,a)}:null,"_d",-1).beforeDragbegin(b?function(g,j,l){xui.use(l).onMouseout(true,{$force:true}).onMouseup(true)}:null,"_d",-1);if(!b){f.clearCache()}})},setCustomFunction:function(a,b){return this.each(function(c){if(typeof a=="string"){if(b){c.CF[a]=b}else{delete c.CF[a]}}else{c.CF=a||{}}})},setCustomClass:function(b,d){var c=arguments.callee,a=(c.fun||(c.fun=function(m,g,j,f){if(!j[g]){return}var l=m.getSubNode(g,true),e;if(!l.isEmpty()){xui.arr.each(j[g].split(/\s+/),function(n){l[f?"removeClass":"addClass"](n)})}}));return this.each(function(j){var e=xui.copy(j.CC),g;if(typeof b=="string"){g=b;b=xui.copy(j.CC);b[g]=d}xui.filter(b,function(m,l){if(!/^[A-Z][A-Z0-9]*$/.test(l)){g=b.KEY=b.KEY||{};if(!(l in g)){g[l]=m}return false}if(!m){return false}});if(b&&typeof b=="object"){if(j.renderId){for(var f in e){a(j,f,e,true)}for(var f in b){a(j,f,b)}}j.CC=b}else{if(j.renderId){for(var f in e){a(j,f,e,true)}}j.CC={}}delete j._nodeEmSize})},setCustomAttr:function(c,e,b){var d=arguments.callee,a=(d.fun||(d.fun=function(q,n,m,j,l){if(!m[n]){return}var g=q.keys[n]||n,o,f;if(l){o=l.query("*","id",g==q.keys.KEY?q.domId:new RegExp("^"+g+":"+q.serialId))}else{o=q.getSubNode(n,true)}if(!o.isEmpty()){if(xui.isHash(m[n])){xui.each(m[n],function(s,r){o.attr(r,j?"":(s&&typeof s=="string")?xui.adjustRes(s,0,1):s)})}}}));return this.each(function(l){var f=xui.copy(l.CA),j;if(typeof c=="string"){j=c;c=xui.copy(l.CA);c[j]=e}xui.filter(c,function(n,m){if(!/^[A-Z][A-Z0-9]*$/.test(m)){j=c.KEY=c.KEY||{};if(!(m in j)){j[m]=n}return false}if(!n){return false}});if(!!c&&typeof c=="object"){if(c){xui.filter(c,function(n,m){return m!="id"&&m!="class"&&m!="style"&&m!="$xid"})}if(l.renderId){for(var g in c){a(l,g,f,true,b)}for(var g in c){a(l,g,c,false,b)}}l.CA=c}else{if(l.renderId){for(var g in f){a(l,g,f,true,b)}}l.CA={}}})},setCustomStyle:function(c,e,b){var d=arguments.callee,a=(d.fun||(d.fun=function(o,n,m,j,l){if(!m[n]){return}var g=o.keys[n]||n,q,f;if(l){q=l.query("*","id",g==o.keys.KEY?o.domId:new RegExp("^"+g+":"+o.serialId))}else{q=o.getSubNode(n,true)}if(!q.isEmpty()){if(xui.isStr(m[n])){xui.arr.each(m[n].split(";"),function(s,r){if((f=s.split(":")).length>=2){r=f.shift();s=f.join(":");r=r.replace(/\-(\w)/g,function(w,u){return u.toUpperCase()});q.css(r,(j?"":(s&&typeof s=="string")?xui.adjustRes(s,0,1):s)||"")}})}else{if(xui.isHash(m[n])){xui.each(m[n],function(r,s){if(xui.isStr(r)){if(s.indexOf("background")===0||r.indexOf(";")==-1){q.css(s,(j?"":(r&&typeof r=="string")?xui.adjustRes(r,0,1):r)||"")}else{xui.arr.each(r.split(";"),function(u){if((f=u.split(":")).length>=2){s=f.shift();u=f.join(":");s=s.replace(/\-(\w)/g,function(x,w){return w.toUpperCase()});q.css(s,(j?"":(u&&typeof u=="string")?xui.adjustRes(u,0,1):u)||"")}})}}else{s=s.replace(/\-(\w)/g,function(w,u){return u.toUpperCase()});q.css(s,(j?"":(r&&typeof r=="string")?xui.adjustRes(r,0,1):r)||"")}})}}}}));return this.each(function(l){var f=xui.copy(l.CS),j;if(typeof c=="string"){j=c;c=xui.copy(l.CS);c[j]=e}xui.filter(c,function(n,m){if(!/^[A-Z][A-Z0-9]*$/.test(m)){j=c.KEY=c.KEY||{};if(!(m in j)){j[m]=n}return false}if(!n){return false}});if(!!c&&typeof c=="object"){if(l.renderId){for(var g in f){a(l,g,f,true,b)}for(var g in c){a(l,g,c,false,b)}}l.CS=c}else{if(l.renderId){for(var g in f){a(l,g,f,true,b)}}l.CS={}}delete l._nodeEmSize})},setCustomBehavior:function(a,b){return this.each(function(c){if(typeof a=="string"){if(c.keys[a]){c.CB[a]=b||{}}}else{c.CB=a||{}}if(c.CB.KEY){xui.merge(c.CB,c.CB.KEY,"all");delete c.CB.KEY}c.clearCache()})},adjustDock:function(a){return this.each(function(c){if(!c.renderId){return}var e=c.properties;if(e.conDockRelative||e.conLayoutColumns){c.boxing().adjustSize()}if(e.position=="absolute"){if("dock" in e&&e.dock&&e.dock!="none"&&c.renderId){var d=c.getRootNode();if(d&&d.clientHeight){if(a){var b=d.style;b.width=((parseFloat(c.$px(b.width))||0)+1)+"px";b.height=((parseFloat(c.$px(b.height))||0)+1)+"px";c._resize_h=c._resize_w=-1}xui.UI.$dock(c,true,true)}}}else{if(xui.get(c,["parent","properties","conDockRelative"])||xui.get(c,["parent","properties","conLayoutColumns"])){xui.UI._adjustConW(c.parent,c.getRoot().parent(),c)}}if(c.$onDock){var d=c.boxing().getContainer(true);if(d&&d.onSize&&d.get(0)){d.onSize()}}})}},Initialize:function(){var b=this.prototype;xui.arr.each("getSubNode,getSubNodes,getDomId,getRootNode,getRoot,getContainer".split(","),function(d){if(!b[d]){b[d]=function(){var e=this.get(0);return e?e[d].apply(e,arguments):null};b[d].$original$="xui.UI";b[d].$type$="instance";b[d].$name$=d}});var a=this,c={};xui.each(xui.UI.$ps,function(d,e){c[e]={$spaceunit:1,ini:"auto",action:function(m){var j=this,n=j.properties,f=false,l;j.getRoot()[e]?j.getRoot()[e](m):xui.Dom._setUnitStyle(j.getRootNode(),e,m);if(e=="width"||e=="height"){if(!j.box._onresize&&j.onResize){j.boxing().onResize(j,e=="width"?m:null,e=="height"?m:null)}}else{if(j.onMove){j.boxing().onMove(j,e=="left"?m:null,e=="top"?m:null,e=="right"?m:null,e=="bottom"?m:null)}}if(n.position=="absolute"&&n.dock!="none"){l={$type:n.dock,$dockid:xui.arr.indexOf(["width","height","fill","cover"],n.dock)!=-1?j.$xid:null};switch(n.dock){case"middle":if(e!="height"&&e!="top"){return}l.top=l.height=1;break;case"center":if(e!="width"&&e!="left"){return}l.left=l.width=1;break;case"top":if(e!="height"&&e!="top"){return}l.width=l.height=1;break;case"bottom":if(e!="height"&&e!="bottom"){return}l.width=l.height=1;break;case"left":if(e!="width"&&e!="left"){return}l.width=l.height=1;break;case"right":if(e!="width"&&e!="right"){return}l.width=l.height=1;break;case"width":if("width"==e){return}l.width=1;break;case"height":if("height"==e){return}l.height=1;break;case"fill":case"cover":if(e=="width"&&e=="height"){return}l.width=l.height=1;break}var g=xui.UIProfile.getFromDom(j.$dockParent);if(g){g.boxing().adjustDock(true)}}}}});xui.merge(c,{renderer:{ini:null},zIndex:{ini:1,action:function(d){this.getRoot().css("zIndex",d)}},tabindex:{ini:1,action:function(f){var e=this,d=new RegExp("^"+e.key+"[-\\w]*:"+e.serialId+":");e.getRoot().query("*",function(g){return g.id&&d.test(g.id)&&g.getAttribute("tabIndex")}).attr("tabIndex",f)}},position:{ini:"absolute",listbox:["","static","relative","absolute"],action:function(e){var d=this,f=d.properties;d.getRoot().css("position",e);if(("dock" in d.box.$DataModel)&&f.dock!="none"&&!f.dockIgnore){e=f.dock;f.dock="none";d.boxing().adjustDock(true);f.dock=e}}},visibility:{listbox:["","visible","hidden"],action:function(d){if(this.box["xui.svg"]){this.boxing().getAllNodes().css("visibility",d)}else{this.getRoot().css("visibility",d)}if(this.$resizer){if(d=="hidden"){this.$resizer.hide()}else{this.$resizer.show()}}xui.setNodeData(this.getRootNode(),"_setVisibility",1)}},display:{listbox:["","none","block","inline","inline-block"],action:function(d){var e=this.box["xui.svg"]?this.boxing().getAllNodes():this.getRoot();if(d=="inline-block"){e.setInlineBlock()}else{e.css("display",d)}}},selectable:{ini:false,action:function(d){this.getRoot().setSelectable(!!d)}}});a.setDataModel(c);xui.UI.$cache_css_before+=xui.UI.buildCSSText({".xui-css-viewport":{"-webkit-text-size-adjust":"100%","-ms-text-size-adjust":"100%","-ms-overflow-style":"scrollbar","-webkit-tap-highlight-color":"transparent","font-size":"75%"},".xui-css-viewport, .xui-css-viewport body":{height:"100%",border:"0 none",margin:"0",padding:"0"},".xui-css-viewport body":{"font-size":"1rem"},"@-ms-viewport":{width:"device-width"},".xui-ui-draggable":{},".xui-inline-block":{display:xui.$inlineBlock,zoom:xui.browser.ie?1:null},".xui-ui-input":{background:"#fff"},".xui-ui-shadow-input":{"-moz-box-shadow":"inset 2px 2px 2px #EEEEEE","-webkit-box-shadow":"inset 2px 2px 2px #EEEEEE","box-shadow":"inset 2px 2px 2px #EEEEEE"},".xui-ui-shadow":{"-moz-box-shadow":"2px 2px 4px #CCC","-webkit-box-shadow":"2px 2px 4px #CCC","box-shadow":"2px 2px 4px #CCC","-ms-filter":(xui.browser.ie&&xui.browser.ver==8)?"progid:DXImageTransform.Microsoft.Shadow(Strength=4, Direction=135, Color='#9f9f9f')":null,filter:(xui.browser.ie&&xui.browser.ver<=8)?"progid:DXImageTransform.Microsoft.Shadow(Strength=4, Direction=135, Color='#9f9f9f')":null},".xui-ui-shadow-r":{"-moz-box-shadow":"1px 0  1px #CCC","-webkit-box-shadow":"1px 0  1px #CCC","box-shadow":"1px 0  1px #CCC","z-index":10},".xui-ui-shadow-b":{"-moz-box-shadow":"0 1px 1px #CCC","-webkit-box-shadow":"0 1px 1px #CCC","box-shadow":"0 1px 1px #CCC","z-index":10},".xui-ui-image":{"vertical-align":"middle",width:"1.3333333333333333em",height:"1.3333333333333333em","background-repeat":"no-repeat"},".xui-uicmd-none, .xui-display-none":{display:"none"},".xui-uitembg":{padding:".25em .5em","background-color":"transparent",border:"solid 1px transparent"},".xui-uitembg-hover":{$order:1,"background-color":"#E0E0E0","border-color":"#CDCDCD"},".xui-uitembg-active":{$order:2,"background-color":"#CDCDCD","border-color":"#B6B6B6"},".xui-uitembg-checked":{$order:3,"background-color":"#CDCDCD","border-color":"#B6B6B6"},".xui-uicell":{"background-color":"#F9F9FB"},".xui-uicell-hover":{$order:1,"background-color":"#d9e8fb"},".xui-uicell-checked":{$order:2,"background-color":"#ABABAB",color:"#fff"},".xui-uicell-alt":{$order:3,"background-color":"#FDF8D2"},".xui-special-icon":{color:"#3393D2","text-shadow":"1px 1px 4px #ccc"},".xui-uibar-top, .xui-uibar-bottom, .xui-uibar-top-s, .xui-uibar-bottom-s":{position:"relative","vertical-align":"baseline"},".xui-uibar-top td, .xui-uibar-top-s td, .xui-uibar-bottom td, .xui-uibar-bottom-s td":{},".xui-uibar-top":{},".xui-uibar-top .xui-uibar-tdl":{$order:1,position:"absolute",width:"12px",left:0,top:0,height:"100%"},".xui-uibar-top .xui-uibar-tdm":{$order:1,position:"absolute",top:0,left:"12px",right:"12px",height:"100%",width:xui.browser.ie&&xui.browser.ver<=7?"expression((this.parentNode.offsetWidth - 24)+'px')":null},".xui-uibar-top .xui-uibar-tdr":{$order:1,position:"absolute",width:"12px",top:0,right:0,height:"100%"},".xui-uibar-top .xui-uibar-tdlt":{$order:1,position:"absolute",width:"12px",left:0,top:0,height:"1.5em"},".xui-uibar-top .xui-uibar-tdmt":{$order:1,position:"absolute",top:0,left:0,right:0,height:"1.5em",width:xui.browser.ie&&xui.browser.ver<=7?"expression((this.parentNode.offsetWidth)+'px')":null},".xui-uibar-top .xui-uibar-tdrt":{$order:1,position:"absolute",width:"12px",right:0,top:0,height:"1.5em"},".xui-uibar-focus, .xui-uibar-top-focus .xui-uibar-tdl, .xui-uibar-top-focus .xui-uibar-tdm, .xui-uibar-top-focus .xui-uibar-tdr":{"background-color":"#B6B6B6"},".xui-uibar-top-focus .xuifont, .xui-uibar-top-focus .xuicon, .xui-uibar-top-focus .xui-uicaption":{},".xui-uibar-top .xui-uibar-cmdl":{overflow:"hidden",position:"relative",padding:".75em 0 .5em .5em","white-space":"nowrap"},".xui-uibar-top2 .xui-uibar-cmdr":{position:"absolute",top:"-.334em",right:"0","text-align":"right"},".xui-uibar-top .xui-uibar-cmdr":{position:"absolute",top:".75em",right:".5em","text-align":"right"},".xui-uibar-top .xui-uibar-tdb":{position:"relative",display:"none",margin:".16667em .16667em 0 .16667em"},".xui-uicon-main":{position:"relative","padding-left":".3333em","z-index":1,overflow:"visible"},".xui-uicon-maini":{"padding-right":".3333em"},".xui-uibar-bottom":{padding:"3px 0"},".xui-uibar-bottom .xui-uibar-tdl":{$order:1,position:"absolute",width:"12px",left:0,bottom:0,height:"100%"},".xui-uibar-bottom .xui-uibar-tdm":{$order:1,position:"absolute",bottom:0,left:"12px",right:"12px",height:"100%",width:xui.browser.ie&&xui.browser.ver<=7?"expression((this.parentNode.offsetWidth - 24)+'px')":null},".xui-uibar-bottom .xui-uibar-tdr":{$order:1,position:"absolute",width:"12px",right:0,bottom:0,height:"100%"},".xui-uibar-top-s, .xui-uibar-bottom-s, .xui-uibar-top-s .xui-uibar-t":{$order:3,height:"5px"},".xui-uibar-top-s .xui-uibar-tdl":{$order:3,position:"absolute",width:"12px",left:0,top:0,height:"100%"},".xui-uibar-top-s .xui-uibar-tdm":{$order:3,position:"absolute",top:0,left:"12px",right:"12px",height:"100%",width:xui.browser.ie&&xui.browser.ver<=7?"expression((this.parentNode.offsetWidth - 24)+'px')":null},".xui-uibar-top-s .xui-uibar-tdr":{$order:3,position:"absolute",width:"12px",top:0,right:0,height:"100%"},".xui-uibar-top-s .xui-uibar-cmdl":{$order:3,display:"none"},".xui-uibar-top-s .xui-uibar-cmdr":{$order:3,display:"none"},".xui-uibar-bottom-s .xui-uibar-tdl":{$order:3,position:"absolute",width:"12px",left:0,bottom:0,height:"100%"},".xui-uibar-bottom-s .xui-uibar-tdm":{$order:3,position:"absolute",bottom:0,left:"12px",right:"12px",height:"100%",width:xui.browser.ie&&xui.browser.ver<=7?"expression((this.parentNode.offsetWidth - 24)+'px')":null},".xui-uibar-bottom-s .xui-uibar-tdr":{$order:3,position:"absolute",width:"12px",right:0,bottom:0,height:"100%"}})+xui.UI.buildCSSText({".xui-ui-unselectable":{$order:0,"-moz-user-select":xui.browser.gek?"-moz-none":null,"-khtml-user-select":xui.browser.kde?"none":null,"-webkit-user-select":xui.browser.kde?"none":null,"-o-user-select":xui.browser.opr?"none":null,"-ms-user-select":(xui.browser.ie||xui.browser.newie)?"none":null,"user-select":"none","touch-action":"none"},".xui-ui-selectable":{$order:1,"-moz-user-select":xui.browser.gek?"text":null,"-khtml-user-select":xui.browser.kde?"text":null,"-webkit-user-select":xui.browser.kde?"text":null,"-o-user-select":xui.browser.opr?"text":null,"-ms-user-select":(xui.browser.ie||xui.browser.newie)?"text":null,"user-select":"text","touch-action":"auto"},".xui-uiw-shell":{display:xui.$inlineBlock,zoom:xui.browser.ie&&xui.browser.ver<=7?1:null,border:0,padding:0,margin:0},".xui-uiw-frame":{$order:1,display:"block",position:"relative",border:0,padding:0,margin:0,width:"100%",height:"100%","-moz-box-flex":"1"},".xui-uiw-border":{$order:2,display:"block",position:"relative",border:0,padding:0,margin:0,left:0,top:0,width:"100%",height:"100%"}})+xui.UI.buildCSSText({".xui-uibase":{"background-color":"#FFFFFF"},".xui-uicontainer":{},".xui-uibar":{"background-color":"#E0E0E0"},".xui-uibar-hover":{$order:1,"background-color":"#CDCDCD"},".xui-uibar-active, .xui-uibar-checked, .xui-uibar-expand, .xui-uimenu-hover, .xui-uimenu-active":{$order:2,"background-color":"#ABABAB"},".xui-ui-ctrl-highlight, .xui-node-highlight, .xui-uibar-checked,  .xui-uibar-expand, .xui-uimenu-hover, .xui-uimenu-active":{$order:3,color:"#FFF"},".xui-ui-btn::-moz-focus-inner":{$order:3,padding:"0 !important",border:"0 none !important"},".xui-uigradient":{$order:4,border:"solid 1px #B6B6B6",color:"#333","text-shadow":"0px 1px 1px rgba(255,255,255,1)","text-decoration":"none","white-space":"nowrap","background-image_1":"linear-gradient(top,  #FFF 5%,  #CDCDCD 100%)","background-image_2":"-webkit-gradient(linear, 0% 0%, 0% 100%, from(0.05, #FFF), to(1, #CDCDCD))","background-image_3":"-webkit-linear-gradient(top,  #FFF 5%,  #CDCDCD 100%)","background-image_4":"-moz-linear-gradient(top,  #FFF 5%,  #CDCDCD 100%)","background-image_5":"-o-linear-gradient(top,  #FFF 5%,  #CDCDCD 100%)","background-image_6":"-ms-linear-gradient(top,  #FFF 5%,  #CDCDCD 100%)","-ms-filter":(xui.browser.ie&&xui.browser.ver==8)?"progid:DXImageTransform.Microsoft.gradient(startColorstr='#FFFFFF', endColorstr='#CDCDCD', GradientType=0)":null,filter:(xui.browser.ie&&xui.browser.ver<=9)?"progid:DXImageTransform.Microsoft.gradient(startColorstr='#FFFFFF', endColorstr='#CDCDCD', GradientType=0)":null},".xui-uigradient-hover, .xui-uigradient:hover":{$order:5,"background-image_1":"linear-gradient(top,  #FFF 5%,  #EEE 100%)","background-image_2":"-webkit-gradient(linear, 0% 0%, 0% 100%, from(0.05, #FFF), to(1, #EEE))","background-image_3":"-webkit-linear-gradient(top,  #FFF 5%,  #EEE 100%)","background-image_4":"-moz-linear-gradient(top,  #FFF 5%,  #EEE 100%)","background-image_5":"-o-linear-gradient(top,  #FFF 5%,  #EEE 100%)","background-image_6":"-ms-linear-gradient(top,  #FFF 5%,  #EEE 100%)","-ms-filter":(xui.browser.ie&&xui.browser.ver==8)?"progid:DXImageTransform.Microsoft.gradient(startColorstr='#FFFFFF', endColorstr='#CDCDCD', GradientType=0)":null,filter:(xui.browser.ie&&xui.browser.ver<=9)?"progid:DXImageTransform.Microsoft.gradient(startColorstr='#FFFFFF', endColorstr='#CDCDCD', GradientType=0)":null},".xui-uigradient-active, .xui-uigradient-checked, .xui-uigradient-expand, .xui-uigradient:active, .xui-uigradient-active:hover, .xui-uigradient-checked:hover, .xui-uigradient-expand:hover":{$order:6,"background-image_1":"linear-gradient(top,  #CDCDCD 5%,  #FFF)","background-image_2":"-webkit-gradient(linear, 0% 0%, 0% 100%, from(0.05, #CDCDCD), to(1, #FFF))","background-image_3":"-webkit-linear-gradient(top,  #CDCDCD 5%,  #FFF 100%)","background-image_4":"-moz-linear-gradient(top,  #CDCDCD 5%,  #FFF 100%)","background-image_5":"-o-linear-gradient(top,  #CDCDCD 5%,  #FFF 100%)","background-image_6":"-ms-linear-gradient(top,  #CDCDCD 5%,  #FFF 100%)","-ms-filter":(xui.browser.ie&&xui.browser.ver==8)?"progid:DXImageTransform.Microsoft.gradient(startColorstr='#CDCDCD', endColorstr='#FFFFFF', GradientType=0)":null,filter:(xui.browser.ie&&xui.browser.ver<=9)?"progid:DXImageTransform.Microsoft.gradient(startColorstr='#CDCDCD', endColorstr='#FFFFFF', GradientType=0)":null},".xui-ui-btn":{$order:7,padding:".334em","white-space":"normal",cursor:"pointer",border:"solid 1px #B6B6B6",display:xui.$inlineBlock,"text-align":"center","line-height":"1",zoom:xui.browser.ie?1:null,width_1:(xui.browser.ie&&xui.browser.ver<=7)?"auto":null,overflow:(xui.browser.ie&&xui.browser.ver<=7)?"visible":null},".xui-ui-btn:hover, .xui-ui-btn-hover":{$order:8,"border-color":"#B5B5B5"},".xui-uiborder-l":{"border-left-style":"solid","border-left-width":"1px","border-left-color":"#F6F6F6"},".xui-uiborder-r":{"border-right-style":"solid","border-right-width":"1px","border-right-color":"#B6B6B6"},".xui-uiborder-t":{"border-top-style":"solid","border-top-width":"1px","border-top-color":"#F6F6F6"},".xui-uiborder-b, .xui-uitem-split":{"border-bottom-style":"solid","border-bottom-width":"1px","border-bottom-color":"#B6B6B6"},".xui-uiborder-nob":{$order:1,"border-bottom-width":0,"border-bottom-style":"none"},".xui-uiborder-hidden":{border:"solid 1px transparent",background:"none"},".xui-uiborder-hidden-active, .xui-uiborder-hidden-checked":{background:"#efefef"},".xui-uiborder-flat":{border:"solid 1px #B6B6B6"},".xui-uiborder-outset":{$order:8,border:"solid 1px","border-color":"#F6F6F6 #B6B6B6 #B6B6B6 #F6F6F6"},".xui-uiborder-inset, .xui-uiborder-hidden-active, .xui-uiborder-hidden-checked":{$order:10,border:"solid 1px","border-color":"#B6B6B6 #F6F6F6 #F6F6F6 #B6B6B6"},".xui-uiborder-dark, .xui-uiborder-flat-hover":{"border-color":"#B6B6B6"},".xui-uiborder-light, .xui-uiborder-hidden-hover":{"border-color":"#efefef"},".xui-uiborder-radius":{$order:11,"-moz-border-radius":"3px","-o-border-radius":"3px","-ms-border-radius":"3px","-khtml-border-radius":"3px"},".xui-uiborder-radius-big":{$order:11,"-moz-border-radius":"6px","-o-border-radius":"6px","-ms-border-radius":"6px","-khtml-border-radius":"6px"},".xui-uiborder-radius-tl":{$order:12,"-moz-border-top-left-radius":"3px","-o-border-top-left-radius":"3px","-ms-border-top-left-radius":"3px","-khtml-border-top-left-radius":"3px"},".xui-uiborder-radius-tr":{$order:12,"-moz-border-top-right-radius":"3px","-o-border-top-right-radius":"3px","-ms-border-top-right-radius":"3px","-khtml-border-top-right-radius":"3px"},".xui-uiborder-radius-br":{$order:12,"-moz-border-bottom-right--radius":"3px","-o-border-bottom-right--radius":"3px","-ms-border-bottom-right--radius":"3px","-khtml-border-bottom-right--radius":"3px"},".xui-uiborder-radius-bl":{$order:12,"-moz-border-bottom-left-radius":"3px","-o-border-bottom-left-radius":"3px","-ms-border-bottom-left-radius":"3px","-khtml-border-bottom-left-radius":"3px"},".xui-uiborder-radius-big-tl":{$order:13,"-moz-border-top-left-radius":"6px","-o-border-top-left-radius":"6px","-ms-border-top-left-radius":"6px","-khtml-border-top-left-radius":"6px"},".xui-uiborder-radius-big-tr":{$order:13,"-moz-border-top-right-radius":"6px","-o-border-top-right-radius":"6px","-ms-border-top-right-radius":"6px","-khtml-border-top-right-radius":"6px"},".xui-uiborder-radius-big-br":{$order:13,"-moz-border-bottom-right--radius":"6px","-o-border-bottom-right--radius":"6px","-ms-border-bottom-right--radius":"6px","-khtml-border-bottom-right--radius":"6px"},".xui-uiborder-radius-big-bl":{$order:13,"-moz-border-bottom-left-radius":"6px","-o-border-bottom-left-radius":"6px","-ms-border-bottom-left-radius":"6px","-khtml-border-bottom-left-radius":"6px"},".xui-uiborder-noradius":{$order:15,"border-radius":"0 !important","-moz-border-radius":"0 !important","-webkit-border-radius":"0 !important","-o-border-radius":"0 !important","-ms-border-radius":"0 !important","-khtml-border-radius":"0 !important"},".xui-uiborder-noradius-l":{$order:15,"border-top-left-radius":"0 !important","-moz-border-top-left-radius":"0 !important","-webkit-border-top-left-radius":"0 !important","-o-border-top-left-radius":"0 !important","-ms-border-top-left-radius":"0 !important","-khtml-border-top-left-radius":"0 !important","border-bottom-left-radius":"0 !important","-moz-border-bottom-left-radius":"0 !important","-webkit-border-bottom-left-radius":"0 !important","-o-border-bottom-left-radius":"0 !important","-ms-border-bottom-left-radius":"0 !important","-khtml-border-bottom-left-radius":"0 !important"},".xui-uiborder-noradius-r":{$order:15,"border-top-right-radius":"0 !important","-moz-border-top-right-radius":"0 !important","-webkit-border-top-right-radius":"0 !important","-o-border-top-right-radius":"0 !important","-ms-border-top-right-radius":"0 !important","-khtml-border-top-right-radius":"0 !important","border-bottom-right-radius":"0 !important","-moz-border-bottom-right-radius":"0 !important","-webkit-border-bottom-right-radius":"0 !important","-o-border-bottom-right-radius":"0 !important","-ms-border-bottom-right-radius":"0 !important","-khtml-border-bottom-right-radius":"0 !important"},".xui-uiborder-noradius-t":{$order:15,"border-top-left-radius":"0 !important","-moz-border-top-left-radius":"0 !important","-webkit-border-top-left-radius":"0 !important","-o-border-top-left-radius":"0 !important","-ms-border-top-left-radius":"0 !important","-khtml-border-top-left-radius":"0 !important","border-top-right-radius":"0 !important","-moz-border-top-right-radius":"0 !important","-webkit-border-top-right-radius":"0 !important","-o-border-top-right-radius":"0 !important","-ms-border-top-right-radius":"0 !important","-khtml-border-top-right-radius":"0 !important"},".xui-uiborder-noradius-b":{$order:15,"border-bottom-left-radius":"0 !important","-moz-border-bottom-left-radius":"0 !important","-webkit-border-bottom-left-radius":"0 !important","-o-border-bottom-left-radius":"0 !important","-ms-border-bottom-left-radius":"0 !important","-khtml-border-bottom-left-radius":"0 !important","border-bottom-right-radius":"0 !important","-moz-border-bottom-right-radius":"0 !important","-webkit-border-bottom-right-radius":"0 !important","-o-border-bottom-right-radius":"0 !important","-ms-border-bottom-right-radius":"0 !important","-khtml-border-bottom-right-radius":"0 !important"},".xui-ui-noshadow, .xui-ui-noshadow .xui-ui-shadow-input, .xui-ui-noshadow .xui-ui-shadow, .xui-ui-noshadow .xui-ui-shadow-b, .xui-ui-noshadow .xui-ui-shadow-r,  .xui-ui-disabled .xui-ui-shadow-input,  .xui-ui-readonly .xui-ui-shadow-input,  .xui-ui-inputreadonly .xui-ui-shadow-input":{$order:15,"-moz-box-shadow":"none !important","-webkit-box-shadow":"none !important","box-shadow":"none !important"},".xui-uiborder-circle":{$order:16,"border-radius":"50%","-moz-border-radius":"50%","-o-border-radius":"50%","-ms-border-radius":"50%","-khtml-border-radius":"50%"},".xui-uiflag-1":{$order:16,"border-radius":"50%","-moz-border-radius":"50%","-o-border-radius":"50%","-ms-border-radius":"50%","-khtml-border-radius":"50%",width:xui.browser.contentBox?"1em":"1.625em",height:xui.browser.contentBox?"1em":"1.625em",padding:".334em","background-color":"#eb6e1a",color:"#fff !important",overflow:"hidden","text-align":"center"},".xui-uiborder-none":{$order:20,border:"none"},".xui-uisb":{position:"absolute"},".xui-uisb-none":{display:"none"},".xui-uisb-left":{left:0,top:0,width:"3em",height:"100%"},".xui-uisb-right":{top:0,right:0,width:"3em",height:"100%"},".xui-uisb-top":{left:0,top:0,width:"100%",height:"3em"},".xui-uisb-bottom":{left:0,bottom:0,width:"100%",height:"3em"},".xui-uisbbtn":{position:"absolute",cursor:"pointer","z-index":1,width:"1em",height:"1em"},".xui-uisb-left .xui-uisbbtn":{left:0,top:0},".xui-uisb-right .xui-uisbbtn":{right:0,top:0},".xui-uisb-top .xui-uisbbtn":{right:0,bottom:0},".xui-uisb-bottom .xui-uisbbtn":{right:0,top:0},".xui-uisbcap":{position:"relative","text-align":"center",width:"100%",height:"100%"},".xui-uisb-left .xui-uisbcap, .xui-uisb-right .xui-uisbcap":{"writing-mode":"tb-rl",filter:"flipv fliph"},".xui-ltag-cmds":{margin:0,padding:0,"vertical-align":"middle"},".xui-rtag-cmds":{margin:0,padding:0,"vertical-align":"middle"},".xui-tag-cmd":{margin:"0 .125em",padding:".1667em","vertical-align":"middle"},".xui-inline-object":{"vertical-align":"middle",margin:"0 .16666667em"}});xui.UI.$cache_css_after+=xui.UI.buildCSSText({".xui-css-innerimage":{"vertical-align":"middle"},".xui-uitem-split":{display:"block",position:"relative",overflow:"visible","white-space":"nowrap",margin:"2px 0",padding:0},".xui-css-noscroll, .xui-css-noscroll body":{overflow:"hidden","overflow-x":"hidden","overflow-y":"hidden"},".xui-css-noscrollx, .xui-css-noscroll body":{"overflow-x":"hidden"},".xui-css-noscrolly, .xui-css-noscroll body":{"overflow-y":"hidden"},".xui-css-dockparent":{overflow:"hidden"},".xui-ui-dirty":{$order:1,"background-image":"url(data:image/gif;base64,R0lGODlhBwAHAPcAAAAAADDSEwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAP8ALAAAAAAHAAcAAAgYAAMIHPhvoMB/BQkiVLgwAMKHDh9KnBgQADs=)","background-repeat":"no-repeat","background-position":"left top"},".xui-float-clear":{clear:"both"},".xui-float-left":{"float":"left"},".xui-float-right":{"float":"right"},".xui-ui-ellipsis":{"max-width":"100%","text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden"},".xui-ui-ruler":{width:0,height:"1.22em","vertical-align":"middle"},".xui-nodatauri .xui-ui-dirty":{$order:2,"background-image":xui.UI.$oldBg("dirtymark.gif","no-repeat left top")},".xui-ui-ctrl-readonly, .xui-node-readonly, input[readonly], textarea[readonly], input:read-only, textarea:read-only, .xui-ui-readonly, .xui-ui-itemreadonly, .xui-ui-readonly .xui-node, .xui-ui-itemreadonly .xui-node, xui-ui-inputreadonly input, xui-ui-inputreadonly textarea":{$order:2,color:"#666666 !important"},"button::-moz-focus-inner, input::-moz-focus-inner":{padding:0,border:0},".xui-ui-ctrl-disabled, .xui-node-disabled, button:disabled, a:disabled, input:disabled, textarea:disabled,  .xui-ui-disabled,  .xui-ui-itemdisabled,  .xui-ui-disabled .xui-node, .xui-ui-itemdisabled .xui-node, .xui-uicell-disabled, .xui-uicell-disabled .xui-node":{$order:2,cursor:"not-allowed",color:"#808080 !important"},".xui-ui-ctrl-disabled, .xui-node-disabled, button:disabled, a:disabled, input:disabled, textarea:disabled,  .xui-ui-disabled input,.xui-ui-disabled textarea, .xui-ui-itemdisabled input, .xui-ui-itemdisabled textarea, .xui-uicell-disabled":{$order:3,"background-color":"#eee !important"},".xui-ui-invalid, .xui-ui-invalid .xui-node":{$order:1,"background-color":"#FFEBCD !important"},".xui-item-row":{display:"block","white-space":"nowrap"},".xui-item-cell":{display:xui.$inlineBlock,zoom:xui.browser.ie?1:null,"white-space":"normal"},".xui-required":{color:"#ff0000 !important"},".xui-alert":{"background-color":"#ff6600 !important"},".xui-uisyle-mobile":{"background-clip":"padding-box",border:"10px solid #333333","border-radius":"12px","box-shadow":"0 0 15px rgba(0, 0, 0, 0.28), 0 1px 1px rgba(255, 255, 255, 0.45) inset, 0 0 2px rgba(255, 255, 255, 0.2) inset"},".xui-uisyle-mobile, .xui-uisyle-mobile *, .xui-cursor-touch, .xui-cursor-touch *":{cursor:"url("+xui.ini.img_touchcur+") 8 8,auto!important"},".xui-icon-loading":{$order:7,width:(xui.browser.ie&&xui.browser.ver<=8)?"1em":null,height:(xui.browser.ie&&xui.browser.ver<=8)?"1em":null,"background-image":(xui.browser.ie&&xui.browser.ver<10)?"url("+xui.ini.img_busy+")":null,"background-repeat":(xui.browser.ie&&xui.browser.ver<10)?"no-repeat":null,"background-position":(xui.browser.ie&&xui.browser.ver<10)?"center center":null},".xui-icon-loading:before":{$order:7,visibility:(xui.browser.ie&&xui.browser.ver<10)?"hidden":null},".xui-load-error":{width:(xui.browser.ie&&xui.browser.ver<=8)?"1em":null,height:(xui.browser.ie&&xui.browser.ver<=8)?"1em":null,"background-image":(xui.browser.ie&&xui.browser.ver<=8)?"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAAJdnBBZwAAABAAAAAQAFzGrcMAAADdSURBVCjPfdGxTsJQGIbhpw20GgN1IZQBDQnGxvu/FEU3IjEBB5SKUsGkdTiCYeGb/pw803uixum1iMJ1KZdp40dpYQWNqBERuXItRY1YrPJspmm0wNAYlZkvdPR1jTVmtJAZgUhliaWFQs9IqYwxkKhUUnf64NuTD6kBMTK8mKgkigNZaGQBJGqfVh6PyFotCWC/NxMbiUL+/xhjJ9Y5kEriVk9HbBdAKZI7A+8ebLQVhigDmNvqKg7k3kZbamceOpSmbvSkXq1xIfSfKh2lPlf/pWa7Tx3A6c86vV+v4FNOkQDWwAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxMC0wMi0xMVQxMTo1MDowOC0wNjowMNYQZfsAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMDYtMDUtMDVUMTM6MjI6NDAtMDU6MDC/5P4aAAAAAElFTkSuQmCC)":null,"background-repeat":(xui.browser.ie&&xui.browser.ver<=8)?"no-repeat":null,"background-position":(xui.browser.ie&&xui.browser.ver<=8)?"center center":null},".xui-load-error:before":{$order:7,visibility:(xui.browser.ie&&xui.browser.ver<=8)?"hidden":null},".xui-ui-clear":{$order:10,border:"none",background:"none"}})},$End:function(){var b={},a=this.$Keys;xui.filter(this.getAppearance(),function(q,n){var g=n.split(/\s*,\s*/),e;for(var d=g.length-1;d>=0;d--){e=g[d].match(/[A-Z][A-Z0-9]*/g);if(e&&e.length){for(var f=0,c=e.length;f<c;f++){if(!a[e[f]]){g.splice(d,1);break}}}}if(g.length){b[g.join(", ")]=q}});this.setAppearance(b);xui.UI.$cache_css_before+=this.buildCSSText(this.$Appearances)},Static:{$cache_css_before:"",$cache_css_after:"",$css_tag_dirty:"xui-ui-dirty",$css_tag_invalid:"xui-ui-invalid",$tag_left:"{",$tag_right:"}",$tag_subId:"_serialId",$tag_subId_c:"_serialId_c",$x01:/\x01/img,$x01r:/ \x01 /img,$tag_special:"\x01",$ID:"\x01id\x01",$DOMID:"\x01domid\x01",$CLS:"\x01cls\x01",$MODULECLS:"\x01modulecls\x01",$TAGCLASS:"\x01tagcls\x01",$childTag:"<!--\x03{id}\x04-->",$ps:{left:1,top:1,width:1,height:1,right:1,bottom:1},objectProp:{},$toDom:function(c,f,j){if(j===false){return xui.str.toDom(f)}var g=xui.Dom.getEmptyDiv(c.$inDesign).get(0),a=[],b=g.style;b.position="relative";b.display="none";g.innerHTML=f;this.$addEventsHandler(c,g);for(var e=0,m=g.childNodes,d=m.length;e<d;e++){xui.$registerNode(m[e]);a[a.length]=m[e].$xid}b.display="";g=null;return xui(a,false)},$evtsindesign:{onload:1,onerror:1,onscroll:1,onunload:1,onsize:1,onmousedown:1,onmouseup:1},_handleEventConf:function(b,a){var c=this},$addEventsHandler:function(f,e,u){var a=xui.$cache.UIKeyMapEvents,b=xui.Event,n=b._eventHandler,r=this.$evtsindesign,x=b.$eventhandler,d=xui.toArr(e.getElementsByTagName("*")),q,g,o,m,c,w,s;if(u){d.push(e)}if(g=d.length){for(q=0;q<g;q++){if((e=d[q]).nodeType!=1){continue}if(c=e.id){if(w=a[c]||a[c.substr(0,c.indexOf(":"))]){s=xui.$registerNode(e);s=s.eHandlers||(s.eHandlers={});for(o in w){if(f.$inDesign&&!r[o]){continue}s[o]=w[o];if(m=n[o]){s[m]=w[o];b._addEventListener(e,m,w[o]);if(xui.browser.isTouch&&m=="onmousedown"){s.onxuitouchdown=x;b._addEventListener(e,"xuitouchdown",x)}}}}}}}d.length=0;e=w=null},setDftProp:function(a){this.__resetDftProp=a;return this},getFromDom:function(a){if(a=xui.UIProfile.getFromDom(a)){return a.boxing()}},_ensureValues:function(c){var d=[],j=0,f=0,l,g=this.KEY,e=xui.$cache.profileMap,b=xui.getNodeData;if(c["xui.absBox"]){c=c._nodes}for(;l=c[j++];){if((l.box&&l.box[g])||((l=e[b(l.renderId?l.renderId:l,["element","id"])])&&l.box&&l.box[g])){d[f++]=l}}return d.length<=1?d:this._unique(d)},__gc:function(){var c=this,b=c.$key,a=xui.$cache;xui.breakO([a.template[b],a.reclaimId[b],c._cache,c._idCache,c.$DataModel,c.$Templates,c.$Behaviors,c],2);delete xui.absBox.$type[b.replace("xui.UI.","")];delete xui.absBox.$type[b];xui.filter(xui.$cache.UIKeyMapEvents,function(e,d){return !(d==b||d.indexOf(b+"-")==0)});xui.Class.__gc(b)},_pickSerialId:function(){var a=xui.$cache.reclaimId[this.$key];if(a&&a[0]){return a.pop()}return this._ctrlId.next()},$oldBg:function(d,b,c,a){return function(e){return"url("+xui.ini.path+"appearance/_oldbrowser/"+d+") "+(b||"")}},$ieOldBg:function(a){return function(b){return'progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+xui.ini.path+"appearance/_oldbrowser/"+a+'",sizingMethod="crop")'}},$doTemplate:function(a,E,c,A,d,b,x){var j=xui.UI.$doTemplate,f,e,m,q=xui.UI.$x01,u=" \x01 ",o="",C=xui.isArr(c),D=E[A||""],g=!d,d=d||[];A=x||A;if(C){if(typeof D!="function"){D=j}for(var B=0;e=c[B++];){if(false===D(a,E,e,A,d,B)){break}}}else{if(e=c.object){d[d.length]=e.toHtml()}else{if(typeof D=="function"){e=D(a,E,c,A,d);if(e){A=e}}else{A=A?A+".":"";var G=D[0],F=D[1];for(var B=0,w=G.length;B<w;B++){if(m=F[B]){if(m in c){e=c[m];if(m.substr(0,4)=="_fi_"){if(xui.__iefix2&&(G[B-1]=="_the_next_is_fonticon_"||m=="_fi_")){e=xui.str.trim(e).split(/\s+/).pop();e=(e in xui.__iefix2)?xui.__iefix2[e]:o}else{if(m=="_fi_"){e=o}}}if(E[f=A+m]&&e){j(a,E,e,f,d)}else{d[d.length]=(e===undefined||e===null||e===NaN)?o:typeof e=="string"?e.replace(q,u):e}}}else{d[d.length]=(G[B]===undefined||G[B]===null||G[B]===NaN)?o:G[B]}}}}}if(g){return d.join("")}},$buildTemplate:function(n,P,U,w,e){if(P&&(P.tagName+"").toLowerCase()=="text"){e[e.length]=P.text;return}var D=arguments.callee,B=n.behavior?U?n.behavior[U]:n.behavior:null,m=n.properties,S=D.map1||(D.map1={tagName:1,text:1}),Q=D.map2||(D.map2={image:1,input:1,br:1,meta:1,hr:1,abbr:1,embed:1}),N=D.map3||(D.map3={input:1,textarea:1,pre:1,code:1}),J=D.r2||(D.r2=/[a-z]/),I=D.r3||(D.r3=/^(on|before|after)/),F=D.r7||(D.r7=/([^{}]*)\{([\w]+)\}([^{}]*)/g),q=false,s=xui.UI,d=s.$tag_special,A,E,O,r,C,f;if(!P){P=n.template}f=U?n.keys[U]:n.key;if(!P.tagName){P.tagName="span"}if(P.id!==null){P.id=U?f+":"+s.$ID+":"+s.$tag_left+(P.$customId?s.$tag_subId_c:s.$tag_subId)+s.$tag_right:s.$DOMID}else{delete P.id}if(P.className!==null){O=P.className||"";if(!P._NativeElement){A=s.$CLS+(U?"-"+U.toLowerCase():"");r=P.tagName.charAt(0)!="{"?P.tagName.toLowerCase():P.tagName;C=(r=="button"||r=="input"||r=="textarea"||r=="select"||r=="keygen")?"xui-ui-reset":"";P["class"]="xui-node"+(C?(" "+C):"")+" xui-node-"+r+(A?(" "+A):"")+(O?(" "+O):"")+(P.$fonticon?(" "+P.$fonticon):"")+(f==n.key?(" xui-ui-ctrl "+((xui.browser.ie&&xui.browser.ver<10)?"":"{_selectable} ")):"")}else{P["class"]=O+" "+(f==n.key?((xui.browser.ie&&xui.browser.ver<10)?"":"{_selectable} "):"")}P["class"]+=" "+d+(U||"KEY")+"_CT"+d+" "+d+(U||"KEY")+"_CC"+d+" "+s.$MODULECLS+" "+s.$TAGCLASS+(m._tagClass?" "+m._tagClass:"")+" xui-custom"}delete P.className;P.style=(P.style?(P.style+";"):"")+d+(U||"KEY")+"_CS"+d;var M=[],L={},j=P.tagName.charAt(0)!="{"?P.tagName.toLowerCase():P.tagName,x=P.text,c=xui.absObj.$specialChars;for(var K in P){if(!P[K]){continue}if(!c[K.charAt(0)]&&!S[K]){E=P[K];if(!J.test(K)){if(typeof E=="object"){if(!E.$order){E.$order=0}E.$key=K;M[M.length]=E}}else{L[K]=E}}}xui.arr.stableSort(M,function(a,b){a=a.$order||0;b=b.$order||0;return a>b?1:a==b?0:-1});if(!e){q=true;e=[]}e[e.length]="<"+j+" ";for(var K in L){if(L[K]){e[e.length]=K+'="'+L[K]+'" '}}if(P.className!==null){P.className=O}delete P["class"];e[e.length]=d+(U||"KEY")+"_CA"+d;e[e.length]=">";if(!Q[j]&&x){e[e.length]=x}if(P.$fonticon&&xui.__iefix2){P.$fonticon=xui.str.trim(P.$fonticon);if(xui.__iefix2[P.$fonticon]){e[e.length]=xui.__iefix2[P.$fonticon]}else{if(/^\s*\{\s*_fi_[\w\s]+\}\s*$/.test(P.$fonticon)){e[e.length]="{_the_next_is_fonticon_}"+P.$fonticon}}}delete P.$fonticon;for(var K=0,H=M.length;K<H;){E=M[K++];D(n,E,E.$key,w,e)}if(!Q[j]){e[e.length]="</"+j+">"}if(q){var T=w[0],R=w[1],G=e.join(""),g=false;G.replace(F,function(o,l,V,u){if(l){T[T.length]=l}R[T.length]=T[T.length]=V;if(u){T[T.length]=u}g=true;return""});if(!g){T[0]=G}}},_rpt:function(b,l){var g=arguments.callee,m=b.host,f=(m&&m["xui.Module"]&&m.customStyle&&!xui.isEmpty(m.customStyle))?(" xui-module-"+m.$xid):null,j=xui.UI,n=j.$tag_special,c=function(r,q,o){q="";for(o in r){q+=(o+'="'+r[o]+'" ')}return q},a=g._r||(g._r=new RegExp(n+"([0-9A-Z_]+)_C([CTA])"+n+"|"+n+"([\\w_\\-\\.]*)"+n,"img")),e={id:b.serialId,cls:b.getClass("KEY"),domid:b.$domId,modulecls:f,tagcls:(b.tagcls||"")},d={A:b.CA,C:b.CC,T:b._CT};return l.replace(a,function(q,o,s,r){return e[r]||(d[s]?(s=="A"?c(d[s][o]):(d[s][o]||"")):"")}).replace(j.$x01r,"\x01")},_build:function(b,l){var q,w,c,r=xui.UI,s=[[],[]],x=this,o=x.KEY,a=xui.$cache.template,g=b._hash="b:"+(b.template._subid||"")+";!"+(b._exhash||"");if(typeof b.theme=="string"){var n=b._CT={},d=b.key.replace(/\./g,"-").toLowerCase().replace("xui-ui","xui")+"-";xui.each(b.keys,function(m,j){if(j.charAt(0)!="$"){n[j]=d+b.theme+"-"+j.toLowerCase()}})}if(!(q=xui.get(a,[o,g]))){r.$buildTemplate(b,null,null,s);xui.set(a,[o,g,""],s);if(w=b.template.$submap){for(var f in w){if(typeof(c=w[f])!="function"){var s=[[],[]];for(var e in c){if(typeof c[e]=="object"){r.$buildTemplate(b,c[e],e,s)}}c=s}xui.set(a,[o,g,f],c)}}q=xui.get(a,[o,g])}if(!q){return""}return x._rpt(b,r.$doTemplate(b,q,l))},_setDefaultBehavior:function(j){var a=this,d=arguments.callee,g=d._m||(d._m={"":1,KEY:1,$key:1}),e=d._f1||(d._f1=function(f,n,o){var m=function(x,E,q){var H,u=xui.use(q).id(),G,F=x.getSubId(u),s=x.properties,r,D,C;if(s.disabled||s.readonly){return}G=x.SubSerialIdMapItem&&x.SubSerialIdMapItem[F];if(G&&G.disabled){return}if(G&&G.readonly){return}switch(typeof f){case"string":r=x.getSubNode(f,F)._get();break;case"function":D=[f];break;case"object":r=[];D=[];for(var w,B=0,A=f.length;B<A;B++){w=f[B];if(typeof w=="string"){r.push.apply(r,x.getSubNode(w,F)._get())}else{D.push(w)}}}if(r&&r.length){r=xui(r);C=x.boxing();if(o==1){if(
/*xui.browser.fakeTouch &&*/
xui.browser.deviceType!="touchOnly"&&n=="mouseover"){if(x.$beforeHover&&false==x.$beforeHover(x,G,E,q,"mouseover")){return}if(s.disableHoverEffect===true){return}if(s.disableHoverEffect&&(new RegExp("\\b"+x.getKey(q,true)+"\\b")).test(s.disableHoverEffect||"")){return}if(x.beforeHoverEffect&&false===C.beforeHoverEffect(x,G,E,q,"mouseover")){return}}if(n=="mousedown"){if(x.$beforeClick&&false==x.$beforeClick(x,G,E,q,"mousedown")){return}if(s.disableClickEffect){return}if(x.beforeClickEffect&&false===C.beforeClickEffect(x,G,E,q,"mousedown")){return}}r.tagClass("-"+((
/*xui.browser.fakeTouch &&*/
xui.browser.deviceType!="touchOnly")&&n=="mouseover"?"hover":n=="mousedown"?"active":n))}else{if(n=="mouseup"){if(x.$beforeClick&&false==x.$beforeClick(x,G,E,q,"mouseup")){return}if(s.disableClickEffect){return}if(x.beforeClickEffect&&false===C.beforeClickEffect(x,G,E,q,"mouseup")){return}r.tagClass("-active",false)}else{if(x.$beforeHover&&false==x.$beforeHover(x,G,E,q,"mouseout")){return}if(s.disableHoverEffect===true){return}if(s.disableHoverEffect&&(new RegExp("\\b"+x.getKey(q,true)+"\\b")).test(s.disableHoverEffect||"")){return}if(x.beforeHoverEffect&&false===C.beforeHoverEffect(x,G,E,q,"mouseout")){return}r.tagClass("(-hover|-active)",false)}}}if(D&&D.length){xui.arr.each(D,function(I){xui.tryF(I,[x],x)});D.length=0}};return m}),b={},c;if(!xui.SC.get("xui.absContainer")){xui.Class("xui.absContainer","xui.absObj",{Instance:{addPanel:function(m,o,q){var r=xui.clone(xui.UI.Panel.$DataStruct,true);xui.merge(r,m,"with");xui.merge(r,{dock:"fill",tag:m.tag||m.id},"all");var n=new xui.UI.Panel(r),f=[];this.append(n,q&&q.id);xui.arr.each(o,function(s){f.push(s[0])});n.append(xui.UI.pack(f,false));return this},removePanel:function(){this.destroy(true)},getPanelPara:function(){return xui.clone(this.get(0).properties,true)},dumpContainer:function(f,m){return this.each(function(r){var u=r.box.$DataModel,A=u.valueSeparator||";",q=r.properties,B="items" in q,x,o,w,n;if(!B){if(n=r.boxing().getContainer()){n.html("",true,false,m)}}else{xui.arr.each(q.items,function(s){o=s.id;if(!f||f===true){x=1}else{w=xui.isArr(f)?f:(f+"").split(A);x=xui.arr.indexOf(w,o)!=-1}if(x){if(n=r.boxing().getContainer(o)){n.html("",true,false,m)}}})}})},getPanelChildren:function(){return this.get(0).children},getFormValues:function(n,m,o,r,f){var q={};this.getFormElements(false,m,o).each(function(A){var B=A.properties,u=B.name||A.alias,x,s=A.boxing(),w=s.getUIValue();if(!n||(w+" ")!==(s.getValue()+" ")){if(s.getCaption&&(r||f)){if(f&&u.indexOf(":")!=-1){x=u.split(":")}if(x&&x[0]&&x[1]){q[x[0]]=w;q[x[1]]=s.getCaption()}else{if(r){q[u]={value:w,caption:s.getCaption()}}else{q[u]=w}}}else{if(!q[u.split(":")[0]]){q[u.split(":")[0]]=w}else{q[u.split(":")[0]]=w}}}});return q},setFormValues:function(f,m,n){if(!xui.isEmpty(f)){this.getFormElements(false,m,n).each(function(x){var A=x.properties,r=x.boxing(),u=A.name||x.alias,w,s;if(typeof(r.setCaption)=="function"&&u.indexOf(":")!=-1){w=u.split(":");if(w&&w[0]&&w[1]){u=w[0];s=w[1]}}var q=f[u],o=xui.isHash(q);if("value" in A&&u in f){r.setValue((o&&("value" in q))?q.value:q,true,"form")}if(typeof(r.setCaption)=="function"){if(s in f){r.setCaption(f[s],null,true,"form")}else{if(o&&("caption" in q)){r.setCaption(q.caption,null,true,"form")}}}})}return this},getFormElements:function(s,q,u){var m=this.getChildren(q,u!==false),n=xui.absValue.pack(m);xui.filter(n._nodes,function(w){return w.box._isFormField?w.box._isFormField(w):!!xui.get(w,["properties","isFormField"])});if(s){var f=[],o,r;n.each(function(w,x){o=w.boxing();if((o.getUIValue()+" ")!==(o.getValue()+" ")){f.push(w)}});return xui.absValue.pack(f)}return n},isDirtied:function(o,s){var m=this.getFormElements(false,o,s).get();for(var q=0,f=m.length;q<f;q++){var r=m[q],n;if(r.box["xui.absValue"]){n=r.boxing();if((n.getUIValue()+" ")!==(n.getValue()+" ")){return true}}}return false},checkValid:function(n,m,r){var q=this,o=q.get(0),f=true;if(!q.checkRequired(n,m,r)){return false}q.getFormElements(false,m,r).each(function(u){var w=u.properties,s=u.boxing();if(!s.checkValid(n,m,r)){if(!n){if(!o.beforeInputAlert||false!==o.boxing().beforeInputAlert(o,u,"invalid")){xui.alert("$inline.invalid",xui.getRes("$inline.invalid2")+(w.labelCaption?(" : "+w.labelCaption):w.name),function(){if(u&&u.renderId){s.activate()}})}return f=false}f=false}});return f},checkRequired:function(n,m,q){var o=this.get(0),f=true;this.getFormElements(false,m,q).each(function(u,s){var w=u.properties,r=u.boxing();if(w.required&&(!(s=r.getUIValue()))&&s!==0){if(!n){if(!o.beforeInputAlert||false!==o.boxing().beforeInputAlert(o,u,"required")){xui.alert("$inline.required",xui.getRes("$inline.required2")+(w.labelCaption?(" : "+w.labelCaption):""),function(){if(u&&u.renderId){r.activate()}})}return f=false}f=false}});return f},formClear:function(f,m){return this.each(function(n){n.boxing().getFormElements(false,f,m).resetValue(null)})},formReset:function(f,m){return this.each(function(o){var q=o.properties,n=o.boxing().getFormElements(false,f,m);if(o.beforeFormReset&&false===o.boxing().beforeFormReset(o,n,f,m)){return}n.each(function(s,r){if((r=s.properties.value)!==s.properties.$UIvalue){s.boxing().resetValue(r)}});if(o.afterFormReset){o.boxing().afterFormReset(o,n,f,m)}})},updateFormValues:function(f,m){this.getFormElements(false,f,m).updateValue()},formSubmit:function(x,m,u,B,q){var A=this;if(!x&&!A.checkValid(false,m,u)){return}var r=A.get(0),o=r.properties,w,s=A.getFormValues(false,m,u,B,q),n;if(r.beforeFormSubmit&&false===r.boxing().beforeFormSubmit(r,s,m,u,B,q)){return}if(o.formTarget=="Alert"){s=xui.stringify(s);if(xui.Coder&&xui.Coder.formatText){s=xui.Coder.formatText(s)}alert(s)}else{if(/^\s*\{[^}]+\}\s*$/.test(o.formTarget)){w=xui.adjustVar(o.formTarget);w(s)}else{if(/^((\s*function\s*([\w$]+\s*)?\(\s*([\w$\s,]*)\s*\)\s*)(\{([^\{\}]*)\}))\s*$/.test(o.formTarget)){if(w=xui.unserialize(o.formTarget)){w(s)}}else{if(xui.APICaller&&xui.arr.indexOf(["_blank","_self","_parent","_top"],o.formTarget)==-1){n=xui.APICaller.getFromName(o.formTarget)}if(n){n.setQueryData(s,o.formDataPath);n.invoke()}else{xui.Dom.submit(o.formAction,s,o.formMethod,o.formTarget,o.formEnctype)}}}}A.getFormElements(dirtiedOnly,m,u).updateValue();if(r.afterFormSubmit){r.boxing().afterFormSubmit(r,s,m,u,B,q)}},_e1:function(m,n,o,q,f){},_e2:function(m,f,n,o){},_e3:function(m,n,f,o){},_e4:function(m,q,r,f,o,n){},_e5:function(f,m,n){},_e6:function(n,f,m){},_e7:function(n,f,m){},_e8:function(m,n,f){}},Static:{$abstract:true,DataModel:{dragKey:"",dropKeys:"",overflow:{ini:xui.browser.deviceType=="touchOnly"?"auto":undefined,combobox:["","visible","hidden","scroll","auto","overflow-x:hidden;overflow-y:auto","overflow-x:auto;overflow-y:hidden"],action:function(f){var m=this;xui.arr.each(m.box.$Behaviors.PanelKeys,function(n){var o=m.getSubNode(n,true);if(f){if(f.indexOf(":")!=-1){xui.arr.each(f.split(/\s*;\s*/g),function(r){var q=r.split(/\s*:\s*/g);if(q.length>1){o.css(xui.str.trim(q[0]),xui.str.trim(q[1]||""))}});return}}o.css("overflow",f||"")})}},panelBgClr:{type:"color",ini:"",action:function(f){var m=this;xui.arr.each(m.box.$Behaviors.PanelKeys,function(n){m.getSubNode(n,true).css("background-color",f)})}},panelBgImg:{format:"image",ini:"",action:function(f){var m=this;xui.arr.each(m.box.$Behaviors.PanelKeys,function(n){m.getSubNode(n,true).css("background-image",f?("url("+xui.adjustRes(f||"")+")"):"")})}},panelBgImgPos:{ini:"",combobox:["","top left","top center","top right","center left","center center","center right","bottom left","bottom center","bottom right","0% 0%","-0px -0px"],action:function(f){var m=this;xui.arr.each(m.box.$Behaviors.PanelKeys,function(n){m.getSubNode(n,true).css("background-position",f)})}},panelBgImgRepeat:{ini:"",combobox:["","repeat","repeat-x","repeat-y","no-repeat"],action:function(f){var m=this;xui.arr.each(m.box.$Behaviors.PanelKeys,function(n){m.getSubNode(n,true).css("background-repeat",f)})}},panelBgImgAttachment:{ini:"",combobox:["","scroll","fixed"],action:function(f){var m=this;xui.arr.each(m.box.$Behaviors.PanelKeys,function(n){m.getSubNode(n,true).css("background-attachment",f)})}},conLayoutColumns:{ini:0,action:function(){this.adjustSize()}},conDockRelative:{hidden:true,ini:false,get:function(){return this.boxing().getConLayoutColumns()},set:function(f){return this.boxing().setConLayoutColumns(f?1:0)}},conDockPadding:{ini:{left:0,top:0,right:0,bottom:0},action:function(){this.boxing().adjustDock(true)}},conDockSpacing:{ini:{width:0,height:0},action:function(){this.boxing().adjustDock(true)}},conDockFlexFill:{ini:"",combobox:["none","width","height","both"],action:function(){this.boxing().adjustDock(true)}},conDockStretch:{ini:"",combobox:["fixed","forward","rearward","stretch","0.25","0.33","0.5","0.25,0.5,0.25"],action:function(){this.boxing().adjustDock(true)}},sandboxTheme:{ini:"",action:function(m,o,q,n,f){xui.UI._refreshSBTheme(this,m,n,f)}},formMethod:{ini:"get",listbox:["get","post"]},formTarget:{ini:"Alert",combobox:["Alert","_blank","_self","_parent","_top","[framename]","[APICaller]","function(d){xui.log(d)}"]},formDataPath:"",formAction:"",formEnctype:{ini:"application/x-www-form-urlencoded",listbox:["application/x-www-form-urlencoded","multipart/form-data","text/plain"]},readonly:{ini:false,action:function(f){this.boxing().getChildren().each(function(n){var m=n.boxing();if(typeof m.setReadonly=="function"){m.setReadonly(f||false)}else{if(typeof m.setDisabled=="function"){m.setDisabled(f||false)}}})}}}}})}var l=xui.absContainer.prototype;if(j.HoverEffected){xui.each(j.HoverEffected,function(m,f){c=g[f]?j:(j[f]||(j[f]={}));if(!m){c.afterMouseover=c.afterMouseout=null}else{c.afterMouseover=e(m,"mouseover",1);c.afterMouseout=e(m,"mouseout",2)}});b.beforeHoverEffect=l._e1}if(j.ClickEffected){xui.each(j.ClickEffected,function(m,f){c=g[f]?j:(j[f]||(j[f]={}));if(!m){c.afterMousedown=c.afterMouseup=null}else{c.afterMousedown=e(m,"mousedown",1);c.afterMouseup=e(m,"mouseup",2)}});b.beforeClickEffect=l._e1}if(j.HotKeyAllowed){xui.merge(j,{beforeKeydown:function(f,m,n){if(f.onHotKeydown){return false!==f.boxing().onHotKeydown(f,xui.Event.getKey(m),m,n)}},beforeKeypress:function(f,m,n){if(f.onHotKeypress){return false!==f.boxing().onHotKeypress(f,xui.Event.getKey(m),m,n)}},beforeKeyup:function(f,m,n){if(f.onHotKeyup){return false!==f.boxing().onHotKeyup(f,xui.Event.getKey(m),m,n)}}});b.onHotKeydown=b.onHotKeypress=b.onHotKeyup=l._e2}if(j.NavKeys){xui.each(j.NavKeys,function(m,q){var f=arguments.callee,n,x=f.m1||(f.m1={KEY:1,$key:1});if(x[q]){return}var u=f.m2||(f.m2={input:1,textarea:1}),s=f.m3||(f.m3={tab:1,enter:1,up:1,down:1,left:1,right:1}),r=f.m4||(f.m4={tab:1,up:1,down:1,left:1,right:1}),w=j[q]||(j[q]={});var w=j[q]||(j[q]={});if(null===m){w.afterKeydown=null}else{w.afterKeydown=function(F,J,A){var G=xui.Event.getKey(J),L=G.key,B=G.ctrlKey,D=G.shiftKey,I=G.altKey,K=false,o=F._smartnav;if(o){var E=xui.use(A).get(0);if(u[G=E.tagName.toLowerCase()]){if(L&&G=="input"&&E.type.toLowerCase()!="text"&&E.type.toLowerCase()!="password"){K=true}else{if(s[L]){var C=xui.use(A).caret(),H=xui.use(A).get(0).value;switch(L){case"up":if(!/[\n\r]/.test(H.substr(0,C[0]))){K=true}break;case"left":if(!D&&(B||(C[0]===0&&(C[1]!==H.length||C[1]===0)))){K=true}break;case"down":if(!/[\n\r]/.test(H.substr(C[1],H.length))){K=true}break;case"right":if(!D&&(B||(C[1]===H.length&&(C[0]!==0||C[1]===0)))){K=true}break;case"enter":if(G=="input"||I){K=true}break;case"tab":K=true;break}}}}else{if(r[L]){K=true}}E=null}else{K=L==="tab"}if(K){if(F.beforeNextFocus&&false===F.boxing().beforeNextFocus(F,J,G.shiftKey,A)){switch(G.key){case"tab":case"enter":if(F.onHotKeydown){F.boxing().onHotKeydown(F,xui.Event.getKey(J),J,A)}case"esc":if(F.onHotKeyup){F.boxing().onHotKeyup(F,xui.Event.getKey(J),J,A)}break}return false}if(o){if(L!="tab"){xui.use(A).nextFocus(("up"==L||"left"==L)?false:true)}}}}}});b.beforeNextFocus=l._e3}if((c=j.DroppableKeys)&&c.length){xui.arr.each(c,function(f){a._droppable(f)});c=a.prototype;xui.arr.each("getDropKeys,setDropKeys".split(","),function(f){if(!c[f]){c[f]=l[f]}});if(j.PanelKeys){xui.arr.each("addPanel,removePanel,dumpContainer,getPanelPara,getPanelChildren,getFormValues,setFormValues,getFormElements,isDirtied,checkValid,checkRequired,formClear,formReset,updateFormValues,formSubmit".split(","),function(f){if(!c[f]){c[f]=l[f]}})}a.$DataModel.dropKeys=a.$DataStruct.dropKeys="";b.onDragEnter=b.onDragLeave=b.beforeDrop=b.onDrop=b.afterDrop=b.onDropTest=b.onDropMarkShow=b.onDropMarkClear=l._e4}if((c=j.DraggableKeys)&&c.length){xui.arr.each(c,function(f){a._draggable(f)});c=a.prototype;xui.arr.each("getDragKey,setDragKey".split(","),function(f){if(!c[f]){c[f]=l[f]}});a.$DataModel.dragKey=a.$DataStruct.dragKey="";b.onGetDragData=b.onStartDrag=b.onDragStop=l._e5}if((c=j.NoDraggableKeys)&&c.length){a.NoDraggableKeys=c}if((c=j.NoDroppableKeys)&&c.length){a.NoDroppableKeys=c}if((c=j.PanelKeys)&&c.length){xui.each(j.PanelKeys,function(f){c=g[f]?j:(j[f]||(j[f]={}));c.onMousewheel=function(m,o,q){var s=xui.use(q).id(),r=m.getSubId(s),n=m.SubSerialIdMapItem&&m.SubSerialIdMapItem[r];if(m.onMousewheel){return m.boxing().onMousewheel(m,xui.Event.getWheelDelta(o),n,o,q)}}});c=a.prototype;xui.arr.each("overflow,panelBgClr,panelBgImg,panelBgImgPos,panelBgImgRepeat,panelBgImgAttachment,conDockRelative,conLayoutColumns,conDockPadding,conDockSpacing,conDockFlexFill,conDockStretch,sandboxTheme,formMethod,formTarget,formDataPath,formAction,formEnctype,readonly".split(","),function(q){var n="get"+xui.str.initial(q),m;if(!c[n]){c[n]=l[n]}n="set"+xui.str.initial(q);if(!c[n]){c[n]=l[n]}m=xui.absContainer.$DataModel[q];if(!(a._NoProp&&a._NoProp[q])){a.$DataStruct[q]=xui.isSet(m.ini)?xui.copy(m.ini):"";a.$DataModel[q]=xui.copy(m)}});xui.merge(b,xui.absContainer.$EventHandlers);b.beforeInputAlert=l._e6;b.beforeFormReset=b.afterFormReset=l._e7;b.beforeFormSubmit=b.afterFormSubmit=l._e8;b.onMousewheel=function(f,q,m,n,o){};a["xui.absContainer"]=true}a.setEventHandlers(b);a.$RenderTrigger=a.$RenderTrigger||[];a.$RenderTrigger.push(function(){if(this.properties.readonly){this.boxing().setReadonly(true,true)}})},addTemplateKeys:function(a){var b=this,c=b.KEY,e=arguments.callee,d=e._reg||(e._reg=/\./g);xui.arr.each(a,function(f){b.$cssKeys[f]=(b.$Keys[f]=f=="KEY"?c:c+"-"+f).replace(d,"-").toLowerCase().replace("xui-ui","xui")});return b},_refreshSBTheme:function(c,f,n,j,g){var e=c.getDomId(),a=e+"sandboxtheme",m=this._getThemePrevId(c),b=xui(a).get(0),d=function(o){if(c.destroyed){return}xui.CSS._appendSS(c.getRootNode(),xui.UI._adjustCSS(o,m,n),a,true);if(g||c.$inDesign){c.boxing().reLayout(true).getChildren(true,"penetrate").reLayout(true)}};if(b){b.disabled=true;xui(a).remove(false)}if(f){if(/^[a-zA-Z-]+$/.test(f+"")&&(f+"")!=="default"){var l=xui.getPath("xui.appearance."+f,"");xui.getFileAsync(l+"theme.css",function(o){d(o.replace(/\.setting-uikey\{[^}]+\}/,"").replace(/url\(([^)]+)\)/g,"url("+l+"$1)"));xui.tryF(j,[c,f])})}else{d(f+"")}}},_getThemePrevId:function(a){return a?"#"+(a["xui.UIProfile"]?a.getDomId():a).replace(/([.:])/g,"\\$1"):""},_adjustCSS:function(b,c,a){c=c||"";if(a){b=xui.replace(b,[[/(\/\*[^*]*\*+([^\/][^*]*\*+)*\/)/,"$0"],[/\{[^}]*\}/,"$0"],[/([^\/{},]+)/,function(d){return d[0].replace(/([^\s>]+)/,"$1"+a)}]])}return b.replace(/(\/\*[^*]*\*+([^\/][^*]*\*+)*\/)/g,"").replace(/^\s*(\.)/,function(e,d){return c+" "+d}).replace(/([},])\s*(\.)/g,function(e,d,f){return d+"\n"+c+" "+f}).replace(/([{;])\s*(.)/g,function(e,d,f){return d+"\n"+(f=="}"?"":"    ")+f}).replace(/url\(([^)]+)\)/g,function(e,d){return"url("+xui.adjustRes(d,0,1)+")"})},setAppearance:function(a){xui.merge(this.$Appearances,a,"all");return this},getAppearance:function(){return this.$Appearances},setTemplate:function(d,q){if(d){var o=this,m=o.$tagName||(o.$tagName={}),l=arguments.callee,a=l.r2||(l.r2=/[a-z]/),g=xui.absObj.$specialChars,e=["KEY"],f=l._fun||(l._fun=function(u,r,j){var w,s;for(s in u){if(!g[s.charAt(0)]){if(!a.test(s)){r[r.length]=s;w=u[s];if(w&&typeof w=="object"){j[s]=w.tagName||"";arguments.callee(w,r,j)}}}}}),n;m.KEY=d.tagName||"";f(d,e,m);o.addTemplateKeys(e);n=o.$Templates;if(typeof q=="string"){d._subid=q;n[q]=d}else{n._=d}if(n=d.$submap){for(var c in n){for(var b in n[c]){l.call(o,n[c],b)}}}}return this},getTemplate:function(a){return this.$Templates[a||"_"]},setBehavior:function(b){if(b){var n=this,g=xui.$cache.UIKeyMapEvents,c=n.$key,C=xui.absObj.$specialChars,x=xui.Event,a=x.$eventhandler,e=x._eventMap,D=arguments.callee,B=D.r1||(D.r1=/[a-z]/),w=D.r2||(D.r2=/^(on|before|after)/),l=n.$Behaviors,r,A,u,s,q,f,d;xui.filter(g,function(m,j){return !(j==c||j.indexOf(c+"-")==0)});n._setDefaultBehavior(b);if(b.KEY){xui.merge(b,b.KEY,"all");delete b.KEY}for(A in b){q=b[A];if(!C[A.charAt(0)]){if(!B.test(A)){r=l[A]||(l[A]={});for(u in q){f=q[u];if(!C[u.charAt(0)]){if(f){r[u]=f}else{delete r[u]}}}}else{if(w.test(A)){if(q){l[A]=q}else{delete l[A]}}else{l[A]=q}}}}for(A in l){q=l[A];if(!C[A.charAt(0)]){if(!B.test(A)){for(u in q){if(!C[u.charAt(0)]&&q[u]){s=c+"-"+A;g[s]=g[s]||{};g[s]["on"+e[u]]=g[s]["on"+e[u]]||a}}}else{if(w.test(A)&&q){s=c;g[s]=g[s]||{};g[s]["on"+e[A]]=g[s]["on"+e[A]]||a}}}}}return n},getBehavior:function(){return this.$Behaviors},$trytoApplyCSS:function(){var e=xui.UI,f=xui.CSS,g="xui.UI-CSS",d=e.$cache_css_before,c=e.$cache_css_after;if(!e.$cssNo){e.$cssNo=1;var a=xui.browser;xui("body").addClass((a.ie?("xui-css-ie xui-css-ie"+a.ver+" "):a.gek?("xui-css-gek xui-css-gek"+a.ver+" "):a.kde?("xui-css-kde xui-css-kde"+a.ver+" "):a.opr?("xui-css-opr xui-css-opr"+a.ver+" "):"")+(a.isSafari?"xui-css-safari ":a.isChrome?"xui-css-chrome ":"")+(a.isMac?"xui-css-mac":a.isLinux?"xui-css-linux ":""));xui("html").addClass("xui-css-base xui-css-viewport xui-uicontainer"+(a.isStrict?" xui-css-strict":""));f.includeLink(xui.ini.path+"iconfont/iconfont.css","xui-font-icon",true)}if(d){f.addStyleSheet(d,g+(e.$cssNo++));e.$cache_css_before=""}if(c){f.addStyleSheet(c,g+(e.$cssNo++),true);e.$cache_css_after=""}},buildCSSText:function(n){var B=this,d=/(^|\s|,)([0-9A-Z_]+)/g,q=[],a=[],s=xui.browser,f=s.ie6,b=s.ie,u=s.gek,w=B.$cssKeys,A,x,c;for(var m in n){if(c=n[m]){A=m.replace(d,function(l,j,o){return j+"."+(w[o]||o)}).toLowerCase();c.$order=parseInt(c.$order,10)||0;c.$=A;q[q.length]=c}}xui.arr.stableSort(q,function(j,l){j=j.$order||0;l=l.$order||0;return j>l?1:j==l?0:-1});for(var m=0,e=q.length;m<e;){c=q[m++];a[a.length]=c.$+"{";if(A=c.$before){a[a.length]=A}if(A=c.$text){a[a.length]=A}for(var g in c){if(g.charAt(0)=="$"){continue}if((x=c[g])||c[g]===0){g=g.replace(/_[0-9]+$/,"");switch(typeof x){case"string":case"number":a[a.length]=g+":"+x+";";break;case"function":a[a.length]=g+":"+x(B.KEY)+";";break;default:xui.arr.each(x,function(j){if(j){a[a.length]=g+":"+j+";"}})}}}if(x=c.$after){a[a.length]=x}a[a.length]="}"}return a.join("")},_prepareCmds:function(j,w,f){var r=this,e=j.properties,d=w.tagCmds||xui.clone(e.tagCmds,true);if(d&&d.length){var g=xui.UI.$tag_subId,s=[],q=[],o;for(var n=0,u=d,m=u.length;n<m;n++){if(typeof u[n]=="string"){o={id:u[n]}}else{o=xui.clone(u[n])}if(f&&xui.isFun(f)){if(!f(o)){continue}}else{if(w.tag&&w.tag.match((new RegExp("\\bno~"+o.id+"\\b")))){continue}}if("id" in o){o.id+=""}else{o.id="cmds"+j.$xid+n}if(o.object){o.object=r._prepareInlineObj(j,o,e.tabindex);o.type="profile"}else{if(!"caption" in o){o.caption=o.id}if(!("tips" in o)){o.tips=o.caption}o.id=o.id.replace(/[^0-9a-zA-Z]/g,"");if(!o.buttonType){o.buttonType="text"}if(!o.tagCmdsAlign){o.tagCmdsAlign="left"}if(!o.itemClass){o.itemClass=o.imageClass}if(!o.pos){o.pos="row"}if(o.caption){o.caption=xui.adjustRes(o.caption)}if(o.tips){o.tips=xui.adjustRes(o.tips)}if(o.image){o.image=xui.adjustRes(o.image)||xui.ini.img_bg}o._style="";if("width" in o){o._style+=o.width+(xui.isFinite(o.width)&&"px")+";"}if("height" in o){o._style+=o.height+(xui.isFinite(o.height)&&"px")+";"}o[g]=(w[g]?w[g]:"")+"_"+o.id}var x=o.location||o.tagCmdsAlign||"right";if(x=="left"){q.push(o)}else{s.push(o);if(x=="right-float"||x=="floatright"){o._exstyle="float:right;"}}}w.ltagCmds=q;w.rtagCmds=s}w._ltagDisplay=w.ltagCmds?"":"display:none";w._rtagDisplay=w.rtagCmds?"":"display:none"},$getTagCmdsTpl:function(b){var a={ltagCmds:function(j,g,f,d,c){var e=f.buttonType||f.type;var l=arguments.callee,m=l._m||(l._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(j,g,f,"tagCmds"+(m[e]||".button"),c)},rtagCmds:function(j,g,f,d,c){var e=f.buttonType||f.type;var l=arguments.callee,m=l._m||(l._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(j,g,f,"tagCmds"+(m[e]||".button"),c)},"tagCmds.text":{CMD:{tagName:"span",title:"{caption}",style:"{_style}{itemStyle}",className:"xui-node xui-tag-cmd {itemClass}",tabindex:"{_tabindex}",text:"{caption}",alt:"{tips}"}},"tagCmds.button":{CMD:{tagName:"button",title:"{caption}",style:"{_style}{itemStyle}",className:"xui-node xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius xui-list-cmd xui-tag-cmd {itemClass}",tabindex:"{_tabindex}",text:"{caption}",alt:"{tips}"}},"tagCmds.image":{CMD:{title:"{caption}",tagName:"image",src:"{image}",border:"0",style:"{_style}{itemStyle}",className:"xui-node xui-tag-cmd {itemClass}",tabindex:"{_tabindex}",alt:"{tips}"}}};return b?a["tagCmds."+b]:a},_droppable:function(d){var b=this,c=xui.Event.$eventhandler,j=b.$Behaviors,a=d=="KEY"?j:(j[d]||(j[d]={})),f=xui.$cache.UIKeyMapEvents,g=d=="KEY"?b.KEY:(b.KEY+"-"+d),e=f[g]||(f[g]={});xui.merge(a,{beforeMouseover:function(o,u,l){var m=o.properties;if(m.disabled||m.readonly){return}if(o.behavior.NoDroppableKeys){var q=o.getKey(xui.Event.getSrc(u).id||"").split("-")[1];if(q&&xui.arr.indexOf(o.behavior.NoDroppableKeys,q)!=-1){return}}var x=l,E,C=xui.DragDrop,n=C.getProfile(),B=n.dragKey,r=n.dragData,A=(E=o.box.$Behaviors.PanelKeys)&&xui.arr.indexOf(E,o.getKey(l,true))!==-1,D,s,w;if(r&&((m.dragSortable&&o.$xid==xui.get(r,["profile","$xid"])&&!A)||(B&&(new RegExp("\\b"+B+"\\b")).test(o.box.getDropKeys(o,x))))){s=o.boxing();if(s.getItemByDom){D=s.getItemByDom(l)}w=[o,u,x,B,r,D];if((E=o.onDropTest)&&(false===s.onDropTest.apply(s,w))){return}if((E=o.box._onDropTest)&&(false===E.apply(o.host||o,w))){return}C.setDropElement(l);if(o.onDropMarkShow&&(false===s.onDropMarkShow.apply(s,w))){}else{if((E=o.box._onDropMarkShow)&&(false===E.apply(o.host||o,w))){}else{xui.resetRun("setDropFace",C.setDropFace,0,[x],C)}}if(E=o.box._onDragEnter){E.apply(o.host||o,w)}if(o.onDragEnter){s.onDragEnter.apply(s,w)}}},beforeMouseout:function(n,r,l){if(n.properties.disabled||n.properties.readonly){return}var w=xui.DragDrop,m=w.getProfile(),u=m.dragKey,o=m.dragData,x,q,s;if(m.dropElement==l){q=n.boxing();if(q.getItemByDom){x=q.getItemByDom(l)}s=[n,r,l,u,o,x];if(n.onDropMarkClear&&(false===q.onDropMarkClear.apply(q,s))){}else{if((t=n.box._onDropMarkClear)&&(false===t.apply(n.host||n,s))){}else{xui.resetRun("setDropFace",w.setDropFace,0,[null],xui.DragDrop)}}if(t=n.box._onDragLeave){t.apply(n.host||n,s)}if(n.onDragLeave){q.onDragLeave.apply(q,s)}w.setDropElement(null)}},beforeDrop:function(n,r,l){var w=xui.DragDrop,m=w.getProfile(),u=m.dragKey,o=m.dragData,A,x,s,q=n.boxing();if(q.getItemByDom){A=q.getItemByDom(l)}s=[n,r,l,u,o,A];if(n.onDropMarkClear&&(false===q.onDropMarkClear.apply(q,s))){}else{if((x=n.box._onDropMarkClear)&&(false===x.apply(n.host||n,s))){}}if(n.beforeDrop&&(false===q.beforeDrop.apply(q,s))){return}if(!n.onDrop||(n.onDrop&&false===q.onDrop.apply(q,s))){if(n.box._onDrop){n.box._onDrop.apply(n.host||n,s)}}if(n.afterDrop){q.afterDrop.apply(q,s)}}},"all");xui.merge(e,{onmouseover:c,onmouseout:c,ondrop:c,afterDrop:c,beforeDrop:c});return b},_draggable:function(d){var b=this,c=xui.Event.$eventhandler,j=b.$Behaviors,a=d=="KEY"?j:(j[d]||(j[d]={})),f=xui.$cache.UIKeyMapEvents,g=d=="KEY"?b.KEY:(b.KEY+"-"+d),e=f[g]||(f[g]={});xui.merge(a,{beforeMousedown:function(o,s,l){if(xui.Event.getBtn(s)!="left"){return}var m=o.properties;if(m.disabled){return}if(!(m.dragSortable||m.dragKey)){return}if(o.behavior.NoDraggableKeys){var q=o.getKey(xui.Event.getSrc(s).id||"").split("-")[1];if(q&&xui.arr.indexOf(o.behavior.NoDraggableKeys,q)!=-1){return}}var w=xui.Event.getPos(s),r=o.boxing(),u=[o,s,l],x;if(o.onStartDrag&&(false===r.onStartDrag.apply(r,u))){}else{if((x=o.box._onStartDrag)&&(false===x.apply(o.host||o,u))){}else{var n=o.box;xui.use(l).startDrag(s,{dragType:"icon",targetLeft:w.left+12,targetTop:w.top+12,dragCursor:"pointer",dragDefer:2,dragKey:n.getDragKey(o,l),dragData:n.getDragData(o,s,l)})}}},beforeDragbegin:function(l,m,n){xui.use(n).onMouseout(true,{$force:true}).onMouseup(true)},beforeDragstop:function(m,n,o){var l;if(m.onDragStop){m.boxing().onDragStop(m.e,o)}if(l=m.box._onDragStop){l.apply(m.host||m,arguments)}}},"all");xui.merge(e,{onmousedown:c,ondragbegin:c});return b},_adjustConW:function(d,o,q,a){var b=d.properties,m,j;if(!(m=b.conLayoutColumns)){m=b.conDockRelative?1:0}if(!m){return}j=d._containerWidth=o.scrollWidth();if(a&&a==j){return}var G=b.conDockPadding,s=b.conDockSpacing,I=o.children(),A=I.size(),K,r,g,J,e=0,L,H=0,B=[],f=function(T,V,N){var S=V.length,U=Math.floor(T/S),c=0,l,Q,M,w,O,R;for(var P=0;P<S;P++){w=V[P][0];M=V[P][1];O=V[P][2];R=V[P][3];if(P==S-1){Q=M.$forceu(Math.min(R,Math.max(O,T-c)))}else{Q=M.$forceu(l=Math.min(R,Math.max(O,U)));c+=l}N.push([w,M,Q,l])}};if(!A){return}I.each(function(M,c,l,w){if(M.id&&(l=xui.$cache.profileMap[M.id])&&l.Class&&l.Class["xui.UIProfile"]){w=xui(M).css("position");if(w=="relative"||w=="static"){xui(M).setInlineBlock()}}});K=G.left+G.right+(m-1)*s.width;r=j-K;g=Math.floor(r/m);var n,D=[],x,F;I.each(function(N,c,l,w,M){if(N.id&&(l=xui.$cache.profileMap[N.id])&&l.Class&&l.Class["xui.UIProfile"]){n=xui(N);w=n.css("position");if(w=="relative"||w=="static"){if(l){n.css({position:"relative",left:"auto",top:"auto",right:"auto",bottom:"auto","margin-left":(c===0?G.left:s.width)+"px","margin-top":(c===0?G.top:s.height)+"px"});x=xui.CSS.$px(l.properties.dockMinW)||0;F=xui.CSS.$px(l.properties.dockMaxW)||(r+K);L=l.$forceu(M=Math.min(F,Math.max(x,g)));H+=M;if(H>r){f(r+(m-D.length)*s.width,D,B);D=[];H=M}D.push([n,l,x,F])}}}});if(D.length){f(r+(m-D.length)*s.width,D,B)}for(var E=0,A=B.length;E<A;E++){var u=B[E][0];u.width(B[E][1].properties.width=B[E][2]);B[E][1]._conLayout=1}var C=function(l,c){if(l.destroyed||!l._containerWidth||c.isEmpty()){return}if(l._containerWidth!=c.scrollWidth()){xui.UI._adjustConW(l,c,l,l._containerWidth)}};C(d,o);xui.asyRun(C,0,[d,o])},adjustData:function(c,n,l,m){if(!l){l={}}var f=c.box,g=f.$DataModel,d,b;for(d in n){if(d.charAt(0)=="$"||d=="renderer"){continue}if(n.hasOwnProperty(d)&&!l.hasOwnProperty(d)){l[d]=typeof(b=n[d])=="string"?d=="html"?xui.adjustRes(b,0,1,false,null,null,m=="sub"&&n):xui.adjustRes(b,true,false,null,null,m=="sub"&&n):b}}if("hidden" in n){l.hidden=n.hidden}var j=n.itemFilter||c.$itemFilter;if(j){l.hidden=!!j(n,"prepareItem",c)}l._itemDisplay=n.hidden?"display:none;":"";if("disabled" in g){l.disabled=(xui.isSet(l.disabled)&&l.disabled)?"xui-ui-itemdisabled":""}if("readonly" in g){l.readonly=(xui.isSet(l.readonly)&&l.readonly)?"xui-ui-itemreadonly":""}l.imageDisplay=(l.imageClass||l.image||l.iconFontCode)?"":"display:none";var a;if(l.iconFontCode){if(l.imageClass){var e=l.imageClass.split(/\s+/);xui.filter(e,function(o){return !xui.builtinFontIcon[o]});l.imageClass=e.join(" ")}}else{if(l.imageClass){var e=l.imageClass.split(/\s+/);xui.arr.each(e,function(o){if(xui.builtinFontIcon[o]){a=xui.builtinFontIcon[o];return}},null,true);if(a&&xui.__iefix2){l.iconFontCode=a;xui.filter(e,function(o){return !xui.builtinFontIcon[o]})}l.imageClass=e.join(" ")}if(!a){l.picClass="xui-css-innerimage";if(l.image){l.imageClass="xui-icon-placeholder";l.backgroundImage="background-image:url("+l.image+");"}if(l.imagePos){l.backgroundPosition="background-position:"+l.imagePos+";"}else{if(l.image){l.backgroundPosition="background-position:center;"}}if(l.imageBgSize){l.backgroundSize="background-size:"+l.imageBgSize+";"}else{if(l.image){l.backgroundSize="background-size:initial;"}}if(l.imageRepeat){l.backgroundRepeat="background-repeat:"+l.imageRepeat+";"}else{if(l.image){l.backgroundRepeat="background-repeat:no-repeat;"}}}}if(l.iconFontSize){l.iconFontSize="font-size:"+l.iconFontSize+";"}if(!l.image&&f.IMGNODE){l.image=xui.ini.img_blank}if(b=l.renderer||n.renderer){l.caption=xui.UI._applyRenderer(c,b,n,l)}return l},_applyRenderer:function(e,m,n,l){if(xui.isFun(m)){return xui.adjustRes(m.call(e,n,l))}else{if(xui.isStr(m)){var g,d,j,a={},q={},o,c=/^\s*[a-zA-Z]+([\w]+\.?)+[\w]+\s*$/,f=function(u,w,r){if(u){var s=/^\s*([^>\s]+)?\s*>\s*([^>\s]+)\s*$/;xui.each(u,function(A,x){if(s.test(x)){w[x.replace(/^\s*>\s*/,"")]=A}});if(xui.isHash(u.ModuleProp)){w=xui.merge(w,u.ModuleProp,"all")}if(xui.isHash(u.ModuleEvents)){r=xui.merge(r,u.ModuleEvents,"all")}}};if(c.test(m)&&(g=xui.SC.get(m))){if(g["xui.UI"]||g["xui.Module"]){g=new g();d=g.get(0);j=xui.get(l,["tagVar","alias"])||d.alias;if(n){n._render_xid=d.$xid;n._render_obj=d;d._render_conf=n}d._render_holder=e;if(g["xui.Module"]){var b=(new xui.UI.MoudluePlaceHolder());d=b.get(0);d._module=g;g=b}else{if(g.setPosition){g.setPosition("relative")}if(g.setDisplay){g.setDisplay("inline-block")}}g.setHost(e.host,j);if(n!==e.properties){if(o=e.box._applyRendererEx){o.call(e.box,e,a,q,l,f)}f(l,a,q)}f(l.tagVar,a,q);delete a.renderer;if(!xui.isEmpty(a)){g.setProperties(a)}if(!xui.isEmpty(q)){g.setEvents(q)}(e.$attached||(e.$attached=[])).push(d);return g.toHtml()}}return xui.adjustVar(m,l)}}},$iconAction:function(f,c,e){var j=f.properties,d=f.getSubNode(c||"ICON"),g=(j.imageClass||j.image||j.iconFontCode)?"":"display:none",b;d.css("backgroundImage","none");d.removeClass("xui-icon-placeholder");if(j.imageClass){d.removeClass(j.imageClass)}if(e){d.removeClass(e)}d.html("");if(j.iconFontCode){d.html(j.iconFontCode);if(j.imageClass){var a=j.imageClass.split(/\s+/);xui.filter(a,function(l){return !xui.builtinFontIcon[l]});d.addClass(a.join(" "))}}else{if(j.imageClass){var a=j.imageClass.split(/\s+/);xui.arr.each(a,function(l){if(xui.builtinFontIcon[l]){b=xui.builtinFontIcon[l];return}},null,true);if(b&&xui.__iefix2){j.iconFontCode=b;xui.filter(a,function(l){return !xui.builtinFontIcon[l]})}d.addClass(a.join(" "))}if(j.iconFontCode){d.html(j.iconFontCode)}if(!b){if(j.image){d.addClass("xui-icon-placeholder");d.css("backgroundImage","url("+xui.adjustRes(j.image)+")")}}}d.css("display",g)},cacheData:function(a,b){xui.set(xui.$cache,["UIDATA",a],b);return this},getCachedData:function(a){var b=xui.get(xui.$cache,["UIDATA",a]);if(typeof b=="function"){b=b()}return b},Behaviors:{onSize:function(c,d){var a=c.getRootNode(),b=a&&a.style;if(b&&(d.width||d.height)){xui.UI.$tryResize(c,b.width,b.height)}},HotKeyAllowed:true,onContextmenu:function(a,b,c){if(a.onContextmenu){return a.boxing().onContextmenu(a,b,c,null,xui.Event.getPos(b))!==false}}},DataModel:{autoTips:true,className:{ini:"",action:function(a,b){if(b){this.getRoot().removeClass(b)}this.getRoot().addClass(a);delete this._nodeEmSize}},disableClickEffect:false,disableHoverEffect:false,disableTips:false,disabled:{ini:false,action:function(a){var b=this.getRoot();if(a){b.addClass("xui-ui-disabled")}else{b.removeClass("xui-ui-disabled")}}},spaceUnit:{listbox:["","px","em"],action:function(){this.boxing().reLayout(true).getChildren(true,"penetrate").reLayout(true)}},defaultFocus:false,hoverPop:{ini:"",action:function(c,e){var f=this,a=f.boxing(),g=f.properties,d;if(!f.destroyed&&f.host){if(e&&(d=f.host[e])&&(d=d.get(0))&&d.renderId&&!d.destroyed){a.hoverPop(d,null)}if(c&&(d=f.host[c])&&(d=d.get(0))&&d.renderId&&!d.destroyed){a.hoverPop(d,g.hoverPopType,function(){d.properties.tagVar.hoverFrom=arguments},function(){delete d.properties.tagVar.hoverFrom},d.getRoot().parent(),c)}}}},hoverPopType:{ini:"outer",dftWidth:180,listbox:["outer","inner","outerleft-outertop","left-outertop","center-outertop","right-outertop","outerright-outertop","outerleft-top","left-top","center-top","right-top","outerright-top","outerleft-middle","left-middle","center-middle","right-middle","outerright-middle","outerleft-bottom","left-bottom","center-bottom","right-bottom","outerright-bottom","outerleft-outerbottom","left-outerbottom","center-outerbottom","right-outerbottom","outerright-outerbottom"]},locked:{ini:false,action:function(){if(this.$inDesign){this.boxing().refresh(true)}}},dock:{ini:"none",listbox:["none","top","bottom","left","right","center","middle","origin","width","height","fill","cover"],action:function(a){xui.UI.$dock(this,true,true)}},dockIgnore:{ini:false,action:function(b){var a=this;if(a.properties.dock!="none"){xui.UI.$dock(a,true,true)}}},dockFloat:{ini:false,action:function(b){var a=this;if(a.properties.dock!="none"){xui.UI.$dock(a,true,true)}}},dockOrder:{hidden:true},showEffects:"",hideEffects:"",dockMargin:{ini:{left:0,top:0,right:0,bottom:0},action:function(b){var a=this;b=b||{};b.left=b.left||0;b.top=b.top||0;b.right=b.right||0;b.bottom=b.bottom||0;if(a.properties.dock!="none"){xui.UI.$dock(a,true,true)}}},dockMinW:{$spaceunit:1,ini:0},dockMinH:{$spaceunit:1,ini:0},dockMaxW:{$spaceunit:1,ini:0},dockMaxH:{$spaceunit:1,ini:0},dockIgnoreFlexFill:{ini:false,action:function(b){var a=this;if(a.properties.dock!="none"){xui.UI.$dock(a,true,true)}}},dockStretch:{ini:"",combobox:["fixed","forward","rearward","stretch","0.25","0.33","0.5"],set:function(b){var c=this,a=c.properties;a.dockStretch=b;if(a.dock=="fill"||a.dock=="cover"||a.dock=="width"||a.dock=="height"){if(b!="forward"&&b!="rearward"&&b!="stretch"){a.dockStretch="stretch"}}if(c.rendered&&a.dock!="none"){xui.UI.$dock(c,true,true)}}},tips:{ini:"",action:function(a){var b=xui.Tips;if(b&&b._showed){if(xui.UIProfile.getFromDom(b._markId)==this){b.setTips(a,true)}}}},rotate:{ini:0,action:function(b){var a=this.getRoot(),c=this.boxing();b=parseFloat(b)||0;b=b%360;if(b<0){b=b+360}if(this.box["xui.svg"]){c.setAttr("KEY",{transform:"r"+b},false)}else{a.rotate(b)}}},activeAnim:{ini:"",action:function(c){var d=this,a,b;if(a=d._activeAnim){xui.Thread.abort(a);delete d._activeAnim}if(c){d._activeAnim=(b=d.boxing().animate(c))&&b.id}}}},EventHandlers:{beforeRender:function(a){},onRender:function(a){},onLayout:function(a){},onResize:function(c,b,a){},onMove:function(c,e,d,b,a){},onDock:function(a,b){},beforePropertyChanged:function(b,a,c,d){},afterPropertyChanged:function(b,a,c,d){},beforeAppend:function(a,b){},afterAppend:function(a,b){},beforeRemove:function(c,d,b,a){},afterRemove:function(c,d,b,a){},onDestroy:function(a){},beforeDestroy:function(a){},afterDestroy:function(a){},onShowTips:function(a,b,c){},onContextmenu:function(a,c,d,b,f){}},RenderTrigger:function(){var f=this,a=f.boxing(),g=f.properties,c,e=f.getRootNode(),d=e.style;if(g.sandboxTheme){xui.UI._refreshSBTheme(f,g.sandboxTheme)}if(f.box._onresize){if(!f._syncResize&&!f.box._syncResize){var d=f.getRootNode().style,c;if((c=d.visibility)!="hidden"){f._$visibility=c;d.visibility="hidden"}d=null}xui.UI.$tryResize(f,g.width,g.height)}if(g.disabled){a.setDisabled(true,true)}if(g.rotate){a.setRotate(g.rotate,true)}if(!f.$inDesign&&g.hoverPop){xui.asyRun(function(){a.setHoverPop(g.hoverPop,true)})}if(f.behavior.PanelKeys){if(c=g.dataBinder){a.setDataBinder(c,true)}}if(g.activeAnim){xui.asyRun(function(){if(f&&!f.destroyed){f.boxing().setActiveAnim(g.activeAnim,true)}})}(f.$beforeDestroy=(f.$beforeDestroy||{}))["activeAnim"]=function(b){if(b=f._activeAnim){xui.Thread.abort(b)}};f._inValid=1},$doResize:function(e,j,f,b,l){if(b||((j||f)&&(e._resize_w!=j||e._resize_h!=f))){var g=e.getRootNode(),c;if(!g){return false}e._resize_w=j;e._resize_h=f;xui.tryF(e.box._onresize,[e,j,f,b,l],e.box);if((b||j)&&e.box&&e.box["xui.absContainer"]&&(c=e.getContainer(true))){c.children().each(function(q,m,n){if((m=xui.UIProfile.getFromDom(q.id))&&m.box&&m.box._onresize&&(n=m.properties)&&(("position" in n)&&("width" in n))&&(n.position=="static"||n.position=="relative")&&(n.width===""||n.width=="auto")){xui.UI.$doResize(m,xui(q).width(),null,b,l)}})}if(e.onResize){e.boxing().onResize(e,j,f)}}if("_$visibility" in e){var d=e.getRootNode(),a=d.style;if(a.visibility!="visible"&&!xui.getNodeData(d,"_setVisibility")){a.visibility=e._$visibility}d=a=null;xui.clearTimeout(e._$rs_timer);delete e._$rs_timer;delete e._$rs_args;delete e._$visibility}},$tryResize:function(g,a,f,j,d){var e=g.box,c=e&&e._onresize;if(c&&(j||a||f)){a=((a===""||a=="auto")?"auto":((xui.isFinite(a)||g.$isPx(a))?(parseFloat(a)||0):a))||null;f=((f===""||f=="auto")?"auto":((xui.isFinite(f)||g.$isPx(f))?(parseFloat(f)||0):f))||null;if("_$visibility" in g){var b=g._$rs_args;if(!b){b=g._$rs_args=[g,null,null];g._$rs_timer=xui.asyRun(function(){if(!g.box){return}try{if(g&&g._$rs_args){xui.UI.$doResize.apply(null,g._$rs_args)}}catch(l){}})}b[1]=a;b[2]=f;b[3]=j;b[4]=d}else{xui.UI.$doResize(g,a,f,j,d)}}},LayoutTrigger:function(){var d=this,a=d.boxing(),f=d.properties;delete d._nodeEmSize;if(f.position=="absolute"){if(f.dock&&f.dock!="none"){if(!d.$laidout){d.$laidout=1;var e=d.getRootNode().style,g=0+d.$picku(e.width),c=0+d.$picku(e.height);switch(f.dock){case"top":case"bottom":case"width":e.width=0;break;case"left":case"right":case"height":e.height=0;break;default:e.width=0;e.height=0}}xui.UI.$dock(this,false,true)}}else{if(xui.get(d,["parent","properties","conDockRelative"])||xui.get(d,["parent","properties","conLayoutColumns"])){if(!d._conLayout){xui.resetRun("conLayoutColumns:"+d.parent.$xid,function(){if(!d._conLayout&&!d.destroyed&&!d.parent.destroyed){xui.UI._adjustConW(d.parent,d.getRoot().parent(),d)}})}}}},$dock_args:["top","bottom","left","right","center","middle","width","height"],$dock_map:{middle:1,center:1},$dock:function(l,e,C){var J=l.getRoot(),D=l.box["xui.svg"],d=l.boxing(),K=-1,I=-1,G=-1,F=-1,E=xui((J.get(0)&&J.get(0).parentNode)||l.$dockParent),g=function(f){return xui.browser.ie&&xui.browser.ver<=6?f-f%2:f},x=function(P,S){var T,X,U,W,V;if(S){if(xui.ini.$frame&&!xui.isNumb(xui.ini.$frame.zoom)){return}T=xui.win.$getEvent("onSize","dock")}else{if(P&&P.get(0)){T=P.$getEvent("onSize","dock")}}if(T&&T.dockall&&T.dockall.length){for(var R=0,Q=T.dockall.length,Y;R<Q;R++){Y=T.dockall[R].$dockType;switch(Y){case"fill":case"cover":W=V=1;break;case"top":case"bottom":case"width":W=1;break;case"left":case"right":case"height":V=1;break}}}if(W&&V){U="xui-css-noscroll"}else{if(W){U="xui-css-noscrollx"}else{if(V){U="xui-css-noscrolly"}}}if(S){xui("html").removeClass(/^xui-css-noscroll(x|y)?$/);X=xui("body").get(0);if(X){X.scroll=""}if(U){if(W){xui.win.scrollLeft(0)}if(V){xui.win.scrollTop(0)}xui("html").addClass(U);if(W&&V&&X){X.scroll="no"}}}else{P.removeClass(/^xui-css-noscroll(x|y)?$/);if(U){if(W){P.scrollLeft(0)}if(V){P.scrollTop(0)}P.addClass(U)}}},c=function(Q,S,f,R){var P;if(parseFloat(S["dockMin"+f])&&(P=Q.$px(S["dockMin"+f]))){R=g(P<=R?R:P)}if(parseFloat(S["dockMax"+f])&&(P=Q.$px(S["dockMax"+f]))){R=g(P<=R?P:R)}return R},r=function(Q,U,f,R,P,T){var S=xui.$us(Q),V=function(W){return Q.$forceu(W,S>0?"em":"px",null,true)};if(("left" in T)&&Q.$px(P.left)!==T.left){T.left=V(T.left)}if(("top" in T)&&Q.$px(P.top)!==T.top){T.top=V(T.top)}if(("right" in T)&&Q.$px(P.right)!==T.right){T.right=V(T.right)}if(("bottom" in T)&&Q.$px(P.bottom)!==T.bottom){T.bottom=V(T.bottom)}if(("width" in T)&&Q.$px(P.width)!==T.width){T.width=V(T.width)}if(("height" in T)&&Q.$px(P.height)!==T.height){T.height=V(T.height)}if(!xui.isEmpty(T)){if(D){f._setBBox(T)}else{R.cssRegion(T,true)}}},L=function(Y,ah,R,Q,P,f,ai){if(!Y.prevLine.length){return}var T=[],ad,aa,af,U,ae,S,ac,ag,X=Y.prevLine.length-1,ab=0,V=Y[f],W=xui.CSS;R-=X*ah;xui.arr.each(Y.prevLine,function(aj){if(aj.pct){T.push(aj)}else{R-=aj.region[Q]+aj.margin[f]+aj.margin[ai]}});if(af=T.length){var Z=0;xui.arr.each(T,function(ak,aj){Z+=ak.pct});xui.arr.each(T,function(ak,aj){S=ak.prop;U=ak.region;nodefz=ak.nodefz;ak.pct=ak.pct/Z;ad=R*ak.pct-ak.margin[f]-ak.margin[ai];if(parseFloat(S[P])&&(aa=W.$px(S[P],nodefz))){ad=g(aa<=ad?aa:ad)}if(aj==af-1){ad=R-ab;if(parseFloat(S[P])&&(aa=W.$px(S[P],nodefz))){ad=g(aa<=ad?aa:ad)}U[Q]=ad}else{ab+=(U[Q]=parseInt(ad,10))}})}xui.arr.each(Y.prevLine,function(ak,aj){U=ak.region;U[f]=parseInt(V+ak.margin[f],10);V+=U[Q]+ak.margin[f]+ak.margin[ai]+ah;r(ak.profile,ak.isSVG,ak.ins,ak.node,ak.style,U)});Y.prevLine=[]};if(!E.get(0)){return}var j=l.properties,q=xui.$us(l),O=function(f,P){return l.$forceu(f,q>0?"em":"px",P,true)},B=j.dockMargin,n="auto",H=j.dock||"none",A=xui.Event.getId(E.get(0)),M=function(f,P){f=parseInt(f.properties._dockOrder||f.properties.dockOrder,10)||0;P=parseInt(P.properties._dockOrder||P.properties.dockOrder,10)||0;return f>P?1:f==P?0:-1},m,w="$inMatrix",N,u,s,o=J._getEmSize(),b={top:O(B.top||0,o),left:O(B.left||0,o),right:O(B.right||0,o),bottom:O(B.bottom||0,o)};if(D){var a=d._getBBox();j.left=a.x;j.top=a.y;j.width=a.width;j.height=a.height}if(E.get(0)===document.body||E.get(0)===document||E.get(0)===window){A="!document";s=true}if(A&&(A==xui.Dom._ghostDivId||xui.str.startWith(A,xui.Dom._emptyDivId))){return}if(l.$dockParent!=A||l.$dockType!=H||e){l.$dockParent=A;l.$dockType=H;K=l.unLink("$dockall");I=l.unLink("$dock");G=l.unLink("$dock1");F=l.unLink("$dock2");switch(H){case"middle":m={right:j.right==n?n:(j.right||""),bottom:n,left:j.left==n?n:(j.left||""),width:j.width||"",height:j.height||""};break;case"center":m={right:n,bottom:j.bottom==n?n:(j.bottom||""),top:j.top==n?n:(j.top||""),width:j.width||"",height:j.height||""};break;case"origin":m={right:n,bottom:n,width:j.width||"",height:j.height||""};break;case"top":m={left:b.left,right:b.right,bottom:n,height:j.height||""};break;case"bottom":m={left:b.left,right:b.right,top:n,height:j.height||""};break;case"left":m={right:n,width:j.width||""};break;case"right":m={left:n,width:j.width||""};break;case"width":m={bottom:n,height:j.height||"",top:j.top||""};break;case"height":m={right:n,width:j.width||"",left:j.left||""};break;case"fill":case"cover":m={right:n,bottom:n};break;case"none":m={left:j.left,top:j.top,width:j.width||"",height:j.height||""};break}if(J.get(0)){if(D){d._setBBox(m)}else{J.cssRegion(m,true)}}if(s){E=xui.win;if(!xui.$cache._resizeTime){xui.$cache._resizeTime=1}}if(H!="none"){N=E.$getEvent("onSize","dock");if(!N){N=function(al){var af=arguments.callee,aD=xui.CSS,am=xui.UI.$dock_map,ah=xui.UI.$dock_args,ao=af.rePos,ax=af.pid,aO=af.pid=="!window"||af.pid=="!document",aA=aO?0:xui.UIProfile.getFromDom(ax),ay=aA&&aA.properties,aH=aA&&aA.getRoot(),av=aH&&aH.get(0)&&aH.get(0).style,ac=av&&aH._getEmSize(),an=(ay&&("conDockSpacing" in ay))?ay.conDockSpacing:{width:0,height:0},ag=(ay&&("conDockPadding" in ay))?ay.conDockPadding:{left:0,top:0,right:0,bottom:0},T=(ay&&("conDockFlexFill" in ay))?ay.conDockFlexFill:"",S=(ay&&("conDockStretch" in ay))?ay.conDockStretch.split(/[,;\s]+/):[],V=T=="width"||T=="both",ad=T=="height"||T=="both",aq=aO?xui.frame:xui(ax);if(!aq.get(0)){return}var ab=aq.get(0),aF=ab.style,ar=xui.$us(l),W=aq._getEmSize(),az=function(aP,aQ){return aD.$forceu(aP,ar>0?"em":"px",aQ||W)},R,aK,aJ,aG,ai,P,aw=aO?xui("body").get(0).style:aF,ak=aw.overflow,Z=aw.overflowX,Y=aw.overflowY;if(aF){aF.overflow=aF.overflowX=aF.overflowY="hidden"}var U;for(var aK in af.dockall){if(af.dockall[aK].$dockType=="cover"){U=1;break}}var f=(aF&&aD.$px(aF.width,W))||aq.width()||0,Q=(aF&&aD.$px(aF.height,W))||aq.height()||0,aM=U?aq.offsetHeight():Q,aC=U?aq.offsetWidth():f;if(f=="auto"){f=0}if(Q=="auto"){Q=0}if(aF){aF.overflow=ak;aF.overflowX=Z;aF.overflowY=Y}an={width:aD.$px(an.width||0,ac),height:aD.$px(an.height||0,ac)};ag={left:aD.$px(ag.left||0,ac),top:aD.$px(ag.top||0,ac),right:aD.$px(ag.right||0,ac),bottom:aD.$px(ag.bottom||0,ac)};if(al.$dockid||!aO||((xui.stamp()-xui.$cache._resizeTime)>50)){R={left:ag.left,top:ag.top,right:ag.right,bottom:ag.bottom,width:f,height:Q,offsetW:aC||f,offsetH:aM||Q};R.preX=R.oX=R.left;R.preY=R.oY=R.top;R.prevLine=[];R.ww=R.width-R.left-R.right;R.hh=R.height-R.top-R.bottom;R.leftHolder=R.topHolder=R.rightHolder=R.bottomHolder=0;if(V||ad){var aN=0,aL=0,X=0,aB=0,aE,aI=0,ae=function(aR,aS,aP,aT,aQ){aT=aR.properties;if(parseFloat(aQ=aT["dockMin"+aS])){aP=Math.max(aR.$px(aQ),aP)}if(parseFloat(aQ=aT["dockMax"+aS])){aP=Math.min(aR.$px(aQ),aP)}return aP},aa=function(aQ,aP){return parseFloat(aQ.$px(aQ.properties[aP]))||0};for(aJ=0;ai=ah[aJ++];){P=af[ai];if(P.length){for(aK=0;aG=P[aK++];){if(!(aG.properties.position!="absolute"||aG.properties.dockIgnore||aG.properties.dockIgnoreFlexFill)){var aq=aG.getRoot();if(V&&(ai=="left"||ai=="right"||ai=="width")){aN++;aE=ae(aG,"W",aa(aG,"width"));aL+=aE;if(aG.properties.dock!="fill"){aI=Math.max(aI,ae(aG,"H",aa(aG,"height")))}}if(ad&&(ai=="top"||ai=="bottom"||ai=="height")){X++;aB+=ae(aG,"H",aa(aG,"height"))}}}}}if(aB&&aI){aB+=aI}if(aN>=1&&aL&&R.width){var aj=R.width-ag.left-ag.right-(aN-1)*an.width;for(aJ=0;ai=ah[aJ++];){P=af[ai];if(P.length){for(aK=0;aG=P[aK++];){if(aG.properties.position=="absolute"&&!aG.properties.dockIgnore&&aG.properties.dockIgnoreFlexFill){var aq=aG.getRoot();if(ai=="left"||ai=="right"||ai=="width"){aj-=ae(aG,"W",aa(aG,"width"));ap-=an.width}}}for(aK=0;aG=P[aK++];){if(!(aG.properties.position!="absolute"||aG.properties.dockIgnore||aG.properties.dockIgnoreFlexFill)){var aq=aG.getRoot();if(ai=="left"||ai=="right"||ai=="width"){aq.width(az(ae(aG,"W",Math.min(1,aa(aG,"width")/aL)*aj)))}}}}}}if(X>=1&&aB&&R.height){var ap=R.height-ag.top-ag.bottom-(X-1)*an.height;for(aJ=0;ai=ah[aJ++];){P=af[ai];if(P.length){for(aK=0;aG=P[aK++];){if(aG.properties.position=="absolute"&&!aG.properties.dockIgnore&&aG.properties.dockIgnoreFlexFill){var aq=aG.getRoot();if(ai=="top"||ai=="bottom"||ai=="height"){ap-=ae(aG,"H",aa(aG,"height"));ap-=an.height}}}for(aK=0;aG=P[aK++];){if(!(aG.properties.position!="absolute"||aG.properties.dockIgnore||aG.properties.dockIgnoreFlexFill)){var aq=aG.getRoot();if(ai=="top"||ai=="bottom"||ai=="height"){aq.height(az(ae(aG,"H",Math.min(1,aa(aG,"height")/aB)*ap)))}}}}}}if(aA&&V){aA._conDockFlexFillW=1}if(aA&&ad){aA._conDockFlexFillH=1}}if(T!="both"){for(aJ=0;ai=ah[aJ++];){P=af[ai];if(P.length){for(aK=0;aG=P[aK++];){if(!(aG.properties.position!="absolute"||aG.properties.dockIgnore||aG.properties.dockIgnoreFlexFill)){var aq=aG.getRoot();if(aA&&aA._conDockFlexFillW&&!V&&(ai=="left"||ai=="right"||ai=="width")){aq.width(az(aG.properties.width))}if(aA&&aA._conDockFlexFillH&&!ad&&(ai=="top"||ai=="bottom"||ai=="height")){aq.height(az(aG.properties.height))}}}}}}if(aA&&aA._conDockFlexFillW){delete aA._conDockFlexFillW}if(aA&&aA._conDockFlexFillH){delete aA._conDockFlexFillH}for(aJ=0;ai=ah[aJ++];){R.preX=R.oX;R.preY=R.top;P=af[ai];var au=0,at;if(at=P.length){if(!am[ai]){al.width=al.height=1}for(aK=0;aG=P[aK++];){if(aG.properties.position=="absolute"&&!aG.properties.dockIgnore){ao(aG,au++,at,R,ai,al.$dockid,aO||al.width,aO||al.height,an.width,an.height,S)}}}}if(R.later){xui.each(R.later,function(aR){var aP;try{if(aR.isSVG){aR.ins._setBBox(aR)}else{aR.node.cssRegion(aR,true)}if(aP=xui.UIProfile.getFromDom(aR.node.get(0))){delete aR.node;if(!aP.box._onresize&&aP.onResize&&(aR.width!==null||aR.height!==null)){aP.boxing().onResize(aP,aR.width,aR.height)}if(aP.onDock){aP.boxing().onDock(aP,aR)}if(aP.$onDock){aP.$onDock(aP,aR)}}}catch(aQ){xui.asyRun(function(){if(!aR.node){return}var aS=aR.width,aT=aR.height;aR.width=((parseFloat(aR.width)||0)+1)+xui.CSS.$picku(aR.width);aR.height=((parseFloat(aR.width)||0)+1)+xui.CSS.$picku(aR.height);if(aR.isSVG){aR.ins._setBBox(aR)}else{aR.node.cssRegion(aR)}aR.width=aS;aR.height=aT;if(aR.isSVG){aR.ins._setBBox(aR)}else{aR.node.cssRegion(aR,true)}if(aP=xui.UIProfile.getFromDom(aR.node.get(0))){delete aR.node;if(!aP.box._onresize&&aP.onResize&&(aR.width!==null||aR.height!==null)){aP.boxing().onResize(aP,aR.width,aR.height)}if(aP.onDock){aP.boxing().onDock(aP,aR)}if(aP.$onDock){aP.$onDock(aP,aR)}}})}})}for(aJ=0;ai=ah[aJ++];){P=af[ai];if(P.length){for(aK=0;aG=P[aK++];){if(aG.properties.position=="absolute"&&!aG.properties.dockIgnore){if(!R.later||!R.later[aG.$xid]){if(aG.onDock){aG.boxing().onDock(aG)}if(aG.$onDock){aG.$onDock(aG)}}}}}}if(aO){xui.$cache._resizeTime=xui.stamp()}}af=ao=aq=aF=null};N.pid=A;xui.arr.each(xui.UI.$dock_args,function(f){N[f]=[]});N.dockall=[];N.rePos=function(W,an,am,S,az,aq,ax,aE,aa,ad,U){var ao=false;if(aq&&W.$xid!=aq){ao=true}var ae=W.properties,aB=xui.CSS,at=ae.dockFloat,X=ae.dockMargin,ai=ae.dockStretch,aj,ac,T,ah,f,ap=0,aA=0,ak=W.getRoot(),aw=W.boxing(),ag=ak.get(0),aD=ag.style,al=xui.$us(W),ab=ak._getEmSize(),av=function(aG){return aB.$forceu(aG,al>0?"em":"px",ab)},V,Y,aC,P,Z,Q,au=aB.$px(ae._dockBorderWidth,ab)||0,ar=aB.$px(ae._dockBorderHeight,ab)||0,aF={},ay,R=W.box["xui.svg"],af;X.top=aB.$px(X.top,ab);X.left=aB.$px(X.left,ab);X.right=aB.$px(X.right,ab);X.bottom=aB.$px(X.bottom,ab);if(R){af=aw._getBBox();ae.left=af.x;ae.top=af.y;ae.width=af.width;ae.height=af.height}if(aD.display=="none"){return}switch(az){case"middle":case"center":aj=ac=0;break;default:ai=ai||((az=="width"||az=="height")?"":U[an%U.length])||"stretch";if(az=="width"||az=="height"){if(ai!="stretch"&&ai!="forward"&&ai!="rearward"){ai="stretch"}}switch(ai){case"stretch":aj=1;ac=1;T=0;break;case"forward":aj=1;ac=0;T=0;break;case"rearward":aj=0;ac=1;T=0;break;case"fixed":T=1;break;default:T=1;ah=Math.min(1,Math.max(0,parseFloat(ai)||0))}}f=ae.dock=="cover";switch(az){case"middle":if(R){aw.setTop(Math.max(0,(S.height-af.height)/2))}else{ak.top(av(Math.max(0,(S.height-ak.height())/2)))}break;case"center":if(R){aw.setLeft(Math.max(0,(S.width-af.width)/2))}else{ak.left(av(Math.max(0,(S.width-ak.width())/2)))}break;case"top":if(!ao){if(T){Z=ah?(parseFloat(S.ww*ah)||0):g(R?af.width:aB.$px(ae.width,ab))+X.left+X.right;if(ah){Z-=aa;ap=c(W,ae,"W",Z-X.left-X.right);Z=ap+X.left+X.right}if((S.preX+Z-S.oX)>S.ww){S.top+=S.topHolder;S.topHolder=0;S.preX=S.oX;L(S,aa,S.ww,"width","dockMaxW","left","right")}S.prevLine.push({profile:W,prop:ae,node:ak,style:aD,isSVG:R,ins:aw,pct:ah,margin:X,region:{top:S.top+X.top,width:Z}});S.preX+=Z+aa;S.topHolder=Math.max(S.topHolder,(R?af.height:ak.offsetHeight())+X.top+X.bottom+ad)}else{L(S,aa,S.ww,"width","dockMaxW","left","right");if(S.topHolder){S.top+=S.topHolder;S.preX=S.oX}V=aj?((at?0:S.left)+X.left):aB.$px(ae.left,ab);aC=ac?((at?0:S.right)+X.right):(S.width-aB.$px(ae.width,ab)-aB.$px(ae.left,ab));Y=(at?0:S.top)+X.top;Z=c(W,ae,"W",S.width-V-aC-au);r(W,R,aw,ak,aD,{left:V,top:Y,width:g(Z)});if(!at){S.top+=(R?af.height:ak.offsetHeight())+X.top+X.bottom+ad}}if(am==an+1){L(S,aa,S.ww,"width","dockMaxW","left","right")}}break;case"bottom":if(!ao){if(T){Z=ah?(parseFloat(S.ww*ah)||0):g(R?af.width:aB.$px(ae.width,ab))+X.left+X.right;if(ah){Z-=aa;ap=c(W,ae,"W",Z-X.left-X.right);Z=ap+X.left+X.right}if((S.preX+Z-S.oX)>S.ww){S.bottom+=S.bottomHolder;S.bottomHolder=0;S.preX=S.oX;L(S,aa,S.ww,"width","dockMaxW","left","right")}S.prevLine.push({profile:W,prop:ae,node:ak,style:aD,isSVG:R,ins:aw,pct:ah,margin:X,region:{bottom:S.bottom+X.bottom,width:Z}});S.preX+=Z+aa;S.bottomHolder=Math.max(S.bottomHolder,(R?af.height:ak.offsetHeight())+X.top+X.bottom+ad)}else{L(S,aa,S.ww,"width","dockMaxW","left","right");if(S.bottomHolder){S.bottom+=S.bottomHolder;S.bottomHolder=0;S.preX=S.oX}V=aj?((at?0:S.left)+X.left):aB.$px(ae.left,ab);aC=ac?((at?0:S.right)+X.right):(S.width-aB.$px(ae.width,ab)-aB.$px(ae.left,ab));P=(at?0:S.bottom)+X.bottom;Z=c(W,ae,"W",S.width-V-aC);r(W,R,aw,ak,aD,{left:V,bottom:P,width:g(Z)});if(!at){S.bottom+=(R?af.height:ak.offsetHeight())+X.top+X.bottom+ad}}if(am==an+1){L(S,aa,S.ww,"width","dockMaxW","left","right")}}break;case"left":if(!ao){if(S.topHolder){S.top+=S.topHolder+ad;S.topHolder=0;S.oY=S.preY=S.top}if(S.bottomHolder){S.bottom+=S.bottomHolder+ad;S.bottomHolder=0}S.hh=S.height-S.top-S.bottom;if(S.hh<=0){return}if(T){Z=ah?(parseFloat(S.hh*ah)||0):g(R?af.height:aB.$px(ae.height,ab))+X.top+X.bottom;if(ah){Z-=ad;aA=c(W,ae,"H",Z-X.top-X.bottom);Z=aA+X.top+X.bottom}if((S.preY+Z-S.oY)>S.hh){S.left+=S.leftHolder;S.leftHolder=0;S.preY=S.oY;L(S,ad,S.hh,"height","dockMaxH","top","bottom")}S.prevLine.push({profile:W,prop:ae,node:ak,style:aD,isSVG:R,ins:aw,pct:ah,margin:X,region:{left:S.left+X.left,height:Z}});S.preY+=Z+ad;S.leftHolder=Math.max(S.leftHolder,(R?af.width:ak.offsetWidth())+X.left+X.right+aa)}else{L(S,aa,S.hh,"height","dockMaxH","top","bottom");if(S.leftHolder){S.left+=S.leftHolder;S.leftHolder=0;S.preY=S.top}V=(at?0:S.left)+X.left;Y=aj?((at?0:S.top)+X.top):aB.$px(ae.top,ab);P=ac?((at?0:S.bottom)+X.bottom):(S.height-aB.$px(ae.height,ab)-aB.$px(ae.top,ab));Z=c(W,ae,"H",S.height-Y-P-ar);r(W,R,aw,ak,aD,{left:V,top:Y,height:g(Z)});if(!at){S.left+=(R?af.width:ak.offsetWidth())+X.left+X.right+aa}}if(am==an+1){L(S,aa,S.hh,"height","dockMaxH","top","bottom")}}break;case"right":if(!ao){if(S.topHolder){S.top+=S.topHolder;S.topHolder=0;S.oY=S.preY=S.top}if(S.bottomHolder){S.bottom+=S.bottomHolder;S.bottomHolder=0}S.hh=S.height-S.top-S.bottom;if(S.hh<=0){return}if(T){Z=ah?(parseFloat(S.hh*ah)||0):g(R?af.height:aB.$px(ae.height,ab))+X.top+X.bottom;if(ah){Z-=ad;aA=c(W,ae,"H",Z-X.top-X.bottom);Z=aA+X.top+X.bottom}if((S.preY+Z-S.oY)>S.hh){S.right+=S.rightHolder;S.rightHolder=0;S.preY=S.oY;L(S,ad,S.hh,"height","dockMaxH","top","bottom")}S.prevLine.push({profile:W,prop:ae,node:ak,style:aD,isSVG:R,ins:aw,pct:ah,margin:X,region:{right:S.right+X.right,height:Z}});S.preY+=Z+ad;S.rightHolder=Math.max(S.rightHolder,(R?af.width:ak.offsetWidth())+X.left+X.right+aa)}else{L(S,aa,S.hh,"height","dockMaxH","top","bottom");if(S.rightHolder){S.right+=S.rightHolder;S.rightHolder=0;S.preY=S.top}aC=(at?0:S.right)+X.right;Y=aj?((at?0:S.top)+X.top):(aB.$px(ae.top,ab));P=ac?((at?0:S.bottom)+X.bottom):(S.height-aB.$px(ae.height,ab)-aB.$px(ae.top,ab));Z=c(W,ae,"H",S.height-Y-P-ar);r(W,R,aw,ak,aD,{right:aC,top:Y,height:g(Z)});if(!at){S.right+=(R?af.width:ak.offsetWidth())+X.left+X.right+aa}}if(am==an+1){L(S,aa,S.hh,"height","dockMaxH","top","bottom")}}break;case"width":if(!ax){return}if(S.leftHolder){S.left+=S.leftHolder;S.leftHolder=0}if(S.rightHolder){S.right+=S.rightHolder;S.rightHolder=0}V=aj?((f?0:(at?0:S.left))+X.left):aB.$px(ae.left,ab);aC=ac?((f?0:(at?0:S.right))+X.right):(S.width-aB.$px(ae.width,ab)-aB.$px(ae.left,ab));Y=ae.dock=="width"?(aB.$px(ae.top,ab)||0):(aj?((f?0:(at?0:S.top))+X.top):aB.$px(ae.top,ab));Z=c(W,ae,"W",(f?S.offsetW:S.width)-V-aC-au);S.later=S.later||{};S.later[W.$xid]=S.later[W.$xid]||{};xui.merge(S.later[W.$xid],{isSVG:R,ins:aw,node:ak,width:av(Z),left:av(V),top:av(Y)},"all");break;case"height":if(!aE){return}if(S.topHolder){S.top+=S.topHolder;S.topHolder=0;S.preX=S.oX}if(S.bottomHolder){S.bottom+=S.bottomHolder;S.bottomHolder=0;S.preX=S.oX}Y=aj?((f?0:(at?0:S.top))+X.top):aB.$px(ae.top,ab);P=ac?((f?0:(at?0:S.bottom))+X.bottom):(S.height-aB.$px(ae.height,ab)-aB.$px(ae.top,ab));V=ae.dock=="height"?(aB.$px(ae.left,ab)||0):(aj?((f?0:(at?0:S.left))+X.left):aB.$px(ae.left,ab));Z=c(W,ae,"H",(f?S.offsetH:S.height)-Y-P-ar);S.later=S.later||{};S.later[W.$xid]=S.later[W.$xid]||{};xui.merge(S.later[W.$xid],{isSVG:R,ins:aw,node:ak,height:av(Z),left:av(V),top:av(Y)},"all");break}};E.onSize(N,"dock")}if(H=="fill"||H=="cover"){l.link(N.height,"$dock1",null,G);l.link(N.width,"$dock2",null,F);xui.arr.stableSort(N.height,M);xui.arr.stableSort(N.width,M)}else{if(H=="origin"){l.link(N.center,"$dock1",null,G);l.link(N.middle,"$dock2",null,F)}else{l.link(N[H],"$dock",null,I);xui.arr.stableSort(N[H],M)}}l.link(N.dockall,"$dockall",null,K);xui.$cache._resizeTime=1;l.$dockFun=N}x(E,s);if(H!="none"){(l.$beforeDestroy=(l.$beforeDestroy||{}))["releaseDock"]=function(){l.unLink("$dockall");l.unLink("$dock");l.unLink("$dock1");l.unLink("$dock2");x(E,s);if(E&&E.get(0)&&(E=xui.UIProfile.getFromDom(E.id()))){E.boxing().adjustDock();xui.tryF(E.clearCache,[],E)}l=E=null}}else{if(l.$beforeDestroy){delete l.$beforeDestroy.releaseDock}}}if(C){E.onSize()}},_beforeSerialized:function(f){var l,m,a,d={};xui.merge(d,f,"all");var c=d.properties=xui.clone(f.properties,true),e=d.box.$DataStruct,m,j=d.box.$DataModel;for(var g in xui.UI.$ps){if((g in c)&&c[g]===""){c[g]="auto"}}for(var g in j){if(j[g].ini===c[g]){delete c[g]}else{if(j[g]&&j[g]["$spaceunit"]){if((j[g].ini===0||j[g].ini==="0"||j[g].ini==="0px"||j[g].ini==="0em")&&(c[g]===0||c[g]==="0"||c[g]==="0px"||c[g]==="0em")){delete c[g]}else{if((j[g].ini+(xui.isFinite(j[g].ini)?"px":""))==(c[g]+(xui.isFinite(c[g])?"px":""))){delete c[g]}else{if(c[g]!="auto"){m=xui.$us(d);c[g]=f.$forceu(c[g],m==2?"em":m==-2?"px":null)}}}}}}if(c.position=="absolute"){switch(c.dock){case"top":case"bottom":delete delete c.top;delete c.bottom;delete c.right;break;case"left":case"right":delete c.left;delete c.right;delete c.bottom;break}}for(var g in xui.UI.$ps){if((g in c)&&xui.isNaN(c[g])){delete c[g]}}if(c.items&&c.items.length){m=xui.absObj.$specialChars;c.items=xui.clone(c.items,function(q,b,n){return !m[((n===1?q.id:b)+"").charAt(0)]&&q!=undefined})}if(c.tagCmds&&c.tagCmds.length){m=xui.absObj.$specialChars;c.tagCmds=xui.clone(c.tagCmds,function(q,b,n){return !m[((n===1?q.id:b)+"").charAt(0)]&&q!=undefined})}for(var g in f.box._objectProp){if((g in c)&&c[g]&&(xui.isHash(c[g])||xui.isArr(c[g]))&&xui.isEmpty(c[g])){delete c[g]}}var g="tagVar";if((g in c)&&c[g]&&(xui.isHash(c[g])||xui.isArr(c[g]))&&xui.isEmpty(c[g])){delete c[g]}xui.arr.each(["dockMargin","conDockPadding","conDockSpacing","sandboxTheme","propBinder"],function(n){if(m=c[n]){if(!xui.isHash(m)){return}a=e[n];for(var b in m){if(a[b]!==m[b]){return}}delete c[n]}});if(xui.isEmpty(c.resizerProp)){delete c.resizerProp}if(c.items&&(c.items.length==0||c.listKey)){delete c.items}if(c.tagCmds&&(c.tagCmds.length==0||c.listKey)){delete c.tagCmds}return d},getDropKeys:function(a,b){return a.properties.dropKeys},getDragKey:function(a,b){return a.properties.dragKey||(a.properites.dragSortable&&(a.key+":"+a.$xid))},getDragData:function(a,c,b){return{profile:a,domId:xui.use(b).id(),data:a.onGetDragData?a.boxing().onGetDragData(a,c,b):null}},_prepareData:function(d,g){var b=d.properties,m=this.$DataModel,n=arguments.callee,c=n.map||(n.map=xui.toArr("left,top,bottom,right,width,height")),o=[],l=d.box,q=d.box.adjustData,r;g=g||{};if(b.id){delete b.id}if("required" in m){b._requiredfld=b.required?"xui-required-field":""}if("nodeName" in m&&!b.nodeName){b.nodeName="xui"}if("caption" in m&&b.caption!==null){b.caption=b.caption===undefined?d.alias:b.caption}if("html" in m&&b.html){g.html=xui.adjustRes(b.html,0,1)}if("src" in m&&b.src){g.src=xui.adjustRes(b.src,0,1)}xui.each(b,function(j,a){if(m[a]&&m[a]["$spaceunit"]){if(xui.$us(d)>0){if(b[a]===0||b[a]=="0"){b[a]="0em"}else{if(b[a]===0||b[a]=="0"){b[a]="0px"}}}}});if("$hborder" in m&&m.$hborder){if(d.$isEm(b.width)){g.bWidth=d.$px2em(d.$em2px(b.width)-b.$hborder*2,null,true)+"em"}else{g.bWidth=(parseFloat(b.width)||0)-b.$hborder*2}}if("$vborder" in m&&m.$vborder){if(d.$isEm(b.height)){g.bHeight=d.$px2em(d.$em2px(b.height)-b.$vborder*2,null,true)+"em"}else{g.bHeight=(parseFloat(b.height)||0)-b.$vborder*2}}for(var e=0,f;f=c[e];e++){var r=(f in g)?g[f]:b[f];if(r||r===0){if(r!="auto"){o[o.length]=f+":"+d.$addu(r)}}}if(b.position){o[o.length]="position:"+b.position}if(b.visibility){o[o.length]="visibility:"+b.visibility}if("zIndex" in b){o[o.length]="z-index:"+b.zIndex}if(b.display){o[o.length]=b.display=="inline-block"?("display:"+xui.$inlineBlock.join("; display:")+";"):("display:"+b.display)}g._style=o.join(";")+";";if(l.$Behaviors.PanelKeys&&!l["xui.absList"]){o=[];if(b.panelBgClr){o[o.length]="background-color:"+b.panelBgClr}if(b.panelBgImg){o[o.length]="background-image:url("+xui.adjustRes(b.panelBgImg)+")"}if(b.panelBgImgPos){o[o.length]="background-position:"+b.panelBgImgPos}if(b.panelBgImgRepeat){o[o.length]="background-repeat:"+b.panelBgImgRepeat}if(b.panelBgImgAttachment){o[o.length]="background-attachment:"+b.panelBgImgAttachment}g._panelstyle=o.join(";")}if("className" in m){g._className=b.className||""}if("readonly" in m){g.readonly=b.readonly?"xui-ui-readonly":""}if("href" in m){g.href=b.href||xui.$DEFAULTHREF}if("tabindex" in m){g.tabindex=b.tabindex||"-1"}if("items" in m){d.ItemIdMapSubSerialId={};d.SubSerialIdMapItem={};b.items=d.box._adjustItems(b.items);g.items=this._prepareItems(d,b.items)}if("selectable" in m){g._selectable=(xui.browser.ie&&xui.browser.ver<10)?"":(b.selectable?"xui-ui-selectable":"xui-ui-unselectable")}g=q(d,b,g);d.prepared=true;return g},_prepareInlineObj:function(c,d,b){var f=d.object;f=f["xui.absBox"]?f.get(0):f["xui.UIProfile"]?f:xui.create(f).get(0);if(f.destroyed){return null}if(f["xui.UIProfile"]){f.properties.position="relative";if("tabindex" in f.properties){f.properties.tabindex=b}var e="xui-inline-object",a=f.CC.KEY||(a=f.CC.KEY="");if(a.indexOf(e)===-1){f.CC.KEY=a+" "+e}}d._inline_xid=f.$xid;d._inline_obj=f;f._inline_conf=d;f._inline_holder=c;if(f.alias&&(!f.host||f.host===f)){f.boxing().setHost(c.host,f.alias)}(c.$attached||(c.$attached=[])).push(f);return f},_prepareItems:function(b,m,j,s,o){var A=this,e=[],w,d,f,c=xui.UI.$tag_subId,q,a=b.properties,x=a.tabindex,n=b.box.adjustData,g=b.$itemFilter;if(g){g("begin","prepareItem",b)}for(var u=0,r=m.length;u<r;u++){if(xui.isHash(m[u])){}else{if(xui.isArr(m[u])){m[u]={id:m[u][0]};if(m.length>1){m[u].caption=m[u][1]}}else{m[u]={id:m[u]}}}if(m[u].id==="?"){m[u].id=xui.rand()}w=m[u];if(b.beforePrepareItem&&false===b.boxing().beforePrepareItem(b,w,j,s,o)){continue}if(!w.hasOwnProperty("caption")){w.caption=w.id}d={id:w.id};if(j){d._pid=j}d.renderer=w.renderer||a.renderer;q=d[c]=typeof o=="string"?o:b.pickSubId("items");if(false!==s){b.ItemIdMapSubSerialId[w.id]=q;b.SubSerialIdMapItem[q]=w}if(w.object){d.object=A._prepareInlineObj(b,w,x)}else{d._tabindex=x;n(b,w,d,"sub");if(A._prepareItem){A._prepareItem(b,d,w,j,u,r,s,o)}}e.push(d)}if(g){g("end","prepareItem",b)}return e},_showTips:function(a,b,c){if(a.properties.disableTips){return}if(a.onShowTips){return a.boxing().onShowTips(a,b,c)}}}});xui.Class("xui.absList","xui.absObj",{Instance:{activate:function(){var b=this.get(0),a=b.getSubNode("ITEM",true);if(!a.isEmpty()){a.focus(true)}return this},insertItems2:function(a,e,d,c){var b=xui.clone(a);if(xui.isHash(b)){delete b.sub}this.insertItems(b,e,d,c)},insertItems:function(j,d,s,u){var e,m,n,l,a,w,c,f,g,q=this,o=q._afterInsertItems;return this.each(function(A){g=A.box;m=g._adjustItems(j);c=A.properties;if(d===true){b=c.$UIvalue||c.value;if(b){b=(b+"").split(c.valueSeparator)}k=A.getItemByItemId(b[0]);d=k?k.id:null}n=A.properties.items;l=xui.arr.subIndexOf(n,"id",d);if(A.renderId){f=g._prepareItems(A,m);a=A._buildItems("items",f);if(A.$attached){for(var x=0,b;b=A.$attached[x++];){if(b._render){b._render(true)}if((t=b._render_holder||b._inline_holder)&&t.$afterAttached){xui.tryF(t.$afterAttached,[b],t)}else{xui.tryF(q.$afterAttached,[b],q)}}delete A.$attached}if(l==-1){e=A.getSubNode(g._ITEMSKEY||A.keys.ITEMS||A.keys.KEY);if(s){e.prepend(a)}else{e.append(a)}}else{e=A.getSubNodeByItemId(g._ITEMKEY||"ITEM",d);if(s){e.addPrev(a)}else{e.addNext(a)}}}if(l==-1){xui.arr.insertAny(n,m,s?0:-1)}else{xui.arr.insertAny(n,m,s?l:l+1)}if(o){A.boxing()._afterInsertItems(A,f,d,s)}if(A.$itemFilter){var r=[];xui.arr.each(j,function(E){if(E.sub&&!E.hidden){if(true!==A.$itemFilter(E,"checkSub",A)){var C;for(var D=0,B=E.sub.length;D<B;D++){if(!E.sub[D].hidden){C=1;break}}if(!C){r.push(E.id)}}else{r.push(E.id)}}});if(r.length){q.showItems(r,false)}}})},removeItems:function(c,e,f){var g,d,a=this._afterRemoveItems;remove=function(m,b,q,o,l,n){var j=arguments.callee;if(!l){l=xui()}xui.filter(b,function(w){var u,r;if(n||(r=(xui.arr.indexOf(q,w.id)!=-1))){if(m.renderId){if(u=m.ItemIdMapSubSerialId[w.id]){o.push(xui.copy(m.SubSerialIdMapItem[u]));delete m.SubSerialIdMapItem[u];delete m.ItemIdMapSubSerialId[w.id];m.reclaimSubId(u,"items");if(!n){if(!(g=m.getSubNode(m.keys[e]?e:(m.box._ITEMKEY||"ITEM"),u)).isEmpty()){l.merge(g)}if(w.$xid){l.get().push(xui.getObject(w.$xid).getRootNode())}}}}}if(w.sub){j(m,w.sub,q,o,l,n||r)}if(r){for(var s in w){w[s]=null}return false}});l.remove(true,f)};return this.each(function(b){var l=b.properties,j=[];c=xui.isHash(c)?[c.id]:xui.isArr(c)?c:c===0?[0]:c?(c+"").split(l.valueSeparator):null;if(!c){c=((l.$UIvalue||l.value)+"").split(l.valueSeparator)}xui.arr.each(c,function(n,m){c[m]=""+(xui.isNumb(n)?l.items&&l.items[n].id:xui.isHash(n)?n.id:n)});remove(b,l.items,c,j);if(d=l.$UIvalue){if((d=(""+d).split(l.valueSeparator)).length>1){xui.filter(d,function(m){return xui.arr.indexOf(c,m)==-1});l.$UIvalue=d.join(l.valueSeparator)}else{if(xui.arr.indexOf(c,l.$UIvalue)!=-1){l.$UIvalue=null}}}if(a&&b.renderId){b.boxing()._afterRemoveItems(b,j)}})},clearItems:function(a){return this.each(function(b){var c=b.properties;if(b.SubSerialIdMapItem){if(b.renderId){b.getSubNode(b.keys[b.box._ITEMKEY||"ITEM"],true).remove(true,a)}xui.each(b.SubSerialIdMapItem,function(e,d){b.reclaimSubId(d,"items")});b.SubSerialIdMapItem={};b.ItemIdMapSubSerialId={}}c.items.length=0;c.$UIvalue=null})},updateItem:function(n,f){var r=this,e=r.get(0),m,d=e.properties;n=xui.isHash(n)?n.id:n===0?0:n?(n+""):null;if(xui.isNumb(n)){n=xui.get(d.items,[n,"id"])}if(!n){m=d.$UIvalue||d.value;if(m){m=(m+"").split(d.valueSeparator)}m=e.getItemByItemId(m[0]);n=m?m.id:null}var j=e.box,s=d.items,x=e.queryItems(s,function(C){return typeof C=="object"?C.id===n:C==n},true,true,true),l,A,u,b,w,o,q;if(!xui.isHash(f)){f={caption:f+""}}if(x&&x.length){x=x[0];if(typeof x[0]!="object"){A=x[2][x[1]]={id:x[0]}}else{A=x[0]}if(xui.isSet(f.id)){f.id+=""}if(f.id&&n!==f.id){l=f.id;var a=e.ItemIdMapSubSerialId,m;if(!a[l]){if(m=a[n]){a[l]=m;delete a[n];e.SubSerialIdMapItem[m].id=l}else{A.id=l}}}delete f.id;if(xui.isEmpty(f)){return r}w=e.getSubNodeByItemId("ITEM",l||n);if(!w.isEmpty()){if("sub" in f){delete A._created;delete A._checked;delete A._inited;if(A.sub){var g=[];xui.arr.each(A.sub,function(C){g.push(C.id)});r.removeItems(g)}}else{if(A.sub){o=e.getSubNodeByItemId("SUB",l||n)}}xui.merge(A,f,"all");u=xui.get(e,["ItemIdMapSubSerialId",l||n]);b=j._prepareItems(e,[A],A._pid,false,u);w.replace(e._buildItems(arguments[2]||"items",b),false);if(o&&!o.isEmpty()){if(!(q=e.getSubNodeByItemId("SUB",l||n)).isEmpty()){q.replace(o)}}if(typeof r.setUIValue=="function"){var B=d.$UIvalue||"",b=(""+B).split(d.valueSeparator);if(b.length&&xui.arr.indexOf(b,n)!=-1){if(l){xui.arr.removeValue(b,n);b.push(A.id);r.setUIValue(b.join(d.valueSeparator),true,null,"update")}else{r._setCtrlValue(B)}}}}else{xui.merge(A,f,"all")}if(j.$Behaviors.PanelKeys){var c={};if(f.hasOwnProperty("panelBgClr")){c["background-color"]=f.panelBgClr}if(f.hasOwnProperty("panelBgImg")){c["background-image"]=f.panelBgImg?("url("+xui.adjustRes(f.panelBgImg)+")"):""}if(f.hasOwnProperty("panelBgImgPos")){c["position-color"]=f.panelBgImgPos}if(f.hasOwnProperty("panelBgImgRepeat")){c["background-repeat"]=f.panelBgImgRepeat}if(f.hasOwnProperty("panelBgImgAttachment")){c["background-attachment"]=f.panelBgImgAttachment}if(f.hasOwnProperty("overflow")){var m=f.overflow;if(m){if(m.indexOf(":")!=-1){xui.arr.each(m.split(/\s*;\s*/g),function(D){var C=D.split(/\s*:\s*/g);if(C.length>1){c[xui.str.trim(C[0])]=xui.str.trim(C[1]||"")}})}}c.overflow=m||""}if(!xui.isEmpty(c)){xui.arr.each(j.$Behaviors.PanelKeys,function(C){panel=e.getSubNode(C,l||n).css(c)})}}}return r},doFilter:function(a,e,d){var c=this,b=c.get(0);if(b){if(!a){if(b.$itemFilter){delete b.$itemFilter;a=function(){return false}}else{return this}}else{if(xui.isFun(a)){b.$itemFilter=a}else{if(a===true){a=b.$itemFilter}}}xui.resetRun(b.$xid+":itemFilter",function(){a("begin","doFilter",b);var m=b.properties,j=m.rows||m.items,g=[],l=[],f=function(o,n,q){var s=0,r;xui.arr.each(o,function(u){if(u.sub){if(true===a(u,e,b)){s++;if(u.hidden){n.push(u.id)}}else{if(f(u.sub,n,q)){s++;if(u.hidden){n.push(u.id)}}else{if(!u.hidden){q.push(u.id)}}}}else{if(a(u,e,b)){if(!u.hidden){q.push(u.id)}}else{s++;if(u.hidden){n.push(u.id)}}}});return s};f(j,g,l);a("end","doFilter",b);if(g.length){(c.showRows||c.showItems).call(c,g)}if(l.length){(c.showRows||c.showItems).call(c,l,false)}if(d!==false){c.reLayout(true)}})}return this},hideItems:function(a){return this.showItems(a,false)},showItems:function(f,b){var e=this,d=e.get(0),a=xui(),c=xui(),g=d.properties;f=xui.isHash(f)?f.id:xui.isArr(f)?f:f===0?[0]:f?(f+"").split(g.valueSeparator):null;if(!f){f=((g.$UIvalue||g.value)+"").split(g.valueSeparator)}if(f&&f.length){xui.arr.each(f,function(l,j){if(j=e.getItemByItemId(l)){if(b===false){if(!j.hidden){c.merge(e.getSubNodeByItemId("ITEM",j.id))}}else{if(j.hidden){a.merge(e.getSubNodeByItemId("ITEM",j.id))}}j.hidden=b===false}})}if(!a.isEmpty()){a.css("display","")}if(!c.isEmpty()){c.css("display","none")}return this},getItems:function(f,e){e=e||this.get(0).properties.items;if(f=="data"){return xui.clone(e,true)}else{if(f=="min"){var d=xui.clone(e,true),c;xui.arr.each(d,function(b,a){d[a]=b.id});return d}else{return e}}},focusItem:function(a){this.getSubNodeByItemId(this.constructor._focusNodeKey,a).focus(true);return this},scrollIntoView:function(a){a=this.getSubNodeByItemId(this.constructor._focusNodeKey,a);if(a=a.get(0)){a.scrollIntoView()}return this},selectItem:function(a){return this.fireItemClickEvent(a)},fireItemClickEvent:function(a){this.getSubNodeByItemId(this.constructor._focusNodeKey,a).onClick();return this},editItem:function(m){var d=this.get(0),b=d.properties,r,a,q;if(d&&d.renderId&&!d.destroyed){m=xui.isHash(m)?m.id:m===0?0:m?(m+""):null;if(xui.isNumb(m)){m=xui.get(b.items,[m,"id"])}if(!m){q=b.$UIvalue||b.value;if(q){q=(q+"").split(b.valueSeparator)}q=d.getItemByItemId(q[0]);m=q?q.id:null}if(m){if(r=d.getItemByItemId(m)){a=d.getSubNodeByItemId("ITEMCAPTION",m);if(a.isEmpty()){a=d.getSubNodeByItemId("CAPTION",m)}if(!a.isEmpty()){var c=a.parent(),e=xui.browser.contentBox,l=a.offset(null,c.get(0)),s=a.cssSize(),j=c.offset(),o=c.cssSize();j.left+=!e?0:a._paddingW("left");j.top+=!e?0:a._paddingH("top");o.height+=!e?0:a._paddingH();var f;if(d.beforeIniEditor){f=d.boxing().beforeIniEditor(d,r,a);if(f===false){return}}if(!f||!f["xui.UI"]){var f=new xui.UI.ComboInput({type:"input"});f.setWidth(Math.max(o.width-l.left,40)).setHeight(Math.max(o.height,20)).setResizer(true).setValue(r.caption||"");if(d.onBeginEdit){d.boxing().onBeginEdit(d,r,f)}var n=function(){xui.resetRun("absList_editor_reset",function(){if(f&&!f.isDestroyed()){f.getRoot().setBlurTrigger("absList_editor_blur",null);f.destroy();f=null}})};f.beforeUIValueSet(function(B,x,w,A,u){if(false!==(d.beforeEditApply&&d.boxing().beforeEditApply(d,r,w,f,u))){d.boxing().updateItem(r.id,{caption:w});if(d.onEndEdit){d.boxing().onEndEdit(d,r,f)}n()}}).onCancel(function(){n()});xui("body").append(f);var g=f.getRoot();g.popToTop({left:l.left+j.left,top:j.top});g.setBlurTrigger("absList_editor_blur",function(){n()});f.activate()}}}}}return this},getSelectedItem:function(){var d=this.getUIValue(true),c=this.get(0),a=[],b;if(xui.isArr(d)){if(d.length){xui.arr.each(d,function(e){if(b=c.getItemByItemId(e)){a.push(b)}});return a}}else{if(d){return c.getItemByItemId(d)}}}},Initialize:function(){var a=this.prototype;xui.arr.each(xui.toArr("getItemByItemId,getItemByItemCaption,getItemByDom,getSubIdByItemId,getSubNodeByItemId"),function(b){a[b]=function(){var c=this.get(0);return c[b].apply(c,arguments)};xui.Class._fun(a[b],b,a.KEY,null,"instance")})},Static:{_focusNodeKey:"ITEM",$abstract:true,_ensureValues:xui.UI._ensureValues,DataModel:{listKey:{set:function(b){var c=this,a=c.box.getCachedData(b);if(a){c.boxing().setItems(xui.clone(a))}else{c.boxing().setItems(c.properties.items)}c.properties.listKey=b}},items:{ini:[],set:function(n){var a=this,j=a.boxing(),l=a.properties.items,b,c,m;if(typeof j.setValue=="function"){m=a.properties.value;if(m&&n&&n.length){var e=xui.arr.indexOf(n,m);if(e===-1){e=xui.arr.subIndexOf(n,"id",a.properties.value)}}}if(l&&l.length){if(a.children&&a.children.length){xui.arr.each(b=a.serialize(false,true).children,function(o){if(o[1]){var q=xui.arr.indexOf(l,o[1]);if(q===-1){q=xui.arr.subIndexOf(l,"id",o[1])}if(q!==-1){o[2]=q}}});j.removeChildren(true,true,true)}j.clearItems(true,true)}j.insertItems(n?xui.copy(n):null,null,null,true);if(n&&n.length&&b){var d={},f={},g=n.length;xui.arr.each(n,function(q,o){d[q.id||q]=o;f[o]=q.id||q});xui.arr.each(b,function(o){var r,q;if(xui.isSet(o[1])){if(xui.isSet(d[o[1]])){q=xui.create(o[0]);if(a.$panelRestore){a.$panelRestore(q.get(0))}j.append(q,o[1]);r=1}else{if(f[o[2]]){q=xui.create(o[0]);if(a.$panelRestore){a.$panelRestore(q.get(0))}j.append(q,f[o[2]]);r=1}}}if(!r){q=xui.create(o[0]);if(a.$panelRestore){a.$panelRestore(q.get(0))}j.append(q,m)}})}if(xui.isSet(m)){j.setValue(m,true,"items")}if(a.renderId){a.adjustSize()}}},dragSortable:false,valueSeparator:";"},RenderTrigger:function(){this.destroyTrigger=function(){xui.each(this.SubSerialIdMapItem,function(a){xui.breakO(a)});this.properties.items.length=0}},EventHandlers:{beforePrepareItem:function(b,c,a){},beforeIniEditor:function(a,b,c){},onBeginEdit:function(b,c,a){},beforeEditApply:function(d,e,b,c,a){},onEndEdit:function(b,c,a){}},getDropKeys:function(a,c){var b=a.getItemByDom(c);return(b&&b.dropKeys)||a.properties.dropKeys},getDragKey:function(a,c){var b=a.getItemByDom(c);return(b&&b.dragKey)||a.properties.dragKey||(a.properties.dragSortable&&(a.key+":"+a.$xid))},_adjustItems:function(c){if(!xui.isSet(c)){c=[]}if(!xui.isArr(c)){c=[c]}var d=xui.copy(c),b;xui.arr.each(d,function(e,a){if(xui.isArr(e)&&e.length){d[a]={id:e[0]};d[a].id=xui.isSet(d[a].id)?(d[a].id+""):xui.id();if(xui.isSet(e[1])){d[a].caption=e[1]+""}}else{if(xui.isHash(e)){d[a]=xui.copy(e);d[a].id=xui.isSet(d[a].id)?(d[a].id+""):xui.id()}else{d[a]={id:e+""}}}});return d},_showTips:function(c,e,j){if(c.properties.disableTips){return}if(c.onShowTips){return c.boxing().onShowTips(c,e,j)}if(!xui.Tips){return}var b=c.properties,g=e.id,a=c.getSubId(g),f=c.SubSerialIdMapItem,d=f&&f[a];if(d&&("tips" in d)){if(d.tips){xui.Tips.show(j,d)}else{xui.Tips.hide()}return false}else{if(c.properties.autoTips&&d&&"caption" in d){if(d.caption||d.comment){xui.Tips.show(j,{tips:xui.adjustRes((d.caption||"")+(d.caption||d.comment?"<br/>":"")+(d.comment||""),true,false,null,null,d)})}else{xui.Tips.hide()}return false}else{return true}}}}});xui.Class("xui.absValue","xui.absObj",{Instance:{_getCtrlValue:function(){return this.get(0).properties.$UIvalue},_getCtrlCatpionValue:function(){return this.get(0).properties.$UICatpionValue},_setCtrlValue:function(a){return this},_setDirtyMark:function(a){return this.each(function(e){if(!e.renderId){return}var c=e.properties,b=c.value!==c.$UIvalue,g=e.getSubNode(a||e.box.DIRYMARKICON||"KEY"),f=xui.UI.$css_tag_dirty;if(e._dirtyFlag!==b){if(c.dirtyMark&&c.showDirtyMark){if(e.beforeDirtyMark&&false===e.boxing().beforeDirtyMark(e,b)){}else{if(b){g.addClass(f)}else{g.removeClass(f)}}}e._dirtyFlag=b}})},getValue:function(c){var b=this.get(0),d=b.properties,a=d.value;if(b.box.$valuemode=="multi"){if(c){if(xui.isStr(a)){a=a.split(d.valueSeparator)}}}if(b.box.$DataModel.selMode&&(d.selMode=="multi"||d.selMode=="multibycheckbox")&&c){if(xui.isStr(a)){a=a.split(d.valueSeparator)}if(a&&xui.isArr(a)&&a.length>1){a.sort()}}return a},getSelectedItem:function(){var d=this.getUIValue(true),c=this.get(0),a=[],b;if(xui.isArr(d)){if(d.length){xui.arr.each(d,function(e){if(b=c.getItemByItemCaption(e)){a.push(b)}});return a}}else{if(d){return c.getItemByItemCaption(d)}}},setCaptionValue:function(b){var a=this.get(0),c=a.properties;c.$CaptionValue=b},_eachValue:function(c,d,b){var a=this.getUIValue(true);var e=this;xui.each(d.sub,function(f){if(xui.arr.indexOf(a,f[b])>-1){c.push(f.caption)}if(f.sub){c=e._eachValue(c,f,b)}});return c},getCaptionValue:function(c){var f=this.get(0),g=f.properties;var d=[];var e=this;var b=this.getItems("data");var a=this.getUIValue(true);if(!c){c="id"}xui.each(b,function(j){if(xui.isArr(a)){if(xui.arr.indexOf(a,j[c])>-1){d.push(j.caption)}}d=e._eachValue(d,j,c)});captionvalue=d.join(g.valueSeparator);return captionvalue},getUICationValue:function(d){var c=this.get(0),e=c.properties;if(!c.renderId){return e&&e.value}var b=this._getCtrlValue(),a;if(!c.box._checkValid||false!==c.box._checkValid(c,b)){e.caption=b}a=e.caption;if(c.box.$valuemode=="multi"){if(d){if(xui.isStr(a)){a=a.split(e.valueSeparator)}}}if(c.box.$DataModel.selMode&&(e.selMode=="multi"||e.selMode=="multibycheckbox")&&d){if(xui.isStr(a)){a=a.split(e.valueSeparator)}if(a&&xui.isArr(a)&&a.length>1){a.sort()}}return a},getUIValue:function(d){var c=this.get(0),e=c.properties;if(!c.renderId){return e&&e.value}var b=this._getCtrlValue(),a;if(!c.box._checkValid||false!==c.box._checkValid(c,b)){e.$UIvalue=b}a=e.$UIvalue;if(c.box.$valuemode=="multi"){if(d){if(xui.isStr(a)){a=a.split(e.valueSeparator)}}}if(c.box.$DataModel.selMode&&(e.selMode=="multi"||e.selMode=="multibycheckbox")&&d){if(xui.isStr(a)){a=a.split(e.valueSeparator)}if(a&&xui.isArr(a)&&a.length>1){a.sort()}}return a},resetValue:function(b){var a=this;a.each(function(e){var f,g=e.properties,d=e.boxing(),c=typeof(f=e.box._ensureValue)=="function"?f.call(e.box,e,b):b;if(g.value!==c||g.$UIvalue!==c){if(e.box._beforeResetValue){e.box._beforeResetValue(e)}if(typeof(f=e.$onValueSet)=="function"){f=f.call(e,g.value,c);if(xui.isSet(f)){c=f}}e.boxing()._setCtrlValue(g.value=c);g.$UIvalue=c}e._inValid=1;d._setDirtyMark()});return a},setUIValue:function(e,d,c,a){var b=this;this.each(function(g){var n=g.properties,l,m=n.$UIvalue,j=g.boxing();if(d||(m!==e)){if((g.box._checkValid&&false===g.box._checkValid(g,e))||(g.beforeUIValueSet&&false===(l=j.beforeUIValueSet(g,m,e,d,a)))){return}if(l!==undefined&&typeof l!=="boolean"){e=l}if(g.box&&(typeof(l=g.box._ensureValue)=="function")){e=l.call(g.box,g,e)}if(typeof(l=g.$onUIValueSet)=="function"){l=l.call(g,e,d,a);if(xui.isSet(l)){e=l}}var f;if(g.renderId&&!c){f=1;j._setCtrlValue(e)}n.$UIvalue=e;if(g.renderId&&!c){j._setDirtyMark()}if(g.afterUIValueSet){j.afterUIValueSet(g,m,e,d,a)}if(g._onChange){j._onChange(g,m,e,d,a)}if(g.onChange){j.onChange(g,m,e,d,a)}if(!n.dirtyMark){j.setValue(e,false,"uiv",f||c)}if(n.excelCellId&&j.notifyExcel){j.notifyExcel(false)}}});return this},updateValue:function(){return this.each(function(b){var c=b.properties;if(c.value!==c.$UIvalue){var a=b.boxing();if(a.checkValid()){a.setValue(a.getUIValue(),true,"update");a._setDirtyMark()}}})},isDirtied:function(){var a=false;this.each(function(b){var c=b.properties;a=(c.value+" ")!==(c.$UIvalue+" ");if(a){return false}});return a},checkValid:function(d){var e,c,b=true,a=xui.isSet(d);this.each(function(f){e=f.properties;c=true;if(f.box._checkValid2){b=(c=f.box._checkValid2(f))&&b}if(c&&f.box._checkValid){b=f.box._checkValid(f,a?d:e.$UIvalue)&&b}if(!a&&f.renderId){f.boxing()._setDirtyMark()}});return b}},Static:{$abstract:true,DataModel:{readonly:{ini:false,action:function(a){var b=this.getRoot();if(a){b.addClass("xui-ui-readonly")}else{b.removeClass("xui-ui-readonly")}}},required:{ini:false,action:function(a){if(a){this.getRoot().addClass("xui-required-field")}else{this.getRoot().removeClass("xui-required-field")}}},value:{ini:null,set:function(g,d,l,b){var e=this,c=e.properties,a,j=c.value,f=e.boxing();if(e.box._checkValid&&e.box._checkValid(e,g)===false){return}if(e.beforeValueSet&&false===(a=f.beforeValueSet(e,j,g,d,l))){return}if(a!==undefined){g=a}if(typeof(a=e.box._ensureValue)=="function"){g=a.call(e.box,e,g)}if(typeof(a=e.$onValueSet)=="function"){a=a.call(e,j,g,d,l);if(xui.isSet(a)){g=a}}if(e.renderId&&!b){f._setCtrlValue(g)}c.value=c.$UIvalue=g;if(!e._inValid){e._inValid=1}if(e.renderId){f._setDirtyMark()}if(e.afterValueSet){f.afterValueSet(e,j,g,d,l)}if(e.onValueChange){f.onValueChange(e,j,g,d,l)}}},isFormField:true,dirtyMark:true,showDirtyMark:true},_ensureValues:xui.UI._ensureValues,_ensureValue:function(a,b){var c=a.properties;if(a.box.$DataModel.selMode&&(c.selMode=="multi"||c.selMode=="multibycheckbox")){if(!xui.isArr(b)){b=(b?(""+b):"").split(c.valueSeparator)}b.sort();return b.join(c.valueSeparator)}else{return xui.isArr(b)?b[0]:b}},EventHandlers:{beforeValueSet:function(c,b,e,d,a){},afterValueSet:function(c,b,e,d,a){},onValueChange:function(c,b,e,d,a){},beforeUIValueSet:function(c,b,e,d,a){},afterUIValueSet:function(c,b,e,d,a){},onChange:function(c,b,e,d,a){},_onChange:function(c,b,e,d,a){},beforeDirtyMark:function(b,a){}},RenderTrigger:function(){var c=this,a=c.boxing(),e=c.properties,d;if(!c.behavior.PanelKeys){if(d=e.dataBinder){a.setDataBinder(d,true)}if(d=e.dataField){a.setDataField(d)}}if(e.value!==undefined){if(typeof(d=c.box._ensureValue)=="function"){e.value=d.call(c.box,c,e.value);if(e.$UIvalue){e.$UIvalue=d.call(c.box,c,e.$UIvalue)}}if(!e.$UIvalue){e.$UIvalue=e.value}a._setCtrlValue(e.$UIvalue,true)}}}});xui.Class("xui.UI.Widget","xui.UI",{Static:{Appearances:{KEY:{},IE67_SHADOW:(xui.browser.ie&&xui.browser.ver<=8)?{"z-index":"-1",position:"absolute",left:0,top:0,width:"100%",height:"100%",overflow:"visible"}:null},Templates:{className:"xui-uiw-shell {_className} {_requiredfld}",style:"{_style}",IE67_SHADOW:(xui.browser.ie&&xui.browser.ver<=8)?{}:null,FRAME:{$order:2,className:"xui-uiw-frame ",BORDER:{$order:1,style:"width:{bWidth};height:{bHeight};",className:"xui-uiw-border"}}},DataModel:{width:{$spaceunit:1,ini:"10em"},height:{$spaceunit:1,ini:"10em"},shadow:{ini:false,action:function(a){if(xui.browser.ie&&xui.browser.ver<=8){var b=this.getSubNode("IE67_SHADOW");if(a){b.addClass("xui-ui-shadow xui-uiborder-r xui-uiborder-b xui-uiborder-radius-br")}else{b.removeClass("xui-ui-shadow xui-uiborder-r xui-uiborder-b xui-uiborder-radius-br")}}else{var b=this.getSubNode("BORDER");if(a){b.addClass("xui-ui-shadow")}else{b.removeClass("xui-ui-shadow")}}}},$hborder:0,$vborder:0},RenderTrigger:function(){var a=this,b=a.properties,c=a.boxing();if(a.renderId){if((!a.$noB)&&b.border&&c._border){c._border()}}if((!a.$noR)&&b.resizer&&c.setResizer){c.setResizer(b.resizer,true)}if((!a.$noS)&&b.shadow&&c.setShadow){c.setShadow(true,true)}},_onresize:function(d,b,r){var a=d.properties,j=d.getSubNode("BORDER"),g=j.contentBox(),q=(xui.browser.ie&&xui.browser.ver<=8)?d.getSubNode("IE67_SHADOW"):null,o,f=xui.$us(d),m=function(s,u){return d.$forceu(s,f>0?"em":"px",u)},l=d.$px(b),e=d.$px(r),c=!g?0:Math.max(0,(a.$b_lw||0)-(a.$hborder||0)),n=!g?0:Math.max(0,(a.$b_tw||0)-(a.$vborder||0));if(l&&"auto"!==l){l-=!g?0:Math.max((a.$hborder||0)*2,(a.$b_lw||0)+(a.$b_rw||0));if(xui.browser.ie&&xui.browser.ver<=6){l=(d.$px(l/2))*2}}if(e&&"auto"!==e){e-=!g?0:Math.max((a.$vborder||0)*2,(a.$b_lw||0)+(a.$b_rw||0));if(xui.browser.ie&&xui.browser.ver<=6){e=(d.$px(e/2))*2}if(xui.browser.ie&&xui.browser.ver<=6&&null===b){j.ieRemedy();if(q){q.ieRemedy()}}}o={left:m(c),top:m(n),width:m(l),height:m(e)};j.cssRegion(o);if(q){q.cssRegion(o)}if((d.$resizer)&&xui.browser.ie){j.ieRemedy();if(q){q.ieRemedy()}}return o}}});xui.Class("xui.UI.Link","xui.UI",{Instance:{fireClickEvent:function(){this.getRoot().onClick();return this}},Static:{Appearances:{KEY:{cursor:"pointer"}},Templates:{tagName:"a",className:"{_className}",style:"{_style}",href:"{href}",target:"{target}",tabindex:"{tabindex}",text:"{caption}"},Behaviors:{HoverEffected:{KEY:"KEY"},ClickEffected:{KEY:"KEY"},onClick:function(b,d,f){var c;if(!b.properties.disabled&&b.onClick){c=b.boxing().onClick(b,d,f)}var a=xui.use(f).attr("href");return typeof c=="boolean"?c:(a.indexOf("javascript:")===0||a.indexOf("#")===0)?false:true}},DataModel:{caption:{ini:undefined,action:function(a){a=(xui.isSet(a)?a:"")+"";this.getRoot().html(xui.adjustRes(a,true))}},href:{ini:xui.$DEFAULTHREF,action:function(a){this.getRoot().attr("href",a)}},target:{action:function(a){this.getRoot().attr("target",a)}}},EventHandlers:{onClick:function(a,b){}}}});xui.Class("xui.UI.Element","xui.UI",{Instance:{fireClickEvent:function(){this.getRoot().onClick();return this}},Static:{_objectProp:{attributes:1},Templates:{_NativeElement:true,tagName:"{nodeName}",className:"xui-node xui-wrapper {_className}",style:"{_style};",tabindex:"{tabindex}",text:"{html}"+xui.UI.$childTag},DataModel:{width:{$spaceunit:1,ini:"8em"},height:{$spaceunit:1,ini:"1em"},nodeName:{ini:"xui",action:function(a){this.boxing().refresh()}},selectable:true,html:{html:1,action:function(a,b,c){this.getRoot().html(xui.adjustRes(a,0,1),null,null,c)}},attributes:{ini:{},action:function(b,c){var a=this.getRoot();if(!xui.isEmpty(c)){xui.each(c,function(e,d){a.attr(d,null)})}if(!xui.isEmpty(b)){xui.each(b,function(e,d){a.attr(d,e)})}}},tabindex:-1},Appearances:{KEY:{"line-height":"normal"}},Behaviors:{HoverEffected:{KEY:"KEY"},onClick:function(a,c,d){var b=a.properties;if(b.disabled){return false}if(a.onClick){return a.boxing().onClick(a,c,d)}}},EventHandlers:{onClick:function(a,c,b){}},RenderTrigger:function(){var b=this.properties.attributes;if(!xui.isEmpty(b)){var a=this.getRoot();xui.each(b,function(d,c){a.attr(c,d)})}}}});xui.Class("xui.UI.Icon","xui.UI",{Instance:{fireClickEvent:function(){this.getRoot().onClick();return this}},Static:{Templates:{className:"xui-node xui-wrapper {_className}  {picClass}",style:"{_style};",ICON:{className:"xuicon {imageClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{imageDisplay}{_fontsize}{_fontclr}{iconStyle}",text:"{iconFontCode}"}},DataModel:{selectable:null,html:null,attributes:null,renderer:null,defaultFocus:null,tabindex:-1,image:{format:"image",action:function(a){xui.UI.$iconAction(this)}},imagePos:{action:function(a){this.getSubNode("ICON").css("backgroundPosition",a||"center")}},imageBgSize:{action:function(a){this.getSubNode("ICON").css("backgroundSize",a||"")}},imageClass:{ini:"",action:function(a,b){xui.UI.$iconAction(this,"ICON",b)}},iconFontCode:{action:function(a){xui.UI.$iconAction(this)}},iconFontSize:{action:function(a){this.getSubNode("ICON").css("fontSize",a||"")}},iconColor:{type:"color",action:function(a){this.getSubNode("ICON").css("color",a||"")}}},Appearances:{KEY:{overflow:"visible"},ICON:{position:"relative",display:xui.$inlineBlock,zoom:xui.browser.ie?1:null}},Behaviors:{HoverEffected:{ICON:"ICON"},ClickEffected:{ICON:"ICON"},onClick:function(a,c,d){var b=a.properties;if(b.disabled){return false}if(a.onClick){return a.boxing().onClick(a,c,d)}}},EventHandlers:{onClick:function(a,c,b){}},_prepareData:function(a){var b=arguments.callee.upper.call(this,a);if(b.iconFontSize){b._fontsize=b.iconFontSize+";"}if(b.iconColor){b._fontclr="color:"+b.iconColor+";"}return b}}});xui.Class("xui.UI.HTMLButton","xui.UI.Element",{Instance:{activate:function(){this.getRoot().focus(true);return this}},Static:{Templates:{tagName:"button",className:"xui-ui-unselectable xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius {_className}",style:"{_style}{_fc}{_fw}{_fs}{_ff};",tabindex:"{tabindex}",text:"{caption}"+xui.UI.$childTag},Appearances:{KEY:{cursor:"pointer",padding:".334em"}},DataModel:{nodeName:null,tabindex:1,width:"auto",height:"auto",html:{hidden:1,get:function(){return this.boxing().getCaption()},set:function(a,b){return this.boxing().setCaption(a,b)}},caption:{ini:undefined,action:function(a){a=(xui.isSet(a)?a:"")+"";this.getRoot().html(xui.adjustRes(a,0,1))}},disabled:{ini:false,action:function(b){var c=this.getRoot(),a="xui-ui-disabled";if(b){this.getRoot().addClass(a)}else{this.getRoot().removeClass(a)}c.attr("disabled",b?"1":null)}},shadow:{ini:false,action:function(a){var b=this.getRoot();if(a){b.addClass("xui-ui-shadow")}else{b.removeClass("xui-ui-shadow")}}},fontColor:{ini:"",type:"color",action:function(a){this.getRoot().css("color",a)}},fontSize:{combobox:["","14px","18px","22px","30px"],action:function(a){this.getRoot().css("fontSize",a)}},fontWeight:{combobox:["","normal","bolder","bold","lighter","100","200","300","400","500","600","700","800","900"],action:function(a){this.getRoot().css("fontWeight",a)}},fontFamily:{combobox:["","arial","sans-serif","comic","courier new","monospace","serif","times new roman","wingdings"],action:function(a){this.getRoot().css("fontFamily",a)}}},_prepareData:function(b,c){c=arguments.callee.upper.call(this,b,c);var a;if(c.clock){c.caption=""}if(a=c.fontSize){c._fs="font-size:"+a+";"}if(a=c.fontWeight){c._fw="font-weight:"+a+";"}if(a=c.fontColor){c._fc="color:"+a+";"}if(a=c.fontFamily){c._ff="font-family:"+a+";"}c._hAlign="text-align:"+(c.hAlign||"");c._vAlign="vertical-align:"+(c.vAlign||"");return c},RenderTrigger:function(){var a=this,b=a.properties,c=a.boxing();if((!a.$noS)&&b.shadow&&c.setShadow){c.setShadow(true,true)}},Behaviors:{HoverEffected:{KEY:"KEY"}}}});xui.Class("xui.UI.Button",["xui.UI.HTMLButton","xui.absValue"],{Initialize:function(){xui.UI.SButton=xui.UI.Button;var a="xui.UI.SButton";xui.absBox.$type[a.replace("xui.UI.","")]=xui.absBox.$type[a]=a;this.$activeClass$="xui.UI.Button"},Instance:{activate:function(){this.getRoot().focus(true);return this},_setCtrlValue:function(a){if(xui.isNull(a)||!xui.isDefined(a)){a=false}return this.each(function(c){var b=c.properties;if(b.type!="status"){return}c.getRoot().tagClass("-checked",a)})},resetValue:function(c){this.each(function(d){if(d.properties.type=="drop"){d.boxing().setCaption("",true)}});var a=arguments.callee.upper,b=a.apply(this,xui.toArr(arguments));a=null;return b},setUIValue:function(d,c){this.each(function(e){var f=e.properties;if(f.$UIvalue!==d&&f.type=="drop"){e.boxing().setCaption("",true)}});var a=arguments.callee.upper,b=a.apply(this,xui.toArr(arguments));a=null;return b}},Static:{DIRYMARKICON:"BACKGROUND",Templates:{tagName:"button",className:"xui-ui-unselectable xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius {_className}",style:"{_align}{_style}{_fc}{_fw}{_fs}{_ff};",tabindex:"{tabindex}",BACKGROUND:{tagName:"div"},ICON:{$order:1,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{$order:2,className:"",text:"{caption}"},DROP:{$order:3,className:"xuifont xui-special-icon",style:"{_showDrop}",$fonticon:"xui-uicmd-arrowdrop"}},Appearances:{BACKGROUND:{"z-index":-1,position:"absolute",left:0,top:0,width:"100%",height:"100%"},DROP:{"vertical-align":"middle","padding-left":".66667em"}},Behaviors:{HoverEffected:{KEY:["KEY","DROP"]},NavKeys:{KEY:1},onClick:function(c,f,g){var d=c.properties;if(d.disabled){return false}var a=c.boxing();if(d.type=="status"){if(d.readonly){return false}a.setUIValue(!d.$UIvalue,null,null,"click");if(c.onChecked){a.onChecked(c,f,d.$UIvalue)}}if(c.onClick){return a.onClick(c,f,g,d.$UIvalue)}if(d.type=="drop"&&c.onClickDrop){return a.onClickDrop(c,f,g,d.$UIvalue)}},onKeydown:function(b,d,f){var c=xui.Event.getKey(d),a=c.key;if(a==" "||a=="enter"){b.getSubNode("KEY").afterMousedown();b.__fakeclick=1}},onKeyup:function(b,d,f){var c=xui.Event.getKey(d),a=c.key;if(a==" "||a=="enter"){b.getSubNode("KEY").afterMouseup();if(b.__fakeclick){xui.use(f).onClick()}}delete b.__fakeclick}},DataModel:{html:null,image:{format:"image",action:function(a){xui.UI.$iconAction(this)}},imagePos:{action:function(a){this.getSubNode("ICON").css("backgroundPosition",a||"center")}},imageBgSize:{action:function(a){this.getSubNode("ICON").css("backgroundSize",a||"")}},imageClass:{ini:"",action:function(a,b){xui.UI.$iconAction(this,"ICON",b)}},iconFontCode:{action:function(a){xui.UI.$iconAction(this)}},caption:{ini:undefined,action:function(a){a=(xui.isSet(a)?a:"")+"";this.getSubNode("CAPTION").html(xui.adjustRes(a,0,1))}},hAlign:{ini:"center",listbox:["left","center","right"],action:function(a){this.getRoot().css("textAlign",a)}},vAlign:{ini:"middle",listbox:["top","middle","bottom"],action:function(a){}},value:{ini:false},fontColor:{action:function(a){this.getSubNode("CAPTION").css("color",a)}},fontSize:{combobox:["","14px","18px","22px",".75em","1.5em","2em","3em"],action:function(a){this.getSubNode("CAPTION").css("fontSize",a)}},fontWeight:{action:function(a){this.getSubNode("CAPTION").css("fontWeight",a)}},fontFamily:{action:function(a){this.getSubNode("CAPTION").css("fontFamily",a)}},type:{ini:"normal",listbox:["normal","status","drop"],action:function(c){var b=this,a=b.getSubNode("DROP");if(c=="drop"){a.css("display","")}else{a.css("display","none")}}}},_isFormField:function(a){return a.properties.type=="status"&&a.properties.isFormField},_ensureValue:function(a,b){if(a.properties.type=="status"){return !!b}else{return b}},_prepareData:function(b,c){var c=arguments.callee.upper.call(this,b);var a;if(c.clock){c.caption=""}if(a=c.fontSize){c._fs="font-size:"+a+";"}if(a=c.fontWeight){c._fw="font-weight:"+a+";"}if(a=c.fontColor){c._fc="color:"+a+";"}if(a=c.fontFamily){c._ff="font-family:"+a+";"}c._hAlign="text-align:"+(c.hAlign||"");c._vAlign="vertical-align:"+(c.vAlign||"");c._showDrop=c.type=="drop"?"":"display:none";return c},RenderTrigger:function(){var a=this,b=a.properties,c=a.boxing();if(b.type=="status"&&b.value){c.setValue(true,true,"render")}},EventHandlers:{onClick:function(a,c,d,b){},onClickDrop:function(a,c,d,b){},onChecked:function(a,c,b){}}}});xui.Class("xui.UI.Span","xui.UI",{Instance:{fireClickEvent:function(){this.getRoot().onClick();return this}},Static:{Templates:{className:"{_className}",style:"{_style};{_overflow};",tabindex:"{tabindex}",text:"{html}"+xui.UI.$childTag},DataModel:{width:{$spaceunit:1,ini:"2em"},height:{$spaceunit:1,ini:"1em"},selectable:true,html:{html:1,action:function(a,b,c){this.getRoot().html(xui.adjustRes(a,0,1),null,null,c)}},overflow:{ini:xui.browser.deviceType=="touchOnly"?"auto":undefined,combobox:["","visible","hidden","scroll","auto","overflow-x:hidden;overflow-y:auto","overflow-x:auto;overflow-y:hidden"],action:function(a){var b=this.getContainer();if(a){if(a.indexOf(":")!=-1){xui.arr.each(a.split(/\s*;\s*/g),function(d){var c=d.split(/\s*:\s*/g);if(c.length>1){b.css(xui.str.trim(c[0]),xui.str.trim(c[1]||""))}});return}}b.css("overflow",a||"")}},tabindex:-1},Appearances:{KEY:{"line-height":"normal"}},Behaviors:{HoverEffected:{KEY:"KEY",ICON:"ICON"},onClick:function(a,c,d){var b=a.properties;if(b.disabled){return false}if(a.onClick){return a.boxing().onClick(a,c,d)}}},EventHandlers:{onClick:function(a,c,b){}},_prepareData:function(a,b){b=arguments.callee.upper.call(this,a,b);if(xui.isStr(b.overflow)){b._overflow=b.overflow.indexOf(":")!=-1?(b.overflow):(b.overflow?("overflow:"+b.overflow):"")}return b}}});xui.Class("xui.UI.Div","xui.UI",{Initialize:function(){xui.UI.Pane=xui.UI.Div;var a="xui.UI.Pane";xui.absBox.$type[a.replace("xui.UI.","")]=xui.absBox.$type[a]=a;this.$activeClass$="xui.UI.Div"},Instance:{fireClickEvent:function(){this.getRoot().onClick();return this}},Static:{Appearances:{KEY:{outline:xui.browser.gek?"none":null,zoom:(xui.browser.ie&&xui.browser.ver<9)?"1":null,background:xui.browser.ie?"url("+xui.ini.img_bg+") no-repeat left top":null,"line-height":"normal"}},Templates:{tagName:"div",className:"xui-uicontainer {_className}",style:"{_style};{_panelstyle};{_overflow};",tabindex:"{tabindex}",text:"{html}"+xui.UI.$childTag},DataModel:{iframeAutoLoad:{ini:"",action:function(){this.box._applyAutoLoad(this)}},ajaxAutoLoad:{ini:"",action:function(){this.box._applyAutoLoad(this)}},width:{$spaceunit:1,ini:"10em"},height:{$spaceunit:1,ini:"10em"},selectable:true,html:{html:1,action:function(a,b,c){this.getRoot().html(xui.adjustRes(a,0,1),null,null,c)}},overflow:{ini:xui.browser.deviceType=="touchOnly"?"auto":undefined,combobox:["","visible","hidden","scroll","auto","overflow-x:hidden;overflow-y:auto","overflow-x:auto;overflow-y:hidden"],action:function(a){var b=this.getContainer();if(a){if(a.indexOf(":")!=-1){xui.arr.each(a.split(/\s*;\s*/g),function(d){var c=d.split(/\s*:\s*/g);if(c.length>1){b.css(xui.str.trim(c[0]),xui.str.trim(c[1]||""))}});return}}b.css("overflow",a||"")}},tabindex:-1},RenderTrigger:function(){var a=this;if(a.box.KEY=="xui.UI.Div"){if(a.properties.iframeAutoLoad||a.properties.ajaxAutoLoad){a.box._applyAutoLoad(this)}}},Behaviors:{DroppableKeys:["KEY"],PanelKeys:["KEY"],onClick:function(a,c,d){var b=a.properties;if(b.disabled){return false}if(a.onClick){return a.boxing().onClick(a,c,d)}}},EventHandlers:{onClick:function(a,c,b){}},_prepareData:function(a,b){b=arguments.callee.upper.call(this,a,b);if(xui.isStr(b.overflow)){b._overflow=b.overflow.indexOf(":")!=-1?(b.overflow):(b.overflow?("overflow:"+b.overflow):"")}return b},_applyAutoLoad:function(d){var a=d.properties,j=d.boxing();if(a.iframeAutoLoad){j.getContainer().css("overflow","hidden");var m=typeof a.iframeAutoLoad=="string"?{url:a.iframeAutoLoad}:xui.clone(a.iframeAutoLoad,true),b="biframe_"+xui.stamp(),l=xui.browser.ie&&xui.browser.ver<9,f=document.createElement(l?"<iframe name='"+b+"'>":"iframe");m.url=xui.adjustRes(m.url,false,true);f.id=f.name=b;if(xui.isHash(a.iframeAutoLoad)){a.iframeAutoLoad.frameName=b}a._frameName=b;if(!m.query){m.query={}}m.query._rand=xui.rand();f.frameBorder="0";f.marginWidth="0";f.marginHeight="0";f.vspace="0";f.hspace="0";f.allowTransparency="true";f.width="100%";f.height="100%";j.getContainer().html("",false);j.append(f);if((m.method||"").toLowerCase()=="post"){xui.Dom.submit(m.url,m.query,"post",b,m.enctype)}else{f.src=m.url}if(d.$afterAutoLoad){d.$afterAutoLoad.call(d.boxing(),d)}}else{if(a.ajaxAutoLoad){var g=typeof a.ajaxAutoLoad=="string"?{url:a.ajaxAutoLoad}:xui.clone(a.ajaxAutoLoad,true),n={rspType:"text"};if(!g.query){g.query={}}g.query._rand=xui.rand();xui.merge(n,g.options);j.busy();var c=j.getContainer();xui.Ajax(xui.adjustRes(g.url,false,true),g.query,function(e){c.html(e,true,true);if(d.$afterAutoLoad){d.$afterAutoLoad.call(d.boxing(),d)}j.free()},function(e){c.html("<div>"+e+"</div>",true,false);if(d.$afterAutoLoad){d.$afterAutoLoad.call(d.boxing(),d)}j.free()},null,n).start()}}},_onresize:function(b,a){if(a){xui.UI._adjustConW(b,b.getRoot(),b)}}}});xui.Class("xui.UI.CSSBox","xui.UI.Span",{Instance:{fireClickEvent:null,adjustDock:null,draggable:null,busy:null,free:null},Static:{$initRootHidden:true,_objectProp:{normalStatus:1,hoverStatus:1,activeStatus:1,focusStatus:1},Templates:{style:"left:"+xui.Dom.HIDE_VALUE+";top:"+xui.Dom.HIDE_VALUE+";width:12.5em;height:5em;visibility:hidden;display:none;position:absolute;z-index:0;",className:"{_className}",text:"{_html}"},DataModel:{customCss:{ini:null,action:function(){this.box._refreshCSS(this)}},className:{ini:null,action:function(){this.box._refreshCSS(this)}},sandbox:{ini:"",action:function(a){this.box._refreshCSS(this)}},normalStatus:{ini:{},action:function(a){this.box._refreshCSS(this)}},hoverStatus:{ini:{},action:function(a){this.box._refreshCSS(this)}},activeStatus:{ini:{},action:function(a){this.box._refreshCSS(this)}},focusStatus:{ini:{},action:function(a){this.box._refreshCSS(this)}},spaceUnit:null,showEffects:null,hideEffects:null,position:null,display:null,visibility:null,zIndex:null,left:null,top:null,width:null,height:null,right:null,bottom:null,rotate:null,activeAnim:null,hoverPop:null,hoverPopType:null,dock:null,dockStretch:null,dockIgnoreFlexFill:null,renderer:null,display:null,html:null,selectable:null,overflow:null,tabindex:null,autoTips:null,disableClickEffect:null,disableHoverEffect:null,disableTips:null,disabled:null,defaultFocus:null,dockStretch:null,dockIgnore:null,dockOrder:null,dockMargin:null,dockFloat:null,dockMinW:null,dockMinH:null,dockMaxW:null,dockMaxH:null,tips:null},$adjustProp:function(d,e){var g=d.properties,a=(!e&&g.className)||("xui-css-"+d.$xid),b,c=1,f={};d.box.getAll().each(function(j){if(j!==d){f[j.properties.className]=1}});while(f[a]){a=a+(c++)}g.className=a},RenderTrigger:function(){var a=this;if(!a.$inDesign){xui("body").append(a.getRoot())}},_prepareData:function(b,c){c=arguments.callee.upper.call(this,b,c);var a=this._getCon(b);c._html="Text"+(a?("<style id='"+b.getDomId()+"cssnode' type='text/css'>"+a+"</style>"):"");return c},_getCon:function(e){var j="",n="",l,a=e.properties,m=a.className,c=a.customCss,g=a.normalStatus,f=a.hoverStatus,d=a.activeStatus,b=a.focusStatus;if(!c){if(g&&!xui.isEmpty(g)){j+="."+m+"{"+xui.Dom.$adjustCss(g,true)+"}\n";if(g.color){j+="."+m+" .xui-node{color:"+g.color+"}"}}}else{j=c}if(f&&!xui.isEmpty(f)){j+="."+m+":hover, ."+m+"-hover{"+xui.Dom.$adjustCss(f,true)+"}\n";if(f.color){j+="."+m+" .xui-node{color:"+f.color+"}"}}if(d&&!xui.isEmpty(d)){j+="."+m+":active, ."+m+":checked, ."+m+"-active, ."+m+"-checked, ."+m+"-checked:hover, ."+m+"-active:hover{"+xui.Dom.$adjustCss(d,true)+"}";if(d.color){j+="."+m+" .xui-node{color:"+d.color+"}"}}if(b&&!xui.isEmpty(b)){j+="."+m+":focus, ."+m+"-focus{"+xui.Dom.$adjustCss(b,true)+"}";if(b.color){j+="."+m+" .xui-node{color:"+b.color+"}"}}if(l=a.sandbox){l=(e.host&&e.host[l]&&e.host[l].get(0))||(xui(l).get(0)&&l);if(l){n=xui.UI._getThemePrevId(l)}}else{if(e.$inDesign){if(l=e.parent){n=xui.UI._getThemePrevId(l)}}}return xui.UI._adjustCSS(j,n)},_refreshCSS:function(b){var a=this;xui.resetRun(b.key+":"+b.$xid,function(){if(b.destroyed){return}var f=b.getDomId()+"cssnode",e=b.properties,c=b.getRoot(),d=a._getCon(b);c.query("style").remove(false);xui.Dom._setClass(c.get(0),e.className);if(d){xui.CSS._appendSS(c.get(0),d,f,false)}})},EventHandlers:{beforeInputAlert:null,onContextmenu:null,onClick:null,onDock:null,onLayout:null,onMove:null,onRender:null,onResize:null,onShowTips:null,beforeHoverEffect:null,beforeAppend:null,afterAppend:null,beforeRender:null,afterRender:null,beforeRemove:null,afterRemove:null,onHotKeydown:null,onHotKeypress:null,onHotKeyup:null}}});xui.Class("xui.UI.MoudluePlaceHolder","xui.UI.Div",{Instance:{destroy:function(a,b){var c=this.get(0);if(!c){return}(c.$afterDestroy=(c.$afterDestroy||{}))["destroyAttachedModule"]=function(){if(!this._replaced&&this._module){this._module.destroy(a,b)}};return arguments.callee.upper.apply(this,[a,b])},adjustDock:null,draggable:null,busy:null,free:null,setProperties:function(b,c){var a=this.get(0);if(!a._properties){a._properties={}}if(!b){a._properties={}}else{if(typeof b=="string"){a._properties[b]=c}else{xui.merge(a._properties,b,"all");if(c&&xui.isHash(c)){xui.merge(a._properties,c,"all")}}}return this},getValue:function(){return xui.get(this.get(0),["_properties","value"])},setValue:function(a){xui.set(this.get(0),["_properties","value"],a);return this},getUIValue:function(){return this.get(0)._$UIvalue},setUIValue:function(a){this.get(0)._$UIvalue=a;return this},getProperties:function(b){var a=this.get(0);if(!a._properties){a._properties={}}return b?a._properties[b]:a._properties},setEvents:function(b,c){var a=this.get(0);if(!a._events){a._events={}}if(!b){a._events={}}else{if(typeof b=="string"){a._events[b]=c}else{xui.merge(a._events,b,"all")}}return this},getEvents:function(b){var a=this.get(0);if(!a._events){a._events={}}return b?this._events[b]:this._events},replaceWithModule:function(f){var b=this,j=b.get(0),a,e,g,d,c=function(l){if(j.$afterReplaced){j.$afterReplaced.call(f)}if((l=j._render_holder||j._inline_holder)&&l.$afterAttached){f.getUIComponents().each(function(m){xui.tryF(l.$afterAttached,[m],l)})}j.alias=null;j._module=null;if(j.box){j.boxing().destroy()}};if(!j||j.destroyed||j._replaced||!j.getRootNode()){return}j._replaced=1;if(j.$beforeReplaced){j.$beforeReplaced.call(f)}if(j.host||j.alias){f.setHost(j.host,j.alias)}if("_$UIvalue" in j){f.$UIvalue=j._$UIvalue}if(e=j._events){f.setEvents(e)}if(e=j._properties){f.setProperties(e)}if(j.moduleClass&&j.moduleXid){if(a=xui.Module.getInstance(j.moduleClass,j.moduleXid)){a.AddComponents(f)}}if(g=j.parent){d=j.childrenId;f.show(c,g,d)}else{if(j.rendered&&(g=j.getRoot().parent())&&!g.isEmpty()){f.show(c,g)}}if(j.$afterReplaced){j.$afterReplaced.call(f)}j.alias=null;j._module=null;b.destroy()}},Static:{Templates:{tagName:"div",style:"left:0;top:0;width:0;height:0;visibility:hidden;display:none;position:absolute;z-index:0;"},DataModel:{showEffects:null,hideEffects:null,activeAnim:null,hoverPop:null,hoverPopType:null,dock:null,dockStretch:null,renderer:null,html:null,disableClickEffect:null,disableHoverEffect:null,disableTips:null,disabled:null,defaultFocus:null,dockStretch:null,dockIgnore:null,dockOrder:null,dockMargin:null,dockFloat:null,dockMinW:null,dockMinH:null,dockMaxW:null,dockMaxH:null,tips:null},EventHandlers:{onContextmenu:null,onDock:null,onLayout:null,onMove:null,onRender:null,onResize:null,onShowTips:null,beforeAppend:null,afterAppend:null,beforeRender:null,afterRender:null,beforeRemove:null,afterRemove:null,onHotKeydown:null,onHotKeypress:null,onHotKeyup:null},RenderTrigger:function(){var a=this;if(a&&!a._replaced&&a._module){a.boxing().replaceWithModule(a._module)}}}});xui.Class("xui.AnimBinder","xui.absObj",{Instance:{_ini:xui.Timer.prototype._ini,_after_ini:function(c,a,b){if(!c.name){c.Instace.setName(b)}},getParent:xui.Timer.prototype.getParent,getChildrenId:xui.Timer.prototype.getChildrenId,destroy:function(){this.each(function(b){var c=b.box,a=b.properties.name;delete c._pool[a];b.__gc()})},setHost:function(c,b){var a=this;if(c&&b){a.setName(b)}return arguments.callee.upper.apply(a,arguments)},apply:function(e,a){var d=this.get(0),r=d.properties.frames,o=[],c,q,n,b;for(var m=0,f=r.length;m<f-1;m++){b={};q=r[m];n=r[m+1];c=xui.copy(n);delete c.status;for(var g in n.status){b[g]=n.status[g]}c.endpoints=b;c.start=q;c.end=n;o.push(c)}var s=function(){if(!o.length){if(d.onEnd){d.boxing().onEnd(d)}if(xui.isFun(a)){xui.tryF(a)}return}var j=o.shift();if(d.beforeFrame&&false===d.boxing().beforeFrame(d,j)){return}return xui(e).animate(j.endpoints,null,s,j.duration,j.step,j.type,null,null,j.restore,j.times).start()};return s()}},Static:{_objectProp:{tagVar:1,propBinder:1,frames:1},_beforeSerialized:xui.Timer._beforeSerialized,$nameTag:"ani_",_pool:{},destroyAll:function(){this.pack(xui.toArr(this._pool,false),false).destroy();this._pool={}},getFromName:function(a){var b=this._pool[a];return b&&b.boxing()},DataModel:{dataBinder:null,dataField:null,name:{set:function(f){var j=this,g=j.properties.name,l=j.box,a=l._pool,b=a[g],d=a[f],e;a[j.properties.name=f]=j;if(d&&!b){j._n=d._n}if(b){delete a[g]}}},frames:{ini:[]}},EventHandlers:{beforeFrame:function(a,b){},onEnd:function(a){}}}});xui.Class("xui.Coder",null,{Initialize:function(){xui.CSS.addStyleSheet('.sh {font-family: "Courier New" , Courier, mono;border: 1px solid #92D1E4;background:#fff;}.sh .sh-con{padding-bottom:3px;font-size: 12px;background-color: #fff;}.sh .sh-cmd{padding: 3px 8px 3px 8px;font-size: 12px;font-family: Verdana, Geneva, Arial, Helvetica, sans-serif;color: silver;border-bottom: 1px solid #EBEADB;}.sh .sh-cmd a{color: blue;text-decoration: none;margin-right: 10px;}.sh .sh-cmd a:hover{color: red;}.sh .cmd-ruler{width:25px;}.sh .sh-toggle{width:16px;cursor:pointer;font-size:120%;color:blue;vertical-align:baseline;}.sh ol{color: #FF97A9; margin: 0px 0px 0px 45px; padding: 0; border-bottom: 1px solid #EBEADB; }.sh ol li{color: #000157;border-left: 3px solid #6CE26C;padding-left: 10px;line-height: 14px;list-style: decimal none;margin:0;/*border-bottom: 1px dashed #E2E2E2;*/}.sh-con span{vertical-align:inherit;'+(xui.browser.ie?"zoom:0;":"")+"}.sh .js .comment, .sh .php .comment{ color: green; }.sh .js .string, .sh .php .string{ color: #ff1493; }.sh .js .reg, .sh .php .reg{ color: #ff1493; }.sh .js .number,.sh .php .number { color: darkred; }.sh .js .keyword, .sh .php .keyword{ color: blue; }.sh .js .keyword2, .sh .php .keyword2 { font-weight: bold; color: red; }.sh .js .special, .sh .php .special{ font-weight: bold; color: navy; }.sh .php .vars{color:#079BFA}.sh .css .comment { color: green; }.sh .css .string { color: red; }.sh .css .colors { color: darkred; }.sh .css .vars { color: #d00; }.sh .css .number { color: blue; }.sh .css .keyword {color:teal;}.sh .css .selector {font-weight: bold; color: navy;}.sh .html .comment { color: green; }.sh .html .string{ color: #ff1493; }.sh .html .script{ color: #ff1493; }.sh .html .attr { color: blue; }.sh .html .speical{color:#079BFA}.sh .html .tag { font-weight: bold; color: navy; }",this.KEY);this._profiles={js:{multicomment:this.$COM_REG.BLOCK_COMMENT,comment:this.$COM_REG.LINE_COMMENT,reg:this.$COM_REG.REG,string1:this.$COM_REG.DQ_STRING,string2:this.$COM_REG.SQ_STRING,number:this.$COM_REG.NUMBER,keyword:"try|throw|catch|finally|arguments|break|case|continue|default|delete|do|else|false|for|function|if|in|instanceof|new|null|return|switch|this|true|typeof|var|void|while|with|toString|valueOf|window|prototype|document|escape|unescape|parseInt|parseFloat|setTimeout|clearTimeout|setInterval|clearInterval|NaN|isNaN|Infinity|Error",keyword2:"exists|isNull|isObj|isEmpty|isArr|isBool|isDate|isFun|isHash|isNumb|isStr|xui.arr|xui.bool|xui.cls|xui.date|xui.fun|xui.hash|xui.numb|xui.str|xui.id|_|alias|host|append|toArr|breakO|tryF|each|copy|clone|filter|asyRun|resetRun|merge|each|swap|removeFrom|filter|indexOf|clean|insertAny|serialize|unserialize|Class|Instance|Initialize|Before|After|Static|Constructor|reBoxing|copy|clone|left|top|right|bottom|startWith|endWith|initial|trim|ltrim|rtrim|blen|toDom|create",special:/xui[\w\.]*|(\bon|before|after|set|get)[A-Z]\w*/},css:{multicomment:this.$COM_REG.BLOCK_COMMENT,string:[this.$COM_REG.DQ_STRING,this.$COM_REG.SQ_STRING],IGNORE:/\([^'")]*\)/,keyword:[/@\w[\w.\s]*/,/attr|rect|rgb|url/],selector:/[\w-:\[.#][^{};]*\{/,colors:/\#[a-zA-Z0-9]{3,6}/,number:[/(\d*\.?\d+|\d+\.?\d*)(cm|em|ex|pt|px|%|\:)?/],vars:[/(-[\w-]+)\s*[ ]*:/,/([\w-]+)\s*[ ]*:/]},php:{multicomment:this.$COM_REG.BLOCK_COMMENT,comment:this.$COM_REG.LINE_COMMENT,reg:this.$COM_REG.REG,string:[this.$COM_REG.DQ_STRING,this.$COM_REG.SQ_STRING],number:this.$COM_REG.NUMBER,keyword:"abs|acos|acosh|addcslashes|addslashes|array_change_key_case|array_chunk|array_combine|array_count_values|array_diff|array_diff_assoc|array_diff_key|array_diff_uassoc|array_diff_ukey|array_fill|array_filter|array_flip|array_intersect|array_intersect_assoc|array_intersect_key|array_intersect_uassoc|array_intersect_ukey|array_key_exists|array_keys|array_map|array_merge|array_merge_recursive|array_multisort|array_pad|array_pop|array_product|array_push|array_rand|array_reduce|array_reverse|array_search|array_shift|array_slice|array_splice|array_sum|array_udiff|array_udiff_assoc|array_udiff_uassoc|array_uintersect|array_uintersect_assoc|array_uintersect_uassoc|array_unique|array_unshift|array_values|array_walk|array_walk_recursive|atan|atan2|atanh|base64_decode|base64_encode|base_convert|basename|bcadd|bccomp|bcdiv|bcmod|bcmul|bindec|bindtextdomain|bzclose|bzcompress|bzdecompress|bzerrno|bzerror|bzerrstr|bzflush|bzopen|bzread|bzwrite|ceil|chdir|checkdate|checkdnsrr|chgrp|chmod|chop|chown|chr|chroot|chunk_split|class_exists|closedir|closelog|copy|cos|cosh|count|count_chars|date|decbin|dechex|decoct|deg2rad|delete|ebcdic2ascii|echo|empty|end|ereg|ereg_replace|eregi|eregi_replace|error_log|error_reporting|escapeshellarg|escapeshellcmd|eval|exec|exit|exp|explode|extension_loaded|feof|fflush|fgetc|fgetcsv|fgets|fgetss|file_exists|file_get_contents|file_put_contents|fileatime|filectime|filegroup|fileinode|filemtime|fileowner|fileperms|filesize|filetype|floatval|flock|floor|flush|fmod|fnmatch|fopen|fpassthru|fprintf|fputcsv|fputs|fread|fscanf|fseek|fsockopen|fstat|ftell|ftok|getallheaders|getcwd|getdate|getenv|gethostbyaddr|gethostbyname|gethostbynamel|getimagesize|getlastmod|getmxrr|getmygid|getmyinode|getmypid|getmyuid|getopt|getprotobyname|getprotobynumber|getrandmax|getrusage|getservbyname|getservbyport|gettext|gettimeofday|gettype|glob|gmdate|gmmktime|ini_alter|ini_get|ini_get_all|ini_restore|ini_set|interface_exists|intval|ip2long|is_a|is_array|is_bool|is_callable|is_dir|is_double|is_executable|is_file|is_finite|is_float|is_infinite|is_int|is_integer|is_link|is_long|is_nan|is_null|is_numeric|is_object|is_readable|is_real|is_resource|is_scalar|is_soap_fault|is_string|is_subclass_of|is_uploaded_file|is_writable|is_writeable|mkdir|mktime|nl2br|parse_ini_file|parse_str|parse_url|passthru|pathinfo|readlink|realpath|rewind|rewinddir|rmdir|round|str_ireplace|str_pad|str_repeat|str_replace|str_rot13|str_shuffle|str_split|str_word_count|strcasecmp|strchr|strcmp|strcoll|strcspn|strftime|strip_tags|stripcslashes|stripos|stripslashes|stristr|strlen|strnatcasecmp|strnatcmp|strncasecmp|strncmp|strpbrk|strpos|strptime|strrchr|strrev|strripos|strrpos|strspn|strstr|strtok|strtolower|strtotime|strtoupper|strtr|strval|substr|substr_compare",keyword2:"and|or|xor|__FILE__|__LINE__|array|as|break|case|cfunction|class|const|continue|declare|default|die|do|else|elseif|empty|enddeclare|endfor|endforeach|endif|endswitch|endwhile|extends|for|foreach|function|include|include_once|global|if|new|old_function|return|static|switch|use|require|require_once|var|while|__FUNCTION__|__CLASS__|__METHOD__|abstract|interface|public|implements|extends|private|protected|throw",vars:/\$\w+/},html:{multicomment:this.$COM_REG.HTML_COMMENT,tag:/\x02\/?\w+/,attr:/\w+=/,script:/(>([^<][^\/]*<+)*\/)(script|style)>/,special:/<!DOCTYPE[^>]+>/,string:[this.$COM_REG.DQ_STRING,this.$COM_REG.SQ_STRING]}}},Static:{$COM_REG:{HTML_COMMENT:/<!\s*(--([^-]|[\r\n]|-[^-])*--\s*)>/,BLOCK_COMMENT:/\/\*[^*]*\*+([^\/][^*]*\*+)*\//,LINE_COMMENT:/\/\/[^\n]*/,REG:/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,DQ_STRING:/"(\\.|[^"\\])*"/,SQ_STRING:/'(\\.|[^'\\])*'/,NUMBER:/-?(\d*\.?\d+|\d+\.?\d*)([eE][+-]?\d+|%)?\b/},isSafeJSON:function(a){return""===xui.replace(a,[[this.$COM_REG.BLOCK_COMMENT,""],[/\\["\\\/bfnrtu]/,""],[this.$COM_REG.LINE_COMMENT,""],[this.$COM_REG.DQ_STRING,""],[this.$COM_REG.SQ_STRING,""],[this.$COM_REG.REG,""],[this.$COM_REG.NUMBER,""],[/true|false|null|undefined/,""],[/[\s\u2028\u2029]/,""],[/[^{,]+:/,""],[/[\[\]\{\}\,]/,""]])},formatText:function(b,e,r){var m,q,B,a=[];var w=0,x,u=20,D=function(l){var E="";while(l--){E+=" "}return E},C=[""];for(x=1;x<u;x++){C.push(D(x*4))}b=b.replace(/(\r\n|\r)/g,"\n");if(e=="html"){a.push([/[\s]*(<[\w]+[^>]+>)[\s]*/,"$1"]);a.push([/[\s]*(<\/[\w]+>)[\s]*/,"$1"]);b=xui.replace(b,a);a.length=0;a.push([this.$COM_REG.HTML_COMMENT,"$0\\n"]);a.push([/<!\[CDATA\[(([^\]])|(\][^\]])|(\]\][^>]))*\]\]>/,function(l,E){return C[w]+l[E]+"\n"}]);a.push([/<br\s*>/,function(l,E){return C[w]+l[E]+"\n"}]);a.push([/<hr\s*>/,function(l,E){return C[w]+l[E]+"\n"}]);a.push([/<input[^>]+>/,function(l,E){return C[w]+l[E]+"\n"}]);a.push([/<img[^>]+>/,function(l,E){return C[w]+l[E]+"\n"}]);a.push([/<[\w]+[^>]*\/>/,function(l,E){return C[w]+l[E]+"\n"}]);a.push([/[^<]+/,function(l,E){return C[w]+l[E]+"\n"}]);a.push([/<[\w]+[^>]*>/,function(l,E){return C[w++]+l[E]+"\n"}]);a.push([/<\/[\w]+>/,function(l,E){return C[--w]+l[E]+"\n"}]);b=xui.replace(b,a,true)}else{var a=[],o=1,n=1,j=1,g=1,f=1,d=1,c=1,s={a:{},b:{},c:{},d:{},e:{},f:{},g:{}};m=this.$COM_REG;b=b.replace(/\\\r?\n/g,"");b=b.replace(/([\x01\x02\x03\x04])/g,"$1-");b=xui.replace(b,[[m.BLOCK_COMMENT.source,r?"":function(F,E){var l="\x01d"+g+++"\x02";s.d[l]=F[E];return l}],[m.LINE_COMMENT.source,r?"":function(F,E){var l="\x01e"+f+++"\x02";s.e[l]=F[E];return l}],[/\/\*@|@\*\/|\/\/@[^\n]*\n/.source,function(F,E){var l="\x01c"+j+++"\x02";s.c[l]=F[E];return l}],[m.SQ_STRING.source,function(F,E){var l="\x03a"+o+++"\x04";s.a[l]=F[E];return l}],[m.DQ_STRING.source,function(F,E){var l="\x03b"+n+++"\x04";s.b[l]=F[E];return l}],[m.REG.source,function(F,E){var l="\x03f"+d+++"\x04";s.f[l]=F[E];return l}],[/function\s*\([^)]*\)/.source,function(F,E){var l="\x03g"+c+++"\x04";s.g[l]=F[E];return l}]]);a=[["([+-])\\s+([+-])","$1 $2"],["\\b[\\s]+\\b"," "],["[\\s]+",""]];if(e=="css"){xui.arr.insertAny(a,[/\s+(\.)/.source," $1"],2,true);xui.arr.insertAny(a,[/(\d*\.?\d+|\d+\.?\d*)(cm|em|ex|pt|px|%|\:)?/," $0 "],-1,true)}b=xui.replace(b,a);var A={};if(!r){a=[[/\[[^,;\n{}\x01\x03]+\]/.source,"$0"],[/(\[)\s*(\{)/.source,function(l,E){A[w+1]=1;return l[E+1]+"\n"+C[++w]+l[E+2]+"\n"+C[++w]}],[/[\[\{]/.source,function(l,E){A[w+1]=l[E]=="[";return l[E]+"\n"+C[++w]}],[/[\x02\;]/.source,function(l,E){return l[E]+"\n"+C[w]}],[/(\,)([\x03\x04\w_\-]+\:)/.source,function(l,E){return l[E+1]+"\n"+C[w]+l[E+2]}],[/,/.source,function(l,E){return A[w]?",\n"+C[w]:","}],[/\x01/.source,function(l,E){return"\n"+C[w]+l[E]}],[/(\])\s*(\})\s*([\,\;]*)/.source,function(l,E){A[w-1]=0;return"\n"+C[--w]+l[E+1]+"\n"+C[--w]+l[E+2]+l[E+3]+"\n"+C[w]}],[/\}\s*[\,\;]*/.source,function(l,E){return"\n"+C[--w]+l[E]+"\n"+C[w]}],[/\]\s*[\,\;]+/.source,function(l,E){A[w]=0;return"\n"+C[--w]+l[E]+"\n"+C[w]}],[/\]/.source,function(l,E){A[w]=0;return"\n"+C[--w]+l[E]}]];if(e!="css"){a.push([/for\s*\([\w ]+\sin\s/.source,"$0"],[/for\s*\(([^;]*);([^;]*);([^)]*)\)/.source,"for($1; $2; $3)"],[/(,)(("[^"\n\r]*"|'[^'\n\r]*'|\w+)?(:|=>))/.source,function(l,E){return l[E+1]+"\n"+C[w]+l[E+2]}],[/\b(case|default)\b[^:]+:/.source,function(l,E){return l[E]+"\n"+C[w]}])}b=xui.replace(b,a);b=xui.replace(b,[[/ *[\n\r]/.source,"\n"],[/\{\s+\}/.source,"{ }"],[/\[\s+\]/.source,"[ ]"],[/\}\n *(else|catch|finnally)/.source,"}$1"],[m.NUMBER,"$0"],[/(\/\/)|(\/\*)|(\*\/)/.source,"$0"]]);if(e!="css"){[/\s*((\+\+|\-\-|\&\&|\|\||!!)|([=!]==)|((<<|>>>|>>)=?)|([\+\-\*\/\%\&|^<>!=~]=?)|([?:]))\s*/.source," $1 "]}}b=xui.replace(b,[[/[\n\r]+/.source,"\n"],[/( *)(\x01[d]\d+\x02)/.source,function(E,l){E[l+1]=E[l+1]||"";return E[l+1]+s.d[E[l+2]].replace(/(\n)(\s*)/g,"$1"+E[l+1])}],[/\x03[g]\d+\x04/.source,function(E,l){return s.g[E[l]].replace(/\s*,\s*/g,","+(r?"":" "))}],[/[\x01\x03]([\w])\d+[\x02\x04]/.source,function(E,l){return s[E[l+1]][E[l]]}],[/([\]\}])\s*([\)])/.source,"$1$2"]]);b=b.replace(/([\x01\x02\x03\x04])-/g,"$1")}return b},$xid:1,formatHTML:function(c,e,C,g,n,m,j){if(!n){n=""+this.$xid++}var d=this.$key,s=c,r=this,o=function(a){return a.replace(/\x02|\x03/g,function(f){return f=="\x02"?"&lt;":"&amp;"})},B=function(a){return a.replace(/<|\&/g,function(f){return f=="<"?"\x02":"\x03"})};c=c.replace(/^\s*(.*)\s*$/g,"$1");c=B(c);var x,w;if(!this._profiles[e]){e="js"}x=xui.copy(this._profiles[e]);c=xui.replace(c,[[/(\r\n|\r)/g,"\n"],[/( +)(\n)/g,"$2"],[/\t/g,"\x04\x04\x04\x04"],[/ /g,"\x04"]]);var b=[];var u=function(D,a,f){if(D){if(!xui.isArr(D)){D=[D]}xui.arr.each(D,function(E){if(typeof E=="string"){E="\\b("+E+")\\b"}b.push([E,f?f:function(F){return"<span class='"+a+"'>"+F[0].replace(/\n/g,"</span>\n<span class='"+a+"'>")+"</span>"}])})}};if(w=x.multicomment){u(w,"multicomment",function(f,D){return"<span class='comment'>"+f[D].split("\n").join("</span>\n<span class='comment'>")+"</span>"});delete x.multicomment}if(w=x.comment){u(w,"comment",function(f,D){return"<span class='comment'>"+f[D].replace("\n","")+"</span>"});delete x.comment}if(w=x.IGNORE){u(w,"IGNORE","$0");delete x.IGNORE}if(x.reg){(function(f,a){if(f){if(!xui.isArr(f)){f=[f]}xui.arr.each(f,function(D){if(typeof D=="string"){D="\\b("+D+")\\b"}b.push([D,"<span class='"+a+"'>$0</span>"])})}})(x.reg,"reg");delete x.reg}xui.arr.each(["string1","string2","number"],function(a){if(x[a]){u(x[a],a);delete x[a]}});xui.each(x,function(f,a){u(f,a)});c=xui.replace(c,b);c=c.replace(/\x04/g,"&nbsp;");c=o(c);var l="";var q=c.split("\n");if(q[0]==""){q.shift()}if(q[q.length-1]==""){q.pop()}var A=[];A.push("<div id='"+d+":"+n+":' class='sh' style='"+(m?("overflow:hidden;height:"+m+(xui.isFinite(m)?"px":"")):"")+"'>");if(C&&C[0]){A.push("<div id='"+d+"-sh-cmd:"+n+":' class='sh-cmd'>");A.push("<span class='sh-toggle' href='javascript:;' onclick='xui.Coder._toggle(this);'>"+(g?" + ":" - ")+"</span> <span class='cmd-ruler'></span>");xui.arr.each(C,function(a){A.push("<a id='"+d+"-"+a+":"+n+":' href='javascript:;' onclick='xui.Coder._action(this,\""+a+"\",arguments[0]);'>"+a+"</a>")});A.push("<span>"+e+" source code viewer, powered by <a href='http://www.itjds.net' target='_blank' style='font-size:9px;color:#000157;'>EUSUI</a></span>");A.push("</div>")}A.push("<pre style='display:none'>");A.push(s.replace(/<([\w\/])/g,"&lt;$1"));A.push("</pre>");A.push("<div id='"+d+"-sh-con:"+n+":'class='sh-con' style='"+(m?("overflow:auto;height:"+m+(xui.isFinite(m)?"px":"")+";"):"")+(g?"display:none;":"")+"'><ol id='"+d+"-ol:"+n+":' start='1' class='"+e+"'><li>");A.push(q.join("&nbsp;</li><li>"));A.push("</li></ol></div>");A.push("</div>");o=B=null;xui.asyRun(function(){xui.Coder._remedy(n,j)});return A.join("")},formatAll:function(e,d,f,c,g,b){var a=xui.toArr(arguments);a[0]=this.formatText.call(this,e,d);return this.formatHTML.apply(this,a)},applyById:function(e,d){var c=0,b=this,a=function(){if(xui.Dom.byId(e)){var g,j,f;c++;g=xui(e);f=(g.get(0).className||"").split(/\s+/g);j=xui.str.toDom(xui.Coder[d?"formatAll":"formatHTML"](g.text(),f[0],f[1]&&f[1].split("-"),f[2],e+":"+c));j.setSelectable(true);g.replace(j)}else{return false}};xui.Thread.repeat(a)},_remedy:function(f,e){var c=this.$key+":"+f+":";if(!(c=xui(c)).isEmpty()){var d=c.parent(),b=d.scrollWidth(),a=d.width();d.css("positoin","relative");if(b>a){c.width(b)}xui.tryF(e,[c,d])}},$action:{run:function(d,c){var b=xui(d).parent().next().text(),a=new Function([],b);a.call(xui(d).parent(2),c)},plain:function(c){var b=xui(c).parent().next().text();var b=b.replace(/</g,"&lt;");var a=window.open("","_blank","width=750, height=400, location=0, resizable=1, menubar=0, scrollbars=1");a.document.write('<pre style="width:100%;height:100%;border:none;">'+b+"</pre>");a.document.close();a=null}},_action:function(c,a,b){if(this.$action[a]){this.$action[a](c,b||window.event)}},_toggle:function(b){var a=b.parentNode.nextSibling.nextSibling.style;if(a.display=="none"){a.display="";b.innerHTML="-"}else{a.display="none";b.innerHTML="+"}a=b=null}}});xui.Class("xui.Tips",null,{Constructor:function(){return null},Initialize:function(){if(xui.ini.disableTips||xui.browser.fakeTouch){return}var b=xui.DragDrop,a=this;if(b){b.$reset=function(){a._pos={left:b._profile.x,top:b._profile.y}}}xui.CSS.addStyleSheet(".xui-tips{position:absolute;overflow:visible;visibility:hidden;left:-10000px;border-radius:1px;} .xui-tips-i{overflow:hidden;position:relative;}.xui-tips-i span{display:inline;}.xui-tips-c{padding:.125em .25em .25em .25em;}.xui-tips-c *{line-height:1.22em;}.xui-tips .xui-tips-c{border-radius:1px;}",this.KEY);xui.doc.afterMousedown(function(){a._cancel()},"$Tips",-1).afterMousemove(function(g,f){if(b.isWorking){return}var c=xui.Event,d,j;if((d=xui.resetRun.$cache)&&d["$Tips"]){a._pos=c.getPos(f)}if(a._from){a._pos=c.getPos(f);a._showF();xui.resetRun("$Tips3")}else{if(a._showed&&a.MOVABLE){d=c.getPos(f);j=a._Node.style;j.left=Math.min(a._tpl._ww-a._tpl._w,Math.max(0,Math.round((parseFloat(j.left)||0)+(d.left-a._pos.left),10)))+"px";j.top=Math.min(a._tpl._hh-a._tpl._h,Math.max(0,Math.round((parseFloat(j.top)||0)+(d.top-a._pos.top),10)))+"px";a._pos=d}}},"$Tips",-1).afterMouseover(function(o,s){var c=xui.Event,j=c.$FALSE,f=c.getSrc(s),d,r,x,n,q=0,A,u=function(e){if(a._markId){a._cancel()}return e};if(!f){return u(j)}try{while((!f.id||f.id==xui.$localeDomId)&&f.parentNode!==document&&q++<10){f=f.parentNode}if(!(d=(typeof f.id=="string"?f.id:null))){f=null;return u(j)}}catch(s){}if((r=c._getProfile(d))&&r.box&&r.KEY=="xui.UIProfile"){if(r.properties.disableTips||r.behavior.disableTips){f=null;return u(false)}var w=r.behavior.NoTips;if(w){for(var m=0,g=w.length;m<g;m++){if(d.indexOf(r.keys[w[m]])===0){return u(false)}}}w=r.behavior.PanelKeys;if(w){for(var m=0,g=w.length;m<g;m++){if(d.indexOf(r.keys[w[m]])===0){return u(false)}}}w=r.behavior.HoverEffected;x=r.onShowTips?d:d.replace(a._reg,function(l,e){return w&&(e in w)?l:":"});if(a._markId&&x==a._markId){return j}a._markId=x;a._pos=c.getPos(s);if(a._showed){a._from=r;a._enode=d;a._showF()}else{xui.resetRun("$Tips",function(){a._from=r;a._enode=d;xui.resetRun("$Tips3",function(){if(a._from){a._showF()}})},a.DELAYTIME)}}else{a._cancel()}f=null;return j},"$Tips",-1).afterMouseout(function(l,j){if(a._markId){var g=xui.Event,m,c,d=0,f=j.toElement||j.relatedTarget;if(!f){c=1}else{try{while((!f.id||f.id==xui.$localeDomId)&&f.parentNode!==document&&d++<10){f=f.parentNode}if(!(m=(typeof f.id=="string"?f.id:null))){f=null;c=1}}catch(j){c=1}}if(c){a._cancel()}return g.$FALSE}},"$Tips",-1).afterMouseup(function(d,c){a._cancel()},"$Tips",-1);this._Types={"default":new function(){this.show=function(q,l,o){if(!l){return}var r=this,e,d,u,n,g;if(!(e=r.node)||!e.get(0)){e=r.node=xui.create('<div class="xui-node xui-node-div xui-tips  xui-ui-shadow xui-custom"><div class="xui-node xui-wrapper xui-node-div xui-tips-i xui-custom"></div></div>');d=r._ruler=xui.create('<div class="xui-node xui-wrapper xui-node-div xui-tips  xui-ui-shadow xui-custom"><div class="xui-node xui-node-div xui-tips-i xui-custom"></div></div>');r.n=e.first();r._n=d.first();xui("body").append(d)}d=r._ruler;if(document.body.lastChild!=e.get(0)){xui("body").append(e,false,true)}u=typeof q=="object"?q[o||xui.Tips.TIPSKEY]:q;if(typeof u=="function"){u=u()}if(u+=""){var f=/^\s*\</.test(u);u=xui.adjustRes(u);xui.Tips._curTips=u;if(!q.transTips||!f){u='<div class="xui-ui-ctrl xui-node xui-node-div  xui-uiborder-flat xui-uicell-alt xui-node-tips xui-tips-c /*xui-cls-wordwrap */xui-custom">'+u+"</div>"}r._n.get(0).innerHTML=u;r._ww=xui.frame.width();r._hh=xui.frame.height();n=Math.min(f?r._ww:a.MAXWIDTH,d.get(0).offsetWidth+2);var c=e.get(0).style,j=r.n.get(0),m=j.style;c.visibility="hidden";j.innerHTML=u;if(xui.browser.ie){c.width=m.width=(r._w=Math.round(n+(n%2)))+"px";g=j.offsetHeight;c.height=(r._h=Math.round(g-(g%2)))+"px"}else{m.width=(r._w=Math.round(n))+"px";r._h=r.n.height()}if(l===true){c.visibility="visible"}else{e.popToTop((l["xui.UI"]||l["xui.UIProfile"]||l["xui.Dom"]||l.nodeType==1||typeof l=="string")?l:{left:l.left,top:l.top,region:{left:l.left,top:l.top-12,width:24,height:32}},1)}c=m=j=null}else{e.css("zIndex",0).hide()}};this.hide=function(){this.node.css("zIndex",0).hide()}}}},Static:{_reg:/-([\w]+):/,TIPSKEY:"tips",MAXWIDTH:600,MOVABLE:true,DELAYTIME:400,AUTOHIDETIME:5000,_showF:function(){if(xui.ini.disableTips||xui.browser.fakeTouch){return}var c=this,f=c._from,e=xui.Dom.byId(c._enode),l=c._pos,j,g,d,a=true;c._from=c._enode=null;if(!e||!f||!l||!(g=f.box)){return}a=false!==((d=f.CF)&&(d=d.showTips)&&d(f,e,l));if(a!==false){a=false!==(f._showTips&&f._showTips(f,e,l))}if(a!==false){a=false!==(g._showTips&&g._showTips(f,e,l))}if(a!==false){if(((d=f)&&d.tips)||(d&&(d=d.properties)&&d.tips)){c.show(l,d);a=false}else{if((d=f)&&(d=d.properties)&&d.autoTips&&("caption" in d)&&d.tips===""){if(d.caption||d.labelCaption){c.show(l,{tips:d.caption||d.labelCaption});a=false}}}}if(a!==false){c.hide()}else{if(!c.MOVABLE){xui.resetRun("$Tips2",c.hide,c.AUTOHIDETIME,null,c)}}e=l=f=null},getTips:function(){return this._curTips},setTips:function(a){if(this._curTips&&this._tpl&&this._Node){this._tpl.show(a,true)}},setPos:function(b,a){var c=this;if((c=c._Node)&&(c=c.style)){if(b||b===0){c.left=Math.round(parseFloat(b))+"px"}if(a||a===0){c.top=Math.round(parseFloat(a))+"px"}}},show:function(e,d,c){var a=this,b;a._pos=e;if(a._item===d){return}if(typeof d=="string"||(d&&(d[c||xui.Tips.TIPSKEY]))){b=a._tpl=a._Types[d.tipsTemplate]||a._Types["default"];b.show(d,e,c);a._Node=b.node.get(0);a._item=d;a._showed=true}else{a._cancel()}},hide:function(){var a=this;if(a._showed){if(a._tpl){a._tpl.hide()}a._clear()}},_cancel:function(){var a=this;if(a._markId){if(a._showed){a.hide()}else{xui.resetRun("$Tips");xui.resetRun("$Tips3");a._clear()}}},_clear:function(){var a=this;a._Node=a._curTips=a._markId=a._from=a._tpl=a._item=a._showed=null}}});xui.Class("xui.UI.Resizer","xui.UI",{Instance:{_attachTo:function(d,c){var b=this,a=b.get(0);a._target=xui(d);a._parent=c||xui("body");a._parent.append(b);a.$resizeId=xui(d).id();return b},show:function(){var a=this;a.each(function(b){b.getRoot().css("display","")});if(xui.browser.ie){a.reBoxing().ieRemedy()}return a},hide:function(){var a=this;a.reBoxing().css("display","none");return a}},Initialize:function(){this.addTemplateKeys(["HANDLER","HIDDEN","MOVE","CONF1","CONF2","ROTATE","L","R","T","B","LT","RT","LB","RB","REGION"]);xui.each({addResizer:function(c,b,a){var e=xui([this.get(0)]);c=c||{};xui.merge(c,{_attached:true});var d=new xui.UI.Resizer(c)._attachTo(e,e);if(b){d.onUpdate(b)}if(a){d.onChange(a)}return d},removeResizer:function(){var a=this.id();xui.arr.each(xui.UI.Resizer._cache,function(b){if(b&&b.$resizeId==a){b.boxing().destroy(true)}});return this},$getResizer:function(){var c=this.id(),a;xui.arr.each(xui.UI.Resizer._cache,function(b){if(b&&b.$resizeId==c){a=b;return false}});return a&&a.boxing()}},function(b,a){xui.Dom.plugIn(a,b)});xui.each({_resizer:function(b,a){return this.each(function(f){var c=f.getSubNode("BORDER"),e=f.properties;if(c.$getResizer()){return}a=a||{};var g=function(x,s,C,j){var n=arguments.callee.profile,m=n.getRoot(),A=n.boxing(),d=n.properties,r=n.box["xui.svg"],B;if(C){var u=null,q=null,o=null,B=null;if(B=C.width){m.widthBy(B);d.width=u=n.$forceu(r?A.getWidth():m.width())}if(B=C.height){m.heightBy(B);d.height=q=n.$forceu(r?A.getHeight():m.height())}xui.UI.$tryResize(n,u,q,true);if(!n.box._onresize&&n.onResize&&(u!==null||q!==null)){A.onResize(n,u,q)}}if(j){if((B=j.left)&&!(d.left=="auto"&&Math.round(parseFloat(d.right))>=0)){m.leftBy(B);d.left=o=n.$forceu(r?A.getLeft():m.left())}if((B=j.top)&&!(d.top=="auto"&&Math.round(parseFloat(d.bottom))>=0)){m.topBy(B);d.top=B=n.$forceu(r?A.getTop():m.top())}if(n.onMove&&(o!==null||B!==null)){A.onMove(n,o,B,null,null)}}return false};g.profile=f;f.$resizer=c.addResizer(a,g);f.$resizer.get(0).$parentUIProfile=f;if(e.visibility=="hidden"){f.$resizer.hide()}})},_unResizer:function(){return this.each(function(b){var a=b.getSubNode("BORDER");if(!a.$getResizer()){return}a.removeResizer();delete b.$resizer})}},function(b,a){xui.UI.Widget.plugIn(a,b)});xui.UI.Widget.setDataModel({resizer:{ini:false,action:function(d){var c=this.boxing();if(d){var f=this.properties,a={};xui.each("minHeight,minWidth,maxHeight,maxWidth".split(","),function(b){if(b in f){a[b]=f[b]}});if(f.resizerProp&&!xui.isEmpty(f.resizerProp)){xui.merge(a,f.resizerProp,"all")}if(f.tagVar.resizerProp){xui.merge(a,f.tagVar.resizerProp,"all")}c._resizer(d,a);if(this.$inDesign){try{this.$resizer.get(0).$inDesign=1}catch(g){}}}else{c._unResizer()}}},resizerProp:{ini:{}}})},Static:{Templates:{tagName:"div",className:"{_disabled}",style:"{_style};"},Appearances:{KEY:{position:"absolute",margin:"0 -1px -1px 0",visibility:"visible",background:(xui.browser.ie&&!xui.browser.newie)?("url("+xui.ini.img_bg+")"):"","z-index":60,cursor:"move"},"KEY.readonly, KEY.disabled":{background:"url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 400 400'><rect x='0' y='0' width='400' height='400' stroke='#666666' fill='#bbbbbb' opacity='0.3' stroke-width='1'></rect><path d='M400 0 L0 400 ' stroke='#666666' stroke-width='1'/><path d='M0 0 L400 400 ' stroke='#666666' stroke-width='1'/></svg>\")","background-repeat":"no-repeat","background-position":"center center","background-size":"100% 100%, auto"},"KEY.readonly.active, KEY.disabled.active":{background:"url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 400 400'><rect x='0' y='0' width='400' height='400' stroke='#666666' fill='#eeeeee' opacity='0.3' stroke-width='1'></rect><path d='M400 0 L0 400 ' stroke='#666666' stroke-width='1'/><path d='M0 0 L400 400 ' stroke='#666666' stroke-width='1'/></svg>\")"},"KEY.readonly div, KEY.disabled div":{display:"none"},"KEY.readonly CONF1, KEY.readonly CONF2":{$order:10,opacity:1,display:"block"},MOVE:{position:"absolute",display:"block","z-index":100,visibility:"visible"},"CONF1, CONF2, ROTATE":{position:"absolute",display:"block","z-index":100,visibility:"visible",cursor:"pointer"},ROTATE:{$order:1,cursor:"crosshair"},HANDLER:{$order:0,position:"absolute",display:"block",border:"solid 1px","z-index":100,visibility:"visible"},T:{$order:1,left:"50%",cursor:"n-resize"},RT:{$order:1,cursor:"ne-resize","z-index":110},R:{$order:1,top:"50%",cursor:"e-resize"},RB:{$order:1,cursor:"se-resize","z-index":110},B:{$order:1,left:"50%",cursor:"s-resize"},LB:{$order:1,cursor:"sw-resize","z-index":110},L:{$order:1,top:"50%",cursor:"w-resize"},LT:{$order:1,cursor:"nw-resize","z-index":110},HIDDEN:{$order:10,"background-color":"transparent","border-width":0}},Behaviors:{beforeMousedown:function(a,b,c){if(a.properties.readonly||a.properties.disabled){return false}a.box._onMousedown(a,b,c,"move")},onDragbegin:function(a,b,c){if(a.properties.readonly||a.properties.disabled){return false}a.box._onDragbegin(a,b,c,"move")},onDrag:function(a,b,c){a.box._onDrag(a,b,c,"move")},onDragstop:function(a,b,c){a.box._onDragstop(a,b,c,"move")},onDblclick:function(a,b,c){if(a.onDblclick){a.boxing().onDblclick(a,b,c)}},CONF1:{onMouseover:function(a,b,c){if(a.properties.disabled){return false}if(a.onConfig){return a.boxing().onConfig(a,b,c,"left","mouseover")}return false},onMousedown:function(a,b,c){if(a.properties.disabled){return false}if(a.onConfig){return a.boxing().onConfig(a,b,c,"left","mousedown")}return false},onClick:function(a,b,c){if(a.properties.disabled){return false}if(a.onConfig){return a.boxing().onConfig(a,b,c,"left","click")}return false}},CONF2:{onMouseover:function(a,b,c){if(a.properties.disabled){return false}if(a.onConfig){return a.boxing().onConfig(a,b,c,"right","mouseover")}return false},onMousedown:function(a,b,c){if(a.properties.disabled){return false}if(a.onConfig){return a.boxing().onConfig(a,b,c,"right","mousedown")}return false},onClick:function(a,b,c){if(a.properties.disabled){return false}if(a.onConfig){return a.boxing().onConfig(a,b,c,"right","click")}return false}},ROTATE:{beforeMousedown:function(a,b,c){a.box._onMousedown(a,b,c,"rotate");return false},onDragbegin:function(a,b,c){a.box._onDragbegin(a,b,c,"rotate")},onDrag:function(a,b,c){a.box._onDrag(a,b,c,"rotate")},onDragstop:function(a,b,c){a.box._onDragstop(a,b,c,"rotate")}},LT:{beforeMousedown:function(a,b,c){a.box._onMousedown(a,b,c,"nw");return false},onDragbegin:function(a,b,c){a.box._onDragbegin(a,b,c,"nw")},onDrag:function(a,b,c){a.box._onDrag(a,b,c,"nw")},onDragstop:function(a,b,c){a.box._onDragstop(a,b,c,"nw")}},RT:{beforeMousedown:function(a,b,c){a.box._onMousedown(a,b,c,"ne");return false},onDragbegin:function(a,b,c){a.box._onDragbegin(a,b,c,"ne")},onDrag:function(a,b,c){a.box._onDrag(a,b,c,"ne")},onDragstop:function(a,b,c){a.box._onDragstop(a,b,c,"ne")}},LB:{beforeMousedown:function(a,b,c){a.box._onMousedown(a,b,c,"sw");return false},onDragbegin:function(a,b,c){a.box._onDragbegin(a,b,c,"sw")},onDrag:function(a,b,c){a.box._onDrag(a,b,c,"sw")},onDragstop:function(a,b,c){a.box._onDragstop(a,b,c,"sw")}},RB:{beforeMousedown:function(a,b,c){a.box._onMousedown(a,b,c,"se");return false},onDragbegin:function(a,b,c){a.box._onDragbegin(a,b,c,"se")},onDrag:function(a,b,c){a.box._onDrag(a,b,c,"se")},onDragstop:function(a,b,c){a.box._onDragstop(a,b,c,"se")}},L:{beforeMousedown:function(a,b,c){a.box._onMousedown(a,b,c,"w");return false},onDragbegin:function(a,b,c){a.box._onDragbegin(a,b,c,"w")},onDrag:function(a,b,c){a.box._onDrag(a,b,c,"w")},onDragstop:function(a,b,c){a.box._onDragstop(a,b,c,"w")}},T:{beforeMousedown:function(a,b,c){a.box._onMousedown(a,b,c,"n");return false},onDragbegin:function(a,b,c){a.box._onDragbegin(a,b,c,"n")},onDrag:function(a,b,c){a.box._onDrag(a,b,c,"n")},onDragstop:function(a,b,c){a.box._onDragstop(a,b,c,"n")}},R:{beforeMousedown:function(a,b,c){a.box._onMousedown(a,b,c,"e");return false},onDragbegin:function(a,b,c){a.box._onDragbegin(a,b,c,"e")},onDrag:function(a,b,c){a.box._onDrag(a,b,c,"e")},onDragstop:function(a,b,c){a.box._onDragstop(a,b,c,"e")}},B:{beforeMousedown:function(a,b,c){a.box._onMousedown(a,b,c,"s");return false},onDragbegin:function(a,b,c){a.box._onDragbegin(a,b,c,"s")},onDrag:function(a,b,c){a.box._onDrag(a,b,c,"s")},onDragstop:function(a,b,c){a.box._onDragstop(a,b,c,"s")}}},DataModel:{_attached:false,forceVisible:false,forceMovable:"",singleDir:false,vertical:true,horizontal:true,minHeight:12,minWidth:12,maxHeight:5000,maxWidth:5000,handlerSize:xui.browser.contentBox?8:12,handlerOffset:xui.browser.contentBox?1:0,readonly:{ini:false,action:function(a){if(a){this.getRoot().addClass("readonly")}else{this.getRoot().removeClass("readonly")}}},disabled:{ini:false,action:function(a){if(a){this.getRoot().addClass("disabled")}else{this.getRoot().removeClass("disabled")}}},leftConfigBtn:{ini:false,action:function(a){this.getSubNode("CONF1").css("display",a?"":"none")}},rightConfigBtn:{ini:false,action:function(a){this.getSubNode("CONF2").css("display",a?"":"none")}},rotatable:{ini:false,action:function(a){if(a&&xui.browser.ie&&xui.browser.ver<=8){a=false}this.getSubNode("ROTATE").css("display",a?"":"none")}},left:100,top:100,height:100,width:100,position:"absolute",display:"block"},EventHandlers:{onDblclick:function(a,b,c){},onUpdate:function(d,e,c,a,b){},onChange:function(b,a){},onConfig:function(b,c,d,f,a){}},_dynamicTemplate:function(c){var f=c.properties,m,e,j,d=c._exhash="$_attached:"+f._attached+";forceVisible:"+f.forceVisible+";singleDir:"+f.singleDir+";vertical:"+f.vertical+";horizontal:"+f.horizontal+";forceMovable:"+f.forceMovable+";";var a=arguments.callee.map||(arguments.callee.map={MOVE:{tagName:"div",className:"xuifont",$fonticon:"xui-icon-dragmove",style:"font-size: 1.5em;top:50%;left:50%;margin-left:-0.5em;margin-top:-0.5em;"},CONF1:{tagName:"div",className:"xuifont",$fonticon:"xui-icon-star",style:"font-size: 1.5em;top:-1.125em;left:-1.125em;{_leftCofigBtn};"},CONF2:{tagName:"div",className:"xuifont",$fonticon:"xui-uicmd-opt",style:"font-size: 1.5em;top:-1.125em;left:auto;right:-1.125em;{_rightCofigBtn};"},ROTATE:{tagName:"div",className:"xuifont",$fonticon:"xui-icon-circle",style:"font-size: 1.5em;top:-1.25em;left:50%;margin-left:-0.5em;{_rotateBtn};"},T:{tagName:"div",style:"top:-{_extend};margin-left:-{_extend};width:{_handlerSize};height:{_handlerSize};"},RT:{tagName:"div",style:"top:-{_extend};right:-{_extend};width:{_handlerSize};height:{_handlerSize};"},R:{tagName:"div",style:"right:-{_extend};margin-top:-{_extend};width:{_handlerSize};height:{_handlerSize};"},RB:{tagName:"div",style:"bottom:-{_extend};right:-{_extend};width:{_handlerSize};height:{_handlerSize};"},B:{tagName:"div",style:"bottom:-{_extend};margin-left:-{_extend};width:{_handlerSize};height:{_handlerSize};"},LB:{tagName:"div",style:"bottom:-{_extend};left:-{_extend};width:{_handlerSize};height:{_handlerSize};"},L:{tagName:"div",style:"left:-{_extend};margin-top:-{_extend};width:{_handlerSize};height:{_handlerSize};"},LT:{tagName:"div",style:"left:-{_extend};top:-{_extend};width:{_handlerSize};height:{_handlerSize};"},cover:{T:{tagName:"div",style:"width:100%;left:0em;top:-{_extend};height:{_handlerSize};"},RT:{tagName:"div",style:"top:-{_extend};right:-{_extend};width:{_handlerSize};height:{_handlerSize};"},R:{tagName:"div",style:"height:100%;top:0em;right:-{_extend};width:{_handlerSize};"},RB:{tagName:"div",style:"right:-{_extend};bottom:-{_extend};width:{_handlerSize};height:{_handlerSize};"},B:{tagName:"div",style:"width:100%;left:0em;bottom:-{_extend};height:{_handlerSize};"},LB:{tagName:"div",style:"left:-{_extend};bottom:-{_extend};width:{_handlerSize};height:{_handlerSize};"},L:{tagName:"div",style:"height:100%;top:0em;left:-{_extend};width:{_handlerSize};"},LT:{tagName:"div",style:"top:-{_extend};left:-{_extend};width:{_handlerSize};height:{_handlerSize};"}}});var g=c.box.getTemplate(d);if(!g){var l,b;g=xui.clone(c.box.getTemplate());l=f._cover?a.cover:a;if(f._move){g.MOVE=a.MOVE}g.CONF1=a.CONF1;g.CONF2=a.CONF2;g.ROTATE=a.ROTATE;if(f.vertical){if(!f.singleDir){g.T=l.T}g.B=l.B}if(f.horizontal){if(!f.singleDir){g.L=l.L}g.R=l.R;if(f.vertical){if(!f.singleDir){g.LB=l.LB;g.RT=l.RT;g.LT=l.LT}g.RB=l.RB}}b=c.getClass("KEY","-handler")+" ";if(l=g.T){l.className=b}if(l=g.RT){l.className=b}if(l=g.R){l.className=b}if(l=g.RB){l.className=b}if(l=g.B){l.className=b}if(l=g.LB){l.className=b}if(l=g.L){l.className=b}if(l=g.LT){l.className=b}if(!f._visible){b=c.getClass("KEY","-hidden")+" ";if(l=g.T){l.className+=b}if(l=g.RT){l.className+=b}if(l=g.R){l.className+=b}if(l=g.RB){l.className+=b}if(l=g.B){l.className+=b}if(l=g.LB){l.className+=b}if(l=g.L){l.className+=b}if(l=g.LT){l.className+=b}}c.box.setTemplate(g,d)}c.template=g},_prepareData:function(b){var a=b.properties;a._visible=true;a._cover=false;a._move=true;if(a._attached){a._visible=false;a._cover=true;a._move=false;a.position="static";if(xui.browser.ie67){a.display="inline"}a.left=a.top=a.width=a.height=0}if(a.forceVisible){a._visible=true;a._cover=false}if(typeof a.forceMovable=="boolean"){a._move=a.forceMovable}a.extend=(parseFloat(a.handlerSize)||0)/2+(parseFloat(a.handlerOffset)||0);a._handlerSize=b.$em(a.handlerSize)+"em";a._extend=b.$em(a.extend)+"em";a._leftCofigBtn=a.leftConfigBtn?"":"display:none";a._rightCofigBtn=a.rightConfigBtn?"":"display:none";var c=a.rotatable;if(c&&xui.browser.ie&&xui.browser.ver<=8){c=false}a._rotateBtn=c?"":"display:none";a._disabled=a.disabled?"disabled":"";return arguments.callee.upper.call(this,b)},RenderTrigger:function(){var a=this;xui.setNodeData(a.renderId,"zIndexIgnore",1);a.box._tryCursors(a)},_onUpdate:function(e,f,d,a,b){if(f){if(d){f.widthBy(d.width,true).heightBy(d.height,true)}if(a){var c=f.get(0).style;if(c.left=="auto"&&(Math.round(parseFloat(c.right))>=0)){}else{f.leftBy(a.left)}if(c.top=="auto"&&(Math.round(parseFloat(c.bottom))>=0)){}else{f.topBy(a.top)}}if(xui.isDefined(b)){f.rotate(b)}}},_switchAxis:function(b,c,j){var g=(c+360)%360,m=["n","ne","e","se","s","sw","w","nw"],l=Math.round(g/45),e=xui.arr.indexOf(m,b),d=e+l,f=m[d%8];if(j&&d%2==1){if(g<l*45){f=m[(d-1)%8]}else{f=m[(d+1)%8]}}return f},_tryCursors:function(c){var b=(c.getRoot().rotate()+360)%360,d=this._switchAxis,e={T:"n",RT:"ne",R:"e",RB:"se",B:"s",LB:"sw",L:"w",LT:"nw"},g;xui.each(e,function(a,f){if((g=c.getSubNode(f)).get(0)){g.css("cursor",d(a,b)+"-resize")}})},_getDDParas:function(c,a,b){switch(a){case"move":return{move:true};case"rotate":return{rotate:true};case"nw":return{left:true,top:true};case"ne":return{right:true,top:true};case"sw":return{left:true,bottom:true};case"se":return{right:true,bottom:true};case"w":return{left:true};case"n":return{top:true};case"e":return{right:true};case"s":return{bottom:true}}},_onMousedown:function(c,f,g,b){if(c.$inDesign){return}if(c.properties.disabled){return false}var a=this._getDDParas(0,b);if(xui.Event.getBtn(f)!="left"){return}var d=c.$parentUIProfile;if(d&&d["xui.UIProfile"]&&d.beforeResizerDrag&&false===xui.tryF(d.beforeResizerDrag,[d,c,a],d.boxing())){return}var j=xui.Event.getPos(f);xui.use(g).startDrag(f,{dragDefer:2,targetReposition:false,dragType:"blank",dragCursor:true,targetLeft:j.left,targetTop:j.top})},_onDragbegin:function(f,m,a,g){var c=f.properties,b=c.rotatable,d=f.properties._attached?f._target:xui([f.renderId]),r=d.width(),l=d.height(),q=d.offset(),j;if(b){j=d.rotate();if(d.get(0).getBoundingClientRect){var n=d.get(0).getBoundingClientRect();f.o_center={x:(n.right+n.left)/2,y:(n.bottom+n.top)/2}}else{f.o_center={x:q.left+r/2,y:q.top+r/2}}}if(f.properties._attached){f.proxy=xui.Dom.getEmptyDiv();f.proxy.html(" ",false).css({border:"1px dashed",visibility:"visible",position:"absolute"}).offset(q).width(r).height(l).css("zIndex",xui.Dom.TOP_ZINDEX+20);if(j){f.proxy.rotate(j)}}else{f.proxy=d}f.o_w2=f.o_w=r;f.o_h2=f.o_h=l;f.o_pos=f.proxy.cssPos();f.o_size={width:r,height:l};f.o_rotate=j;if(f.regions){f.o_regions=[];f.regions.each(function(e){f.o_regions.push(xui(e).cssSize())})}f.$onDrag=true},_onDrag:function(d,ab,s,u){var S=this._getDDParas(d.o_rotate,u);d.oos=d.oos||{};var m=xui.DragDrop.getProfile(),R=d.properties,c=d.o_rotate,A=d.o_size,l=d.o_pos,E=m.offset,b=E.x,a=E.y,P,N,Q,Z,aa,ad={};if(b===0&&a===0){return}if(c&&!(S.move||S.rotate)){var O=function(e){return(e+360)%360},r=Math.pow(Math.pow(b,2)+Math.pow(a,2),0.5),G=O(Math.atan2(b,-a)*180/Math.PI),M=c+90-G,I=(O(G-c)<180)?1:-1,H=(O(G-c)<90||O(G-c)>270)?-1:1;b=r*Math.abs(Math.cos(M*Math.PI/180))*I;a=r*Math.abs(Math.sin(M*Math.PI/180))*H}if(b==d.oos.width&&a==d.oos.height){return}d.oos={width:b,height:a};if(S.left){Q=d.o_w-b;P=l.left+b;if(Q<R.minWidth){Q=R.minWidth;P=d.o_w+l.left-Q}else{if(Q>R.maxWidth){Q=R.maxWidth;P=d.o_w+l.left-Q}}xui.merge(ad,{width:Q,left:P})}else{if(S.right){Q=d.o_w+b;if(Q<R.minWidth){Q=R.minWidth}else{if(Q>R.maxWidth){Q=R.maxWidth}}xui.merge(ad,{width:Q})}}if(S.top){Z=d.o_h-a;N=l.top+a;if(Z<R.minHeight){Z=R.minHeight;N=d.o_h+l.top-Z}else{if(Z>R.maxHeight){Z=R.maxHeight;N=d.o_h+l.top-Z}}xui.merge(ad,{height:Z,top:N})}else{if(S.bottom){Z=d.o_h+a;if(Z<R.minHeight){Z=R.minHeight}else{if(Z>R.maxHeight){Z=R.maxHeight}}xui.merge(ad,{height:Z})}}if(c&&!(S.move||S.rotate)){delete ad.left;delete ad.top;var K=Math.abs(Math.cos(c*Math.PI/180)),q=Math.abs(Math.sin(c*Math.PI/180)),W=l.left+A.width/2,V=l.top+A.height/2,T=A.width*K+A.height*q,ae=A.width*q+A.height*K,ac=W-T/2,U=V-ae/2,g=(ad.left||l.left)+(ad.width||A.width)/2,f=(ad.top||l.top)+(ad.height||A.height)/2,B=(ad.width||A.width)*K+(ad.height||A.height)*q,J=(ad.width||A.width)*q+(ad.height||A.height)*K,F=g-B/2,C=f-J/2,D=(B-T)/2,L=(J-ae)/2,Y=g-W,X=f-V;ad.left=l.left-Y;ad.top=l.top-X;var n=this._switchAxis(u,c,true);switch(n){case"e":if(c<90){ad.top-=((ad.height||A.height)*K-J/2)-(A.height*K-ae/2)}else{if(c>90&&(c<180)){ad.top-=((ad.width||A.width)*q-J/2)-(A.width*q-ae/2)}else{if(c>180&&(c<270)){ad.top+=((ad.width||A.width)*q-J/2)-(A.width*q-ae/2)}else{ad.top+=((ad.height||A.height)*K-J/2)-(A.height*K-ae/2)}}}ad.left+=D;break;case"s":if(c<90){ad.left-=((ad.height||A.height)*q-B/2)-(A.height*q-T/2)}else{if(c>90&&(c<180)){ad.left-=((ad.width||A.width)*K-B/2)-(A.width*K-T/2)}else{if(c>180&&(c<270)){ad.left+=((ad.width||A.width)*K-B/2)-(A.width*K-T/2)}else{ad.left+=((ad.height||A.height)*q-B/2)-(A.height*q-T/2)}}}ad.top+=L;break;case"w":if(c<90){ad.top+=((ad.height||A.height)*K-J/2)-(A.height*K-ae/2)}else{if(c>90&&(c<180)){ad.top+=((ad.width||A.width)*q-J/2)-(A.width*q-ae/2)}else{if(c>180&&(c<270)){ad.top-=((ad.width||A.width)*q-J/2)-(A.width*q-ae/2)}else{ad.top-=((ad.height||A.height)*K-J/2)-(A.height*K-ae/2)}}}ad.left-=D;break;case"n":if(c<90){ad.left+=((ad.height||A.height)*q-B/2)-(A.height*q-T/2)}else{if(c>90&&(c<180)){ad.left+=((ad.width||A.width)*K-B/2)-(A.width*K-T/2)}else{if(c>180&&(c<270)){ad.left-=((ad.width||A.width)*K-B/2)-(A.width*K-T/2)}else{ad.left-=((ad.height||A.height)*q-B/2)-(A.height*q-T/2)}}}ad.top-=L;break}}if(S.left||S.right){if(d.regions&&"width" in ad&&ad.width!==A.width){var j=ad.width-A.width;d.regions.each(function(w,e){xui(w).width(d.o_regions[e].width+j)})}}if(S.top||S.bottom){if(d.regions&&"height" in ad&&ad.height!==A.height){var o=ad.height-A.height;d.regions.each(function(w,e){xui(w).height(d.o_regions[e].height+o)})}}if(S.move){P=l.left+b;N=l.top+a;xui.merge(ad,{top:N,left:P})}if(S.rotate){aa=(180-Math.atan2(m.x-d.o_center.x,m.y-d.o_center.y)*180/Math.PI);if(aa<0){aa+=360}xui.merge(ad,{rotate:aa})}if(!xui.isEmpty(ad)){xui.each(ad,function(w,e){ad[e]=Math.round(parseFloat(w))+"px"});d.proxy.css(ad);if(d.onChange){d.boxing().onChange(d,d.proxy)}}},_onDragstop:function(f,q,a,g){var l,d,s,j,m,n=f.o_size,b=f.o_pos,c=f.proxy,r=this._getDDParas(f.o_rotate,g);if(!r.move&&!r.rotate){l=c.cssSize();s={width:l.width-n.width,height:l.height-n.height};if(s.width===0&&s.height===0){s=null}}d=c.cssPos();j={left:d.left-b.left,top:d.top-b.top};if(j.left===0&&j.top===0){j=null}if(r.rotate){m=c.rotate()}if(f.onUpdate&&false===f.boxing().onUpdate(f,f._target,s,j,m)){}else{f.box._onUpdate(f,f._target,s,j,m)}if(f.properties._attached){if(xui.browser.ie6){f._target.ieRemedy()}f.proxy.html("",false).css({visibility:"hidden",border:"none",zIndex:"0",width:"0",height:"0",rotate:0})}f.$onDrag=false;delete f.o_rotate;f.box._tryCursors(f)}}});xui.Class("xui.UI.Image","xui.UI",{Initialize:function(){var a=this;a._adjustItems=xui.absList._adjustItems;a.prototype._prepareItems=function(b){return b}},Instance:{fireClickEvent:function(){this.getRoot().onClick();return this},getRate:function(){return parseFloat(this.get(0)._rate)||1},getUIValue:function(){return this.getSrc()},setUIValue:function(a){this.setSrc(a)},getValue:function(){return this.getSrc()},setValue:function(a){this.setSrc(a)}},Static:{IMGNODE:1,Templates:{tagName:"img",style:"cursor:{cursor};{_style}",className:"{_className}",border:"0",src:xui.ini.img_bg,alt:"{alt}"},Behaviors:{HoverEffected:{KEY:"KEY"},ClickEffected:{KEY:"KEY"},DraggableKeys:["KEY"],onError:function(a,b,c){a.boxing().onError(a)},onLoad:function(c,f,g){var a=xui.use(g).get(0),d;try{d=a.src}catch(f){return}if(d!=xui.ini.img_bg){var b=new Image();b.onload=function(){if(!c||c.destroyed){return}var j=c.properties,e=c.box._adjust(c,(j.width===""||j.width=="auto")?b.width:j.width,(j.height===""||j.height=="auto")?b.height:j.height);if(c.$afterLoad){c.$afterLoad.apply(c.host,[c,d,e[0],e[1]])}c.boxing().afterLoad(c,d,e[0],e[1]);if(j.dock!="none"){c.boxing().adjustDock()}b.onload=null};b.src=d;xui.Dom.fixPng(a)}},onClick:function(a,c,d){var b=a.properties;if(b.disabled){return false}if(a.onClick){return a.boxing().onClick(a,c,d)}},onDblclick:function(a,c,d){var b=a.properties;if(b.disabled){return false}if(a.onDblclick){a.boxing().onDblclick(a,c,d)}}},RenderTrigger:function(){var b=this,d=b.properties,a=d.src,c=d.activeItem;if(c&&-1!=xui.arr.subIndexOf(d.items,"id",c)){b.boxing().setActiveItem(c,true)}else{if(a){b.boxing().setSrc(a,a!=xui.ini.img_bg)}}},EventHandlers:{onClick:function(a,b,c){},onDblclick:function(a,b,c){},onError:function(a){},beforeLoad:function(a){},afterLoad:function(c,d,b,a){}},_adjust:function(g,d,m){var c=g.properties,b=g.getRootNode(),j=xui.$us(g),l=function(n,o){return g.$forceu(n,j>0?"em":"px",o)};d=d?g.$px(d,null,true):d;m=m?g.$px(m,null,true):m;b.style.width=b.style.height="";if(d>0&&m>0){var f=c.maxWidth/d,e=c.maxHeight/m,a=f<e?f:e;if(a>=1){a=1}g._rate=a;return[b.width=d*a,b.height=m*a]}return[0,0]},DataModel:{expression:{ini:"",action:function(){}},maxWidth:{ini:800,action:function(a){var b=this.getRootNode(),c=this.properties;this.box._adjust(this,(c.width===""||c.width=="auto")?b.width:c.width,(c.height===""||c.height=="auto")?b.height:c.height)}},maxHeight:{ini:600,action:function(a){var b=this.getRootNode(),c=this.properties;this.box._adjust(this,(c.width===""||c.width=="auto")?b.width:c.width,(c.height===""||c.height=="auto")?b.height:c.height)}},width:{ini:"auto",action:function(a){var c=this.getRootNode(),d=this.properties,b=new Image();b.src=c.src;this.box._adjust(this,(a===""||a=="auto")?b.width:a,(d.height===""||d.height=="auto")?b.height:d.height)}},height:{ini:"auto",action:function(a){var c=this.getRootNode(),d=this.properties,b=new Image();b.src=c.src;this.box._adjust(this,(d.width===""||d.width=="auto")?b.width:d.width,(a===""||a=="auto")?b.height:a)}},src:{format:"image",ini:xui.ini.img_bg,linkage:["activeItem"],action:function(b){var a=this;if(false!==a.boxing().beforeLoad(this)){xui.asyRun(function(){var d=a.properties,c=a.getRoot(),e=xui.adjustRes(b);if(d){if(c.attr("src")!==e){c.attr("src",e)}}})}if(!a.$inner){a.properties.activeItem=""}}},alt:{ini:"",action:function(a){this.getRoot().attr("alt",a)}},items:{ini:[]},activeItem:{ini:"",linkage:["src","alt","tips"],action:function(c){var b=this.properties.items,e=xui.arr.subIndexOf(b,"id",""+c),f,d=this.boxing(),j=xui.ini.img_bg,g,a;if((e!=-1)&&(f=b[e])){j=f.image;g=f.alt||"";a=f.tips||""}this.$inner=1;d.setSrc(j,true);delete this.$inner;d.setAlt(g||"");d.setTips(a||"")}},cursor:{ini:"auto",combobox:["","default","text","pointer","move","crosshair","wait","help","e-resize","ne-resize","nw-resize","n-resize","se-resize","sw-resize","s-resize","w-resize"],action:function(a){this.getRoot().css("cursor",a)}}}}});xui.Class("xui.UI.Flash","xui.UI",{Instance:{refreshFlash:function(){var b="",a=this.constructor;return this.each(function(c){xui.resetRun(c.domId,function(){a._clearMemory(c);if(c.properties.src){a._drawSWF(c)}})})},getFlash:function(){return this.constructor._getSWF(this.get(0))}},Static:{Appearances:{KEY:{overflow:"hidden"},BOX:{position:"absolute",left:0,top:0,"z-index":1},COVER:{position:"absolute",left:"-1px",top:"-1px",width:0,height:0,"z-index":4}},Templates:{tagName:"div",className:"{_className}",style:"{_style}",BOX:{tagName:"div"},COVER:{tagName:"div",style:"background-image:url("+xui.ini.img_bg+");"}},DataModel:{selectable:true,width:{$spaceunit:1,ini:"30em"},height:{$spaceunit:1,ini:"25em"},cover:false,src:{format:"media",ini:"",action:function(a){this.boxing().refreshFlash()}},parameters:{ini:{},action:function(a){this.boxing().refreshFlash()}},flashvars:{ini:{},action:function(a){this.boxing().refreshFlash()}}},RenderTrigger:function(){(this.$beforeDestroy=(this.$beforeDestroy||{}))["flashClearMem"]=function(){if(this.box){this.box._clearMemory(this)}};this.boxing().refreshFlash()},getFlashVersion:function(){if(xui.browser.ie){try{var a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");try{a.AllowScriptAccess="always"}catch(b){return"6,0,0"}}catch(b){}finally{try{return new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(b){}}}else{try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin){return(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}}catch(b){}}return"0,0,0"},_getSWF:function(a){var b=xui.isStr(a)?a:(this._idtag+a.serialId);return(xui.browser.ie?window[b]:((document.embeds&&document.embeds[b])||window.document[b]))||document.getElementById(b)},_clearMemory:function(d){var e=this._idtag+d.serialId;var b=xui.fun(),c=d.box._getSWF(d);if(c){c.style.display="none";if(xui.browser.ie){for(var a in c){if(typeof c[a]=="function"){c[a]=b}}if(window[e]){window[e]=undefined}}else{if(document.embeds&&document.embeds[e]){document.embeds[e]=undefined}if(window.document[e]){window.document[e]=undefined}}c=b=null}},_drawSWF:function(e){var d=this;var j=e.properties,c=e.serialId,g=xui.adjustRes(j.src),f=j.parameters,b=xui.copy(j.flashvars),a="";b.DOMId=e.box._idtag+e.serialId;b.chartWidth=j.width;b.chartHeight=j.height;if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){a+='<embed type="application/x-shockwave-flash" src="'+g+"?"+xui.urlEncode(f)+'" ';a+='width="'+j.width+'" height="'+j.height+'" ';a+='id="'+b.DOMId+'" name="'+b.DOMId+'" ';a+='wmode="opaque" ';a+='flashvars="'+xui.urlEncode(b)+'" ';a+="/>"}else{a+='<object id="'+b.DOMId+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" ';a+='width="'+j.width+'" height="'+j.height+'">';a+='<param name="movie" value="'+g+"?"+xui.urlEncode(f)+'" />';a+='<param name="wmode" value="opaque" />';a+='<param name="flashvars" value="'+xui.urlEncode(b)+'" />';a+="</object>"}e.getSubNode("BOX").html(a,false)},_onresize:function(c,b,j){var a=c.properties,e=xui.$us(c),g=function(m,n){return c.$forceu(m,e>0?"em":"px",n)},l=c.getSubNode("BOX").cssSize(),f=b?c.$px(b):b,d=j?c.$px(j):j;if((b&&!xui.compareNumber(l.width,f,6))||(j&&!xui.compareNumber(l.height,d,6))){if(b){a.width=g(f)}if(j){a.height=g(d)}l={width:b?a.width:null,height:j?a.height:null};c.getSubNode("BOX").cssSize(l,true);if(c.$inDesign||a.cover){c.getSubNode("COVER").cssSize(l,true)}c.boxing().refreshFlash()}}}});xui.Class("xui.UI.Audio","xui.UI",{Instance:{play:function(){var a=this.getSubNode("H5"),b=a.get(0);if(b&&this.getSrc()){b.play()}},pause:function(){var a=this.getSubNode("H5"),b=a.get(0);if(b&&this.getSrc()){b.pause()}},load:function(){var a=this.getSubNode("H5"),b=a.get(0);if(b&&this.getSrc()){b.load()}},canPlayType:function(c){var a=this.getSubNode("H5"),b=a.get(0);if(b){return b.canPlayType(c)}}},Static:{Appearances:{KEY:{overflow:"hidden"},H5:{position:"absolute",left:0,top:0,"z-index":1},COVER:{position:"absolute",left:"-1px",top:"-1px",width:0,height:0,"z-index":4}},Templates:{tagName:"div",className:"{_className}",style:"{_style}",H5:{tagName:"audio",crossOrigin:"anonymous",autoplay:"{_autoplay}",controls:"{_controls}",loop:"{_loop}",muted:"{_muted}",preload:"{preload}",volume:"{volume}",src:"{src}",text:"Your browser does not support the audio element."},COVER:{tagName:"div",style:"background-image:url("+xui.ini.img_bg+");"}},Behaviors:{HotKeyAllowed:false},DataModel:{selectable:true,width:{$spaceunit:1,ini:"18em"},height:{$spaceunit:1,ini:"5em"},src:{format:"media",ini:"",action:function(a){this.getSubNode("H5").attr("src",xui.adjustRes(a))}},cover:false,controls:{ini:true,action:function(a){this.getSubNode("H5").attr("controls",a?"controls":null)}},preload:{ini:"none",listbox:["none","metadata","auto"],action:function(a){this.getSubNode("H5").attr("preload",(!a||a=="none")?null:a)}},loop:{ini:false,action:function(a){this.getSubNode("H5").attr("loop",a?"loop":null)}},muted:{ini:false,action:function(a){this.getSubNode("H5").attr("muted",a?"muted":null)}},volume:{ini:1,action:function(a){this.getSubNode("H5").attr("volume",a)}},autoplay:{ini:false,action:function(a){this.getSubNode("H5").attr("autoplay",a?"autoplay":null)}}},RenderTrigger:function(){var d=this,b=d.getSubNode("H5"),e=d.properties,a=function(f){if(d.onMediaEvent){d.boxing().onMediaEvent(d,(f||window.event).type,arguments)}},c;xui.arr.each("loadstart progress durationchange seeked seeking timeupdate playing canplay canplaythrough volumechange ratechange loadedmetadata loadeddata play pause ended".split(" "),function(g,f){if(f=b&&b.get(0)){xui.Event._addEventListener(f,g,a)}});(d.$beforeDestroy=(d.$beforeDestroy||{}))["detachEvents"]=function(){xui.arr.each("loadstart progress durationchange seeked seeking timeupdate playing canplay canplaythrough volumechange ratechange loadedmetadata loadeddata play pause ended".split(" "),function(g,f){if(f=b&&b.get(0)){xui.Event._removeEventListener(f,g,a)}})};if(!e.controls){b.attr("controls",null)}if(!e.loop){b.attr("loop",null)}if(!e.muted){b.attr("muted",null)}if(!e.autoplay){b.attr("autoplay",null)}else{xui.asyRun(function(f){if(d.$inDesign){return}if(e.src&&xui.isStr(e.src)&&(f=b.get(0))){f.play()}})}},_prepareData:function(a){var b=arguments.callee.upper.call(this,a);if(b.autoplay){b._autoplay="autoplay"}if(b.controls){b._controls="controls"}if(b.loop){b._loop="loop"}if(b.muted){b._muted="muted"}return b},EventHandlers:{onMediaEvent:function(b,a,c){}},_onresize:function(c,b,l){var j=c.getSubNode("H5"),m=j.cssSize(),a=c.properties,e=xui.$us(c),g=function(n,o){return c.$forceu(n,e>0?"em":"px",o)},f=b?c.$px(b):b,d=l?c.$px(l):l;if((b&&!xui.compareNumber(m.width,f,6))||(l&&!xui.compareNumber(m.height,d,6))){if(b){j.attr("width",f).width(a.width=g(f))}if(l){j.attr("height",d).height(a.height=g(d))}if(c.$inDesign||a.cover){c.getSubNode("COVER").cssSize({width:b?a.width:null,height:l?a.height:null},true)}}}}});xui.Class("xui.UI.Video","xui.UI.Audio",{Instance:{},Static:{Templates:{tagName:"div",crossOrigin:"anonymous",className:"{_className}",style:"{_style}",H5:{tagName:"video",autoplay:"{_autoplay}",controls:"{_controls}",loop:"{_loop}",muted:"{_muted}",type:"application/x-mpegURL",preload:"{preload}",volume:"{volume}",src:"{src}",width:"{width}",height:"{height}",text:"Your browser does not support the video element."},COVER:{tagName:"div",style:"background-image:url("+xui.ini.img_bg+");"}},DataModel:{width:{$spaceunit:1,ini:"34em"},height:{$spaceunit:1,ini:"25em"},poster:{format:"image",ini:"",action:function(a){this.getSubNode("H5").attr("poster",a||null)}}},RenderTrigger:function(){var c=this,a=c.getSubNode("H5"),d=c.properties,b;if(b=d.poster){a.attr("poster",b)}}}});xui.Class("xui.UI.Block","xui.UI.Widget",{Instance:{setChildren:function(e,d){var c=this,b=[],a=c.getModule().getCtxComponents();this.removeChildren(true,true,true);xui.each(e,function(f){if(f&&f.alias){if(f.alias=="pagectx"){a.boxing().removeChildren(true,true,true);c.getModule().addCtxComponents(f.children)}else{b.push(f)}}});xui.addChild({children:b},c,c.getModule(),c.getModule())},getAllFormValues:function(b){var c=this.getChildren(),d=xui.absValue.pack(c),f={},e=this.get(0);xui.arr.each(e.children,function(j){var a=j[0].boxing(),g=a.getProperties().name||j[0].alias;if(a.Class["xui.UI.Tabs"]){xui.merge(f,a.getAllFormValues(b),"all")}else{if(a.Class["xui.UI.Block"]||a.Class["xui.UI.Panel"]||a.Class["xui.UI.Layout"]){xui.merge(f,a.getAllFormValues(b),"all")}else{if(a.getFormValues){xui.merge(f,a.getFormValues(),"all")}else{if(a.getUIValue){f[g]=a.getUIValue()}else{if(a.getValue){f[g]=a.getValue()}}}}}});return f}},Initialize:function(){var a=this,b=a.getTemplate();b.className+=" {_sidebarStatus}";xui.merge(b.FRAME.BORDER,{className:"xui-uiw-border {clsBorderType1}",SIDEBAR:{tagName:"div",className:"xui-uisb xui-uibar {_sidebar}",SBCAP:{className:"xui-uisbcap xui-title-node",text:"{sideBarCaption}"},SBBTN:{$order:1,className:"xui-uisbbtn xuifont",$fonticon:"{_fi_btn}"}},PANEL:{tagName:"div",className:"xui-uibar xui-uicontainer {clsBorderType2}",style:"{_panelstyle};{background};{_overflow};",text:"{html}"+xui.UI.$childTag}},"all");a.setTemplate(b);b=a.getAppearance();xui.merge(b,{PANEL:{position:"relative",overflow:"auto"},SBCAP:{"text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden"},SBBTN:{"z-index":2,margin:"0.33333em"}});a.setAppearance(b)},Static:{Behaviors:{HoverEffected:{SBBTN:"SBBTN",SBCAP:null},ClickEffected:{SBBTN:"SBBTN"},DroppableKeys:["PANEL"],PanelKeys:["PANEL"],PANEL:{onClick:function(a,c,d){var b=a.properties;if(b.disabled){return false}if(a.onClickPanel){return a.boxing().onClickPanel(a,c,d)}}},SBBTN:{onClick:function(a,c,d){var b=a.properties;if(b.disabled){return false}a.boxing().setSideBarStatus(b.sideBarStatus=="fold"?"expand":"fold")}},SIDEBAR:{onClick:function(b,d,f){var c=b.properties,a=b.getSubNode("SBBTN");if(c.disabled){return false}if(xui.Event.getSrc(d).$xid!=a.xid()){if(c.sideBarStatus=="fold"){a.onClick(true)}}}}},EventHandlers:{onClickPanel:function(a,b,c){},onFlagClick:function(a,b,c,d){},touchstart:function(a,b,c,d){},touchmove:function(a,b,c,d){},touchend:function(a,b,c,d){},touchcancel:function(a,b,c,d){},swipe:function(a,b,c,d){},swipeleft:function(a,b,c,d){},swiperight:function(a,b,c,d){},swipeup:function(a,b,c,d){},swipedown:function(a,b,c,d){},press:function(a,b,c,d){},pressup:function(a,b,c,d){},pan:function(a,b,c,d){},panstart:function(a,b,c,d){},panmove:function(a,b,c,d){},panend:function(a,b,c,d){},pancancel:function(a,b,c,d){},panleft:function(a,b,c,d){},panright:function(a,b,c,d){},panup:function(a,b,c,d){},pandown:function(a,b,c,d){},pinch:function(a,b,c,d){},pinchstart:function(a,b,c,d){},pinchmove:function(a,b,c,d){},pinchend:function(a,b,c,d){},pinchcancel:function(a,b,c,d){},pinchin:function(a,b,c,d){},pinchout:function(a,b,c,d){},rotate:function(a,b,c,d){},rotatestart:function(a,b,c,d){},rotatemove:function(a,b,c,d){},rotateend:function(a,b,c,d){},rotatecancel:function(a,b,c,d){}},DataModel:{disabled:null,tips:null,rotate:null,iframeAutoLoad:{ini:"",action:function(){xui.UI.Div._applyAutoLoad(this)}},ajaxAutoLoad:{ini:"",action:function(){xui.UI.Div._applyAutoLoad(this)}},selectable:true,html:{html:1,action:function(a,b,c){this.getSubNode("PANEL").html(xui.adjustRes(a,0,1),null,null,c)}},borderType:{ini:"outset",listbox:["none","flat","inset","outset","groove","ridge"],action:function(a){var b=this,c=b.properties;b.box._borderType(b,a,c.sideBarStatus,c.sideBarType.split("-"),true)}},sideBarCaption:{ini:"",action:function(a){this.getSubNode("SBCAP").html(a)}},sideBarType:{ini:"none",listbox:["none","left","right","top","bottom","left-top","left-bottom","right-top","right-bottom","top-left","top-right","bottom-left","bottom-right"],action:function(a){var b=this,c=b.properties;b.box._adjustSideBar(b,c.sideBarStatus,a);if(c.dock!="none"){b.boxing().adjustDock(true)}else{b.adjustSize()}}},sideBarStatus:{ini:"expand",listbox:["expand","fold"],action:function(a){var b=this,c=b.properties;b.getRoot().tagClass("-fold",a!="expand");b.box._adjustSideBar(b,a,c.sideBarType);xui.UI.$doResize(b,c.width,c.height,true);b.boxing().adjustDock(true)}},sideBarSize:{ini:"2em",action:function(a){var b=this,c=b.properties;if(c.dock=="none"){b.adjustSize()}else{b.boxing().adjustDock(true)}}},background:{format:"color",ini:"",action:function(a){this.getSubNode("PANEL").css("background",a)}},width:{$spaceunit:1,ini:"30em"},height:{$spaceunit:1,ini:"30em"}},Appearances:{KEY:{"line-height":"normal"},"KEY-fold PANEL":{display:"none"},"KEY-fold SIDEBAR":{cursor:"pointer","background-color":"#B6B6B6"}},RenderTrigger:function(){var a=this;if(a.box.KEY=="xui.UI.Block"){if(a.properties.iframeAutoLoad||a.properties.ajaxAutoLoad){xui.UI.Div._applyAutoLoad(this)}}},_sbicon:function(c,a,b,d){var e=a=="fold"?b=="left"?"left":b=="right"?"right":b=="top"?"up":"down":b=="left"?"right":b=="right"?"left":b=="top"?"down":"up";return d?c.getSubNode("SBBTN").replaceClass(/(xui-icon-double)[\w]+/g,"$1"+e):"xui-icon-double"+e},_borderType:function(g,d,u,j,D){j=u=="expand"?j[0]:(j[1]||j[0]);var H=g,s=d,q=H.getSubNode("BORDER"),n=H.getSubNode("PANEL"),l=/^xui-uiborder-/,G="xui-uiborder-",A=G+"radius",E=G+"inset",B=G+"outset",F=G+"flat",a=j=="left"?A+"-tr "+A+"-br":j=="top"?A+"-bl "+A+"-br":j=="right"?A+"-tl "+A+"-bl":j=="bottom"?A+"-tl "+A+"-tr":A,w=F+" "+A,c=E+" "+A,m=B+" "+A,x=E+" "+a,e=B+" "+a,C=H.getRoot();q.removeClass(l);n.removeClass(l);switch(s){case"flat":q.addClass(w);n.addClass(a);break;case"inset":q.addClass(c);n.addClass(a);break;case"outset":q.addClass(m);n.addClass(a);break;case"groove":q.addClass(c);n.addClass(e);break;case"ridge":q.addClass(m);n.addClass(x);break}H.box._setB(H);if(D){H.adjustSize()}},_adjustSideBar:function(g,b,f){var d=g,j=d.properties,c=/^xui-uisb-/,a=f.split("-"),e=d.getSubNode("SIDEBAR");e.removeClass(c).addClass("xui-uisb-"+(b=="expand"?a[0]:(a[1]||a[0])));d.box._sbicon(d,b,a[1]||a[0],true);d.box._borderType(d,j.borderType,b,a,false)},_setB:function(c){var d=c.properties,b=d.borderType,e=c.getSubNode("BORDER"),a=e._borderW("left");d.$hborder=d.$vborder=d.$iborder=0;if(b=="flat"||b=="inset"||b=="outset"){d.$hborder=d.$vborder=a;d.$iborder=0}else{if(b=="groove"||b=="ridge"){d.$hborder=d.$vborder=d.$iborder=a}}},LayoutTrigger:function(){var c=this.properties,a=c.sideBarStatus,b=c.borderType;if(b!="none"){this.boxing().setBorderType(b,true)}if(a=="fold"){this.boxing().setSideBarStatus("fold",true)}},_prepareData:function(e){var f=arguments.callee.upper.call(this,e),d=f.sideBarType.split("-"),c=f.sideBarStatus;f.background=f.background?"background:"+f.background:"";if(xui.isStr(f.overflow)){f._overflow=f.overflow.indexOf(":")!=-1?(f.overflow):(f.overflow?("overflow:"+f.overflow):"")}f._sidebar="xui-uisb-"+(c=="expand"?d[0]:(d[1]||d[0]));f._sidebarStatus=c=="fold"?e.getClass("KEY","-fold"):"";f._fi_btn=e.box._sbicon(e,c,d[1]||d[0]);return f},_onresize:function(e,w,u){var s=arguments.callee.upper.apply(this,arguments),x=e.getRoot(),A=e.getSubNode("BORDER"),o=e.getSubNode("PANEL"),q=e.getSubNode("SIDEBAR"),F=e.getSubNode("SBCAP"),d=e.properties,r=d.sideBarStatus,C=d.sideBarType.split("-"),b=A.contentBox(),D=(d.$vborder||0)*2,c=(d.$hborder||0)*2,a=o.contentBox(),j=(d.$iborder||0)*1,l=xui.$us(e),E=function(H,I){return e.$forceu(H,l>0?"em":"px",I)},B=e.getEmSize()/x._getEmSize(),m=o._getEmSize(B),G=w?e.$px(s.width):s.width,g=u?e.$px(s.height):s.height,f=e.$px(d.sideBarSize),n=E(f);C=r=="expand"?C[0]:(C[1]||C[0]);s.left=s.top=0;if(C&&C!="none"){F.css("line-height",E(f-(!b?0:c)));if(C=="left"||C=="right"){q.width(n);if(u&&"auto"!==u){q.height(E(g-(b?0:D)))}}else{q.height(n);q.width(E(G-(b?0:c)))}if(r=="fold"){if(C=="left"||C=="right"){x.width(E(f+c));A.width(E(f+(b?0:c)))}else{x.height(E(f+D));A.height(E(f+(b?0:D)))}return}else{if(C=="left"||C=="right"){x.width(E(w));A.width(E(G))}else{x.height(E(u));A.height(E(g))}switch(C){case"left":G-=f;s.left=f;break;case"right":G-=f;break;case"top":g-=f;s.top=f;break;case"bottom":g-=f;break}}}if(s.width){s.width=E(G-(b?0:c)-(!a?0:j),m)}if(s.height&&"auto"!==s.height){s.height=E(g-(b?0:D)-(!a?0:j),m)}o.cssRegion(s,true);if(s.width){xui.UI._adjustConW(e,o,s.width)}},_showTips:function(a,b,f){var c=a.properties;if(c.disableTips){return}if(a.onShowTips){return a.boxing().onShowTips(a,b,f)}if(!xui.Tips){return}if(c.sideBarType=="none"){return}var e=b.id,d=a.keys;if(c.sideBarStatus=="fold"&&(e.indexOf(d.SBCAP)===0||e.indexOf(d.SBBTN)===0)){xui.Tips.show(f,{tips:xui.wrapRes("$inline.Expand")});return false}else{if(c.sideBarStatus=="expand"&&e.indexOf(d.SBBTN)===0){xui.Tips.show(f,{tips:xui.wrapRes("$inline.Fold")});return false}}}}});xui.Class("xui.UI.Label","xui.UI",{Initialize:function(){xui.UI.SLabel=xui.UI.Label;var a="xui.UI.SLabel";xui.absBox.$type[a.replace("xui.UI.","")]=xui.absBox.$type[a]=a},Instance:{fireClickEvent:function(){this.getRoot().onClick();return this},_applyExcelFormula:function(d){var a=this.get(0),e=a.properties,c,b;if(c=e.excelCellFormula){b=xui.ExcelFormula.calculate(c,d);if(xui.isSet(b)){if(a.beforeApplyExcelFormula&&false===a.beforeApplyExcelFormula(a,e.excelCellFormula,b)){}else{this.setCaption(b,true);if(a.afterApplyExcelFormula){a.afterApplyExcelFormula(a,e.excelCellFormula,b)}}}}}},Static:{Templates:{tagName:"label",className:"{_className}",style:"{_hAlign};{_style}",VALIGN:{$order:0,style:"{_vAlign}"},ICON:{$order:1,className:"xuicon {imageClass} {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{_fc}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{$order:2,text:"{caption}",style:"{_fc}{_fw}{_fs}{_ff}","font-size":"1em"}},Appearances:{VALIGN:{"font-size":0,width:0,display:"inline-block",height:"100%"}},DataModel:{selectable:true,expression:{ini:"",action:function(){}},caption:{ini:null,action:function(a){var b=this;if(!b.properties.clock){a=(xui.isSet(a)?a:"")+"";b.getSubNode("CAPTION").html(xui.adjustRes(a,true))}}},clock:{ini:"",combobox:["hh : mm : ss","hh - mm : ss"],action:function(a){var c=this,d;if(a&&!c._timer){d=c._timer=new xui.Timer();var b=d.get(0).$onTime=function(){if(!c.destroyed){c.getSubNode("CAPTION").html(xui.Date.format(new Date,c.properties.clock))}};b()}else{if(!a&&c._timer){c._timer.destroy();c._timer=null;c.boxing().setCaption(c.properties.caption,true)}}}},image:{format:"image",action:function(a){xui.UI.$iconAction(this)}},imagePos:{action:function(a){this.getSubNode("ICON").css("backgroundPosition",a||"center")}},imageBgSize:{action:function(a){this.getSubNode("ICON").css("backgroundSize",a||"")}},imageClass:{ini:"",action:function(a,b){xui.UI.$iconAction(this,"ICON",b)}},iconFontCode:{action:function(a){xui.UI.$iconAction(this)}},iconFontColor:{ini:"",type:"color",action:function(a){this.getRoot().css("color",a)}},hAlign:{ini:"right",listbox:["left","center","right"],action:function(a){this.getRoot().css("textAlign",a||"")}},vAlign:{ini:"top",listbox:["top","middle","bottom"],action:function(a){this.getSubNode("VALIGN").css("verticalAlign",a||"")}},fontColor:xui.UI.Button.$DataModel.fontColor,fontSize:xui.UI.Button.$DataModel.fontSize,fontWeight:xui.UI.Button.$DataModel.fontWeight,fontFamily:xui.UI.Button.$DataModel.fontFamily,excelCellFormula:{ini:"",action:function(b){var c=this,a,d=c.properties;if(b&&xui.ExcelFormula.validate(b)){if(c.host&&(a=c.host["xui.Module"])){a.applyExcelFormula(c)}}}}},Behaviors:{HoverEffected:{KEY:"KEY",ICON:"ICON"},onClick:function(a,c,d){var b=a.properties;if(b.disabled){return false}if(a.onClick){return a.boxing().onClick(a,c,d)}}},EventHandlers:{onClick:function(a,b,c){},beforeApplyExcelFormula:function(b,a,c){},afterApplyExcelFormula:function(b,a,c){}},RenderTrigger:function(){var b=this,a;(b.$beforeDestroy=(b.$beforeDestroy||{}))["timerClear"]=function(){if(b._timer){b._timer.destroy();delete b._timer}};if(a=b.properties.clock){b.boxing().setClock(a,true)}},_prepareData:function(b,c){c=arguments.callee.upper.call(this,b,c);var a;if(c.caption){c.caption=xui.adjustVar(c.caption)}if(c.clock){c.caption=""}if(a=c.iconFontColor){c._ic="color:"+a+";"}if(a=c.fontSize){c._fs="font-size:"+a+";"}if(a=c.fontWeight){c._fw="font-weight:"+a+";"}if(a=c.fontColor){c._fc="color:"+a+";"}if(a=c.fontFamily){c._ff="font-family:"+a+";"}c._hAlign="text-align:"+(c.hAlign||"");c._vAlign="vertical-align:"+(c.vAlign||"");return c}}});xui.Class("xui.UI.ProgressBar",["xui.UI.Widget","xui.absValue"],{Instance:{_setCtrlValue:function(a){return this.each(function(c){var b=c.properties.type,d=c.getSubNode("FILL");if(b=="horizontal"){d.width(a+"%")}else{d.top((100-a)+"%").height(a+"%")}c.getSubNode("CAP").text(c.properties.captionTpl.replace(/\{value\}|\*/g,a))})}},Initialize:function(){var a=this,b=a.getTemplate();xui.merge(b.FRAME.BORDER,{className:"xui-uiborder-flat xui-uiborder-radius xui-uibase",FILL:{tagName:"div",style:"{fillBG}",className:"xui-uibar",text:"{html}"+xui.UI.$childTag},INN:{$order:2,tagName:"div",CAP:{tagName:"div"}}},"all");a.setTemplate(b);b=a.getAppearance();xui.merge(b,{BORDER:{overflow:"hidden"},INN:{display:"table",position:"absolute",left:0,top:0,width:"100%",height:"100%"},CAP:{"text-align":"center"},FILL:{border:"none",position:"relative",width:0,height:0,left:0,top:0}});a.setAppearance(b)},Static:{DataModel:{value:0,width:{$spaceunit:1,ini:"25em"},height:{$spaceunit:1,ini:"1.5em"},captionTpl:{ini:"* %",action:function(){this.boxing()._setCtrlValue(this.properties.$UIvalue)}},type:{listbox:["vertical","horizontal"],ini:"horizontal",action:function(b){var a=this.properties.width,c=this.properties.height;this.properties.height=a;this.properties.width=c;this.boxing().refresh()}},fillBG:{ini:"",format:"color",action:function(a){this.getSubNode("FILL").css("background",a)}},$hborder:1,$vborder:1},LayoutTrigger:function(){var a=this.properties,b=this.getSubNode("BORDER");a.$hborder=a.$vborder=b._borderW("left")},_prepareData:function(a){var b=arguments.callee.upper.call(this,a);b.fillBG=b.fillBG?"background:"+b.fillBG:"";return b},_ensureValue:function(a,b){return Math.max(0,Math.min(100,((/^\s*\=/.test(b||""))?xui.ExcelFormula.calculate(b||""):parseInt(b,10))||0))},_onresize:function(c,b,r){var u=arguments.callee.upper.apply(this,arguments),o,a=c.properties,f=xui.$us(c),g=function(w,x){return c.$forceu(w,f>0?"em":"px",x)},m=c.getRoot(),n=c.getSubNode("INN"),q=c.getSubNode("CAP"),s=c.getSubNode("FILL"),e=c.getEmSize()/m._getEmSize(),d=n._getEmSize(e),j=q._getEmSize(e),l=s._getEmSize(e);if(u.width&&u.width!="auto"){u.width=c.$px(u.width)}if(u.height&&u.height!="auto"){u.height=c.$px(u.height)}if(a.type=="horizontal"){if(u.height){o=g(u.height,d);n.css({"line-height":o});o=g(u.height,l);s.css({height:o,"line-height":o});o=g(u.height,j);q.css({height:o,"line-height":o})}}else{if(u.width){s.css({width:g(u.width,l)});q.css({width:g(u.width,j)})}if(u.height){n.css({"line-height":g(u.height,d)});s.css({"line-height":g(u.height,l)});q.css({"line-height":g(u.height,j)})}}}}});xui.Class("xui.UI.Input",["xui.UI.Widget","xui.absValue"],{Instance:{_setTB:function(c){var b=this.get(0),e=b.properties,f,a;if(!b.host||!e.tipsBinder){return}var d=b.tips;a=b.tips=b.tips||e.tips||"";f=xui.getObject(e.tipsBinder)||((f=b.host[e.tipsBinder])&&f.get(0));if(f&&(f.key=="xui.UI.Span"||f.key=="xui.UI.Div"||f.key=="xui.UI.Label")){if(f.renderId){f.getRootNode().innerHTML=a.charAt(0)=="$"?xui.wrapRes(a):a;f.getRoot().css("color",c==1?"gray":c==2?"red":"#000")}}if(d!==b.tips&&xui.Tips&&xui.Tips.getTips()){xui.Tips.setTips(b.tips)}},activate:function(a){var b=this.get(0);if(b&&b.renderId){var c=b.getSubNode("INPUT").get(0);if(c){try{c.focus();if(a||(!xui.browser.fakeTouch&&xui.browser.deviceType!="touchOnly")){try{if(c.tagName.toLowerCase()=="input"||!/[\n\r]/.test(c.value)){c.select()}else{xui(c).caret(0,0)}}catch(d){}}}catch(d){}delete b._justFocus}}return this},getAutoexpandHeight:function(){var a=this.get(0),b=a.properties;return(b.multiLines&&parseFloat(a._autoexpand||b.autoexpand))?(a.$autoExpandH||a.$px(a._autoexpand||b.autoexpand)):null},_setCtrlValue:function(a){if(xui.isNull(a)||!xui.isDefined(a)){a=""}return this.each(function(b){if(b.$Mask&&!a){a=b.$Mask}b.$_inner=1;b.getSubNode("INPUT").attr("value",a+"");b.box._checkAutoexpand(b);delete b.$_inner})},_getCtrlValue:function(){var b=this.getSubNode("INPUT"),a=(b&&!b.isEmpty())?this.getSubNode("INPUT").attr("value"):"";if(a.indexOf("\r")!=-1){a=a.replace(/(\r\n|\r)/g,"\n")}if(this.get(0).$Mask&&this.get(0).$Mask==a){a=""}return a},_setDirtyMark:function(){return this.each(function(b){var j=b.properties,a=b.getSubNode("INPUT"),n=b.box,f=b.boxing(),g=xui.UI.$css_tag_dirty,m=xui.UI.$css_tag_invalid,l=j.value!==j.$UIvalue;var e=b.tips;if(b._inValid==2){b.tips=j.tipsErr||j.tips}else{if(b._inValid==1){b.tips=j.tips}else{b.tips=j.tipsOK||j.tips}}if(e!==b.tips&&xui.Tips&&xui.Tips.getTips()){xui.Tips.setTips(b.tips)}if(b._dirtyFlag!==l){if(j.dirtyMark&&j.showDirtyMark){if(b.beforeDirtyMark&&false===f.beforeDirtyMark(b,l)){}else{if(b._dirtyFlag=l){a.addClass(g)}else{a.removeClass(g)}}}b._dirtyFlag=l}if(b.beforeFormatMark&&false===f.beforeFormatMark(b,b._inValid==2)){}else{var c=b.getSubNode("ERROR");if(b._inValid==2){a.addClass(m);c.css("display","block")}else{a.removeClass(m);c.css("display","none")}}f._setTB(b._inValid)})},getSelectedItem:function(c){var b=arguments.callee.upper,a=b.apply(this,xui.toArr(arguments));b=null;return this._adjustV(a)},getUIValue:function(){var b=arguments.callee.upper,a=b.apply(this,xui.toArr(arguments));b=null;return a},notifyExcel:function(a){return this.each(function(c){var d=c.properties,b="triggerExcelFormulas:";if(d.excelCellId){if(c.host&&c.host["xui.Module"]){b=b+c.host.xid;if(a===false){if(!xui.resetRun.exists(b)){if(c&&c.host){c.host.triggerExcelFormulas(c)}}}else{xui.resetRun(b,function(){if(c&&c.host){c.host.triggerExcelFormulas(null)}})}}}})},getExcelCellValue:function(){var a=this.get(0),d=a.properties,b,c;if(d.excelCellId){b=this.getUIValue();if(xui.isSet(c=(a.onGetExcelCellValue&&a.onGetExcelCellValue(a,d.excelCellId,b)))){b=c}}return b},_applyExcelFormula:function(d){var a=this.get(0),e=a.properties,c,b;if(c=e.excelCellFormula){b=xui.ExcelFormula.calculate(c,d);if(xui.isSet(b)){if(a.beforeApplyExcelFormula&&false===a.beforeApplyExcelFormula(a,e.excelCellFormula,b)){}else{this.setUIValue(b,true,null,"formula");if(a.afterApplyExcelFormula){a.afterApplyExcelFormula(a,e.excelCellFormula,b)}}}}}},Initialize:function(){var a=this.getTemplate();xui.merge(a.FRAME.BORDER,{style:"",LABEL:{className:"{_required} xui-ui-ellipsis",style:"{labelShow};width:{_labelSize};{_labelHAlign};{_labelVAlign};",text:"{labelCaption}"},BOX:{className:"xui-ui-input xui-ui-shadow-input xui-uiborder-flat xui-uiborder-radius xui-uibase",style:" {_hiddenBorder}",WRAP:{tagName:"div",INPUT:{$order:10,className:"xui-ui-ellipsis {_inputcls}",tagName:"input",type:"{_inputtype}",maxlength:"{maxlength}",tabindex:"{tabindex}",placeholder:"{placeholder}",style:"{_css};{hAlign}"}}}},"all");a.FRAME.ERROR={className:"xuifont",$fonticon:"xui-icon-error"};this.setTemplate(a)},Static:{_syncResize:true,_maskMap:{"~":"[+-]","1":"[0-9]",a:"[A-Za-z]",u:"[A-Z]",l:"[a-z]","*":"[A-Za-z0-9]"},_maskSpace:"_",Appearances:{KEY:{position:"relative"},BORDER:{},WRAP:{left:0,position:"absolute",overflow:(xui.browser.gek&&xui.browser.ver<3)?"auto":"visible"},BOX:{left:0,top:0,position:"absolute",overflow:"hidden","z-index":10},".xui-required-field BOX":{"border-color":"#ff0000"},LABEL:{$order:100,"z-index":1,top:0,left:0,display:xui.browser.isWebKit?"-webkit-flex":"flex",position:"absolute","padding-top":"4px","padding-bottom":"4px"},INPUT:{$order:100,"padding-top":"4px","padding-left":"4px","padding-right":"4px","padding-bottom":"4px","background-color":"transparent",border:0,margin:0,"text-align":"left","margin-top":xui.browser.ie67?"-1px":null,position:"relative","z-index":10,width:"8.5em",overflow:xui.browser.ie678?"hidden":"auto","overflow-y":xui.browser.ie678?"hidden":"auto","overflow-x":xui.browser.ie678?"hidden":"hidden",resize:"none"},"KEY textarea.autoexpand":{overflow:"hidden",$order:2},"KEY textarea":{"white-space":"normal","overflow-x":"hidden","overflow-y":"auto"},ERROR:{position:"absolute",right:".25em",top:".25em",display:"none","z-index":20}},Behaviors:{HoverEffected:{BOX:["BOX"]},NavKeys:{INPUT:1},LABEL:{onClick:function(a,b,c){if(a.properties.disabled){return false}if(a.onLabelClick){a.boxing().onLabelClick(a,b,c)}},onDblClick:function(a,b,c){if(a.properties.disabled){return false}if(a.onLabelDblClick){a.boxing().onLabelDblClick(a,b,c)}},onMousedown:function(a,b,c){if(xui.Event.getBtn(b)!="left"){return}if(a.properties.disabled){return false}if(a.onLabelActive){a.boxing().onLabelActive(a,b,c)}}},INPUT:{onChange:function(d,j,m){if(d.$_onedit||d.$_inner||d.destroyed||!d.box){return}var g=d.properties,c=d.box,l=d._inValid,a=d.boxing(),f=xui.use(m).get(0).value;if(d.$Mask&&d.$Mask==f){f=""}a.setUIValue(f,null,null,"onchange");if(g.$UIvalue!==f){a._setCtrlValue(g.$UIvalue)}if(l!==d._inValid){if(d.renderId){a._setDirtyMark()}}c._asyCheck(d)},onKeydown:function(g,l,n){var j=g.properties,c=g.box,a=j.multiLines,d=xui.Event,f=d.getKey(l);if(j.disabled||j.readonly){return}if(parseInt(j.autoexpand)){c._checkAutoexpand(g)}if(f.key=="enter"&&(!a||f.altKey)){xui.use(n).onChange()}c._asyCheck(g);if(j.mask){if(f.key.length>1){g.$ignore=true}else{delete g.$ignore}switch(f.key){case"backspace":c._changeMask(g,xui.use(n).get(0),"",false);return false;case"delete":c._changeMask(g,xui.use(n).get(0),"");return false}}},onKeypress:function(f,j,a){var d=f.properties,m=f.box,o=f.box,c=o._maskMap,g=xui.Event.getKey(j),n,l=xui.use(a).caret();if(f.beforeKeypress&&false===f.boxing().beforeKeypress(f,l,g,j,a)){return false}n=f.CF.beforeKeypress||f.$beforeKeypress;if(n&&false===n(f,l,g,j,a)){return false}m._asyCheck(f);if(d.mask){if(f.$ignore){delete f.$ignore;return true}if(g.ctrlKey||g.altKey){return true}o._changeMask(f,xui.use(a).get(0),g.key,true);return false}},onKeyup:function(c,g,j){var f=c.properties,a=c.box;if(xui.Event.getKey(g).key=="esc"){c.boxing()._setCtrlValue(f.$UIvalue);if(c.onCancel){c.boxing().onCancel(c)}}if(f.dynCheck){var d=xui.use(j).get(0).value;c.box._checkValid(c,d);c.boxing()._setDirtyMark()}a._asyCheck(c)},onMousedown:function(a,b,c){a._mousedownmark=1;xui.asyRun(function(){if(a){delete a._mousedownmark}})},onMouseup:function(a,c,d){if(a.properties.selectOnFocus&&a._justFocus){var b=xui.use(d).get(0);if(!b.readOnly&&b.select){a.$mouseupDelayFun=xui.asyRun(function(){delete a.$mouseupDelayFun;if(!xui.browser.fakeTouch&&xui.browser.deviceType!="touchOnly"){if(b.tagName.toLowerCase()=="input"||!/[\n\r]/.test(b.value)){b.select()}}})}delete a._justFocus}if(a._activedonmousedown){delete a._activedonmousedown;var b=xui.use(d).get(0);if(b.tagName.toLowerCase()=="input"||!/[\n\r]/.test(b.value)){b.select()}}},onFocus:function(c,j,l){if(c.$ignoreFocus){return false}if(c.beforeFocus&&false===c.boxing().beforeFocus(c)){c.$ignoreBlur=1;xui(l).blur();delete c.$ignoreBlur;return false}var g=c.properties,a=c.box;if(g.disabled||g.readonly){return false}if(c.onFocus){c.boxing().onFocus(c)}c.getSubNode("BOX").tagClass("-focus");var d=xui.use(l).get(0);if(g.mask){var f=d.value;if(!f){c.$focusDelayFun=xui.asyRun(function(){if(!c.box){return}delete c.$focusDelayFun;c.$_inner=true;d.value=c.$Mask;delete c.$_inner;a._setCaret(c,d)})}}if(g.selectOnFocus&&!d.readOnly&&d.select){if(xui.browser.kde){c.$focusDelayFun2=xui.asyRun(function(){delete c.$focusDelayFun2;if(!xui.browser.fakeTouch&&xui.browser.deviceType!="touchOnly"){if(d.tagName.toLowerCase()=="input"||!/[\n\r]/.test(d.value)){d.select()}}})}else{if(!xui.browser.fakeTouch&&xui.browser.deviceType!="touchOnly"){if(d.tagName.toLowerCase()=="input"||!/[\n\r]/.test(d.value)){d.select()}}}if(c._mousedownmark){c._justFocus=1}}c.boxing()._setTB(3);a._asyCheck(c)},onBlur:function(c,g,j){if(c.$ignoreBlur){return false}xui.resetRun(c.$xid+":asycheck");if(c.$focusDelayFun){xui.clearTimeout(c.$focusDelayFun)}if(c.$focusDelayFun2){xui.clearTimeout(c.$focusDelayFun2)}if(c.$focusDelayFun2){xui.clearTimeout(c.$mouseupDelayFun)}var f=c.properties,a=c.box;if(f.disabled||f.readonly){return false}if(c.onBlur){c.boxing().onBlur(c)}if(c.destroyed){return false}c.getSubNode("BOX").tagClass("-focus",false);var d=xui.use(j).get(0).value;if(c.$Mask&&c.$Mask==d){d=""}if(f.$UIvalue==d){c.box._checkValid(c,d)}c.boxing()._setDirtyMark();a._asyCheck(c,false)}}},DataModel:{selectable:true,expression:{ini:"",action:function(){}},tipsErr:"",tipsOK:"",dynCheck:false,selectOnFocus:true,placeholder:{ini:"",action:function(a){this.getSubNode("INPUT").attr("placeholder",a)}},labelSize:{$spaceunit:2,ini:"0",action:function(a){this.getSubNode("LABEL").css({display:a?"":"none"});xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelPos:{ini:"left",listbox:["none","left","top","right","bottom"],action:function(a){xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelGap:{$spaceunit:2,ini:"4",action:function(a){xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelCaption:{ini:"",action:function(a){a=(xui.isSet(a)?a:"")+"";this.getSubNode("LABEL").html(xui.adjustRes(a,true))}},labelHAlign:{ini:"right",listbox:["","left","center","right"],action:function(a){this.getSubNode("LABEL").css({textAlign:a||"",justifyContent:a=="right"?"flex-end":a=="center"?"center":a=="left"?"flex-start":""})}},labelVAlign:{ini:"top",listbox:["","top","middle","bottom"],action:function(a){this.getSubNode("LABEL").css("align-items",a=="bottom"?"flex-end":a=="middle"?"center":a=="top"?"flex-start":"")}},valueFormat:{helpinput:[{caption:"phone",id:"^1[3456789]\\d{9}$"},{caption:"numpassword",id:"^\\d{6}$"},{caption:"required",id:"[^.*]"},{caption:"email",id:"^[\\w\\.=-]+@[\\w\\.-]+\\.[\\w\\.-]{2,4}$"},{caption:"charOnly",id:"^[a-zA-Z]*$"},{caption:"words",id:"^[\\w ]*$"},{captoin:"size",id:"^(([1-9]\d*.\d+)|([1-9]\d*)|(.\d\d*))s*(px|em)?$"},{caption:"integer",id:"^-?\\d\\d*$"},{caption:"positiveInteger",id:"^\\d\\d*$"},{caption:"number",id:"^-?(\\d\\d*\\.\\d*$)|(^-?\\d\\d*$)|(^-?\\.\\d\\d*$)"},{caption:"filepath",id:"([\\/]?[\\w_]+)+\\.\\w{1,9}$"},{caption:"URL",id:"^(http|https|ftp)\\:\\/\\/[\\w\\-\\_\\.]+[\\w\\-\\_](:[\\w]*)?\\/?([\\w\\-\\._\\?\\,\\'\\/\\\\\\+&amp;%\\$#\\=~])*$"},{caption:"color",id:"^\\#[0-9A-Fa-f]{6}$"},{caption:"HH:MM",id:"^(([0-1][0-9])|([2][0-3])):([0-5][0-9])$"},{caption:"HH:MM:SS",id:"^(([0-1][0-9])|([2][0-3])):([0-5][0-9])\\:([0-5][0-9])$"},{caption:"YYYY-MM-DD",id:"^([0-9]{4})\\-(([0][0-9])|([1][0-2]))\\-([0-3][0-9])$"},{caption:"DD/MM/YYYY",id:"^(([0-2][0-9])|([3][0-1]))/(([0][0-9])|([1][0-2]))/([0-9]{4})$"}]},mask:{action:function(d){var c=this,a=c.box;if(d){c.$MaskFormat=function(j,g){var b=j._maskMap,f=[],l=/[A-Za-z0-9]/;xui.arr.each(g.split(""),function(n,m){f.push(b[n]||(l.test(n)?"":"\\")+n)});return"^"+f.join("")+"$"}(a,d);c.$Mask=function(l,g){var b=l._maskMap,f=[],j=l._maskSpace;xui.arr.each(g.split(""),function(n,m){f.push(b[n]?j:n)});return f.join("")}(a,d);var e=c.properties.$UIvalue;e=xui.isSet(e)?(e+""):"";c.boxing()._setCtrlValue(e+c.$Mask.slice(e.length))}else{delete c.$MaskFormat;delete c.$Mask}}},value:"",width:{$spaceunit:1,ini:"10em"},height:{$spaceunit:1,ini:"auto"},hAlign:{ini:"",listbox:["","left","center","right"],action:function(a){this.getSubNode("INPUT").css("textAlign",a)}},disabled:{ini:false,action:function(a){this.box._handleInput(this,"xui-ui-disabled",a)}},hiddenBorder:{ini:false,action:function(a){var b=this.getSubNode("BOX");if(a){b.css("border","")}else{b.css("border","0px")}}},readonly:{ini:false,action:function(a){this.box._handleInput(this,"xui-ui-readonly",a)}},texttype:{ini:"text",listbox:["text","password"],set:function(a){var b=this;b.properties.texttype=a;if(b.renderId){b.boxing().refresh(true)}}},maxlength:{ini:-1,action:function(a){this.getSubNode("INPUT").attr("maxlength",a)}},multiLines:{ini:false,action:function(a){this.boxing().refresh()}},autoexpand:{$spaceunit:1,ini:"",action:function(a){this.boxing().refresh()}},tipsBinder:{ini:"",set:function(a){if(a["xui.UIProfile"]){a=a.$xid}if(a["xui.UI"]&&(a=a.get(0))){a=a.$xid}this.properties.tipsBinder=a+""}},excelCellId:{ini:"",action:function(){this.boxing().notifyExcel(false)}},excelCellFormula:{ini:"",action:function(b){var c=this,a,d=c.properties;if(b&&xui.ExcelFormula.validate(b)){if(c.host&&(a=c.host["xui.Module"])){a.applyExcelFormula(c)}}}}},EventHandlers:{beforeFocus:function(a){},onFocus:function(a){},onBlur:function(a){},onCancel:function(a){},beforeFormatCheck:function(a,b){},beforeFormatMark:function(a,b){},beforeKeypress:function(b,f,a,c,d){},onLabelClick:function(a,b,c){},onLabelDblClick:function(a,b,c){},onLabelActive:function(a,b,c){},onGetExcelCellValue:function(b,a,c){},beforeApplyExcelFormula:function(b,a,c){},afterApplyExcelFormula:function(b,a,c){},onAutoexpand:function(b,a,c){}},_checkAutoexpand:function(a){var c=a.properties,b=a._autoexpand||c.autoexpand;if(a.renderId&&parseFloat(b)){xui.resetRun(a.key+":"+a.$xid+":autoexpand",function(){if(a.renderId&&!a.destroyed){var j=a.getRoot(),f=a.$px(b),o=a.getSubNode("INPUT"),l=j.height(),n,m,d,e;d=o.get(0).style.height;n=o.height();ph=o._paddingH();m=o.scrollHeight();f-=l-n;o.height(f+"px");f=Math.max(f,o.scrollHeight()-ph);e=parseInt(f-n,10);o.get(0).style.height=d;if(e){var g=a.$autoExpandH=l+e;if(!(a.$beforeAutoexpand&&false===a.$beforeAutoexpand(a,g,e))){a.boxing().setHeight(g);if(a.$onAutoexpand){g=a.$onAutoexpand(a,g,e)}if(a.onAutoexpand){a.boxing().onAutoexpand(a,g,e)}}}}})}},_handleInput:function(d,a,b){var c=d.getSubNode("INPUT");if((""+c.get(0).type).toLowerCase()!="button"){if(!b&&(d.properties.disabled||d.properties.readonly)){b=true}d.getRoot()[b?"addClass":"removeClass"](a);c.attr("readonly",b)}},_prepareData:function(c){var e={},g=c.properties,b,a;if(g.height=="auto"){e.height="1.83em"}e._inputcls=parseFloat(c._autoexpand||g.autoexpand)?"autoexpand":"";var f=arguments.callee.upper.call(this,c,e);f._inputtype=f.texttype||"";if(f.maxlength<0){f.maxlength=""}if(xui.browser.kde){f._css="resize:none;"}f.hAlign=(a=f.hAlign)?("text-align:"+a):"";f._hiddenBorder=g.hiddenBorder?"border:0px":"";e._labelHAlign="text-align:"+(a=e.labelHAlign||"")+";justify-content:"+(a=="right"?"flex-end":a=="center"?"center":a=="left"?"flex-start":"");e._labelVAlign="align-items:"+((a=e.labelVAlign)=="bottom"?"flex-end":a=="middle"?"center":a=="top"?"flex-start":"");f.labelShow=f.labelPos!="none"&&f.labelSize&&f.labelSize!="auto"?"":"display:none";f._labelSize=f.labelSize?"":0+c.$picku();if(a=f.labelCaption){f.labelCaption=xui.adjustRes(a,true)}return f},_dynamicTemplate:function(c){var e=c.properties,a,d=c._exhash="$multiLines:"+e.multiLines,b=c.box.getTemplate(d);e.$UIvalue=e.value;if(!b){b=xui.clone(c.box.getTemplate());if(e.multiLines){a=b.FRAME.BORDER.BOX.WRAP.INPUT;a.tagName="textarea";delete a.type}c.box.setTemplate(b,d)}c.template=b},_ensureValue:function(a,b){return""+(xui.isSet(b)?b:"")},RenderTrigger:function(){var c=this,e=c.properties;xui.asyRun(function(){if(c.box){c.boxing()._setTB(1)}});c.getSubNode("WRAP").$firfox2();if(e.readonly){c.boxing().setReadonly(true,true)}if(e.tipsBinder){c.boxing().setTipsBinder(e.tipsBinder,true)}if(e.excelCellId){c.boxing().notifyExcel()}var j=xui.browser.ie,g=c.getSubNode("INPUT").get(0),a=c.box,d=function(b){if(j&&("propertyName" in b)&&b.propertyName!="value"){return}a._asyCheck(c,false)};if(j&&g.attachEvent){g.attachEvent("onpropertychange",d);g.attachEvent("ondrop",d);c.$ondestory=function(){var b=this.getSubNode("INPUT").get(0);if(b){b.detachEvent("onpropertychange",d);b.detachEvent("ondrop",d)}b=d=null}}else{g.addEventListener("input",d,false);g.addEventListener("drop",d,false);if(xui.browser.gek){g.addEventListener("dragdrop",d,false)}c.$ondestory=function(){var b=this.getSubNode("INPUT").get(0);if(b){b.removeEventListener("input",d,false);b.removeEventListener("drop",d,false);if(xui.browser.gek){b.removeEventListener("dragdrop",d,false)}}b=d=null}}g=null},LayoutTrigger:function(){var a=this.properties;if(a.mask){this.boxing().setMask(a.mask,true)}},_changeMask:function(e,g,j,r,c){if(false!==c){var C=this,q=e.properties,B=C._maskMap,s=C._maskSpace,b=q.mask,d=e.$Mask,l=xui(g),m=l.caret();if(r===false&&m[0]==m[1]&&m[0]>0){l.caret(m[0]-1,m[0])}if(r===undefined&&m[0]==m[1]){l.caret(m[0],m[0]+1)}if(r===true){if(d.charAt(m[0])!=s){var w=m[0]+d.substr(m[0],d.length).indexOf(s);l.caret(w,Math.max(m[1],w))}}var m=l.caret(),u=g.value,o=q.mask.charAt(m[0]),f=C._maskMap[o],x,n;if(f&&j&&j.length==1){if(o=="l"){j=j.toLowerCase()}else{if(o=="u"){j=j.toUpperCase()}}}if(f&&new RegExp("^"+f+"$").test(j)||j==""){n=u;if(m[0]!=m[1]){n=n.substr(0,m[0])+d.substr(m[0],m[1]-m[0])+n.substr(m[1],n.length-m[1])}if(j){n=n.substr(0,m[0])+j+n.substr(m[0]+1,n.length-m[0]-1)}var A=[];xui.arr.each(b.split(""),function(D,a){A.push(B[D]?(((new RegExp("^"+B[D]+"$")).test(n.charAt(a)))?n.charAt(a):d.charAt(a)):d.charAt(a))});if(r===true){j=d.substr(m[0]+1,u.length-m[0]-1);x=j.indexOf(s);x=m[0]+(x==-1?0:x)+1}else{x=m[0]}if(xui.browser.opr){if(r===undefined){xui.arr.insertAny(A,s,x)}if(r===false){xui.arr.insertAny(A,s,x++)}}u=A.join("");g.value=u;e.boxing().setUIValue(u==d?"":u,null,null,"mask");C._setCaret(e,g,x)}}else{var C=this,q=e.properties,B=C._maskMap,b=q.mask,d=e.$Mask,n=g.value,A=[];xui.arr.each(b.split(""),function(D,a){A.push((new RegExp("^"+(B[D]?B[D]:"\\"+D)+"$").test(n.charAt(a)))?n.charAt(a):d.charAt(a))});u=A.join("");g.value=u;e.boxing().setUIValue(u==d?"":u,null,null,"mask")}},_setCaret:function(a,b,c){if(a.properties.mask){if(typeof c!="number"){c=b.value.indexOf(this._maskSpace)}xui(b).caret(c,c)}},_checkValid2:function(a){if(!a.renderId){return true}return this._checkValid(a,a.getSubNode("INPUT").get(0).value)},_checkValid:function(d,f){var g=d.properties,b=(g.mask&&d.$MaskFormat),a=g.valueFormat||d.$valueFormat;if(d.boxing()._toEditor){f=d.boxing()._toEditor(f)}var c=d.getSubNode("INPUT"),j=c.get(0);if(j&&d.properties.required){v=j.value;if(d.keys.LABEL){var e=d.getSubNode("LABEL");if(!v){e.addClass("xui-required")}else{e.removeClass("xui-required")}}if(!v){d.getRoot().addClass("xui-required-field")}else{d.getRoot().removeClass("xui-required-field")}}if((d.beforeFormatCheck&&(d.boxing().beforeFormatCheck(d,f)===false))||(((f&&f.length)&&d.$Mask!==f)&&(b&&typeof b=="string"&&!(new RegExp(b)).test((f===0?"0":f)||"")))||(a&&typeof a=="string"&&!(new RegExp(a)).test((f===0?"0":f)||""))){d._inValid=2;return false}d._inValid=3;return true},_asyCheck:function(b,a){if(b.destroyed){return}if(!b.properties.dynCheck&&!b.properties.mask){return}xui.resetRun(b.$xid+":asycheck",function(){if(!b.renderId){return}var d=b.getSubNode("INPUT"),f=d.get(0);if(!f){return}if(b.properties.required){c=f.value;if(b.keys.LABEL){var e=b.getSubNode("LABEL");if(!c){e.addClass("xui-required")}else{e.removeClass("xui-required")}}if(!c){b.getRoot().addClass("xui-required-field")}else{b.getRoot().removeClass("xui-required-field")}}if(b.properties.mask){if(f.value.length!=b.$Mask.length){b.box._changeMask(b,f,"",true,a)}}if(b.properties.dynCheck){var c=f.value;if(b.$Mask&&b.$Mask==c){c=""}b.boxing().setUIValue(c,false,true,"asycheck")}})},_onresize:function(g,E,B){if(g._$ignoreonsize){return}var e=g.properties,K=function(f){if(!f){return null}f=g.getSubNode(f);return f},G=K("KEY"),d=K("INPUT"),w=K("BOX"),r=K("LABEL"),s=xui.$us(g),N=function(f,R){return g.$forceu(f,s>0?"em":"px",R)},H=g.getEmSize()/G._getEmSize(),J=d._getEmSize(H),n=r._getEmSize(H),Q,a,o="xui-node xui-input-input",D=xui.browser.contentBox,b=!D?0:Math.round(d._paddingH()/2)*2,I=!D?0:Math.round(d._paddingW()/2)*2,F,u=w._borderW();Q=a=!D?0:u/2;if(B){B=(F=B=="auto")?g.$em2px(!D?1.6666667:1,null,true)+b+u:g.$isEm(B)?g.$em2px(B,null,true):B}if(E){E=g.$isEm(E)?g.$em2px(E,null,true):E}if(F){g._$ignoreonsize=1;G.height(N(B));delete g._$ignoreonsize}var C=e.labelPos,q=(C=="none"||!C)?0:g.$px(e.labelSize,n)||0,M=(C=="none"||!C)?0:g.$px(e.labelGap)||0,P=E,j=B,m=Math.max(0,(e.$b_lw||0)-Q),A=Math.max(0,(e.$b_tw||0)-a);if(null!==P){P-=Math.max(Q*2,(e.$b_lw||0)+(e.$b_rw||0));if(xui.browser.ie6){P=(Math.round(parseFloat(P/2)))*2}}if(null!==j){j-=Math.max(a*2,(e.$b_lw||0)+(e.$b_rw||0));if(xui.browser.ie6){j=(Math.round(parseFloat(j/2)))*2}if(xui.browser.ie6&&null===E){w.ieRemedy()}}var c=m+(C=="left"?q:0),O=A+(C=="top"?q:0),L=P===null?null:Math.max(0,P-((C=="left"||C=="right")?q:0)),l=j===null?null:Math.max(0,j-((C=="top"||C=="bottom")?q:0)),x=j===null?null:Math.max(0,B-((C=="top"||C=="bottom")?q:0));if(null!==L&&L-I>0){d.width(N(Math.max(0,L-I),J))}if(null!==l&&l-b>0){d.height(N(Math.max(0,l-b),J))}w.cssRegion({left:N(c),top:N(O),width:N(L),height:N(l)});if(q){r.cssRegion({left:N(P===null?null:C=="right"?(P-q+M+Q*2):0,n),top:N(B===null?null:C=="bottom"?(B-q+M):0,n),width:N(P===null?null:Math.max(0,((C=="left"||C=="right")?(q-M):P)),n),height:N(B===null?null:Math.max(0,((C=="top"||C=="bottom")?(q-M):B)-b),n)})}c+=(L||0)+Q*2;if((g.$resizer)&&xui.browser.ie){w.ieRemedy()}}}});xui.Class("xui.UI.CheckBox",["xui.UI","xui.absValue"],{Initialize:function(){xui.UI.SCheckBox=xui.UI.CheckBox;var a="xui.UI.SCheckBox";xui.absBox.$type[a.replace("xui.UI.","")]=xui.absBox.$type[a]=a},Instance:{fireClickEvent:function(){this.getRoot().onClick();return this},activate:function(){this.getSubNode("FOCUS").focus(true);return this},_setCtrlValue:function(a){return this.each(function(b){b.getSubNode("MARK").tagClass("-checked",!!a)})},_setDirtyMark:function(){return arguments.callee.upper.apply(this,["CAPTION"])},notifyExcel:xui.UI.Input.prototype.notifyExcel,getExcelCellValue:xui.UI.Input.prototype.getExcelCellValue},Static:{Templates:{className:"{_className} ",style:"{_style} {_hAlign}",VALIGN:{$order:0,style:"{_vAlign}"},FOCUS:{tabindex:"{tabindex}",MARK:{$order:0,className:"{_iconPosCls} xuifont",$fonticon:"xui-uicmd-check"},ICON:{$order:1,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{$order:2,text:"{caption}"}}},Appearances:{KEY:{overflow:"visible"},MARK:{cursor:"pointer",margin:"0 .334em 0 .1667em","vertical-align":"middle"},VALIGN:{"font-size":0,width:0,display:"inline-block",height:"100%"},FOCUS:{cursor:"default","vertical-align":"middle",padding:".1667em 0"},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle","font-size":"1em"}},Behaviors:{HoverEffected:{KEY:"MARK",ICON:"ICON"},ClickEffected:{KEY:"MARK"},NavKeys:{FOCUS:1},onClick:function(c,f,g){var d=c.properties,a=c.boxing();if(d.disabled){return false}if(d.readonly){return false}a.setUIValue(!d.$UIvalue,null,null,"click");if(c.onChecked){a.onChecked(c,f,d.$UIvalue)}c.getSubNode("FOCUS").focus(true)},FOCUS:{onKeydown:function(b,c,d){var a=xui.Event.getKey(c).key;if(a==" "||a=="enter"){b.getRoot().onClick(true);return false}}}},DataModel:{value:false,expression:{ini:"",action:function(){}},hAlign:{ini:"left",listbox:["left","center","right"],action:function(a){this.getRoot().css("textAlign",a)}},vAlign:{ini:"top",listbox:["top","middle","bottom"],action:function(a){this.getSubNode("VALIGN").css("verticalAlign",a||"")}},iconPos:{ini:"left",listbox:["left","right"],action:function(a){this.getSubNode("MARK").removeClass("xui-float-left xui-float-right").addClass("xui-float-"+a)}},image:{format:"image",action:function(a){xui.UI.$iconAction(this)}},imagePos:{action:function(a){this.getSubNode("ICON").css("backgroundPosition",a||"center")}},imageBgSize:{action:function(a){this.getSubNode("ICON").css("backgroundSize",a||"")}},imageClass:{ini:"",action:function(a,b){xui.UI.$iconAction(this,"ICON",b)}},iconFontCode:{action:function(a){xui.UI.$iconAction(this)}},caption:{ini:undefined,action:function(a){a=(xui.isSet(a)?a:"")+"";this.getSubNode("CAPTION").html(xui.adjustRes(a,true))}},excelCellId:{ini:"",action:function(){this.boxing().notifyExcel(false)}}},EventHandlers:{onChecked:function(a,c,b){},onGetExcelCellValue:function(b,a,c){}},RenderTrigger:function(){var a=this,b=a.properties;if(b.excelCellId){a.boxing().notifyExcel()}},_prepareData:function(a){var b=arguments.callee.upper.call(this,a);b._hAlign="text-align:"+b.hAlign+";";b._vAlign="vertical-align:"+(b.vAlign||"");b._iconPosCls="xui-float-"+b.iconPos;return b},_ensureValue:function(a,b){return b==="0"?false:!!b}}});xui.Class("xui.UI.HiddenInput",["xui.UI.Widget","xui.absValue"],{Instance:{activate:function(){return this}},Static:{Templates:{className:"xui-display-none",style:"display:none",tagName:"input",type:"hidden"},DataModel:{expression:null,locked:null,required:null,dataBinder:null,dataField:null,display:null,visibility:null,position:null,left:null,top:null,right:null,bottom:null,width:null,height:null,rotate:null,showEffects:null,hideEffects:null,activeAnim:null,tabindex:null,zIndex:null,defaultFocus:null,hoverPop:null,hoverPopType:null,disabled:null,readonly:null,disableClickEffect:null,disableHoverEffect:null,dock:null,dockOrder:null,dockMargin:null,dockMinW:null,dockMinH:null,dockMaxW:null,dockMaxH:null,dockFloat:null,dockIgnore:null,dirtyMark:null,showDirtyMark:null,selectable:null,autoTips:null,tips:null,disableTips:null,renderer:null,className:null},EventHandlers:{beforeDirtyMark:null,onContextmenu:null,onDock:null,onLayout:null,onMove:null,onRender:null,onResize:null,onShowTips:null,beforeAppend:null,afterAppend:null,beforeRender:null,afterRender:null,beforeRemove:null,afterRemove:null,onHotKeydown:null,onHotKeypress:null,onHotKeyup:null},setUIValue:function(f,e,c,a){var d=arguments.callee.upper,b=d.apply(this,xui.toArr(arguments))},getUIValue:function(){var b=arguments.callee.upper,a=b.apply(this,xui.toArr(arguments));b=null;return a},_ensureValue:function(a,b){return""+(xui.isSet(b)?b:"")}}});xui.Class("xui.UI.ComboInput","xui.UI.Input",{Instance:{_adjustV:function(a){var b=this.get(0),c=b.properties;if(b.$isNumber){a=(""+a).replace(/[^\d.-]/g,"");a=xui.isNumb(parseFloat(a))?xui.toFixedNumber(a,c.precision):null}else{if(b.properties.type=="date"||b.properties.type=="datetime"){a=xui.isDate(a)?a:xui.isFinite(a)?new Date(parseInt(a,10)):null;if(a&&xui.isDate(a)){a=a.getTime()}}else{if(typeof a=="string"&&a.indexOf("\r")!=-1){a=a.replace(/(\r\n|\r)/g,"\n")}}}return a},getValue:function(){var b=arguments.callee.upper,a=b.apply(this,xui.toArr(arguments));b=null;return this._adjustV(a)},getAllSelectedValues:function(b){var a=getSelectedItem(true);var c=[];if(b){xui.each(a,function(d){c.push(d[k])})}else{c=a}return c},getSelectedItem:function(c){var b=arguments.callee.upper,a=b.apply(this,xui.toArr(arguments));b=null;return this._adjustV(a)},getUICationValue:function(c){var b=arguments.callee.upper,a=b.apply(this,xui.toArr(arguments));b=null;return this._adjustV(a)},getUIValue:function(){var b=arguments.callee.upper,a=b.apply(this,xui.toArr(arguments));b=null;return this._adjustV(a)},setCaptionValue:function(c){var b=arguments.callee.upper,a=b.apply(this,xui.toArr(arguments));b=null},getCaptionValue:function(){var b=arguments.callee.upper,a=b.apply(this,xui.toArr(arguments));b=null;return a},_getCtrlValue:function(){return this.get(0).properties.$UIvalue},_setCtrlValue:function(e){var c=this,d=arguments.callee,b=d._r1||(d._r1=/\</),a=d._r2||(d._r2=/\<\/?[^>]+\>/g);return this.each(function(j){if(!j.$typeOK){j.box._iniType(j)}var l=j.getSubNode("INPUT"),g=j.properties.type;e=j.$_onedit?c._toEditor(e):c.getShowValue(e);if(g!=="none"&&g!=="input"&&g!=="password"&&!j.properties.multiLines&&typeof e=="string"&&b.test(e)){e=e.replace(a,"")}if(j.$Mask&&!e){e=j.$Mask}j.$_inner=1;l.attr("value",e||"");delete j.$_inner;if(g=="color"){var f=xui.UI.ColorPicker.getTextColor(e);l.css({backgroundColor:e,color:f});if(j.properties.showMode=="compact"){j.getRoot().query("button").css("color",f)}}})},_compareValue:function(d,c){var b=this.get(0),a;if(a=b.CF.compareValue||b.$compareValue){return a(b,d,c)}return d===c},getShowValue:function(e){var c=this.get(0),f=c.properties,a,b;if(!xui.isDefined(e)){e=f.$UIvalue}if(!c.$typeOK){c.box._iniType(c)}if(b=c.CF.getShowValue||c.$getShowValue){a=b(c,e)}else{if("listbox"==f.type){var d=(f.listKey)?xui.UI.getCachedData(f.listKey):f.items;if(d&&(b=xui.arr.subIndexOf(d,"id",e))!=-1){a=d[b].caption+"";if(a&&a.length>0){a=xui.adjustRes(a)}}else{a=null}}else{a=c.$showValue}}if(!xui.isSet(a)&&(c.$inputReadonly||f.inputReadonly)){a=xui.isSet(f.caption)?f.caption:null}return""+(xui.isSet(a)?a:xui.isSet(e)?e:"")},_toEditor:function(c){var b=this.get(0),d=b.properties,a;if(a=b.CF.toEditor||b.$toEditor){return a(b,c)}return c},_fromEditor:function(c){var b=this.get(0),d=b.properties,a;if(a=b.CF.fromEditor||b.$fromEditor){return a(b,c)}return c},setPopWnd:function(a){if(this.isDestroyed()){return}var b=this.get(0);b.$poplink=a?a["xui.Module"]?a.getRoot(true):a["xui.UI"]?a.get(0):a:null;(b.$poplink.$beforeDestroy=(b.$poplink.$beforeDestroy||{}))["$poplink_to"]=function(){delete b.$poplink};(b.$beforeDestroy=(b.$beforeDestroy||{}))["$poplink"]=function(){if(b.$poplink){xui.filter(b.box.$drop,function(c){return c!==b.$poplink});b.$poplink.boxing().destroy();b.$poplink=null}}},_cache:function(e,a){if(this.isDestroyed()){return}var d=this.get(0);var b=d.$poplink,c=d.properties.cachePopWnd;if(b){if(!c){if(!b.destroyed){b.boxing().destroy(true)}delete d.$poplink;if(a){d.boxing().activate()}}else{if(!d.__tryToHide){d.__tryToHide=xui.asyRun(function(){if(!d.box){return}delete d.__tryToHide;if(!b.destroyed){if(xui.browser.opr){b.getRoot().css("display","none")}if(b.boxing()._clearMouseOver){b.boxing()._clearMouseOver()}d.getSubNode("POOL").append(b.getRoot())}if(a){d.boxing().activate()}})}}}delete d.$poplink;if(d.afterPopHide){this.afterPopHide(d,b,e)}return c},clearPopCache:function(){var a=this.get(0);if(a.renderId){a.getSubNode("POOL").empty()}delete a.$poplink;return this},setUploadObj:function(a){var b=this.get(0),f=b.properties,e=xui(a).get(0);if(e.tagName&&e.tagName.toLowerCase()=="input"&&e.type=="file"){if(b.renderId&&f.type=="file"){var d=b.getSubNode("FILE").get(0);xui.setNodeData(e.$xid=d.$xid,"element",e);e.id=d.id;e.onclick=d.onclick;e.onchange=d.onchange;d.$xid=null;d.id=d.onclick=d.onchange=null;delete b.$_domid[b.keys.FILE];xui([d]).addPrev(e).remove(false);this.setUIValue(e.value||"",null,null,"setfile")}}return this},getUploadObj:function(){var a=this.get(0),e=a.properties;if(a.renderId&&e.type=="file"){var b=a.getSubNode("FILE").get(0);if(!b.value){return null}var d=b.cloneNode(false);d.value="";xui.setNodeData(d.$xid=b.$xid,"element",d);d.onclick=b.onclick;d.onchange=b.onchange;b.$xid=null;b.id=b.onclick=b.onchange=null;delete a.$_domid[a.keys.FILE];xui([b]).addPrev(d).remove(false);d=null;this.setUIValue(this.getValue(),null,null,"getfile");return b}},popFileSelector:function(d,a){var e=this.get(0),g=e.properties;if(e.renderId&&g.type=="file"){var b=e.getSubNode("FILE"),f=b.get(0);b.attr("accept",d||g.fileAccept||null);b.attr("multiple",a||g.fileMultiple?"multiple":null);if(xui.browser.ie11){var c=document.createElement("div");f.appendChild(c);c.click();f.removeChild(c)}else{f.click()}}},resetValue:function(c){this.each(function(d){if(d.properties.type=="file"){d.getSubNode("FILE").attr("value","")}});var a=arguments.callee.upper,b=a.apply(this,xui.toArr(arguments));a=null;return b},_drop:function(c,d,b,a){return this.each(function(m){var A=m.properties,u=A.type,x=A.cachePopWnd;if(A.disabled||A.readonly){return}if(m.$poplink){return}var g,B,j,r=m.boxing(),n=m.getSubNode("BOX"),f=m.getSubNode("RBTN"),w=n.offset();w.top+=n.offsetHeight();if((!a&&m.beforeComboPop&&false===r.beforeComboPop(m,w,c,d))){return}if(u=="combobox"||u=="listbox"||u=="helpinput"||u=="date"||u=="time"||u=="datetime"||u=="color"){if(m.__tryToHide){xui.clearTimeout(m.__tryToHide);delete m.__tryToHide}var s;if(x){switch(u){case"time":case"date":case"datetime":case"color":s=u;break;default:if(A.listKey){if(typeof xui.get(xui.$cache,["UIDATA",A.listKey])=="function"){j=s=null}else{s="!"+A.listKey}}else{s="$"+m.$xid}}if(s){xui.filter(m.box.$drop,function(D){return !!D.renderId});j=m.box.$drop[s]}}if(!j){switch(u){case"combobox":case"listbox":case"helpinput":g=xui.create("List");g.setHost(m).setDirtyMark(false).setItems(xui.copy(A.items)).setListKey(A.listKey||"");if(A.dropListWidth){g.setWidth(A.dropListWidth)}else{g.setWidth(m.$forceu(n.offsetWidth()+f.offsetWidth()))}g.setHeight(A.dropListHeight||"auto");g.afterClick(function(){if(!this.destroyed){this.boxing()._cache("",true)}else{g.destroy(true)}return false});g.beforeUIValueSet(function(G,F,E){var o=this.boxing();if(u=="combobox"){var D=G.queryItems(G.properties.items,function(H){return H.id==E},false,true);if(D.length){E=D[0].caption}}o.setUIValue(E,null,null,"pick");return o._cache("",true)});break;case"time":g=xui.create("TimePicker");g.setHost(m);g.beforeClose(function(){if(!this.destroyed){this.boxing()._cache("",true)}return false});g.beforeUIValueSet(function(F,G,E){var D=this.boxing();D.setUIValue(E,null,null,"pick");return D._cache("",true)});break;case"date":case"datetime":g=xui.create("DatePicker");if(u=="datetime"){g.setTimeInput(true)}g.setHost(m);g.beforeClose(function(){if(!this.destroyed){this.boxing()._cache("",true)}else{g.destroy(true)}return false});g.beforeUIValueSet(function(F,G,E){var D=this.boxing();D.setUIValue(String(E.getTime()),null,null,"pick");return D._cache("",true)});break;case"color":g=xui.create("ColorPicker");g.setHost(m);g.beforeClose(function(){if(!this.destroyed){this.boxing()._cache("",true)}else{g.destroy(true)}return false});g.beforeUIValueSet(function(F,G,E){var D=this.boxing();D.setUIValue((E=="transparent"?"":"#")+E,null,null,"pick");return D._cache("",true)});break}if(xui.isHash(A.popCtrlProp)&&!xui.isEmpty(A.popCtrlProp)){g.setProperties(A.popCtrlProp)}if(xui.isHash(A.popCtrlEvents)&&!xui.isEmpty(A.popCtrlEvents)){g.setEvents(A.popCtrlEvents)}j=g.get(0);if(s){m.box.$drop[s]=j}g.render()}g=j.boxing();g.setHost(m);switch(u){case"combobox":case"listbox":case"helpinput":case"time":g.setValue(m.properties.$UIvalue,true,"pop");break;case"date":case"datetime":var C=j.properties;if(C=m.properties.$UIvalue){g.setValue(new Date(parseInt(C,10)),true,"pop")}break;case"color":g.setValue(m.properties.$UIvalue.replace("#",""),true,"pop");break}m.boxing().setPopWnd(g);if(!a&&m.beforePopShow&&false===r.beforePopShow(m,j,m.properties.items)){return}var l=g.reBoxing(),q=A.parentID||xui.ini.$rootContainer;l.popToTop(b||m.getSubNode("BOX"),null,q?xui.get(m,["host",q])?m.host[q].getContainer():xui(q):null);xui.tryF(g.activate,[],g);var e=m.key+":"+m.$xid;l.setBlurTrigger(e,function(){r._cache("blur");xui.Event.keyboardHook("esc",0,0,0,e)});xui.Event.keyboardHook("esc",0,0,0,function(){m.$escclosedrop=1;xui.asyRun(function(){delete m.$escclosedrop});r.activate();r._cache("esc",true);xui.Event.keyboardHook("esc",0,0,0,e);return false},e,null,null,m.domId)}else{if(u=="file"){m.boxing().popFileSelector()}}if(!a&&m.afterPopShow){r.afterPopShow(m,j)}})},expand:function(c,a,d){var b=this.get(0);if(b.renderId){b.boxing()._drop(d,c,c,a)}},collapse:function(){var a=this.get(0);if(a.renderId&&a.$poplink){a.boxing()._cache("call")}},getPopWnd:function(){var a=this.get(0);if(a&&a.$poplink){return a.$poplink.boxing()}}},Initialize:function(){var f=this;f.addTemplateKeys(["ICONB","ICON","UNIT","FILE","LMID","RMID","LBTN","RBTN","SPINBTN","R1","R1B","R2","R2B"]);var e=f.getTemplate();xui.merge(e.FRAME.BORDER,{LBTN:{},RBTN:{},SPINBTN:{R1:{},R2:{}},CMD:{$order:50,tagName:"button",className:"xui-ui-unselectable xui-uiborder-radius-tr xui-uiborder-radius-br xui-uiborder-noradius-l xui-nofocus xui-ui-btn xui-uibar xui-uigradient",style:"{_cmdDisplay}",SMID:{className:"xuifont",$fonticon:"{_fi_commandCls}"}}},"all");var g=e.FRAME.BORDER.BOX;g.className="xui-ui-input xui-ui-shadow-input xui-uiborder-flat xui-uibase {_radius_input} ";g.ICONB={tagName:"button",className:"xui-ui-unselectable xui-nofocus xui-ui-clear",tabindex:"-1",ICON:{className:"xuifont {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"}};g.UNIT={tagName:"button",tabindex:"-1",className:"xui-ui-unselectable xui-nofocus",text:"{unit}"};e.FRAME.POOL={};e.className+=" {typecls}";f.setTemplate(e);f._adjustItems=xui.absList._adjustItems;var d=f.prototype,c=xui.absList.prototype;d.getItems=c.getItems;d.getItemByItemId=c.getItemByItemId},Static:{_beforeResetValue:function(a){a.properties.caption=undefined},_iniType:function(e){var f=e.properties,d=f.type,g=e.box;delete e.$beforeKeypress;delete e.$inputReadonly;delete e.$isNumber;delete e.$compareValue;delete e.$getShowValue;delete e.$toEditor;delete e.$fromEditor;delete e.$typeOK;if(d=="listbox"||d=="file"||d=="cmdbox"||d=="button"||d=="dropbutton"){e.$inputReadonly=true}if(d=="file"){e.$xuiFileCtrl=true}if(d!="listbox"&&d!="combobox"&&d!="helpinput"){f.items=[]}if(d=="time"){var b={a:1,c:1,v:1,x:1};xui.merge(e,{$beforeKeypress:function(l,m,j){return j.key.length!=1||/[-0-9:]/.test(j.key)||(j.ctrlKey&&!!b[j.key])},$getShowValue:function(j,c){return c?xui.UI.TimePicker._ensureValue(j,c):""},$fromEditor:function(j,c){if(c){c=xui.UI.TimePicker._ensureValue(j,c);if(c=="00:00"){c=j.properties.$UIvalue}}return c}},"all")}else{if(d=="date"||d=="datetime"){var a=xui.Date;var b={a:1,c:1,v:1,x:1};xui.merge(e,{$beforeKeypress:function(l,m,j){return j.key.length!=1||/[0-9:/\-_ ]/.test(j.key)||(j.ctrlKey&&!!b[j.key])},$compareValue:function(l,j,c){return(!j&&!c)||(String(j)==String(c))},$getShowValue:function(j,c){if(j.properties.dateEditorTpl){return c?a.format(c,j.properties.dateEditorTpl):""}else{return c?a.getText(new Date(parseInt(c,10)),j.properties.type=="datetime"?"ymdhn":"ymd"):""}},$toEditor:function(o,j){if(!j){return""}j=new Date(parseInt(j,10)||0);if(o.properties.dateEditorTpl){return a.format(j,o.properties.dateEditorTpl)}else{var c=(a.get(j,"m")+1)+"",q=a.get(j,"d")+"",l=a.get(j,"h")+"",r=a.get(j,"n")+"";return a.get(j,"y")+"-"+(c.length==1?"0":"")+c+"-"+(q.length==1?"0":"")+q+(o.properties.type=="datetime"?(" "+(l.length==1?"0":"")+l+":"+(r.length==1?"0":"")+r):"")}},$fromEditor:function(j,c){if(c){if(j.properties.dateEditorTpl){c=a.parse(c,j.properties.dateEditorTpl)}else{c=xui.Date.parse(c)}if(!c){c=j.properties.$UIvalue;if(xui.isFinite(c)){c=new Date(parseInt(c,10))}}if(c){if(j.properties.type!="datetime"){c=a.getTimSpanStart(c,"d",1)}if(c.getFullYear()<j.properties.min){c.setTime(j.properties.min)}if(c.getFullYear()>j.properties.max){c.setTime(j.properties.max)}}}return c?String(c.getTime()):""}},"all")}else{if(d=="currency"){e.$isNumber=1;var b={a:1,c:1,v:1,x:1};xui.merge(e,{$beforeKeypress:function(l,m,j){return j.key.length!=1||/[-0-9,. ]/.test(j.key)||(j.ctrlKey&&!!b[j.key])},$compareValue:function(l,j,c){return((j===""&&c!=="")||(c===""&&j!==""))?false:l.box._number(l,j)==l.box._number(l,c)},$getShowValue:function(l,j){var c=l.properties;if(xui.isSet(j)&&j!==""){j=xui.formatNumeric(l.box._number(l,j),c.precision,c.groupingSeparator,c.decimalSeparator,c.forceFillZero,c.trimTailZero);if(l.properties.currencyTpl){j=l.properties.currencyTpl.replace("*",j)}}else{j=""}return j},$toEditor:function(l,j){var c=l.properties;return(xui.isSet(j)&&j!=="")?xui.formatNumeric(l.box._number(l,j),c.precision,c.groupingSeparator,c.decimalSeparator,c.forceFillZero,c.trimTailZero):""},$fromEditor:function(j,c){return(xui.isSet(c)&&c!=="")?j.box._number(j,c):""}},"all")}else{if(d=="number"||d=="spin"||d=="counter"){e.$isNumber=1;var b={a:1,c:1,v:1,x:1};xui.merge(e,{$beforeKeypress:function(l,m,j){return j.key.length!=1||/[-0-9. ]/.test(j.key)||(j.ctrlKey&&!!b[j.key])},$compareValue:function(l,j,c){return((j===""&&c!=="")||(c===""&&j!==""))?false:l.box._number(l,j)==l.box._number(l,c)},$getShowValue:function(l,j){var c=l.properties;j=(xui.isSet(j)&&j!=="")?xui.formatNumeric(l.box._number(l,j),c.precision,c.groupingSeparator,c.decimalSeparator,c.forceFillZero,c.trimTailZero):"";if(j!=""&&l.properties.numberTpl){j=l.properties.numberTpl.replace("*",j)}return j},$toEditor:function(l,j){var c=l.properties;return(xui.isSet(j)&&j!=="")?xui.formatNumeric(l.box._number(l,j),c.precision,c.groupingSeparator,c.decimalSeparator,c.forceFillZero,c.trimTailZero):""},$fromEditor:function(j,c){return(xui.isSet(c)&&c!=="")?j.box._number(j,c):""}},"all")}}}}if(f.value){f.$UIvalue=f.value=g._ensureValue(e,f.value)}e.$typeOK=true},$drop:{},Appearances:{POOL:{position:"absolute",left:0,top:0,width:0,height:0,display:"none",visibility:"hidden"},FILE:{visibility:"hidden","z-index":30,border:0,width:"100%",height:"100%",position:"absolute",padding:0,top:0,right:0,cursor:"pointer",overflow:"hidden"},"KEY-type-number INPUT, KEY-type-spin INPUT, KEY-type-counter INPUT, KEY-type-currency INPUT":{$order:4,"text-align":"right"},"KEY-type-counter INPUT":{$order:4,"text-align":"center"},"KEY-type-file INPUT, KEY-type-button INPUT, KEY-type-dropbutton INPUT, KEY-type-cmdbox INPUT, KEY-type-listbox INPUT":{$order:4,cursor:"pointer","text-align":"left","white-space":"normal",overflow:"hidden"},"KEY-type-button INPUT, KEY-type-dropbutton INPUT":{$order:5,"text-align":"center"},"LBTN,RBTN,SPINBTN,CMD":{display:"block","z-index":20,cursor:"pointer",padding:0,position:"absolute",width:"1.5em",overflow:"visible"},"ICONB, UNIT":{"z-index":20,cursor:"pointer",position:"absolute",padding:0,margin:0,border:0,background:"none",height:"100%",padding:"0 2px",display:xui.$inlineBlock,zoom:xui.browser.ie67?1:null,width:(xui.browser.ie&&xui.browser.ver<=7)?"auto":null,overflow:(xui.browser.ie&&xui.browser.ver<=7)?"visible":null},ICONB:{left:0,top:0},ICON:{width:"1em"},UNIT:{top:0,right:0},CMD:{$order:2,"z-index":22,padding:0},"R1,R2":{$order:1,display:"block",cursor:"pointer",padding:0,position:"absolute",height:"50%",width:"1.5em",overflow:"visible"},R1:{top:0},R2:{bottom:0},"R1B,R2B":{cursor:"pointer",position:"absolute",left:0,top:"50%",height:"6px","margin-top":"-2px",padding:0,"z-index":2},"SMID,LMID,RMID":{$order:2,cursor:"pointer",padding:0,left:0}},_objectProp:{popCtrlProp:1,popCtrlEvents:1},Behaviors:{HoverEffected:{BOX:"BOX",ICON:"ICON",ICONB:"ICONB"},ClickEffected:{BOX:"BOX"},ICONB:{onClick:function(a,b,c){var d=a.properties;if(d.disabled||d.readonly){return}if(a.onClickIcon){a.boxing().onClickIcon(a,c)}}},UNIT:{onClick:function(c,f,j){var l=c.properties;if(l.disabled||l.readonly){return}if(!l.units){return}var g=xui.create("List",{dirtyMark:false,items:l.units.split(/[,;\:]/),width:"auto",height:"auto",value:l.unit});g.afterClick(function(){g.destroy(true);return false});g.beforeUIValueSet(function(m,n,e){c.boxing().setUnit(xui.str.trim(e))});g.render();var d=g.reBoxing(),b=l.parentID||xui.ini.$rootContainer;d.popToTop(j,null,b?xui.get(c,["host",b])?c.host[b].getContainer():xui(b):null);xui.tryF(g.activate,[],g);var a=c.key+":unit:"+c.$xid;d.setBlurTrigger(a,function(){g.destroy();xui.Event.keyboardHook("esc",0,0,0,a)});xui.Event.keyboardHook("esc",0,0,0,function(){g.destroy();xui.Event.keyboardHook("esc",0,0,0,a);return false},a,null,null,c.domId)}},FILE:{onClick:function(a,b,c){var d=a.properties;if(d.disabled||d.readonly){return}if(a.onFileDlgOpen){a.boxing().onFileDlgOpen(a,c)}},onChange:function(c,n,a){var b=c.properties,o=xui.use(a).get(0),q=o.value+"";if(b.type=="file"){var j=[];for(var g=0,m=o.files,d=m.length;g<d;g++){j.push(m[g].name)}q=j.length?'"'+j.join('", "')+'"':""}c.boxing().setUIValue(q,null,null,"onchange")}},LBTN:{onMousedown:function(a){var b=a.properties;if(b.disabled||b.readonly){return}a.box._spin(a,false)},onMouseout:function(a){xui.Thread.abort(a.$xid+":spin")},onMouseup:function(a){xui.Thread.abort(a.$xid+":spin")}},RBTN:{onMousedown:function(b){var c=b.properties,a=c.type;if(a!="counter"){return}if(c.disabled||c.readonly){return}b.box._spin(b,true)},onMouseout:function(a){if(a.properties.type!="counter"){return}xui.Thread.abort(a.$xid+":spin")},onMouseup:function(a){if(a.properties.type!="counter"){return}xui.Thread.abort(a.$xid+":spin")},onClick:function(b,c,d){var f=b.properties,a=f.type;if(a=="counter"){return}if(a=="popbox"||a=="cmdbox"||a=="listbox"||a=="getter"||a=="dropbutton"){if(b.onClick&&false===b.boxing().onClick(b,c,d,"right",f.$UIvalue)){return}}if(a=="file"){b.boxing().popFileSelector();return}if(f.disabled||f.readonly){return}b.boxing()._drop(c,d);return false}},CMD:{onClick:function(a,b,c){var d=a.properties;if(d.disabled||d.readonly){return}if(a.onCommand&&false===a.boxing().onCommand(a,c,d.commandBtn)){return}if(d.commandBtn=="delete"||d.commandBtn=="remove"){a.boxing().setUIValue("",true,null,"cmd")}}},BOX:{onClick:function(a,b,c){var d=a.properties;if(d.type=="cmdbox"||d.type=="button"||d.type=="dropbutton"){if(a.onClick){a.boxing().onClick(a,b,c,"left",d.$UIvalue)}}else{if(d.inputReadonly||a.$inputReadonly){if(d.disabled||d.readonly){return}a.boxing()._drop(b,c)}}}},INPUT:{onClick:function(a,b,c){if(a.onClick){var d=a.properties;a.boxing().onClick(a,b,c,"left",d.$UIvalue)}if(b.$cell){b=xui.Event.getPos(b);if(b.left===0&&b.top===0){return false}}},onChange:function(f,g,a){if(f.$_onedit||f.$_inner||f.destroyed||!f.box){return}var d=f._inValid,c=f.properties,j=f.box,n=f.boxing(),m=n._fromEditor(xui.use(a).get(0).value),l=c.$UIvalue;if(!n._compareValue(l,m)){if(m===null){n._setCtrlValue(l)}else{n.setUIValue(m,null,null,"onchange");if(c.$UIvalue!==m){n._setCtrlValue(c.$UIvalue)}if(d!==f._inValid){if(f.renderId){n._setDirtyMark()}}}}j._asyCheck(f)},onKeyup:function(d,j,l){var g=d.properties,a=d.box,c=xui.Event.getKey(j);if(g.disabled||g.readonly){return false}if(d.$inputReadonly||g.inputReadonly){return}if(c.key=="esc"){if(d.$escclosedrop){return}d.boxing()._setCtrlValue(g.$UIvalue);if(d.onCancel){d.boxing().onCancel(d)}}if(g.dynCheck){var f=xui.use(l).get(0).value;d.box._checkValid(d,f);d.boxing()._setDirtyMark()}a._asyCheck(d);if(c.key=="down"||c.key=="up"){if(g.type=="spin"||g.type=="counter"){xui.Thread.abort(d.$xid+":spin");return false}}},onMousedown:function(a,b,c){a._mousedownmark=1;xui.asyRun(function(){if(a){delete a._mousedownmark}})},onMouseup:function(a,c,d){if(a.properties.selectOnFocus&&a._stopmouseupcaret){var b=xui.use(d).get(0);if(!b.readOnly&&b.select){a.$mouseupDelayFun=xui.asyRun(function(){delete a.$mouseupDelayFun;if(b.tagName.toLowerCase()=="input"||!/[\n\r]/.test(b.value)){b.select()}})}delete a._stopmouseupcaret}},onFocus:function(f,g,a){if(f.$ignoreFocus){return false}if(f.beforeFocus&&false===f.boxing().beforeFocus(f)){f.$ignoreBlur=1;xui(a).blur();delete f.$ignoreBlur;return false}var c=f.properties,j=f.box;if(c.disabled||c.readonly){return false}if(f.onFocus){f.boxing().onFocus(f)}if(f.$inputReadonly||c.inputReadonly){return}f.getSubNode("BORDER").tagClass("-focus");var o=f.boxing(),l=c.$UIvalue,n=o._toEditor(l),d=xui.use(a).get(0),q=d.value;if(l!==n&&q!==n){f.$_onedit=true;d.value=n;delete f.$_onedit}if(c.mask){var m=d.value;if(!m){f.$focusDelayFun=xui.asyRun(function(){if(!f.box){return}delete f.$focusDelayFun;f.$_onedit=true;f.boxing()._setCtrlValue(m=f.$Mask);delete f.$_onedit;j._setCaret(f,d)})}}if(c.selectOnFocus&&!d.readOnly&&d.select){if(xui.browser.kde){f.$focusDelayFun2=xui.asyRun(function(){delete f.$focusDelayFun2;if(d.tagName.toLowerCase()=="input"||!/[\n\r]/.test(d.value)){d.select()}})}else{if(d.tagName.toLowerCase()=="input"||!/[\n\r]/.test(d.value)){d.select()}}if(f._mousedownmark){f._stopmouseupcaret=1}}f.boxing()._setTB(3);j._asyCheck(f)},onBlur:function(f,l,m){if(f.$ignoreBlur){return false}xui.resetRun(f.$xid+":asycheck");if(f.$focusDelayFun){xui.clearTimeout(f.$focusDelayFun)}if(f.$focusDelayFun2){xui.clearTimeout(f.$focusDelayFun2)}if(f.$focusDelayFun2){xui.clearTimeout(f.$mouseupDelayFun)}var j=f.properties;if(j.disabled||j.readonly){return false}if(f.onBlur){f.boxing().onBlur(f)}if(f.$inputReadonly||j.inputReadonly){return}var c=f.box,a=f.boxing(),g=j.$UIvalue,d=xui.use(m).get(0).value;if(f.$Mask&&f.$Mask==d){d="";g=f.$Mask}d=a._fromEditor(d);f.getSubNode("BORDER").tagClass("-focus",false);if(a._compareValue(j.$UIvalue,d)){f.box._checkValid(f,d);a._setCtrlValue(g)}a._setDirtyMark();c._asyCheck(f,false)},onKeydown:function(g,l,n){var j=g.properties;if(j.disabled||j.readonly){return}var c=g.box,a=j.multiLines,d=xui.Event,f=d.getKey(l);if(f.key=="enter"&&(!a||f.altKey)&&!j.inputReadonly&&!g.$inputReadonly){g.$_onedit=true;g.boxing().setUIValue(g.boxing()._fromEditor(xui.use(n).get(0).value),true,null,"enter");g.$_onedit=false}c._asyCheck(g);if(j.mask){if(f.key.length>1){g.$ignore=true}else{delete g.$ignore}switch(f.key){case"backspace":c._changeMask(g,xui.use(n).get(0),"",false);return false;case"delete":c._changeMask(g,xui.use(n).get(0),"");return false}}if(f.key=="down"||f.key=="up"){if(j.type=="spin"||j.type=="counter"){if(!f.ctrlKey){g.box._spin(g,f.key=="up");return false}}else{if(f.ctrlKey&&j.type!="none"&&j.type!="input"&&j.type!="password"){g.boxing()._drop(l,n);return false}}}},onDblclick:function(a,b,c){a.getSubNode("RBTN").onClick(true)}},R1:{onMousedown:function(a){var b=a.properties;if(b.disabled||b.readonly){return}a.box._spin(a,true)},onMouseout:function(a){xui.Thread.abort(a.$xid+":spin")},onMouseup:function(a){xui.Thread.abort(a.$xid+":spin")}},R2:{onMousedown:function(a){var b=a.properties;if(b.disabled||b.readonly){return}a.box._spin(a,false)},onMouseout:function(a){xui.Thread.abort(a.$xid+":spin")},onMouseup:function(a){xui.Thread.abort(a.$xid+":spin")}}},EventHandlers:{onFileDlgOpen:function(a,b){},onCommand:function(b,c,a){},beforeComboPop:function(a,d,b,c){},beforePopShow:function(b,c,a){},afterPopShow:function(a,b){},afterPopHide:function(b,c,a){},onClick:function(b,d,f,a,c){},onClickIcon:function(a,b){},beforeUnitUpdated:function(a,b){},afterUnitUpdated:function(a,b){}},DataModel:{cachePopWnd:true,expression:{ini:"",action:function(){}},filter:"",itemsExpression:"",dateEditorTpl:"",groupingSeparator:",",decimalSeparator:".",forceFillZero:true,trimTailZero:false,parentID:"",enumClass:"",popCtrlProp:{ini:{}},popCtrlEvents:{ini:{}},image:{format:"image",action:function(){xui.UI.$iconAction(this);this.boxing().reLayout(true)}},imagePos:{action:function(a){this.getSubNode("ICON").css("backgroundPosition",a||"center")}},imageBgSize:{action:function(a){this.getSubNode("ICON").css("backgroundSize",a||"")}},imageClass:{ini:"",action:function(a,b){xui.UI.$iconAction(this,"ICON",b);this.boxing().reLayout(true)}},iconFontCode:{action:function(a){xui.UI.$iconAction(this);this.boxing().reLayout(true)}},dropImageClass:{action:function(){this.boxing().refresh()}},unit:{ini:"",set:function(a){var b=this;if(b.beforeUnitUpdated&&false===b.boxing().beforeUnitUpdated(b,a)){return}b.properties.unit=a;if(b.renderId){b.getSubNode("UNIT").html(a);b.boxing().reLayout(true)}if(b.afterUnitUpdated){b.boxing().afterUnitUpdated(b,a)}}},units:"",numberTpl:{ini:"",action:function(){this.boxing().setUIValue(this.properties.$UIvalue,true,null,"tpl")}},currencyTpl:{ini:"$ *",action:function(){this.boxing().setUIValue(this.properties.$UIvalue,true,null,"tpl")}},listKey:{set:function(b){var a=xui.UI.getCachedData(b),c=this;c.boxing().setItems(a?xui.clone(a):c.properties.items);c.properties.listKey=b}},dropListWidth:0,dropListHeight:0,items:{ini:[],set:function(a){var b=this;a=b.properties.items=b.box._adjustItems(a);if(b.renderId){b.SubSerialIdMapItem={};b.ItemIdMapSubSerialId={};b.box._prepareItems(b,a);if(b.$poplink&&b.$poplink.box){b.$poplink.boxing().setItems(a)}else{b.boxing().clearPopCache()}}}},type:{ini:"combobox",listbox:xui.toArr("none,input,password,combobox,listbox,file,getter,helpinput,button,dropbutton,cmdbox,popbox,date,time,datetime,color,spin,counter,currency,number"),set:function(a){var b=this;b.properties.type=a;if(b.renderId){b.boxing().refresh(true)}}},showMode:{ini:"normal",listbox:["","normal","compact","transparent"],action:function(){this.boxing().refresh()}},precision:2,increment:0.01,min:-Math.pow(10,15),max:Math.pow(10,15),commandBtn:{ini:"none",combobox:xui.toArr("none,save,delete,add,remove,pop,select,search,function"),action:function(){this.boxing().refresh()}},disabled:{ini:false,action:function(a){this.box._handleInput(this,"xui-ui-disabled",a)}},inputReadonly:{ini:false,action:function(a){this.box._handleInput(this,"xui-ui-inputreadonly",a)}},readonly:{ini:false,action:function(a){this.box._handleInput(this,"xui-ui-readonly",a)}},caption:{ini:null,set:function(a){var b=this.properties;b.caption=a;if(xui.isSet(a)){a=a+"";b.caption=xui.adjustRes(a,false)}if(this.renderId){if(this.$inputReadonly||b.inputReadonly){this.getSubNode("INPUT").attr("value",this.boxing().getShowValue())}}},get:function(){return this.boxing().getShowValue()}},fileAccept:"",fileMultiple:false},RenderTrigger:function(){var b=this,a=b.boxing(),c=b.properties;b.box._iniType(b);if(c.readonly){a.setReadonly(true,true)}else{if(c.inputReadonly){a.setInputReadonly(true,true)}}},_spin:function(e,c){if(e.$inDesign){return}var j=e.$xid+":spin";if(xui.Thread.isAlive(j)){return}var g=e.properties,a=Math.max(g.increment,Math.pow(10,-g.precision)),f=a*(c?1:-1),d={delay:300},b=function(){if(e.destroyed){return false}var l=((+g.$UIvalue)||0)+f;l=(xui.isSet(l)&&l!=="")?xui.formatNumeric(e.box._number(e,l),g.precision,g.groupingSeparator,g.decimalSeparator,g.forceFillZero,g.trimTailZero):"";e.boxing().setUIValue(l,null,null,"spin");d.delay*=0.9};d.task=b;xui.Thread(j,[d],500,null,b,null,true).start()},_dynamicTemplate:function(b){var g=b.properties,l=g.type,n=g.multiLines,a=g.fileAccept,e=g.fileMultiple,c=g.showMode,d=b._exhash="$multiLines:"+n+";type:"+l+";mode:"+c+";",m=b.box.getTemplate(d),j=function(q){return(!c||c=="normal")?q:"xui-ui-clear "+q.replace(/\b(xui-ui-btn|xui-uibar|xui-uigradient|xui-uibase)\b/g,"")};g.$UIvalue=g.value;if(!m){m=xui.clone(b.box.getTemplate());var o=m.FRAME.BORDER,f=o.BOX.WRAP.INPUT;delete o.LBTN;delete o.RBTN;delete o.SPINBTN;f.tagName="input";f.type="text";switch(l){case"none":case"input":case"number":case"currency":break;case"button":f.type="button";break;case"password":f.type="password";break;case"spin":o.SPINBTN={$order:20,className:"xui-ui-unselectable",style:"{rDisplay}",R1:{tagName:"button",className:j("xui-ui-btn xui-uibar xui-uigradient xui-nofocus {_radius_dropt}"),R1B:{className:"xuifont",$fonticon:"xui-icon-smallup"}},R2:{tagName:"button",className:j("xui-ui-btn xui-uibar xui-uigradient xui-nofocus {_radius_dropb}"),R2B:{className:"xuifont",$fonticon:"xui-icon-smalldown"}}};break;case"counter":o.LBTN={$order:1,tagName:"button",className:j("xui-ui-unselectable xui-ui-btn xui-uibar xui-uigradient xui-nofocus {_radius_dropl}"),style:"{_btnlDisplay}",LMID:{className:"xuifont",$fonticon:"{_fi_btnlClass}",style:"{_btnlStyle}"}};break;case"file":o.FILE={$order:20,className:"xui-ui-unselectable  {_radius_dropr}",tagName:"input",type:"file",accept:a||null,multiple:e?"multiple":null,hidefocus:xui.browser.ie?"hidefocus":null,size:"1"};case"listbox":case"cmdbox":case"dropbutton":o.className+=" xui-ui-noshadow";f.type="button"}if(l!="none"&&l!="input"&&l!="password"&&l!="button"&&l!="spin"&&l!="currency"&&l!="number"){o.RBTN={$order:20,tagName:"button",className:j("xui-ui-unselectable xui-ui-btn xui-uibar xui-uigradient xui-nofocus {_radius_dropr}"),style:"{_btnrDisplay}",RMID:{className:"xuifont",$fonticon:"{_fi_btnrClass}"}}}if(l=="button"||l=="dropbutton"){o.BOX.className+=" xui-uigradient"}if(n){switch(l){case"none":case"input":case"getter":case"helpinput":case"popbox":case"number":case"combobox":f.tagName="textarea";f.className="";delete f.type}}if(c&&c!="normal"){if(c=="transparent"){o.BOX.className="{_radius_input} "}o.CMD.className=j(o.CMD.className)}b.box.setTemplate(m,d)}b.template=m},_handleInput:function(d,a,b){var c=d.getSubNode("INPUT");if((""+c.get(0).type).toLowerCase()!="button"){if(!b&&(d.properties.disabled||d.properties.readonly||d.$inputReadonly)){b=true}d.getRoot()[b?"addClass":"removeClass"](a);c.attr("readonly",b)}},_prepareData:function(e){var g={},n="display:none",d=e.properties,o=d.type,f=d.showMode,j=e.box.$DataModel.commandBtn.combobox;g=arguments.callee.upper.call(this,e,g);var l=o,r,q,m=l=="counter";l=(l=="combobox"||l=="listbox"||l=="dropbutton")?"arrowdrop":l;g._fi_btnlClass="xui-icon-singleleft";g._fi_btnrClass=l=="counter"?"xui-icon-singleright":(g.dropImageClass||("xui-uicmd-"+l));g._type="text";g._cmdDisplay=(r=(!g.commandBtn)||g.commandBtn=="none")?n:"";g._fi_commandCls=(xui.arr.indexOf(j,g.commandBtn)!=-1?"xui-uicmd-":"")+g.commandBtn;g._btnrDisplay=(q=o=="none"||o=="input"||o=="password"||o=="currency"||o=="number"||o=="button")?n:"";g.typecls=e.getClass("KEY","-type-"+g.type);if(!f||f=="normal"){g._radius_dropl="xui-uiborder-radius-tl xui-uiborder-radius-bl xui-uiborder-noradius-r";g._radius_input=(r&&q)?"xui-uiborder-radius":m?"xui-uiborder-noradius":"xui-uiborder-radius-tl xui-uiborder-radius-bl xui-uiborder-noradius-r";g._radius_dropr=r?"xui-uiborder-radius-tr xui-uiborder-radius-br xui-uiborder-noradius-l":"xui-uiborder-noradius";g._radius_dropt=r?"xui-uiborder-radius-tr xui-uiborder-noradius-l xui-uiborder-noradius-b":"xui-uiborder-noradius";g._radius_dropb=r?"xui-uiborder-radius-br xui-uiborder-noradius-l xui-uiborder-noradius-t":"xui-uiborder-noradius"}else{if(f=="compact"){g._radius_input="xui-uiborder-radius"}}return g},_ensureValue:function(a,e){var b=arguments.callee,j=a.properties;if(!xui.isSet(e)||e===""){return""}if(a.$Mask&&a.$Mask==e){e=""}switch(a.properties.type){case"date":case"datetime":var f;if(e){if(xui.isDate(e)){f=e}else{if(xui.isFinite(e)){f=new Date(parseInt(e,10))}else{f=xui.Date.parse(e+"")}}}return f?String(a.properties.type=="datetime"?f.getTime():xui.Date.getTimSpanStart(f,"d",1).getTime()):"";case"color":var g=xui.UI.ColorPicker._ensureValue(null,e);return(g=="transparent"?"":"#")+g;case"time":return xui.UI.TimePicker._ensureValue(null,e);case"currency":case"number":case"spin":case"counter":return this._number(a,e);default:return typeof e=="string"?e:(e||e===0)?String(e):""}},_number:function(a,b){var c=a.properties;if(/^\s*\=/.test(b||"")){b=xui.ExcelFormula.calculate(b||"")||""}b=xui.toNumeric(b,c.precision,c.groupingSeparator,c.decimalSeparator,c.forceFillZero,c.trimTailZero);if(xui.isSet(c.max)){b=b>c.max?c.max:b}if(xui.isSet(c.min)){b=b<c.min?c.min:b}return b},_onresize:function(g,a,b){if(g._$ignoreonsize){return}var x=g.properties,aj=x.type,Q=x.showMode=="compact",ab=function(f){if(!f){return null}f=g.getSubNode(f);return f},F=ab("KEY"),ai=ab("INPUT"),E=ab("ICONB"),I=ab("UNIT"),l=ab("BOX"),U=ab("LABEL"),ae=ab(x.commandBtn!="none"?"CMD":null),ah=ab(aj=="counter"?"LBTN":null),C=ab(aj=="spin"?"SPINBTN":(aj=="none"||aj=="input"||aj=="password"||aj=="currency"||aj=="number"||aj=="button")?null:"RBTN"),J=xui.$us(g),O=function(f,ak){return g.$forceu(f,J>0?"em":"px",ak)},Y=g.getEmSize()/F._getEmSize(),m=ai._getEmSize(Y),X=U._getEmSize(Y),K=ai.get(0).type.toLowerCase()=="button",u,A,R="xui-node xui-input-input",N=xui.browser.contentBox,o=!N?0:K?0:Math.round(ai._paddingH()/2)*2,M=!N?0:Math.round(ai._paddingH()/2)*2,d=0,c,B,w,L,s=0,n=0,G=l._borderW(),P=G/2;u=A=!N?0:P;L=parseInt(g.getEmSize()*1.5,10);if(b){b=(c=b=="auto")?g.$em2px(!N?1.6666667:1,null,true)+M+G:g.$isEm(b)?g.$em2px(b,null,true):b}if(a){a=g.$isEm(a)?g.$em2px(a,null,true):a}if(c){g._$ignoreonsize=1;F.height(O(b));delete g._$ignoreonsize}var r=x.labelPos||"left",D=(r=="none"||!r)?0:g.$px(x.labelSize,X,true)||0,aa=(r=="none"||!r)?0:g.$px(x.labelGap,null,true)||0,Z=a,af=b,ad=0,q=0,H=0,e=Math.max(0,(x.$b_lw||0)-u),j=Math.max(0,(x.$b_tw||0)-A);if(null!==Z){Z-=Math.max(u*2,(x.$b_lw||0)+(x.$b_rw||0));q=ah?L:0;H=C?L:0;ad=ae?L:0;if(xui.browser.ie6){Z=(Math.round(Z/2))*2}}if(null!==af){af-=Math.max(A*2,(x.$b_lw||0)+(x.$b_rw||0));if(xui.browser.ie6){af=(Math.round(af/2))*2}if(xui.browser.ie6&&null===a){l.ieRemedy()}}var ac=Z===null?null:e+(r=="left"?D:0),V=af===null?null:j+(r=="top"?D:0),T=Z===null?null:Math.max(0,Z-((r=="left"||r=="right")?D:0)),ag=af===null?null:Math.max(0,af-((r=="top"||r=="bottom")?D:0)),S=af===null?null:Math.max(0,b-((r=="top"||r=="bottom")?D:0)),W=r=="right"?D:0;if(D){U.css("display","");U.cssRegion({left:O(Z===null?null:r=="right"?(Z-D+aa+u*2):0,X),top:O(b===null?null:r=="bottom"?(b-D+aa):0,X),width:O(Z===null?null:Math.max(0,((r=="left"||r=="right")?(D-aa):Z)),X),height:O(b===null?null:Math.max(0,((r=="top"||r=="bottom")?(D-aa):b)-o),X)})}else{U.css("display","none")}if(T!==null){if(Q){s+=q;n+=ad+H}else{T-=ad+H+q}}if(ah){if(S!==null){ah.height(O(Math.max(0,S)))}if(T!==null){ah.left(O(ac))}ah.top(O(V));if(!Q){ac+=q}if(T!==null){ac-=P;T+=P}}if(x.image||x.imageClass){E.setInlineBlock();if(B=E.offsetWidth(true)){s+=B}}if(!B){E.css("display","none")}else{if(Q&&q){E.left(O(q,E))}}if(ad){ae.top(O(V));if(S!==null){ae.height(O(Math.max(0,S)))}if(T!==null){ae.css("right",O(W));W+=ad-u;T+=P}}if(H){C.top(O(V));if(S!==null){C.height(O(Math.max(0,S)))}if(T!==null){C.css("right",O(W));T+=P}if(S!==null&&x.type=="spin"){if(S/2-A*2>0){ab("R1").height(O(S/2));ab("R2").height(O(S/2+(Math.round(S)-Math.round(S/2)*2)))}}}if(x.unit){I.setInlineBlock();if(w=I.offsetWidth(true)){n+=w}}if(!w){I.css("display","none")}else{if(Q&&(H||ad)){I.css("right",O(H+ad,I))}}l.cssRegion({left:T?O(ac):null,top:ag?O(V):null,width:T?O(T):null,height:ag?O(ag):null});if(s){ai.css("paddingLeft",O(s,E))}if(n){ai.css("paddingRight",O(n,I))}d=!N?0:K?0:ai._paddingW();if(null!==T&&T-d>0){ai.width(O(Math.max(0,T-d),m))}if(null!==ag&&ag-o>0){ai.height(O(Math.max(0,ag-o),m))}if((g.$resizer)&&xui.browser.ie){l.ieRemedy()}}}});xui.Class("xui.UI.RichEditor",["xui.UI","xui.absValue"],{Initialize:function(){this.addTemplateKeys(["TOOLBARBTN"])},Instance:{activate:function(){this.getEditorWin().focus();return this},getEditorWin:function(){return this.get(0).$win},getEditorDoc:function(){return this.get(0).$doc},getEditorBody:function(){var a=this.get(0).$doc;return a&&(a.body||a.documentElement)},_setCtrlValue:function(a){if(!xui.isSet(a)){a=""}return this.each(function(d){var e=window["/"];if(e&&e.indexOf(":/")!=-1){a=a.replace(/{\/}/g,e)}var c=d.$useOriginalText?a:xui.adjustRes(a,0,1);if(!d.$inDesign){var f=d.$doc,b=f&&(f.body||f.documentElement);if(b){b.innerHTML=c;return}}d.getSubNode("EDITOR").html(c)})},_getCtrlValue:function(){var c=this.get(0);if(!c.$inDesign){var d=c.$doc,a=d&&(d.body||d.documentElement);if(a){var b=a.innerHTML;if(this.getTextType()=="text"){b=a.innerText}sp=window["/"];if(sp&&sp.indexOf(":/")!=-1){b=b.replace(new RegExp(sp,"g"),"{/}")}return b}else{return""}}else{return c.getSubNode("EDITOR").text()}}},Static:{DIRYMARKICON:"DIRTYMARK",Templates:{tagName:"div",style:"{_style}",className:"{_className} xui-ui-selectable",LABEL:{className:"{_required} xui-ui-ellipsis",style:"{labelShow};width:{_labelSize};{_labelHAlign};{_labelVAlign}",text:"{labelCaption}"},BOX:{EDITOR:{tagName:"div",className:"xui-uiborder-flat xui-uiborder-radius xui-uibase"},DIRTYMARK:{},POOL:{}}},DataModel:{expression:{ini:"",action:function(){}},selectable:true,value:{ini:"",html:1},width:{$spaceunit:1,ini:"32em"},height:{$spaceunit:1,ini:"25em"},frameTemplate:{ini:'<html style="-webkit-overflow-scrolling: touch;padding:0;margin:0.25em;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"><style type="text/css">body{height: 100%;-webkit-overflow-scrolling: touch;border:0;padding:0;margin:.0;cursor:text;color:#000;font-family:arial,helvetica,clean,sans-serif;font-style:normal;font-weight:normal;font-size:12px;line-height:1.22}div, p{margin:0;padding:0;} body, p, div{word-wrap: break-word;} img, input, textarea{cursor:default;}</style></head><body scroll="auto" spellcheck="false"></body></html>',action:function(){this.boxing().refresh()}},frameStyle:"",cmdList:{ini:"font1;font2;align;list;font4;font3;insert;clear;html",action:function(a){var b=this;if(!b.properties.disabled&&!b.properties.readonly){b.box._iniToolBar(b)}}},cmdFilter:{ini:""},enableBar:{ini:false,action:function(b){var a=this;this.cmdList="";this.labelPos="none";if(!a.properties.disabled&&!a.properties.readonly){a.box._iniToolBar(a)}xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},disabled:{ini:false,action:function(a){var a=this.properties.disabled||this.properties.readonly,b=this.$doc;if(b){if(b.body.contentEditable!=undefined&&xui.browser.ie){b.body.contentEditable=a?"false":"true"}else{b.designMode=a?"off":"on"}this.box._iniToolBar(this,!a)}}},readonly:{ini:false,action:function(a){this.boxing().setDisabled(a)}},textType:{ini:"html",listbox:["text","html"],action:function(a){}},labelSize:{$spaceunit:2,ini:0,action:function(a){this.getSubNode("LABEL").css({display:a&&a!="auto"?"":"none"});xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelPos:{ini:"left",listbox:["none","left","top","right","bottom"],action:function(a){xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelGap:{$spaceunit:2,ini:4,action:function(a){xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelCaption:{ini:"",action:function(a){a=(xui.isSet(a)?a:"")+"";this.getSubNode("LABEL").html(xui.adjustRes(a,true))}},labelHAlign:{ini:"right",listbox:["","left","center","right"],action:function(a){this.getSubNode("LABEL").css({textAlign:a||"",justifyContent:a=="right"?"flex-end":a=="center"?"center":a=="left"?"flex-start":""})}},labelVAlign:{ini:"top",listbox:["","top","middle","bottom"],action:function(a){this.getSubNode("LABEL").css("align-items",a=="bottom"?"flex-end":a=="middle"?"center":a=="top"?"flex-start":"")}}},Appearances:{KEY:{overflow:"hidden"},BOX:{left:0,top:0,width:"100%",position:"absolute",overflow:"hidden"},POOL:{position:"absolute",display:"none"},DIRTYMARK:{position:"absolute",width:"1em",height:"1em"},TOOLBARBTN:{},LABEL:{"z-index":1,top:0,left:0,display:xui.browser.isWebKit?"-webkit-flex":"flex",position:"absolute","padding-top":".5em"},EDITOR:{position:"absolute",display:"block",left:0,top:0,width:"100%",height:"100%",padding:0,margin:0,"z-index":"10"}},Behaviors:{LABEL:{onClick:function(a,b,c){if(a.properties.disabled){return false}if(a.onLabelClick){a.boxing().onLabelClick(a,b,c)}},onDblClick:function(a,b,c){if(a.properties.disabled){return false}if(a.onLabelDblClick){a.boxing().onLabelDblClick(a,b,c)}},onMousedown:function(a,b,c){if(xui.Event.getBtn(b)!="left"){return}if(a.properties.disabled){return false}if(a.onLabelActive){a.boxing().onLabelActive(a,b,c)}}}},EventHandlers:{onInnerEvent:function(b,a,c,d){},onUpdateToolbar:function(a,b,c){},onReady:function(a){},onLabelClick:function(a,b,c){},onLabelDblClick:function(a,b,c){},onLabelActive:function(a,b,c){}},$cmds:{font1:[{id:"bold",command:"Bold",statusButton:true,imageClass:"xuifont xui-icon-bold",_fi_:"xui-icon-bold"},{id:"italic",command:"Italic",statusButton:true,imageClass:"xuifont xui-icon-italic",_fi_:"xui-icon-italic"},{id:"underline",command:"Underline",statusButton:true,imageClass:"xuifont xui-icon-underline",_fi_:"xui-icon-underline"},{id:"strikethrough",command:"strikeThrough",statusButton:true,imageClass:"xuifont xui-icon-strikethrough",_fi_:"xui-icon-strikethrough"}],font2:[{id:"subscript",command:"subscript",statusButton:true,imageClass:"xuifont xui-icon-sub",_fi_:"xui-icon-sub"},{id:"superscript",command:"superscript",statusButton:true,imageClass:"xuifont xui-icon-super",_fi_:"xui-icon-super"}],font3:[{id:"forecolor",command:"custom",imageClass:"xuifont xui-icon-forecolor",_fi_:"xui-icon-forecolor"},{id:"bgcolor",command:"custom",imageClass:"xuifont xui-icon-bgcolor",_fi_:"xui-icon-bgcolor"}],font4:[{id:"fontsize",command:"custom",caption:"$editor.fontsize",dropButton:true},{id:"fontname",command:"custom",caption:"$editor.fontname",dropButton:true},{id:"formatblock",command:"custom",caption:"$editor.formatblock",dropButton:true}],align:[{id:"left",command:"justifyleft",imageClass:"xuifont xui-icon-alignleft",_fi_:"xui-icon-alignleft"},{id:"center",command:"justifycenter",imageClass:"xuifont xui-icon-aligncenter",_fi_:"xui-icon-aligncenter"},{id:"right",command:"justifyright",imageClass:"xuifont xui-icon-alignright",_fi_:"xui-icon-alignright"},{id:"justify",command:"justifyfull",imageClass:"xuifont xui-icon-alignjustify",_fi_:"xui-icon-alignjustify"}],list:[{id:"indent",command:"indent",imageClass:"xuifont xui-icon-indent",_fi_:"xui-icon-indent"},{id:"outdent",command:"outdent",imageClass:"xuifont xui-icon-outdent",_fi_:"xui-icon-outdent"},{id:"ol",command:"insertorderedlist",imageClass:"xuifont xui-icon-number",_fi_:"xui-icon-number"},{id:"ul",command:"insertunorderedlist",imageClass:"xuifont xui-icon-bullet",_fi_:"xui-icon-bullet"}],insert:[{id:"hr",command:"insertHorizontalRule",imageClass:"xuifont xui-icon-inserthr",_fi_:"xui-icon-inserthr"},{id:"insertimage",command:"custom",imageClass:"xuifont xui-icon-picture",_fi_:"xui-icon-picture"},{id:"createlink",command:"custom",imageClass:"xuifont xui-icon-link",_fi_:"xui-icon-link"},{id:"unlink",command:"unlink",imageClass:"xuifont xui-icon-breaklink",_fi_:"xui-icon-breaklink"}],clear:[{id:"removeformat",command:"removeformat",imageClass:"xuifont xui-icon-formatclear",_fi_:"xui-icon-formatclear"}],html:[{id:"html",command:"custom",imageClass:"xuifont xui-icon-html",_fi_:"xui-icon-html"}]},_prepareData:function(c){var e=arguments.callee.upper.call(this,c),b,a;e._labelHAlign="text-align:"+(a=e.labelHAlign||"")+";justify-content:"+(a=="right"?"flex-end":a=="center"?"center":a=="left"?"flex-start":"");e._labelVAlign="align-items:"+((a=e.labelVAlign)=="bottom"?"flex-end":a=="middle"?"center":a=="top"?"flex-start":"");e.labelShow=e.labelPos!="none"&&e.labelSize&&e.labelSize!="auto"?"":"display:none";e._labelSize=e.labelSize?"":0+c.$picku();if(!e.enableBar){this.cmdList="";this.labelPos="none"}if(e.textType&&e.textType=="text"){this.cmdList="";this.labelPos="none"}if(e.labelCaption){e.labelCaption=xui.adjustRes(e.labelCaption,true)}return e},_updateToolbar:function(d,g,q){var c=xui.$cache.profileMap[d],m;if(!c){return}if(c.properties.disabled||c.properties.readonly){return}if(c&&(m=c.$toolbar)){var n=c.$doc,j=g?false:n.queryCommandState("bold"),f=g?false:n.queryCommandState("italic"),b=g?false:n.queryCommandState("underline"),a=g?false:n.queryCommandState("strikethrough"),l=g?false:n.queryCommandState("subscript"),o=g?false:n.queryCommandState("superscript"),e=m.boxing();e.updateItem("bold",{value:j});e.updateItem("italic",{value:f});e.updateItem("underline",{value:b});e.updateItem("strikethrough",{value:a});e.updateItem("subscript",{value:l});e.updateItem("superscript",{value:o});if(c.onUpdateToolbar){c.boxing().onUpdateToolbar(c,q,n)}n=null}},RenderTrigger:function(){var o=this;if(!o.properties.disabled&&!o.properties.readonly){o.box._iniToolBar(o)}if(!o.$inDesign){var n=o.getSubNode("EDITOR").get(0),d=o.$domId,r=o.properties.frameTemplate,u=o.properties.frameStyle,q=n.id;if(u){r=r.replace(/<\s*\/\s*head\s*>/,"<style>"+(u||"")+"</style></head>")}if(!o.$once){o.$once=true;try{var g=o.$ifr=document.createElement("IFRAME")}catch(w){var g=o.$ifr=document.createElement("<iframe name='"+q+"' id='"+q+"'></iframe>")}var m=this,a=o._eventOutput=function(B){if(m&&(m.properties.disabled||m.properties.readonly)){return}if(m.onInnerEvent){return m.boxing().onInnerEvent(m,B.type,xui.Event.getSrc(B),B)}},s=o._event=function(E){if(m&&(m.properties.disabled||m.properties.readonly)){return}var C=E.type;if(C!=="mouseover"&&C!=="mouseout"){xui.resetRun("RichEditor:"+d,function(){if(!m.box){return}xui.UI.RichEditor._updateToolbar(d,false,C)},100);if(C=="mousedown"){if(xui.browser.applewebkit&&E.target.tagName=="IMG"){var D=o.$win.getSelection(),B=o.$doc.createRange();B.selectNode(E.target);D.removeAllRanges();D.addRange(B)}xui.doc.onMousedown(true)}}if(m.onInnerEvent){return m.boxing().onInnerEvent(m,C,xui.Event.getSrc(E),E)}},j=o._event2=function(C){if(m&&(m.properties.disabled||m.properties.readonly)){return}if(m.onInnerEvent){var B=C.type;xui.resetRun(m.$xid+":frmInnerAsyEvent",function(){if(m&&!m.destroyed){m.boxing().onInnerEvent(m,B,xui.Event.getSrc(C),C)}})}},b=function(B){if(!m){return}if(m.properties.disabled||m.properties.readonly){return}m.box._onchange(m)},f=function(C){if(!m){return}if(m.properties.disabled||m.properties.readonly){return}xui.resetRun("RichEditor:"+d,function(){if(!m.box){return}xui.UI.RichEditor._updateToolbar(d,true,"blur")},100);if(m._onchangethread){clearInterval(m._onchangethread);m._onchangethread=null;if(m&&m.box){m.box._checkc(m)}}var B=m.boxing()._getCtrlValue();m.boxing().setUIValue(B,null,true,"blur")},l=function(C){if(m){var B=m.boxing();xui.asyRun(function(){if(!m.box){return}B.refresh()})}},A,c,x=function(){xui.setTimeout(function(){if(!frames[q]){return}if(!frames[q].document){return}if(o.$win!=frames[q].window){c=o.$win=frames[q].window;A=o.$doc=c.document;A.open();A.write(r);A.close();try{A.execCommand("styleWithCSS",0,false)}catch(D){try{A.execCommand("useCSS",0,true)}catch(D){}}var B=o.properties.disabled||o.properties.readonly;if(A.body.contentEditable!=undefined&&xui.browser.ie){A.body.contentEditable=B?"false":"true"}else{A.designMode=B?"off":"on"}if(B){o.box._iniToolBar(o,false)}c._gekfix=l;if(xui.browser.ie&&A.attachEvent){A.attachEvent("unload",l);if(!B){A.attachEvent("onmousedown",s);A.attachEvent("ondblclick",s);A.attachEvent("onclick",s);A.attachEvent("oncontextmenu",a);A.attachEvent("onkeyup",s);A.attachEvent("onkeydown",s);A.attachEvent("onmouseover",s);A.attachEvent("onmouseout",s);A.attachEvent("onmousemove",j);c.attachEvent("onfocus",b);c.attachEvent("onblur",f);(o.$beforeDestroy=(o.$beforeDestroy||{}))["ifmClearMem"]=function(){var J=this.$win,I=this.$doc,G=this._event,F=this._event2;if(this._onchangethread){clearInterval(this._onchangethread);this._onchangethread=null}try{var E=I.designMode;I.designMode="off";I.designMode="on";I.designMode=E}catch(H){}J._gekfix=undefined;try{I.detachEvent("unload",J._gekfix)}catch(H){}if(!this.properties.disabled&&!this.properties.readonly){I.detachEvent("onmousedown",G);I.detachEvent("ondblclick",G);I.detachEvent("onclick",G);I.detachEvent("oncontextmenu",a);I.detachEvent("onkeyup",G);I.detachEvent("onkeydown",G);I.detachEvent("onmouseover",G);I.detachEvent("onmouseout",G);I.detachEvent("onmousemove",F);J.detachEvent("onfocus",b);J.detachEvent("onblur",f)}J=I=G=F=null}}}else{var C=o;if(xui.browser.opr||!c.addEventListener){C.$repeatT=xui.Thread.repeat(function(){if(!frames[q]){return false}else{if(!C.$win.document||!C.$win.document.defaultView){C.boxing().refresh()}}},99)}else{c.addEventListener("unload",l,false)}if(!B){A.addEventListener("mousedown",s,false);A.addEventListener("dblclick",s,false);A.addEventListener("click",s,false);A.addEventListener("contextmenu",a,false);A.addEventListener("keyup",s,false);A.addEventListener("mouseover",s,false);A.addEventListener("mouseout",s,false);A.addEventListener("mousemove",j,false);if(xui.browser.gek||!c.addEventListener){A.addEventListener("focus",b,false);A.addEventListener("blur",f,false);A.addEventListener("keypress",s,false)}else{c.addEventListener("focus",b,false);c.addEventListener("blur",f,false);A.addEventListener("keydown",s,false)}}(o.$beforeDestroy=(o.$beforeDestroy||{}))["ifmClearMem"]=function(){var I=this.$win,H=this.$doc,J=this.$ifr,F=this._event,E=this._event2;if(xui.browser.opr){if(C.$repeatT){C.$repeatT.abort()}}if(J.detachEvent){J.detachEvent("onload",x)}else{J.onload=null}try{I.removeEventListener("unload",I._gekfix,false)}catch(G){}I._gekfix=undefined;delete frames[this.$frameId];if(!this.properties.disabled&&!this.properties.readonly&&H.removeEventListener){H.removeEventListener("mousedown",F,false);H.removeEventListener("dblclick",F,false);H.removeEventListener("click",F,false);H.removeEventListener("contextmenu",a,false);H.removeEventListener("keyup",F,false);H.removeEventListener("mouseover",F,false);H.removeEventListener("mouseout",F,false);H.removeEventListener("mousemove",E,false);if(xui.browser.gek||!I.removeEventListener){H.removeEventListener("focus",b,false);H.removeEventListener("blur",f,false);H.removeEventListener("keypress",F,false)}else{I.removeEventListener("focus",b,false);I.removeEventListener("blur",f,false);H.removeEventListener("keydown",F,false)}}C=l=F=E=I=H=null}}o.boxing()._setCtrlValue(o.properties.$UIvalue||"");g.style.visibility="";g.style.overflow="auto";if(o.onReady){o.boxing().onReady(o)}}})};o.$frameId=q;g.id=g.name=q;g.className=n.className;g.src="about:blank";g.frameBorder=0;g.border=0;g.scrolling="yes";g.marginWidth=0;g.marginHeight=0;g.tabIndex=-1;g.allowTransparency="allowtransparency";g.style.visibility="hidden";xui.$cache.domPurgeData[g.$xid=n.$xid].element=g;n.parentNode.replaceChild(g,n);if(g.attachEvent){g.attachEvent("onload",x)}else{g.onload=x}}}else{o.boxing()._setCtrlValue(o.properties.value||"")}},_checkc:function(c){if(c&&c.$doc){var d=c.$doc,a=d&&(d.body||d.documentElement);if(!c.__oldv){c.__oldv=a.innerHTML}if(a.innerHTML!=c.__oldv){var b=c.__oldv;c.__oldv=a.innerHTML;c.boxing().onChange(c,b,a.innerHTML)}}},_onchange:function(a){if(a.onChange){if(a._onchangethread){clearInterval(a._onchangethread);a._onchangethread=null}a._onchangethread=setInterval(function(){if(a&&a.box){a.box._checkc(a)}},500)}},_clearPool:function(a){a.getSubNode("POOL").empty();a.$colorPicker=a.$fontsizeList=a.$fontnameList=a.$formatblockList=a.$htmlEditor=null},_iniToolBar:function(b,f){var q=b,l=q.properties,g=(l.cmdFilter||"").split(/[\s,;]+/),r;if(q.$toolbar){q.$toolbar.boxing().destroy(true);delete q._$tb;delete q.$toolbar}if(f!==false){var n,m,a,e=[],j=q.getClass("TOOLBARBTN"),d=l.cmdList.split(/[\s,;]+/),c={};xui.arr.each(d,function(o){if((a=q.box.$cmds[o])&&!c[o]){c[o]=1;xui.filter(a,function(s){if(xui.arr.indexOf(g,s.id)!==-1){return false}if(s.imagePos){s.imageClass=j}s.tips=xui.wrapRes("editor."+s.id)});e.push({id:o,sub:a})}});n=new xui.UI.ToolBar({selectable:false,handler:false,items:e,disabled:l.disabled||l.readonly});n.setCustomStyle("ITEMS","border:none");q.getSubNode("BOX").prepend(n);n.render(true);b.$_tbH=r=n.getRoot().offsetHeight();if(xui.browser.ie){n.getSubNode("BOX").query("*").attr("unselectable","on")}n=q._$tb=n.get(0);n.onClick=q.box._toolbarclick;m=q._$composed={};m[n.$xid]=n;q.$toolbar=n;n.$hostage=q}b.adjustSize(true);return r},_toolbarclick:function(b,F,m,D,j){var d=b.$hostage;if(!d.$doc){return}var n=d.properties,g;d.$win.focus();if(F.command=="custom"){var C=F.id,w,c,A,u,E;switch(C){case"forecolor":case"bgcolor":if(!d.$colorPicker){g=true;d.$colorPicker=(new xui.UI.ColorPicker({selectable:false,barDisplay:false})).render(true)}w=d.$colorPicker;break;case"fontsize":case"fontname":case"formatblock":if(d.$lang!=xui.getLang()){d.box._clearPool(d)}d.$lang=xui.getLang();if(C=="fontsize"){if(!d.$fontsizeList){u=xui.getRes("editor.fontsizeList");u=u.split(";");E=[];var r;xui.arr.each(u,function(e){e=e.split(",");r=e[0]=="..."?"1":e[0];E.push({id:e[0],caption:'<font size="'+e[0]+'" '+xui.$IEUNSELECTABLE()+">"+e[1]+"</font>"})});g=true;d.$fontsizeList=(new xui.UI.List({selectable:false,height:"auto",items:E,width:150})).render(true)}w=d.$fontsizeList}else{if(C=="fontname"){if(!d.$fontnameList){u=xui.getRes("editor.fontnameList");u=u.split(";");E=[];var r;xui.arr.each(u,function(e){r=e=="..."?"":e;E.push({id:e,caption:'<span style="font-family:'+e+'" '+xui.$IEUNSELECTABLE()+">"+e+"</span>"})});g=true;d.$fontnameList=(new xui.UI.List({selectable:false,height:"auto",items:E})).render(true)}w=d.$fontnameList}else{if(C=="formatblock"){if(!d.$formatblockList){u=xui.getRes("editor.formatblockList");u=u.split(";");E=[];var r;xui.arr.each(u,function(e){e=e.split(",");r=e[0]=="..."?"span":e[0];E.push({id:e[0],caption:"<"+r+' style="display:inline;padding:0;margin:0" '+xui.$IEUNSELECTABLE()+">"+e[1]+"</"+r+">"})});g=true;d.$formatblockList=(new xui.UI.List({selectable:false,height:"auto",items:E})).render(true)}w=d.$formatblockList}}}break;case"html":if(!d.$htmlEditor){g=true;d.$htmlEditor=new xui.UI.Input({multiLines:true,width:400,height:300,resizer:true})}w=d.$htmlEditor;break}if(w){var f=b.key+":"+d.$xid;c=function(){w.beforeUIValueSet(null);d.getSubNode("POOL").append(w.getRoot());A.setBlurTrigger(f);xui.Event.keyboardHook("esc",0,0,0,f);xui.asyRun(function(){if(!d||!d.$win){return}d.$win.focus()})};w.setValue("",true,"clear");A=w.reBoxing();if(d.$htmlEditor==w){var B=d.getRoot(),l=d.getSubNode("EDITOR");w.setLeft(l.left()).setTop(l.top()).setWidth(l.offsetWidth()).setHeight(l.offsetHeight());w.setZIndex(10);d.getSubNode("BOX").append(A)}else{A.popToTop(j)}if(g&&xui.browser.ie){w.getSubNode("BOX").query("*").attr("unselectable","on")}xui.tryF(w.activate,[],w);A.setBlurTrigger(f,function(){if(w==d.$htmlEditor){var e=w._getCtrlValue()}w.setUIValue(e,null,true,"blur");c()});xui.Event.keyboardHook("esc",0,0,0,function(){c()},f,null,null,b.domId)}switch(C){case"forecolor":case"bgcolor":w.beforeUIValueSet(function(I,J,e){c();var H=d.$doc;if(C=="bgcolor"&&xui.browser.gek){H.execCommand("useCSS",0,false);H.execCommand("hilitecolor",false,"#"+e);H.execCommand("useCSS",0,true)}else{if(C=="bgcolor"){C=xui.browser.opr?"hilitecolor":"backcolor"}H.execCommand(C,false,xui.browser.kde?("#"+e):e)}H=null;return false});break;case"fontsize":case"fontname":case"formatblock":w.beforeUIValueSet(function(K,M,H){c();if(xui.browser.ie&&(H=="..."||C=="formatblock")){var I=d.$doc.selection,e=I?I.createRange():null;if(e&&e.parentElement().ownerDocument!=d.$doc){e=I=null}}var J=function(O,o){var Q=d.$doc;if(e){d.$win.focus();if(O=="formatblock"&&o){var P=e.parentElement(),N;if(P.ownerDocument==Q){if(/^\s*</.test(e.htmlText)){e.collapse(true);P=e.parentElement();if(P.tagName=="BODY"){N=P.innerHTML;P.innerHTML="<"+o+">"+N+"</"+o+">"}else{N=P.outerHTML;N=N.replace(/\<[\w]+/,"<"+o).replace(/[\w]+\>$/,o+">");P.outerHTML=N}}else{e.pasteHTML("<"+o+">"+e.htmlText+"</"+o+">")}}P=null}e.select();I=e=null}Q.execCommand(O,false,o);Q=null};if(H=="..."){var L=xui.getRes("editor."+C);xui.UI.Dialog.prompt(L,L,"",function(o){if(o){J(C,o)}},function(){if(xui.browser.ie){if(e){d.$win.focus();e.select()}I=e=null}})}else{J(C,H)}});break;case"insertimage":case"createlink":var x=xui.getRes("editor."+C),a=xui.getRes("editor."+C+"2");if(xui.browser.ie){var G=d.$doc.selection,s=G?G.createRange():null;if(s&&s.parentElement().ownerDocument!=d.$doc){s=G=null}}xui.UI.Dialog.prompt(x,a,"http://",function(e){if(xui.browser.ie){if(s){d.$win.focus();s.select()}G=s=null}if(e){var o=d.$doc;o.execCommand(C,false,xui.adjustRes(e,0,1));o=null}},function(){if(xui.browser.ie){if(s){d.$win.focus();s.select()}G=s=null}});break;case"html":var q=d.boxing().getUIValue();if(xui.Coder){q=xui.Coder.formatText(q,"html")}w.setValue(q,true,"editor");w.beforeUIValueSet(function(H,I,e){c();d.boxing().setUIValue(e,null,null,"html")});break}}else{d.$doc.execCommand(F.command,false,F.commandArgs||null);if(F.id=="removeformat"){xui.UI.RichEditor._updateToolbar(d.$domId,true,"none")}d.$win.focus()}},_ensureValue:function(a,b){var c=xui.$getGhostDiv();c.innerHTML=(xui.isSet(b)?b:"")+"";b=c.innerHTML;c.innerHTML="";return b},_onresize:function(c,q,n){if(q||n){if(!n){n=c.properties.height}var b=c.properties,r=c.getRoot(),l=c.getSubNode("BOX"),f=c.getSubNode("LABEL"),j=xui.$us(c),u=function(A,B){return c.$forceu(A,j>0?"em":"px",B)},s=c.getEmSize()/r._getEmSize(),e=f._getEmSize(s),o=b.labelPos,g=(o=="none"||!o)?0:c.$px(b.labelSize,e)||0,w=(o=="none"||!o)?0:c.$px(b.labelGap)||0,m,a,x,d;if(q&&q!="auto"){q=c.$px(q)}if(n&&n!="auto"){n=c.$px(n)}l.cssRegion({left:u(m=o=="left"?g:0),top:u(a=o=="top"?g:0),width:u(x=q===null?null:Math.max(0,(q-((o=="left"||o=="right")?g:0)))),height:u(d=n===null?null:Math.max(0,(n-((o=="top"||o=="bottom")?g:0))))});if(g){f.cssRegion({left:u(q===null?null:Math.max(0,o=="right"?(q-g+w):0),e),top:u(n===null?null:Math.max(0,o=="bottom"?(n-g+w):0),e),width:u(q===null?null:Math.max(0,((o=="left"||o=="right")?(g-w):q)),e),height:u(n===null?null:Math.max(0,((o=="top"||o=="bottom")?(g-w):n)),e)})}xui.asyRun(function(){if(!c.renderId){return}var D=c._$tb,B={},C=0,A;if(D){D.getRoot().width(u(x,D.getRoot()));A=D.getRoot().offsetHeight(true);if(A){c.$_tbH=A}else{A=c.$_tbH}}C=(D?(A-1):0);B.height=d-C-2;if(x){B.width=x-2}if(B.width<0){B.width=0}if(B.height<0){B.height=0}if(x||d){if(c&&c.renderId){B.width=u(B.width);B.height=u(B.height);c.getSubNode("EDITOR").top(u(C)).cssSize(B,true);c.getSubNode("DIRTYMARK").left(0+c.$picku()).top(u(C+1))}}},100)}}}});xui.Class("xui.UI.ColorPicker",["xui.UI","xui.absValue"],{Instance:{activate:function(){this.getSubNode("TOGGLE").focus(true);return this},_setCtrlValue:function(b,a){return this.each(function(j){if(!j.renderId){return}var o=j.box,e=j.properties;if(b&&b.toLowerCase()=="transparent"){b="transparent"}var g=j.$hex=o._to3(b),d=j.$hex.join(""),n=j.$rgb=o.hex2rgb(b),l=j.$hsv=o.rgb2hsv(n),m=function(q,f){j.getSubNode(q).get(0).firstChild.nodeValue=String(f)},c=function(f){return parseInt(f*100,10)};if(b=="transparent"){g=j.$hex=["00","00","00"];n=j.$rgb=[0,0,0];l=j.$hsv=[0,0,0]}m("R",n[0]);m("G",n[1]);m("B",n[2]);m("H",g[0]);m("E",g[1]);m("X",g[2]);if(j.$hexinhsv!=d){m("HH",l[0]);m("S",c(l[1]));m("V",c(l[2]));delete j.$hexinhsv}o._setClrName(j,b=="transparent"?b:d);o._updateDftTip(j);if(e.advance&&j.$hexinadv!=d){o._updateMarks(j,b,true,l[0]);delete j.$hexinadv}if(a!=false){j.getSubNode("CAPTION").html((b=="transparent"?"":"#")+b,false)}})},getColorName:function(){return this.get(0).$clrN||""}},Initialize:function(){var m=this,b=xui.UI.$ID,q=xui.UI.$CLS,r=xui.UI.$tag_special,n=m.KEY,j=m._slist,d=j.length,f,e,g=[],o=xui.$IEUNSELECTABLE(),a='style="visibility:hidden;"',c="xui-node xui-node-span xui-ui-draggable xui-uibase xui-uiborder-flat";m.addTemplateKeys(["DD1","DD2","DD3","R","G","B","TXT","HH","S","V","H","E","X"]);for(f=0;f<d;f++){g.push('<span  id="'+n+"-SC:"+b+":"+j[f]+'" style="background-color:#'+j[f]+'" '+o+' class="xui-node xui-span xuicon xui-uiborder-flat xui-icon-placeholder">'+(xui.__iefix2&&xui.__iefix2["xui-icon-placeholder"]||"")+"</span>");if((f+1)%17==0){g.push("<br />")}}e="<div "+o+'><span class="'+q+'-txt"'+o+'>R: </span><span id="'+n+"-R:"+b+':" class="'+q+"-dd2 "+c+" "+r+"DD2_CC"+r+'" '+o+">R</span><span "+a+'>%</span><span class="'+q+'-txt"'+o+'>G: </span><span id="'+n+"-G:"+b+':" class="'+q+"-dd2 "+c+"  "+r+"DD2_CC"+r+'" '+o+">G</span><span "+a+'>\xB0</span><span class="'+q+'-txt"'+o+'>B: </span><span id="'+n+"-B:"+b+':" class="'+q+"-dd2 "+c+"  "+r+"DD2_CC"+r+'" '+o+">B</span></div><div "+o+'><span class="'+q+'-txt"'+o+'>S: </span><span id="'+n+"-S:"+b+':" class="'+q+"-dd2 "+c+"  "+r+"DD2_CC"+r+'"  '+o+">S</span><span "+o+'>%</span><span class="'+q+'-txt"'+o+'>H: </span><span id="'+n+"-HH:"+b+':" class="'+q+"-dd2 "+c+"  "+r+"DD2_CC"+r+'" '+o+">H</span><span "+o+'>\xB0</span><span class="'+q+'-txt"'+o+'>V: </span><span id="'+n+"-V:"+b+':" class="'+q+"-dd2 "+c+"  "+r+"DD2_CC"+r+'" '+o+">V</span><span "+o+">%</span></div><div "+o+'><span class="'+q+'-txt"'+o+'>HEX: </span><span id="'+n+"-H:"+b+':" class="'+q+"-dd3 "+c+"  "+r+"DD3_CC"+r+'" '+o+'>H</span><span id="'+n+"-E:"+b+':" class="'+q+"-dd3 "+c+"  "+r+"DD3_CC"+r+'" '+o+""+o+'>E</span><span id="'+n+"-X:"+b+':" class="'+q+"-dd3 "+c+"  "+r+"DD1_CC"+r+'" '+o+">X</span></div>";m.setTemplate({style:"{_style};height:auto;width:auto",tagName:"div",BORDER:{tagName:"div",className:"xui-uiborder-outset xui-uiborder-box xui-uiborder-radius-big",BAR:{tagName:"div",className:"{classBar}",BARTDL:{className:"xui-uibar-tdl xui-uibar xui-uiborder-radius-big-tl",BARTDLT:{className:"xui-uibar-tdlt"}},BARTDM:{$order:1,className:"xui-uibar-tdm xui-uibar",BARTDMT:{className:"xui-uibar-tdmt"}},BARTDR:{$order:2,className:"xui-uibar-tdr xui-uibar xui-uiborder-radius-big-tr",BARTDRT:{className:"xui-uibar-tdrt"}},BARCMDL:{$order:3,tagName:"div",className:"xui-uibar-cmdl",SPACE:{className:"xuifont",$fonticon:"xui-icon-placeholder"}},BARCMDR:{$order:4,tagName:"div",className:"xui-uibar-cmdr",CLOSE:{className:"xuifont",$fonticon:"xui-uicmd-close",style:"{closeDisplay}"}},TBARTDB:{$order:5,tagName:"div",className:"xui-uibar-tdb xui-uiborder-inset xui-uiborder-radius"}},MAIN:{$order:2,tagName:"div",className:"xui-uicon-main xui-uibar",MAINI:{tagName:"div",className:"xui-uicon-maini xui-uibar",CON:{$order:1,tagName:"div",className:"xui-uiborder-inset xui-uiborder-radius",SIMPLE:{tagName:"div",TOP:{$order:1,tagName:"div",DATA:{$order:0,tagName:"div",text:e},EXAM:{$order:3,tagName:"div",className:"xui-uiborder-inset xui-uiborder-radius"}},LIST:{$order:2,tagName:"div",text:g.join("")}},ADV:{$order:2,style:"{advDispay}",tagName:"div",ADVWHEEL:{$order:0,tagName:"div"},ADVCLR:{$order:1,tagName:"div"},ADVMARK1:{$order:3,tagName:"div"},ADVMARK2:{$order:4,tagName:"div"}}}}},TAIL:{$order:3,tagName:"div",className:"xui-uicon-main xui-uibar",TAILI:{tagName:"div",className:"xui-uibar xui-uicon-maini",TRANS:{className:"xuicon",$fonticon:"xui-icon-transparent",tabindex:"{tabindex}",title:"{_transparent}"},CAPTION:{text:"{caption}"},SET:{tagName:"button",className:"xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius",tabindex:"{tabindex}",text:"{_set}"},TOGGLE:{$order:2,className:"xuifont",$fonticon:"xui-icon-doubleright",tabindex:"{tabindex}"}}},BBAR:{$order:4,tagName:"div",className:"xui-uibar-bottom-s",BBARTDL:{className:"xui-uibar-tdl xui-uibar xui-uiborder-radius-big-bl"},BBARTDM:{$order:1,className:"xui-uibar-tdm xui-uibar"},BBARTDR:{$order:2,className:"xui-uibar-tdr xui-uibar xui-uiborder-radius-big-br"}}}})},Static:{_radius:84,_square:100,_bigRadius:97,DataModel:{height:{ini:"auto",readonly:true},width:{ini:"auto",readonly:true},value:{ini:"FFFFFF",format:"color"},barDisplay:{ini:true,action:function(a){if(a){this.getSubNode("BAR").replaceClass("xui-uibar-top-s","xui-uibar-top")}else{this.getSubNode("BAR").replaceClass("xui-uibar-top","xui-uibar-top-s")}}},closeBtn:{ini:true,action:function(a){this.getSubNode("CLOSE").css("display",a?"":"none")}},advance:{ini:false,action:function(a){var b=this,c=b.getSubNode("TOGGLE");b.getSubNode("ADV").css("display",a?"":"none");b.getSubNode("CON").css("padding-right",a?"205px":"0px");if(xui.__iefix2){c.html(xui.__iefix2[a?"xui-icon-doubleleft":"xui-icon-doubleright"])}else{if(a){c.removeClass("xui-icon-doubleright").addClass("xui-icon-doubleleft")}else{c.removeClass("xui-icon-doubleleft").addClass("xui-icon-doubleright")}}if(a){b.box._updateMarks(b,b.properties.$UIvalue,true,b.$hsv[0])}}}},Appearances:{KEY:{},"TBART, BBART":{"border-spacing":0,"border-collapse":"separate"},MAINI:{padding:".5em .3333em .3333em 0"},CON:{padding:".25em",position:"relative"},".xui-uibar-top BARCMDL":{padding:".25em 0 0 0"},".xui-uibar-top BARCMDR":{top:".3334em",right:".5em"},CMDL:{padding:".25em 0 .25em 0"},DATA:{},"DATA span":{padding:"0 1px","margin-left":"-1px","margin-right":"1px",width:"2em"},"DATA div":{padding:".5em 0"},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle","font-size":"1em"},EXAM:{padding:".125em",position:"absolute",width:"5.5em",height:"5.5em",top:".25em",right:".25em","white-space":"normal","text-align":"center"},"DD1, DD2, DD3":{"padding-right":"2px",cursor:"e-resize","text-align":"center"},TOP:{position:"relative"},LIST:{position:"relative",overflow:"hidden",padding:".25em","white-space":"nowrap","line-height":"1em"},TAILI:{position:"relative",padding:".5em 0 0 0","text-align":"center"},SIMPLE:{position:"relative"},ADV:{position:"absolute",right:"4px",bottom:"4px",width:"195px",height:"195px"},"ADV div":{cursor:"crosshair",position:"absolute"},ADVCLR:{background:xui.browser.ie6?null:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGUAAABlCAYAAABUfC3PAAAABGdBTUEAANbY1E9YMgAAABh0RVh0U29mdHdhcmUAUGFpbnQuTkVUIHYzLjIyt5EXfQAATvhJREFUeF7t3AeUl+Wd8P3ZfXaTbHo1xsQSY2JMjLFHjS32rih2EVEUFEQFkSoCAgKiSG/Se++9997bAMPMML333v7v55qd8UyIKVvenOe85zXnuwzGxPX34Xdd9/0H8i8TJkyInH/++VH+iIT88cXX4Yu6P1f77zX4a77064Z/rf+emi/562vq/gbhm9p/v+77f/b1l/w19f+5L/vP/9mfa/jf2+Drs/+a8P9/7Z+r++OLv//Z//n6v+Csv75+Vl/2nz/736ufYfj7NZznf/7D/+efrJ97+PdvjVq7dm3tgFStSpWrTKUqVqHylatsZSpdKUpWguJ1WqcUrWM6rAPap93aoa3apA0Kf+OVWq7FWqh5mqUZmqKJGqcxGqmhGqRP1V991Us91E2d1UHv6h29qTfUQs3VTE30nJ5WYzXSI3pQ9+lu3aHbdLNu0vW6VlfpCl2uy3SpLtHFulDn6zydq3P0Q31f39W39E19XV/TV/Xv+jf9q/4liPTt2/fT/6+hdPEP1xClje+3qqmpaaHmaqYX9byeVmM10iN6UPfpbt2h23SzbtIfdK2u0hW6XJdVV1dfqkt0sS7U+TpPP6mqqjpHP9T39d3KyspvV1RUfLO8vPzrZWVlXystLf1qcXHxV/Ly8v4tMSHxX7dv2/4v/x717/+JsmbNmoj/khqFPypVrjKVqliFyleuspWpdKUoWQmK12mdUrSO6bAOaJ92a4e2apM2aK1WabmWaKHmabZ/iBmaqkkarzEaqWEarIH6WH3VWz30gbqoo9obQlu1USu11Kt6WS8azvN6Rk/qcT1qWA/pft1jaHfqdt2qPxrgDbpO15SUlFxpmL/Tb4uKin6tXxUWFv6ioKDg5/n5+Rca8s9yc3PPy87O/nFmZuaPMtIzfpiWmvb9pMSk78THxX/r1MlT3zhy+MjX9+3d9x9bNm/56vx58/+9z4d9/k/jRo3/Fcq/fvTRR/+J4h+iRtWqVLnKVKpiFSpfucpWptKVomQlKF6ndUrROqYjOqh9BrFHO7VNm7VR67RKK7REizRfszVTUzVJ4/W5RmmYBhviQH2sfuqtnuquruqk9wy3rd5Sa7U03Ff1sprqBQN+Vk/pCT1m2A/rAd1r4HfpT7rV0G829Bt0vcFfY/BX6grDv9zwL8vJyfkVgEsAXJyRkXFhelr6+ampqT9NSko6NyEh4RwQPzodc/oHx48d/+6hg4e+vXvX7m9u2rjpG6tXrv6P+XPnf23E0BFfaf1663+77ebb/g+U/wNlYNTq1asj/kFrVK3wR7nKVKpiFSpfucpWpn/odKUoWQmKV6xidELHdUQHtV97tFPbDGizNmqdVmmFlmqR5muOoc3UNE3WBI3VaMMbriH6TAPU3xD76EN11/vqZJgd1E5vG+qbel2v6RXDfUlN9JwhP63GhtxIjxr0gwZ9v+4x7DsM+/asrKxbsjIzbzL0P6Snp19r6Fcb+u9TUlIuT05K/o2j59Iz8Wd+afi/MPyfnzxx8oIT0SfOP3rk6HkHDxw810acs3PHzh9t3LDx+ytXrPzuwvkLvz1tyrRvjh0z9hsDBwz8+rvvvPu1h+9/+Cu/+dVv/h3Kv/Xp02dg1KpVqyIGUaNqVSr8UaZSFatQ+co1mGxlKkOpSlGizihWMTqh4zqigwa3X3u0U9u0RRu1TqsNcaWWarEWaI5mGeg0TdEEjdVoQx2hoRqkT/Sx4X6kXuqhbobcWR0N+V29ozaG3UotDftVNTPwpnre0J8x9Cf1uKE/5kf6Q+npGfenpaXd68i5y/D/ZPi3Gv4fHT83+pF/PYBr4mLjroo9HXtFzKmYywFcZgsudSRdAuFiCBft2rnrgq1btv7URpy3bu26c2Gcs2Degh/OmDbj++M+H/fdQQMHfbtvn77f6tyh8zdfavLS12+58ZavXfSzi74K5Su9e/f+LGrlypURw6lRtSpVrjKFP4pVqHyDylWOspShVKUoUWcUqxid0HFDPKJDOqC92qXt2qJNBrpeq7VSS7XYUBdormZpuqYY8ESN0xiNMOShGqxP9bFh91Vvw+6pbupi4B3V3tDb6i1Db63XDf5VvWz4TfWCH/nPAnjK8BunpqQ2AvBISnLKg46e+2zA3QlnEu6AcBuEm23BTRD+YBOuiz4effWxo8euBPE7EL/dv2//rx1Lv9qxfccl7omfb1i/4cJVK1f9bOmSpT9duGDhT2bPnP3jKZOm/GjMqDE/+OzTz77fq0ev73bp2OU7jq1vNX6s8TeuvfLar//0xz/9DyhfgzKoFsUQa1StSpWrTKUqVqEKDDJPOcpShlKVokSdUaxidMKAj+uoDumA9mqXtmuLYW/Seq3RSi3TYkNfqLmaremaYvATNc7gx2ikhhn8YH2qAYbfV731IYAP1BVAJ7UH0E5vAWit1yG8BuEVvQSiCYTnIDxtExrbhEYgHgHxEIj7HUf3wLgTxu0u51tsxE0wboBxHYxr3A9XHdh/4Iq9e/ZebjMu27Z126WbN23+pc24GMhFSxYvOd8l/rNZM2adN3ni5HM/H/35OUMGDflhvz79ftC1U9fvtXu73XdfffnVbz/8wMPf/P1vf/+Nn/zwJ1+H8h+9evUaFLVixYqIQdWoWpUqV5lKVazwR4Gh5SlHWcpQqlKUqDOKNcQYnVS0juqQDmivwe7SDm3VZm3QGkNepWVaooUGPU+zNUNTDXuSxutzAx+l4Rpi6AP1iaH3Ux/1MvjuBv++Oht8B71r+G/bgjcBvJGcnNwCQHMAzQC8COB5AM/qKQhPOJIeg/CwjXjARtwL4S5H0x3uh9sOHzp8s624yVb8Yc/uPdeCuNpj7O9txu/cF7+FcRmMX9mOS2zHxbbjwqmTp54/fuz4n40cPvK8Af0H/NhT1jnvd37/h++0eecHLV9t+b3nnn7uu3fdfte3L/vlZd8853vnfAPKN6AMjlq+fHnE0GpUrUqVq8zASlWiIhUoTznKUoZSDTFFiUpQnE7rpGFG66gO66D2Gepu7dBWbTbYDVqr1Ya7XEu1yHDna45mGvI0TdYEgx6r0QY9QkMN+zN9auAfG/hHfsT3NvAe6mboXQ29o9obfFtDf8vQW/uR/7rBv2bwrxj8SzagieE/bwueNvwnbUEjW/AogIcA3A/gXptwl6PpTy7rW23DzRBudFf8Yf269detXrX66hXLV/zeVvzOnfGbubPnXubeuNRR9UubcfGIYSMuclxd0O+jfufDOM92nPtGizd+/HLTl3/07FPP/tCW/OCm62/63sUXXPydH3z7B9+G8q0Pe344JGrZsmURg6xRtSpVrjKVGmaJilSgPOUoSxkGm6YUJSlBcTptyCcVrWM6rIOGvU+7tUPbDHyLNmqtga/WCi0z9EWab+hzNUvTDX6KJhr+OMMfY/gjNczwByUlJQ8EMMDw+6oPgJ76AML7EDpBeA9COwhvQ3gTwhsQWkBobguagXgRxAsgngHxFIgnHEmPuawftg0P2Ib73BN3u7TvcDTd7q64Ze2atTfBuAHG9bbi2kULFl01b86838+cPvNym/Ebm/FrIL8aNmTYJQM/GXixC/2inh/0vKB92/Y/a9Wy1XnNXmx27jNPPvPjJx594px777z3R+6TH1z40wu/971vfv+7UL7Ts2fPoVFLly6NGGaNqlWpcpUZZqhERSpQnnJkrlkZSlOqkpSgOEM+rVM6oWMGfVgHtV97DHyntmmLgW/UOq0x9BVapsVaYPjzDH6WZmgqgEkaD2CM4Y/ScMMfrM8ADADQTx9B+BBCdwjvQ+isDiDeBfEOiDYQWkFo6Th6FcTL7oWXQDQB8RyIp0E0thWNbMWjjqaHYNxvK+61FXfC+BOM22DcvHTx0ptg/MF7xnVzZs25xnZc5d64wpPV5Y6qy9wdl37y8Se/BHIJkItd6he91fqt890hP3NknffoQ4+e6zH43DtuveOcKy+/8kfnn3v+D777je9+H8r3evToMawWxUBrVK1KlYcMtUwlKlKB8pSjLAPOVJpSlaQEg45XrE7phI4Z+BEd0n7D3qOd2q6tBr9J6wx9jVY675cb/BItNPx5mm34MzTV8CdpPIDPNQrAcABD9BmETyD0V18IvSD0gNANQhfb0BFEexBtQbwFojWI10G8BqI5iGaOpxdBPG8rnrEVTzminnBEPQbjYZvxoLviPhh3w7jDZty+eOHiWx1Vf3RU3Wg7rrcd104cP/Fq23ElkCsGfzb4t0Au692z96VAfulSv8SWXPz6a69f2PSFpuc/2ejJnz1wzwPnuUt+4lH43Mt/ffk5Pz3npz/6zte/80MoP+jRvcfwqCVLlkQMtUbVqlSFgZarTCUqUoHyDDdH2cpU+CNVSYacoHjFOmZOGfYJHdcRAz9k4Pu118B3abu2GvomrTf0tVpl6Mu1xNAXar7mGP5Mg5+myYY/QWMNf7Thj9RQAIMADATwMYB+6g3hQwjdIXR1JHWG0AFCOwjvuCPagGhlI1pCeNVGvAziJRBNQDwH4mkQT4J4fM3qNY96v3ho+bLlD7gz7rUZd9uMO2zGbTBugfHHSRMm3egl8PpRI0ZdO3Tw0KvcH1f279v/d70/7H25O+Syju07Xuoe+dWbb7x5iXvkYsfWRY8++OgFQH528w03//T6q68/zyX/E09eP/72f3z7HCg/6t69+4ioxYsXRwy2RtWqVIXhlqtMJSpSgWHnGXKuspWpNANPVfhXouINO1YxOmngx3VUhw39gPZql8Hv0DZD36wNBr9Wq7TC8Jca/CItMPy5mmX40zUFwEQA4zQGwkgAwwAMAfAZgAHqbxM+gtBLPSB0g9AFQkfb0B5EWxBvgWjtaHodxGsgmrsrmnl6etER9YIj6llb8ZStaLxs6bLHlixa8giMh2DcD+MeGHd5G78Dxm2Oqlu8d9zkMr/BdlxvO65xXF31YY8Pr+z+fvcrOrzb4beesi5zj1zq2PrV8888f8njjz5+sS256LY/3nbBH675w/lX/e6qn/3y57/86Y+//+OffOtr3zoXyo8/+OCDkVGLFi2KGGiNqlWpCkMtV5lKVKQC5RtwrrKVqXSlGnSyEhVv2LGK0UkdN/SjOmzgB7RPuw1+p7YZ/GZt0DrDX62Vhr/M8BdrgeHP1WwAMwBM1SQI4yGM1SgAwzXUNgyC8Ilt+BhEXxC9QPSE8IFjqSuIziDesxHtQLzjnmgDohWIlrbiVVvxiq14yeNskxXLVjwH4xkYT/o45HEYjzmmHobx4PSp0+9zb9wzYdyEOx1Vf7Idt9mOm23HTR53b/io90fX9+ze8xobclWn9zpdCeR3Xg5/C+Q3Lz7/4q+feuKpXz3y4COX3P2nuy/+4x/++PNrfn/NRY6uC35x4S/O9zj8UyjnQTmvW7duo6I8U0cMt0bVqjTcCpWrTCUqUqEh5ytX2co07HSlKVmJBn5G4V8xhn5S0QZ+VId10ND3abfB79R2g9+ijVpv+GsMf6WWG/4SLQQwz/Dn2ICZmgZgMoAJGgthDIQREIZBGAxhoG0YAKIfiD4QPoTQ3Ua8D6KLjegIoj2ItiDeAtEaxOu2ooUjqrkjqpn7oqn74gUYz8J42mY09uL3OIxHYTwE4wFH1X2jR46+e/jQ4Xfajts9Xd3muLrZcXVTjw963ADkehtyDZCrbcjvX3vltSt8jHK5x9/fPPbwY7+2JZf+6ZY//dKW/MIFf/Glv7j0op+f//OLfvidH17wza9+83woP3v//fdHRy1YsCBiyDWqVqUBV6hcZSpRkQoNO1+5ylaWoacrTcmGnqQzijP40zqlaMM/piM6aPj7DX+Pdmk7gK3aBGA9gDVaBWG5lkBYBGG+5kCYCWE6hCkQJmociDEgRoIYDmIwiM9sxCcw+oP4CEQvG9EDRjf3RFcYnRxP78FoB+NtW9EGRqvlS5e3hPHa4kWLX/GD8yUX+Is243kYz3iiesq98YSjqpHH3Edsx0O2436Puvf67Ooux9UdQG7v06vPrT269bjZhX6jO+QGd8h17pBrgFzlHrnyhWdfuOLJx5+8/MF7H/zNPXfc8+tbb7r1Uo/Bv7ziN1dc4ui62OPwz72jXPSNr3zjQigXvN/1/TFRPgqIGGyNqlVlsBUqV5lKVKxCQ85XrnKUZdDpSlOKgSfpjOIN/LROGfgJHdMRgz+k/Qa/V7sMfoe2Gv4mg9+gtVoNYAWApQAWawGAuQBmAZihqRAmQRgP4XMIoyCMsBFDQQwCMRDCxzaiH4g+NuJDEN3dE++D6AyiI4j2tqItiLccUW8uWrjoDZvR0nvGqzbjZRgv2YwmMJ6D8QyMJ23HEzAesx2PeNR9yHbc/3G/j+9xf9ztM6w7Puj6we1Abn2v3Xs3t32r7U1AbvC2fr0NucY9cvXTjZ++qtHDjX4P5PLbb779t14WL3OX/Pq3l/72UkfXL8/70XmXfP9b378Yys+h/Lxrl66fR82bOy9iyDWqNuAqVahcZSox6GIVKl+5Bp6jLGUYeLpSlGToCYo39NOKMfQTOq6jhn9IBwx+r3Yb/k7D36bNhr/R8NdpDYCVhr9MSwAsBDAPwGwAMzUNwmQIEyGMswljIIyEMAzCYNvwGYhPbEN/EH0dTb1A9ATxAYiu7opOnqI6OKLeBfGOI6qNrWjt45A33BmvwWjuTbwZjKYwmtiMZx1VT8N4Esbj7o7H3B0Pezt/0HF1v8fde4Hc7ZPeOzzy3u7IutUdcrM75KZXXnrlRiDX25BrGz3S6BrvJFd7J/k9kN954rrclvzm15f8+rKf/+znv/bk9avvffN7v/z6v3/9Eii/6NK5y9iouXPmRgy4RtWqMuAKlatMJSo27ELlK085hp6lDKUbeoqSDD1B8Yo1+Bid1HEARw3/sA4A2KfdAHZqG4QtADZqPYQ1EFZBWK6lEBZBmA9hDoRZmg5iiibBGA/jcxCjQIwAMUSDbMSnMD6G0c8TVB8YH9qK7rbifRhdYHSE0R5GOxhvw3gTRiub0RLGa943XvFU9ZKnqhe9czzvqHrW3fH0pwM+bQzkcdvxaK+evR52fzzYrUu3+4HcY0PuAnKHDbndhtzqyLq5yXNNbvL4e4OnreuBXHf/3fdf64nrqhuuveH3LvgrXPC/c59c7uj6zbk/OPcyL46XQvkVlF917tx5XNTs2bMjBl2jakOuUoXKVaZSAy9WofINPE85yjLwDKUr1eCTlWDwZxSrGMM/qWjDP2b4h3XQ8PdpD4BdALZrC4BNADZoLYTVEFYAWOo4WgxggeZCmA1hho2YCmIyiAmOprE2YgyIkSCGgRgMYiCIAbaiv634CERvj7Q93RUfOKK6wugMowOMd2G0hfGWS/xNl/gbMFrAeNVR9bLteMl2NLEdz7s7nnV3PPVRrz6NPe428rj7qOPqYU9YD9qQ+99+8+17gdzdonmLO2zI7Z60bnOx3/LEY0/80TvJjUD+4L3kei+K11531XVX+0T4Sj+h9ftLLrrkigt+csHvPA7/FspvoFwG5dedOnUaHzVr1qyIIdeo2oCrVKFylanUsItVqALDzlOOsg08Q+lKNfhkJRr8GcUZ/GmdNPxoHTP8IzoIYL/h79UuAOFfWyFshrABwjqthrASwjIIiyEshDAPwhwIM23DNBBTQEwEMQ7E5yBGgRgOYiiIQS7tT0EMsBX9bEUfGB+6L7q7L7q5vLt4z+jkmHrPZrSD8Q6MNjBaw3jDO0cLj7nNXeQv246m7o4mtuN5x9UzjqunHFeNfWTSyIX+qJ8xfBjIg46s+4HcC+RuIHcC+ZNj67ZHHnjkFpf7ze6Sm9wlNzi6rr/6iquvsyXX2JKr3SdX+Xjl9568rvA2/zsol0P5bceOHSdGzZw5M2LINapWlSFXqFxlKjXsYhWpwMDzlKtsQ89UhqGnKlmJBn9GcYZ/WqcM/4SOG/4RHQKwH8Be7QawE8A2AFu0EcJ6CGsgrNJyEEtALAIxH8RcELMgTHdHTNUkEONBjHU8jXY8jbAVw0AMthWfwfjEVvS3FX1tRW9b0RNGdxjvw+gMoyOM9jDawXgbRhtHVStH1esu8ha2o7m7o5knq6aOqyaerp5zXD3juHrKI29jT1iNgDwG5GEgDwK5H8i9Pte62y+AuNM9cgeQ23zgeOudt915iy35o7vkRo/Bf/AGf52nrms9Cl/r45WrPXld6W3+9//xb/9xBZQrOnboOClqxvQZEQOvUbVhV6lC5SFDL1Wxigy9QHmGnqtsZRp8hlINPkVJBp+geMOP1SnDP6HjAI4COKwDAPYB2KOdELYD2ApgE4ANWgthNYQVEJbahsUgFkCYZyNmg5gJYpqNmAxiIohxtuJzEKNADAcxxFYMshUDbcUAGP0cUX0cUb1g9IDxgaeprjA6w+gAoz2MtjDedlS9CaOV7WhpO16zHa94GWzmuGrquGriuHrO/fGMJ6ynfLjY2HvI40Aec4c87DOth4Dc7wXxPiD3uEfuuu+u++4Acrstuc2W3Oox+I8u+JtsyQ1A/uCnf6+Hcp0nr2u8OF4N5SooV3Z4r8PkqOnTpkcMu0bVBl2lCpWHDLxUxSoy9ALlK9fgs5Vp8BlKM/gUJRl+guINP1YxAE4qGsBRAId1EMI+CHsA7AKwXVshbIKwAcI6CKu1EsRyEEtALLIN830yOxfELBDTQUwFMQnEBMfTWBCjbcVIWzEMxmBb8RmMT2B87PLu62mqt834EEZ3GN1gdIHRyb3xnqPqXUdVWxf5W7bjTdvRyna0tB2vOa5eAdLMcdXU/dHEhf5cm1ZtnvFzIk8BaQzkcRvyGJBHgDzkYn/AsXWfl8R7HVt3A7nTZ1x/csHf7i651dF1y68u/tUfgdx4wXkX3OjJ6wZPXtdDuQ7KtVCuea/9e1Oipk6dGjHoGlUbdJUqVB4y8FKVqMjQC5Rv6LnKUabBZyjN4FOUZPiJijf8OMOP0UkA0ToG4QiAg9oPYS+EXRB2aBuEzRA2QlgPYY1tWAViuY1YCmIxiAUg5oGYrRkwptmKySAm2opxMMbAGAVjuCNqqK0YBGMgjAE2oz+Mj2D0htETRncY78Po4qjqCOM9F3k72/GO7Xjrw+4ftu7erfsb3s5buD9eBfKK+6MZkKYu9BeAPOfF8BlH1lM2pLFH38e9izwG5BEfyT8M5AFbcr8393u9KN5z43U33uWCv/N3l/3udkfXbS74Wy8878Kb3Sc3Q7nJJX8DlBug/AHK9e3fbT81asqUKRHDrlG1qgy7oq5yAy9ViYoMvUD5yjX4HGUZfqbSDD9VyYafqDMA4nQawCkAJ3QMwlEAh3QAwj4IuyHs1HYQW0BsArEexFqX9WoQK0Asc08sBrHQRswHMcdWzAIxHcQUEJMcUeNtxVgYY2CMdEQNgzEExmfeNT6F8TGMfp6o+rjEe8HoAeMDR1VXR1Vn29HRdrS3He086r5jO9oAae24esNx1cL98ar74xUgzYA0BfICkOeAPOtt/Wkgjd0jTzz20GONHFuPukce9vnWQ0Du9xnXfT5SudcFf7ctudPR9ScX/O1AbvPSeKvH4Vug/NFHLDd97f987UYoN77b7t3pUZMnT44Yeo2qDbxKFSFDL1epSgy+SIUGn6885Rh+ljINP12pAJKVCOCM4iCcBnAKwAkdh3AUwGEAB7Qfwh4IuxxL223DVhCbIWzQOhBrbMNKEMtBLAWxyFYsgDEXxmwQM2zFVBiTHVETbcU4GJ87okbBGGEzhsEY7F1jIIxPYPSH0de90dtR9SGMHrajmw8Ru9qOzu6ODo6r9i7zdo6rt4G0cVy1AvIGkBZAXvXzIa8AaebIagqkCZDnvYs8C+Rpn2s9CeQJj7+NgDxqSx5xbD3k2HrAltzvgr/XY/A9tuQu98mdP/vxz/5kS273OHw7lFuh3ALlZih/bNeu3YyoSRMnRQy8RtWGXaWKkIGXq9TAS1SkQkPPV56h5yhLmYafbvhpSjb8JCUAiAcQqxgAJwFE6xiEwzbhIIT9NmEvgN0AdmqbbdgCYhOE9VoLYhWIFRCW2YjFIBaCmAdiDohZIKaDmGorJoGYYCvGeQMfA2KkzRjumBrimBoEY6DNGGAz+juqPrIZvWF8CKO7945uMLrC6ASjg6er9p6u2jmu3nFctXGht/aE9YaXwpbe1F8F8oo7pJkjqymQF4G8YEOedY88A+Qp90hjII/bkkaOrUeBPGxLHnLBP+gN/n5bcq/75B4X/F225E6fDt/pcfhPUG6HchuUW9u2bTszKvxWCIOuCRlylSpVoXIDL1OJgRerUAWGnqdcg89WpsGnK83wU5Rk+AmGH6/YpYuXxAA4ZQuiIRyDcATAIR2AsA/CbtuwE8J2CFshbLYNG0CsA7EGxEoIy7UExCLH0wIY80DMthUzQEyzFVNsxUQY423FWFsxGsZIGMNgDIExyGZ8ajMGwOgH4yMYvR1VPT1ZdXdUdYPRxd3R2XHVwXa0B9LOdrztuGoDpHXzZs3f8HPrLYG8BqS5I+tlIC950noRyAvukeeAPOtp62kgT9qSxh6BH/f2/pgL/lFH1yMu+IdsyQNeGO+Hcp8tucc7yj1Q7vKOcieUO6Dc0fadtrOjxo8fHzH4GgMPValSFQZfrjKDL1GxCg2/QHmGn6tsAFnKAJDmGEqxBckQEiGcgRAH4TSAUzoB4TiEoxAO6yCIfSD2gNgFYgeIbSC2gNhoI9aDWOueWA1iBYhltmIxjIW2Yj6MObZiJowZMKbCmGQzJsIYB+Nzx9RoGCNsxjCbMdgl/pl74xMfIH7sJbCf7ehjO3rZjp6Oqu62433HVRePu51sRwcg7YG09YT1tg15C0hrIG8AaQnkNSDNgbwMpJn3kaYu9iZAnve09SyQZ2zJU0Aa++DxCRd8I0fXY46uR2zJw+6TB90nD9iS+72j3Ocd5V6X/N1Q7oZy1ztvvzMnatzYcRGDrgkZdJUqVaFyAy9TiaEXq9DgC5Rv+LmGn23wWcow/HSlGn6y4SfqjOIgnAYQA+AkgGgdhXAYwiEI+yHshbAbwk4I2yFssRGbQGwAsQ7EGhArQSwHsdRWLAKxAMQ8ELNBzLQZ071nTIExyWZMgDEWxhgYo2AMhzEUxiD3xkAYn7jIP4bRz3b0sR29bEdP29HddnTzuNvFcdXJ/dHB/dHehd4OyDs+y3rLY++bQFoBed2nvi2AvPrQfQ+9AqSZe+Qlx9aLtuQFIM/bkmeBPG1LnvJp8JMu+Cf8MqJGPut6zJY84uh6+Eff/dFD3lEegvIAlPuh3Aflvrffentu1NjPP48YfE3I4KtUafAVBl+uMsMv9SO/2PCLVKB8ALkAspVl+JlKB5AKIFmJEBIUDyEWQgyEkxCidQzEERCHQBwAsQ/EHhA7QewAsRXEZhAbHU/rYawFscpWrICxzF2xGMZCGPNtxRwYs23FDJf3VBhTHFMT+3/UbzyMsTBGO6pGesQdDmOIo2qQo2qgx9wBtqM/jL7ujj62o5fLvIft6O6F8H3HVRcgnYB08PF7eyDtgLwD5C0gb9qQVj7Teh1IC/fIa0Ca+wT4ZSAvedpq6mmriRfFF1zuzzm2nrElTzu6nnJ0NfZu8oQtaeToegzKo1AegfIwkAe/+q9ffRDKA2+1eWt+1JjRYyIGX2PYoSpVGnqFyg29TKUqNvgiFRh+vsHnKUfZhp9p+OlKBZACIEkJAOIBxOk0hFMQTkA4DuEohMMQDkLYD2EvhF3aCWKbjdgCYhOIDSDW2Yo1IFaCWG4rloJYbCsW2Ip5MObAmAVjus2Y6s6YBGMCjPE243NH1WgYI2AMsx1DbMcg2zHQUTXAdvS3HX0dV31sRy/HVU/HVXfHVTcXeldPWJ08YXUA0h5IOyDvAHkbSBsgrYG84R5pCeQ1x9arjq1XPG297HJ/yeX+osu9iS153pY85+h61tH1tKPrSU9djR1dT7hPHvfk1cg7ymNQHoXyCJSH27zZZkHU6FGjI4ZdEzLwKlUadkVdZb4tNfgSQy9SofINP085hp9t+JnKMPw0pQBIApCoMxDiIJyGcEonQUSDOAbiCIRDEPbbhn0gdoPYCWG7toLYbCs2glgPYq2tWAVjha1YBmMJiEWOqPku77kwZsOYCWO6d40pNmOSzZgAY5x7YwyMUTBGwBhmO4bYjkEwPoUxwHb0tx19HVd9bEcvF3pPx1V3IN2AdPXhYmdv6h194vsekHeBtAXyNpA2QN50j7QC8jqQlo6t1xxbzd0lrzi2mgFp6mXxRVvSxFPXC14Yn/Mo/AyUp23JU1CedMk3hvIElMehNILSqE3rNgujRo0cFTH0mpCBV6nSwCvqKjP4UpUYfJEKDb5AeYafo2zDzzL8DKUBSFUygCQAZwDEKxZCDISTEKIhHINwBMIh23BA+yHsgbDLRuwAsQ3EFhCbQGywFetArLEVq0AstxVLYSx2RC2EMd9WzPU0NctmzIAxzZ0xBcYkGONhjIUxBsYoGCMcVcMcVUPcHYNgfApjgO3obzv6Oq4+clz1cqH3dKF398jbDUhXIF3cIR3dIR2AtAfSDsg7QN4C0saHja19tvWGY+t1IC0cW6/akuaOrZdtSTNb8tLF51/c1FNXE0fX8+6T54E865J/FsrTUJ6C8iSUJ6E0frP1m4ujRgwfETH0mpChV6nS0CvqKvNtqeGXGH6RCg2/QPmGn6scAFnKgJAOIFXJEJIgJECIVyyI0yBOgTgB4bhtOAriMIiDIPaD2AtiN4idILaD2GorNsPYaCvWw1gLYrWtWAljua1YAmORzVgAYx6MOTZjFowZMKa6Nya7NyZ6qhrvqBrrqBpjO0bZjuG2YyiQwe6Oz2zHp7ZjgOOqP5C+7o8+QHoB6QmkO5BuNuR9G9IFSCcgHYC09/Mj7YC0dY+8DaSNY+tNx1Yrx9YbtqSlu6SF95JXfRrc3Ja84uhq5uh6yZa86D5pAuUFKC9Aec47yrNQnoHyDJSnW7dqvSRq+LDhEUOvCRl6lSoNvSJk6OUqVYnBF6vQ8AuUb/i5hp+jLACZhp+uVAApAJKUCOEMhDgIpyHEQDgJIRrCMR2BcEgHIOyDsAfCLhuxA8R2EFtsxWYQG0CssxVrQKwCscIRtQzEYhCLbMYCd8ZcGHNsxkybMR3GNBiTYUyEMR7GWBhjYIyyHSNsxzDbMcR2DHJcDXRcfeK4+tj90c/98ZGfD+nts6wPvRj2sCEfeOx9H0hXIJ1tSEcg7wFp72JvB6StY+ttIG1syZtAWtmSNxxbLW1JCxf8ay745p66XoHysvukGZCmLvmmLvkXoTSB8jyU56E81+qNVsuihg4dGjH0mpChV6kyZPAVKjf8UpUYfrHhF6pA+QByAeQoC0CmMiCkQUiBkKxEEGdAxIOIhRBjG05CiNZxEEdBHNZBEPu1F8RuEDttxXYY22BssRUbYayHsRbGai99K4Esh7HUZiyGsRDGfJsxF8ZsGDMdVdMdVVMdVZMcVRNc5OOAjLUdo23HSNsx3HYMtR2DHVeDgHwK5BMgHwPpZ0M+8tFJbxvyoQ3pCaS7z7S62ZCuHn07+6ndTu6RDu6R9kDe9bTV1iPwO46tt9wlbWxJa1vSypa8YUtaOrpaOLpedXS96j55BcjLLvlmUF6C8hKUF6G8CKXJG6+/sTxqyOAhEQOvCRl2tSoNPFShckMvU4mhF6vI4AuVb/h5yjX8bMPPUgaANACpAJKVBCEBQLwjKQ7CaZ2CcMJGREM4ZiOOgDgE4gCIfRD22IhdIHaC2A5iK4jNnqI2glgPYi2I1TZjpSNqOYylNmMxjIUw5tuMuTBmwZgJY7rtmApjMowJtmO87RhrO8bYjlG2Y4TjahiMIY6rQY6rgZ6wPnn8kcc/tiH9bUhfG9IHSC8b0tOG9ADygQ1534Z0BdLZPdIJSAcg7YG8a0vaudzfcZe8DaQNkDdtSWtHVysor9uSlo6uFlBec3S9CqW5t/lXoLwMpRmUZq+3fH1l1OBBgyOGX2PwoWqDr6yrwvDLVWb4pSoGUKRCAAXKg5ALIVtZEDIgpCsVRAqIJAiJEM4oDkQsiBgQJ0FEgzgO4qiNOAzjIIz9MPaC2O3i3uWu2AFjG4wtMDbB2ABjHYw1MFbBWAFjmUt8ic1YBGMBjHmOqjkwZtmOGR5zpwGZYjsm2Y4JtmOc7RhrO8bYjlFARgAZZjuGABnk/hgI5BMfLg4A0h9IXxvSx4b0AvKhDenhYu/uHukGpKt7pItjq5Njq6M39/dsSXtb8q4taetl8W0ob9mSNp663nR0tYbyBpTX/RxKSygtXPItoLwKpTmU5lBegbIq6rOBn0UMvCZk4NWqNPBQhcoNvkylBl9s8EUqVIHh5ykXQA6ALACZSgeQBiAFQLISISRAiIcQCyEGwimdgHAcwlEbcQTEIRAHQOwDsRfEbvfFThjbQWx1RG2GsdERtR7GWhCrbcYqm7ECxjIYi2EsgrHAZsxzb8yBMct2zLAd02BMsR2TbMcE2zHOZT7W4+4Yx9UoICMcV8OADHVcDQbyGZBPvakPsCEfA+kH5CMgfYD0AtITSA8gH3ja6gakqy3pAqSTLekI5D13SXt3ybseg9vZkrbuk7dd8G85utq4T96E0hpKKyhvQHkdSMsQlBYtW7RcHTXw04ERQ68JGXy1qgy9UhWGXq4ylRp+ieEXqdDwCww/LwQgR9kAMgFkAEhTKoRkCEkAEmzCGQhxOg0iBsRJENGOpmMQjkI4DOEghP02Yh+IPSB2gdgBYhuILbZiM4yNtmI9jLUu8NUwVsFYYSuWtmrZegmMhTAW2Ix5NmMOjFkwZsCYZjum2o7JtmMijPEwxtqOMS700bZjpONquPtjqA8XhwAZBGSgI+sTIAOA9AfSD8hHQHq7R3oB6QmkB5APHFvdgHR1bHUB0tnR1clHKh1syXu2pL2j610obW3JO46ut90nbzm62rhP3oTSGkirEJQ3WrzWYm3UJwM+iRh6Tcjgq1Vl8JWqMPxylakUQImKARQCKFA+hDwAOcqGkAUhQ+kgUkGkQEiCkKgzIOJBxNqIGBtxCsYJGMdhHIVxBMQhHQCxX3th7IaxE8YOW7ENxhZbsUkbYKyDscZmrLIZKx1Ty4EstRmLbcZCIAuAzHNUzQEyC8YM2zHNdkwBMgnIRNsx3naMBfI5kNFARgIZDmQYkCFABgH5DMinQAYA6e9Jqx+QvkD6uEd6e/z9EEgPW9LdsfWBLXkfSFdb0sWWdLYlHW1JB0fXe7bkXVvyri1pB6UtlHegvA3lLSBtQlDebPFqi3VRAz4eEDHsmpCBV6vKwCvrKjf4MpUafInBF6vI4AuVb/h5ygWQAyBLmQDSAaQBSFEyhEQICRDOQIiDcBpCjI04CSHaRhyHcNQ9cRjEIRAHQOwDsQfEbluxE8R2EFtBbHaBb7IZG2CsA7HGZqyCsRLGcpf4UhiLYSyEscBRNQ/GHBizYMxwmU+3HVNtx2QvhBMdVxMcV+McV5+7P8a4P0b5LGsEkOFAhgIZDGQQkIFAPgUyAEh/IP2A9HWP9AHS25Z86BG4py3pcfH5P//AlnSzJe/bkq62pIunrs5QOkLpAOU9R1d7KO2hvOvDyHZA2uodKO+81vy1DVH9+/WPGHpNyOCrVWXwlXVVGH6ZSg2/xPCLVWT4hYafHwKQqxwAWQAyHUkZENIhpEJIgZCkRBBnQMSBiAURA+IUiBMgokEcczQd0WEQB7UfxF5H1B4Yu0DssBXbYWy1FZthbISxwTG1DsYaGKtgrISxHMZSGIthLHRULXCRz4Mxx3bMhjHDdky3HVNtx2TbMcl2TAAy3naMdX+MATIayEggwz32DgMyBMggIJ950hroYv8EyAAg/W1JPyAfObb6AOltS3q53Hvakh5AutuSD2xJN0fX+46uLlA625JOQDq6Tzr69cMdoLwHpH0IyruvNn91Y1S/vv0ihl4TMvhqVRl8ZV0VAMpVBqDE8ItVpEIIBRDylQchB0I2hCxlQEiHkAYhBUKyEkEkgIgHEQfiNIhTNuIkiBO24jiIo7biMIxDMA7Yin0w9sLYDWMnjB0wtsHYAmMTjI2OqfUw1ro3VgNZ5d5Y4ahaBmOp7VhsOxYCWWA75gGZ491jlu2YaTum246pQKYAmQRkApDxPlwc68XwcyCjb77hllFARgAZBmQokMFABrlHBgL5FMgnXhI/dmz1tyX9gHzk2OpjS3rbkl5QetqSHraku6eu7kC62ZL3bUlXIF1CUDpD6QSkYwhKh+avNN8U5X+gJWLoNYYeqlaVoVeGDL5C5SqzAaUqAVDsBa7I8AuUDyAPQK6yIWQByASQrjQIqRCSISRBSIRwBkIchFgIMRBOQTgBIdpGHANxFMRhEAdBHHBE7QOxF8RuR9QuGDtAbLMZW0BsArHRZqy3GWthrIGxCsZKGMthLIWxGMZC27HAdswDMhfIbBgzYcxwXE0DMhXIZNsxEcgE7yHjbMhYIGOAjAYyEshwIMOADHWxDwYyCMhnQAYC+cSWDPAI3N+W9APS113yEZA+tqS3Lenl6PoQSg8o3aF88K2vfVvf6gblfShdgXQJQenc/OXmW6L69O4T8aO9xsBrDLzaj/gqVRp8paFXqNzgy1Rq8CUqNvwiwy8IGX6e4ecqB0BWCEIGhHQIqRBSlAwiEUKC4kHEgTgNIgbESRAnQBwHcQzEEVtxGMRBEAdA7LMVe0DsshU7YWyHsc1WbIGxyTG1EcR6rYOxBsYqGCthLIex1HYsgbEIxgLbMR/IXJf5HBizYMx0XE0HMtV2THF/TAYyEcgET1njgIwFMgbIaCAjbchwIMOBDAUyBMggl/tntmSgLfnUlnxy/k/O/9iW9IfSz5b0Ped7P/4ISh9PXb2h9ILyIZCeISg9oHQH8kEISrdXmr2yLap3r94Rg48Yeo2qVWXwoUrDr1C5ygCUAihRsYogFAIoUD6EPAg5ygaRBSETQrrSbEQKiGQQSSASQJwBEQ8iFsRpEKdAnAQRbSuOwzgK4wiMQ7bioPbD2AtjD4xdNmMnjO0wtmoLjE3ujY0w1sNY66lqDZBVQFb6dVjL3R1L3R2LgSyyHQttx3wgc4HMcVzNAjITyHQg07ypTwEyGchEIBOAjAMyFsgYGzIayiggI9wjw4EMAzLUhgwGMgjIZ7ZkIJBP3SWfAPnYlvR3dPV3n/QD8hGQPu6T3kB6A+nlyetDL449v/IvX+kBpLaXm728Pcr/wkHE0COGXqNqA6+qq9LgK1Ru8GUqNfwSFRt+keEXqgBAvvIA5ALIBpClTAgZENIhpEJIgZCsRBAJIM6AiAMRCyIGxCkQJ0BE24pjII6COAziEIgDIPbbjL2OqN0gdjmmdoLYbjO2wdgCYxOMjT4iWW8z1jqq1sBYZTtWwlhhO5bZjiUwFnu6Wmg7FsCY57ia67iabTtmAZnpo5PpQKYCmeIpaxKQiUAmABkHZKwnrc+BjHGxjwIy0oaMgDLcsTXUxylDHFuDoQyyJZ9BGQjkU1vyCZQBUD6G0h9IP09dfaF8BOUjKH2g9AbSK/TySy/viOrZo2fEwCOGXaNqVRl6qNLQK1QeMvjSkOGXGH6xigy/0PDzQwBylQMhG0IWgAylQ0iDkAohGUIShEQlQIiHEAvhNIQYx9NJECdAHAdxDMRREIdtxUEYB0DstxV7YeyBscvT1E4Y22FssxlbYGxyTG2EsR7GOhhrYKy2HatsxwoYy23HUtuxGMYi27HQdswHMs92zHF/zAYyy5v6DCDTPfZOBTIFyGRH1kQgE4CMBzLWlnzuHhkDZDSQUZ62RgAZDmQYkKHukiFABgMZBOQzR9dAKJ9C+QTKACgDoHwMpT+UflD6AqmtWdNmu6LcHRFDjxh4japVZfChSlUYfqgcQJlKAZQYfrGKABSqAEI+gDzlQMiBkAUhUxkg0iCk2YYUEMlKhJEA4oziQMQqBsYpECcVDeI4iGO24giMwzAOwjhgK/bB2AtjD4xdMHbA2O6Y2gpkC4xNjqqNMDbAWAdjre1YDWOV7VgBZDmQpbZjCZBFtmMhkAVA5gGZC2QOkFlAZnrsnQ5kGpCpQKYAmQRkog2ZAGScLRkH5HPH1hjH1mggoxxbI4GMsCXDoQyDMtQFPwTKYI/Cgxxdn0EZCGUgkE/dJ59AGQDlYyC1vdT0pd1RH3T7IGLoEQOvUbWhV9VV6dtKw69QueGXGX6pSgy/WEUACgEUKB9AHoBc5UDIhpAFIEPpENJsRCqEZBuRBCERQoKNiIcQp1hbEQPiFIgTigZxHMRRW3EExmEYB2EcALHPfbEXxm4Yu2zGThjbYWyzHVtgbHZUbYKxwXasB7IWxmrH1SrbsRLICtuxDMhSx9ViIIscVwuAzAcyD8hcGzIbyCwgM4FMBzINyFQgk4FMBjLRPTIBynjH1jhbMhbK57ZkDJDR7pJRQEbakhFQhtuSYbZkKJQhQAaHoAyC8hmUz6AMBPJp6KUXX9ob5XejRgw8VGPg1aoy8PoqDb5C5QZfZvClKgkZfpHhhwoAFBh+vnIB5ADIVhaETAgZENKV9lKTZikgkiEkQUi0EWdAxEOIsxGxIGJAnAJxAkQ0iOMgjtqKIzAOews/6L44YCv2w9gLYw+IXTZjJ4wdNmMbjK0wNtuMTTA22oz1MNbBWANjNYxVMFbAWG47lsFYAmOx+2MRjAU2ZL77Yx6QuS712UBmAZnpyJoBZDqQqUCmXPjTiyYDmQRkIpAJQMbbknFAxtqSz4GMATLaloyCMgrKSFsyAshwR9cwKMOgDIUyBMpgILU1bdJ0X5TfjRqBEDH4GlUbfqgqZPiVqgBQrjIApSEIJQCKVQShEECB8iHkQchVDoRs25CpDBDpINJApIJIAZEMIvH5p59LgHEGRjyMWBinYcTAOAnjBIxoGMdgHIVxBMYhGAdhHICxD8ZeGHtsxi4gO2HssBnbgGy1GZuBbAKy0VG1Hsg6IGuBrIaxynasBLLCE9YyIEuBLAGyyIYsBLIAyHwg84DMATIbyCwgM90jM2zIdCDTHFtToUxxbE2CMtGWTIAy3paMgzIWyFggn2uMLRkNZRSUUUBGagSUEVCGQxkGZGjoxSYvHojq0qlLxMAjhl2j6pChV9VVafAVKjf8spDhl6oEQLHhF6kQQIHyAeQByAWQo2wIWRAyIWQoHUQahBQIyRCSICRCSIAQrzgIsToNIsYRdRLECUdUNIhjII46oo7AOAzjIIwDMPbbjL0w9sDYBWOX7dgBYzuMrTC2wNgMY6O7Y4PtWA9k3fVXXbcGxmobsspxtRLIciDLbMhSIEuALAayEMgCIPOBzAMy14bMATLbPTITyEwg04FMAzLVlkwBMsWWTIYyyZZMhDLBXTLeloyDMhbK51A+BzImBGS0RkEZCaS2F1948WBUp46dIoYeMfAaVYcMvaquSsOvMPhQucoMv9TwS1QcMvwiFaoAQL7yAOQqB0I2hCwImRAylAYiFUQKhGTbkAQhEcIZCPGKc1fEgjhtK2JgnIJxAkQ0iOMgjoI4YisOwzgI4wCI/SD22Yy9MHbD2OWo2gljO4xtMLbaji1ANtmOjTA2wFhvO9YCWQNjte1YBWSl+2MFkGVeDJcCWQJksXtkEZCFQBYAmedJay6QOUBmO7ZmA5kJZAaQ6UCmAZlqS6YCmWJDJkOZBGUSkAlAJji6xgMZFwIyNgTlcyBjQk2eb3I4yu+xixh8xMBrVB0y+KqQoVeqImQDylVm+KUhW1CiYghFAApVACEfQh6EXOVAyIaQpUwQGSDSQaSBSFUKhCQlOp4SbMUZEPEg4kDE2ooYGKdgnIRxAkY0jGMwjsI4YjMOAzkI5ACM/TD2wdhrO3YD2QVjJ4wdMLbZjq1AtgDZDGQTjA22Yz2QdUDW2o41QFYDWQlkBZDlMJbZkKVAlgBZDGSRDVng2FoAZT6QebZkLpDZjq3ZUGYBmQlkhi2ZDmRaCMpUWzIFymQok6FMAjIxBGRC6Cv/8tXxQMaFoByJ8tu5IoYdqjHsUPWLzzetMvBQpaGHKgy9XGUGHyo1/BIVG35RCECh4RcoH0AegFwAOcoGkKVMG5EBId02pEFIhZACIUmJIBJAnAERDyIORCyI0yBiQJwEcQJENIjjII7ZjCMwDsM4BOMgjAM2Yx+MvTD2wNgNYxeMnTC2w9hmO7YC2QJjM4yNtmMjkPUw1jmu1gJZYztWA1kFZKX7YwWQ5UCWAVkKY4kNWQxkEZCFQBYAmQ9kHpC5mgNkti2ZDWQWkJm2ZAaUGVCmA5mmqUBqAzLFxyuTbcokILW98NwLR6P8dq6I4UcMvqauasMPVRl+ZV0VAMoNP1QGoFQlAELFEIpUCKIAQr7yIORCyAmByLYNWSAyHE3pMNJBpIJIAZEMIkmJMBJgnIERDyMORiyM0zBOwTgJ4wSMaBjHYRyDcRTGYRiHYByEcQDGfhj7YOyBsRvGLhg7YeywHduBbAOyBchm27EJyEYgG4CsB7IOyFoga4CsBrIKyEpH1gogy4EsA7IUyBLH1mIoi4AsdGwtADLflswHMk9zgcwBMhtIaBaUmUBmhIBMBxKaBmUqlKlApoSef+7541Hvtn03YuARw66pq9q31YZeFTL0SlWo3ODLDb5MpSHDLzH8YhUZfmEIQIFNyFcehFwAOcqGkAUhE0KG0iGkQUiFkAIhWUkQEiEk6AyIeBBxIGJBnAYRA+LkbTfdegJEtCPqOIxjMI7COALjMIxDMA56qjoAZB+MvdoDYzeMXTB2wthhO7YD2QZkK4wtjqtNQDYB2QhkgyNrPZC1QNbYkDVAVgFZCWQFkBVAlgNZZkuWQlkCZDGQRbZkEZCFtmQBlPlQ5gOZB2Suo2sOkDmeuGaHgMwKQZkJZSaQGaHnn30+OspvUokYeMTAa+qq9m21oVeFDL5SFSHDLzf4spDhl6rE8Itre+ixIhUCKACQH4KQp1wIORCyIWQpE0QGhHTbkAYiVSkgkkEkgUgEkQDiDIh4EHGKtRWnYcTAOAXjJIxoGNEwjsE4CuMIjMMwDtmOgzAOwNivfTD2wtgDYzeMXTB22o4dQLYD2QZkC4zNMDbbkE1ANgJZb0PWA1kHZC2QNUBWA1kFZCWQlUBW2JLlQJYBWRqCsgTIYiCLtBDKQigLgMwPAZkXAjI3BGSOZgOp7blnnjsZ5TepRAw8YuA1dVX7ttrgq0IGX1nbw40qVA6g3BFUZvildZUAKDb8IsMvrKsAQj6APAC5IQg5ELJCEDIhZEBIVxqIVBApIJKVBCMRRAKIMyDiQcSBiAVxGkQMiFM6CeMEiGgQx0Ec01EYRxxVh2EcgnEQxgEY+2Hsg7EXxh4Yu2HsgrHTduwAsh3INiBbgWwBstmFvgnIRiAbgKwHsg7IOiBrgawBshrIKluyCspKICtsyHIgy0JAlgJZAmSJLVkMZFEIyMIQkAUhIPNDQOaFoJyK8vshIoYeMeyauqp9W+1HfajK4CtDBl+h8hCAMsMvDRl+SV3FEIoAFAIoqCsfQh6EXAg5ALJDELKUCSIDQjqENKWCSAGRDCIJRCKIRBBnFA8jDkQsiFhbcRpGDIxTIE5cc8XVJ0BEgzjumDoG4yiMIzAOwzgE46AOwNgPYx+MvTD2wNgNYxeMnTB2wNjuuNoGZCuQrUC2ANkMZBOQjUA2AFkPY10IyFoga4CsBrIqBGQlkJVAVgBZHoKyDMhSd8lSIEtghBaHgCwKAVkYevbpZ2Oi/H6IiKFHDLumrmrfVht8qMrgK0MGX1FXueGHygCUGn5JXcUAigCECiEUKB9CPoA85ULIgZAdgpAFIRNChtJBpIFIBZGiZBBJIJJAJIJI0BkY8TDiYMTCOG0rYmCcgnESxgkY0ToO5BiQoyCO2IzDMA7BOATjoA4A2Q9kH5C9QPYA2Q1kF5CdMHbC2KHtMLZpK5AtQLYA2WxDNgHZCGQDkA1A1juy1gFZG4KyBspqGKtCQFaGoKyAsgLKchihZe6TZUCWhoAsCUGJjXqz1ZsRQ48YeE1d1b6tzeCrQoZfafAVdZX7thxAWQhAqeGXqDgEoQhAYQhCAYB85UEI5YLIgZANISsEIhNChtJBpIFIBZECIRlCUghEohJgnIERDyMORiyM0zBiQJwCEToJ44TtiAZyHMgxIEeBHIFxGMYhGIdgHIRxAMZ+GPtg7LUde4DshrErZEN2AtkBZDuMbSEgW4FsAbL5R9/54WYgm4BshBHaAGQ9kHW2ZB2QtSEga0JAVgNZFQKyMgRlJZAVISDLQ8889UxcVOs3WkcMPWLQNXVV+7Y2Q68KGXylgYcqQgZfrrKQ4ZcafqjE8IvrKgJQCKAAQCgfQB6AUC6AHGVDyIKQBSFTGSDSIaQpFUIqhBQlg0gCkQgiAUQCiDMg4hUHIhbEaRAxIE6BOKkTME7AiIZxHMYxGEdhHIFxBMZhGId0EMgBIPuB7IexD8ZeGHtg7LYdu2Hs0k4gO4DsALLdhmwDshVIaAuQzUA2A9kEZGMIyAYY60O2ZD2UdUDWhoCsCUFZA2R1CMiqEJT4qFavt4oYesSwa+qqNuz6qnxdZfCVIYOvCBl8eV1lhl8aAlASAlCsIgihQggFAEL5EPIg5IYg5CgbRFYIRCaIDAjpENJCIFJBpCgZRhKMRBAJIRhnYMTDiIMRCyJ0GkYMjFMwTsIInQASDeQ4kGNAjsI4AuOIp6vDQA75efWDQA4AOQBkP5B9QPaGgOwBshvILiC7gOwEsiMEZDuQbSEgW0NAtgDZHAKyKQRkI4wN9QFZH4KyDkhtQNaGnn7y6YSo11u8HjHwiGGHakIGXt2gKl9XGXyloYcqQgZfXleZ4ZeGAJQYfqgYQFEIQKEKABQYfr7yAOQCyAWQo+wQhCxlgsiAkHHV5Vemg0gDkQohBUIKhGQlgUgEkQAhdAZEPIg4ELEQTodAxIA4BeIkiNAJGNEwjoM4ZjNCR2EcgXEExmEdAnIQxkEYB2Dsh7EPRmgvkD0wQruB7IKxy4bshLEjBGQ7jNA227E1BCS0BcjmEIxN9cHYGIKxoT4oiVEtX2sZMfCIQYdqQoZd3aAqX1cZemXI4CtCBl8eMviyukoNP1QCoNjwQ0UAQoUqAJEfgpAHIBdAKAdCNoBQFoRMCKGMKy77XTqMNBCpIEIpMJJBJINIUiKMBBgJIM4oHkYcjFgYodMwYmCcCgE5CeQEjGgY0TCO6xiMYzCOwjgCI3QYyCEgB0NADgDZDyO0D8beEJA9MEK7gYR2AdkZArIjBGR7CMi2EJCt9QHZEgKyub6nGj+VFOXXrkYMuzbDrgkZdnWDqnxdZfCVIUMPVRh8qNzgQ2UqDRl+Scjwiw2/KASgMASgAEB+XXkQQrkgciBkhyBkQQhlQsiAkA4hlAYhVSkgQskwkkCEEmEkwDgDIhQPIw5EHIhYnYYR45iKgXEKxEmdgHECRnQIyHEYx2AcDcE4AiN0GMghGIdsx0EYoQNA9sMI7QsB2Qtjj+NqD4zQbhi76gOyMwRkR31AtoeAbKsPSkqUXyYZMezaDLumPgOvrqvKt7UZemXI0CtCBl8eMviyukoNP1QSglCsIgihQgCFAAqUDyAfQF5duRByQiCylQUjC0SmMkBkQEiHkBaCkAohJQQiWUkgEkEkgkgIgTgDIl5xNiMORqxOwzgNIwbEqRCMkzoB5ASM6BCQ4zCOwTgK4yiMIyEYh0NADoVgHNQBIAeA7AdSG5B92gukNhh7QjB21+c+2QWkNiA763vyiSdTo/yKvIhB12bQNQ2qvu6q6+u6rsrwQ5WGX5uhV9RVbvDlhl4WMvjSukp8WwKgOAShSIUQQgUAQvkA8gCEcgGEciBkh0BkKRNEKANGBoh0pYFIBRFKgZECIllJMEKJMBJgJIA4o3gYoTggcTBidRrGaRgxIE6BCJ2EcQJGKBpI6DiQ4zCOhWAc1REYocMwaoNxSAdh1AbjQF37gdQGYl9de2F8EZA99UFJi/Ir8iKGHTHoUE19Bl7doCpfVxl+qDIEoCJk8OUhgw+VGXyoNGT4JXUVAwgVQQgVQigAEMoHEMoDkGv4oRwAoWwAoSwImSEIGUoHkQ4hTakQQikgUkAkKwlEKBFEIogEnYEQigcRF4IRG4JxGkYoBkboFIyTMEInYISiYYSOwzgWsiHHgByFEToSAnI4BORQCEbooA05CORAfVD21wdkX32NH2+cHuUXf0UMuTZDrmmYYVc3qMrXVQZfWZ/BV4QMvjxk6GX1GXxpyPBLQoZfXFcRgFBhCEQBhPwQhLwQhNwQhJwQhGwIWSEImSEIGSEQ6RDSQhBSIaSEICSHbERSCEYiiIQQiDMhGPEhGHEgQrEwTodgxIRgnArBOBkCcSIEI7o+GMdDMI6FYBytD8iREJTDQGqDcahhQA7WByUzyi/+ihhybQZc0zCDrq7PsKsaVOnrUIXB12bw5XWVGX5thl4aMviSkMEX11Vk+KHCEICCEID8EIS8EIRc5UCoDUK2skBkQcgMgcgIgUhXGohQKohQCowUEMkhEEkhEIkhGAkhGGcUD6M2GHEgYiGETtuK2mDEhGCcquskjNpgnAjBiK4PxvH6YByrD8jRhgE5Uh+UrKimLzaNGHxthlzTMMOurs/Aq86q0vcrDb8iZPihcsMPlYUAhEoNPlRi8KFigw8VhQy/sD4ABXXlQwjlQQjlggjlgMjxFJUNIgtCKBNCbRAyQiDSlQYilAoilAIilAwilAQilAiiNhgJMM6EYMSHYITiYIRiYYROg6gvBkboVAjIyRCM0In6gETXB+R4w4Acq++JRk9kR/nVExHDrc1waxpmyDWqrs+gqxpU6evaDL6iPsMvDxl+WX2GXxoy/JL6DL84ZPBFIYMPFRp8qMDwQ/mGH8oLAcitKwdCKBtCKAtCbRAylQGhNgjpSoNQG4TUEIQUCKFkCKGkEIjEEIiE+mCcCcGIDwGJqw9EbH0wTodAnHZcxdQH41R9ME6eHZAT9UHJifIT9RFDr82Aaxpm0DWqrs+wqxpm6JUNqvB1heGHykMAQmUhAKUhAKGSEITiEIRQEYRQIYBQQQhCfghAKA9AKPcnPwz9JAdAKDsEISsEIZQJIZQBIZQegpEWghFKBRFKARFKDsFICoEIJYZgJIRghM6EYITiQzBCcSEocUBi6wNyuj4gpxXTMCCn6gs/jR7lJ+ojBl2bodacneFWN8yAqxpm0JUNqvB1bYZeXp/Bl4UMvvSLfnJBCYDaDL+4PgBFIQCF9UEoCEHIDwEI5YUg5IYg5IQgZIcAZNUHITMEIaM+EOkhCGn1gUitD0RKfTCSQyCS6gORWB+IhBCMBBBnGgYjvmEw4s4OSGx9jz/2eF6UnxOOGPIXGWjN2Rlu9VlVGfIXGXRlgyp8XWHYofKGGXxZXaUG/0WGXxIy+OIGFQEIFRp+fQUAagOQXx+EvBCE3Pog5NSVDaI2CFl1ZYKoLwNEbRDSG5QGojYQqQ1KgVEbiGQQXwQjqUGJMP4sGAlnB+NMw6AURPnpx4iBf5Fh13xJ1Qb95/3kgioD/yLDrqzPwCvOqtz36ysDUBuA0gaVAKgNQnF9AIrqg1BYVwGE+vJB1JcHor5cELWByKkPRnZdWSDqy4TxRSAy6kqH8UUg0kB8EZDU+mCkNAxIcsNgJH1ZQBIb1ujRRgVRfqYrcuF5F9Rm8BGDrvF085ede361oX+RIVerqmEGXdkwA69omIGXN6jM12WGHyoNGX59Jb4uARAqBlBfEYD6Cn1dCCFUYPj15fs6H0J9eRBCubV9/Tu5MHJCIOrLhlBfFojaIGTWByOjPhDpDYOR1jAYaUptGJCULwtIcsOgFEb5SZWIYX+RIdd8WYZdfXYGXq2qhhl0ZcMMu6I+g65QeX0GXq6yBpUCaFiJ75cYfqi4PghF9QEoUmEIRKigPgj59UHIVx6I+nJB1AYgpz4IOcquD0S2suqDkdkwGBkNA5Gh9LMDknZ2MNKU2jAoxVE+v48Y6p9lqDV/pWp/vtqQG1bl+1UG3bBK36807IZV+H6FIddX7utygw6V1WfYZSqtz7BLVVKfgZeouD5DL1ZRyNBDhfUBKFRBfQAKlF8fiHzlhSDUl+vrXAj15fg6B0TDsn0/G0bDsnw/C0bDMn0/E8aXlQHjL/KLWIqjfFQcMdQ/y0Br/laGW312Blx1dgZdeXaGXXF2Bl5+doZe1jBDL22YwZc0zOCLG2bwRQ0z+MKGGXzB2Rl+/tkZft7ZGX7u2Rl+ztnByP5bQck6u8ceeaw0yqeSEQP+iwy45m9l2NVfloFXfUmVhv4XGXrF2Rl8+VmVGf7ZlQL4swCUnFUxhLMrAvFnQSg8OwgFX1I+iL8IRN6XBSP3bwUj58v6T5THn4wY7pdVY7h/M4Ou/htVff+b36sy9LOrNPSzqzD4L6vc8P8iwy87OwClZweg5EsqhvAXQSj6kgpBfFkFIP5a+TD+ZjDy/lpQyqJ8ABYx/C/NwGv+XoZe/dcy/GpVnR2AKlWeHYBKVZwdgAqVnx2EcpU1DEKZSs8ORKlKzg5EiYrPDkaxis4ORpEK/1pACv5eQPL/Wo8+/Gh5lNf6iKH91Qyu5h/NMKv/VoZa9fcy4Mq/lkFX/LUMu/yvZeBlfy1DL/17ASj5W0Eo/kcCUayivxWUiii/XjhikH83w6z5r2Sw1f9Ihlz19zLsyr+XoVf8vQy//O9l+GX/SBBK/yuBKPlHglIZ5bk4Yth/NwOu+e9k4NX/aAZf9Y9k+JX/SAAq/pEglP+jgSj77wSk9B/pP1H84u5vfOWb+sZ/pRrD+59Ubaj/naoM+b9apYH/d6ow/P9J5RD+y/kdDVVRbvuIAf+3Mtia/40MukbV/5MMvup/EoDK/61gVPx3e+ShR6qjrEvEMP7XM6Caf2YGWv3PysCrVfX/RlBqovyfiOH9UzO8iGr+b+7fo75SUzf8APBP6wsUf9PIP6+v/BP/Xv/Mf67/nb9XWJLa3zT0yIOP/P/9XzKD4PH/ABYzZXBSXEBtAAAAAElFTkSuQmCC)",height:"101px",left:"47px",top:"47px",width:"101px"},ADVWHEEL:{background:xui.browser.ie6?null:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMMAAADDCAYAAAA/f6WqAAAAB3RJTUUH1gcOCDIojJpTggAALYlJREFUeNrtnXmYHUW58H9V1WdmMtlDQtijSSDKorLovRAWAwqyiBJugoCK6CfqRdSLityLkIsiF9SIyqIsRhZBlu+TK0JEQBBFUEAEZQ9LgkCABBPIJJnMdFd9f5wzM2d6qrqr+/SZmUy6nqef06e6z9Ld76/epd6qgrKUpSxlKUtZylKWspSlLGVxF1HeguKLAQmTp0JlOuitQU+BaHJ105NBj4JoDEQKolYwoxAmQtKBxKBYi6ITxWokK1GsQPI6ilcQLEWxjBfpFGDKu13CMBwEXsA2bTB+BzA7Qbgz6B0hmgl6GugxEAG6tkX0va/fr70XBhQgqb72bLb3kgjFy0ieQ/EUiscQPErAo/yNlaL6pWUpYWia8Cv4l21BzwYzG6K9IHo7mBarcPcTfG0BwROGNED67xsUy5E8gOSPBNyD5mH+VGqREoaGhX+/KSD3h+j9EL231uILt+AnaYACYcgCiKADxZ+R3IHgNlp4jFvpKuEoYUgBYL8A2mYB80AfDGZXiCp+gu8CwXY8AYaigHABInkJyW+R3Mga7uBu1pZglDDUAJinIJoOZh5ER0L0LjDSLsjaQ9BThN5VlwZDEUD0hwIkK1DcguQ61vN7cTPrShg2Sef3Q+Nh1GGgPwF6X9CV/K2/zghCThgaAUWmOuXLEPwcxZW8wBJxN2EJw4g3g6btCOLTEM0DPdXd6usMTnAW08hxrB4Gl3AH/YR3YF3Pq+08l3YIYucJulH8HskiWrlJXERHCcOIguC4NmjbB6KTQB8EumWgIOuMwp0Vjoww2IAIKN6UkgM0RP37JUguJeBKfshrI923ECMbghPaITgMzMmg31ONBLkEX3uaP41C4DgnDkMQa8HjMKiCwZBOvwIUKxFcTsAFLOQfI7UfQ4xMCL48GsLDgK+A3qNP2NNMH90kCNLMJgcMPj6ELxg2gQ88YOj/ugrJIgQX0MYL4syRBYUYWRCc1AptBwFngN7dHQnKA4GPo5xUlwJLEgxZBD5wCH1WcylZW6xCcAkB3xdn8koJw7CCYIGEaCcwZ4I+HLRyh0V9Wn2dQ6C1p4lUAAxJgGQxpdIiTK7XvnOXYvgGa7heLGTtxi5HcuMH4VtTQJ4N8o8gjwChqozXb5KBdSQcc21g/245NO2K628Iy99JuwwRuwyfWyh4CwGL2IxbzDnsba5HlTAMkUlk+NZc0PeA+BrIsenSkf50/QBwSdww1Pu+ly499utva/9z9kNwGy/wPfNttihhGDQIEIZzt4dtLgd5PcgdskGQZ8Mi/Hm+owmCPRSbDRbJKARfoMI95gfMNwtoK2Form/QBucdD8EfQH4EpHILv3S85tEOvsJdMBhZv6Z5gu7WEvE2SDEDyTVswU/NhWxbwtAUEH6wDUy+FOSlIKfadLW/VpANCn+jrX9B5lWjFl6WWyQTXgfWKeAjVLjL/ITDzAKCEoZCIJinDD/+AAR3gvgoSJluFskM2sH2HUU1szmBSPu478/JDIKfdgvTbqe0tkkzENzAWznHXMTEEoaGQLi4HQ78Ksj/C2p71x3P1pTZzofGfQhvqTZAN9AJrK1tbwJravvrgK5azNX9dUWYSdIRQUozh4SHU913bhuSLzOGX5irmDXc4w3DFISfbgFiIURHV9MojKW/QJPcsZanL8GzX8C5hRFE6yFcD3otRMsgeh7ClyH8J4SrIHoD9Bro6qyez3qgQkArCoVkDAHjUYwnYBIBUwiYRsAMFJuhaEPRTkCFAJHYv5Clv6K+r0KSrWNOpuz3ZMbC51DcJuZbYC9hsIFwza6gL4NoN7fw+/QupwHQQCdZddMQroNoNURPQPgg6Ceg+3nQS+GZ5YJiH7qZzngqbIdkOhVmongHinejmErAWAIquTvusiT3JeUyJQPSAfw3a7hQHE9nCYM7WiRh54MgvAz0VunCn0cz5Emr6N0MhJ0QrYDoftB3QfgIrH9M8MjqIbtv+xHQxUwUO6PYE8X+KKahGEeAStQasgEgkjTDQK1QX6cRXIThdHEEq0sYBoDwYAWWfRKib4MZlw5AxEDTqdG0bBcA0TqIXoDoFtC/gbV/EdyzatiamPsRUOHtVJhNhblI3oViEgHKy4RKy4LtEe7AA4Iks0lwM4bPig/yUglDLwg3tYM+tbZV0k2jpHyjJCiSxigPgKATwuerAES3QHS/4OaNblikAcFcZqI4AMlcAnZHMYGgFgBNM5V8/Qfbe5noP/TUP4Tgo+JAntjkYTDcNQY6zgZ9YnXscSMQZMlGtYKgQa+E6G4Ir4aOOwU3rWGEFAOSY9iJVo5EMg/FTBQtmf0IHxCUFwg9GmIJAUeJ9/LXTRYGw+3jofs8MJ/oP/CmZzMeplIaCF7aIaqZQdfChqsEVz3BCC/mWMYxhkNRnIDi3QS0o2qRKVfqt8wAhy8Q9ZEmwTHsx31DNaJODB0It04C9SPQ8/3MoiwOs7dmiEA/B9Fl0HWV4JLlbGLFzKOFrZiD4osE7ItktNOx9knz9neibdtyJB9nL347FECIoQHh9vGgLqmCYAoEwXuEmga9DKJFsP4ywUWvsIkXcwIVJvF+JCfXIlLtmUFQHjCkA/EaAUeKPbhnxMNg+NM46Dof9Mft5lBen8ErgmQgehX05dB5keB7/6As/Z/PSbQynkNp4atIdkfV9Vv4hliTzKN0cwkEL6GYL3bj3hELg+E3o2H098CcMBAA4wGAacA8CteCvhHEtwVn/L0U+5Rn9TXGM4GPIjkZyVt7e7obgcEHhD4gliGZK97JQyMOhmo/QvhNMKf0OcvGA4asKRgDHGZd7RXWC6Dzl4Izw1LUMzy3bzMDxQICjkTRnjjnUp6+BjsIPftP08LBYhbPjRgYqj3LH/wcmO+DDuwANAKDE4Q3wFwF684RfP2lUrRzPr+LqbCBuSjOQPE2VK2PwqdHOq926APiHhRzxQ6s2OhhqE7l+JcPgrgazJhk08jk1AoDHGYN0eNVLfT6bwRnlusVFPEsz2crWvgGAcegGOXVz5A9olSVStUPiJ8zhk+LLZs76cAgwPD4bhAthmiqn5/gA0RSx1vYCdENoE8TnFg6yM3QEq18FMkCJNv19k34RpOy+A19GsIgOJdlnC7mNG8OWNFcEJ6dCht+DXpXf7PIBwhnROk10N+AsZcK5neVotvEZ3s576CFHxKwNxLlBUNWEPqbSxsQfIptuUaI5vRBiOaB8GA7jF0E+qg+4faFISsQkQH9GIRfEHzirlJUBwmIq5lMC2ehOA5FW2KOUh4QBg4tXYnkELEVDzTjemRzQDASJn4J5Dz7lamMdyHxPA3yTlAfLkEY3CKOZSUv80UkZyB5I5ew26fHt4OkmIzgJ+bV5kxH06Rhny8cAPK06nhlm1clPO6KV1MSgrwO5NGCo58txXMIgPgiG/grCxGchOTV1MemUh6zcoLQE87dBcV3jaFl2JtJhqVbgrwLzCy3aZSlw81pGnXXcopOEczvKMVyGJhNt3EIkh+j2DZRoPOYSf3NpYiAzzCORUXmMMliQTAVqJwLalZygFmQX59KQG4AdR50fbkEYRhpiQNZjORjSJ5FYgqNLPUXJYXgf1jDTsPYTHrtGFBHu+cOSRsB4nVX1oH4FnScLpi/vhTBYQbE/tyN4WgUj6NiQLh6q33Npv7t6RQCLjCG0cPOTDL8cxroe6tjl02CWZQUUTIpppHeANHZIM4WzCnTKoazyXQ/uyK4DslMJKKBHuiBnXD9X79Che8VEW4VxYBgAlh9OZhj7RAYTxCiBP8h6gJzLrx8Vk8fgjGm7FkeIgXgPCBE7zHzAO8h4OcopjtGuKXHVUTKvmAVitlCND5stCAY3vww6BuAYKDwpznNPs6zCUFfDOu+IpjTO72IMaZrOFz/EP32UH7eCwYA8zD7U+FqJFvk6ltwOdK1VyPACBZLmCsEG4ZUGAxvbAbqPjDb24U/i3awwRLpaup15/GCvfuNRzbGrB3EaxcFnCMG+f8U9d+8/3scBgDzGEehuATFuLpVRf1iKo75XI3oe9WgNRzfKrhyyGAwGAFd3wR9mlsT2LSEC4q4mRSZ6voL+kjBbgOyFo0xqxoQNNEEYRVDCEqzrj9TnRUGEDzDSQjO7ddT7asZ7NogLllLu+A940T+7NYGYejcEeR91XmOkkwjHy1h1Q7PAIcKdnza+vvGrMhwTWIQIRGD9Ps+5zb7+0TMTJL2Z0XAUhYScGJvLpMtUzVhlu8ebaCFs4n9zhj4Wl5nWuQHwQTA9aCPSIYgyTxKNJlWgT5G8LZbnf/BmJcyPsyGH3ZOYRMb0ffn+S6RBgOAWck4urgBwfv7RZg8zCPTZxINkKq6/Y4QZk8S/G1QYejGHCzhJoEJql+SVytY07i7QP8nzDgvqYfRGLM06cEU8XBzfGeW80WD/6VZv5P7s0kwAJgXmEkri1Fs7wVB7dvi2iDBAP/VJDhCiOxz3IqcWqHSBXdK2Lsn3bz6ZYb8TrSp9xOuh67jBDskRgeMMUsyCE8RIOQVHFHQ8WYJtiiqLg0GAPMah1LhWiRjXH5CzEFOBaFOokIFcyaJ7LNr5IKhE3OogZskyP5T9Zve1+waofczS2D9+wQzXki9qcY8nvGBNyqAIid8RQleoYLr8epzLDsMBsEazkVwci21YgAIBn8QLFAsngqHZ9UOIo9WWAt3ippWsK9lUa8pMmmItaCPFWzxS6//YswjOYRBDJJgFfm5Is91fdanEUl69YYBwKxiAi3cgmLPHv/B5SBnAaFWFxrYf2vBH7LIdua1tt6EA4G96gEwdSBU90Vd0pOqQVF/po69CqqhYnE5XPirTK5L9pasaIHJKrB5fyuPgMbPNY738f363zEpdfWf92+FJ7LarOVkJL9GMdFYTKKsENTVBxr+0xj+KAS6KZrBYNQquF3AHJ8lhWXMfErWCtHTEOwnGOM9u50x5r6M2iDPa14zwxe0PN8lMv5n399Nq3Mdr3egMy2MbgxnaTjVgGoEBEtdGMLsGYL7m6IZVsBeAvZ1aYX6OtnvmKgBIeu0RD+tsAHU1wXtWad57M7Q0mcRwqyCluXz3oLlccz3901KnU+jaSz31hQQmfyuhkM07OobezR+YATAfxjDMb79Dt4wLMBIAyebatcIWACoh8JlOonavug7y4BcDC035orwNi6kaQLrC1bS7+eBQWT8ftt7E9tPOm6DxniYTA0VIVjdaTjDwPUaRukcELhMJgMffgpmAU8WaiYtx+xk4CEBLVmWDXavvdnrZP8T5P4C8UhmZ96YW5uh6nEvKisyAiRShDftu/N+n0i5bt/PCs//Vu9Aq+zPEdUB1xo4Uldbx8TwqQcEvceBC94mOKlQzRDCcS4Q4k2MTNAUfa8CAVohFuUBIaYZsgp9ViH0FTAfOLK+9xXGrIIsPZzjNIe5kKxfIYjWGM6MYH8NkzxCp17mUm37yNOG03YQvFkIDC9h2rvhWN81to0HJLXXVzfADxq4j905W/9mtqJ5W9ws/62+Tub8j9oRZRIpPoMrgtQQGGMFj64wXGPgRBPTDnm0Qt02eT0cAVyR9h+8YsKdVQdnqyyrISettRlVNY0O4ZLRiBcbhCFtCxPeh3Vbt2PftnUn1MUuc0Bd5FnnM0OCsfVaWupMhjrXhuUVhzOdq2j4voaVPstP+ixNWXdxn1xg0mU9lWaDEc/AzQIOyboAfXK4lZcE7DYW8Vrem2eM+VmDtrpPnSiotZc5fzvtPJnhs83aeq8tj8/QzwoxLNTwHz3awaYRyKYZalY+79xN8HhDZtKTsKWAA7LecekwnUxfJ+MVExsAoVa6ChTWLALo+9n649rzvKy32uQUXhP7vUb6pgrzH9bDjyvwSQMTsoRUiYFC/+OBgY8AZzRkJkUwV0OrzzKBOkF9xepWGbikgHvXnWNLM3fClM/4mlKhxUxy1UU5N98pyxOTwVLMpbgJFD9WqKk0U7Akgv8XgklamNhncYLYNv96g8qtGQxGPArzohzOsnBrBiPguimIZQXAEGYMS+Zp/X1b86Tv0I46mxbQHorWdcttXUDxvlBivyFjTrUcaMoPiDzFHehCx5ILuEDDRzSMzuEwD6C49vkdtoJdgQdzwfAIvEXAnjQgMZantl7CTwu6b90Z4+CNCr/M4A+k1aWZTtKjnZEOgdcOv0J71NmAMI4IeVNMpbfAI0/CHzUcaHJA4NgEcFRuGCI4TEDFN/aX9LTqDNS/bE1h63R1eQiqLxTS47hO+WzSucIhpGk2vchwjsvfMAxMLtYJmiEOhImBEBd+U6R2EALzqOEKA3M0VBqBIGbXfcgYTnGlZyTAYISBg4yj6ZUWMGwSEXtaoYFFAqEL1AxZW+8iIi8yQ4svE0wXFxw6BRjpMImwdO2kQU0KEMLiI8TrmjHlzk0hvGxgWh4AtCUWbGDGHbA98HQmGB6EURHs49IEJqWu3siseyKvATcWeMO6M9jwPnUyIxB4tPARfhkrLnPIODSCsfgCBnvOpIx1ssXNJCyaAIcTLYrWBLays6DjL4ZrIjiVujBr1s6Q2DGp4f2ZYeiCvYBxcS3gep8ERt3+r3dAvFHgPQubHGOXnsddLbm27MuYA+0j+PH38dBo/HbLmBYwlscU1xRxhU6d7yoHwzyymOk3aviSgVG+ppAjtFoPyYHAhZlgiOB9OLSASdEIWJ4w0CXgfwu+X12DJPhJpk7asA6RAIF2QCUTQLAlBUsGZs9Lh2kUb8fiZpELgDgEJmYuFQ7GUnhoK3gW2NnDH3Bpg/j+fosNrYdYZt8LXP5CBPvkyTwz7qZ6JVD0yjrdBdr5WTSCfbRr8nHtcaxeqHVCJ5kruiMtoU8bFDJmHtnqfGWsaZphviD6g+EXGnbq6ZHGw0ewmUx1x8dreBfwZy8YfgPtGnbzScK33X2Hl7p4d8TaYQCDSGjls9S5nF9bK+8KXwrHvq7TDjZzxWYyxf2GtDoXEMbS2rvqbB1yhZYQfmXgq9TGOvjAQLp22NsbBgF7aGhzAeBrMtVHkTTc0YTGo5viHN1GWn7XexcIwmLX21p9bdEA2qEdbEJvYvuqTm6wdNTVD04nBqgLCNFkLfFwBK8Ab9X+plCaQz0bWBj/IVc6xt6+XeEJ3d/1+QbrgN81CQafbFVbmoUt/SIpJSNL+kVaykZStmpIcpqGLRlYk57x6lp02zXs2KfjtynaoL7MEYQh3OFzM9Lq627WXrYs1sChmt5ta/mT6lL8i0dnI14dIs2Q1fzx0R6S9AF9OsEk0rFzjeO4TQu4Wn1jCY/aepJtDaC0aAzfKGbTp/XX8DsDx9fGNXs50ZCYXLX5DJgGPJ8CgxEadrGZRXFV4vIbLHD8sUn3qSgYpKf5IzPAIRMAS1q+Ly26Y1KO9dQpiwAnJWbGv98XjKZrhxDuN9XIYeDjJJMCRrWTm11SYVgMY7urOUkDhD5tigTHFBKhhD81EYYsznCaRiAmnHgKc2Spiwusy4GWFqfZJuz1Ah73H+LPXaaYwRY3sZ+fEAfL1gs9KCAAHA7P/gKWAzOSWn0PjVD/fhfgpkQYumFHXXcT07SCSIFBQOf6hOSogmDI6+SKlNbbt+X3eXUtyJTU0tvMJOlwklXsNa01t2mGJCjSvqdpUAiBud5wXxyGJMHXjj9WV79zqs/QBbu4Jh8yDhhSzKkXDod/DLKZJGksWlSE8MsEPyIu7PHlOXQCLEmmT1aNYNMOtkiWtsDBYJpLEdwr4JiehjpN8E1CzLd2MekwGNhe4zcHYhIMddri73X9JUMBQ5L5k0X4XX6AzZySHr6By0ewQSBJnxVFZdQEceWuU4AwGeSt8GLgqbAaYWvJoQUG/LkQZi4wyDPrpp8MLM7KdNdIDiyhA+k4Vvu8MSSPOx0EMylJ+NPMpEY1RBoItgVeXVDUH7OdB96ZzE67P2lGwqwTBBStGZ6Oqs/bG4YUWtu2hq2AF50waJhuPIWfBGh07zX4zWaWs3Q5hNRX+Mkh8FkiQ2mtv80kskWNkjrS6h+FItuQTNss0EkAJGmKppaPwUs/gVVQXQTdVz3phJsgYXoiDBFMT1oYIGl+QYs5FZpY+KoJmsFX+H3Mn0Yd4qSl+RTJS3271rGJawRXNoJ0+JQueUlacUg6zCWRYno1rwhMZFgCbJOh9U/09HUVht9bYfgpZoKGcSIh3ECC1rDMQBUKeKGJtygkexKdzOEwZzWFbFBoS51J0BhJGkHG4LBFler3SXhUrnTzeJdRnghV0Z1vzxmYYzyFPUkl1gh/i9OB7obNlaNHsSeYnhGGtR9vTs9zWj9DHi2RxfxpxDeIw5CkGWy+gcrQ+vtGkbAIvw8Ag6ohwioM/Xq9jR0aLxvRwBQnDBo2czUhUcpdtMFgmhdSTfIZfNIlmgmDzFCXpBHix5VFOxiHlqjvc3A5uq7Hlzbm2qSEe5vZ8r0o+oIJia2+cUel6vc3S4Jhiklu6Z130mZKGXi9yTB0F+An5DGRfPyEtDqfTVn6FOJ1PmaRSdEMPhDYhH9Qi4FV2gMGl3awhNDcmiGEKfEBtFlAIBaSYOhgyGMa5QmRpqxl3/BmUuqUBYI0c8k42jkXCPFxGTLFRGvmw14t6uTcpAh82p/SSTAIGOPzJcLjeA2mfzbfjMzkM8iMmsKnTnn6DMpyXFmO+8IQd55VgqaoN5mIWb1xS9g2e0fS4J9BC7GGsEp6wpCmHWplTJJmaBd+Qu7llQ0CDF0ZQqZJHWl5o0eupDtf/yAeMq2HQqXAYNMIqgEHuh4KYemDiHcADnrnWxesrtRk3PeHUhr3dicMUW0xEtedynqlBlYPIzMpr/BnjRjZWvk0bRDV7RuH8yxjEOAAIwkSm0kU1WkL11iMLDO0NLO8GTb4OzEbstUJgwEV75ExBf3wRghDI0BozwhRvIdZxLSFzVwyjqhSHJKefeVW3APg0HVQRHV19Vt8xr1B8xnWgWmluNFEJnZv4tGksUX2kWhYOwxgaDSvKClalOQfiDqhttW5IDEOAJKiS1giTGmCqiymURIIrmGgg1baYW036AK/MtFnKKwIiv3X1t8Q1WkqjTHC0cq6Jgo3jtbYNnAm3hoL0meOiMcZXIm9NoESObp00pa50ikhU+FpGhEDgsEGImrid8d9ho4Cv1tSS6rayMugjPMti5eZNNrkG6vhKmuSzKRQDAXuZSmLR+kEERT0XcISfY3D0FWUM1w7f0L5CMtSYBnXXR3Mn1lVO2zPDUkwrDN+Qp56Tm2bVD6/shQYLZkga2aSaACCumPrUn2GRoCIeYQlDGUprIQwUYIUHoIO9lXfY7La4YQhhBW+wWPjAYOwZMGWpSwNRDImRHUwJAFhG3IQ1xgGVjhhMLAi/gU6Iwyx8aglDGUprGiYSCyaJNyC7mM2rUjyGV7Pkh/uMcRu2/IRlqWo0gXbKA8YpKf/EB9iIGM+w2tR3fq78Vlssy5MHMLoT2Gmlo+xLAVphukhiLwLZlvqVjhh+AFitYY3fRahTlsgvbYFErYrH2NZCnKgp4f5hH7Ae1PdX5qoUSJ4rj4RxWf6b9vc6rX9IIS3lo+xLAV4z6Jngrs0INJAqJua/jmnz0DfCbu6/ACT7DDH/QcFvK18kmVptHwAtg5hou/M8Lb38c465QNDmmOcYWo/AexYPsqyNFoE7BBCRVqE3DXLQdLMkEDnLHg5EYYIluTQAE5IDOwCRjRxvtWybBJWErM0BMYTBkHyFKkCnqmfZ9XlM/zdZmuZDL5DbNvusDLEWpbGI0l7hSDzLGOlLT5DCI/Gf8M28fDjom4kU5oWSBsIq6EtgD1o7sx6ZRnhznMEe9q0QNos8HFtIfrkcgAMAzTD1bBGw1JfLZAUau2JKEXwr+UTLUvesi/MDGHLyDOSpD00h4G/p2oGEEZj/m5is3H7agTHvIezy0dalrwlgncLaPFYO3CABnDUmdACg3T8+AO2tVKT1lpN6X/Yef+yJ7os+WF4r65aGF5ZETZZjdW9djss84KhG+7J28XtOK9dwHvLx1qWHP5CEMH7fHqeM6QN3YsYmINqhWEtPKih00VXGomWLdDwvvLJliVr2RXeFcEWEf5awOXL1smndSlmKwy3w7oIHtIeP5ghxHrIOzCjy8dbliwlhA9G0JY3Mc8GRwj3eMNQdaL5g2/Sk6c3P3k0zCkfb1kymEhKw9zIkqmqM8hkTDu88Qo8nAEGCOGOPFohwZxq0fDh8gmXxbfsALtpmOHrC6TJaO393c+I/hMBpMKwEu4Na+ncOoXKDI7LwbtjxpePuSw+RcMRcRMpTdZ0SuPcDbe5fs8Jw19gvYY/pNlfaZGlWBRg8xCOKB9zWdLKFMOYCI6JEgbzJDXEDi2hu+D2zDCAMBH8JgsAOj36FETwKTCyfNxlSSqtcHgEW2VxmD3k89m/1RJRM8IAGm7W0K09QlgZPP3dZsFu5eMuS4LjLDQcF0El7xBPW8Mcwi8R7klfEmH4AywN4b5GQqqWPzVKw/HlEy+L00SCd4YwO0tOXJK5VNuMgeuSfjfFXBFGww05+hSSHBsRwVFvwUwrH3tZbCWEz2to90nP9oGkduzpR+GvDcAAG+AXEWxw+QRpuUsOWidqOKF87GWJl7GG7Q0cmda3kLUhDuF6RPKM9qkw/BWWR/Bbn8hRBnNKRnDcVMzm5eMvS393gc9GMD7J1HbJXEJiXmjg2rTf9ojqCKPhp0k/6mO3Weq2BP69fPxl6Y0gGWaE8DENIq1T1wWItoNy7zPwZAEwwKuwOISXfbSDT1Jf7ZjUcMIkzDalGJSl5it8ScPkLAN1fML7ISyyZanmgmE5Yp2Gq3WCNvDJUbJc2FQNXyzFoCwYdtaxTra0ccyefWAr18KNPn9B+v9XroigK01FaT8I6n2HT7Zj3llKwyYNggKxwMDEPONmUhroa/8peLNQGJ6AJzQsTnJefHunLZGlBWCCUio21aIOBnUoKEHNntGe1oUmscOtsxsu9P0XGdIihI5gYQRRXtPIEXUSGg5RZc7SpqoVJkDlG6BG1a8KbGpQRBmgsIDxv6/DU02AAZ6D+wz83icnJCkcZoGj1cBZYLYopWNTK2O/AuodVQjiW34oNITdcF5S+kVDMICIumGhri547kWo9gREw0wEXy+T+DYlrTD2X0D9OyhVD8DANePFgImw00x0Dbe/CQ9m+TuZBe8luE3DvQlEeneU9E4PLgCFRPEJWvhgKSWbAgjjJ0Dr90BN6A9B0tYfioSGOOyC//EJpzYEA4juLjgnimmHtE4Q2zFDrCFQjEbxHdpMuabDyPYTBIz6L1D/Ul2izaUVlONV9E536rBEbuuEe7P+rVwmyco67ZBmFrmAQFiuu7rNpMK3wbSWUjNSy9aHgPpcn3kkGQiESgGiCoVF3sKoqhWiQYEBRHcEZ2sIPXNDel+NsFxb/2sXKI5gIp+vnV2WEaUVtpkJwXmgxgzUADIHEH1Q1GRscQj35flruZ3VVXB7BL/yBaFXG7iut399CwGnMYWDSukZSSDMHAejLoRg5sBWUGY0ldQALWGgw8DpebRCQzCACDV8vX4NOBcIA7SBdJpI9dtEAs5nK7NDKUUjwk8IIPgmyAP6/ATpEGwfEGzniB9hmUN1EGCADngihPNdDnSvg5x0HQp3IxEwg4DL2MJMKaVpY3eYdzkR1Akglbt1lwnvU02lpWC+k6VfoVAYQJgNcF4ES5wmkXQArxLuRX//YTaj+RGzzNhSqjbWsut8kN8A1ebWCK79JEHq/R4NagGi/1K2gwwDgHhdwyk9znSiNvABYOB9kUg+BJzDNNNWCtbGphXesz+o70MwLtlOTmo1U0Ott0LndQ1LckFXHACXIzi2F2TXqxwQCPAAH5B0ITmXiLN4XHSVUrYxgPCv7wHxc9DTk3NLezbj2K9/b2L7ehVEsxEdTzT6dwtKfRAhcBqSl1Odf5ViMrn8CEULklNo49Qyw3VjAGHfXaHyM1Bvdbf8MqN2sGkJvgUdTxYixYXegIo5DsllCIIBrb5oSCvUb+tQnMMazi01xHAF4YB3g74czNtBC/dQMJOiHVzaovf1blhxKIK1ww8GTIVWfoLiY06hrzebVAoc7kDDBiQ/IOK/+ZNYX0rfcALhA/uB/gmY6RAJP/PIx1SKgxCtAPZHvPpoUX+9+B7edrMlkruQzLICIHNuAzVlN4pL0XyNu0VHKYXDAYRDDwF+DHpbv6kj8voMOoLoM7B8USOh1Cb5DHVlnViO5CQk65w97Ao/MzKpj0JSQXICLVzCB8p+iKGFAImZ+zGoLAK1rZ8vkGYPi6Rj18Lyq4oEoTmaoXp3JJM4Fck3kUjvaJJKMKHc7zWKu9B8hlvFs6VkDrpZ1ArjvwD6NIjGJw/Vr2/lXT6DTvIRAP13iA5ELHul6EtpYiKcaWdzfoLkI4l+gfBsQJL7JgySxwj4Ar8Qd5USOlggHD0Z1FkQHgemLXlmrSjFUfYymVZCeAji+QeacTnNzQrd3ExF8WsUu2aKIPmAYDefXkPyDeBSbigjTc0F4VPvgOiHoPeGSPkBkAWIATBsAP0peOqaos2jwYEBYEuzGwGLUUzNBYMrf8vdMdmJ4gYqnMbl4h+l1BYNwQkV4KNgFkC0XTV0GnkKvy8QA+oMROfCE6cjCJt1ac0fb7ycvwInIOjI5E8lgZD8mTYkx2JYzPHm4HJMdZEgnLgVVH4E6kKQ06rZp42qea8OqGuhclYzQRgczdDjUM/gc0i+j6x1yCkPLZElodFuOr1BwFUYzuFi8VIpzY1ogzFzITod9NtBS/c8FT7h1DTtUP8+ugfMXMTDK5p9mYM4ksxUmMU3UZyCROTqgfaBYWDqh0bxBJIFPMIvuVuEpXRneWxfmQFqAegjIWpPXrfJd1pqb4f5adAHIx58bjAudXCHVU41o5nMQhSfyeQ7pCU7puVBVffXIrkRwXf4rvhbKeVpEHxtPLR+FPTJEL21rzc5bUFknxU80mDQgFkGG+Yi/vLQYF3y4I8xnmnGMZrzkXy8KTAkgaEwKF5FcgVwId8qHeyBEPygFToOheiroHcHXUmd8N1r33iYT72pFi9CdBTivnsH89KHZsD97mY8cAmS+Q050T6v9jEjmoBlKBbRymWcIl4pIbi4Ah3vh+hkiPasmkQ+k/7oHBoicXsNuo9E/PGewb4FQzf7xI5mEmP4ESoBCIV/eobKAEPfFqF4DsllGH7G18TLmx4EC1pg8hzQXwS9L0Sjk9dj8lkZPC8I0XKIPga/u7NZfQnDE4YeDdHK91Ac3+tUZ8tPyqYVJBBYz4kI+AeKa5FcyYniiZEPwcXjQR4K0Qmg96g5xyLdJEozl9I63FwdbdEyMMcgbrt3qG7J0M9LtJ8Zg+FsJCfWhnjm8x3ShtbWw+AaVBSgkbyO4ncEXI3mTv6PWDOCtICE7XcCcySE80HPgKjFb7W+PP5CUii1X27SEgiPQtz616G8PcNjkq7dTTvjORXJqSgqDadlpDvS/evsgHQS8DyKW2jhFlq5n8PFuo0PAAT8aiZ0HwDhXAh3Bz0BIpm+IJSPv5AlH8m6PQTRsYibnxzqWzV8Zqzb3VSYxCeRfJuAcdbsVd/UjCwgpG8GxToULxBwCxVuw/Agh4lVwxeAuwII3w7de4M+AqJ3gZ4EofJbB8d3xbQsZpJthFt0M2z4LOKWYdEhOsymbzSSgzkIyWUotvLWCD490kEKIGlb0AtGJ4oVVHgAyV0EPIzgcfYZQjjMXQGMnQnrdwG9J0RzQE+DaFwVgKzLimfRCLk62zToi8B8HXHDG8NF+obnXKaHm10RXIZit960DZXDf0gPsbocahsItjpd0xpvEPAEAQ8geBLJc7SzlO1ZjhBRsYL/7HhgO+icDnp7CN8B+t0Qbg7hWIgq/QU1xHsxYnyXFvTRDM76DogWwMsXIe7uHE5iN3wn9j3EbMEoFqI4ul+kKW9vdJpjbRN86YAhSAQmQtFJhXW1Xu9lKJ6nhZeR/JOAVSjeoMIaJJ0ERFRYD90VoLWaDt01ttqqMx7CSRBOgXAaRDMg2gx0G4TtNcEX/YU6JB8MWcOoefoVomXQ/Tnovg1xQzTcRG54z3J9mGlnNCchOR3F6NwzEPoAoRJ8i8BTawQJwFToW5kpIKyFc6PauRFSi5pTK6A7AK2qYEQJQu1zLKtfkBY9ytvrHP2u6h9c/dRwFbfhnd58s1iH5rso/g3BEufEAj4Tl9XXxetdm8859ZuruRH93guggqANwWgEo4FxwFhgNNAOoqWGTsIX2Y75bDLjcdeNTdvvPb8TxELonDucQRj+MADcICJ+Jm5Fsz+CnyHQqc8r6bnLjLLhC4DrOwtX2PEfLwqSLDcnDYLeumdBzoOnTkVcs2q4i9rGM/DlavEihk8j+TSCV1PHhAjPBi1N0PPIkI+si0aAiJ+T96JkxgtMaoX6HYuqM1hEcxAX3oy4e6NIm9+4RoFdITq5lJ8C+yC4FkHopamFBxBpWiSTICfIrMj6wSwfEgVtPjfK2co8A+IYWH084kcbVVbwRjgkUhguFktQfALDUcDTTm2Q10zOoiFkgq8hizCZ6h+Va8ur2ijoJklArgfxQzD7IBZej7iic2OTrI13fPD5YgMXiF8QsTdwLoI1drO1yT7C8G44CtYYTrV7N5gD4ZmTEd/daNPhN/7B8ueLFYzmv4DZtZFsUaYGrSi/YVgIfpKN53uhMov2WArmk9BxKOJb9wzHvoOR08+QtZxkWpnAgQScgWSP1MxWnzEPPkl+efKeBnwuS85QWkeZz3FXz7JXZ9oqiC6B6DzEaa+OFPEZmUvLftmMZhKHIvkqkj1S0zTyJPVlzW+SRcGgyZdg10iaRVQHgV4E0fnQ8Q/EmXokic3IXmd5gWlnFIdR4WQk70HV0jp8YZAFgWFLEvSGIQ0Cn9Zfe9QlQrASwsthwwUjEYJNA4Y+KNqYyD4oTkJyUG0VIP90jaxp4ElawAmUT1pEoxAknWeFYQmYS2HdlfDF1xDCjGQx2TRg6IMiYHN2pMKngXkETE1cilfGWnJJtoFCSblNMg0G3YAfkPZdtvN684i6Qd9dNYc6foX4/Caz9sWmBUNvMYLzGM84DiPgEyj27R1h55vlakv/lp5aIBWGNBB8tUgmv2AZRD8HcSU8uQRx5iY32domCkNdud4oupmOZB6KI1G8C4nM5UNk9SlkVhiS6vOkYEcrILoFzHVQ+T3i8HWbsiiUMNSXu0zASmZR4d+QHFwbXFTJPAVNnjqpG2z5faZ7jAD9IoR3grkR1t4B89aOdF+ghKFhS8pIbmIKo9gfwfuRzEExDYXIPGCoKTB4j0/ugOjPYG6H7ttg1WMwv3so5iUqYRhJ5tQUtqXCbCSzUeyF5O0oWgoBIhEG7esgG9DLQd8P0b1g7oHoYdizs2z9SxiaqTkES2llFbNQ7ETAzkh2RDKzpkHGZAJEag8N0HssAv0yRM+Bfgq6HwPzKISPwo0rR2o/QAnDxmpiLWMqMJ1WtgamoJiMYjKSyQSMQjIGhULQhqINpaPqYHltIFoLUSdEq6sdXtEK0K9D9AqYpRAtQ2xXrn9dlrKUpSxlKUtZylKWwSj/HyHl/ePsagXCAAAAAElFTkSuQmCC)",height:"195px",width:"195px"},"ADVMARK1, ADVMARK2":{background:xui.browser.ie6?null:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAK3RFWHRDcmVhdGlvbiBUaW1lAHZyIDE0IGp1bCAyMDA2IDEzOjMxOjIzICswMTAwHvJDZwAAAAd0SU1FB9YHDgsgJYiZ4bUAAAAJcEhZcwAALiIAAC4iAari3ZIAAAAEZ0FNQQAAsY8L/GEFAAAB5ElEQVR42q2Tz0sqURTH72Qq4mASSAoSIfSDdCEI8qJFLXSjLYSQNoGLINrI8/0ZD9q0KnDlKkIMebmP9xZRCEEiLQLBiMiNJDYq/Zg573vpCkM6CdGBD3Pn3OvXe77nDGPfENKwJBHx/CxYAtNAAVfgXJKk7khVCCyCP6ALVKAJXkEdbINxw5tgM4HHPphSFEUql8usXq8zWZZZKBRiPp+PH3sBx2Br4FbiBg+aplGxWKRgMPiMH1+YTKZDq9V64na7G+l0mprNJo7RG/g94IEoQSsUCuRyue6QToIJYAJWMA/Bo2QySZ1Ohws9gZBeZI570Gq1yO/395BKGJg+ZbFYznK5HAmf9vQiKW5iqVQim832Fyn5E+83Y7EYieAdY2Nig7dRqtVqrNfr3YiWGsVltVrtr2f0IrwEZrfbGeqWhQ9GMeFwOPprRS9SAWo4HGZOp/MH1l4DAS6+HolE+u9Xek9kcK+qKqVSKUL/s0hPDhFY83g8j5VKhcQg7nxs80/w0mg0KB6Pa2az+RTpDbDA3sd/lwvk8/l+Z7iS/FHEAor8H9rtNmWzWYpGo+T1eikQCFAmkyFxAy7AJ255aMHYcIID8d1oNBi8hGuwwkYFDq0CPlG3YsTb4B/4BRwjBb4S/wGzT16tu5THiAAAAABJRU5ErkJggg==)",height:"16px",margin:"-8px 0 0 -8px",overflow:"hidden",width:"16px"},".xui-nodatauri ADVCLR":{background:xui.browser.ie6?null:xui.UI.$oldBg("clrbg.png","no-repeat left top"),_filter:xui.UI.$ieOldBg("clrbg.png"),"-ms-filter":xui.browser.ie8?xui.UI.$ieOldBg("clrbg.png"):null},".xui-nodatauri ADVWHEEL":{background:xui.browser.ie6?null:xui.UI.$oldBg("clr.png","no-repeat left top"),_filter:xui.UI.$ieOldBg("clr.png"),"-ms-filter":xui.browser.ie8?xui.UI.$ieOldBg("clr.png"):null},".xui-nodatauri ADVMARK1, .xui-nodatauri ADVMARK2":{background:xui.browser.ie6?null:xui.UI.$oldBg("picker.png","no-repeat left top"),_filter:xui.UI.$ieOldBg("picker.png"),"-ms-filter":xui.browser.ie8?xui.UI.$ieOldBg("picker.png"):null},"LIST span":{overflow:"hidden",margin:"0",cursor:"pointer",margin:"0 -1px -1px 0",display:xui.$inlineBlock,"font-size":"1.18em"},TRANS:{position:"absolute",top:".25em",left:"0",display:xui.$inlineBlock,cursor:"pointer"},SET:{position:"absolute",display:"none",top:".125em",right:"2.5em"},TOGGLE:{position:"absolute",right:".5em",top:"0.25em",display:xui.$inlineBlock,cursor:"default"}},Behaviors:{HoverEffected:{CLOSE:"CLOSE",SET:"SET",TRANS:"TRANS",TOGGLE:"TOGGLE"},ClickEffected:{CLOSE:"CLOSE",SET:"SET",TRANS:"TRANS",TOGGLE:"TOGGLE"},KEY:{onClick:function(){return false}},SC:{onMouseover:function(c,b,a){c.box._setTempUI(c,c.getSubId(a))},onClick:function(d,c,b){var a=d.getSubId(b);d.boxing()._setCtrlValue(d.$tempValue=a,false);d.box._vC(d);if(!d.properties.advance){d.boxing().setUIValue(a,true,null,"click")}return false},onDblclick:function(d,c,b){var a=d.getSubId(b);d.boxing()._setCtrlValue(d.$tempValue=a,false);d.box._vC(d);d.boxing().setUIValue(a,true,null,"dblclick");return false}},LIST:{onMouseout:function(c,b,a){c.box._updateDftTip(c)}},SET:{onClick:function(b,a,c){b.box._vC(b);b.boxing().setUIValue(b.$tempValue,true,null,"setbtn")}},TRANS:{onClick:function(b,a,c){b.box._vC(b);b.boxing().setUIValue(b.$tempValue="transparent",true,null,"transbtn")}},CANCEL:{onClick:function(b,a,c){b.getSubNode("CLOSE").onClick(true)}},TOGGLE:{onClick:function(b,a,c){b.boxing().setAdvance(!b.properties.advance)}},R:{beforeMousedown:function(b,a,c){b.box._dd1(b,a,c)},onDrag:function(b,a,c){b.box._dd2(b,a,c,0)},onDragstop:function(b,a,c){b.box._dd3(b,a,c,0)}},G:{beforeMousedown:function(b,a,c){b.box._dd1(b,a,c)},onDrag:function(b,a,c){b.box._dd2(b,a,c,1)},onDragstop:function(b,a,c){b.box._dd3(b,a,c,1)}},B:{beforeMousedown:function(b,a,c){b.box._dd1(b,a,c)},onDrag:function(b,a,c){b.box._dd2(b,a,c,2)},onDragstop:function(b,a,c){b.box._dd3(b,a,c,2)}},HH:{beforeMousedown:function(b,a,c){b.box._dd1(b,a,c,true)},onDrag:function(b,a,c){b.box._dd2(b,a,c,0,"hsv1")},onDragstop:function(b,a,c){b.box._dd3(b,a,c,0,true,"hsv1")}},S:{beforeMousedown:function(b,a,c){b.box._dd1(b,a,c,true)},onDrag:function(b,a,c){b.box._dd2(b,a,c,1,"hsv2")},onDragstop:function(b,a,c){b.box._dd3(b,a,c,1,true,"hsv2")}},V:{beforeMousedown:function(b,a,c){b.box._dd1(b,a,c,true)},onDrag:function(b,a,c){b.box._dd2(b,a,c,2,"hsv2")},onDragstop:function(b,a,c){b.box._dd3(b,a,c,2,true,"hsv2")}},H:{beforeMousedown:function(b,a,c){b.box._dd1(b,a,c)},onDrag:function(b,a,c){b.box._dd2(b,a,c,0,"hex")},onDragstop:function(b,a,c){b.box._dd3(b,a,c,0)}},E:{beforeMousedown:function(b,a,c){b.box._dd1(b,a,c)},onDrag:function(b,a,c){b.box._dd2(b,a,c,1,"hex")},onDragstop:function(b,a,c){b.box._dd3(b,a,c,1)}},X:{beforeMousedown:function(b,a,c){b.box._dd1(b,a,c)},onDrag:function(b,a,c){b.box._dd2(b,a,c,2,"hex")},onDragstop:function(b,a,c){b.box._dd3(b,a,c,2)}},CLOSE:{onClick:function(c,d,f){var b=c.properties,a=c.boxing();if(b.disabled||b.readonly){return}if(false===a.beforeClose(c)){return}a.destroy()}},ADVWHEEL:{beforeMousedown:function(c,b,d){var a=c.box;a._prepareAdv(c,b);a._updateClrByPos(c,b,true);c.getSubNode("ADVMARK1").startDrag(b,{dragType:"none"})}},ADVMARK1:{beforeMousedown:function(c,b,d){var a=c.box;a._prepareAdv(c,b);a._updateClrByPos(c,b,true);c.getSubNode("ADVMARK1").startDrag(b,{dragType:"none"})},onDrag:function(c,b,d){var a=c.box;a._updateClrByPos(c,b,true)},onDragstop:function(b,a,c){b.box._updateValueByPos(b,a)},onDblclick:function(b,a,c){b.box._updateValueByPos(b,a);b.box._vC(b);b.boxing().setUIValue(b.$tempValue,true,null,"advdblclick")}},ADVCLR:{beforeMousedown:function(c,b,d){var a=c.box;a._prepareAdv(c,b);a._updateClrByPos(c,b);c.getSubNode("ADVMARK2").startDrag(b,{dragType:"none"});return false}},ADVMARK2:{beforeMousedown:function(c,b,d){var a=c.box;a._prepareAdv(c,b);a._updateClrByPos(c,b);c.getSubNode("ADVMARK2").startDrag(b,{dragType:"none"});return false},onDrag:function(c,b,d){var a=c.box;a._updateClrByPos(c,b)},onDragstop:function(b,a,c){b.box._updateValueByPos(b,a)},onDblclick:function(b,a,c){b.box._updateValueByPos(b,a);b.box._vC(b);b.boxing().setUIValue(b.$tempValue,true,null,"adv2dblclick")}}},_vC:function(b){var e=b.properties,a=e.$UIvalue,c=a==b.$tempValue;b.getSubNode("SET").css("display",c?"none":"block");b.getSubNode("CAPTION").css("color",c?"#000":"#ff0000")},_prepareData:function(b){var c=arguments.callee.upper.call(this,b);var a="display:none";c.classBar=c.barDisplay?"xui-uibar-top":"xui-uibar-top-s";c.closeDisplay=c.closeBtn?"":a;c.advDispay=c.advance?"":"display:none;";c._transparent=xui.getRes("inline.transparent");c._set=xui.wrapRes("inline.set");return c},EventHandlers:{beforeClose:function(a,b){}},RenderTrigger:function(){this.$onValueSet=this.$onUIValueSet=function(b,a){this.box._setClrName(this,a)}},_setClrName:function(c,b){var e=c,a="color.LIST.",d=xui.getRes(a+b);if(d==b){e.$clrN2=e.$clrN=(b=="transparent"?"":"#")+b}else{e.$clrN=d;e.$clrN2=xui.wrapRes(a+b)}},_slist:"FFFFFF,FFFFF0,FFFFE0,FFFF00,FFFAFA,FFFAF0,FFFACD,FFF8DC,FFF5EE,FFF0F5,FFEFD5,FFEBCD,FFE4E1,FFE4C4,FFE4B5,FFDEAD,FFDAB9,FFD700,FFC0CB,FFB6C1,FFA500,FFA07A,FF8C00,FF7F50,FF69B4,FF6347,FF4500,FF1493,FF00FF,FF00FF,FF0000,FDF5E6,FAFAD2,FAF0E6,FAEBD7,FA8072,F8F8FF,F5FFFA,F5F5F5,F5DEB3,F4A460,F0FFFF,F0FFF0,F0F8FF,F0E68C,F08080,EEE8AA,EE82EE,E9967A,E6E6FA,E1FFFF,DEB887,DDA0DD,DCDCDC,DC143C,DB7093,DAA520,DA70D6,D8BFD8,D3D3D3,D2B48C,D2691E,CD853F,CD5C5C,C71585,C0C0C0,BDB76B,BC8F8F,BA55D3,B22222,B0E0E6,B0C4DE,AFEEEE,ADFF2F,ADD8E6,A9A9A9,A52A2A,A0522D,9932CC,98FB98,9400D3,9370DB,90EE90,8FBC8F,8B4513,8B008B,8B0000,8A2BE2,87CEFA,87CEEB,808080,808000,800080,800000,7FFFAA,7FFF00,7CFC00,7B68EE,778899,708090,6B8E23,6A5ACD,696969,6495ED,5F9EA0,556B2F,4B0082,48D1CC,483D8B,4682B4,4169E1,40E0D0,3CB371,32CD32,2F4F4F,2E8B57,228B22,20B2AA,1E90FF,191970,00FFFF,00FFFF,00FF7F,00FF00,00FA9A,00CED1,00BFFF,008B8B,008080,008000,006400,0000FF,0000CD,00008B,000080,000000".split(","),_C16:"0123456789ABCDEF",_dd1:function(c,j,l,b){if(xui.Event.getBtn(j)!="left"){return}var g=c.properties,a=c.box,d=function(){var e=a.hex2rgb(c.$tempValue||g.$UIvalue);return b?a.rgb2hsv(e):e};xui.use(l).css("backgroundColor","red").startDrag(j,{dragType:"blank",targetReposition:false,widthIncrement:2,dragCursor:true});c.$temp=0;c.$start=d();c.$temp2=d()},_dd2:function(f,m,a,g,n){var j,d=xui.DragDrop.getProfile().offset,b=f.properties,c=f.$temp2,q=f.box,l=n=="hsv1"?361:n=="hsv2"?101:256,o;j=(n=="hsv2"?parseInt(f.$start[g]*100,10):parseInt(f.$start[g],10))+parseInt(d.x/2,10);j=(j%l+l)%l;if(f.$temp!=j){c[g]=f.$temp=n=="hsv2"?j/100:j;o=(n=="hsv1"||n=="hsv2")?q.hsv2rgb(c):c;o=q.rgb2hex(o);q._setTempUI(f,o);xui.use(a).text(n=="hex"?q._toFF(j):j)}},_dd3:function(d,j,a,f,g){if(d.$start[f]!==d.$temp){var b=d.properties,m=d.box,c=d.$start,l;c[f]=d.$temp;l=g?m.hsv2rgb(c):c;l=m.rgb2hex(l);if(g){d.$hexinhsv=l}d.boxing()._setCtrlValue(d.$tempValue=l,false);delete d.$hexinhsv;d.box._vC(d)}xui.use(a).css("backgroundColor","");d.$temp=d.$start=0},_setTempUI:function(a,l){var m=this,e=m.hex2rgb(l),f=a.boxing(),d=f.getSubNode("EXAM"),c=m.rgb2hsv(e),j=xui.getRes("color.LIST."+l),g=(l=="transparent"?"":"#")+l;d.css({backgroundColor:g,color:c[2]>0.6?"#000":"#FFF"});d.text(a.show_color=j==l?g:j)},_updateDftTip:function(d){var a=d.box,e=d.properties,c=(d.$tempValue||e.$UIvalue)=="transparent",b=d.boxing().getSubNode("EXAM");b.css({backgroundColor:c?"transparent":"#"+d.$hex.join(""),color:c?"#000":d.$hsv[2]>0.6?"#000":"#FFF"});b.html(d.$clrN2||"",false)},_to3:function(a){if(!a||a=="transparent"){a="FFFFFF"}return[a.substr(0,2),a.substr(2,2),a.substr(4,2)]},_toFF:function(b){var a=this._C16;b=parseInt(b,10)||0;b=(b>255||b<0)?0:b;return a.charAt((b-b%16)/16)+a.charAt(b%16)},_to255:function(c){var b=this._C16,a=c.split("");return b.indexOf(a[0].toUpperCase())*16+b.indexOf(a[1].toUpperCase())},_webSafe:function(e,d,a){var c=arguments.callee,j=c.f||(c.f=function(b){return parseInt(b/51,10)*51});if(typeof e=="object"){d=e[1];a=e[2];e=e[0]}return[j(e),j(d),j(a)]},_updateMarks:function(b,a,g,f){var m=this,e=m.hex2rgb(a),d=m.rgb2hsv(e),c=(d[0]/360)*6.28,n=b.getSubNode("ADVCLR");if(g){var l=b.getSubNode("ADVMARK1"),j=b.getSubNode("ADVMARK2");l.cssPos({left:Math.round(Math.sin(c)*m._radius+m._bigRadius),top:Math.round(-Math.cos(c)*m._radius+m._bigRadius)});j.cssPos({left:Math.round(m._square*(d[1]-0.5)+m._bigRadius),top:Math.round(m._square*(0.5-d[2])+m._bigRadius)})}if(f!==undefined){n.css("backgroundColor","#"+m.rgb2hex(m.hsv2rgb([f,1,1])))}m._setTempUI(b,a)},_updateClrByPos:function(c,l,m){var x=this,f=xui.Event.getPos(l),o=c.$tpos,b=f.left-o.left,q=f.top-o.top,d,w,u,j,A,r,g,n,a;if(m){w=c.getSubNode("ADVMARK1");d=Math.atan2(b,-q);w.cssPos({left:Math.round(Math.sin(d)*x._radius+x._bigRadius),top:Math.round(-Math.cos(d)*x._radius+x._bigRadius)});j=Math.floor((d/Math.PI)*180);if(j<0){j+=360}g=[j,c.$hsv[1],c.$hsv[2]];n=x.hsv2rgb(g);a=x.rgb2hex(n);x._updateMarks(c,c.$t_hex=a,false,j)}else{u=c.getSubNode("ADVMARK2");A=Math.max(0,Math.min(1,(b/x._square)+0.5));r=Math.max(0,Math.min(1,0.5-(q/x._square)));u.cssPos({left:Math.round(x._square*(A-0.5)+x._bigRadius),top:Math.round(x._square*(0.5-r)+x._bigRadius)});g=[c.$hsv[0],A,r];n=x.hsv2rgb(g);a=x.rgb2hex(n);x._updateMarks(c,c.$t_hex=a)}},_updateValueByPos:function(a,b){a.$hexinadv=a.$t_hex;a.boxing()._setCtrlValue(a.$tempValue=a.$t_hex,false);delete a.$hexinadv;a.box._vC(a)},_prepareAdv:function(b,c){var a=this,d=b.getSubNode("ADVWHEEL").offset();b.$tpos={left:d.left+a._bigRadius,top:d.top+a._bigRadius}},_ensureValue:function(d,m){var j=this,g=arguments.callee,b=g.map||(g.map=(function(){var a={};xui.arr.each(j._C16.split(""),function(q,n){a[q]=1});return a}())),c=g._r||(g._r=/rgb\(([^)]*)\)/);if(!m||typeof m!="string"||m=="transparent"){return"transparent"}if(c.test(m)){m=m.replace(c,"$1");m=m.split(",");m[0]=parseInt(m[0],10)||0;m[1]=parseInt(m[1],10)||0;m[2]=parseInt(m[2],10)||0;m=j.rgb2hex(m)}if(m.charAt(0)=="#"){m=m.substr(1,m.length)}var l="",e;for(var f=0;f<6;f++){e=m.charAt(f).toUpperCase();l+=(b[e]?e:"F")}return l},hsv2rgb:function(l,A,w){if(l instanceof Array){A=l[1];w=l[2];l=l[0]}var o=arguments.callee,n=o.f||(o.f=function(b){return Math.min(255,Math.round(b*256))}),a,m,u,j,e,d,c,x;if(A==0){return[w=n(w),w,w]}else{j=Math.floor((l/60)%6);e=(l/60)-j;d=w*(1-A);c=w*(1-e*A);x=w*(1-(1-e)*A);switch(j){case 0:a=w;m=x;u=d;break;case 1:a=c;m=w;u=d;break;case 2:a=d;m=w;u=x;break;case 3:a=d;m=c;u=w;break;case 4:a=x;m=d;u=w;break;case 5:a=w;m=d;u=c;break}return A==0?[w=n(w),w,w]:[n(a),n(m),n(u)]}},rgb2hsv:function(a,e,f){if(a instanceof Array){e=a[1];f=a[2];a=a[0]}a=a/255;e=e/255;f=f/255;var c=Math.min(a,e,f),j=Math.max(a,e,f),l=j-c,n=(j===0)?0:1-(c/j),m=j,d;switch(j){case c:d=0;break;case a:d=60*(e-f)/l;if(e<f){d+=360}break;case e:d=(60*(f-a)/l)+120;break;case f:d=(60*(a-e)/l)+240;break}return[Math.round(d),n,m]},rgb2hex:function(e,d,a){var c=this;if(e instanceof Array){d=e[1];a=e[2];e=e[0]}return c._toFF(e)+c._toFF(d)+c._toFF(a)},hex2rgb:function(b){var a=this;if(!b||b=="transparent"){b="FFFFFF"}if(b.charAt(0)=="#"){b=b.slice(1)}return[a._to255(b.substr(0,2)),a._to255(b.substr(2,2)),a._to255(b.substr(4,2))]},getTextColor:function(b){var a=this;b=a._ensureValue(0,b);if(b&&b.toLowerCase()=="transparent"){return"#000000"}b=a.hex2rgb(b);b=a.rgb2hsv(b);return(b&&b[2])>0.6?"#000000":"#FFFFFF"},_onresize:function(){}}});xui.Class("xui.UI.DatePicker",["xui.UI","xui.absValue"],{Dependencies:["xui.Date"],Instance:{activate:function(){this.getSubNode("PRE").focus(true);return this},_setCtrlValue:function(a){return this.each(function(c){if(!c.renderId){return}var b=c.box,d=c.properties;b._to(c,a,true);if(c.keys.CAPTION){c.getSubNode("CAPTION").html(xui.Date.getText(a,"ymd",d.firstDayOfWeek),false)}})},getDateFrom:function(){return this.get(0)._realstart}},Initialize:function(){var q=this,r=xui.UI.$ID,G=xui.UI.$tag_special,c=xui.UI.$CLS,H=q.KEY;q.addTemplateKeys(["H","COL","W","TBODY","THEADER","TD"]);var n='<colgroup id="'+H+"-COL:"+r+':"  class="'+G+"COL_CS"+G+' xui-custom {comcls}"  style="'+G+"COL_CS"+G+'"><col width="1px"/><col width=""/><col width=""/><col width=""/><col width=""/><col width=""/><col width=""/><col width=""/></colgroup>',e='<thead ID="'+H+"-THEADER:"+r+':" class="'+G+"THEADER_CS"+G+' xui-custom {comcls}"  style="'+G+"THEADER_CS"+G+'" ><tr height="1px"><th id="'+H+"-H:"+r+':7" class="xui-node  xui-node-th xui-uiborder-b xui-uiborder-r '+c+"-h "+c+"-w "+G+"H_CC"+G+' xui-custom {comcls}" style="'+G+"H_CS"+G+'"></th>',d="</tr></thead>",m='<th id="'+H+"-H:"+r+':@" class="xui-node xui-node-th xui-uiborder-b xui-uiborder-r '+c+"-h "+G+"H_CC"+G+' xui-custom {comcls}"  style="'+G+"H_CS"+G+'">@</th>',x='<tbody id="'+H+"-TBODY:"+r+':"  class="'+G+"TBODY_CS"+G+' xui-custom {comcls}"  style="'+G+"TBODY_CS"+G+'" >',u="</tbody>",F="<tr>",D="</tr>",g='<th id="'+H+"-W:"+r+':@"  class="xui-node xui-node-th xui-uiborder-b xui-uiborder-r '+c+"-w "+G+"W_CC"+G+' xui-custom {comcls}"  style="'+G+"W_CS"+G+'">@</th>',f='<td id="'+H+"-TD:"+r+':@" class="xui-node xui-uicell  xui-node-td xui-uiborder-b xui-uiborder-r '+c+"-td "+G+"TD_CC"+G+' xui-custom {comcls}"  style="'+G+"TD_CS"+G+'" '+xui.$IEUNSELECTABLE()+" ></td>",o,B,A,w,s,E=[],C=[];for(B=0;B<7;B++){C[C.length]=m.replace(/@/g,B)}w=s=0;for(B=0;B<48;B++){A=B%8;E[E.length]=(A==0?F:"")+(A==0?g:f).replace(/@/g,A==0?s:w)+(A==7?D:"");if(A!==0){w++}else{s++}}o=n+e+C.join("")+d+x+E.join("")+u;q.setTemplate({tagName:"div",style:"{_style};height:auto;",BORDER:{tagName:"div",className:"xui-uiborder-outset xui-uiborder-box xui-uiborder-radius-big",BAR:{tagName:"div",className:"xui-uibar-top",style:"{barDisplay};",BARTDL:{className:"xui-uibar-tdl xui-uibar xui-uiborder-radius-big-tl",BARTDLT:{className:"xui-uibar-tdlt"}},BARTDM:{$order:1,className:"xui-uibar-tdm xui-uibar",BARTDMT:{className:"xui-uibar-tdmt"}},BARTDR:{$order:2,className:"xui-uibar-tdr xui-uibar xui-uiborder-radius-big-tr",BARTDRT:{className:"xui-uibar-tdrt"}},BARCMDL:{$order:3,tagName:"div",className:"xui-uibar-cmdl",PRE2:{$order:0,className:"xuifont",$fonticon:"xui-icon-doubleleft",tabindex:"{tabindex}"},PRE:{$order:1,className:"xuifont",$fonticon:"xui-icon-singleleft",tabindex:"{tabindex}"},YEAR:{$order:2,className:"xui-ui-draggable xui-uibase xui-uiborder-flat xui-uiborder-radius"},YTXT:{$order:3,text:"-"},MONTH:{$order:4,className:"xui-ui-draggable xui-uibase xui-uiborder-flat xui-uiborder-radius"},MTXT:{$order:5,text:"-"},DAY:{$order:6,className:"xui-ui-draggable xui-uibase xui-uiborder-flat xui-uiborder-radius"},NEXT:{$order:7,className:"xuifont",$fonticon:"xui-icon-singleright",tabindex:"{tabindex}"},NEXT2:{$order:8,className:"xuifont",$fonticon:"xui-icon-doubleright",tabindex:"{tabindex}"}},BARCMDR:{$order:4,tagName:"div",className:"xui-uibar-cmdr",CLOSE:{className:"xuifont",$fonticon:"xui-uicmd-close",style:"{closeDisplay}"}},TBARTDB:{$order:5,tagName:"div",className:"xui-uibar-tdb xui-uiborder-inset xui-uiborder-radius"}},MAIN:{$order:2,tagName:"div",className:"xui-uicon-main xui-uibar",MAINI:{tagName:"div",className:"xui-uicon-maini xui-uicon-maini xui-uibar",CON:{tagName:"div",className:"xui-uiborder-inset",BODY:{tagName:"table",cellpadding:"0",cellspacing:"0",text:o}}}},TAIL:{$order:3,tagName:"div",className:"xui-uicon-main xui-uibar",TAILI:{tagName:"div",className:"xui-uicon-maini xui-uibar",CAPTION:{tagName:"div",style:"{_nocap}",text:"{caption}",$order:0},TIME:{style:"{_timectrl}",tagName:"div",TPRE2:{$order:0,className:"xuifont",$fonticon:"xui-icon-doubleleft",tabindex:"{tabindex}"},TPRE:{$order:1,className:"xuifont",$fonticon:"xui-icon-singleleft",tabindex:"{tabindex}"},HOUR:{$order:2,className:"xui-ui-draggable xui-uibase xui-uiborder-flat xui-uiborder-radius"},MTXT:{$order:3,text:":"},MINUTE:{$order:4,className:"xui-ui-draggable xui-uibase xui-uiborder-flat xui-uiborder-radius"},TNEXT:{$order:6,className:"xuifont",$fonticon:"xui-icon-singleright",tabindex:"{tabindex}"},TNEXT2:{$order:7,className:"xuifont",$fonticon:"xui-icon-doubleright",tabindex:"{tabindex}"}},TODAY:{tabindex:"{tabindex}",className:"xuifont",$fonticon:"xui-icon-date",title:"{_todaytitle}"},SET:{tagName:"button",className:"xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius",tabindex:"{tabindex}",text:"{_set}"}}},BBAR:{$order:4,tagName:"div",className:"xui-uibar-bottom-s",BBARTDL:{className:"xui-uibar-tdl xui-uibar xui-uiborder-radius-big-bl"},BBARTDM:{$order:1,className:"xui-uibar-tdm xui-uibar"},BBARTDR:{$order:2,className:"xui-uibar-tdr xui-uibar xui-uiborder-radius-big-br"}}}})},Static:{Appearances:{KEY:{},"TBART, BBART":{"border-spacing":0,"border-collapse":"separate"},BORDER:{},BODY:{position:"relative"},BARCMDL:{top:".125em"},TAILI:{position:"relative",padding:".5em 0 0 0"},TIME:{padding:".25em 1.5em"},SET:{position:"absolute",display:"none",top:".125em",right:".5em"},TODAY:{position:"absolute",top:".25em",left:".125em",display:xui.$inlineBlock,cursor:"default"},"PRE,PRE2,NEXT,NEXT2,TPRE,TPRE2,TNEXT,TNEXT2":{$order:0,display:xui.$inlineBlock,position:"relative",margin:"0 .25em","vertical-align":"middle",cursor:"default"},"YEAR,MONTH,DAY,HOUR,MINUTE":{$order:4,"font-weight":"bold","vertical-align":"middle",cursor:"e-resize",margin:"0 .25em",padding:"0 .25em"},YEAR:{},"MONTH, DAY,HOUR, MINUTE":{},CAPTION:{"text-align":"center","vertical-align":xui.browser.ie6?"baseline":"middle","font-size":"1em"},MAINI:{padding:".5em .3333em .3333em 0"},BODY:{overflow:"visible"},TD:{$order:1,"text-align":"center"},"TD-checked":{$order:4,"font-weight":"bold"},"W,H":{$order:3,"vertical-align":"middle","text-align":"center",padding:".25em"},W:{$order:4,padding:".125em"},H:{$order:4,padding:".25em 0.6666667em"}},Behaviors:{HoverEffected:{CLOSE:"CLOSE",TD:"TD",PRE:"PRE",PRE2:"PRE2",NEXT:"NEXT",NEXT2:"NEXT2",TPRE:"TPRE",TPRE2:"TPRE2",TNEXT:"TNEXT",TNEXT2:"TNEXT2",SET:"SET",TODAY:"TODAY"},ClickEffected:{CLOSE:"CLOSE",TD:"TD",PRE:"PRE",PRE2:"PRE2",NEXT:"NEXT",NEXT2:"NEXT2",TPRE:"TPRE",TPRE2:"TPRE2",TNEXT:"TNEXT",TNEXT2:"TNEXT2",SET:"SET",TODAY:"TODAY"},KEY:{onClick:function(){return false}},TD:{onClick:function(b,f,g){var d=b.properties,j=b.getSubId(g),c=b.$daymap,a=c[j];if(d.disabled||d.readonly){return false}xui.use(g).onMouseout(true,{$force:true});a=xui.Date.add(b.$tempValue,"d",xui.Date.diff(b.$tempValue,a,"d",d.firstDayOfWeek));b.box._to(b,a);if(!d.timeInput){b.boxing().setUIValue(a,null,null,"click")}},onDblclick:function(a,c,d){var b=a.properties;if(b.timeInput){xui.use(d).onMouseout(true,{$force:true});a.boxing().setUIValue(a.$tempValue,true,null,"dblclick")}}},TODAY:{onClick:function(a,b,c){xui.use(c).onMouseout(true,{$force:true});a.boxing().setUIValue(a.properties.timeInput?new Date:xui.Date.getTimSpanStart(new Date,"d",1),true,null,"today")}},SET:{onClick:function(a,b,c){xui.use(c).onMouseout(true,{$force:true});a.boxing().setUIValue(a.$tempValue,true,null,"set")}},CLOSE:{onClick:function(b,d,f){var c=b.properties,a=b.boxing();if(c.disabled||c.readonly){return}if(false===a.beforeClose(b,f)){return}a.destroy(true)}},PRE:{onClick:function(a,c,d){var b=a.properties;if(b.disabled||b.readonly){return}a.box._to(a,xui.Date.add(a.$tempValue,"m",-1))}},NEXT:{onClick:function(a,c,d){var b=a.properties;if(b.disabled||b.readonly){return}a.box._to(a,xui.Date.add(a.$tempValue,"m",1))}},PRE2:{onClick:function(a,c,d){var b=a.properties;if(b.disabled||b.readonly){return}a.box._to(a,xui.Date.add(a.$tempValue,"y",-1))}},NEXT2:{onClick:function(a,c,d){var b=a.properties;if(b.disabled||b.readonly){return}a.box._to(a,xui.Date.add(a.$tempValue,"y",1))}},TPRE:{onClick:function(a,c,d){var b=a.properties;if(b.disabled||b.readonly){return}a.box._to(a,xui.Date.add(a.$tempValue,"n",-1))}},TNEXT:{onClick:function(a,c,d){var b=a.properties;if(b.disabled||b.readonly){return}a.box._to(a,xui.Date.add(a.$tempValue,"n",1))}},TPRE2:{onClick:function(a,c,d){var b=a.properties;if(b.disabled||b.readonly){return}a.box._to(a,xui.Date.add(a.$tempValue,"h",-1))}},TNEXT2:{onClick:function(a,c,d){var b=a.properties;if(b.disabled||b.readonly){return}a.box._to(a,xui.Date.add(a.$tempValue,"h",1))}},YEAR:{beforeMousedown:function(a,b,c){return a.box._ondown(a,b,c,10)},onDrag:function(a,c,f){var b,d=xui.DragDrop.getProfile().offset;b=parseInt(a.$year,10)+parseInt(d.x/10,10);if(a.$temp!=b){a.$temp2=parseInt(d.x/10,10);a.getSubNode("YEAR").html(b,false)}},onDragstop:function(a,b,c){return a.box._onds(a,b,c,"y")}},MONTH:{beforeMousedown:function(a,b,c){return a.box._ondown(a,b,c,20)},onDrag:function(a,c,f){var b,d=xui.DragDrop.getProfile().offset;b=parseInt(a.$month,10)+(parseInt(d.x/20,10)%12);b=(b%12+12)%12;if(a.$temp!=b){a.$temp=b;a.$temp2=b-a.$month+1;a.getSubNode("MONTH").html(((b+1)<=9?"0":"")+(b+1),false)}},onDragstop:function(a,b,c){return a.box._onds(a,b,c,"m")}},DAY:{beforeMousedown:function(a,b,c){return a.box._ondown(a,b,c,10)},onDrag:function(b,f,j){var a=new Date(b.$year,b.$month,0),l=a.getDate();var d=b.properties,c,g=xui.DragDrop.getProfile().offset;c=parseInt(b.$day,10)+(parseInt(g.x/10,10)%l);c=(c%l+l)%l+1;if(b.$temp!=c){b.$temp=c;b.$temp2=c-b.$day;b.getSubNode("DAY").html((c<=9?"0":"")+c,false)}},onDragstop:function(a,b,c){return a.box._onds(a,b,c,"d")}},HOUR:{beforeMousedown:function(a,b,c){return a.box._ondown(a,b,c,20)},onDrag:function(a,b,c){return a.box._ondrag(a,20,24,"HOUR",a.$hour)},onDragstop:function(a,b,c){return a.box._onds(a,b,c,"h")}},MINUTE:{beforeMousedown:function(a,b,c){return a.box._ondown(a,b,c,10)},onDrag:function(a,b,c){return a.box._ondrag(a,10,60,"MINUTE",a.$minute)},onDragstop:function(a,b,c){return a.box._onds(a,b,c,"n")}}},DataModel:{timeInput:{ini:false,action:function(a){this.getSubNode("CAPTION").css("display",a?"none":"block");this.getSubNode("SET").css("display",a?"block":"none");this.getSubNode("TIME").css("display",a?"block":"none");this.getSubNode("TODAY").attr("title",xui.getRes(a?"inline.now":"inline.today"))}},height:{$spaceunit:1,ini:"auto",readonly:true},width:{$spaceunit:1,ini:"auto",readonly:true},value:{ini:new Date,format:"date"},closeBtn:{ini:true,action:function(a){this.getSubNode("CLOSE").css("display",a?"":"none")}},firstDayOfWeek:{ini:0,action:function(){this.boxing().refresh()}},offDays:{ini:"60",action:function(){this.boxing().refresh()}},hideWeekLabels:{ini:false,action:function(){this.boxing().refresh()}},dateInputFormat:{ini:"yyyy-mm-dd",listbox:["yyyy-mm-dd","mm-dd-yyyy","dd-mm-yyyy"],action:function(){this.boxing().refresh()}}},EventHandlers:{beforeClose:function(a,b){}},_prepareData:function(c){var d=arguments.callee.upper.call(this,c);var a="display:none";d.closeDisplay=d.closeBtn?"":a;var b="display:none;";if(c.properties.timeInput){d._todaytitle=xui.getRes("inline.now");d._nocap=b}else{d._todaytitle=xui.getRes("inline.today");d._timectrl=b}d._set=xui.wrapRes("inline.set");return d},_ensureValue:function(a,b){var c;if(b){if(xui.isDate(b)){c=b}else{if(xui.isFinite(b)){c=new Date(parseInt(b,10))}}}c=c||new Date;if(!a.properties.timeInput){c=xui.Date.getTimSpanStart(c,"d")}return c},RenderTrigger:function(){var d=this,f=d.properties,g=d.boxing(),c=d.box;c._setWeekLabel(d);var e={yyyy:"YEAR",mm:"MONTH",dd:"DAY"},a=f.dateInputFormat.split("-");if(e[a[0]]&&e[a[1]]&&e[a[2]]){d.getSubNode("YTXT").addPrev(d.getSubNode(e[a[0]]));d.getSubNode("MTXT").addPrev(d.getSubNode(e[a[1]]));d.getSubNode("MTXT").addNext(d.getSubNode(e[a[2]]))}},_getWeekNodes:function(a){return a.$weeks||(a.$weeks=a.getSubNode("W",true))},_getTDNodes:function(a){return a.$tds||(a.$tds=a.getSubNode("TD",true))},_getLabelNodes:function(a){return a.$days||(a.$days=a.getSubNode("TD",true))},_getHeaderNodes:function(a){return a.$header||(a.$header=a.getSubNode("H",true))},_setWeekLabel:function(c){var g=c.properties;var e=g.firstDayOfWeek,d=function(f){f=c.getSubId(f);if(f=="7"){return f}f=(parseInt(f,10)+e);return f<7?f:(f-7)};c.box._getHeaderNodes(c).each(function(j,f){j.innerHTML=xui.wrapRes("date.WEEKS."+d(j.id))});if(g.hideWeekLabels){c.getSubNode("BODY").query("TR").first().remove();c.getSubNode("COL").first().remove()}var a="xui-uicell-alt",b={};if(g.offDays){xui.arr.each(g.offDays.split(""),function(f){f=parseInt(f,10);if(f>=0&&f<=6){b[f]=1}});c.box._getTDNodes(c).each(function(j,f){f=((f+e)-7*parseInt((f+e)/7,10));if(b[f]){j.className=j.className+" "+a}else{j.className=j.className.replace(a,"")}})}},_setBGV:function(e,b,a){var c=xui.Date,g=e.properties,f=e.$daymap||(e.$daymap=[]),d,j;e.box._getLabelNodes(e).each(function(m,l){j=c.add(b,"d",l);f[l]=j;d=c.get(j,"m")==a?"#":'<p class="xui-node xui-node-p xui-ui-readonly xui-custom {comcls}">#</p>';j=c.get(j,"d");m.innerHTML=d.replace("#",j)});if(!g.hideWeekLabels){e.box._getWeekNodes(e).each(function(m,l){m.innerHTML=c.get(c.add(b,"ww",l),"ww",g.firstDayOfWeek)})}},_to:function(f,e,b){var a=f.properties,j=a.firstDayOfWeek,g=xui.Date,q=f.keys,n=a.$UIvalue,l=-1,d,o,r=g.getTimSpanStart(g.getTimSpanStart(e,"m"),"ww",1,j),c=g.get(e,"m",j);f.$tempValue=e;this._setBGV(f,f._realstart=r,c);if(f.$selnode){f.$selnode.tagClass("-checked",false)}xui.arr.each(f.$daymap,function(s,m){if(g.get(s,"m",j)+"-"+g.get(s,"d",j)==g.get(e,"m",j)+"-"+g.get(e,"d",j)){l=m;return false}});d=this._getTDNodes(f).get()[l];(f.$selnode=xui([d]).tagClass("-checked"));f.getSubNode("SET").css("display",(b||n.getTime()==e.getTime())?"none":"block");f.getSubNode("CAPTION").css("color",(b||n.getTime()==e.getTime())?"":"#ff0000");o=g.get(e,"y",j);if(f.$year!=o){f.$year=o;f.getSubNode("YEAR").html(o,false)}o=g.get(e,"m",j)+1;if(f.$month!=o){f.$month=o;f.getSubNode("MONTH").html((o<=9?"0":"")+o,false)}o=g.get(e||e,"d",j);if(f.$day!=o){f.$day=o;f.getSubNode("DAY").html((o<=9?"0":"")+o,false)}o=g.get(e,"h",j);if(f.$hour!=o){f.$hour=o;f.getSubNode("HOUR").html((o<=9?"0":"")+o,false)}o=g.get(e,"n",j);if(f.$minute!=o){f.$minute=o;f.getSubNode("MINUTE").html((o<=9?"0":"")+o,false)}},_ondown:function(b,c,d,a){if(xui.Event.getBtn(c)!="left"){return}xui.use(d).startDrag(c,{dragType:"blank",targetReposition:false,widthIncrement:a,dragCursor:true});b.$temp=b.$temp2=0},_ondrag:function(d,b,a,c,f){var g=d.properties,e,j=xui.DragDrop.getProfile().offset;e=parseInt(f,10)+(parseInt(j.x/b,10)%a);e=(e%a+a)%a;if(d.$temp!=e){d.$temp=e;d.$temp2=e-f;d.getSubNode(c).html((e<=9?"0":"")+e,false)}},_onds:function(c,f,g,b){if(c.$temp2){var d=c.properties,a=xui.Date.add(c.$tempValue,b,c.$temp2);c.box._to(c,a)}c.$temp=c.$temp2=0},_onresize:function(){}}});xui.Class("xui.UI.TimePicker",["xui.UI","xui.absValue"],{Dependencies:["xui.Date"],Instance:{activate:function(){this.getSubNode("PRE").focus(true);return this},_setCtrlValue:function(a){return this.each(function(d){if(!d.renderId){return}var b=d.box,c=b._v2a(a);d.$hour=c[0];d.$minute=c[1];d.getSubNode("HI",true).removeClass(b._excls_c3).removeClass(b._excls_mo3);d.getSubNode("HI",c[0]).addClass(b._excls_c3);d.getSubNode("MI",true).removeClass(b._excls_c).removeClass(b._excls_mo);d.getSubNode("MI",c[1]).addClass(b._excls_c);d.getSubNode("HOUR").html(c[0],false);d.getSubNode("MINUTE").html(c[1],false);d.getSubNode("CAPTION").html(d.box._showV(d,d.box._v2a(c)),false)})}},Initialize:function(){this.addTemplateKeys(["HI","MI"]);var e,g,j,c,d,b,l,f;d=this._excls3;b=this._excls4;l=xui.UI.$ID;f='<span id="'+this.KEY+"-HI:"+l+':@" class="xui-node xui-node-span '+d+' !" '+xui.$IEUNSELECTABLE()+" >@</span>";e=[];for(g=0;g<24;g++){e[e.length]=f.replace(/@/g,g<10?("0"+g):g).replace("!",((g%6===0)?b:"")+" xui-custom {comcls}");if(g+1==12){e[e.length]="<br />"}}j=e.join("");e.length=0;d=this._excls;b=this._excls2;l=xui.UI.$ID;f='<span id="'+this.KEY+"-MI:"+l+':@" class="xui-node xui-node-span '+d+' !" '+xui.$IEUNSELECTABLE()+" >@</span>";e=[];for(g=0;g<60;g++){e[e.length]=f.replace(/@/g,g<10?("0"+g):g).replace("!",((g%5===0)?b:"")+" xui-custom {comcls}");if((g+1)%10===0&&g!=59){e[e.length]="<br />"}}c=e.join("");e.length=0;this.setTemplate({tagName:"div",style:"{_style};height:auto;",BORDER:{tagName:"div",className:"xui-uiborder-outset xui-uiborder-box xui-uiborder-radius-big",BART:{tagName:"div",className:"xui-uibar-top",style:"{barDisplay};",BARTDL:{className:"xui-uibar-tdl xui-uibar xui-uiborder-radius-big-tl",BARTDLT:{className:"xui-uibar-tdlt"}},BARTDM:{$order:1,className:"xui-uibar-tdm xui-uibar",BARTDMT:{className:"xui-uibar-tdmt"}},BARTDR:{$order:2,className:"xui-uibar-tdr xui-uibar xui-uiborder-radius-big-tr",BARTDRT:{className:"xui-uibar-tdrt"}},BARCMDL:{$order:3,tagName:"div",className:"xui-uibar-cmdl",PRE2:{$order:0,className:"xuifont",$fonticon:"xui-icon-doubleleft",tabindex:"{tabindex}"},PRE:{$order:1,className:"xuifont",$fonticon:"xui-icon-singleleft",tabindex:"{tabindex}"},HOUR:{$order:2,className:"xui-ui-draggable xui-uibase xui-uiborder-flat xui-uiborder-radius"},MTXT:{$order:3,text:":"},MINUTE:{$order:4,className:"xui-ui-draggable xui-uibase xui-uiborder-flat xui-uiborder-radius"},NEXT:{$order:6,className:"xuifont",$fonticon:"xui-icon-singleright",tabindex:"{tabindex}"},NEXT2:{$order:7,className:"xuifont",$fonticon:"xui-icon-doubleright",tabindex:"{tabindex}"}},BARCMDR:{$order:4,tagName:"div",className:"xui-uibar-cmdr",CLOSE:{className:"xuifont",$fonticon:"xui-uicmd-close",style:"{closeDisplay}"}},TBARTDB:{$order:5,tagName:"div",className:"xui-uibar-tdb xui-uiborder-inset xui-uiborder-radius"}},MAIN:{$order:2,tagName:"div",className:"xui-uicon-main xui-uibar",MAINI:{tagName:"div",className:"xui-uibar xui-uicon-maini xui-uibar",CONH:{tagName:"div",className:"xui-uibase xui-uiborder-flat",text:j},CONM:{$order:2,tagName:"div",className:"xui-uibase xui-uiborder-flat",text:c}}},TAIL:{$order:3,tagName:"div",className:"xui-uicon-main xui-uibar",TAILI:{tagName:"div",className:"xui-uibar xui-uicon-maini",CAPTION:{text:"{caption}"},SET:{tagName:"button",className:"xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius",tabindex:"{tabindex}",text:"{_set}"}}},BBAR:{$order:4,tagName:"div",className:"xui-uibar-bottom-s",BBARTDL:{className:"xui-uibar-tdl xui-uibar xui-uiborder-radius-big-bl"},BBARTDM:{$order:1,className:"xui-uibar-tdm xui-uibar"},BBARTDR:{$order:2,className:"xui-uibar-tdr xui-uibar xui-uiborder-radius-big-br"}}}})},Static:{_excls:"xuiex-timepicker xui-uicell",_excls2:"xuiex-timepicker xui-uicell xui-uicell-alt ",_excls3:"xuiex-timepicker3 xui-uicell",_excls4:"xuiex-timepicker xui-uicell xui-uicell-alt",_excls_mo:"xui-uicell-hover",_excls_c:"xui-uicell-checked",_excls_mo3:"xui-uicell-hover",_excls_c3:"xui-uicell-checked",_mover:function(d,c){var a=this,e=d.className;if(c==2){if(e.indexOf(a._excls_mo3)==-1){d.className=e+" "+a._excls_mo3}}else{if(e.indexOf(a._excls_mo)==-1){d.className=e+" "+a._excls_mo}}d=null},_mout:function(d,c){var a=this,e=d.className;if(c==2){if(e.indexOf(a._excls_mo3)!=-1){d.className=e.replace(a._excls_mo3,"")}}else{if(e.indexOf(a._excls_mo)!=-1){d.className=e.replace(a._excls_mo,"")}}d=null},Appearances:{KEY:{},"TBART, BBART":{"border-spacing":0,"border-collapse":"separate"},MAINI:{padding:".5em .3333em .3333em 0"},CONH:{"white-space":"nowrap","text-align":"center"},CONM:{"margin-top":".5em","white-space":"nowrap","text-align":"center"},BARCMDL:{top:".125em"},"PRE,PRE2,NEXT,NEXT2":{position:"relative",margin:"0 .25em","vertical-align":"middle",cursor:"default"},"HOUR, MINUTE":{$order:3,"font-weight":"bold","vertical-align":"middle",cursor:"e-resize",margin:"0 .25em",padding:"0 .25em"},SET:{position:"absolute",display:"none",top:".125em",right:".5em"},TAILI:{position:"relative",padding:".5em 0 0 0","text-align":"center"},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle","font-size":"1em"},".xuiex-timepicker":{width:"2em","text-align":"center",padding:".25em 0",margin:0},".xuiex-timepicker3":{width:"1.6666em","text-align":"center","font-weight":"bold",padding:".25em 0",margin:0}},Behaviors:{HoverEffected:{CLOSE:"CLOSE",PRE:"PRE",NEXT:"NEXT",PRE2:"PRE2",NEXT2:"NEXT2",SET:"SET"},ClickEffected:{CLOSE:"CLOSE",PRE:"PRE",NEXT:"NEXT",PRE2:"PRE2",NEXT2:"NEXT2",SET:"SET"},KEY:{onClick:function(){return false}},HOUR:{beforeMousedown:function(a,b,c){if(xui.Event.getBtn(b)!="left"){return}xui(c).startDrag(b,{dragType:"blank",targetReposition:false,widthIncrement:5,dragCursor:true});a.$temp2=0},onDrag:function(d,g,l){var f,j=xui.DragDrop.getProfile().offset,c=d.properties.$UIvalue,b=c.split(":");b[0]=Math.round((parseFloat(b[0])||0)+parseInt(j.x/10));b[0]=(b[0]%24+24)%24;d.$temp2=(b[0]<=9?"0":"")+b[0];if(c[0]!=d.$temp2){d.getSubNode("HOUR").html(d.$temp2,false)}},onDragstop:function(a,b,c){if(a.$temp2){a.$hour=a.$temp2;a.boxing()._setCtrlValue(a.$hour+":"+a.$minute)}a.$temp2=0;a.box._hourC(a)}},MINUTE:{beforeMousedown:function(a,b,c){if(xui.Event.getBtn(b)!="left"){return}xui(c).startDrag(b,{dragType:"blank",targetReposition:false,widthIncrement:5,dragCursor:true});a.$temp2=0},onDrag:function(d,g,l){var f,j=xui.DragDrop.getProfile().offset,c=d.properties.$UIvalue,b=c.split(":");b[0]=Math.round((parseFloat(b[0])||0)+parseFloat(j.x/20));b[0]=(b[0]%60+60)%60;d.$temp2=(b[0]<=9?"0":"")+b[0];if(c[0]!=d.$temp2){d.getSubNode("MINUTE").html(d.$temp2,false)}},onDragstop:function(a,b,c){if(a.$temp2){a.$minute=a.$temp2;a.boxing()._setCtrlValue(a.$hour+":"+a.$minute)}a.$temp2=0;a.box._hourC(a)}},SET:{onClick:function(d){var e=d.properties,c=e.$UIvalue,b=c.split(":");b[0]=d.$hour;b[1]=d.$minute;d.boxing().setUIValue(b.join(":"),true,null,"click");if(d.box){d.box._hourC(d)}}},HI:{onMouseover:function(a,b,c){if(a.properties.disableHoverEffect){return}a.box._mover(xui.use(c).get(0),2)},onMouseout:function(a,b,c){if(a.properties.disableHoverEffect){return}a.box._mout(xui.use(c).get(0),2)},onClick:function(a,b,c){a.$hour=a.getSubId(c);a.boxing()._setCtrlValue(a.$hour+":"+a.$minute);if(a.box){a.box._hourC(a)}},onDblclick:function(a,b,c){a.$hour=a.getSubId(c);a.boxing().setUIValue(a.$hour+":"+a.$minute,true,null,"dblclick");if(a.box){a.box._hourC(a)}}},MI:{onMouseover:function(a,b,c){if(a.properties.disableHoverEffect){return}a.box._mover(xui.use(c).get(0))},onMouseout:function(a,b,c){if(a.properties.disableHoverEffect){return}a.box._mout(xui.use(c).get(0))},onClick:function(a,b,c){a.$minute=a.getSubId(c);a.boxing().setUIValue(a.$hour+":"+a.$minute,true,null,"click2");if(a.box){a.box._hourC(a)}}},PRE:{onClick:function(b,d,f){var c=b.properties;if(c.disabled||c.readonly){return}var a=b.$minute;a=(parseFloat(a)||0)-1;a=(a%60+60)%60;b.$minute=a=(a<=9?"0":"")+a;b.boxing()._setCtrlValue(b.$hour+":"+b.$minute);if(b.box){b.box._hourC(b)}}},NEXT:{onClick:function(b,d,f){var c=b.properties;if(c.disabled||c.readonly){return}var a=b.$minute;a=(parseFloat(a)||0)+1;a=(a%60+60)%60;b.$minute=a=(a<=9?"0":"")+a;b.boxing()._setCtrlValue(b.$hour+":"+b.$minute);if(b.box){b.box._hourC(b)}}},PRE2:{onClick:function(b,d,f){var c=b.properties;if(c.disabled||c.readonly){return}var a=b.$hour;a=(parseFloat(a)||0)-1;a=(a%24+24)%24;b.$hour=a=(a<=9?"0":"")+a;b.boxing()._setCtrlValue(b.$hour+":"+b.$minute);if(b.box){b.box._hourC(b)}}},NEXT2:{onClick:function(b,d,f){var c=b.properties;if(c.disabled||c.readonly){return}var a=b.$hour;a=(parseFloat(a)||0)+1;a=(a%24+24)%24;b.$hour=a=(a<=9?"0":"")+a;b.boxing()._setCtrlValue(b.$hour+":"+b.$minute);if(b.box){b.box._hourC(b)}}},CLOSE:{onClick:function(c,d,f){var b=c.properties,a=c.boxing();if(b.disabled||b.readonly){return}if(false===a.beforeClose(c,f)){return}a.destroy(true)}}},DataModel:{expression:{ini:"",action:function(){}},height:{ini:"auto",readonly:true},width:{ini:"auto",readonly:true},value:{ini:"00:00",format:"time"},closeBtn:{ini:true,action:function(a){this.getSubNode("CLOSE").css("display",a?"":"none")}}},EventHandlers:{beforeClose:function(a,b){}},_hourC:function(e){var g=e.properties,c=g.$UIvalue,b=c.split(":"),f=(b[0]+"")==(e.$hour+"")&&(b[1]+"")==(e.$minute+"");e.getSubNode("SET").css("display",f?"none":"block");e.getSubNode("CAPTION").css("color",f?"":"#ff0000")},_prepareData:function(b){var c=arguments.callee.upper.call(this,b);var a="display:none";c.closeDisplay=c.closeBtn?"":a;c._set=xui.wrapRes("inline.set");return c},_ensureValue:function(e,f){var d,c=[];if(f&&typeof f=="string"){d=f.split(":")}else{if(f&&typeof f=="object"&&xui.isArr(f)){d=f}else{d=[]}}c[0]=parseFloat(d[0])||0;c[1]=parseFloat(d[1])||0;if(c[0]<0){c[0]=0}if(c[0]>23){c[0]=23}if(c[1]<0){c[1]=0}if(c[1]>59){c[1]=59}c[0]=(c[0]<=9?"0":"")+c[0];c[1]=(c[1]<=9?"0":"")+c[1];return c.join(":")},formatValue:function(a){return a.join(":")},_v2a:function(a){return typeof a=="string"?a.split(":"):a},_showV:function(c,b){var d=c.CF;if(typeof d.formatCaption=="function"){return d.formatCaption(b)}else{return b.join(":")}},_onresize:function(){}}});xui.Class("xui.UI.List",["xui.UI","xui.absList","xui.absValue"],{Instance:{_setCtrlValue:function(a){return this.each(function(d){if(!d.renderId){return}var j=d.box,D=d.boxing().getUIValue(),r=d.properties,B=j._ITEMKEY||"ITEM",w=j._DIRTYKEY||"ITEM",x="MARK",b=function(e,o){return d.getSubNode(e,o)},c=function(e){return d.getSubIdByItemId(e)};if(r.selMode=="single"){var l=c(D);if(D!==null&&l){b(B,l).tagClass("-checked",false).tagClass("-hover",false);b(x,l).tagClass("-checked",false)}l=c(a);if(l){b(B,l).tagClass("-checked");b(x,l).tagClass("-checked")}try{if(l){var s=b(B,l);if(s){var q=d.getSubNode("ITEMS"),g=s.offset(null,q),m=g?g.top:0,n=s.offsetHeight(),C=q.scrollHeight(),u=q.scrollTop(),f=q.height();if(C>f){if(m<u||(m+n)>(u+f)){q.scrollTop(m)}}}}}catch(A){console.warn(A)}}else{if(r.selMode=="multi"||r.selMode=="multibycheckbox"){D=D?D.split(r.valueSeparator):[];a=a?a.split(r.valueSeparator):[];xui.arr.each(D,function(e){b(B,c(e)).tagClass("-checked",false).tagClass("-hover",false);b(x,c(e)).tagClass("-checked",false)});xui.arr.each(a,function(e){b(B,c(e)).tagClass("-checked");b(x,c(e)).tagClass("-checked")})}}})},_clearMouseOver:function(){var b=this.constructor,a=b._ITEMKEY||"ITEM";this.getSubNode(a,true).tagClass("-hover",false)},adjustSize:function(){return this.each(function(j){var c=j.getRoot(),d=j.getSubNode("ITEMS"),b=j.properties,e=b.maxHeight,g=j.$isEm(b.height),f,a;if(j.$isEm(e)){e=j.$em2px(e,d,true)}if(c.css("display")=="none"){a=1;c.css("visibility","hidden")}d.height("auto");if(j.properties.height!="auto"){f=Math.min(e,d.offsetHeight());if(g){f=j.$px2em(f,d)+"em"}d.height(b.height=f)}else{f=d.offsetHeight();if(f>e){d.height(b.maxHeight);j.getRoot().height(b.maxHeight)}}if(a){c.css("visibility","");c.css("display","none")}j.getRoot().height("auto")})},activate:function(){return xui.absList.prototype.activate.call(this)},setCaptionValue:function(c){var b=arguments.callee.upper,a=b.apply(this,xui.toArr(arguments));b=null},getCaptionValue:function(){var b=arguments.callee.upper,a=b.apply(this,xui.toArr(arguments));b=null;return a},getSelectedItem:function(){var b=arguments.callee.upper,a=b.apply(this,xui.toArr(arguments));b=null;return a},getShowValue:function(d){var c=this.get(0),e=c.properties,a,b;if(!xui.isDefined(d)){d=e.$UIvalue}if((a=xui.arr.subIndexOf(e.items,"id",d))!=-1){a=e.items[a].caption;a=a.charAt(0)=="$"?xui.getRes(a.slice(1)):a}else{a=""}return a},_setDirtyMark:function(){return arguments.callee.upper.apply(this,["ITEMS"])}},Static:{_DIRTYKEY:"ITEM",Templates:{tagName:"div",style:"{_style}",className:"{_className}",LABEL:{className:"{_required} xui-ui-ellipsis",style:"{labelShow};width:{_labelSize};{_labelHAlign};{_labelVAlign}",text:"{labelCaption}"},ITEMS:{$order:10,tagName:"div",className:"xui-uibase {_cmdsalign} {_bordertype} {_itemscls1}",text:"{items}"},$submap:{items:{ITEM:{className:"xui-uitembg xui-uiborder-radius xui-showfocus {_itemRow} {_split} {itemClass} {disabled} {readonly}",style:"{itemStyle}{_itemDisplay}",tabindex:"{_tabindex}",LTAGCMDS:{$order:2,tagName:"span",style:"{_ltagDisplay}",text:"{ltagCmds}"},MARK:{$order:5,className:"xuifont",$fonticon:"xui-uicmd-check",style:"{_cbDisplay}"},ICON:{$order:10,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{style:"{_capDisplay}",text:"{caption}",$order:20},EXTRA:{style:"{_extraDisplay}",text:"{ext}",$order:30},RTAGCMDS:{$order:40,tagName:"span",style:"{_rtagDisplay}",text:"{rtagCmds}"},OPT:{$order:50,style:"{_optDisplay}",className:"xuifont",$fonticon:"{_fi_optClass}"}}},"items.ltagCmds":function(e,d,c,b,a){var f=arguments.callee,g=f._m||(f._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(e,d,c,"items.tagCmds"+(g[c.type]||".button"),a)},"items.rtagCmds":function(e,d,c,b,a){var f=arguments.callee,g=f._m||(f._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(e,d,c,"items.tagCmds"+(g[c.type]||".button"),a)},"items.tagCmds.text":xui.UI.$getTagCmdsTpl("text"),"items.tagCmds.button":xui.UI.$getTagCmdsTpl("button"),"items.tagCmds.image":xui.UI.$getTagCmdsTpl("image")}},Appearances:{KEY:{},LABEL:{"z-index":1,top:0,left:0,display:xui.browser.isWebKit?"-webkit-flex":"flex",position:"absolute","padding-top":".333em"},EXTRA:{display:"none"},ITEMS:{position:"relative",overflow:"auto","overflow-x":"hidden"},ITEM:{display:"block",zoom:xui.browser.ie?1:null,cursor:"pointer",position:"relative","white-space":"nowrap"},MARK:{$order:1,cursor:"pointer","vertical-align":"middle"},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle",padding:".167em","font-size":"1em","white-space":"normal"},OPT:{$order:10,position:"absolute",left:"auto",top:"50%","margin-top":"-0.5em",right:".167em",display:"none"},"LTAGCMDS, RTAGCMDS":{padding:0,margin:0,"vertical-align":"middle"},"ITEMS-tagcmdleft RTAGCMDS":{"padding-right":".333em","float":"left"},"ITEMS-tagcmdfloatright RTAGCMDS":{"padding-right":".333em","float":"right"}},Behaviors:{HoverEffected:{ITEM:"ITEM",OPT:"OPT",CMD:"CMD",ICON:"ICON"},ClickEffected:{ITEM:"ITEM",OPT:"OPT",CMD:"CMD"},DraggableKeys:["ITEM"],DroppableKeys:["ITEM","ITEMS"],ITEM:{onDblclick:function(b,d,f){var a=b.properties,c=b.getItemByDom(f);b.boxing().onDblclick(b,c,d,f)},onClick:function(b,l,a){var n=b.properties,u=b.getItemByDom(a),o=b.getSubId(a),j=b.boxing(),r=xui.Event.getKey(l);if(b.beforeClick&&false===j.beforeClick(b,u,l,a)){return false}if(n.disabled||u.disabled||u.type=="split"){return false}if(b.onClick){j.onClick(b,u,l,a)}xui.use(a).focus(true);switch(n.selMode){case"none":j.onItemSelected(b,u,l,a,0);break;case"multibycheckbox":if(n.readonly||u.readonly){return false}var s=j.getUIValue(),g=s?s.split(n.valueSeparator):[],q=1;if(g.length){if(xui.arr.indexOf(g,u.id)!=-1){xui.arr.removeValue(g,u.id);q=-1}else{g.push(u.id)}g.sort();s=g.join(n.valueSeparator);if(j.getUIValue()!==s){j.setUIValue(s,null,null,"click");if(j.get(0)&&j.getUIValue()==s){j.onItemSelected(b,u,l,a,q)}}break}case"multi":if(n.readonly||u.readonly){return false}var s=j.getUIValue(),g=s?s.split(n.valueSeparator):[],q=1;if(g.length&&(r.ctrlKey||r.shiftKey||n.noCtrlKey||n.$checkbox)){if(r.shiftKey){var m=n.items,d=xui.arr.subIndexOf(m,"id",b.$firstV.id),c=xui.arr.subIndexOf(m,"id",u.id),f;g.length=0;for(f=Math.min(d,c);f<=Math.max(d,c);f++){g.push(m[f].id)}}else{if(xui.arr.indexOf(g,u.id)!=-1){xui.arr.removeValue(g,u.id);q=-1}else{g.push(u.id)}}g.sort();s=g.join(n.valueSeparator);if(j.getUIValue()!==s){j.setUIValue(s,null,null,"click");if(j.get(0)&&j.getUIValue()==s){j.onItemSelected(b,u,l,a,q)}}break}case"single":if(n.readonly||u.readonly){return false}if(j.getUIValue()!==u.id){b.$firstV=u;j.setUIValue(u.id,null,null,"click");if(j.get(0)&&j.getUIValue()==u.id){j.onItemSelected(b,u,l,a,1)}}break}if(b.afterClick){j.afterClick(b,u,l,a)}},onKeydown:function(c,g,a){var n=xui.Event.getKey(g),m=n[0],b=n[2],l=xui(a),f=c.getRoot().nextFocus(true,true,false),j=c.getRoot().nextFocus(false,true,false);switch(xui.Event.getKey(g)[0]){case"tab":if(b){if(l.get(0)!=f.get(0)){f.focus(true);return false}}else{if(l.get(0)!=j.get(0)){j.focus(true);return false}}break;case"left":case"up":var d=l.nextFocus(false,true,false);if(l.get(0)==f.get(0)){j.focus(true)}else{l.nextFocus(false)}return false;break;case"right":case"down":var d=l.nextFocus(true,false,false);if(l.get(0)==j.get(0)){f.focus(true)}else{l.nextFocus()}return false;break;case"enter":l.onClick(true);break}},onContextmenu:function(a,b,c){if(a.onContextmenu){return a.boxing().onContextmenu(a,b,c,a.getItemByDom(c),xui.Event.getPos(b))!==false}},onMouseover:function(a,c,d){if(xui.browser.fakeTouch||xui.browser.deviceType=="touchOnly"){return}var b=a.getItemByDom(d);if(!b){return}if(!a.properties.optBtn&&!b.optBtn){return}a.getSubNode("OPT",a.getSubId(d)).setInlineBlock()},onMouseout:function(a,c,d){if(xui.browser.fakeTouch||xui.browser.deviceType=="touchOnly"){return}var b=a.getItemByDom(d);if(!b){return}if(!a.properties.optBtn&&!b.optBtn){return}a.getSubNode("OPT",a.getSubId(d)).css("display","none")}},OPT:{onClick:function(a,c,d){if(a.onShowOptions){var b=a.getItemByDom(d);if(!b){return}if(!a.properties.optBtn&&!b.optBtn){return}a.boxing().onShowOptions(a,b,c,d)}return false},onDblclick:function(a,b,c){return false}},CMD:{onClick:function(a,c,d){var f=a.properties,b=a.getItemByDom(xui.use(d).parent().get(0));if(!b){return false}if(f.disabled||b.disabled||b.type=="split"){return false}if(a.onCmd){a.boxing().onCmd(a,b,xui.use(d).id().split("_")[1],c,d)}return false}},LABEL:{onClick:function(a,b,c){if(a.properties.disabled){return false}if(a.onLabelClick){a.boxing().onLabelClick(a,b,c)}},onDblClick:function(a,b,c){if(a.properties.disabled){return false}if(a.onLabelDblClick){a.boxing().onLabelDblClick(a,b,c)}},onMousedown:function(a,b,c){if(xui.Event.getBtn(b)!="left"){return}if(a.properties.disabled){return false}if(a.onLabelActive){a.boxing().onLabelActive(a,b,c)}}}},DataModel:{expression:{ini:"",action:function(){}},selMode:{ini:"single",listbox:["single","none","multi","multibycheckbox"],action:function(a){if(!this.box._ITEMMARKED){this.getSubNode("MARK",true).css("display",(a=="multi"||a=="multibycheckbox")?"":"none")}}},borderType:{ini:"flat",listbox:["none","flat","inset","outset"],action:function(b){var d=this,g=d.properties,e=d.getSubNode("ITEMS"),c=/^xui-uiborder-/,f="xui-uiborder-",a=d.getRoot();e.removeClass(c);e.addClass(f+b);d.adjustSize()}},noCtrlKey:true,width:{$spaceunit:1,ini:"10em"},height:{$spaceunit:1,ini:"15em"},maxHeight:420,itemRow:{ini:"",combobox:["row","cell"],action:function(a){var b=this.getSubNode("ITEM",true);b.removeClass(/xui-item-[\w]+/);if(a){b.addClass("xui-item-"+(a||"row"))}}},optBtn:{ini:"",combobox:xui.toArr("xui-uicmd-opt,xui-icon-singleright"),action:function(){this.boxing().refresh()}},tagCmds:{ini:[],action:function(){this.boxing().refresh()}},tagCmdsAlign:{ini:"right",listbox:["left","right","floatright"],action:function(b){var c=this,d=c.getSubNode("ITEMS"),a=c.getClass("ITEMS","-tagcmd");d.removeClass(new RegExp(a+"[w]*")).addClass(c.getClass("ITEMS","-tagcmd"+b))}},labelSize:{$spaceunit:2,ini:0,action:function(a){this.getSubNode("LABEL").css({display:a?"":"none"});xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelPos:{ini:"left",listbox:["none","left","top","right","bottom"],action:function(a){xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelGap:{$spaceunit:2,ini:4,action:function(a){xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelCaption:{ini:"",action:function(a){a=(xui.isSet(a)?a:"")+"";this.getSubNode("LABEL").html(xui.adjustRes(a,true))}},labelHAlign:{ini:"right",listbox:["","left","center","right"],action:function(a){this.getSubNode("LABEL").css({textAlign:a||"",justifyContent:a=="right"?"flex-end":a=="center"?"center":a=="left"?"flex-start":""})}},labelVAlign:{ini:"top",listbox:["","top","middle","bottom"],action:function(a){this.getSubNode("LABEL").css("align-items",a=="bottom"?"flex-end":a=="middle"?"center":a=="top"?"flex-start":"")}}},EventHandlers:{onClick:function(a,b,c,d){},onCmd:function(a,b,d,c,f){},beforeClick:function(a,b,c,d){},afterClick:function(a,b,c,d){},onDblclick:function(a,b,c,d){},onShowOptions:function(a,b,c,d){},onItemSelected:function(b,c,d,f,a){},onLabelClick:function(a,b,c){},onLabelDblClick:function(a,b,c){},onLabelActive:function(a,b,c){}},_onStartDrag:function(a,b,c,d){var d=xui.Event.getPos(b);xui.use(c).startDrag(b,{dragSource:a.$xid,dragType:"icon",shadowFrom:c,targetLeft:d.left+12,targetTop:d.top+12,dragCursor:"pointer",dragDefer:2,dragKey:a.box.getDragKey(a,c),dragData:a.box.getDragData(a,b,c)});return false},_onDropTest:function(b,g,l,a,d,c){var j=d&&d.domId,f=xui.use(l).id();if(j){if(j==f){return false}if(xui.get(xui.use(l).get(0),["previousSibling","id"])==j){return false}}},_onDrop:function(d,l,b,n,j,q){var g=d.getKey(xui.use(b).id()),c=j.profile,a=j.domId,f,o=xui.absObj.$specialChars,m=d.properties.$UIvalue;f=xui.clone(c.getItemByDom(a),function(r,e){return !o[(e+"").charAt(0)]});c.boxing().removeItems([f.id]);if(g==d.keys.ITEM){d.boxing().insertItems([f],q.id,true)}else{d.boxing().insertItems([f])}if(f.id==m){d.boxing().setUIValue(f.id,true,null,"drop")}j._new=f;return false},_prepareData:function(c){var e=arguments.callee.upper.call(this,c),b,a;e._bordertype="xui-uiborder-"+e.borderType;e._labelHAlign="text-align:"+(a=e.labelHAlign||"")+";justify-content:"+(a=="right"?"flex-end":a=="center"?"center":a=="left"?"flex-start":"");e._labelVAlign="align-items:"+((a=e.labelVAlign)=="bottom"?"flex-end":a=="middle"?"center":a=="top"?"flex-start":"");e.labelShow=e.labelPos!="none"&&e.labelSize&&e.labelSize!="auto"?"":"display:none";e._labelSize=e.labelSize?"":0+c.$picku();if(e.labelCaption){e.labelCaption=xui.adjustRes(e.labelCaption,true)}e._cmdsalign=c.getClass("ITEMS","-tagcmd"+c.properties.tagCmdsAlign);return e},_prepareItem:function(c,d){var e=c.properties,a=e.selMode,b;d._cbDisplay=(a=="multi"||a=="multibycheckbox")?"":"display:none;";d._itemRow=(b=c.properties.itemRow)?("xui-item-"+b):"";if(xui.browser.fakeTouch||xui.browser.deviceType!=="mouseOnly"){d._optDisplay=e.optBtn?"display:block;":""}d._fi_optClass=e.optBtn;if(d.type=="split"){d._split="xui-uitem-split";d._ltagDisplay=d._rtagDisplay=d.imageDisplay=d._cbDisplay=d._capDisplay=d._extraDisplay=d._optDisplay="display:none;"}this._prepareCmds(c,d)},RenderTrigger:function(){if(this.key!="xui.UI.List"){return}var a=this.properties;xui.UI.$doResize(this,a.width,a.height)},_onresize:function(c,u,o){var b=c.properties,m=xui.$us(c),F=function(f,H){return c.$forceu(f,m>0?"em":"px",H)},w=c.getRoot(),s=xui.browser.contentBox,D=function(f){return c.getSubNode(f)},q=D("ITEMS"),l=D("LABEL"),B=c.getEmSize()/w._getEmSize(),g=q._getEmSize(B),e=l._getEmSize(B),x=!s?0:b.borderType!="none"?q._borderW():0,A=b.dock,C=b.maxHeight,r=b.labelPos,j=(r=="none"||!r)?0:c.$px(b.labelSize,e)||0,E=(r=="none"||!r)?0:c.$px(b.labelGap)||0,n,a,G,d;if(u&&u!="auto"){u=c.$px(u)}if(o&&o!="auto"){o=c.$px(o)}q.cssRegion({left:F(n=r=="left"?j:0,g),top:F(a=r=="top"?j:0,g),width:F(G=u===null?null:u=="auto"?u:Math.max(0,(u-(!s?0:q._paddingW("both"))-((r=="left"||r=="right")?j:0)-x)),g),height:F(d=o===null?null:o=="auto"?o:Math.max(0,(o-(!s?0:q._paddingH("both"))-((r=="top"||r=="bottom")?j:0)-x)),g)});if(o=="auto"){if(A!="fill"&&A!="cover"&&A!="height"&&A!="left"&&A!="right"){if(q.height()>C){q.height(F(C,g));w.height("auto")}}}if(j){if(u=="auto"){G=q.offsetWidth()}if(o=="auto"){d=q.offsetHeight()}l.cssRegion({left:F(u===null?null:Math.max(0,r=="right"?((u=="auto"?G:(u-j))+E):0),e),top:F(o===null?null:Math.max(0,r=="bottom"?((o=="auto"?d:(o-j))+E):0),e),width:F(u===null?null:Math.max(0,((r=="left"||r=="right")?(j-E):(u=="auto"?G:u))),e),height:F(o===null?null:Math.max(0,((r=="top"||r=="bottom")?(j-E):(o=="auto"?d:o))),e)})}}}});xui.Class("xui.UI.Gallery","xui.UI.List",{Instance:{getStatus:function(b){var a=this.get(0).getItemByItemId(b);return(a&&a._status)||"ini"},_afterInsertItems:function(a){a.getSubNodes("IMAGE",true).each(function(b){if(b.src==xui.ini.img_bg){if(xui.browser.isFF){b.src=""}b.src=b.title;b.title=""}})},updateItemData:function(a,b){this.get(0).box._prepareItem(this.get(0),b);this.get(0).boxing().refresh()}},Initialize:function(){var b=this.getTemplate();b.$submap={items:{ITEM:{tabindex:"{_tabindex}",className:"xui-uitembg xui-uiborder-radius xui-showfocus {itemClass} {disabled} {readonly}",style:"padding:{itemPadding};margin:{itemMargin};{_itemSize};{itemStyle}{_itemColor}",ITEMFRAME:{style:"{_inneritemSize};{_bgimg}; {_itemposition}",COMMENT:{tagName:"div",className:"xui-ui-ellipsis",text:"{comment}",style:"{commentDisplay};{_fontColor}",$order:2},CONTENT:{tagName:"div",$order:1,className:"{contentClass}",style:"{_loadbg}",ICON:{className:"xuifont {_imageClass}",style:"{_fontSize};{_iconColor};{_icon};{_position};}",text:"{iconFontCode}"},IMAGE:{tagName:"img",src:xui.ini.img_bg,title:"{image}",style:"{_innerimgSize};{imgStyle}"}},CAPTION:{tagName:"div",className:"xui-ui-ellipsis",style:"{capDisplay}",text:"{caption}",$order:0}},FLAG:{$order:20,className:"xui-display-none {flagClass}",style:"{_flagStyle};{flagStyle}",text:"{flagText}"},EXTRA:{text:"{ext}",$order:30}}}};this.setTemplate(b);xui.UI.IconList=xui.UI.Gallery;var a="xui.UI.IconList";xui.absBox.$type[a.replace("xui.UI.","")]=xui.absBox.$type[a]=a},Static:{IMGNODE:1,Appearances:{EXTRA:{display:"none"},KEY:{overflow:"visible"},ITEMS:{position:"relative",overflow:"auto","overflow-x":"hidden",zoom:xui.browser.ie6?1:null},"ITEMS-nowrap":{"white-space":"nowrap"},ITEM:{display:xui.$inlineBlock,zoom:xui.browser.ie67?1:null,position:"relative",cursor:"pointer","vertical-align":"top",margin:0},ITEMFRAME:{display:xui.browser.ie67?xui.$inlineBlock:"block",zoom:xui.browser.ie67?1:null,position:"relative",overflow:"hidden",border:0,padding:0,margin:0,"-moz-box-flex":"1"},IBWRAP:{},IMAGE:{display:xui.$inlineBlock,zoom:xui.browser.ie6?1:null,visibility:"hidden","vertical-align":"middle"},CAPTION:{"text-align":"center",overflow:"hidden","white-space":"nowrap","font-weight":"bold","font-size":"20px","margin-top":"15px",height:"35px"},CONTENT:{"text-align":"center","white-space":"nowrap","background-repeat":"no-repeat","font-size":"1em"},COMMENT:{display:"block",margin:".25em","text-align":"center","font-size":"1em"},FLAG:{width:"2em",height:"2em",right:"5em",top:"1em","font-size":"16px",color:"#eb6e1a",position:"absolute","z-index":10}},Behaviors:{IMAGE:{onLoad:function(d,g,a){var f=xui.use(a).get(0),n=f.src;if(n!=xui.ini.img_bg){var b=d.properties,m=xui.use(a),c=m.get(0),l=d.getItemByDom(a);if(!l){return}var j=d.getSubNodeByItemId("ICON",l.id);if(l.autoImgSize||b.autoImgSize){m.attr("width","");m.attr("height","")}else{m.attr("width",l.imgWidth);m.attr("height",l.imgWidth)}j.removeClass("xui-icon-loading");if(!l.iconFontCode&&!l.imageClass&&!l.icon){j.addClass("xui-display-none")}m.onLoad(null).onError(null).$removeEventHandler("load").$removeEventHandler("error");l._status="loaded";if(xui.ini.img_blank==n){c.style.visibility="hidden";c.style.display="none"}else{c.style.visibility="visible";c.style.display=""}}},onError:function(b,g,j){var d=b.getItemByDom(j);if(d._status=="error"){return}var f=b.properties,l=xui.use(j),c=l.get(0),a=b.getSubNodeByItemId("ICON",d.id);a.removeClass("xui-icon-loading xui-display-none").addClass("xui-load-error");l.onLoad(null).onError(null).$removeEventHandler("load").$removeEventHandler("error");c.style.visibility="hidden";c.style.display="none";d._status="error"}},ITEMS:{swipeleft:function(a,d,f){var c=a.getItemByDom(f),b=a.boxing();if(a.swipeleft){b.swipeleft(a,c,d,f);return false}},swiperight:function(a,c,d,f){var c=a.getItemByDom(f),b=a.boxing();if(a.swiperight){b.swipeleft(a,c,d,f);return false}},},ITEM:{swipeleft:function(a,d,f){var c=a.getItemByDom(f),b=a.boxing();if(a.swipeleft){b.swipeleft(a,c,d,f);return false}},swiperight:function(a,d,f){var c=a.getItemByDom(f),b=a.boxing();if(a.swiperight){b.swiperight(a,c,d,f);return false}},swipedown:function(a,d,f){var c=a.getItemByDom(f),b=a.boxing();if(a.swipedown){b.swipedown(a,c,d,f);return false}},swipeup:function(a,d,f){var c=a.getItemByDom(f),b=a.boxing();if(a.swipeup){b.swipeup(a,c,d,f);return false}}},FLAG:{onClick:function(a,d,f){var c=a.getItemByDom(f),b=a.boxing();if(a.onFlagClick){b.onFlagClick(a,c,d,f);return false}}}},DataModel:{tagCmds:null,expression:{ini:"",action:function(){}},bgimg:null,iotStatus:null,tagCmdsAlign:null,flagText:null,flagClass:null,flagStyle:null,iconColors:null,itemColors:null,fontColors:null,autoFontColor:{ini:false,action:function(){this.boxing().refresh()}},autoIconColor:{ini:true,action:function(){this.boxing().refresh()}},autoItemColor:{ini:false,action:function(){this.boxing().refresh()}},autoImgSize:{ini:false,action:function(){this.boxing().refresh()}},autoItemSize:{ini:true,action:function(){this.boxing().refresh()}},iconOnly:{ini:false,action:function(){this.boxing().refresh()}},iconFontSize:{ini:"",action:function(a){this.getSubNode("ICON",true).css("font-size",a)}},itemMargin:{ini:6,action:function(a){this.getSubNode("ITEM",true).css("margin",a||0)}},itemPadding:{ini:2,action:function(a){this.getSubNode("ITEM",true).css("padding",a||0)}},itemWidth:{$spaceunit:1,ini:32,action:function(a){this.getSubNode("ITEMFRAME",true).width(a||"")}},itemHeight:{$spaceunit:1,ini:32,action:function(a){this.getSubNode("ITEMFRAME",true).height(a||"")}},imgWidth:{ini:16,action:function(a){this.getSubNode("IMAGE",true).width(a||"")}},imgHeight:{ini:16,action:function(a){this.getSubNode("IMAGE",true).height(a||"")}},width:{$spaceunit:1,ini:"16rem"},height:{$spaceunit:1,ini:"16rem"},columns:{ini:0,action:function(){this.boxing().refresh()}},rows:{ini:0,action:function(){this.boxing().refresh()}}},EventHandlers:{onCmd:null,onFlagClick:function(a,b,c,d){},touchstart:function(a,b,c,d){},touchmove:function(a,b,c,d){},touchend:function(a,b,c,d){},touchcancel:function(a,b,c,d){},swipe:function(a,b,c,d){},swipeleft:function(a,b,c,d){},swiperight:function(a,b,c,d){},swipeup:function(a,b,c,d){},swipedown:function(a,b,c,d){},press:function(a,b,c,d){},pressup:function(a,b,c,d){}},_prepareData:function(b){var e=arguments.callee.upper.call(this,b),c=b.properties,a=this;if(c.cols){e._itemscls1=b.getClass("ITEMS","-nowrap")}xui.arr.each(e.items,function(f){var d=f.index;if(!d){d=xui.arr.indexOf(e.items,f)}a._autoColor(f,d,c)});return e},_initIconColors:function(d,f){var c=[],b=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],e=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],a=["#F19B60","#49CD81","#0277bd","#A693EB","#42a3af","#B0E0E6","#F06292"];switch(d){case"icon":c=b;if(f.iconColors&&f.iconColors.length>0){c=f.iconColors}break;case"font":c=e;if(f.fontColors&&f.fontColors.length>0){c=f.fontColors}break;case"item":c=a;if(f.itemColors&&f.itemColors.length>0){c=f.itemColors}break}return c},_autoColor:function(d,c,f){c=c||0;if(f.autoFontColor||d.fontColor){var e=this._initIconColors("font",f);while(c&&c>(e.length-1)){c=c-e.length}if(!d.fontColor){d.fontColor=e[c]}d._fontColor=d.fontColor?";color:"+d.fontColor:""}if(f.autoIconColor||d.iconColor){var b=this._initIconColors("icon",f);while(c&&c>(b.length-1)){c=c-b.length}if(!d.iconColor){d.iconColor=b[c]}d._iconColor=d.iconColor?";color:"+d.iconColor:""}if(f.autoItemColor||d.itemColor){var a=this._initIconColors("item",f);while(c&&c>(a.length-1)){c=c-a.length}if(!d.itemColor){d.itemColor=a[c]}d._itemColor=d.itemColor?";background-color:"+d.itemColor:"";d._fontColor=";color:#ffffff";d._iconColor=";color:#ffffff"}},_prepareItem:function(b,n,c,e,g,j){var a=b.properties,l=a.columns,o=a.rows,f=n.autoItemSize||a.autoItemSize,d=n.autoImgSize||a.autoImgSize,m;this._autoColor(n,g,a);xui.arr.each(xui.toArr("itemWidth,bgimg,iotStatus,position,itemHeight,imgWidth,imgHeight,itemPadding,itemMargin,iconFontSize,autoItemSize,autoImgSize"),function(q){n[q]=xui.isSet(n[q])?n[q]:a[q]});if(a.flagClass&&!n.flagClass){n.flagClass=a.flagClass}if(a.flagStyle&&!n.flagStyle){n.flagStyle=a.flagStyle}if(a.flagText&&!n.flagText){n.flagText=a.flagText}n.itemWidth=(!f&&(m=n.itemWidth))?b.$forceu(m):"";n.itemHeight=(!f&&(m=n.itemHeight))?b.$forceu(m):"";n.itemMargin=(m=n.itemMargin)?b.$forceu(m):0;n.itemPadding=(m=n.itemPadding)?b.$forceu(m):0;n.imgWidth=(!d&&(m=n.imgWidth))?b.$forceu(m):"";n.imgHeight=(!d&&(m=n.imgHeight))?b.$forceu(m):"";n._tabindex=a.tabindex;if(n.fontColor){n._fontColor="color:"+n.fontColor}if(n.iconColor){n._iconColor="color:"+n.iconColor}if(n.icon){n._icon="background-image: url("+n.icon+")"}if(n.position){n._position="background-position:"+n.position}if(n.bgimg){n._bgimg="background-image: url(/"+n.bgimg+")"}if(m=n.iconFontSize){n._fontSize="font-size:"+m}n._imageClass="";if(!n.iconFontCode&&!n.imageClass){n._imageClass+="xui-icon-loading"}if(n.imageClass){n._imageClass+=" "+n.imageClass}else{n._imageClass=" icon1"}if(n.flagText||n.flagClass){n._flagStyle="display:block"}if(!n.flagClass){n.flagClass="xui-uiflag-1"}if(a.iconOnly){delete n.caption;delete n.comment}if((n.caption=n.caption||"")===""){n.capDisplay="display:none;"}if((n.comment=n.comment||"")===""){n.commentDisplay="display:none;"}n._itemSize="";if(l){n._itemSize+="width:"+(100/l+"%")+";border:0;margin-left:0;margin-right:0;padding-left:0;padding-right:0;"}if(o){n._itemSize+="height:"+(100/o+"%")+";border:0;margin-top:0;margin-bottom:0;padding-top:0;padding-bottom:0;"}if(!f){n._inneritemSize=(!l&&n.itemWidth?("width:"+n.itemWidth+";"):"")+(!o&&n.itemHeight?("height:"+n.itemHeight):"")}if(!d){n._innerimgSize=(n.imgWidth?("width:"+n.imgWidth+";"):"")+(!o&&n.imgHeight?("height:"+n.imgHeight):"")}},RenderTrigger:function(){this.boxing()._afterInsertItems(this)}}});xui.Class("xui.UI.TitleBlock","xui.UI.List",{Instance:{_afterInsertItems:function(a){a.getSubNodes("IMAGE",true).each(function(b){if(b.src==xui.ini.img_bg){if(xui.browser.isFF){b.src=""}b.src=b.title;b.title=""}})},updateItemData:function(a,b){this.get(0).box._prepareItem(this.get(0),b);this.get(0).boxing().refresh()}},Initialize:function(){var b=this.getTemplate();b.$submap={items:{ITEM:{tabindex:"{_tabindex}",className:"xui-uitembg xui-uiborder-radius xui-showfocus {itemClass} {disabled} {readonly}",style:"padding:{itemPadding};margin:{itemMargin};{_itemSize};{itemStyle}{_iconColor})",ITEMFRAME:{style:"{_inneritemSize};{_bgColor}; {_position}",MSGNUM:{tagName:"div",className:"xui-ui-ellipsis",style:"{capDisplay} {_fontColor}",text:"{msgnum}",$order:0},TITLE:{tagName:"div",className:"xui-ui-ellipsis",style:"{capDisplay}{_fontColor}",text:"{_title}",$order:3,IMAGE:{tagName:"img",src:xui.ini.img_bg,title:"{image}",style:"{_innerimgSize};{imgStyle}"}},MORE:{tagName:"div",className:"xui-ui-ellipsis",style:"{capDisplay};{_moreBgColor};",text:"{more}",$order:4}},FLAG:{$order:20,className:"xui-display-none {flagClass}",style:"{_flagStyle};{flagStyle};font-size:{iconFontSize}{_fontColor}",text:"{flagText}"},EXTRA:{text:"{ext}",$order:30}}}};this.setTemplate(b);xui.UI.IconList=xui.UI.TitleBlock;var a="xui.UI.IconList";xui.absBox.$type[a.replace("xui.UI.","")]=xui.absBox.$type[a]=a},Static:{IMGNODE:1,Appearances:{EXTRA:{display:"none"},KEY:{overflow:"visible"},ITEMS:{position:"relative",overflow:"auto","overflow-x":"hidden",zoom:xui.browser.ie6?1:null},"ITEMS-nowrap":{"white-space":"nowrap"},ITEM:{display:xui.$inlineBlock,zoom:xui.browser.ie67?1:null,position:"relative",cursor:"pointer","vertical-align":"top",margin:0},ITEMFRAME:{display:xui.browser.ie67?xui.$inlineBlock:"block",zoom:xui.browser.ie67?1:null,position:"relative",overflow:"hidden",border:0,padding:0,margin:0,"-moz-box-flex":"1"},IBWRAP:{},IMAGE:{display:xui.$inlineBlock,zoom:xui.browser.ie6?1:null,visibility:"hidden","vertical-align":"middle"},MSGNUM:{"text-align":"right",overflow:"hidden",color:"#FFFFFF","white-space":"nowrap","font-weight":"bold","font-size":"2em","margin-top":"5px","margin-right":"0.5em",height:"35px"},TITLE:{color:"#FFFFFF",display:"block","margin-right":"0.25em","text-align":"right","font-size":"1em"},MORE:{color:"#FFFFFF",display:"block","background-color":"#E6945C","margin-top":"0.5em","text-align":"center","font-size":"0.75em"},FLAG:{left:"0.5em",top:"0.2em","text-align":"left",color:"#fff",opacity:0.2,position:"absolute","z-index":10}},Behaviors:{ITEMS:{swipeleft:function(a,d,f){var c=a.getItemByDom(f),b=a.boxing();if(a.swipeleft){b.swipeleft(a,c,d,f);return false}},swiperight:function(a,c,d,f){var c=a.getItemByDom(f),b=a.boxing();if(a.swiperight){b.swipeleft(a,c,d,f);return false}},},IMAGE:{onLoad:function(d,g,a){var f=xui.use(a).get(0),n=f.src;if(n!=xui.ini.img_bg){var b=d.properties,m=xui.use(a),c=m.get(0),l=d.getItemByDom(a);if(!l){return}var j=d.getSubNodeByItemId("ICON",l.id);if(l.autoImgSize||b.autoImgSize){m.attr("width","");m.attr("height","")}else{m.attr("width",l.imgWidth);m.attr("height",l.imgWidth)}j.removeClass("xui-icon-loading");if(!l.iconFontCode&&!l.imageClass&&!l.icon){j.addClass("xui-display-none")}m.onLoad(null).onError(null).$removeEventHandler("load").$removeEventHandler("error");l._status="loaded";if(xui.ini.img_blank==n){c.style.visibility="hidden";c.style.display="none"}else{c.style.visibility="visible";c.style.display=""}}},onError:function(b,g,j){var d=b.getItemByDom(j);if(d._status=="error"){return}var f=b.properties,l=xui.use(j),c=l.get(0),a=b.getSubNodeByItemId("ICON",d.id);a.removeClass("xui-icon-loading xui-display-none").addClass("xui-load-error");l.onLoad(null).onError(null).$removeEventHandler("load").$removeEventHandler("error");c.style.visibility="hidden";c.style.display="none";d._status="error"}},TITLE:{onClick:function(a,d,f){var c=a.getItemByDom(f),b=a.boxing();if(a.onTitleClick){b.onTitleClick(a,c,d,f);return false}}},MORE:{onClick:function(a,d,f){var c=a.getItemByDom(f),b=a.boxing();if(a.onMoreClick){b.onMoreClick(a,c,d,f);return false}}}},DataModel:{flagText:null,flagClass:null,flagStyle:null,iconColors:null,itemColors:null,fontColors:null,moreColors:null,autoFontColor:{ini:false,action:function(){this.boxing().refresh()}},autoIconColor:{ini:false,action:function(){this.boxing().refresh()}},autoItemColor:{ini:true,action:function(){this.boxing().refresh()}},autoImgSize:{ini:false,action:function(){this.boxing().refresh()}},autoItemSize:{ini:true,action:function(){this.boxing().refresh()}},iconFontSize:{ini:"3.5em",action:function(a){this.getSubNode("FLAG",true).css("font-size",a)}},itemMargin:{ini:0,action:function(a){this.getSubNode("ITEM",true).css("margin",a||0)}},itemPadding:{ini:0,action:function(a){this.getSubNode("ITEM",true).css("padding",a||0)}},itemWidth:{$spaceunit:1,ini:32,action:function(a){this.getSubNode("ITEMFRAME",true).width(a||"")}},itemHeight:{$spaceunit:1,ini:32,action:function(a){this.getSubNode("ITEMFRAME",true).height(a||"")}},width:{$spaceunit:1,ini:"16rem"},height:{$spaceunit:1,ini:"16rem"},columns:{ini:0,action:function(){this.boxing().refresh()}},rows:{ini:0,action:function(){this.boxing().refresh()}}},EventHandlers:{onCmd:null,onMoreClick:function(a,b,c,d){},onTitleClick:function(a,b,c,d){},touchstart:function(a,b,c,d){},touchmove:function(a,b,c,d){},touchend:function(a,b,c,d){},touchcancel:function(a,b,c,d){},swipe:function(a,b,c,d){},swipeleft:function(a,b,c,d){},swiperight:function(a,b,c,d){},swipeup:function(a,b,c,d){},swipedown:function(a,b,c,d){},press:function(a,b,c,d){},pressup:function(a,b,c,d){}},_prepareData:function(b){var e=arguments.callee.upper.call(this,b),c=b.properties,a=this;if(c.cols){e._itemscls1=b.getClass("ITEMS","-nowrap")}xui.arr.each(e.items,function(f){var d=f.index;if(!d){d=xui.arr.indexOf(e.items,f)}a._autoColor(f,d,c)});return e},_initIconColors:function(e,g){var d=[],b=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],f=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],c=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],a=["#F19B60","#49CD81","#0277bd","#A693EB","#42a3af","#B0E0E6","#F06292"];switch(e){case"icon":d=b;if(g.iconColors&&g.iconColors.length>0){d=g.iconColors}break;case"font":d=f;if(g.fontColors&&g.fontColors.length>0){d=g.fontColors}break;case"more":d=c;if(g.moreColors&&g.moreColors.length>0){d=g.moreColors}break;case"item":d=a;if(g.itemColors&&g.itemColors.length>0){d=g.itemColors}break}return d},_autoColor:function(e,d,g){d=d||0;if(g.autoFontColor||e.fontColor){var f=this._initIconColors("font",g);while(d&&d>(f.length-1)){d=d-f.length}if(!e.fontColor){e.fontColor=f[d]}e._fontColor=e.fontColor?";color:"+e.fontColor:""}if(g.autoIconColor||e.iconColor){var b=this._initIconColors("icon",g);while(d&&d>(b.length-1)){d=d-b.length}if(!e.iconColor){e.iconColor=b[d]}e._iconColor=e.iconColor?";color:"+e.iconColor:""}if(g.autoItemColor||e.itemColor){var a=this._initIconColors("item",g);var c=this._initIconColors("more",g);while(d&&d>(a.length-1)){d=d-a.length}if(!e.itemColor){e.itemColor=a[d]}e._bgColor=e.itemColor?";background-color:"+e.itemColor:"";if(!e.moreColor){e.moreColor=c[d]}e._moreBgColor=e.moreColor?";background-color:"+e.moreColor:"";e._fontColor=";color:#ffffff";e._iconColor=";color:#ffffff"}},_prepareItem:function(b,m,c,d,f,g){var a=b.properties,j=a.columns,n=a.rows,e=m.autoItemSize||a.autoItemSize,l;this._autoColor(m,f,a);xui.arr.each(xui.toArr("itemWidth,position,itemHeight,imgWidth,imgHeight,itemPadding,itemMargin,iconFontSize"),function(o){m[o]=xui.isSet(m[o])?m[o]:a[o]});m.itemWidth=(!e&&(l=m.itemWidth))?b.$forceu(l):"";m.itemHeight=(!e&&(l=m.itemHeight))?b.$forceu(l):"";m.itemMargin=(l=m.itemMargin)?b.$forceu(l):0;m.itemPadding=(l=m.itemPadding)?b.$forceu(l):0;m._tabindex=a.tabindex;if(m.title){m._title=m.title}else{if(m.caption){m._title=m.caption}}if(a.flagClass&&!m.flagClass){m.flagClass=a.flagClass}if(a.flagStyle&&!m.flagStyle){m.flagStyle=a.flagStyle}if(a.flagText&&!m.flagText){m.flagText=a.flagText}m._imageClass="";if(!m.iconFontCode&&!m.imageClass){m._imageClass+="xui-icon-loading"}if(m.imageClass){m._imageClass+=" "+m.imageClass}else{m._imageClass=" icon1"}if(m.flagText||m.flagClass){m._flagStyle="display:block"}if(!m.flagClass){m.flagClass="xui-uiflag-1"}m._itemSize="";if(j){m._itemSize+="width:"+(100/j+"%")+";border:0;margin-left:0;margin-right:0;padding-left:0;padding-right:0;"}if(n){m._itemSize+="height:"+(100/n+"%")+";border:0;margin-top:0;margin-bottom:0;padding-top:0;padding-bottom:0;"}},RenderTrigger:function(){this.boxing()._afterInsertItems(this)}}});xui.Class("xui.UI.ButtonLayout","xui.UI.List",{Instance:{_afterInsertItems:function(a){a.getSubNodes("IMAGE",true).each(function(b){if(b.src==xui.ini.img_bg){if(xui.browser.isFF){b.src=""}b.src=b.title;b.title=""}})},updateItemData:function(a,b){this.get(0).box._prepareItem(this.get(0),b);this.updateItem(b.id,b);this.get(0).boxing().refresh()}},Initialize:function(){var b=this.getTemplate();b.$submap={items:{ITEM:{tabindex:"{_tabindex}",className:"{itemClass} {disabled} {readonly}",style:"padding:{itemPadding};margin:{itemMargin};{_itemSize};{itemStyle} {_itemColor}",ITEMFRAME:{style:"{_inneritemSize};{_bgimg}; {_itemposition}",COMMENT:{tagName:"div",className:"xui-ui-ellipsis",text:"{comment}",style:"{commentDisplay};{_fontColor}",$order:2},CONTENT:{tagName:"div",$order:1,className:"{contentClass}",style:"{_loadbg}",ICON:{className:"xuifont {_imageClass} xui-showfocus",style:"{_fontSize};{_icon};{_position}{_iconColor}",text:"{iconFontCode}"},IMAGE:{tagName:"img",src:xui.ini.img_bg,title:"{image}",style:"{_innerimgSize};{imgStyle}"}},CAPTION:{tagName:"div",className:"xui-ui-ellipsis",style:"{capDisplay} {_iconColor}",text:"{caption}",$order:0}},FLAG:{$order:20,className:"xui-display-none {flagClass}",style:"{_flagStyle};{flagStyle}",text:"{flagText}"},EXTRA:{text:"{ext}",$order:30}}}};this.setTemplate(b);xui.UI.IconList=xui.UI.ButtonLayout;var a="xui.UI.IconList";xui.absBox.$type[a.replace("xui.UI.","")]=xui.absBox.$type[a]=a},Static:{IMGNODE:1,Appearances:{EXTRA:{display:"none"},KEY:{overflow:"visible"},ITEMS:{position:"relative",overflow:"auto","overflow-x":"hidden",zoom:xui.browser.ie6?1:null},"ITEMS-nowrap":{"white-space":"nowrap"},ITEM:{display:xui.$inlineBlock,zoom:xui.browser.ie67?1:null,position:"relative",cursor:"pointer","vertical-align":"top",margin:0},ITEMFRAME:{display:xui.browser.ie67?xui.$inlineBlock:"block",zoom:xui.browser.ie67?1:null,position:"relative",overflow:"hidden",border:0,padding:0,margin:0,"-moz-box-flex":"1"},IBWRAP:{},IMAGE:{display:xui.$inlineBlock,zoom:xui.browser.ie6?1:null,visibility:"hidden","vertical-align":"middle"},CAPTION:{"text-align":"center",overflow:"hidden","white-space":"nowrap","font-weight":"bold","font-size":"20px","margin-top":"15px",height:"35px"},CONTENT:{"text-align":"center","white-space":"nowrap","background-repeat":"no-repeat","font-size":"1em"},COMMENT:{display:"block",margin:".25em","text-align":"center","font-size":"0.75em"},FLAG:{right:"30%",top:"0.125em","font-size":"8px",color:"#eb6e1a",position:"absolute","z-index":10}},Behaviors:{IMAGE:{onLoad:function(d,g,a){var f=xui.use(a).get(0),n=f.src;if(n!=xui.ini.img_bg){var b=d.properties,m=xui.use(a),c=m.get(0),l=d.getItemByDom(a);if(!l){return}var j=d.getSubNodeByItemId("ICON",l.id);if(l.autoImgSize||b.autoImgSize){m.attr("width","");m.attr("height","")}else{m.attr("width",l.imgWidth);m.attr("height",l.imgWidth)}j.removeClass("xui-icon-loading");if(!l.iconFontCode&&!l.imageClass&&!l.icon){j.addClass("xui-display-none")}m.onLoad(null).onError(null).$removeEventHandler("load").$removeEventHandler("error");l._status="loaded";if(xui.ini.img_blank==n){c.style.visibility="hidden";c.style.display="none"}else{c.style.visibility="visible";c.style.display=""}}},onError:function(b,g,j){var d=b.getItemByDom(j);if(d._status=="error"){return}var f=b.properties,l=xui.use(j),c=l.get(0),a=b.getSubNodeByItemId("ICON",d.id);a.removeClass("xui-icon-loading xui-display-none").addClass("xui-load-error");l.onLoad(null).onError(null).$removeEventHandler("load").$removeEventHandler("error");c.style.visibility="hidden";c.style.display="none";d._status="error"}},ITEMS:{swipeleft:function(a,d,f){var c=a.getItemByDom(f),b=a.boxing();if(a.swipeleft){b.swipeleft(a,c,d,f);return false}},swiperight:function(a,c,d,f){var c=a.getItemByDom(f),b=a.boxing();if(a.swiperight){b.swiperight(a,c,d,f);return false}}},FLAG:{onClick:function(a,d,f){var c=a.getItemByDom(f),b=a.boxing();if(a.onFlagClick){b.onFlagClick(a,c,d,f);return false}}}},DataModel:{tagCmds:null,expression:{ini:"",action:function(){}},bgimg:null,tagCmdsAlign:null,flagText:null,flagClass:null,flagStyle:null,autoFontColor:{ini:false,action:function(){this.boxing().refresh()}},autoIconColor:{ini:true,action:function(){this.boxing().refresh()}},autoItemColor:{ini:false,action:function(){this.boxing().refresh()}},iconColors:null,itemColors:null,fontColors:null,autoImgSize:{ini:false,action:function(){this.boxing().refresh()}},autoItemSize:{ini:true,action:function(){this.boxing().refresh()}},iconOnly:{ini:false,action:function(){this.boxing().refresh()}},iconFontSize:{ini:"",action:function(a){this.getSubNode("ICON",true).css("font-size",a)}},itemMargin:{ini:6,action:function(a){this.getSubNode("ITEM",true).css("margin",a||0)}},itemPadding:{ini:2,action:function(a){this.getSubNode("ITEM",true).css("padding",a||0)}},itemWidth:{$spaceunit:1,ini:32,action:function(a){this.getSubNode("ITEMFRAME",true).width(a||"")}},itemHeight:{$spaceunit:1,ini:32,action:function(a){this.getSubNode("ITEMFRAME",true).height(a||"")}},imgWidth:{ini:16,action:function(a){this.getSubNode("IMAGE",true).width(a||"")}},imgHeight:{ini:16,action:function(a){this.getSubNode("IMAGE",true).height(a||"")}},width:{$spaceunit:1,ini:"16rem"},height:{$spaceunit:1,ini:"16rem"},columns:{ini:0,action:function(){this.boxing().refresh()}},rows:{ini:0,action:function(){this.boxing().refresh()}}},EventHandlers:{onCmd:null,onFlagClick:function(a,b,c,d){},touchstart:function(a,b,c,d){},touchmove:function(a,b,c,d){},touchend:function(a,b,c,d){},touchcancel:function(a,b,c,d){},swipe:function(a,b,c,d){},swipeleft:function(a,b,c,d){},swiperight:function(a,b,c,d){},swipeup:function(a,b,c,d){},swipedown:function(a,b,c,d){},press:function(a,b,c,d){},pressup:function(a,b,c,d){}},_prepareData:function(b){var e=arguments.callee.upper.call(this,b),c=b.properties,a=this;if(c.cols){e._itemscls1=b.getClass("ITEMS","-nowrap")}xui.arr.each(e.items,function(f){var d=f.index;if(!d){d=xui.arr.indexOf(e.items,f)}a._autoColor(f,d,c)});return e},_initIconColors:function(d,f){var c=[],b=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],e=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],a=["#F19B60","#49CD81","#0277bd","#A693EB","#42a3af","#B0E0E6","#F06292"];switch(d){case"icon":c=b;if(f.iconColors&&f.iconColors.length>0){c=f.iconColors}break;case"font":c=e;if(f.fontColors&&f.fontColors.length>0){c=f.fontColors}break;case"item":c=a;if(f.itemColors&&f.itemColors.length>0){c=f.itemColors}break}return c},_autoColor:function(d,c,f){c=c||0;if(f.autoFontColor||d.fontColor){var e=this._initIconColors("font",f);while(c&&c>(e.length-1)){c=c-e.length}if(!d.fontColor){d.fontColor=e[c]}d._fontColor=d.fontColor?";color:"+d.fontColor:""}if(f.autoIconColor||d.iconColor){var b=this._initIconColors("icon",f);while(c&&c>(b.length-1)){c=c-b.length}if(!d.iconColor){d.iconColor=b[c]}d._iconColor=d.iconColor?";color:"+d.iconColor:""}if(f.autoItemColor||d.itemColor){var a=this._initIconColors("item",f);while(c&&c>(a.length-1)){c=c-a.length}if(!d.itemColor){d.itemColor=a[c]}d._itemColor=d.itemColor?";background-color:"+d.itemColor:"";d._fontColor=";color:#ffffff";d._iconColor=";color:#ffffff"}},_prepareItem:function(b,n,c,e,g,j){var a=b.properties,l=a.columns,o=a.rows,f=n.autoItemSize||a.autoItemSize,d=n.autoImgSize||a.autoImgSize,m;this._autoColor(n,g,a);xui.arr.each(xui.toArr("itemWidth,bgimg,position,itemHeight,imgWidth,imgHeight,itemPadding,itemMargin,iconFontSize,autoItemSize,autoImgSize"),function(q){n[q]=xui.isSet(n[q])?n[q]:a[q]});if(a.flagClass&&!n.flagClass){n.flagClass=a.flagClass}if(!n.flagStyle){n.flagStyle=a.flagStyle}if(!n.flagText){n.flagText=a.flagText}n.itemWidth=(!f&&(m=n.itemWidth))?b.$forceu(m):"";n.itemHeight=(!f&&(m=n.itemHeight))?b.$forceu(m):"";n.itemMargin=(m=n.itemMargin)?b.$forceu(m):0;n.itemPadding=(m=n.itemPadding)?b.$forceu(m):0;n.imgWidth=(!d&&(m=n.imgWidth))?b.$forceu(m):"";n.imgHeight=(!d&&(m=n.imgHeight))?b.$forceu(m):"";n._tabindex=a.tabindex;if(n.icon){n._icon="background-image: url("+n.icon+")"}if(n.position){n._position="background-position:"+n.position}if(n.bgimg){n._bgimg="background-image: url(/"+n.bgimg+")"}if(m=n.iconFontSize){n._fontSize="font-size:"+m}n._imageClass="";if(!n.iconFontCode&&!n.imageClass){n._imageClass+="xui-icon-loading"}if(n.imageClass){n._imageClass+=" "+n.imageClass}else{n._imageClass=" icon1"}if(n.flagText||n.flagClass){n._flagStyle="display:block"}if(!n.flagClass){n.flagClass="xui-uiflag-1"}if(a.iconOnly){delete n.caption;delete n.comment}if((n.caption=n.caption||"")===""){n.capDisplay="display:none;"}if((n.comment=n.comment||"")===""){n.commentDisplay="display:none;"}n._itemSize="";if(l){n._itemSize+="width:"+(100/l+"%")+";border:0;margin-left:0;margin-right:0;padding-left:0;padding-right:0;"}if(o){n._itemSize+="height:"+(100/o+"%")+";border:0;margin-top:0;margin-bottom:0;padding-top:0;padding-bottom:0;"}if(!f){n._inneritemSize=(!l&&n.itemWidth?("width:"+n.itemWidth+";"):"")+(!o&&n.itemHeight?("height:"+n.itemHeight):"")}if(!d){n._innerimgSize=(n.imgWidth?("width:"+n.imgWidth+";"):"")+(!o&&n.imgHeight?("height:"+n.imgHeight):"")}},RenderTrigger:function(){this.boxing()._afterInsertItems(this)}}});xui.Class("xui.UI.Opinion","xui.UI.List",{Instance:{getStatus:function(b){var a=this.get(0).getItemByItemId(b);return(a&&a._status)||"ini"},_afterInsertItems:function(a){a.getSubNodes("IMAGE",true).each(function(b){if(b.src==xui.ini.img_bg){if(xui.browser.isFF){b.src=""}b.src=b.title;b.title=""}})},updateItemData:function(a,b){this.get(0).box._prepareItem(this.get(0),b);this.get(0).boxing().refresh()}},Initialize:function(){var b=this.getTemplate();b.$submap={items:{ITEM:{tabindex:"{_tabindex}",className:"xui-uitembg xui-uiborder-radius xui-showfocus {itemClass} {disabled} {readonly}",style:"padding:{itemPadding};margin:{itemMargin};{_itemSize};{itemStyle})",ITEMFRAME:{style:"{_inneritemSize};{_bgimg}; {_position}}",COMMENT:{tagName:"div",className:"xui-ui-ellipsis",text:"{comment}",style:"{commentDisplay};{_color}",$order:2},CONTENT:{tagName:"div",$order:1,className:"{contentClass}",style:"{_loadbg}",ICON:{className:"xuifont {_imageClass}",style:"{_fontSize};{_color};{_icon};{_position};}",text:"{iconFontCode}"}},CAPTION:{tagName:"div",className:"xui-ui-ellipsis",style:"{capDisplay}",text:"{caption}",$order:0},PERSON:{tagName:"div",className:"xui-ui-ellipsis",style:"{capDisplay}",text:"{creatorName}",$order:3,IMAGE:{tagName:"img",src:xui.ini.img_bg,title:"{image}",style:"{_innerimgSize};{imgStyle}"}},PERFORTIME:{tagName:"div",className:"xui-ui-ellipsis",style:"{capDisplay}",text:"{createDateStr}",$order:4}},FLAG:{$order:20,className:"xui-display-none {flagClass}",style:"{_flagStyle};{flagStyle}",text:"{flagText}"},EXTRA:{text:"{ext}",$order:30}}}};this.setTemplate(b);xui.UI.IconList=xui.UI.Gallery;var a="xui.UI.IconList";xui.absBox.$type[a.replace("xui.UI.","")]=xui.absBox.$type[a]=a},Static:{IMGNODE:1,Appearances:{EXTRA:{display:"none"},KEY:{overflow:"visible"},ITEMS:{position:"relative",overflow:"auto","overflow-x":"hidden",zoom:xui.browser.ie6?1:null},"ITEMS-nowrap":{"white-space":"nowrap"},ITEM:{display:xui.$inlineBlock,zoom:xui.browser.ie67?1:null,position:"relative",cursor:"pointer","vertical-align":"top",margin:0},ITEMFRAME:{display:xui.browser.ie67?xui.$inlineBlock:"block",zoom:xui.browser.ie67?1:null,position:"relative",overflow:"hidden",border:0,padding:0,margin:0,"-moz-box-flex":"1"},IBWRAP:{},IMAGE:{display:xui.$inlineBlock,zoom:xui.browser.ie6?1:null,visibility:"hidden","vertical-align":"middle"},CAPTION:{"text-align":"left",overflow:"hidden",right:"3em","white-space":"nowrap","font-weight":"bold","font-size":"20px","margin-top":"15px",height:"35px"},CONTENT:{"text-align":"center","white-space":"nowrap","background-repeat":"no-repeat","font-size":"1em"},COMMENT:{display:"block",margin:".25em","text-align":"center","font-size":"1em"},TIEM:{display:"block",margin:".25em","text-align":"center","font-size":"1em"},PERSON:{display:"block","margin-top":"0.5em","margin-right":"2em","text-align":"right","font-size":"1em"},PERFORTIME:{display:"block","margin-top":"0.5em","margin-right":"1em","text-align":"right","font-size":"1em"},FLAG:{width:"2em",height:"2em",right:"1.5em",top:"1em","text-align":"left","font-size":"16px",color:"#eb6e1a",position:"absolute","z-index":10}},Behaviors:{IMAGE:{onLoad:function(d,g,a){var f=xui.use(a).get(0),n=f.src;if(n!=xui.ini.img_bg){var b=d.properties,m=xui.use(a),c=m.get(0),l=d.getItemByDom(a);if(!l){return}var j=d.getSubNodeByItemId("ICON",l.id);if(l.autoImgSize||b.autoImgSize){m.attr("width","");m.attr("height","")}else{m.attr("width",l.imgWidth);m.attr("height",l.imgWidth)}j.removeClass("xui-icon-loading");if(!l.iconFontCode&&!l.imageClass&&!l.icon){j.addClass("xui-display-none")}m.onLoad(null).onError(null).$removeEventHandler("load").$removeEventHandler("error");l._status="loaded";if(xui.ini.img_blank==n){c.style.visibility="hidden";c.style.display="none"}else{c.style.visibility="visible";c.style.display=""}}},onError:function(b,g,j){var d=b.getItemByDom(j);if(d._status=="error"){return}var f=b.properties,l=xui.use(j),c=l.get(0),a=b.getSubNodeByItemId("ICON",d.id);a.removeClass("xui-icon-loading xui-display-none").addClass("xui-load-error");l.onLoad(null).onError(null).$removeEventHandler("load").$removeEventHandler("error");c.style.visibility="hidden";c.style.display="none";d._status="error"}},FLAG:{onClick:function(a,d,f){var c=a.getItemByDom(f),b=a.boxing();if(a.onFlagClick){b.onFlagClick(a,c,d,f);return false}}}},DataModel:{expression:{ini:"",action:function(){}},tagCmds:null,bgimg:null,iotStatus:null,flagText:null,flagClass:null,flagStyle:null,tagCmdsAlign:null,autoImgSize:{ini:false,action:function(){this.boxing().refresh()}},autoItemSize:{ini:true,action:function(){this.boxing().refresh()}},iconOnly:{ini:false,action:function(){this.boxing().refresh()}},iconFontSize:{ini:"",action:function(a){this.getSubNode("ICON",true).css("font-size",a)}},itemMargin:{ini:6,action:function(a){this.getSubNode("ITEM",true).css("margin",a||0)}},itemPadding:{ini:2,action:function(a){this.getSubNode("ITEM",true).css("padding",a||0)}},itemWidth:{$spaceunit:1,ini:32,action:function(a){this.getSubNode("ITEMFRAME",true).width(a||"")}},itemHeight:{$spaceunit:1,ini:32,action:function(a){this.getSubNode("ITEMFRAME",true).height(a||"")}},imgWidth:{ini:16,action:function(a){this.getSubNode("IMAGE",true).width(a||"")}},imgHeight:{ini:16,action:function(a){this.getSubNode("IMAGE",true).height(a||"")}},width:{$spaceunit:1,ini:"16rem"},height:{$spaceunit:1,ini:"16rem"},columns:{ini:0,action:function(){this.boxing().refresh()}},rows:{ini:0,action:function(){this.boxing().refresh()}}},EventHandlers:{onCmd:null,onFlagClick:function(a,b,c,d){}},_prepareData:function(a){var c=arguments.callee.upper.call(this,a),b=a.properties;if(b.cols){c._itemscls1=a.getClass("ITEMS","-nowrap")}return c},_prepareItem:function(d,e){var j=d.properties,g=j.columns,f=j.rows,c=e.autoItemSize||j.autoItemSize,b=e.autoImgSize||j.autoImgSize,a;xui.arr.each(xui.toArr("itemWidth,bgimg,iotStatus,position,itemHeight,imgWidth,imgHeight,itemPadding,itemMargin,iconFontSize,autoItemSize,autoImgSize"),function(l){e[l]=xui.isSet(e[l])?e[l]:j[l]});e.itemWidth=(!c&&(a=e.itemWidth))?d.$forceu(a):"";e.itemHeight=(!c&&(a=e.itemHeight))?d.$forceu(a):"";e.itemMargin=(a=e.itemMargin)?d.$forceu(a):0;e.itemPadding=(a=e.itemPadding)?d.$forceu(a):0;e.imgWidth=(!b&&(a=e.imgWidth))?d.$forceu(a):"";e.imgHeight=(!b&&(a=e.imgHeight))?d.$forceu(a):"";e._tabindex=j.tabindex;if(j.flagClass&&!e.flagClass){e.flagClass=j.flagClass}if(j.flagStyle&&!e.flagStyle){e.flagStyle=j.flagStyle}if(j.flagText&&!e.flagText){e.flagText=j.flagText}if(e.icon){e._icon="background-image: url("+e.icon+")"}if(e.bgimg){e._bgimg="background-image: url(/"+e.bgimg+")"}if(a=e.iconFontSize){e._fontSize="font-size:"+a}e._imageClass="";if(!e.iconFontCode&&!e.imageClass){e._imageClass+="xui-icon-loading"}if(e.imageClass){e._imageClass+=" "+e.imageClass}else{e._imageClass=" icon1"}if(e.flagText||e.flagClass){e._flagStyle="display:block"}if(!e.flagClass){e.flagClass="xui-uiflag-1"}if(j.iconOnly){delete e.caption;delete e.comment}if(e.content){e.caption=e.content}if((e.caption=e.caption||"")===""){e.capDisplay="display:none;"}if((e.comment=e.comment||"")===""){e.commentDisplay="display:none;"}e._itemSize="";if(g){e._itemSize+="width:"+(100/g+"%")+";border:0;margin-left:0;margin-right:0;padding-left:0;padding-right:0;"}if(f){e._itemSize+="height:"+(100/f+"%")+";border:0;margin-top:0;margin-bottom:0;padding-top:0;padding-bottom:0;"}if(!c){e._inneritemSize=(!g&&e.itemWidth?("width:"+e.itemWidth+";"):"")+(!f&&e.itemHeight?("height:"+e.itemHeight):"")}if(!b){e._innerimgSize=(e.imgWidth?("width:"+e.imgWidth+";"):"")+(!f&&e.imgHeight?("height:"+e.imgHeight):"")}},RenderTrigger:function(){this.boxing()._afterInsertItems(this)}}});xui.Class("xui.UI.Panel","xui.UI.Div",{Instance:{activate:function(){var a=this.get(0);a.getSubNode("CAPTION").focus(true);return this},getAllFormValues:function(b){var c=this.getChildren(),d=xui.absValue.pack(c),f={},e=this.get(0);xui.arr.each(e.children,function(j){var a=j[0].boxing(),g=a.getProperties().name||j[0].alias;if(a.Class["xui.UI.Tabs"]){xui.merge(f,a.getAllFormValues(b),"all")}else{if(a.Class["xui.UI.Block"]||a.Class["xui.UI.Panel"]||a.Class["xui.UI.Layout"]){xui.merge(f,a.getAllFormValues(b),"all")}else{if(a.getFormValues){xui.merge(f,a.getFormValues(b),"all")}else{if(a.getUIValue){f[g]=a.getUIValue()}else{if(a.getValue){f[g]=a.getValue()}}}}}});return f},resetPanelView:function(b,c){if(!xui.isSet(b)){b=true}if(!xui.isSet(c)){c=true}var a;return this.each(function(d){if(d.renderId){delete d.$ini;if(b){a=d.boxing();a.removeChildren(true,c)}if(d.properties.toggle){a.setToggle(false)}}})},iniPanelView:function(){return this.each(function(a){if(!a.$ini){a.$ini=true;var b=a.properties;if(a.onIniPanelView){a.boxing().onIniPanelView(a)}if(b.iframeAutoLoad||b.ajaxAutoLoad){xui.UI.Div._applyAutoLoad(a)}}})}},Static:{Templates:{tagName:"div",style:"{_style}",className:"{_className}",BORDER:{tagName:"div",className:"xui-uiborder-outset xui-uiborder-box xui-uiborder-radius-big",TBAR:{tagName:"div",className:"xui-uibar-top",BARTDL:{className:"xui-uibar-tdl xui-uibar xui-uiborder-radius-big-tl",BARTDLT:{className:"xui-uibar-tdlt"}},BARTDM:{$order:1,className:"xui-uibar-tdm xui-uibar",BARTDMT:{className:"xui-uibar-tdmt"}},BARTDR:{$order:2,className:"xui-uibar-tdr xui-uibar xui-uiborder-radius-big-tr",BARTDRT:{className:"xui-uibar-tdrt"}},BARCMDL:{$order:3,tagName:"div",className:"xui-uibar-cmdl",style:"{_align}",LTAGCMDS:{tagName:"span",className:"xui-ltag-cmds",style:"{_ltagDisplay}",text:"{ltagCmds}"},TOGGLE:{$order:1,className:"xuifont",$fonticon:"{_fi_toggleCls2}",style:"{toggleDisplay}",$order:0},ICON:{$order:2,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{tabindex:"{tabindex}",className:"xui-title-node",text:"{caption}",$order:3}},BARCMDR:{$order:4,tagName:"div",className:"xui-uibar-cmdr",RTAGCMDS:{$order:0,tagName:"span",className:"xui-rtag-cmds",style:"{_rtagDisplay}",text:"{rtagCmds}"},INFO:{className:"xuicon",$fonticon:"xui-uicmd-info",style:"{infoDisplay}",$order:1},OPT:{className:"xuicon",$fonticon:"xui-uicmd-opt",style:"{optDisplay}",$order:2},POP:{className:"xuicon",$fonticon:"xui-uicmd-pop",style:"{popDisplay}",$order:3},REFRESH:{className:"xuicon",$fonticon:"xui-uicmd-refresh",style:"{refreshDisplay}",$order:4},CLOSE:{className:"xuicon",$fonticon:"xui-uicmd-close",style:"{closeDisplay}",$order:5}}},MAIN:{$order:2,tagName:"div",className:"xui-uicon-main xui-uibar",style:"{_leftp}",MAINI:{tagName:"div",className:"xui-uicon-maini xui-uibar",style:"{_rightp}",PANEL:{tagName:"div",className:"xui-uibase xui-uicontainer {_bordertype}",style:"{panelDisplay};{_panelstyle};{_overflow};",text:"{html}"+xui.UI.$childTag}}},BBAR:{$order:3,tagName:"div",className:"xui-uibar-bottom-s",style:"{_bbarDisplay}",BBARTDL:{className:"xui-uibar-tdl xui-uibar xui-uiborder-radius-big-bl"},BBARTDM:{$order:1,className:"xui-uibar-tdm xui-uibar"},BBARTDR:{$order:2,className:"xui-uibar-tdr xui-uibar xui-uiborder-radius-big-br"}}},$submap:xui.UI.$getTagCmdsTpl()},Appearances:{KEY:{background:"transparent"},"LTAGCMDS, RTAGCMDS":{padding:0,margin:0,"vertical-align":"middle"},"KEY BORDER":{zoom:xui.browser.ie6?1:null},"TBART, BBART":{"border-spacing":0,"border-collapse":"separate"},PANEL:{position:"relative",left:0,top:0,overflow:"auto","line-height":"normal",zoom:xui.browser.ie6?1:null},CAPTION:{display:"inline",padding:".25em","vertical-align":xui.browser.ie6?"baseline":"middle"}},Behaviors:{DroppableKeys:["PANEL"],PanelKeys:["PANEL"],DraggableKeys:["TBAR"],NavKeys:{CAPTION:1},NoDraggableKeys:["INFO","OPT","CLOSE","POP","REFRESH","TOGGLE","CMD","TOGGLE"],HoverEffected:{INFO:"INFO",OPT:"OPT",CLOSE:"CLOSE",POP:"POP",REFRESH:"REFRESH",CMD:"CMD",TOGGLE:"TOGGLE",ICON:"ICON"},ClickEffected:{INFO:"INFO",OPT:"OPT",CLOSE:"CLOSE",POP:"POP",REFRESH:"REFRESH",CMD:"CMD",TOGGLE:"TOGGLE"},TOGGLE:{onClick:function(a,b,c){if(a.properties.toggleBtn){a.box._toggle(a,!a.properties.toggle);return false}}},CAPTION:{onClick:function(a,b,c){if(!a.onClickBar||false===a.boxing().onClickBar(a,c)){return xui.Event.getKey(b).shiftKey}}},PANEL:{onClick:function(a,c,d){var b=a.properties;if(b.disabled){return false}if(a.onClickPanel){return a.boxing().onClickPanel(a,c,d)}}},INFO:{onClick:function(a,b,c){a.boxing().onShowInfo(a,b,c)}},OPT:{onClick:function(a,b,c){a.boxing().onShowOptions(a,b,c)}},REFRESH:{onClick:function(a,b,c){a.boxing().onRefresh(a)}},CLOSE:{onClick:function(c,d,f){var b=c.properties;if(b.disabled){return}var a=c.boxing();if(false===a.beforeClose(c)){return}a.destroy()}},POP:{onClick:function(b,d,a){var g=b.properties;if(g.disabled){return}var j=b.getRoot().offset(),n=b.getRoot().cssSize(),o={parent:null,host:null,properties:null,events:null,CS:null,CC:null,CB:null,CF:null,init:null};if(b.beforePop&&false==b.boxing().beforePop(b,o,d,a)){return false}var l=xui.copy(xui.UI.Dialog.$DataStruct),m={};xui.merge(l,g,"with");xui.merge(l,{dock:"none",width:Math.max(n.width,200),height:Math.max(n.height,100),left:j.left,top:j.top,landBtn:true},"all");if(o.properties){xui.merge(l,o.properties,"with")}if(o.events){xui.merge(m,o.events,"all")}var f=new xui.UI.Dialog(l,m,o.host||b.host,o.CS||null,o.CC||null,o.CB||null,o.CF||null);if(xui.isFun(o.init)&&false===o.init(f,b,o)){}else{f.show(o.parent||xui("body"));var c=[];xui.arr.each(b.children,function(e){c.push(e[0])});if(c.length){f.append(xui.UI.pack(c,false))}b.boxing().removeChildren().destroy(true)}}},CMD:{onClick:function(a,b,c){var d=a.properties;if(d.disabled){return false}if(a.onCmd){a.boxing().onCmd(a,xui.use(c).id().split("_")[1],b,c)}return false}}},DataModel:{rotate:null,selectable:true,dock:"fill",caption:{ini:undefined,action:function(a){a=(xui.isSet(a)?a:"")+"";this.getSubNode("CAPTION").html(xui.adjustRes(a,true))}},html:{action:function(a,b,c){this.getSubNode("PANEL").html(xui.adjustRes(a,0,1),null,null,c)}},toggle:{ini:true,action:function(a){this.box._toggle(this,a)}},image:{format:"image",action:function(a){xui.UI.$iconAction(this)}},imagePos:{action:function(a){this.getSubNode("ICON").css("backgroundPosition",a||"center")}},imageBgSize:{action:function(a){this.getSubNode("ICON").css("backgroundSize",a||"")}},imageClass:{ini:"",action:function(a,b){xui.UI.$iconAction(this,"ICON",b)}},iconFontCode:{action:function(a){xui.UI.$iconAction(this)}},borderType:{ini:"inset",listbox:["none","flat","inset","outset"],action:function(b){var d=this,g=d.properties,e=d.getSubNode("PANEL"),c=/^xui-uiborder-/,f="xui-uiborder-",a=d.getRoot();e.removeClass(c);e.addClass(f+b);d.adjustSize()}},noFrame:{ini:false,action:function(b){var c=this,a=c.getRoot();c.getSubNode("BBAR").css("display",b?"none":"");c.getSubNode("MAIN").css("paddingLeft",b?"0":"");c.getSubNode("MAINI").css("paddingRight",b?"0":"").css("backgroundImage",b?"none":"");c.adjustSize()}},hAlign:{ini:"left",listbox:["left","center","right"],action:function(a){this.getSubNode("BARCMDL").css("textAlign",a)}},toggleIcon:{listbox:["xui-uicmd-toggle","xui-uicmd-check"],ini:"xui-uicmd-toggle",action:function(a,b){this.getSubNode("TOGGLE").replaceClass(new RegExp("\\b"+b,"img"),a)}},infoBtn:{ini:false,action:function(a){this.getSubNode("INFO").css("display",a?"":"none")}},optBtn:{ini:false,action:function(a){this.getSubNode("OPT").css("display",a?"":"none")}},toggleBtn:{ini:false,action:function(a){this.getSubNode("TOGGLE").css("display",a?"":"none")}},closeBtn:{ini:false,action:function(a){this.getSubNode("CLOSE").css("display",a?"":"none")}},refreshBtn:{ini:false,action:function(a){this.getSubNode("REFRESH").css("display",a?"":"none")}},popBtn:{ini:false,action:function(a){this.getSubNode("POP").css("display",a?"":"none")}},tagCmds:{ini:[],action:function(){this.boxing().refresh()}}},LayoutTrigger:function(){var a=this,b=a.properties;if(!b.toggle){a.box._toggle(a,false,true)}else{a.boxing().iniPanelView()}},EventHandlers:{onIniPanelView:function(a){},beforeFold:function(a){},beforeExpand:function(a){},afterFold:function(a){},afterExpand:function(a){},onClickBar:function(a,b){},onClickPanel:function(a,b,c){},beforePop:function(b,a,c,d){},beforeClose:function(a){},onShowInfo:function(a,b,c){},onShowOptions:function(a,b,c){},onRefresh:function(a){},onCmd:function(a,c,b,d){}},_prepareData:function(b){var c=arguments.callee.upper.call(this,b),a="display:none";c._bordertype="xui-uiborder-"+c.borderType;c._bbarDisplay=c.noFrame?a:"";c._leftp=c.noFrame?"padding-left:0;":"";c._rightp=c.noFrame?"padding-right:0;background-image:none;":"";c.toggleDisplay=c.toggleBtn?"":a;c.panelDisplay=c.toggleBtn&&!c.toggle?a:"";c._fi_toggleCls2=c.toggleIcon+(c.toggleBtn&&c.toggle?" xuifont-checked "+c.toggleIcon+"-checked":"");b._toggle=!!c.toggle;c.infoDisplay=c.infoBtn?"":a;c.optDisplay=c.optBtn?"":a;c.closeDisplay=c.closeBtn?"":a;c.popDisplay=c.popBtn?"":a;c.refreshDisplay=c.refreshBtn?"":a;c._align="text-align:"+c.hAlign+";";if(!xui.isEmpty(c.tagCmds)){this._prepareCmds(b,c)}return c},_toggle:function(c,d,a){var e=c.properties,b=c.boxing();if(d){b.iniPanelView()}if(a||c._toggle!==!!d){c._toggle=e.toggle=!!d;if(!a){if(d){if(b.beforeExpand&&false===b.beforeExpand(c)){return}}else{if(b.beforeFold&&false===b.beforeFold(c)){return}}}if(e.toggleBtn){c.getSubNode("TOGGLE").tagClass("-checked",!!d)}c.adjustSize(true);if(!a){if(d){if(b.afterExpand){b.afterExpand(c)}}else{if(b.afterFold){b.afterFold(c)}}}if(e.dock&&e.dock!="none"){b.adjustDock(true)}}},_onresize:function(j,A,x){var g=j.properties,r=xui.$us(j),F=function(G,H){return j.$forceu(G,r>0?"em":"px",H)},B=j.getRoot();var q={},E=g.noFrame,C=j.getSubNode("BORDER"),f=j.getSubNode("TBAR"),u=j.getSubNode("PANEL"),d=j.getSubNode("BBAR"),b=j.getSubNode("MAIN"),a=j.getSubNode("MAINI"),D=j.getEmSize()/B._getEmSize(),s=u._getEmSize(D),e=C.contentBox(),o=C._borderH(),c=u.contentBox(),l=j.properties.borderType!="none"?u._borderW():0,n,m,w;if(A&&A!="auto"){A=j.$px(A,null,true)}if(x&&x!="auto"){x=j.$px(x,null,true)}if(x){if(j._toggle){u.css("display","")}else{u.css("display","none")}if(x=="auto"){B.height(q.height="auto")}else{if(j._toggle){n=f.offsetHeight(true);m=E?0:d.offsetHeight(true);if((w=x-o-n-m)>0){q.height=F(w-(c?l:0),s)}C.height(F(x-(e?o:0),C));B.height(F(x))}else{C.height("auto");B.height("auto")}}}if(A){q.width=F(A-(E?0:(Math.round(parseFloat(a.css("paddingRight")))||0))-(E?0:(Math.round(parseFloat(b.css("paddingLeft")))||0))-o-l-(b._borderW())-(a._borderW()),s)}if(j._toggle){u.cssSize(q,true);if(A){xui.UI._adjustConW(j,u,q.width)}}}}});xui.Class("xui.UI.Group","xui.UI.Panel",{Static:{Templates:{tagName:"div",style:"{_style}",className:"{_className}",BORDER:{tagName:"fieldset",className:"{_fieldCls} xui-uibar-top2",TBAR:{tagName:"legend",style:"{_align} ",BARCMDL:{LTAGCMDS:{tagName:"span",className:"xui-ltag-cmds",style:"{_ltagDisplay}",text:"{ltagCmds}"},TOGGLE:{$order:1,className:"xuifont",$fonticon:"{_fi_toggleCls2}",style:"{toggleDisplay}",$order:0},ICON:{$order:2,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{tabindex:"{tabindex}",className:"xui-title-node",text:"{caption}",$order:3}},BARCMDR:{$order:4,tagName:"div",className:"xui-uibar-cmdr xui-uibase",RTAGCMDS:{$order:0,tagName:"span",className:"xui-rtag-cmds",style:"{_rtagDisplay}",text:"{rtagCmds}"},INFO:{className:"xuicon",$fonticon:"xui-uicmd-info",style:"{infoDisplay}",$order:1},OPT:{className:"xuicon",$fonticon:"xui-uicmd-opt",style:"{optDisplay}",$order:2},POP:{className:"xuicon",$fonticon:"xui-uicmd-pop",style:"{popDisplay}",$order:3},REFRESH:{className:"xuicon",$fonticon:"xui-uicmd-refresh",style:"{refreshDisplay}",$order:4},CLOSE:{className:"xuicon",$fonticon:"xui-uicmd-close",style:"{closeDisplay}",$order:5}}},PANEL:{$order:1,tagName:"div",style:"{panelDisplay};{_panelstyle};{_overflow};",className:"xui-uicontainer xui-uiborder-radius-bl xui-uiborder-radius-br",text:"{html}"+xui.UI.$childTag}},$submap:xui.UI.$getTagCmdsTpl()},Appearances:{KEY:{zoom:xui.browser.ie6?"1":null},BORDER:{position:"relative",overflow:"visible",zoom:xui.browser.ie6?"1":null},"LTAGCMDS, RTAGCMDS":{padding:0,margin:0,"vertical-align":"middle"},TBAR:{width:"auto",padding:"0 0 .1666667em 0",margin:"0 0 0 .5em",border:0,"font-size":"inherit"},"BORDER-checked TBAR":{"margin-left":"-.5em"},"BORDER-checked BARCMDL":{"padding-left":"1em"},BARCMDL:{cursor:"default","padding-right":".25em",display:xui.$inlineBlock},PANEL:{position:"relative",overflow:"auto","line-height":"normal",background:xui.browser.ie?"url("+xui.ini.img_bg+") no-repeat left top":null},CAPTION:{display:"inline","vertical-align":xui.browser.ie6?"baseline":"middle"},TOGGLE:{padding:"0 .334em 0 0"}},DataModel:{expression:{ini:"",action:function(){}},dock:"none",noFrame:null,borderType:null,toggleBtn:{ini:true}},_prepareData:function(a){var b=arguments.callee.upper.call(this,a);if(!a.properties.toggle){b.height="auto"}b._fieldCls=b.toggleBtn&&!b.toggle?" xui-uiborder-t":"xui-uiborder-radius";return b},_toggle:function(d,e,a){var f=d.properties,c=d.boxing();if(e){c.iniPanelView()}if(a||d._toggle!==!!e){d._toggle=f.toggle=!!e;if(!a){if(e){if(c.beforeExpand&&false===c.beforeExpand(d)){return}}else{if(c.beforeFold&&false===c.beforeFold(d)){return}}}if(f.toggleBtn){d.getSubNode("TOGGLE").tagClass("-checked",!!e)}var b=d.getSubNode("BORDER");if(e){b.removeClass("xui-uiborder-t").addClass("xui-uiborder-flat xui-uiborder-radius")}else{b.removeClass("xui-uiborder-flat xui-uiborder-radius").addClass("xui-uiborder-t")}d.adjustSize(true);if(!a){if(e){if(c.afterExpand){c.afterExpand(d)}}else{if(c.afterFold){c.afterFold(d)}}}if(f.dock&&f.dock!="none"){c.adjustDock(true)}}},_onresize:function(d,c,q){var b=d.properties,g=xui.$us(d),m=function(r,s){return d.$forceu(r,g>0?"em":"px",s)},j=d.getSubNode("BORDER"),a=d.getSubNode("PANEL"),o=d.getRoot(),f=j.contentBox(),n=j._borderH(),l=c?d.$px(c):null,e=q?d.$px(q):null;if(q){if(d._toggle){a.css("display","")}else{a.css("display","none")}if(q=="auto"){a.height("auto");j.height("auto");o.height("auto")}else{if(d._toggle){a.height(m(e-d.getSubNode("TBAR").offsetHeight(true)-n/2,a));j.height(m(e-(f?n:0),j));o.height(m(e))}else{j.height("auto");o.height("auto")}}}if(c&&c!="auto"&&l>=2&&d._toggle){a.width(l=m(l-2));xui.UI._adjustConW(d,a,l)}}}});xui.Class("xui.UI.PageBar",["xui.UI","xui.absValue"],{Instance:{_setCtrlValue:function(a){return this.each(function(e){if(!e.renderId){return}var m,c=e.properties,B=!c.showMoreBtns,b=e.box._v2a(a),s=b[0],d=b[1],w=b[2],n=e.keys,A=function(D,C){return D.getSubNode(C)},f=A(e,"FIRST"),o=A(e,"PREV"),x=A(e,"PREM"),r=A(e,"CUR"),q=A(e,"NEXT"),l=A(e,"NEXTM"),g=A(e,"LAST"),j=function(G,F,D,C,E){if(F){G.attr("href",c.uriTpl.replace("*",F));G.attr("title",F)}else{if(E){G.attr("title",E)}}if(xui.isSet(D)){G.html(c.textTpl.replace("*",D),false)}if(xui.isSet(C)){G.get(0)._real_page=C}},u=function(D,C){D.css("display",C?"":"none")};j(f,s,s);j(x,"",".."+xui.str.repeat(".",String(d-1-s).length),1,(s+1)+"~"+(d-2));j(o,d-1,c.prevMark||(d-1));r.get(0).value=d+"";j(q,d+1,c.nextMark||(d+1));j(l,"",".."+xui.str.repeat(".",String(w-d-1).length),1,(d+2)+"~"+(w-1));j(g,w,w);if((m=d-s)<=0){u(f,0);u(x,0);u(o,0)}else{if(m==1){u(f,1);u(x,0);u(o,0)}else{if(m==2){u(f,1);u(x,0);u(o,1);j(o,d-1,d-1)}else{u(f,1);u(x,B?0:1);u(o,1);if(m==3){j(o,d-1,d-1);j(x,d-2,d-2,0)}}}}if((m=w-d)<=0){u(g,0);u(l,0);u(q,0)}else{if(m==1){u(g,1);u(l,0);u(q,0)}else{if(m==2){u(g,1);u(l,0);u(q,1);j(q,d+1,d+1)}else{u(g,1);u(l,B?0:1);u(q,1);if(m==3){j(q,d+1,d+1);j(l,d+2,d+2,0)}}}}})},setPage:function(c,b,a){return this.each(function(l){if(!/^[1-9]\d*$/.test(c+"")){return}var j=l.properties,g=j.pageCount,f=(j.$UIvalue||j.value||"")+"",e=f.split(":"),d=parseInt(e[1],10);if(c>parseInt(e[2],10)){return}e[1]=parseInt(c,10)||d;if(b||e[1]!==d){l.boxing().setUIValue(e.join(":"),false,false,"page");if(l.onPageSet){l.boxing().onPageSet(l,e[1],(e[1]-1)*g,g,a||"code",d,(d-1)*g)}}})},getPage:function(d){var f=this.get(0),e=f.properties,c=(e.$UIvalue||e.value||"")+"",b=c.split(":");return b[d?2:1]},buindAPI:function(a){this.api=a;return a},getTotalPages:function(){return this.getPage(true)},setTotalCount:function(a){if(!/^[1-9]\d*$/.test(a+"")){return this}a=parseInt(a,10);return this.each(function(g){var f=g.properties,e=parseInt(f.pageCount,10),b=parseInt((a+e-1)/e,10),d=(f.$UIvalue||f.value||"")+"",c=d.split(":");c[2]=b;if(parseInt(c[1],10)>b){c[1]=1}g.boxing().setUIValue(c.join(":"),false,false,"settotal")})}},Static:{Templates:{style:"{_style} {_hiddenBar}",className:"{_className}",POOL:{style:"position:absolute;display:none;",POP:{tagName:"div",className:"xui-uibase xui-ui-reset xui-ui-ctrl"}},LABEL:{text:"{caption}"},FIRST:{$order:1,tagName:"a",className:"xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius",href:"#",tabindex:"{tabindex}"},PREM:{$order:2,className:"xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius",style:"{_css2}",tagName:"a",href:"#",tabindex:"{tabindex}"},PREV:{$order:3,className:"xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius",tagName:"a",href:"#",tabindex:"{tabindex}",text:"{prevMark}"},CUR:{$order:4,className:"xui-ui-input xui-ui-shadow-input xui-uiborder-flat xui-uiborder-radius xui-uibase",tagName:"input",tabindex:"{tabindex}",style:"{_css}"},NEXT:{$order:5,className:"xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius",tagName:"a",href:"#",tabindex:"{tabindex}",text:"{nextMark}"},NEXTM:{$order:6,className:"xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius",style:"{_css2}",tagName:"a",href:"#",tabindex:"{tabindex}"},LAST:{$order:7,className:"xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius",tagName:"a",href:"#",tabindex:"{tabindex}"}},Appearances:{LABEL:{padding:".25em .5em 0 .5em","vertical-align":"top","white-space":"nowrap"},KEY:{display:"inline",overflow:"visible"},"KEY a:focus, POP a:focus":{"outline-offset":"","-moz-outline-offset":(xui.browser.gek&&xui.browser.ver<3)?"":null},"KEY .xui-ui-btn, KEY .xui-ui-input, POP .xui-ui-btn":{"margin-right":".25em"},CUR:{"font-weight":"bold","text-align":"center",padding:".25em",width:"2em","margin-top":"-1px"},POP:{border:"dotted 1px gray",position:"absolute",padding:".25em","line-height":"2.25em"}},Behaviors:{HoverEffected:{FIRST:"FIRST",PREM:"PREM",PREV:"PREV",NEXT:"NEXT",NEXTM:"NEXTM",LAST:"LAST",POPI:"POPI",CUR:"CUR"},ClickEffected:{FIRST:"FIRST",PREM:"PREM",PREV:"PREV",NEXT:"NEXT",NEXTM:"NEXTM",LAST:"LAST",POPI:"POPI"},POP:{onClick:function(a,c,f){var d=xui(f),b=xui.Event.getSrc(c);d.setBlurTrigger(a.key+":"+a.$xid,null);a.getSubNode("POOL").append(d);if(b.tagName.toLowerCase()=="a"||((b=b.firstChild)&&(b.tagName.toLowerCase()=="a"))||((b=b.firstChild)&&(b.tagName.toLowerCase()=="a"))||((b=b.firstChild)&&(b.tagName.toLowerCase()=="a"))){return a.box._click(a,b)}}},FIRST:{onClick:function(a,b,c){return a.box._click(a,c)}},PREM:{onClick:function(a,b,c){if(xui.use(c).get(0)._real_page){a.box._show(a,b,c,0);return false}else{return a.box._click(a,c)}}},PREV:{onClick:function(a,b,c){return a.box._click(a,c)}},CUR:{onKeypress:function(b,c,f){var a=xui.Event.getKey(c),d=xui.use(f).caret();if(!/^\d$/.test(a.key)){return false}if(a.key==="0"&&d[0]===0){return false}},onChange:function(d,f,b){var c=d.properties;if(c.disabled||c.readonly){return}var n=(c.$UIvalue||c.value||"")+"",j=n.split(":"),m=parseInt(j[1]||"",10),g=parseInt(j[2]||"",10),l=xui.use(b).get(0).value||"";if(!/^[1-9]\d*$/.test(l)){xui(b).attr("value",m+"");return}l=parseInt(l,10);if(m!==l){l=l>g?g:l;xui(b).attr("value",l+"");d.boxing().setPage(l,false,"input")}},onKeydown:function(f,j,l){var g=f.properties,a=f.box,c=xui.Event,d=c.getKey(j);if(g.disabled||g.readonly){return}if(d.key=="enter"){xui.use(l).onChange()}}},NEXT:{onClick:function(a,b,c){return a.box._click(a,c)}},NEXTM:{onClick:function(a,b,c){if(xui.use(c).get(0)._real_page){a.box._show(a,b,c,1);return false}else{return a.box._click(a,c)}}},LAST:{onClick:function(a,b,c){return a.box._click(a,c)}}},DataModel:{dataField:null,dataBinder:null,autoTips:false,dirtyMark:false,showDirtyMark:false,parentID:"",hiddenBar:{ini:false,action:function(){this.boxing().refresh()}},isFormField:{hidden:true,ini:false},caption:{ini:" Page: ",action:function(a){a=(xui.isSet(a)?a:"")+"";this.getSubNode("LABEL").html(xui.adjustRes(a,true))}},showMoreBtns:{ini:true,action:function(a){this.getSubNodes(["PREM","NEXTM"]).css("display",a?"":"none")}},pageCount:20,disabled:{ini:false,action:function(b){var c=this.getSubNode("CUR"),a="xui-ui-disabled";if(b){this.getRoot().addClass(a)}else{this.getRoot().removeClass(a)}if(!b&&this.properties.readonly){b=true}c.attr("readonly",b)}},readonly:{ini:false,action:function(b){var c=this.getSubNode("CUR"),a="xui-ui-readonly";if(b){this.getRoot().addClass(a)}else{this.getRoot().removeClass(a)}if(!b&&this.properties.disabled){b=true}c.attr("readonly",b)}},value:"1:1:1",uriTpl:"#*",textTpl:"*",prevMark:"",api:null,nextMark:"",_moreStep:30},EventHandlers:{onClick:function(a,b){},onPageSet:function(d,f,g,e,c,b,a){}},RenderTrigger:function(){var c=this,d=c.properties,b=((d.value||"")+"").split(":");if(d.readonly){c.boxing().setReadonly(true,true)}if(!c.$inDesign){c.boxing().setPage(b[1]||b[0],true,"inited")}},_ensureValue:function(f,g){g=g+"";var e=g.split(":"),j=f.properties,c=[],d=function(b){return parseInt(b,10)||1};if(e.length<3){c=((j.$UIvalue||j.value||"")+"").split(":");e[1]=e[0];e[0]=c[0];e[2]=c[2]}c[0]=d(e[0]);c[1]=d(e[1]);c[2]=d(e[2]);c[0]=Math.max(c[0],1);c[0]=Math.min(c[0],c[1]);c[2]=Math.max(c[1],c[2]);return c.join(":")},_v2a:function(a){a=typeof a=="string"?a.split(":"):a;a[0]=parseInt(a[0],10);a[1]=parseInt(a[1],10);a[2]=parseInt(a[2],10);return a},_click:function(f,l){var j=f.properties;if(j.disabled||j.readonly){return false}var c=f.boxing(),d=(j.$UIvalue||j.value||"").split(":"),e=parseInt(xui(l).attr("href").split("#")[1],10)||d[1]||d[0];var g=c.onClick(e);if(!d.length||(e+"")!==(d[1]+"")){c.setPage(e,false,"click")}return typeof g=="boolean"?g:false},_show:function(j,G,o,F){var d=j.properties;if(d.disabled||d.readonly){return false}var w=d.parentID||xui.ini.$rootContainer,b=j.box._v2a(d.value),C=b[0],g=b[1],E=b[2],s=j.keys,H=function(e,a){return e.getSubNode(a)},u=H(j,"POOL"),q=H(j,"POP"),c=function(a){return Math.ceil((a+1)/10)*10},I=[],r,A,x,D,B;if(F){if((r=E-1-g)<=0){return}x=g+1;B=E}else{if((r=g-1-C)<=0){return}x=1;B=g-1}A=Math.ceil(r/d._moreStep);if(A>10){x=c(x);B=c(B)-1;A=c(A)}else{x=x+A}var f=j.keys.POPI+":"+j.serialId+":";while(x<B){I.push('<a style="margin-top:.25em;" id="'+f+x+'" class="xui-node xui-node-span xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius" href="'+d.uriTpl.replace("*",x)+'">'+d.textTpl.replace("*",x)+"</a>");x=x+A}q.width("auto");q.html(I.join(" "));xui("body").append(q);if(q.width()>300){q.width(300)}q.popToTop(o,null,w?xui.get(j,["host",w])?j.host[w].getContainer():xui(w):null);q.setBlurTrigger(j.key+":"+j.$xid,function(){u.append(q)})},_prepareData:function(a){var b=arguments.callee.upper.call(this,a),c=a.properties;b._hiddenBar=c.hiddenBar?";display:none":"";b._css=xui.browser.kde?"resize:none;":"";b._css2=b.showMoreBtns?"":"display:none;";return b}},Initialize:function(){this.addTemplateKeys(["POPI"])}});xui.Class("xui.UI.Tabs",["xui.UI","xui.absList","xui.absValue"],{Instance:{_setCtrlValue:function(a){this.each(function(e){var c=e.domId,g=e.boxing(),q=g.getUIValue(),b=e.properties,j=e.box.$DataModel,f=e.getSubNode("MENUCAPTION"),l=e.getSubNode("MENUCLOSE"),m=function(A,s){var w=e.getSubIdByItemId(A),x=e.getItemByItemId(A);if(w){s.push(w);if(!j.hasOwnProperty("noPanel")||!b.noPanel){var u=g.getPanel(A).get(0);if(u&&(x._scrollTop=u.scrollTop||0)){u.scrollTop=0}g.getPanel(A).css("display","none")}}},r=function(x,s){var u=e.getSubIdByItemId(x),w=e.getItemByItemId(x);if(u){s.push(u);f.html(w.caption);l.css("display",w.closeBtn?"":"none");e._menuId=w.id;if(!j.hasOwnProperty("noPanel")||!b.noPanel){g.getPanel(x).css("display","block");if(w._scrollTop){g.getPanel(x).get(0).scrollTop=w._scrollTop}e.adjustSize(false,false,a);e.box._forLazyAppend(e,w,a);e.box._forIniPanelView(e,w)}}};var o=[],n=[];if(j.hasOwnProperty("selMode")&&j.hasOwnProperty("noPanel")&&b.noPanel&&b.selMode=="multi"){q=q?q.split(b.valueSeparator):[];xui.arr.each(q,function(s){m(s,o)});a=a?a.split(b.valueSeparator):[];var d="";xui.arr.each(a,function(u){var s=n.length;r(u,n);if(s<n.length){d=u}})}else{m(q,o);r(a,n)}if(o.length){e.getSubNodes(["ITEM","TOGGLE"],o).tagClass("-checked",false);e.getSubNodes("ITEM",o).tagClass("-checked",false)}if(n.length){e.getSubNodes(["ITEM","TOGGLE"],n).tagClass("-checked");e.getSubNodes("ITEM",n).tagClass("-checked")}})},append:function(e,a,d,b){var c=this.get(0).properties;if(a=a||c.$UIvalue||c.value){arguments.callee.upper.call(this,e,a+"",d,b)}return this},getCurPanel:function(){var c=this.get(0),b=c.box.$DataModel,a=c.properties.$UIvalue;if(b.hasOwnProperty("noPanel")&&b.hasOwnProperty("selMode")&&c.properties.selMode=="multi"){a=a.split(prop.valueSeparator);a=a[0]||null}return a?this.getPanel(a):null},autoSave:function(){var a=this.getActiveModule();if(a){a.autoSave()}},getActiveModule:function(){if(this.getSelectedItem()){var a=this.getSelectedItem().euClassName;return this.getModule().getChildModule(a)}return null},getPanel:function(a){var b=this.get(0);return b.getSubNodeByItemId("PANEL",a+"")},addPanel:function(l,b,j){var f=this,c={},d=[],a=j&&j.id,e=f.getItems(),g=l.id||l.tag;if(e.length){if(-1!=xui.arr.subIndexOf(e,"id",g)){return false}}xui.merge(c,{caption:l.caption,image:l.image,closeBtn:l.closeBtn||false,popBtn:l.popBtn||false,optBtn:l.optBtn||false,imagePos:l.imagePos,imageBgSize:l.imageBgSize,dragKey:l.dragKey,dropKeys:l.dropKeys,id:l.id||l.tag||xui.id()});if(a){f.insertItems([c],a,true)}else{f.insertItems([c])}xui.arr.each(b,function(m){d.push(m[0])});f.append(xui.UI.pack(d,false),c.id);return f},removePanel:function(c){var a=this,b=a.getItemByDom(c);return a.removeItems([b.id])},getPanelPara:function(e){var c=this.get(0),a=c.properties,d=c.getItemByDom(e),b=xui.clone(d,false);if(!b.dragKey){b.dragKey=a.dragKey}if(!b.dropKeys){b.dropKeys=a.dropKeys}return b},getAllFormValues:function(b){var c=this.getChildren(),d=xui.absValue.pack(c),e={},g={},f=this.get(0);xui.arr.each(f.children,function(l){var a=l[0].boxing(),j=a.getProperties().name||l[0].alias;if(xui.isArr(l)&&l.length>1&&xui.isStr(l[1])){j=l[1]}if(a.Class["xui.UI.Tabs"]){xui.merge(g,a.getAllFormValues(b),"all")}else{if(a.Class["xui.UI.Block"]||a.Class["xui.UI.Panel"]||a.Class["xui.UI.Layout"]){if(b&&!xui.str.endWith(j,"Main")){if(!g[j]){g[j]=a.getAllFormValues(b)}else{xui.merge(g[j],a.getAllFormValues(b),"all")}}else{xui.merge(g,a.getAllFormValues(b),"all")}}else{if(a.getFormValues){g[j]=a.getFormValues()}else{if(a.getUIValue){g[j]=a.getUIValue()}else{if(a.getValue){g[j]=a.getValue()}}}}}});e[f.properties.name||f.alias]=g;return e},getPanelChildren:function(c){var b=this.get(0),d=b.getItemIdByDom(c),a=[];if(d){xui.arr.each(b.children,function(e){if(e[1]==d){a.push(e)}})}return a},resetPanelView:function(b,c,e){if(!xui.isSet(c)){c=true}if(!xui.isSet(e)){e=true}var a,d;return this.each(function(f){if(f.renderId){xui.arr.each(f.properties.items,function(g){if(b===true||(b+"")===g.id){delete g._$ini}});if(c){f.boxing().removeChildren(b,e)}}})},iniPanelView:function(a){return this.each(function(b){if(a){if(a=b.getItemByItemId(a+"")){b.box._forIniPanelView(b,a)}}else{xui.arr.each(b.properties.items,function(c){b.box._forIniPanelView(b,c)})}})},fireItemClickEvent:function(a){var c=this.getSubNodeByItemId("ITEM",a+""),b=xui.Event;c.onClick(true);return this},_afterInsertItems:function(c,e){if(!c.renderId){return}var d=c.box,f,b,a=c.properties;if(f=c.getSubNode(c.keys.BOX||c.keys.KEY)){f.append(c._buildItems("panels",e));if(!c.box.$DataModel.hasOwnProperty("noPanel")){if(!(b=this.getUIValue())){this.fireItemClickEvent((b=a.items[0])&&b.id)}}c.adjustSize()}},removeItems:function(a,d){var b=this,f,e,c;b.each(function(g){var j=g.properties;a=xui.isSet(a)?xui.isArr(a)?a:(a+"").split(j.valueSeparator):null;if(!a){a=((j.$UIvalue||j.value)+"").split(j.valueSeparator)}if(!g.box.$DataModel.hasOwnProperty("noPanel")||!g.properties.noPanel){xui.arr.each(a,function(l){c=g.getSubIdByItemId(l+"");if(c&&!(e=g.getSubNode("PANEL",c)).isEmpty()){e.remove(true,d)}})}});arguments.callee.upper.apply(b,arguments);b.each(function(g){if(!g.boxing().getUIValue()){xui.asyRun(function(){if(!g||!g.renderId||!g.properties||!g.properties.items.length){return}var j;g.boxing().fireItemClickEvent((j=g.properties.items[0])&&j.id)})}g.adjustSize()});return b},clearItems:function(b){var a=this;a.each(function(c){if(!c.box.$DataModel.hasOwnProperty("noPanel")||!c.properties.noPanel){c.getSubNode("PANEL",true).remove(true,b)}});a.setValue(null,true,"clear");arguments.callee.upper.apply(a,arguments);return a},markItemCaption:function(a,f,c,m,l){var e=this.get(0);a=e.getItemByItemId(a+"");if((a._dirty!=f)||c){var b=a.id,j=e.getItemByItemId(b),g=j.caption,d=e.getSubNodeByItemId("CAPTION",b);if(m){if(xui.isFun(m)){j.caption=m(e,j,f);d.html(j.caption)}else{d.html(j.caption=f?m+g:g.replace(new RegExp("^"+m),""))}}else{d.html(j.caption=f?"*"+g:g.replace(/^\*/,""))}if(l){if(f){d.addCalss(l)}else{d.removeCalss(l)}}else{d.css({"font-weight":f?"bold":"","font-style":f?"italic":""})}a._dirty=f}return this}},Static:{Templates:{tagName:"div",style:"{_style};",className:"{_className}",LIST:{$order:1,tagName:"div",style:"{_liststyle}",LISTBG:{$order:0,className:"xui-uiborder-t xui-uiborder-b xui-uiborder-dark xui-uibar-checked"},MENU:{className:"xui-ui-unselectable xui-uiborder-hidden xui-uiborder-radius",MENUICON:{className:"xuicon",$fonticon:"xui-icon-menu"},MENUCAPTION:{},MENUCLOSE:{className:"xuifont",$fonticon:"xui-uicmd-close",$order:2}},MENU2:{tagName:"div",className:"xui-ui-unselectable",MENUICON2:{className:"xui-uiborder-hidden xui-uiborder-radius xuicon {_iconChecked}",$fonticon:"xui-icon-menu"}},ITEMS:{tagName:"div",className:"xui-ui-unselectable {_specialIconCls}",text:"{items}",style:"{HAlign}"}},PNAELS:{$order:2,tagName:"text",text:"{panels}"},$submap:{items:{ITEM:{className:"xui-uiborder-flat xui-uiborder-nob xui-uiborder-box xui-uiborder-radius-big-tl xui-uiborder-radius-big-tr xui-uibar {itemClass} {disabled} {readonly}",style:"{_itemDisplay} {itemStyle}{_itemColor}",ITEMI:{ITEMC:{HANDLE:{tabindex:"{_tabindex}",className:"xui-showfocus",IBWRAP:{tagName:"div",style:"white-space:nowrap;",RULER:{},LTAGCMDS:{$order:1,tagName:"span",className:"xui-ltag-cmds",style:"{_ltagDisplay}",text:"{ltagCmds}"},ICON:{$order:2,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}{_iconColor}",text:"{iconFontCode}"},CAPTION:{$order:3,text:"{caption}",className:"xui-title-node",style:"{itemWidth};{itemAlign}{_fontColor}"},CMDS:{$order:4,RTAGCMDS:{$order:0,tagName:"span",className:"xui-rtag-cmds",style:"{_rtagDisplay}",text:"{rtagCmds}"},OPT:{$order:1,className:"xuifont",$fonticon:"xui-uicmd-opt",style:"{_opt}"},POP:{className:"xuifont",$fonticon:"xui-uicmd-pop",style:"{popDisplay}",$order:1},CLOSE:{className:"xuifont",$fonticon:"xui-uicmd-close",style:"{closeDisplay}",$order:2}}}}}}}},panels:{PANEL:{tagName:"div",className:"xui-uibase xui-uicontainer",style:"{_overflow};{_bginfo}",text:"{html}"+xui.UI.$childTag}},"items.ltagCmds":function(e,d,c,b,a){var f=arguments.callee,g=f._m||(f._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(e,d,c,"items.tagCmds"+(g[c.type]||".button"),a)},"items.rtagCmds":function(e,d,c,b,a){var f=arguments.callee,g=f._m||(f._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(e,d,c,"items.tagCmds"+(g[c.type]||".button"),a)},"items.tagCmds.text":xui.UI.$getTagCmdsTpl("text"),"items.tagCmds.button":xui.UI.$getTagCmdsTpl("button"),"items.tagCmds.image":xui.UI.$getTagCmdsTpl("image")}},Appearances:{KEY:{position:"absolute",overflow:"hidden"},LIST:{position:"relative",overflow:"hidden",left:0,width:"100%","white-space":"nowrap"},LISTBG:{position:"absolute",overflow:"hidden",left:0,bottom:0,height:"3px",width:"100%"},MENU:{display:"none",margin:".25em",padding:".16667em",cursor:"pointer"},MENU2:{display:"none"},MENUCAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle",margin:"0 4px","font-size":"1em"},ITEMS:{padding:xui.browser.contentBox?"0 0 4px 0":"0 0 2px 0",position:"relative",left:0,top:0,"white-space":"nowrap"},"ITEMS-icon CAPTION, ITEMS-icon OPT, ITEMS-icon POP, ITEMS-icon2 CAPTION, ITEMS-icon2 OPT, ITEMS-icon2 POP":{display:"none"},"ITEMS-menu ITEM":{display:"none"},ITEM:{$order:0,cursor:"pointer",padding:"0 .5em 0 0","vertical-align":"top",height:"2.75em","border-bottom":0,"-moz-border-radius":"6px 6px 0 0","-webkit-border-radius":"6px 6px 0 0","-o-border-radius":"6px 6px 0 0","-ms-border-radius":"6px 6px 0 0","-khtml-border-radius":"6px 6px 0 0"},ITEMI:{$order:0,"padding-left":".5em","vertical-align":"top"},ITEMC:{$order:0,padding:"0.75em 0 0 0","vertical-align":"top","text-align":"center"},HANDLE:{display:xui.$inlineBlock,zoom:xui.browser.ie6?1:null,cursor:"pointer","vertical-align":"middle",padding:0},"ITEM-checked HANDLE":{"padding-bottom":"1px"},RULER:{height:"1.5em",width:"0","vertical-align":"middle"},PANEL:{position:"relative",display:"none",width:"100%",overflow:"auto"},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle",margin:"0 4px 0 8px",overflow:"hidden"},CMDS:{"vertical-align":"middle"},"LTAGCMDS, RTAGCMDS":{padding:0,margin:0,"vertical-align":"middle"},CMD:{padding:0,margin:0}},Behaviors:{NOTIPS:["GROUP","HANDLER"],DroppableKeys:["PANEL","LIST","ITEM"],PanelKeys:["PANEL"],DraggableKeys:["ITEM"],HoverEffected:{ITEM:"ITEM",MENU:"MENU",MENU2:"MENU2",MENUICON2:"MENUICON2",OPT:"OPT",CLOSE:"CLOSE",MENUCLOSE:"MENUCLOSE",POP:"POP",ICON:"ICON",CMD:"CMD"},ClickEffected:{ITEM:"ITEM",MENU:"MENU",MENU2:"MENU2",MENUICON2:"MENUICON2",OPT:"OPT",CLOSE:"CLOSE",MENUCLOSE:"MENUCLOSE",POP:"POP",CMD:"CMD"},CAPTION:{onMousedown:function(b,f,g){if(xui.Event.getBtn(f)!="left"){return}var a=b.properties,d=b.getItemByDom(g),c=b.boxing();if(a.disabled||d.disabled){return false}if(a.readonly||d.readonly){return false}if(c.getUIValue()==d.id){if(b.onCaptionActive){b.boxing().onCaptionActive(b,b.getItemByDom(g),f,g)}}}},ITEM:{onClick:function(d,m,a){if(xui.Event.getBtn(m)!="left"){return false}var s;if((s=xui.Event.getSrc(m).parentNode)&&s.id&&(d.getKey(s.id))==d.keys.CMDS){return false}var b=d.properties,l=d.box.$DataModel,n=d.getSubId(a),r=d.getItemByDom(a),j=d.boxing();if(b.disabled||r.disabled){return false}if(b.readonly||r.readonly){return false}if(l.hasOwnProperty("selMode")&&l.hasOwnProperty("noPanel")&&b.noPanel&&b.selMode=="multi"){var q=j.getUIValue(),g=q?q.split(b.valueSeparator):[],o=1,f=false,c=false;if(g.length){if(xui.arr.indexOf(g,r.id)!=-1){xui.arr.removeValue(g,r.id);o=-1}else{g.push(r.id)}g.sort();q=g.join(b.valueSeparator);if(j.getUIValue()==q){f=false}else{j.setUIValue(q,null,null,"md");if(j.get(0)&&j.getUIValue()==q){f=j.onItemSelected(d,r,m,a,o)||c}}return f}}if(j.getUIValue()!=r.id){j.setUIValue(r.id,null,null,"md");if(j.getUIValue()==r.id){f=j.onItemSelected(d,r,m,a)||c;return f}}}},HANDLE:{onKeydown:function(c,g,a){var o=xui.Event.getKey(g),n=o.key,b=o.shiftKey;if(n==" "||n=="enter"){c.getSubNode("ITEM",c.getSubId(a)).onClick();return false}var m=xui(a),j=c.getSubNode("ITEMS"),f=j.nextFocus(true,true,false),l=j.nextFocus(false,true,false);switch(n){case"tab":if(b){if(m.get(0)!=f.get(0)){f.focus(true);return false}}else{if(m.get(0)!=l.get(0)){l.focus(true);return false}}break;case"left":case"up":var d=m.nextFocus(false,true,false);if(m.get(0)==f.get(0)){l.focus(true)}else{m.nextFocus(false)}return false;break;case"right":case"down":var d=m.nextFocus(true,false,false);if(m.get(0)==l.get(0)){f.focus(true)}else{m.nextFocus()}return false;break}}},CMD:{onClick:function(a,c,d){var f=a.properties,b=a.getItemByDom(xui.use(d).parent().get(0));if(!b){return false}if(f.disabled||b.disabled||b.type=="split"){return false}if(a.onCmd){a.boxing().onCmd(a,b,xui.use(d).id().split("_")[1],c,d)}return false}},OPT:{onClick:function(a,b,c){a.boxing().onShowOptions(a,a.getItemByDom(c),b,c);return false}},CLOSE:{onClick:function(c,f,a){var j=c.properties,q=c.getItemByDom(a),l=j.$UIvalue,n;if(j.disabled||q.disabled){return}if(j.readonly||q.readonly){return false}var m=c.boxing();if(false===m.beforePageClose(c,q,a)){return}n=xui.copy(q);if(l&&l==q.id){var g=j.items,d=xui.arr.subIndexOf(g,"id",q.id),o,b=(o=g[d+1])?o.id:(o=g[d-1])?o.id:(o=g[0])?o.id:null;if(b&&b!=l){c.boxing().fireItemClickEvent(b)}}m.removeItems(q.id);m.afterPageClose(c,n);c.adjustSize();return false}},MENUCLOSE:{onClick:function(a,b,c){a.getSubNodeByItemId("CLOSE",a._menuId).onClick(true)}},POP:{onClick:function(d,g,a){var l=d.properties,q=d.getItemByDom(a),s={parent:null,host:null,properties:null,events:null,CS:null,CC:null,CB:null,CF:null,init:null},c=q.id;if(l.disabled||q.disabled){return false}if(l.readonly||q.readonly){return false}if(d.beforePagePop&&false==d.boxing().beforePagePop(d,q,s,g,a)){return false}var b=d.boxing().getPanel(c),m=d.getRoot().offset(),r=d.getRoot().cssSize(),n=xui.copy(xui.UI.Dialog.$DataStruct),o={};xui.merge(n,q,"with");xui.merge(n,{dragKey:q.dragkey||l.dragKey,dock:"none",tag:q.tag||q.id,width:Math.max(r.width,200),height:Math.max(r.height,100),left:m.left,top:m.top,landBtn:true},"all");if(s.properties){xui.merge(n,s.properties,"with")}if(s.events){xui.merge(o,s.events,"all")}var j=new xui.UI.Dialog(n,o,s.host||d.host,s.CS||null,s.CC||null,s.CB||null,s.CF||null);if(xui.isFun(s.init)&&false===s.init(j,d,s)){}else{j.show(s.parent||xui("body"));var f=[];xui.arr.each(d.children,function(e){if(e[1]==c){f.push(e[0])}});if(f.length){j.append(xui.UI.pack(f,false))}d.boxing().removeChildren(c).removeItems(c)}return false}},MENU:{onMouseover:function(c,m,a){var b=c._droppopmenu;if(b){return}var j=c.boxing(),n=c.properties.items,f=[],d=n.length,o;if(n.length>10){o=Math.ceil(d/10);for(var g=0;g<o;g++){f.push({caption:(g*10+1)+" - "+Math.min(d,((g+1)*10+1)),sub:[]})}xui.arr.each(n,function(l,e){f[parseInt(e/10)].sub.push(xui.clone(l,false,1))})}else{f=xui.clone(n,false,2)}b=c._droppopmenu=new xui.UI.PopMenu({items:f,autoHide:true},{onMenuSelected:function(e,l){j.fireItemClickEvent(l.id)},beforeHide:function(w,u){if(u){var q=xui(a),x=xui.Event.getPos(u),l=q.cssSize(),s=3,r=q.offset();if(x.left>r.left&&x.top>r.top-s&&x.left<r.left+l.width&&x.top<r.top+l.height){return false}}},onHide:function(){c._droppopmenu.destroy(true);delete c._droppopmenu}});b.pop(a)},onMouseout:function(c,d,a){var g;if(g=c._droppopmenu){var b=g.get(0).getRoot(),j=xui.Event.getPos(d),m=b.cssSize(),l=3,f=b.offset();if(j.left>f.left&&j.top>f.top-l&&j.left<f.left+m.width&&j.top<f.top+m.height){}else{g.hide()}}},onClick:function(b,a,c){xui(c).onMouseover(true)}},PANEL:{onClick:function(a,d,f){var c=a.properties,b=a.getItemByDom(f);if(c.disabled||b.disabled){return false}if(a.onClickPanel){return a.boxing().onClickPanel(a,b,d,f)}}}},DataModel:{rotate:null,iconColors:null,itemColors:null,fontColors:null,autoFontColor:{ini:false,action:function(){this.boxing().refresh()}},autoIconColor:{ini:true,action:function(){this.boxing().refresh()}},autoItemColor:{ini:false,action:function(){this.boxing().refresh()}},expression:{ini:"",action:function(){}},selectable:true,dirtyMark:false,lazyAppend:true,isFormField:{hidden:true,ini:false},dock:"fill",width:{$spaceunit:1,ini:"18em"},height:{$spaceunit:1,ini:"18em"},position:"absolute",itemWidth:{ini:0,action:function(a){this.getSubNode("CAPTION",true).width(a)}},itemAlign:{ini:"",listbox:["","left","center","right"],action:function(a){this.getSubNode("CAPTION",true).css("text-align",a)}},HAlign:{ini:"left",listbox:["left","center","right"],action:function(a){this.getSubNode("ITEMS").css("textAlign",a)}},dropKeysPanel:"",value:{ini:""},selMode:{ini:"single",listbox:["single","multi"]},noPanel:{ini:false,action:function(a){this.getSubNode("PANEL",true).css("display",a?"none":"block");this.adjustSize(null,true)}},noHandler:{ini:false,action:function(a){this.getSubNode("LIST").css("display",a?"none":"block");this.adjustSize(null,true)}},tagCmds:{ini:[],action:function(){this.boxing().refresh()}}},EventHandlers:{onCmd:function(a,b,d,c,f){},onIniPanelView:function(a,b){},beforePagePop:function(b,c,a,d,f){},beforePageClose:function(a,b,c){},afterPageClose:function(a,b){},onShowOptions:function(a,b,c,d){},onItemSelected:function(b,c,d,f,a){},onCaptionActive:function(a,b,c,d){},onClickPanel:function(a,b,c,d){}},RenderTrigger:function(){var b=this,a,d,c;if(a=b.properties.value){(c=b.boxing()).setUIValue(a,null,null,"render");if(d=b.getItemByItemId(a)){c.onItemSelected(b,d)}}},_prepareData:function(a){var b=arguments.callee.upper.call(this,a);b.panels=b.items,p=a.properties,ns=this;if(b.HAlign){b.HAlign="text-align:"+b.HAlign+";"}b._liststyle=b.noHandler?"display:none":"";if(b.sideBarStatus=="fold"){b._specialIconCls=a.getClass("ITEMS")+"-icon2";b._iconChecked=" xui-uiborder-hidden-checked xui-icon-menu-checked "}xui.arr.each(b.items,function(d){var c=d.index;if(!c){c=xui.arr.indexOf(b.items,d)}ns._autoColor(d,c,p)});return b},_initIconColors:function(d,f){var c=[],b=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],e=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],a=["#F19B60","#49CD81","#0277bd","#A693EB","#42a3af","#B0E0E6","#F06292"];switch(d){case"icon":c=b;if(f.iconColors&&f.iconColors.length>0){c=f.iconColors}break;case"font":c=e;if(f.fontColors&&f.fontColors.length>0){c=f.fontColors}break;case"item":c=a;if(f.itemColors&&f.itemColors.length>0){c=f.itemColors}break}return c},_autoColor:function(d,c,f){c=c||0;if(f.autoFontColor||d.fontColor){var e=this._initIconColors("font",f);while(c&&c>(e.length-1)){c=c-e.length}if(!d.fontColor){d.fontColor=e[c]}d._fontColor=d.fontColor?";color:"+d.fontColor:""}if(f.autoIconColor||d.iconColor){var b=this._initIconColors("icon",f);while(c&&c>(b.length-1)){c=c-b.length}if(!d.iconColor){d.iconColor=b[c]}d._iconColor=d.iconColor?";color:"+d.iconColor:""}if(f.autoItemColor||d.itemColor){var a=this._initIconColors("item",f);while(c&&c>(a.length-1)){c=c-a.length}if(!d.itemColor){d.itemColor=a[c]}d._itemColor=d.itemColor?";background-color:"+d.itemColor:"";d._fontColor=";color:#ffffff";d._iconColor=";color:#ffffff"}},_prepareItem:function(b,j,c,d,e,f){var l="display:none",a=b.properties,g;this._autoColor(j,e,a);if(!j.closeBtn){j.closeBtn=a.closeBtn}if(!j.autoSave){j.autoSave=a.autoSave}if(!j.optBtn){j.optBtn=a.optBtn}j.closeDisplay=j.closeBtn?"":l;j.popDisplay=j.popBtn?"":l;j._opt=j.optBtn?"":l;j._itemDisplay=j.hidden?l:"";if(g=j.itemWidth||a.itemWidth){j.itemWidth="width:"+g+(xui.isFinite(g)?"px":"")}if(g=j.itemAlign||a.itemAlign){j.itemAlign="text-align:"+g}j._bginfo="";if(g=j.panelBgClr||a.panelBgClr){j._bginfo+="background-color:"+g+";"}if(g=j.panelBgImg||a.panelBgImg){j._bginfo+="background-image:url("+xui.adjustRes(g)+");"}if(g=j.panelBgImgPos||a.panelBgImgPos){j._bginfo+="background-position:"+g+";"}if(g=j.panelBgImgRepeat||a.panelBgImgRepeat){j._bginfo+="background-repeat:"+g+";"}if(g=j.panelBgImgAttachment||a.panelBgImgAttachment){j._bginfo+="background-attachment:"+g+";"}if(xui.isStr(j.overflow)){j._overflow=j.overflow.indexOf(":")!=-1?(j.overflow):(data.overflow?("overflow:"+data.overflow):"")}else{if(xui.isStr(a.overflow)){j._overflow=a.overflow.indexOf(":")!=-1?(a.overflow):(a.overflow?("overflow:"+a.overflow):"")}}this._prepareCmds(b,j)},getDropKeys:function(a,c){var d=a.properties,b=a.getItemByDom(c);return a.getKey(xui.use(c).id())==a.keys.PANEL?((b&&b.dropKeysPanel)||d.dropKeysPanel):((b&&b.dropKeys)||d.dropKeys)},_forLazyAppend:function(c,o,m){var b=c.properties,g=c.boxing(),f={},d=c.moduleClass+"["+c.moduleXid+"]";if(b.lazyAppend){var j=c.children,l=[];xui.arr.each(j,function(a){if(a[1]==m&&(!a[0].renderId||xui.UIProfile.getFromDom(xui(a[0].renderId).parent().id())!=c)){l.push(a[0])}});if(l.length){xui.arr.each(l,function(q,r,a){if(q.moduleClass&&q.moduleXid&&(r=xui.SC.get(q.moduleClass))&&(r=r.getInstance(q.moduleXid))&&r["xui.Module"]){a=q.moduleClass+"["+q.moduleXid+"]";if(d!=a&&!f[a]){f[a]=r}}g.append(xui(q),m)})}if(c.$attached){for(var e=0,n;n=c.$attached[e++];){if(n._render){n._render(true)}}delete c.$attached}j=c.exchildren;if(j&&j.length){l=[];xui.filter(j,function(a){if(a[1]==m){l.push(a[0]);return false}});if(l.length){xui.arr.each(l,function(a){if(a.moduleClass&&a.moduleXid&&(y=xui.SC.get(a.moduleClass))&&(y=y.getInstance(a.moduleXid))&&y["xui.Module"]){z=a.moduleClass+"["+a.moduleXid+"]";if(d!=z&&!f[z]){f[z]=y}}g.append(xui(a),m)})}}j=c.excoms;if(j&&j.length){l=[];xui.filter(j,function(a){if(a[1]==m){l.push(a[0]);return false}});if(l.length){xui.arr.each(l,function(a){a.show(null,g,m,false)})}}xui.each(f,function(a){a.render()})}},_forIniPanelView:function(d,n){if(!n){return}var a=d.properties,g=d.boxing();if(!n._$ini){n._$ini=true;if(d.onIniPanelView){g.onIniPanelView(d,n)}if(n.iframeAutoLoad){g.getPanel(n.id).css("overflow","hidden");var m=typeof n.iframeAutoLoad=="string"?{url:n.iframeAutoLoad}:xui.clone(n.iframeAutoLoad,true),b="diframe_"+xui.rand(),l=xui.browser.ie&&xui.browser.ver<9,f=document.createElement(l?"<iframe name='"+b+"'>":"iframe");m.url=xui.adjustRes(m.url,false,true);f.id=f.name=b;if(xui.isHash(n.iframeAutoLoad)){n.iframeAutoLoad.frameName=b}n._frameName=b;if(!m.query){m.query={}}m.query._rand=xui.rand();f.frameBorder="0";f.marginWidth="0";f.marginHeight="0";f.vspace="0";f.hspace="0";f.allowTransparency="true";f.width="100%";f.height="100%";g.getPanel(n.id).html("").append(f);if((m.method||"").toLowerCase()=="post"){xui.Dom.submit(m.url,m.query,"post",b,m.enctype)}else{f.src=m.url}}else{if(n.ajaxAutoLoad){var j=typeof n.ajaxAutoLoad=="string"?{url:n.ajaxAutoLoad}:xui.clone(n.ajaxAutoLoad,true),o={rspType:"text"};xui.merge(o,j.options);if(!j.query){j.query={}}j.query._rand=xui.rand();g.busy(false,null,"PANEL",d.getSubIdByItemId(n.id));var c=g.getPanel(n.id);xui.Ajax(xui.adjustRes(j.url,false,true),j.query,function(e){c.html(e,true,true);g.free()},function(e){c.html("<div>"+e+"</div>",true,false);g.free()},null,o).start()}}}},_showTips:function(d,c,g){if(d.properties.disableTips){return}if(d.onShowTips){return d.boxing().onShowTips(d,c,g)}if(!xui.Tips){return}var a=c.id,e,b,j=d.keys;e=xui.get(c,["parentNode","id"])||"";b=xui.get(c,["parentNode","parentNode","id"])||"";if(a.indexOf(j.ITEM)===0||e.indexOf(j.ITEM)===0||b.indexOf(j.ITEM)===0||a.indexOf(j.HANDLE)===0||e.indexOf(j.HANDLE)===0||b.indexOf(j.HANDLE)===0||a.indexOf(j.CMDS)===0||e.indexOf(j.CMDS)===0||b.indexOf(j.CMDS)===0){var l=arguments.callee.upper,f=l.apply(this,xui.toArr(arguments));l=null;return f}},_onDrop:xui.UI.List._onDrop,_onresize:function(c,n,m,a,x){var b=c.properties,u=c.getItemByItemId(x);if(!u){x=b.$UIvalue||b.value;u=c.getItemByItemId(x)}if(!u){u=b.items[0];x=u&&u.id}if(!u){return}var l=c.boxing().getPanel(x),e=xui.$us(c),w=function(A,B){return c.$forceu(A,e>0?"em":"px",B)},o=c.getRoot(),s=c.getSubNode("LIST"),q=c.getEmSize()/o._getEmSize(),g=l._getEmSize(q),j=s._getEmSize(q),f=null,d=null,r;if(n&&n!="auto"){n=c.$px(n,null,true)}if(m&&m!="auto"){m=c.$px(m,null,true)}if(!l||l.isEmpty()){return}if(!b.noHandler){r=s.offsetHeight(true);if(c._listH!=r){c._listH=r;a=true}}if(a){u._w=u._h=null}if(m&&u._h!=m){u._h=m;if(m=="auto"){d="auto"}else{if(!b.noHandler){m=m-r}if(m>0){d=m}}}else{d=m}if(n&&u._w!=n){s.width(f=w(u._w=n,j));if(!b.noHandler){this._adjustHScroll(c)}}if(!b.noPanel&&(d||f)){l.height(w(d,g)).onSize()}if(f){xui.UI._adjustConW(c,l,f)}},_adjustHScroll:function(d){var n=d.getSubNode("ITEMS"),j=n.width(),m=d.getSubNode("LIST"),b=d.getSubNode("MENU"),f=d.getSubNode("CAPTION",true),o=0,e=function(){var q=0;n.children().each(function(r){if(r.offsetWidth==0){return}if(!q){q=r.offsetLeft+r.offsetWidth;return false}},true);return q},c=function(){var q=0;f.each(function(r){if(r.clientWidth==0){return}q+=r.clientWidth});return q},g;n.tagClass("-icon",false);n.tagClass("-icon2",false);n.tagClass("-menu",false);b.css("display","none");f.css("width","");d._mode="normal";o=e();if(o>j){var a=c();if((o-j)<a*0.75){var l=1-(o-j)/a;f.each(function(q){xui(q).width(Math.floor(q.clientWidth*l)+"px")});d._mode="narrow"}else{g=1}if(g||e()>j){n.tagClass("-icon",true);d._mode="icon";if(e()>j){n.tagClass("-menu",true);b.setInlineBlock();d._mode="menu"}}}}}});xui.Class("xui.UI.Stacks","xui.UI.Tabs",{Initialize:function(){var a=this.getTemplate(),b=this.$Keys;a.BOX={tagName:"div",LIST:a.LIST,PNAELS:a.PNAELS};delete a.LIST.LEFT;delete a.LIST.RIGHT;delete a.LIST.DROP;delete a.LIST;delete a.PNAELS;a.$submap.items.ITEM.className="xui-uibar xui-uiborder-t xui-uiborder-b";a.$submap.items.ITEM.ITEMI.ITEMC.HANDLE.IBWRAP.TOGGLE={$order:1,className:"xuifont {_tlgchecked}",$fonticon:"xui-uicmd-toggle"};this.setTemplate(a);delete b.LEFT;delete b.RIGHT;delete b.DROP},Static:{Behaviors:{DroppableKeys:["PANEL","KEY","ITEM"]},Appearances:{BOX:{position:"absolute",overflow:"hidden",left:0,top:0},LIST:{position:"static"},ITEMS:{position:"static"},ITEM:{$order:0,display:"block",position:"absolute",cursor:"pointer",width:"100%",left:0},ITEMC:{display:"block"},ITEMI:{display:"block"},"ITEM-hover":{$order:1},"ITEM-active ITEMC, ITEM-checked ITEMC":{$order:2},"ITEM-active ITEMI, ITEM-checked ITEMI":{$order:2},"ITEM-active, ITEM-checked":{$order:3},HANDLE:{cursor:"pointer",display:"block",padding:".58333em","white-space":"nowrap"},"ITEM-checked HANDLE":{},PANEL:{position:"absolute",display:"none",overflow:"auto"},CMDS:{position:"absolute",top:".5em",right:".75em","text-align":"right","vertical-align":"middle"}},DataModel:{expression:{ini:"",action:function(){}},noPanel:null,noHandler:null,selMode:null,borderType:{ini:"flat",listbox:["none","flat","inset","outset"],action:function(l){var j=this,b=j.properties,f=j.getSubNode("BOX"),d=/^xui-uiborder-/,a="xui-uiborder-flat  xui-uiborder-radius",e="xui-uiborder-inset  xui-uiborder-radius",c="xui-uiborder-outset  xui-uiborder-radius",g=j.getRoot();f.removeClass(d);switch(l){case"flat":f.addClass(a);break;case"inset":f.addClass(e);break;case"outset":f.addClass(c);break}j.adjustSize()}}},LayoutTrigger:function(){var a=this.properties.borderType;if(a&&a!="none"){this.boxing().setBorderType(a,true)}},_onresize:function(c,x,u,a,J){var b=c.properties,C=b.noPanel,w=xui.browser.contentBox,G=c.getItemByItemId(J);if(!G){J=b.$UIvalue||b.value;G=c.getItemByItemId(J)}if(!G){G=b.items[0];J=G&&G.id}if(!G){return}var q=c.boxing().getPanel(J),f=xui.$us(c),H=function(K,L){return c.$forceu(K,f>0?"em":"px",L)},A=c.getRoot(),o=c.getSubNode("BOX"),E=c.getSubNode("LIST"),B=c.getEmSize()/A._getEmSize(),j=q._getEmSize(B),n=E._getEmSize(B),d=b.borderType,D=!w?0:(d=="flat"||d=="inset"||d=="outset")?o._borderW():0,g=null,e=null,I,F,m,l,r,s;if(!q||q.isEmpty()){return}x=x?c.$px(x,null,true):x;u=u?c.$px(u,null,true):u;if(u){u-=D;l=m=0;xui.arr.each(b.items,function(K){r=c.getSubNodeByItemId("ITEM",K.id);r.cssRegion({bottom:"auto",top:H(m,r)});I=K.hidden?0:r.offsetHeight(true);m+=I;if(K.id==J){return false}});xui.arr.each(b.items,function(K){if(K.id==J){return false}r=c.getSubNodeByItemId("ITEM",K.id);r.cssRegion({top:"auto",bottom:H(l,r)});I=K.hidden?0:r.offsetHeight(true);l+=I},null,true);F=u-m-l;if(F>0){s=m;e=F}o.height(H(u))}if(x){x-=D;g=x;o.width(H(x))}q.cssRegion({width:g?H(g,j):null,height:e?H(e,j):null,top:H(s,j),left:0+c.$picku()},true);if(g){E.width(g=H(g,n));xui.UI._adjustConW(c,q,g)}},_adjustScroll:null}});xui.Class("xui.UI.ButtonViews","xui.UI.Tabs",{Initialize:function(){var a=this.getTemplate(),b=this.$Keys;a.LIST.className="xui-uibar";this.setTemplate(a);a.$submap.items.ITEM.className="xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius {itemClass} {disabled} {readonly} {itemPosCls}";delete b.LEFT;delete b.RIGHT;delete b.DROP},Static:{Appearances:{LIST:{"z-index":"2",position:"absolute","white-space":"nowrap",overflow:"hidden"},"LIST-attop, LIST-atbottom":{$order:2,position:"relative"},LISTBG:{},MENU:{display:"none",margin:".25em",padding:".25em",cursor:"pointer"},MENU2:{display:"none","text-align":"center"},MENUICON2:{position:"relative",margin:".09375em",padding:".1875em",cursor:"pointer"},ITEMS:{"z-index":"2",position:"relative",left:0,width:"100%",height:"100%","white-space":"nowrap","overflow-x":"hidden","overflow-y":"scroll"},"ITEMS-left, ITEMS-left ITEMC":{$order:1,top:"-1.5em !important",height:"auto","text-align":"left"},"ITEMS-center, ITEMS-center ITEMC":{$order:1,height:"auto","text-align":"center"},"ITEMS-right, ITEMS-right ITEMC":{$order:1,top:"-1.5em",height:"auto","text-align":"right"},"ITEMS-left HANDLE, ITEMS-right HANDLE":{$order:2,display:"block"},ITEM:{$order:0,margin:".166667em",position:"relative",cursor:"pointer",padding:"0 .125em 0 0","vertical-align":"top"},ITEMI:{$order:0,"padding-left":".125em","vertical-align":"top"},"ITEMS-block ITEM, ITEMS-block ITEMI, ITEMS-block ITEMC":{$order:2,display:"block"},ITEMC:{$order:0,padding:".15em 0 .125em 0","vertical-align":"top","text-align":"center"},HANDLE:{display:xui.$inlineBlock,zoom:xui.browser.ie6?1:null,cursor:"pointer","vertical-align":"middle",margin:".125em"},"ITEM-checked HANDLE":{}},DataModel:{HAlign:null,barLocation:{ini:"top",listbox:["top","bottom","left","right"],action:function(b){var a=this,c=a.getSubNode("LIST"),d=a.getSubNode("ITEMS"),e=0+a.$picku();switch(b){case"left":c.cssRegion({left:e,top:e,right:"auto",bottom:e});break;case"top":c.cssRegion({left:e,top:e,right:e,bottom:"auto"});break;case"right":c.cssRegion({left:"auto",top:e,right:e,bottom:e});break;case"bottom":c.cssRegion({left:e,top:"auto",right:e,bottom:e});break}switch(b){case"left":case"right":d.tagClass("-block",true);break;case"top":case"bottom":d.tagClass("-block",false);c.height("auto");break}c.tagClass("(-attop|-atbottom|-atleft|-atright)",false).tagClass("-at"+b,true);this.adjustSize()}},barHAlign:{ini:"left",listbox:["left","center","right"],action:function(b){var a=this.getSubNode("ITEMS");a.tagClass("(-left|-right|-center)",false).tagClass("-"+b,true)}},barVAlign:{ini:"top",listbox:["top","bottom"],action:function(b){var a=this.getSubNode("ITEMS"),c=0+this.$picku();if(b=="top"){a.cssRegion({top:c,bottom:"auto"})}else{a.cssRegion({bottom:c,top:"auto"})}this.adjustSize()}},barSize:{$spaceunit:1,ini:"2.5em",action:function(a){this.adjustSize()}},borderType:{ini:"none",listbox:["none","flat","inset","outset"],action:function(l){var j=this,b=j.properties,f=j.getSubNode("LIST"),d=/^xui-uiborder-/,a="xui-uiborder-flat xui-uiborder-radius",e="xui-uiborder-inset xui-uiborder-radius",c="xui-uiborder-outset xui-uiborder-radius",g=j.getRoot();f.removeClass(d);switch(l){case"flat":f.addClass(a);break;case"inset":f.addClass(e);break;case"outset":f.addClass(c);break}this.adjustSize()}},noFoldBar:{ini:false,action:function(a){this.getSubNode("MENU2",true).css("display",a?"none":"block")}},sideBarStatus:{ini:"expand",listbox:["expand","fold"],action:function(c){var b=this,d=b.properties,f=xui.$us(b),g=function(j,l){return b.$forceu(j,f>0?"em":"px",l)},a=b.getSubNode("ITEMS"),e=b.getSubNode("MENUICON2");if(d.sideBarStatus=="fold"){a.tagClass("-icon2",true);e.tagClass("-checked",true)}else{a.tagClass("-icon2",false);e.tagClass("-checked",false)}this.adjustSize()}},sideBarSize:{ini:"3.25em",action:function(a){this.adjustSize()}}},Behaviors:{MENU2:{onClick:function(a,b,c){a.boxing().setSideBarStatus(a.properties.sideBarStatus=="fold"?"expand":"fold",true)}}},LayoutTrigger:function(){var a=this.properties;this.boxing().setBarLocation(a.barLocation,true).setBarHAlign(a.barHAlign,true).setBarVAlign(a.barVAlign,true);if(a.barLocation=="top"||a.barLocation=="bottom"){this.getSubNode("ITEMS").addClass("xui-css-noscroll")}if(a.borderType&&a.borderType!="none"){this.boxing().setBorderType(a.borderType,true)}},_onresize:function(d,C,x,a,N){var c=d.properties,F=c.noPanel,O=c.noHandler,H=d.getItemByItemId(N);if(!H){N=c.$UIvalue||c.value;H=d.getItemByItemId(N)}if(!H){H=c.items[0];N=H&&H.id}if(!H){return}var s=d.boxing().getPanel(N),n=xui.$us(d),J=function(P,Q){return d.$forceu(P,n>0?"em":"px",Q)},M=C?d.$px(C,null,true):C,f=(x&&x!="auto")?d.$px(x,null,true):x,D=d.getRootNode(),K=d.getSubNode("LIST"),b=d.getSubNode("ITEMS"),I=d.getSubNode("MENU2"),E=d.getEmSize()/d.getRoot()._getEmSize(),q=s._getEmSize(E),j=K._getEmSize(E),m=b._getEmSize(E),A=xui(D).contentBox(),e=c.borderType,G=!A?0:(e=="flat"||e=="inset"||e=="outset")?K._borderW():0,o=null,l=null,w,g,L;I.css("display","none");if(O){o=M;l=f}else{if(c.barLocation=="top"||c.barLocation=="bottom"){if(xui.browser.isTouch&&(xui.browser.isAndroid||xui.browser.isBB)){}else{b.css("overflow-y","hidden")}L=K.height(c.barSize||"auto").offsetHeight(true);b.css("position","relative");if(C){K.width(J(M-G,j));b.width(J(M-G,m));if(F&&x!="auto"){K.height(J(f-G,j));b.height(J(f-G,j))}if(!O){d.box._adjustHScroll(d)}g=0;o=M}if(f!="auto"){if(f-L>0){l=f-L-G}}else{l=f}var u;if(c.barLocation=="top"){if((u=D.firstElementChild||D.firstChild)!=K.get(0)){if(u){D.insertBefore(K.get(0),u)}else{D.appendChild(K.get(0))}}}else{if(c.barLocation=="bottom"){if((D.lastElementChild||D.lastChild)!=K.get(0)){D.appendChild(K.get(0))}}}}else{if(xui.browser.isTouch&&(xui.browser.isAndroid||xui.browser.isBB)){}else{b.css("overflow-y","scroll")}I.css("display",(c.sideBarSize&&c.noFoldBar)?"block":"none");if(!O){d.getSubNode("CAPTION",true).css("width","")}if(f=="auto"){f=300}if(x){if(F){if(xui.browser.isTouch&&(xui.browser.isAndroid||xui.browser.isBB)){}else{b.css("overflow-y","hidden")}K.width(J(M-G,j));b.width(J(M-G,j))}K.height(J(f-G,j));b.height("auto");if(b.height()>=K.height()){b.height(J(f-G-(c.sideBarSize?I.offsetHeight():0),m))}b.css("position",c.barVAlign=="bottom"?"absolute":"relative");l=f}if(x||C){var r=d.$px(c.sideBarStatus=="fold"?c.sideBarSize:c.barSize,m,true);var B=!A?0:(b._paddingW()+b._marginW());g=c.barLocation=="left"?G+d.$px(r+B,j,true):0;o=M-d.$px(r+B,j,true)-G;b.width("auto");if(!F){K.width(J(r+B,j));b.width(J(r+xui.Dom.getScrollBarSize(),m))}}}}if(!F){s.cssRegion({width:(o=o?J(o,q):null),height:l?J(l,q):null,left:O?0:J(g,q)},true);if(o){xui.UI._adjustConW(d,s,o)}}}}});xui.Class("xui.UI.MTabs","xui.UI.Tabs",{Initialize:function(){var a=this.getTemplate(),b=this.$Keys;a.LIST.className="xui-uibar";this.setTemplate(a);a.$submap.items.ITEM.className="xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius {itemClass} {disabled} {readonly} {itemPosCls}";delete b.LEFT;delete b.RIGHT;delete b.DROP},Static:{Appearances:{LIST:{"z-index":"2",position:"absolute","white-space":"nowrap",overflow:"hidden"},"LIST-attop, LIST-atbottom":{$order:2,position:"relative"},LISTBG:{display:"none"},MENU:{display:"none",margin:".25em",padding:".25em",cursor:"pointer"},MENU2:{display:"none","text-align":"center"},MENUICON2:{position:"relative",margin:".09375em",padding:".1875em",cursor:"pointer"},ITEMS:{"z-index":"2",position:"relative",left:0,top:0,width:"100%",height:"100%","white-space":"nowrap","overflow-x":"hidden","overflow-y":"scroll"},"ITEMS-left, ITEMS-left ITEMC":{$order:1,height:"auto","text-align":"left"},"ITEMS-center, ITEMS-center ITEMC":{$order:1,height:"auto","text-align":"center"},"ITEMS-right, ITEMS-right ITEMC":{$order:1,height:"auto","text-align":"right"},"ITEMS-left HANDLE, ITEMS-right HANDLE":{$order:2,display:"block"},ITEM:{$order:0,margin:".166667em",position:"relative",cursor:"pointer",padding:"0 .125em 0 0","vertical-align":"top"},ITEMI:{$order:0,"padding-left":".125em","vertical-align":"top"},"ITEMS-block ITEM, ITEMS-block ITEMI, ITEMS-block ITEMC":{$order:2,display:"block"},ITEMC:{$order:0,padding:".15em 0 .125em 0","vertical-align":"top","text-align":"center"},HANDLE:{display:xui.$inlineBlock,zoom:xui.browser.ie6?1:null,cursor:"pointer","vertical-align":"middle",margin:".125em"},"ITEM-checked HANDLE":{}},DataModel:{HAlign:null,barLocation:{ini:"top",listbox:["top","bottom","left","right"],action:function(b){var a=this,c=a.getSubNode("LIST"),d=a.getSubNode("ITEMS"),e=0+a.$picku();switch(b){case"left":c.cssRegion({left:e,top:e,right:"auto",bottom:e});break;case"top":c.cssRegion({left:e,top:e,right:e,bottom:"auto"});break;case"right":c.cssRegion({left:"auto",top:e,right:e,bottom:e});break;case"bottom":c.cssRegion({left:e,top:"auto",right:e,bottom:e});break}switch(b){case"left":case"right":d.tagClass("-block",true);break;case"top":case"bottom":d.tagClass("-block",false);c.height("auto");break}c.tagClass("(-attop|-atbottom|-atleft|-atright)",false).tagClass("-at"+b,true);this.adjustSize()}},barHAlign:{ini:"left",listbox:["left","center","right"],action:function(b){var a=this.getSubNode("ITEMS");a.tagClass("(-left|-right|-center)",false).tagClass("-"+b,true)}},barVAlign:{ini:"top",listbox:["top","bottom"],action:function(b){var a=this.getSubNode("ITEMS"),c=0+this.$picku();if(b=="top"){a.cssRegion({top:c,bottom:"auto"})}else{a.cssRegion({bottom:c,top:"auto"})}this.adjustSize()}},barSize:{$spaceunit:1,ini:"2.5em",action:function(a){this.adjustSize()}},borderType:{ini:"none",listbox:["none","flat","inset","outset"],action:function(l){var j=this,b=j.properties,f=j.getSubNode("LIST"),d=/^xui-uiborder-/,a="xui-uiborder-flat xui-uiborder-radius",e="xui-uiborder-inset xui-uiborder-radius",c="xui-uiborder-outset xui-uiborder-radius",g=j.getRoot();f.removeClass(d);switch(l){case"flat":f.addClass(a);break;case"inset":f.addClass(e);break;case"outset":f.addClass(c);break}this.adjustSize()}},noFoldBar:{ini:false,action:function(a){this.getSubNode("MENU2",true).css("display",a?"none":"block")}},sideBarStatus:{ini:"expand",listbox:["expand","fold"],action:function(c){var b=this,d=b.properties,f=xui.$us(b),g=function(j,l){return b.$forceu(j,f>0?"em":"px",l)},a=b.getSubNode("ITEMS"),e=b.getSubNode("MENUICON2");if(d.sideBarStatus=="fold"){a.tagClass("-icon2",true);e.tagClass("-checked",true)}else{a.tagClass("-icon2",false);e.tagClass("-checked",false)}this.adjustSize()}},sideBarSize:{ini:"3em",action:function(a){this.adjustSize()}}},Behaviors:{MENU2:{onClick:function(a,b,c){a.boxing().setSideBarStatus(a.properties.sideBarStatus=="fold"?"expand":"fold",true)}}},LayoutTrigger:function(){var a=this.properties;this.boxing().setBarLocation(a.barLocation,true).setBarHAlign(a.barHAlign,true).setBarVAlign(a.barVAlign,true);if(a.barLocation=="top"||a.barLocation=="bottom"){this.getSubNode("ITEMS").addClass("xui-css-noscroll")}if(a.borderType&&a.borderType!="none"){this.boxing().setBorderType(a.borderType,true)}},_onresize:function(d,C,x,a,N){var c=d.properties,F=c.noPanel,O=c.noHandler,H=d.getItemByItemId(N);if(!H){N=c.$UIvalue||c.value;H=d.getItemByItemId(N)}if(!H){H=c.items[0];N=H&&H.id}if(!H){return}var s=d.boxing().getPanel(N),n=xui.$us(d),J=function(P,Q){return d.$forceu(P,n>0?"em":"px",Q)},M=C?d.$px(C,null,true):C,f=(x&&x!="auto")?d.$px(x,null,true):x,D=d.getRootNode(),K=d.getSubNode("LIST"),b=d.getSubNode("ITEMS"),I=d.getSubNode("MENU2"),E=d.getEmSize()/d.getRoot()._getEmSize(),q=s._getEmSize(E),j=K._getEmSize(E),m=b._getEmSize(E),A=xui(D).contentBox(),e=c.borderType,G=!A?0:(e=="flat"||e=="inset"||e=="outset")?K._borderW():0,o=null,l=null,w,g,L;I.css("display","none");if(O){o=M;l=f}else{if(c.barLocation=="top"||c.barLocation=="bottom"){if(xui.browser.isTouch&&(xui.browser.isAndroid||xui.browser.isBB)){}else{b.css("overflow-y","hidden")}L=K.height(c.barSize||"auto").offsetHeight(true);b.css("position","relative");if(C){K.width(J(M-G,j));b.width(J(M-G,m));if(F&&x!="auto"){K.height(J(f-G,j));b.height(J(f-G,j))}if(!O){d.box._adjustHScroll(d)}g=0;o=M}if(f!="auto"){if(f-L>0){l=f-L-G}}else{l=f}var u;if(c.barLocation=="top"){if((u=D.firstElementChild||D.firstChild)!=K.get(0)){if(u){D.insertBefore(K.get(0),u)}else{D.appendChild(K.get(0))}}}else{if(c.barLocation=="bottom"){if((D.lastElementChild||D.lastChild)!=K.get(0)){D.appendChild(K.get(0))}}}}else{if(xui.browser.isTouch&&(xui.browser.isAndroid||xui.browser.isBB)){}else{b.css("overflow-y","scroll")}I.css("display",(c.sideBarSize&&c.noFoldBar)?"block":"none");if(!O){d.getSubNode("CAPTION",true).css("width","")}if(f=="auto"){f=300}if(x){if(F){if(xui.browser.isTouch&&(xui.browser.isAndroid||xui.browser.isBB)){}else{b.css("overflow-y","hidden")}K.width(J(M-G,j));b.width(J(M-G,j))}K.height(J(f-G,j));b.height("auto");if(b.height()>=K.height()){b.height(J(f-G-(c.sideBarSize?I.offsetHeight():0),m))}b.css("position",c.barVAlign=="bottom"?"absolute":"relative");l=f}if(x||C){var r=d.$px(c.sideBarStatus=="fold"?c.sideBarSize:c.barSize,m,true);var B=!A?0:(b._paddingW()+b._marginW());g=c.barLocation=="left"?G+d.$px(r+B,j,true):0;o=M-d.$px(r+B,j,true)-G;b.width("auto");if(!F){K.width(J(r+B,j));b.width(J(r+xui.Dom.getScrollBarSize(),m))}}}}if(!F){s.cssRegion({width:(o=o?J(o,q):null),height:l?J(l,q):null,left:O?0:J(g,q)},true);if(o){xui.UI._adjustConW(d,s,o)}}}}});xui.Class("xui.UI.FoldingTabs","xui.UI.Tabs",{Instance:{_setCtrlValue:function(a,b){this.each(function(e){var d=e.domId,f=e.boxing(),m=b?"":f.getUIValue(),c=e.properties,g=function(u,o){var r=e.getSubIdByItemId(u),s=e.getItemByItemId(u);if(r){o.push(r);var q=e.getSubNode("BODY",r);if(q.css("display")!="none"){s._scrollTop=q.get(0).scrollTop||0;if(s._scrollTop){q.get(0).scrollTop=0}q.css("display","none")}}},n=function(u,o){var r=e.getSubIdByItemId(u),s=e.getItemByItemId(u);if(r){o.push(r);var q=e.getSubNode("BODY",r);if(q.css("display")=="none"){q.css("display","block");if(s._scrollTop){q.get(0).scrollTop=s._scrollTop}e.box._forLazyAppend(e,s,u);e.box._forIniPanelView(e,s,u)}}};var l=[],j=[];if(c.selMode=="multi"){m=m?m.split(c.valueSeparator):[];a=a?a.split(c.valueSeparator):[];xui.arr.each(m,function(o){if(xui.arr.indexOf(a,o)==-1){g(o,l)}});xui.arr.each(a,function(o){if(xui.arr.indexOf(m,o)==-1){n(o,j)}})}else{g(m,l);n(a,j)}if(l.length){e.getSubNodes(["ITEM","TOGGLE"],l).tagClass("-checked",false);e.getSubNodes("ITEM",l).next().tagClass("-prechecked",false)}if(j.length){e.getSubNodes(["ITEM","TOGGLE"],j).tagClass("-checked");e.getSubNodes("ITEM",j).next().tagClass("-prechecked")}e.adjustSize()})},_afterInsertItems:null},Static:{Templates:{tagName:"div",style:"{_style};",BOX:{$order:0,tagName:"div",ITEMS:{tagName:"div",text:"{items}"}},$submap:{items:{ITEM:{tagName:"div",className:"xui-uiborder-flat xui-uiborder-radius {_checked} {_precheked} {itemClass} {disabled} {readonly}",style:"{_itemDisplay} {itemStyle} ",HEAD:{tagName:"div",style:"{_itemColor}",className:"xui-uibar  {_checked} {_precheked} ",HL:{tagName:"div"},HR:{tagName:"div"},TITLE:{tabindex:"{_tabindex}",TLEFT:{$order:0,tagName:"div",LTAGCMDS:{$order:0,tagName:"span",style:"{_ltagDisplay}",text:"{ltagCmds}"},TOGGLE:{$order:1,className:"xuifont {_tlgchecked}",$fonticon:"xui-uicmd-toggle"},ICON:{$order:2,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle} {_iconColor}",text:"{iconFontCode}"},CAPTION:{$order:3,className:"xui-title-node",style:"{_fontColor}",text:"{caption}"}},TRIGHT:{$order:1,tagName:"div",style:"{_capDisplay}",MESSAGE:{$order:0,text:"{message}"},CMDS:{$order:2,RTAGCMDS:{$order:0,tagName:"span",style:"{_rtagDisplay}",text:"{rtagCmds}"},OPT:{$order:1,className:"xuifont",$fonticon:"xui-uicmd-opt",style:"{_opt}"},POP:{className:"xuifont",$fonticon:"xui-uicmd-pop",style:"{popDisplay}",$order:1},CLOSE:{className:"xuifont",$fonticon:"xui-uicmd-close",style:"{closeDisplay}",$order:2}}}}},BODY:{$order:1,tagName:"div",className:"xui-uibase",BODYI:{tagName:"div",PANEL:{tagName:"div",style:"{_itemHeight};{_overflow};{_bginfo}",className:"xui-uibase xui-uicontainer",text:xui.UI.$childTag}}},TAIL:{$order:4,tagName:"div",className:"xui-uibar",TL:{tagName:"div"},TR:{tagName:"div"}}}},"items.ltagCmds":function(e,d,c,b,a){var f=arguments.callee,g=f._m||(f._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(e,d,c,"items.tagCmds"+(g[c.type]||".button"),a)},"items.rtagCmds":function(e,d,c,b,a){var f=arguments.callee,g=f._m||(f._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(e,d,c,"items.tagCmds"+(g[c.type]||".button"),a)},"items.tagCmds.text":xui.UI.$getTagCmdsTpl("text"),"items.tagCmds.button":xui.UI.$getTagCmdsTpl("button"),"items.tagCmds.image":xui.UI.$getTagCmdsTpl("image")}},Appearances:{KEY:{},BOX:{},"LTAGCMDS, RTAGCMDS":{padding:0,margin:0,"vertical-align":"middle"},ITEMS:{border:0,position:"relative",zoom:xui.browser.ie?1:null},ITEM:{zoom:xui.browser.ie?1:null,padding:0,position:"relative",overflow:"hidden","box-shadow":"-1px -1px 2px #EDEDED"},"HEAD, BODY, BODYI, PANEL, TAIL":{position:"relative"},CMDS:{padding:".25em 0 0 .25em","vertical-align":"middle",position:"relative"},BODY:{display:"none",zoom:xui.browser.ie?1:null,position:"relative"},BODYI:{},PANEL:{overflow:"auto",padding:"0em"},"ITEM-hover":{},"ITEM-active, ITEM-checked":{},"ITEM-checked":{$order:2,},"ITEM-checked BODY":{$order:2,display:"block"},"HL, HR, TL, TR":{position:"absolute",width:".75em"},"HL, HR":{height:"2.5em"},"ITEM-prechecked HL":{$order:1},"ITEM-prechecked HR":{$order:1},"TL, TR":{height:"1.75em"},HL:{$order:1,top:0,left:0},HR:{$order:1,top:0,right:0},TL:{$order:1,bottom:0,left:0},TR:{$order:1,bottom:0,right:0},HEAD:{cursor:"pointer",position:"relative",zoom:xui.browser.ie?1:null,overflow:"hidden"},TITLE:{$order:1,display:"block",position:"relative","white-space":"nowrap",overflow:"hidden",padding:".25em .5em"},"BODY, BODYI":{overflow:"hidden"},TAIL:{height:"0em"},"CAPTION, MESSAGE":{padding:".25em","font-align":"center","vertical-align":"middle"},MESSAGE:{"font-size":"1em"},CAPTION:{"white-space":"nowrap"},"ITEM-checked CAPTION":{$order:2,"font-weight":"bold"},TLEFT:{position:"relative",left:".5em",padding:"0 0 0 .5em","white-space":"nowrap",overflow:"hidden"},TRIGHT:{position:"absolute",right:"0em",top:"0em","white-space":"nowrap",overflow:"hidden"}},Behaviors:{DraggableKeys:["HEAD"],HoverEffected:{OPT:"OPT",CLOSE:"CLOSE",POP:"POP",ITEM:"HEAD"},ClickEffected:{OPT:"OPT",CLOSE:"CLOSE",POP:"POP",ITEM:"HEAD"},ITEM:{onClick:null},ITEMS:{onMousedown:null,onDrag:null,onDragstop:null},HEAD:{onClick:function(c,g,a){if(xui.Event.getBtn(g)!="left"){return}var b=c.properties,n=c.getItemByDom(a),j=c.getSubId(a),f=c.boxing();if(!n){return}if(b.disabled||n.disabled){return false}if(b.readonly||n.readonly){return false}c.getSubNode("TITLE").focus(true);switch(b.selMode){case"multi":var m=f.getUIValue(),d=m?m.split(b.valueSeparator):[],l=1;if(d.length){if(xui.arr.indexOf(d,n.id)!=-1){xui.arr.removeValue(d,n.id);l=-1}else{d.push(n.id)}d.sort();m=d.join(b.valueSeparator);if(f.getUIValue()!==m){f.setUIValue(m,null,null,"click");if(f.get(0)&&f.getUIValue()==m){f.onItemSelected(c,n,g,a,l)}}break}case"single":if(f.getUIValue()!==n.id){f.setUIValue(n.id,null,null,"click");if(f.get(0)&&f.getUIValue()==n.id){f.onItemSelected(c,n,g,a,1)}}break}},onKeydown:function(c,f,g){var d=xui.Event.getKey(f),b=d.key,a=d.shiftKey;if(b==" "||b=="enter"){c.getSubNode("HEAD",c.getSubId(g)).onClick();return false}}}},DataModel:{expression:{ini:"",action:function(){}},iconColors:null,itemColors:null,fontColors:null,expression:{ini:"",action:function(){}},autoFontColor:{ini:false,action:function(){this.boxing().refresh()}},autoIconColor:{ini:true,action:function(){this.boxing().refresh()}},autoItemColor:{ini:false,action:function(){this.boxing().refresh()}},$hborder:0,$vborder:0,noPanel:null,noHandler:null,HAlign:null,selMode:{ini:"single",listbox:["single","multi"]}},_initIconColors:function(d,f){var c=[],b=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],e=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],a=["#F19B60","#49CD81","#0277bd","#A693EB","#42a3af","#B0E0E6","#F06292"];switch(d){case"icon":c=b;if(f.iconColors&&f.iconColors.length>0){c=f.iconColors}break;case"font":c=e;if(f.fontColors&&f.fontColors.length>0){c=f.fontColors}break;case"item":c=a;if(f.itemColors&&f.itemColors.length>0){c=f.itemColors}break}return c},_autoColor:function(d,c,f){c=c||0;if(f.autoFontColor||d.fontColor){var e=this._initIconColors("font",f);while(c&&c>(e.length-1)){c=c-e.length}if(!d.fontColor){d.fontColor=e[c]}d._fontColor=d.fontColor?";color:"+d.fontColor:""}if(f.autoIconColor||d.iconColor){var b=this._initIconColors("icon",f);while(c&&c>(b.length-1)){c=c-b.length}if(!d.iconColor){d.iconColor=b[c]}d._iconColor=d.iconColor?";color:"+d.iconColor:""}if(f.autoItemColor||d.itemColor){var a=this._initIconColors("item",f);while(c&&c>(a.length-1)){c=c-a.length}if(!d.itemColor){d.itemColor=a[c]}d._itemColor=d.itemColor?";background-color:"+d.itemColor:"";d._fontColor=";color:#ffffff";d._iconColor=";color:#ffffff"}},_prepareItems:function(d,a,b){var c=this;if(a.length){a[0]._precheked=d.getClass("ITEM","-prechecked")}xui.arr.each(a,function(e){if(!e.index){e.index=xui.arr.indexOf(a,e)}c._autoColor(e,e.index,d.properties)});return arguments.callee.upper.apply(this,arguments)},_prepareItem:function(b,c){var g="display:none",d=b.properties,a;c.closeDisplay=c.closeBtn?"":g;c.popDisplay=c.popBtn?"":g;c._opt=c.optBtn?"":g;c._itemDisplay=c.hidden?g:"";if(c.height){c._itemHeight="height:"+b.$forceu(c.height)}var f=b.properties,e;c._tabindex=f.tabindex;if(!c.caption){c._capDisplay=g}c._bginfo="";if(a=c.panelBgClr||d.panelBgClr){c._bginfo+="background-color:"+a+";"}if(a=c.panelBgImg||d.panelBgImg){c._bginfo+="background-image:url("+xui.adjustRes(a)+");"}if(a=c.panelBgImgPos||d.panelBgImgPos){c._bginfo+="background-position:"+a+";"}if(a=c.panelBgImgRepeat||d.panelBgImgRepeat){c._bginfo+="background-repeat:"+a+";"}if(a=c.panelBgImgAttachment||d.panelBgImgAttachment){c._bginfo+="background-attachment:"+a+";"}if(xui.isStr(c.overflow)){c._overflow=c.overflow.indexOf(":")!=-1?(c.overflow):(data.overflow?("overflow:"+data.overflow):"")}else{if(xui.isStr(d.overflow)){c._overflow=d.overflow.indexOf(":")!=-1?(d.overflow):(d.overflow?("overflow:"+d.overflow):"")}}if(c._show){c._checked=b.getClass("ITEM","-checked");c._tlgchecked=b.getClass("TOGGLE","-checked")}this._prepareCmds(b,c)},_onresize:function(e,d,a,f,c){if(f){e._w=e._h=null}var b=e.getSubNode("PANEL",true).size();e.getSubNode("PANEL",true).each(function(g){var j=(30*b)+15;var l=e.$addpx(a,0-j);g.style.height=l});if(d&&e._w!=d){e._w=d;e.getSubNode("PANEL",true).each(function(j){if(j.offsetWidth){xui(j).width("auto");var g=xui(j).width(),l=e.properties;if(xui.$us(e)>0){g=e.$px2em(g,j)+"em"}xui(j).width(g);xui.UI._adjustConW(e,j,g)}})}},_adjustScroll:null}});xui.Class("xui.UI.RadioBox","xui.UI.List",{Initialize:function(){var a=this.getTemplate();a.className="{_className}";a.ITEMS.className="{_bordertype}";a.$submap={items:{ITEM:{className:"xui-showfocus {_itemRow} {itemClass} {disabled} {readonly}",style:"{itemStyle}{_itemDisplay}",tabindex:"{_tabindex}",MARK:{$order:0,className:"xuifont",$fonticon:"{_fi_markcls}"},ICON:{$order:1,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{text:"{caption}",$order:2}}}};this.setTemplate(a)},Static:{_DIRTYKEY:"MARK",_ITEMMARKED:true,Appearances:{ITEM:{display:xui.$inlineBlock,border:0,padding:".5em",position:"relative",zoom:xui.browser.ie?1:null,cursor:"pointer",overflow:"hidden","vertical-align":"middle"},"ITEM-checked":{padding:".5em"},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle","font-size":"1em"},ITEMS:{overflow:"auto","overflow-x":"hidden",position:"relative","line-height":"1.25em"},MARK:{$order:1,cursor:"pointer",margin:"0 .5em 0 .25em","vertical-align":"middle"}},DataModel:{expression:{ini:"",action:function(){}},tagCmds:null,borderType:{ini:"none"},checkBox:{ini:false,action:function(a){this.getSubNode("MARK",true).replaceClass(a?/(uicmd-radio)|(\s+uicmd-radio)/g:/(^uicmd-check)|(\s+uicmd-check)/g,a?" xui-uicmd-check":" xui-uicmd-radio")}}},Behaviors:{HoverEffected:{ITEM:null,MARK:"MARK"},ClickEffected:{ITEM:null,MARK:"MARK"}},EventHandlers:{onCmd:null},_prepareItem:function(a,b){b._fi_markcls=a.properties.checkBox?"xui-uicmd-check":"xui-uicmd-radio";b._itemRow=a.properties.itemRow?"xui-item-row":""}}});xui.Class("xui.UI.StatusButtons",["xui.UI.List"],{Initialize:function(){var a=this.getTemplate();a.className="{_className}";a.ITEMS.className="{_bordertype {_align} }";a.$submap={items:{ITEM:{className:"{_itemClass} {itemClass} {disabled} {readonly} ",style:"{itemPadding};{itemMargin};{itemWidth};{itemAlign};{itemStyle};{_display} {_itemColor}",tabindex:"{_tabindex}",ICON:{$order:10,className:"xuicon {imageClass} {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}{_iconColor}",text:"{iconFontCode}"},CAPTION:{$order:11,style:"{_fontColor}",text:"{caption}"},DROP:{$order:12,className:"xuifont",$fonticon:"xui-uicmd-arrowdrop",style:"{_dropDisplay}"},FLAG:{$order:13,className:"xui-display-none {flagClass}",style:"{_flagStyle};{flagStyle}",text:"{flagText}"}}}};this.setTemplate(a)},Static:{Appearances:{ITEMS:{position:"relative",overflow:"visible","text-align":"center"},ITEM:{"vertical-align":"middle",position:"relative",margin:".166667em",cursor:"pointer","white-space":"nowrap"},"ITEM-hover, ITEM-active, ITEM-checked":{},"ITEM-hover":{},"ITEM-active":{},"ITEM-checked":{},CAPTION:{display:xui.$inlineBlock,zoom:xui.browser.ie6?1:null,"vertical-align":"middle",margin:"0 0.8em 0 0.3em","font-size":"1.2em"},DROP:{"vertical-align":"middle"},FLAG:{top:"-.5em",right:"-.5em",position:"absolute","z-index":10}},DataModel:({expression:{ini:"",action:function(){}},iconColors:null,itemColors:null,fontColors:null,expression:{ini:"",action:function(){}},autoFontColor:{ini:false,action:function(){this.boxing().refresh()}},autoIconColor:{ini:false,action:function(){this.boxing().refresh()}},autoItemColor:{ini:true,action:function(){this.boxing().refresh()}},maxHeight:null,tagCmds:null,height:"auto",align:{ini:"",listbox:["","left","center","right"],action:function(a){this.getSubNode("ITEMS",true).css("text-align",a)}},itemMargin:{ini:"",action:function(a){this.getSubNode("ITEM",true).css("margin",v)}},itemPadding:{ini:"",action:function(a){this.getSubNode("ITEM",true).css("padding",a)}},itemWidth:{$spaceunit:1,ini:"auto",action:function(a){this.getSubNode("ITEM",true).width(a||"auto")}},itemAlign:{ini:"",listbox:["","left","center","right"],action:function(a){this.getSubNode("ITEM",true).css("text-align",a)}},itemType:{ini:"button",listbox:["text","button","dropButton"],action:function(a){this.boxing().refresh()}},connected:{ini:false,action:function(){this.boxing().refresh()}}}),Behaviors:{DroppableKeys:["ITEMS"]},EventHandlers:{onCmd:null},_prepareData:function(d){var e=arguments.callee.upper.call(this,d),b,a;var f=d.properties,c=this;xui.arr.each(e.items,function(g){if(!g.index){g.index=xui.arr.indexOf(e.items,g)}c._autoColor(g,g.index,f)});return e},_initIconColors:function(d,f){var c=[],b=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],e=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],a=["#F19B60","#49CD81","#0277bd","#A693EB","#42a3af","#B0E0E6","#F06292"];switch(d){case"icon":c=b;if(f.iconColors&&f.iconColors.length>0){c=f.iconColors}break;case"font":c=e;if(f.fontColors&&f.fontColors.length>0){c=f.fontColors}break;case"item":c=a;if(f.itemColors&&f.itemColors.length>0){c=f.itemColors}break}return c},_autoColor:function(d,c,f){c=c||0;if(f.autoFontColor||d.fontColor){var e=this._initIconColors("font",f);while(c&&c>(e.length-1)){c=c-e.length}if(!d.fontColor){d.fontColor=e[c]}d._fontColor=d.fontColor?";color:"+d.fontColor:""}if(f.autoIconColor||d.iconColor){var b=this._initIconColors("icon",f);while(c&&c>(b.length-1)){c=c-b.length}if(!d.iconColor){d.iconColor=b[c]}d._iconColor=d.iconColor?";color:"+d.iconColor:""}if(f.autoItemColor||d.itemColor){var a=this._initIconColors("item",f);while(c&&c>(a.length-1)){c=c-a.length}if(!d.itemColor){d.itemColor=a[c]}d._itemColor=d.itemColor?";background-color:"+d.itemColor:"";d._fontColor=";color:#ffffff";d._iconColor=";color:#ffffff"}},_prepareItem:function(b,j,c,d,e,f){var a=b.properties,l,g=j.type||a.itemType;j._tabindex=a.tabindex;if(a.align){align="text-align:"+a.align}this._autoColor(j,e,a);if(a.connected){j.itemMargin="margin:"+(e===0?"0":"0 0 0 -1px")}else{if(l=j.itemMargin||a.itemMargin){j.itemMargin="margin:"+l}}if(l=j.itemPadding||a.itemPadding){j.itemPadding="padding:"+l}if(l=j.itemWidth||a.itemWidth){j.itemWidth="width:"+b.$forceu(l||"auto")}if(l=j.itemAlign||a.itemAlign){j.itemAlign="text-align:"+l}if(j.flagText||j.flagClass){j._flagStyle="display:block"}if(!j.flagClass){j.flagClass="xui-uiflag-1"}if(!j.iconFontSize){j.iconFontSize="iconFontSize:1.2em"}j._itemClass=g=="text"?"xui-node-a":("xui-ui-btn xui-uibar xui-uigradient "+(a.connected?(e==0?"xui-uiborder-radius-tl xui-uiborder-radius-bl xui-uiborder-noradius-r":e===f-1?"xui-uiborder-radius-tr xui-uiborder-radius-br xui-uiborder-noradius-l":"xui-uiborder-noradius"):"xui-uiborder-radius"));j._dropDisplay=g=="dropButton"?"":"display:none";j.hidden?j._display="display:none":""}}});xui.Class("xui.UI.FoldingList",["xui.UI.List"],{Instance:{fillContent:function(e,d){var b=this.get(0),a,c;if(b.renderId){if(c=b.getItemByItemId(e)){a=b.getSubNodeByItemId("BODYI",e).html("");if(d){c._obj=d;c._fill=true;if(typeof d=="string"){a.html(d)}else{a.append(d.render(true))}}else{c._obj=c._fill=null}}}return this},toggle:function(c){var e=this.get(0);if(e.renderId){var g=e.properties,j=g.items,o=e.getItemByItemId(c),b=e.getSubIdByItemId(c),d=e.getSubNode("ITEM",b),f=e.getSubNode("TOGGLE",b),l=d.next(),n;if(o._show){if(g.activeLast&&j.length){if(j[j.length-1].id==o.id){return false}}d.tagClass("-checked",false);f.tagClass("-checked",false);if(l){l.tagClass("-prechecked",false)}}else{d.tagClass("-checked");f.tagClass("-checked");if(l){l.tagClass("-prechecked")}if(!o._fill){var m=function(q){e.boxing().fillContent(o.id,o._body=q)};if(e.onGetContent){var a=e.boxing().onGetContent(e,o,m);if(a){m(a)}}else{m(e.box._buildBody(e,o))}}}o._show=!o._show}return this}},Initialize:function(){var a=this.getTemplate();a.ITEMS.className="{_bordertype}";a.$submap.items={ITEM:{tagName:"div",className:"xui-uiborder-flat xui-uiborder-radius {_checked} {_precheked} {itemClass} {disabled} {readonly}",style:"{itemStyle}",HEAD:{tagName:"div",className:"xui-uibar",HL:{tagName:"div"},HR:{tagName:"div"},TITLE:{tabindex:"{_tabindex}",TLEFT:{$order:0,tagName:"div",TOGGLE:{$order:0,className:"xuifont",$fonticon:"{_fi_tlg}"},LTAGCMDS:{$order:2,tagName:"span",text:"{ltagCmds}"},CAP1:{$order:1,className:"xui-title-node",text:"{title}"}},TRIGHT:{$order:1,tagName:"div",style:"{_capDisplay}",CAP2:{$order:0,text:"{caption}"},TAGCMDS:{$order:60,tagName:"span",text:"{rtagCmds}"}}}},BODY:{$order:1,tagName:"div",className:"xui-uibase",BODYI:{$order:0,tagName:"div",text:"{_body}"}},TAIL:{$order:4,tagName:"div",className:"xui-uibar",TL:{tagName:"div"},TR:{tagName:"div"}}}};this.setTemplate(a)},Static:{Appearances:{KEY:{padding:".25em"},ITEMS:{border:0,position:"relative",zoom:xui.browser.ie?1:null,"padding-top":".75em"},ITEM:{zoom:xui.browser.ie?1:null,"margin-top":"-7px",padding:0,position:"relative",overflow:"hidden","border-radius":"6px","box-shadow":"-1px -1px 2px #EDEDED"},"HEAD, BODY, BODYI, TAIL":{position:"relative"},BODY:{display:"none",zoom:xui.browser.ie?1:null,position:"relative",overflow:"auto"},BODYI:{padding:".25em .75em 0 .75em",position:"relative"},"BODY, BODYI":{},"ITEM-hover, ITEM-active, ITEM-checked":null,"ITEM-checked":{$order:2,"margin-bottom":"1em"},"ITEM-checked BODY":{$order:2,display:"block"},"HL, HR, TL, TR":{position:"absolute",width:".75em"},"HL, HR":{height:"2.5em"},"ITEM-prechecked HL":{$order:1},"ITEM-prechecked HR":{$order:1},"TL, TR":{height:"1.75em"},HL:{$order:1,top:0,left:0},HR:{$order:1,top:0,right:0},TL:{$order:1,bottom:0,left:0},TR:{$order:1,bottom:0,right:0},HEAD:{position:"relative",zoom:xui.browser.ie?1:null,overflow:"hidden"},TITLE:{$order:1,display:"block",position:"relative","white-space":"nowrap",overflow:"hidden",padding:".25em .5em"},TAIL:{position:"relative",height:".25em"},"CAP1, CAP2":{padding:".25em","vertical-align":"middle"},CAP1:{cursor:"pointer","white-space":"nowrap"},"ITEM-checked CAP1":{$order:2,"font-weight":"normal"},TLEFT:{position:"relative",left:".5em","white-space":"nowrap",overflow:"hidden"},TRIGHT:{position:"absolute",right:".5em",top:".25em","white-space":"nowrap",overflow:"hidden"}},Behaviors:{HoverEffected:{ITEM:"ITEM",HEAD:"HEAD",OPT:"OPT"},ClickEffected:{ITEM:null,HEAD:"HEAD"},ITEM:{onClick:null,onKeydown:null},HEAD:{onClick:function(a,b,c){a.boxing().toggle(a.getItemIdByDom(c));return false}},OPT:{onMousedown:function(){return false},onClick:function(a,b,c){a.boxing().onShowOptions(a,a.getItemByDom(c),b,c);return false}}},DataModel:({expression:{ini:"",action:function(){}},value:null,borderType:null,activeLast:true}),EventHandlers:{onGetContent:function(b,c,a){},onShowOptions:function(a,b,c,d){}},RenderTrigger:function(){var b=this,d=b.properties,a=d.items,c;if(d.activeLast&&a.length>0){c=a[a.length-1];b.boxing().fillContent(c.id,c._body)}},_prepareItems:function(c,a,b){if(a.length){a[0]._precheked=c.getClass("ITEM","-prechecked");if(c.properties.activeLast){var d=a[a.length-1];d._show=true;d._fill=true;d._body=c.onGetContent?c.boxing().onGetContent(c,d,function(e){c.boxing().fillContent(d.id,d._body=e)}):c.box._buildBody(c,d)}}return arguments.callee.upper.apply(this,arguments)},_prepareItem:function(a,b){var c=a.properties,d,e="display:none";b._tabindex=c.tabindex;if(!b.caption){b._capDisplay=e}else{b.caption=b.caption.replace(/</g,"&lt;")}b._body=b._body||"Loading...";if(b._show){b._checked=a.getClass("ITEM","-checked");b._fi_tlg="xuifont-checked xui-uicmd-toggle xui-uicmd-toggle-checked"}else{b._fi_tlg="xui-uicmd-toggle"}this._prepareCmds(a,b)},_buildBody:function(a,b){return b.text?'<pre class="xui-node xui-node-div">'+b.text.replace(/</g,"&lt;")+"</pre>":""},_onresize:function(){}}});xui.Class("xui.UI.TreeBar",["xui.UI","xui.absList","xui.absValue"],{$Start:function(a){if(a=this.Static.RenderTrigger){a.$order=-1}},Instance:{_setCtrlValue:function(b,a){return this.each(function(d){if(!d.renderId){return}var l=d.boxing(),u=l.getUIValue(),n=d.properties,q=function(B,C,A){d.getSubNodeByItemId(B,C).tagClass("-checked",A)},g=n.selMode;if(g=="single"||g=="singlecheckbox"){var s=d.getSubIdByItemId(u);if(u&&s){q("BAR",u,false);if(g=="singlecheckbox"){q("MARK",u,false)}}s=d.getSubIdByItemId(b);if(s){q("BAR",b,true);if(g=="singlecheckbox"){q("MARK",b,true)}if(!d._noScroll){var c=d.getSubNode("ITEM",s);if(c){var m=d.getSubNode("BOX"),f=c.offset(null,m),r=f?f.top:0,w=c.offsetHeight(),j=m.scrollHeight(),x=m.scrollTop(),e=m.height();if(j>e){if(r<x||(r+w)>(x+e)){m.scrollTop(r)}}}}}}else{if(g=="multi"||g=="multibycheckbox"){u=u?u.split(n.valueSeparator):[];b=b?b.split(n.valueSeparator):[];if(a){xui.arr.each(b,function(A){q("BAR",A);if(g=="multibycheckbox"){q("MARK",A)}})}else{xui.arr.each(u,function(A){q("BAR",A,false);if(g=="multibycheckbox"){q("MARK",A,false)}});xui.arr.each(b,function(A){q("BAR",A);if(g=="multibycheckbox"){q("MARK",A)}})}}}})},insertItems:function(d,e,l,j,c){var f,g,a=this._afterInsertItems;return this.each(function(q){var b,s,m,o,u=q.properties;g=q.box._adjustItems(d);if(e===true){v=u.$UIvalue||u.value;if(v){v=(v+"").split(u.valueSeparator)}m=q.getItemByItemId(v[0]);e=m?m.id:null}if(e){m=q.getItemByItemId(e);b=xui.isArr(m.sub)?m.sub:(o=true,m.sub=[])}else{m=u;b=m.items||(m.items=[])}if(q.renderId){if(l===true){v=u.$UIvalue||u.value;if(v){v=(v+"").split(u.valueSeparator)}m=q.getItemByItemId(v[0]);l=m?m.id:null}if(l){f=q.getSubNodeByItemId("ITEM",l);if(f){s=q._buildItems("items",q.box._prepareItems(q,g,e));if(j){f.addPrev(s)}else{f.addNext(s)}}}else{if(!e){f=q.getSubNode("ITEMS")}else{if(e){if(o){q.getSubNodeByItemId("TOGGLE",e).removeClass("xui-icon-placeholder xui-uicmd-none").addClass("xui-uicmd-toggle")}if(m._inited){f=q.getSubNodeByItemId("SUB",e)}}}if(f){s=q._buildItems("items",q.box._prepareItems(q,g,e));if(j){f.prepend(s)}else{f.append(s)}}}}if(!l){xui.arr.insertAny(b,g,j?0:-1)}else{var n=xui.arr.subIndexOf(b,"id",l);xui.arr.insertAny(b,g,j?n:(n+1))}if(q.renderId&&c!==false){if(!e){q.boxing()._toggleNodes(g,true,true,true)}else{if(q.getItemByItemId(e)._inited){if(!(("iniFold" in m)?m.iniFold:q.properties.iniFold)){q.boxing()._toggleNodes(g,true,true,true)}}}}if(a&&q.renderId){q.boxing()._afterInsertItems(q,g,e,l,j)}if(q.renderId&&e){q.box._tofold(q,m,e)}})},_toggleNodes:function(b,d,c,l){var a=this,g=a.get(0),j=g.properties,e=function(f,n,m,o){if(xui.isArr(f)){xui.arr.each(f,function(q){if(o&&(xui.isBool(q.iniFold)?q.iniFold:j.iniFold)){return}a.toggleNode(q.id,n,false,m);if(m&&q.sub&&xui.isArr(q.sub)&&q.sub.length){e(q.sub,n,true,o)}})}};e(b,d,c,l);return a},_removeAllkeys:function(a,c,d,b){xui.each(d.sub,function(e){xui.arr.removeValue(a,e.id);xui.arr.removeValue(c,e.caption);if(e.sub&&e.sub.length>0){a=b.boxing()._removeAllkeys(a,c,e,b)}});return a},_addAllkeys:function(a,c,d,b){xui.each(d.sub,function(e){a.push(e.id);c.push(e.caption);if(e.sub&&e.sub.length>0){a=b.boxing()._addAllkeys(a,c,e,b)}});return a},toggleNode:function(a,f,d,g,j){var c=this.get(0),e=this,l=arguments.callee;if(a){var b=c.getItemByItemId(a);if(b&&b.sub&&(f==true||!xui.isSet(f)||!!f!==!!b._checked)){c.box._setSub(c,b,((xui.isSet(f)?!!f:!b._checked)),d,g||d,j)}}else{xui.arr.each(c.properties.items,function(m){if(m.sub){l.call(e,m.id,f,d)}})}return this},reloadNode:function(a,f,d,g,j){var c=this.get(0),e=this,m=arguments.callee;if(a){var b=c.getItemByItemId(a);if(b&&b.sub){var l=c.getItemByItemId(a);xui.arr.each(xui.clone(l.sub),function(n){e.removeItems([n.id])});b.sub=true;e.toggleNode(a,false);xui.Thread.abort(c.key+c.id);b._inited=false;b._check=true;e.toggleNode(a,true)}}return this},disableNode:function(e,a){var d=this.get(0),c=this,b=arguments.callee;if(xui.isArr(e)){xui.each(e,function(j){var g=d.getItemByItemId(j);if(g){g.disabled=true;c.updateItem(g,g.caption)}})}else{var f=d.getItemByItemId(e);if(f){f.disabled=true;c.updateItem(f,f.caption)}}return this},getCallBackValue:function(){var c=this.get(0),b=this;var d=c.getModule().getData();var e={};var f=d.fieldName;if(f&&f.value){e[f.value]=this.getUIValue()}var a=d.fieldCaption;if(a&&a.value){e[a.value]=this.getCaptionValue()}return e},openToNode:function(b,a){return this.each(function(f){var e=false,d=[],c=function(g,l,j){j=j||0;var m=arguments.callee;xui.arr.each(g,function(n){if(n.id==l){d.push(n);e=true;return false}if(n.sub&&xui.isArr(n.sub)){e=m.call(m,n.sub,l,++j);if(e){d.push(n);return false}}});return e};c(f.properties.items,b);if(e){d.reverse();xui.arr.each(d,function(j,g){if(j.sub){f.boxing().toggleNode(j.id,true);if(a!==false&&g==d.length-1&&!(j.hasOwnProperty("group")?j.group:f.properties.group)){f.boxing().fireItemClickEvent(j.id)}}else{if(a!==false){f.boxing().fireItemClickEvent(j.id)}}})}})}},Static:{_focusNodeKey:"BAR",Templates:{tagName:"div",style:"{_style}",className:"{_className}",BORDER:{tagName:"div",className:"xui-uibase",BOX:{tagName:"div",ITEMS:{tagName:"div",className:"{_cmdsalign}",text:"{items}"}}},$submap:{items:{ITEM:{className:"",style:"{_itemDisplay}",tagName:"div",BAR:{$order:0,tabindex:"{_tabindex}",className:"xui-uitembg  xui-showfocus  {itemClass} {cls_group} {cls_fold} {_split} {disabled} {readonly}",style:"{itemStyle};{_splitstyle} {_itemColor}",RULER:{$order:2,style:"{_ruleDisplay};{rulerStyle}",text:"{innerIcons}"},TOGGLE:{$order:3,style:"{_tglDisplay}",className:"xuifont",$fonticon:"{_fi_togglemark}"},LTAGCMDS:{$order:4,tagName:"span",style:"{_ltagDisplay}",text:"{ltagCmds}"},MARK:{$order:5,className:"xuifont",$fonticon:"{_fi_check}",style:"{mark2Display}"},ITEMICON:{$order:6,className:"xuicon {imageClass} {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle} {_iconColor}",text:"{iconFontCode}"},ITEMCAPTION:{text:"{caption}",style:"{_capDisplay} {_fontColor}",className:"{disabled}  {readonly}",$order:7},EXTRA:{style:"{_extraDisplay}",text:"{ext}",$order:8},RTAGCMDS:{$order:9,tagName:"span",style:"{_rtagDisplay}",text:"{rtagCmds}"},OPT:{$order:10,style:"{_optDisplay}",className:"xuifont",$fonticon:"{_fi_optClass}"}},SUB:{$order:1,tagName:"div",text:xui.UI.$childTag}}},"items.ltagCmds":function(f,e,d,b,a){var g=arguments.callee,j=g._m||(g._m={text:".text",button:".button",image:".image"});var c=d.buttonType||d.type;xui.UI.$doTemplate(f,e,d,"items.tagCmds"+(j[c]||".button"),a)},"items.rtagCmds":function(f,e,d,b,a){var g=arguments.callee,j=g._m||(g._m={text:".text",button:".button",image:".image"});var c=d.buttonType||d.type;xui.UI.$doTemplate(f,e,d,"items.tagCmds"+(j[c]||".button"),a)},"items.tagCmds.text":xui.UI.$getTagCmdsTpl("text"),"items.tagCmds.button":xui.UI.$getTagCmdsTpl("button"),"items.tagCmds.image":xui.UI.$getTagCmdsTpl("image")}},Appearances:{KEY:{border:0},EXTRA:{display:"none"},BOX:{left:"1em",overflow:"auto","overflow-x":"hidden",position:"relative",clear:"both"},ITEMS:{overflow:"hidden"},ITEM:{"white-space":"nowrap",position:"relative",overflow:"hidden"},BAR:{cursor:"pointer",zoom:xui.browser.ie?1:null,position:"relative",display:"block",overflow:"hidden",padding:".25em .5em","border-radius":".3px 0 0 3px","-moz-border-radius":"3px 0 0 3px","-webkit-border-radius":"3px 0 0 3px","-o-border-radius":"3px 0 0 3px","-ms-border-radius":"3px 0 0 3px","-khtml-border-radius":"3px 0 0 3px","outline-offset":"-1px","-moz-outline-offset":(xui.browser.gek&&xui.browser.ver<3)?"-1px !important":null},SUB:{overflow:"hidden",zoom:xui.browser.ie?1:null,height:0,"font-size":xui.browser.ie68?"1px":null,"line-height":xui.browser.ie68?"1px":null,position:"relative","margin-left":"1.75em"},MARK:{cursor:"pointer","vertical-align":"middle"},"BAR-group":{$order:4,border:"none"},ITEMCAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle",padding:".167em","white-space":"normal"},OPT:{$order:10,position:"absolute",left:"auto",top:"50%","margin-top":"-0.5em",right:".167em",display:"none"},"LTAGCMDS, RTAGCMDS":{padding:0,margin:0,"vertical-align":"middle"},"ITEMS-tagcmdleft RTAGCMDS":{"padding-right":".333em","float":"left"},"ITEMS-tagcmdfloatright RTAGCMDS":{"padding-right":".333em","float":"right"},TOGGLE:{padding:"0 .334em 0 0"}},Behaviors:{HoverEffected:{TOGGLE:"TOGGLE",BAR:"BAR",OPT:"OPT",CMD:"CMD"},ClickEffected:{TOGGLE:"TOGGLE",BAR:"BAR",OPT:"OPT",CMD:"CMD"},DraggableKeys:["BAR"],NoDraggableKeys:["TOGGLE"],DroppableKeys:["BAR","TOGGLE","BOX"],TOGGLE:{onClick:function(b,f,g){var a=b.properties,d=xui.use(g).id(),c=b.getItemByDom(d);if(a.disabled||c.disabled){return false}if(!("sub" in c)){return false}b.box._setSub(b,c,!c._checked);return false}},BAR:{onDblclick:function(b,f,g){var a=b.properties,d=b.getItemByDom(g),c=b.onDblclick&&b.boxing().onDblclick(b,d,f,g);if(d.sub&&c!==false){b.getSubNode("TOGGLE",b.getSubId(g)).onClick()}},onClick:function(a,b,c){return a.box._onclickbar(a,b,c)},onKeydown:function(a,b,c){return a.box._onkeydownbar(a,b,c)},onContextmenu:function(a,b,c){if(a.onContextmenu){return a.boxing().onContextmenu(a,b,c,a.getItemByDom(c),xui.Event.getPos(b))!==false}},onMouseover:function(a,c,d){if(xui.browser.fakeTouch||xui.browser.deviceType=="touchOnly"){return}var b=a.getItemByDom(d);if(!b){return}if(!a.properties.optBtn&&!b.optBtn){return}a.getSubNode("OPT",a.getSubId(d)).setInlineBlock()},onMouseout:function(a,c,d){if(xui.browser.fakeTouch||xui.browser.deviceType=="touchOnly"){return}var b=a.getItemByDom(d);if(!b){return}if(!a.properties.optBtn&&!b.optBtn){return}a.getSubNode("OPT",a.getSubId(d)).css("display","none")}},OPT:{onClick:function(a,c,d){if(a.onShowOptions){var b=a.getItemByDom(d);if(!b){return}if(!a.properties.optBtn&&!b.optBtn){return}a.boxing().onShowOptions(a,b,c,d)}return false},onDblclick:function(a,b,c){return false}},CMD:{onClick:function(a,c,d){var f=a.properties,b=a.getItemByDom(xui.use(d).parent().get(0));if(!b){return false}if(f.disabled||b.disabled||b.type=="split"){return false}if(a.onCmd){a.boxing().onCmd(a,b,xui.use(d).id().split("_")[1],c,d)}return false}},BOX:{onScroll:function(a,b,c){if((b=xui.use(c)).scrollLeft()!==0){b.scrollLeft(0)}}}},EventHandlers:{onShowOptions:function(a,b,c,d){},beforeClick:function(a,b,c,d){},onClick:function(a,b,c,d){},afterClick:function(a,b,c,d){},onCmd:function(a,b,d,c,f){},onDblclick:function(a,b,c,d){},onGetContent:function(a,b,c){},onItemSelected:function(b,c,d,f,a){},beforeFold:function(a,b){},beforeExpand:function(a,b){},afterFold:function(a,b){},afterExpand:function(a,b){}},DataModel:{expression:{ini:"",action:function(){}},listKey:null,isFormField:{hidden:true,ini:false},autoFontColor:{ini:false,action:function(){this.boxing().refresh()}},autoIconColor:{ini:true,action:function(){this.boxing().refresh()}},autoItemColor:{ini:false,action:function(){this.boxing().refresh()}},iconColors:null,itemColors:null,fontColors:null,width:{$spaceunit:1,ini:"18em"},height:{$spaceunit:1,ini:"18em"},iniFold:true,animCollapse:true,dock:"fill",group:{ini:false,action:function(d){var c=this,b=c.properties.items,e=c.queryItems(b,function(f){return f.sub&&f.group===undefined}),a=xui();xui.arr.each(e,function(f){a.merge(c.getSubNodeByItemId("BAR",f.id))});if(d){a.addClass("xui-uigradient xui-uibar "+c.getClass("BAR","-group"))}else{a.removeClass("xui-uigradient xui-uibar "+c.getClass("BAR","-group"))}}},selMode:{ini:"single",listbox:["single","none","multi","singlecheckbox","multibycheckbox"],action:function(c){var b=this,d=this.properties,a=[];xui.each(this.SubSerialIdMapItem,function(e){if(!(e.sub&&(e.hasOwnProperty("group")?e.group:d.group))){a.push(b.getSubNodeByItemId("MARK",e.id).get(0))}});xui(a).css("display",(c=="singlecheckbox"||c=="multibycheckbox")?"":"none")}},noCtrlKey:true,singleOpen:false,dynDestory:false,position:"absolute",optBtn:{ini:"",combobox:xui.toArr("xui-uicmd-opt,xui-icon-singleright"),action:function(){this.boxing().refresh()}},togglePlaceholder:false,tagCmds:{ini:[],action:function(){this.boxing().refresh()}},tagCmdsAlign:{ini:"right",listbox:["left","right","floatright"],action:function(b){var c=this,d=c.getSubNode("ITEMS"),a=c.getClass("ITEMS","-tagcmd");d.removeClass(new RegExp(a+"[w]*")).addClass(c.getClass("ITEMS","-tagcmd"+b))}}},RenderTrigger:function(){this.boxing()._toggleNodes(this.properties.items,true,true,true)},_onclickbar:function(c,w,j){var l=c.properties,d=xui.use(j).id(),A=c.getItemByDom(d),n=c.getSubId(d),m=c.boxing(),D=xui.Event.getKey(w),B=c.getKey(xui.Event.getSrc(w).id||""),b=B==c.keys.TOGGLE||B==c.keys.MARK;if(!b&&c.beforeClick&&false===m.beforeClick(c,A,w,j)){return false}if(l.disabled||A.disabled||A.type=="split"){return false}if(!b&&c.onClick){m.onClick(c,A,w,j)}if(A.sub&&(A.hasOwnProperty("group")?A.group:l.group)){c.getSubNode("TOGGLE",n).onClick();return}c.getSubNode(c.box._focusNodeKey,n).focus(true);switch(l.selMode){case"none":m.onItemSelected(c,A,w,j,0);break;case"multibycheckbox":if(l.readonly||A.readonly){return false}var g=m.getCaptionValue();var r=m.getUIValue(),x=g?g.split(l.valueSeparator):[],a=r?r.split(l.valueSeparator):[],f=1;var o=l.items;if(D.shiftKey){if(c.$firstV._pid!=A._pid){return}var o=l.items;if(A._pid){var C=c.getItemByItemId(A._pid);if(C){o=C.sub}}var s=xui.arr.subIndexOf(o,"id",c.$firstV.id),q=xui.arr.subIndexOf(o,"id",A.id),u;a.length=0;for(u=Math.min(s,q);u<=Math.max(s,q);u++){a.push(o[u].id)}}else{if(xui.arr.indexOf(a,A.id)!=-1){xui.arr.removeValue(a,A.id);xui.arr.removeValue(x,A.caption);c.boxing()._removeAllkeys(a,x,A,c);f=-1}else{a.push(A.id);x.push(A.caption);c.boxing()._addAllkeys(a,x,A,c)}}a.sort();x.sort();r=a.join(l.valueSeparator);g=x.join(l.valueSeparator);if(m.getUIValue()!=g){c._noScroll=1;m.setUIValue(r,null,null,"click");m.setCaptionValue(g);delete c._noScroll;if(m.get(0)&&m.getUIValue()==r){m.onItemSelected(c,A,w,j,f)}}break;case"multi":if(l.readonly||A.readonly){return false}var r=m.getUIValue(),a=r?r.split(l.valueSeparator):[],f=1;if(a.length&&(D.ctrlKey||D.shiftKey||l.noCtrlKey)){if(D.shiftKey){if(c.$firstV._pid!=A._pid){return}var o=l.items;if(A._pid){var C=c.getItemByItemId(A._pid);if(C){o=C.sub}}var s=xui.arr.subIndexOf(o,"id",c.$firstV.id),q=xui.arr.subIndexOf(o,"id",A.id),u;a.length=0;for(u=Math.min(s,q);u<=Math.max(s,q);u++){a.push(o[u].id)}}else{if(xui.arr.indexOf(a,A.id)!=-1){xui.arr.removeValue(a,A.id);f=-1}else{a.push(A.id)}}a.sort();r=a.join(l.valueSeparator);if(m.getUIValue()!=r){c._noScroll=1;m.setUIValue(r,null,null,"click");delete c._noScroll;if(m.get(0)&&m.getUIValue()==r){m.onItemSelected(c,A,w,j,f)}}break}case"single":if(m.getUIValue()!=A.id){c.$firstV=A;c._noScroll=1;m.setUIValue(A.id,null,null,"click");delete c._noScroll;if(m.get(0)&&m.getUIValue()==A.id){m.onItemSelected(c,A,w,j,1)}}break;case"singlecheckbox":if(m.getUIValue()!=A.id){c.$firstV=A;c._noScroll=1;m.setUIValue(A.id,null,null,"click");delete c._noScroll;if(m.get(0)&&m.getUIValue()==A.id){m.onItemSelected(c,A,w,j,1)}}break}if(!b&&c.afterClick){m.afterClick(c,A,w,j)}return !b},_onkeydownbar:function(d,g,a){var o=xui.Event.getKey(g),n=o.key,c=o.shiftKey,b=o.ctrlKey,m=d.getSubNode(d.box._focusNodeKey,d.getSubId(a)),j=d.getRoot(),f=j.nextFocus(true,true,false),l=j.nextFocus(false,true,false);switch(n){case"enter":m.onClick();break;case"tab":if(c){if(m.get(0)!=f.get(0)){f.focus(true);return false}}else{if(m.get(0)!=l.get(0)){l.focus(true);return false}}break;case"up":if(b){d.getSubNode("TOGGLE",d.getSubId(a)).onClick();return false}if(m.get(0)==f.get(0)){l.focus(true)}else{m.nextFocus(false,true,false).focus(true)}return false;break;case"down":if(b){d.getSubNode("TOGGLE",d.getSubId(a)).onClick();return false}if(m.get(0)==l.get(0)){f.focus(true)}else{m.nextFocus(true,false,false).focus(true)}return false;break;case"right":case"left":d.getSubNode("TOGGLE",d.getSubId(a)).onClick();return false}},_onStartDrag:function(a,b,c,d){var d=xui.Event.getPos(b);xui.use(c).startDrag(b,{dragSource:a.$xid,dragType:"icon",shadowFrom:c,targetLeft:d.left+12,targetTop:d.top+12,dragCursor:"pointer",dragDefer:2,dragKey:a.box.getDragKey(a,c),dragData:a.box.getDragData(a,b,c)});return false},_onDropTest:function(c,m,a,n,j,o){var f=j&&j.domId;if(f){var g=xui.use(a).id();if(f==g){return false}if(xui.get(xui.use(a).get(0),["parentNode","previousSibling","firstChild","id"])==f){return false}var d=c.getItemByDom(f);if(d&&o&&d._pid==o.id){return false}var b=xui.use(a).get(0),l=c.getRootNode();while((b=b.parentNode)){if(c.getSubId(b.id)==c.getSubId(f)){return false}if(b.id==xui.get(l,["parentNode","id"])){break}}}},_onDrop:function(f,n,c,r,l,u){var j=f.getKey(xui.use(c).id()),d=l.profile,a=l.domId,g,q=f.keys,s=xui.absObj.$specialChars,o=f.boxing(),m=xui.copy(o.getUIValue(true));g=xui.clone(d.getItemByDom(a),function(e,b){return !s[(b+"").charAt(0)]});d.boxing().removeItems([g.id]);if(j==q.BOX){o.insertItems([g],null,null,false)}else{if(j==q.BAR){o.insertItems([g],u._pid,u.id,true)}else{if(j==q.TOGGLE){o.insertItems([g],u.id,null,false)}}}if(m&&m.length){if(xui.arr.indexOf(m,g.id)!=-1){f._noScroll=1;o.setUIValue(m,true,null,"drop");delete f._noScroll}}l._new=g;return false},_prepareData:function(b){var c=arguments.callee.upper.call(this,b),a=this,d=b.properties;c._cmdsalign=b.getClass("ITEMS","-tagcmd"+b.properties.tagCmdsAlign);xui.arr.each(c.items,function(f){var e=f.index;if(!e){e=xui.arr.indexOf(c.items,f)}a._autoColor(f,e,d)});return c},_initIconColors:function(d,f){var c=[],b=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],e=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],a=["#F19B60","#49CD81","#0277bd","#A693EB","#42a3af","#B0E0E6","#F06292"];switch(d){case"icon":c=b;if(f.iconColors&&f.iconColors.length>0){c=f.iconColors}break;case"font":c=e;if(f.fontColors&&f.fontColors.length>0){c=f.fontColors}break;case"item":c=a;if(f.itemColors&&f.itemColors.length>0){c=f.itemColors}break}return c},_autoColor:function(d,c,f){c=c||0;if(f.autoFontColor||d.fontColor){var e=this._initIconColors("font",f);while(c&&c>(e.length-1)){c=c-e.length}if(!d.fontColor){d.fontColor=e[c]}d._fontColor=d.fontColor?";color:"+d.fontColor:""}if(f.autoIconColor||d.iconColor){var b=this._initIconColors("icon",f);while(c&&c>(b.length-1)){c=c-b.length}if(!d.iconColor){d.iconColor=b[c]}d._iconColor=d.iconColor?";color:"+d.iconColor:""}if(f.autoItemColor||d.itemColor){var a=this._initIconColors("item",f);while(c&&c>(a.length-1)){c=c-a.length}if(!d.itemColor){d.itemColor=a[c]}d._itemColor=d.itemColor?";background-color:"+d.itemColor:"";d._fontColor=";color:#ffffff";d._iconColor=";color:#ffffff"}},_prepareItem:function(c,m,d,e,j,l){var a=c.properties,g=c.ItemIdMapSubSerialId,f=c.SubSerialIdMapItem,b;m._fi_check=m.ficheck?m.ficheck:"xui-uicmd-check";if(e){d._pid=e}m._fi_togglemark=m.sub?("xui-uicmd-toggle"+(m._checked?" xuifont-checked xui-uicmd-toggle-checked":"")):(a.togglePlaceholder?"xui-icon-placeholder":"xui-uicmd-none");m.disabled=m.disabled?"xui-ui-disabled":"";m.mark2Display=("showMark" in m)?(m.showMark?"":"display:none;"):(a.selMode=="multi"||a.selMode=="multibycheckbox")?"":"display:none;";m._tabindex=a.tabindex;m._fi_optClass=a.optBtn;if(m.sub&&(m.hasOwnProperty("group")?m.group:a.group)){m.cls_group="xui-uigradient xui-uibar "+c.getClass("BAR","-group");m.mark2Display="display:none"}this._prepareCmds(c,m);if(xui.browser.fakeTouch||xui.browser.deviceType=="mouseOnly"){m._optDisplay=a.optBtn?"display:block;":""}if(m.tglDisplay&&m.sub){m._tglDisplay="display:none;";m._optDisplay="display:block;"}if(m.type=="split"){m._split="xui-uitem-split";m._ruleDisplay=m._ltagDisplay=m._tglDisplay=m._rtagDisplay=m.imageDisplay=m.mark2Display=m._capDisplay=m._extraDisplay=m._optDisplay="display:none;"}},_setSub:function(e,B,u,x,j,o){var q=e.domId,b=e.boxing(),d=e.properties,l=e.getSubIdByItemId(B.id),c=e.getSubNode("TOGGLE",l),s=e.getSubNode("SUB",l),w=e.getSubNode("BAR",l),A=e.getSubNode("ITEMICON",l);if(xui.Thread.isAlive(e.key+e.id)){return}if(!u){if(B._checked){if(b.beforeFold&&false===b.beforeFold(e,B)){return}var a=function(){s.css({display:"none",height:0});c.tagClass("-checked",false);w.tagClass("-expand",false).tagClass("-fold");A.tagClass("-expand",false).tagClass("-fold");B._checked=false;if(d.dynDestory||B.dynDestory){var F=B.sub,r=[];for(var E=0,D=F.length;E<D;E++){r.push(F[E].id)}e.boxing().removeItems(r);B.sub=true;delete B._inited}if(b.afterFold){b.afterFold(e,B)}xui.resetRun(q,function(G){if(G){xui.tryF(G,[e,B],b)}},0,[o])};if(!j){if(d.animCollapse){s.animate({height:[s.height(),0]},null,a,200,null,"expoOut",e.key+e.id).start()}else{a()}}else{a()}}if(x&&B.sub&&!d.dynDestory&&!B.dynDestory){xui.arr.each(B.sub,function(r){if(r.sub&&r.sub.length){e.box._setSub(e,r,u,x,true,o)}})}}else{if(!B._checked){if(b.beforeExpand&&false===b.beforeExpand(e,B)){return}var a=function(r){s.css({display:"",height:"auto"});if(xui.browser.ie&&xui.browser.ver<=8){c.css({backgroundImage:"",backgroundRepeat:"",backgroundPositionX:"",backgroundPositionY:"",backgroundColor:"",backgroundAttachment:""})}else{c.removeClass("xui-icon-loading")}if(!r){B._checked=true;if(b.afterExpand){b.afterExpand(e,B)}}xui.resetRun(q,function(D){if(D){xui.tryF(D,[e,B],b)}},0,[o])},C=function(F,O,E,G,L,K,N,r){var M=F.boxing(),D=F.properties,J=r===false;if(!J&&!O._inited){delete O.sub;O._inited=true;if(r){if(typeof r=="string"){L.html(O.sub=r,false)}else{if(r["xui.Template"]||r["xui.UI"]){L.append(O.sub=r.render(true))}else{if(xui.isArr(r)){M.insertItems(r,O.id);if(!O.sub){O.sub=r}}}}var P=0,I=M.getUIValue(true);if(I&&I.length){xui.arr.each(r,function(Q){if(xui.arr.indexOf(I,Q.id||Q)!=-1){P=1;return false}});if(P){F._noScroll=1;M._setCtrlValue(M.getUIValue());delete F._noScroll}}}}if(D.singleOpen){M._toggleNodes(O._pid?F.getItemByItemId(O._pid).sub:D.items,false)}if(!J){G.tagClass("-checked");K.tagClass("-expand").tagClass("-fold",false);N.tagClass("-fold",false).tagClass("-expand")}if(!j){L.css("height","0px").css("display","");if(D.animCollapse){var H=0;L.children().each(function(Q){H+=Q.offsetHeight});L.animate({height:[0,H]},null,function(){a(J)},200,null,"expoIn",F.key+F.id).start()}else{a(J)}}else{a(J)}},g=B.sub,f=function(F){var E=this,D=e.boxing(),G=E._response,r=G?G.ids:[];if(F&&F.data){F=F.data}C(e,B,q,c,s,w,A,F);if(r&&xui.isArr(r)){xui.arr.each(r,function(H){})}},m;if((m=typeof g)=="string"||(m=="object"&&((xui.isArr(g)&&g.length>0)))){f(g)}else{if(e.onGetContent){if(xui.browser.ie&&xui.browser.ver<=8){c.css("background","url("+xui.ini.img_busy+") no-repeat")}else{c.addClass("xui-icon-loading")}var n=e.boxing().onGetContent(e,B,f);if(n||n===false){if(n===true){B._inited=true}f(n)}}}}if(x&&B.sub){xui.arr.each(B.sub,function(r){if(r.sub&&r.sub.length&&!r._checked){e.box._setSub(e,r,u,x,true,o)}})}}},_tofold:function(b,c,a){b.getSubNodeByItemId("BAR",a).addClass(b.getClass("BAR","-fold"));b.getSubNodeByItemId("TOGGLE",a).replaceClass(new RegExp("\\buicmd-(none|empty)\\b"),"xui-uicmd-toggle")},_onresize:function(c,b,a){c.getSubNode("BORDER").cssSize({width:b?b:null,height:a?a:null});c.getSubNode("BOX").cssSize({width:b?b:null,height:a?a:null})}}});xui.Class("xui.UI.TreeView","xui.UI.TreeBar",{Initialize:function(){this.addTemplateKeys(["IMAGE"]);var a=this.getTemplate();a.$submap.items.ITEM.BAR.className="xui-uitembg xui-uiborder-radius xui-showfocus {cls_group} {cls_fold} {_split} {disabled} {readonly}";var b=a.$submap.items.ITEM.BAR.ITEMICON;b.$fonticon="{_fi_cls_file}";this.setTemplate(a)},Static:{Appearances:{ITEMS:{padding:".0em"},ITEM:{"white-space":"nowrap",position:"relative","line-height":1.22,overflow:"hidden"},BAR:{zoom:xui.browser.ie?1:null,position:"relative",height:"2em",display:"block","outline-offset":"-1px","-moz-outline-offset":(xui.browser.gek&&xui.browser.ver<3)?"-1px !important":null},SUB:{zoom:xui.browser.ie?1:null,height:0,"font-size":xui.browser.ie68?"1px":null,"line-height":xui.browser.ie68?"1px":null,position:"relative",overflow:"hidden"},BOX:{left:"0em",overflow:"auto",position:"relative"}},Behaviors:{MARK:{onClick:function(a,b,c){a.box._onclickbar(a,b,xui.use(c).parent().xid());return false}},ITEMICON:{onClick:function(a,b,c){a.box._onclickbar(a,b,xui.use(c).parent().xid());return false}}},DataModel:{expression:{ini:"",action:function(){}},$subMargin:1.8,group:null,noIcon:{ini:false,action:function(a){this.getSubNode("ITEMICON",true).css("display",a?"none":"")}}},_prepareData:function(b){var c=arguments.callee.upper.call(this,b),a=this,d=b.properties;return c},_initIconColors:function(d,f){var c=[],b=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],e=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],a=["#F19B60","#49CD81","#0277bd","#A693EB","#42a3af","#B0E0E6","#F06292"];switch(d){case"icon":c=b;if(f.iconColors&&f.iconColors.length>0){c=f.iconColors}break;case"font":c=e;if(f.fontColors&&f.fontColors.length>0){c=f.fontColors}break;case"item":c=a;if(f.itemColors&&f.itemColors.length>0){c=f.itemColors}break}return c},_autoColor:function(d,c,f){c=c||0;if(f.autoFontColor||d.fontColor){var e=this._initIconColors("font",f);while(c&&c>(e.length-1)){c=c-e.length}if(!d.fontColor){d.fontColor=e[c]}d._fontColor=d.fontColor?";color:"+d.fontColor:""}if(f.autoIconColor||d.iconColor){var b=this._initIconColors("icon",f);while(c&&c>(b.length-1)){c=c-b.length}if(!d.iconColor){d.iconColor=b[c]}d._iconColor=d.iconColor?";color:"+d.iconColor:""}if(f.autoItemColor||d.itemColor){var a=this._initIconColors("item",f);while(c&&c>(a.length-1)){c=c-a.length}if(!d.itemColor){d.itemColor=a[c]}d._itemColor=d.itemColor?";background-color:"+d.itemColor:"";d._fontColor=";color:#ffffff";d._iconColor=";color:#ffffff"}},_prepareItem:function(d,o,e,f,m,n){var b=d.properties,l=d.ItemIdMapSubSerialId,j=d.SubSerialIdMapItem,g=d.getItemByItemId(f),a={},c;if(o.fiCheck){o._fi_check=o.fiCheck}else{o._fi_check="xui-uicmd-check"}if(g){a.autoIconColor=g.autoIconColor?g.autoIconColor:b.autoIconColor;a.autoFontColor=g.autoFontColor?g.autoFontColor:b.autoFontColor;a.autoItemColor=g.autoItemColor?g.autoItemColor:b.autoItemColor}this._autoColor(o,m,a);if(f){e._pid=f;if(c=j[l[f]]){e._deep=c._deep+1;o.rulerStyle="width:"+(e._deep*b.$subMargin)+"em;";o._fi_togglemark=o.sub?("xui-uicmd-toggle"+(o._checked?"-checked":"")):(b.togglePlaceholder?"xui-uicmd-empty":"xui-uicmd-none")}}else{e._deep=0;o.rulerStyle="";o.innerIcons="";o._fi_togglemark=o.sub?("xui-uicmd-toggle"+(o._checked?"-checked":"")):(b.togglePlaceholder?"xui-uicmd-empty":"xui-uicmd-none")}o.imageDisplay=(o.noIcon||b.noIcon)?"display:none;":"";o.cls_fold=o.sub?d.getClass("BAR","-fold"):"";if(!(o.imageClass||o.image||o.iconFontCode)){o._fi_cls_file="xui-icon-file"+(o.sub?" xui-icon-file-fold":"")}o._fi_optClass=b.optBtn;o.disabled=o.disabled?"xui-ui-disabled":"";o._itemDisplay=o.hidden?"display:none;":"";o.mark2Display=("showMark" in o)?(o.showMark?"":"display:none;"):((b.selMode=="singlecheckbox"&&!o.sub)||b.selMode=="multibycheckbox")?"":"display:none;";o._tabindex=b.tabindex;this._prepareCmds(d,o);if(o.type=="split"){o._split="xui-uitem-split";o._splitstyle="margin-left:"+(e._deep*b.$subMargin)+"em;";o._ruleDisplay=o._ltagDisplay=o._tglDisplay=o._rtagDisplay=o.imageDisplay=o.mark2Display=o._capDisplay=o._extraDisplay=o._optDisplay="display:none;"}},_tofold:function(c,d,b){var a=c.getClass("IMAGE");c.getSubNodeByItemId("BAR",b).addClass(c.getClass("BAR","-fold"));c.getSubNodeByItemId("TOGGLE",b).replaceClass(new RegExp("\\b"+a+"-path([-\\w]+)\\b"),a+"-fold$1")}}});xui.Class("xui.UI.MTreeView","xui.UI.TreeBar",{Initialize:function(){this.addTemplateKeys(["IMAGE"]);var a=this.getTemplate();a.$submap.items.ITEM.BAR.className="xui-uitembg xui-uiborder-radius xui-showfocus {cls_group} {cls_fold} {_split} {disabled} {readonly}";var b=a.$submap.items.ITEM.BAR.ITEMICON;b.$fonticon="{_fi_cls_file}";this.setTemplate(a)},Static:{Appearances:{ITEMS:{padding:".0em"},ITEM:{"white-space":"nowrap",position:"relative","line-height":1.22,"border-width":"1px","border-bottom-style":"solid","border-color":"#DDDDDD",overflow:"hidden"},MARK:{position:"absolute",left:"auto",top:"50%","margin-top":"-0.5em",right:".167em",$order:12,color:"#3ed268",cursor:"pointer","vertical-align":"middle"},BAR:{zoom:xui.browser.ie?1:null,position:"relative",height:"2em","border-width":"1px","border-top-style":"solid","border-color":"#DDDDDD",display:"block","outline-offset":"-1px","-moz-outline-offset":(xui.browser.gek&&xui.browser.ver<3)?"-1px !important":null},SUB:{zoom:xui.browser.ie?1:null,height:0,"font-size":xui.browser.ie68?"1px":null,"line-height":xui.browser.ie68?"1px":null,position:"relative",overflow:"hidden"},BOX:{left:"0em",overflow:"auto",position:"relative"}},Behaviors:{MARK:{onClick:function(a,b,c){a.box._onclickbar(a,b,xui.use(c).parent().xid());return false}},ITEMICON:{onClick:function(a,b,c){a.box._onclickbar(a,b,xui.use(c).parent().xid());return false}}},DataModel:{expression:{ini:"",action:function(){}},$subMargin:1.8,group:null,noIcon:{ini:true,action:function(a){this.getSubNode("ITEMICON",true).css("display",a?"none":"")}}},_initIconColors:function(d,f){var c=[],b=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],e=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],a=["#F19B60","#49CD81","#0277bd","#A693EB","#42a3af","#B0E0E6","#F06292"];switch(d){case"icon":c=b;if(f.iconColors&&f.iconColors.length>0){c=f.iconColors}break;case"font":c=e;if(f.fontColors&&f.fontColors.length>0){c=f.fontColors}break;case"item":c=a;if(f.itemColors&&f.itemColors.length>0){c=f.itemColors}break}return c},_autoColor:function(d,c,f){c=c||0;if(f.autoFontColor||d.fontColor){var e=this._initIconColors("font",f);while(c&&c>(e.length-1)){c=c-e.length}if(!d.fontColor){d.fontColor=e[c]}d._fontColor=d.fontColor?";color:"+d.fontColor:""}if(f.autoIconColor||d.iconColor){var b=this._initIconColors("icon",f);while(c&&c>(b.length-1)){c=c-b.length}if(!d.iconColor){d.iconColor=b[c]}d._iconColor=d.iconColor?";color:"+d.iconColor:""}if(f.autoItemColor||d.itemColor){var a=this._initIconColors("item",f);while(c&&c>(a.length-1)){c=c-a.length}if(!d.itemColor){d.itemColor=a[c]}d._itemColor=d.itemColor?";background-color:"+d.itemColor:"";d._fontColor=";color:#ffffff";d._iconColor=";color:#ffffff"}},_prepareItem:function(c,m,d,e,j,l){var a=c.properties,g=c.ItemIdMapSubSerialId,f=c.SubSerialIdMapItem,b;this._autoColor(m,j,a);if(m.fiCheck){m._fi_check=m.fiCheck}else{m._fi_check="xui-uimcmd-check"}if(e){d._pid=e;if(b=f[g[e]]){d._deep=b._deep+1;m.rulerStyle="width:"+(d._deep*a.$subMargin)+"em;";m._fi_togglemark=m.sub?("xui-uimcmd-toggle"+(m._checked?"-checked":"")):(a.togglePlaceholder?"xui-uicmd-empty":"xui-uicmd-none")}}else{d._deep=0;m.rulerStyle="";m.innerIcons="";m._fi_togglemark=m.sub?("xui-uimcmd-toggle"+(m._checked?"-checked":"")):(a.togglePlaceholder?"xui-uicmd-empty":"xui-uicmd-none")}m.imageDisplay=(m.noIcon||a.noIcon)?"display:none;":"";m.cls_fold=m.sub?c.getClass("BAR","-fold"):"";if(!(m.imageClass||m.image||m.iconFontCode)){m._fi_cls_file="xui-icon-file"+(m.sub?" xui-icon-file-fold":"")}m._fi_optClass=a.optBtn;m.disabled=m.disabled?"xui-ui-disabled":"";m._itemDisplay=m.hidden?"display:none;":"";m.mark2Display=("showMark" in m)?(m.showMark?"":"display:none;"):((a.selMode=="singlecheckbox"&&!m.sub)||a.selMode=="multibycheckbox")?"":"display:none;";m._tabindex=a.tabindex;this._prepareCmds(c,m);if(m.type=="split"){m._split="xui-uitem-split";m._splitstyle="margin-left:"+(d._deep*a.$subMargin)+"em;";m._ruleDisplay=m._ltagDisplay=m._tglDisplay=m._rtagDisplay=m.imageDisplay=m.mark2Display=m._capDisplay=m._extraDisplay=m._optDisplay="display:none;"}},_tofold:function(c,d,b){var a=c.getClass("IMAGE");c.getSubNodeByItemId("BAR",b).addClass(c.getClass("BAR","-fold"));c.getSubNodeByItemId("TOGGLE",b).replaceClass(new RegExp("\\b"+a+"-path([-\\w]+)\\b"),a+"-fold$1")}}});xui.Class("xui.UI.PopMenu",["xui.UI.Widget","xui.absList"],{Instance:{adjustSize:function(){this.each(function(c){if(c.renderId){var r=c.getRoot();var g=c.getSubNode("BORDER"),o=c.getSubNode("BOX"),l=c.getSubNode("BOXBGBAR"),q=c.getSubNode("ITEMS"),b=c.getSubNode("ITEM",true),a=c.properties,f=xui.$us(c),e=g.contentBox(),n=function(w,x){return c.$forceu(w,f>0?"em":"px",x)},j=0,d=0;q.cssSize({width:"auto",height:"auto"});d=q.height()+(e?0:g._borderH());if(xui.browser.ie67&&d%2==1){d+=1}q.addClass(c.getClass("ITEMS","-inline"));b.each(function(w){j=Math.max(j,w.offsetWidth)});if(j%2==1){j+=1}q.removeClass(c.getClass("ITEMS","-inline"));q.cssSize({width:n(j),height:n(d)});l.height(n(d));var m=n(Math.min(a._maxHeight,d)),s=n(Math.min(a._maxWidth,j)),u={width:s,height:m};a.width=s;a.height=m;r.cssSize(u);g.cssSize(u);o.cssSize({width:n(Math.min(a._maxWidth,j)+xui.Dom.getScrollBarSize()),height:u.height})}});return this._setScroll()},_setScroll:function(){return this.each(function(f){if(f.renderId){var g=f.getSubNode("BOX"),d=g.scrollTop(),e=g.scrollHeight(),a=f.getRoot(),c=a.offsetHeight();f.getSubNode("TOP").css("display",d===0?"none":"block");f.getSubNode("BOTTOM").css("display",(c>=e-d)?"none":"block")}})},_scrollToBottom:function(){var f=this.get(0),j=f.getSubNode("BOX"),d=f.getSubNode("BORDER"),l=j.scrollTop(),a=false,g,e=j.scrollHeight(),c=d.height();if(c<e-l){l+=(f.$scrollStep=Math.max(5,(f.$scrollStep||1)*1.005));if(c>=e-l){l=e-c;a=true}j.scrollTop(l);if(a){f.getSubNode("BOTTOM").css("display","none");f.$scrollTobottom=false;f.$scrollStep=1}else{f.getSubNode("TOP").css("display","block");if(f.$scrollTobottom){xui.asyRun(this._scrollToBottom,0,[],this)}}}},_scrollToTop:function(){var c=this.get(0),d=c.getSubNode("BOX"),e=d.scrollTop(),a=false;if(e>0){e-=(c.$scrollStep=Math.max(5,(c.$scrollStep||1)*1.005));if(e<0){e=0;a=true}d.scrollTop(e);if(a){c.getSubNode("TOP").css("display","none");c.$scrollToTop=false;c.$scrollStep=1}else{c.getSubNode("BOTTOM").css("display","block");if(c.$scrollToTop){xui.asyRun(this._scrollToTop,0,[],this)}}}},_initGrp:function(){var b=this.get(0),a;if(!b.$popGrp||!b.$popGrp.length){a=b.getRoot();b.$popGrp=[a._get(0)];a.setBlurTrigger(b.$xid,null);a.setBlurTrigger(b.$xid,function(){if(b.box){b.boxing().hide();if(b.$popGrp){b.$popGrp.length=0}}},b.$popGrp)}},setTagVar:function(a){var c=this,b=c.get(0);if(!b.tagVar){b.tagVar=a}else{xui.merge(b.tagVar,a,"all")}},pop:function(j,g,n,e){var l=this,d=l.get(0),c=d.properties,f=c.parentID||xui.ini.$rootContainer,a="$subPopMenuShowed",b="$highLight",m="$childPopMenu";if(!d.renderId){xui.Dom.getEmptyDiv().append(l.render(true))}if(d.$highLight){xui([d.$highLight]).tagClass("-hover",false)}d._conainer=f?xui.get(d,["host",f])?d.host[f].getContainer():xui(f):n||null;d.getRoot().popToTop(j,g,d._conainer);l._setScroll();l.adjustSize();l._initGrp();d[m]=d[a]=d[b]=null;return l},hide:function(m,f,g){var o,d=this.get(0),c=d.properties,l=d.getRoot(),a="$subPopMenuShowed",b="$highLight",n="$childPopMenu",j=function(){if(false!==m){if(false===d.boxing().beforeHide(d,f,g)){return this}}if(!l||l.css("display")=="none"){return}if(xui.get(d,["$hideMenuPool","_nodes",0])){d.$hideMenuPool.append(l)}else{l.css("display","none")}if(o=d[b]){xui([o]).tagClass("-hover",false)}var r=d[n],e;if(o=d[a]){o.hide(m,f)}while(r){r.boxing().hide(m,f);r=(e=r)[n];e[n]=e[a]=e[b]=null}d[n]=d[a]=d[b]=null;if(o=d.$parentPopMenu){o[a]=null}if(d.$popGrp){xui.arr.removeValue(d.$popGrp,l._get(0))}if(!d.$popGrp||!d.$popGrp.length){l.setBlurTrigger(d.$xid,null)}if(false!==m){d.boxing().onHide(d)}};l.hide(j,null,f);return this},_afterInsertItems:function(a){if(!a.renderId){return}a.boxing().adjustSize()},_afterRemoveItems:function(a){if(!a.renderId){return}a.boxing().adjustSize()}},Initialize:function(){var a=this.getTemplate();xui.merge(a.FRAME.BORDER,{className:"xui-uiborder-outset xui-uiborder-radius",TOP:{className:"xuifont xui-uibar xui-uiborder-b",$fonticon:"xui-icon-circleup"},BOTTOM:{className:"xuifont xui-uibar xui-uiborder-t",$fonticon:"xui-icon-circledown"},BOX:{tagName:"div",className:"xui-uibase",BOXBGBAR:{tabName:"div",className:"xui-uibar",style:"{_iconDisplay}"},ITEMS:{tagName:"div",text:"{items}"}},POOL:{}},"all");a.$submap={items:function(g,f,d,c,b){var e;c=c+"."+d.type;if(e=d.object){b[b.length]=e.build(d)}else{if(f[c]){xui.UI.$doTemplate(g,f,d,c,b)}}},"items.split":{ITEMSPLIT:{style:"{_itemDisplay}",className:"xui-uiborder-b"}},"items.button":{ITEM:{tabindex:-1,className:" xui-uimenu {itemClass} {disabled}",style:"{itemStyle}{_itemDisplay}{_itemColor}",ICON:{$order:0,className:" {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{_iconDisplay}{iconStyle} {_iconColor}",text:"{iconFontCode}"},CAPTION:{text:"{caption}",style:"{_fontColor}",$order:1},RULER:{style:"{displayAdd}",$order:2},ADD:{tagName:"div",style:"{displayAdd}",text:"{add}",$order:2},SUB:{className:"xuifont",$fonticon:"xui-icon-singleright",style:"{displaySub}"}}},"items.checkbox":{ITEM:{tabindex:-1,className:"  xui-uimenu {itemClass} {disabled}",style:"{itemStyle}{_itemDisplay}",CHECKBOX:{$order:0,className:"xuifont",$fonticon:"{_fi_checkboxCls1} {_fi_checkboxCls2}  {_iconDisplay}"},CAPTION:{text:"{caption}",$order:1},RULER:{style:"{displayAdd}",$order:2},ADD:{tagName:"div",style:"{displayAdd}",text:"{add}",$order:2}}},"items.radiobox":{ITEM:{tabindex:-1,className:"  xui-uimenu {itemClass} {disabled}",style:"{itemStyle}{_itemDisplay}",RADIOBOX:{$order:0,className:"xuifont",$fonticon:"{_fi_radioboxCls1} {_fi_radioboxCls2}  {_iconDisplay}"},CAPTION:{text:"{caption}",$order:1},RULER:{style:"{displayAdd}",$order:2},ADD:{tagName:"div",style:"{displayAdd}",text:"{add}",$order:2}}}};this.setTemplate(a);this.prototype.popUp=this.prototype.pop},Static:{$initRootHidden:true,Appearances:{KEY:{visibility:"hidden"},POOL:{position:"absolute",display:"none"},BOX:{overflow:"hidden",position:"relative",overflow:"hidden","overflow-y":"auto","z-index":"3"},BORDER:{position:"relative",overflow:"hidden"},ITEMS:{position:"relative",top:0,left:0,overflow:"hidden","white-space":"nowrap"},BOXBGBAR:{"z-index":-1,position:"absolute",left:0,top:0,width:"2em",height:"100%"},"ITEMS-inline ITEM":{$order:5,display:xui.$inlineBlock},ITEM:{display:"block",position:"relative",overflow:"visible","white-space":"nowrap",cursor:"pointer",padding:".25em 1.75em .25em .25em",outline:0},ITEMSPLIT:{display:"block",position:"relative",overflow:"visible","white-space":"nowrap",margin:".25em .25em .25em 2em"},ICON:{margin:0,"font-size":"1.25em  !important"},TOP:{cursor:"pointer",display:"none",position:"absolute","z-index":"10",top:0,"text-align":"center",width:"100%"},BOTTOM:{cursor:"pointer",display:"none",position:"absolute",bottom:0,"z-index":"10","text-align":"center",width:"100%"},"RADIOBOX, CHECKBOX, RADIOBOX-checked, CHECKBOX-checked":{cursor:"pointer","vertical-align":"middle"},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle","padding-left":".75em","font-size":"1em"},RULER:{width:"8em"},ADD:{position:"absolute",top:".25em",right:0,width:"7em","padding-right":"1.75em","text-align":"right","z-index":"10",zoom:xui.browser.ie?1:null},SUB:{position:"absolute",top:".15em",right:".15em"}},Behaviors:{HoverEffected:{TOP:"TOP",BOTTOM:"BOTTOM"},BOX:{onScroll:function(a,b,c){a.boxing()._setScroll()}},ITEM:{onMouseover:function(g,l,b){var d="$subPopMenuShowed",q="$allPops",f="$highLight",o="$showpops",j="$popGrp";if(g[f]==b){return}g[q]=g[q]||{};var m=g.properties,A=g.getItemByDom(b),n=A.id,x=false,u,c,w;if(w=g[d]){if(w==xui.get(g,[q,n])){x=true}else{w.hide();g[d]=null}}if(!x){if(w=g[f]){xui([w]).tagClass("-hover",false)}g[f]=b;xui.use(b).tagClass("-hover");try{xui.use(b).get(0).focus()}catch(l){}}if(!x&&A.sub){if(!(xui.isArr(A.sub)&&A.sub.length)){if(g.onShowSubMenu){var a=g[q][n];if(a&&a["xui.UI"]&&!a.isEmpty()){}else{a=g.boxing().onShowSubMenu(g,A,b)}if(a&&a["xui.UI"]&&!a.isEmpty()){g[q][n]=g[d]=a;a=a.reBoxing();a.onMouseout(function(B,r,C){g.box._mouseout(g,r,C)},null,-1);g.boxing()._initGrp();g[j].push(a._get(0));a.popToTop(b,2,g._conainer);return}else{if(a&&xui.isArr(a)&&a.length){A.sub=a}}}}if(xui.isArr(A.sub)&&A.sub.length){if(!(u=g[q][n])){var s=g.properties;u=(new xui.UI.PopMenu({position:"absolute",items:A.sub,autoHide:s.autoHide,showEffects:s.showEffects,hideEffects:s.hideEffects})).render(true);u.onShowSubMenu(function(B,e,r){return g.boxing().onShowSubMenu(g,e,r)});u.onMenuSelected(function(B,e,r){return g.boxing().onMenuSelected(g,e,r)});c=u.get(0);c.$hideMenuPool=xui.get(g,["$hideMenuPool","_nodes",0])||g.getSubNode("POOL");g[q][n]=u;g[o]=g[o]||[g];c[o]=g[o];g[o].push(c)}else{c=u.get(0)}g.boxing()._initGrp();g[j].push(c.getRoot()._get(0));c[j]=g[j];c.$parentPopMenu=g;g.$childPopMenu=c;u.pop(b,2,g._conainer);g[d]=u}}},onMouseout:function(f,l,b){var m=f.properties,r=f.getItemByDom(b),n=r.id,g=true,c="$highLight",q;if(f[c]==b){return}if(q=f.$subPopMenuShowed){var d=l.toElement||l.relatedTarget,j=q.get(0).getRootNode();try{do{if(d==j){return}}while((d&&(d=d.parentNode)))}catch(o){}}xui.use(b).tagClass("-hover",false);f[c]=null},onClick:function(a,c,f){var g=a.properties,b=a.getItemByDom(f),d=b.id;if(g.disabled||b.disabled){return false}if(!b.group){if(b.type=="checkbox"){a.getSubNodeByItemId("CHECKBOX",b.id).tagClass("-checked",b.value=!b.value)}else{if(b.type=="radiobox"){a.getSubNode("RADIOBOX",true).tagClass("-checked",false);xui.arr.each(g.items,function(e){if(e.type=="radiobox"){e.value=false}});a.getSubNodeByItemId("RADIOBOX",b.id).tagClass("-checked",b.value=true)}}if(a.onMenuSelected){a.boxing().onMenuSelected(a,b,f)}if(g.hideAfterClick){xui.use(f).tagClass("-hover",false);xui.asyRun(function(){var j=a,e;if(!j.renderId){return}while(j){j.boxing().hide();j=(e=j).$parentPopMenu;e.$parentPopMenu=e.$subPopMenuShowed=null}a.$subPopMenuShowed=null;if(a.$popGrp){a.$popGrp.length=0}},100)}}},onFocus:function(b,f,g){var c=b.getSubNode("BOX"),d=c.scrollTop(),a=c.scrollHeight(),j=xui.use(g).offsetTop();if(j<d||j>d+a){xui.use(g).offsetTop(d)}xui.use(g).onMouseover()},onKeydown:function(d,g,b){var q=d.getItemByDom(b),j=d.properties.items,n=xui.Event.getKey(g).key,m=q.id,l,a,f,c,o;switch(n){case"enter":xui(b).onClick();break;case"up":a=true;l=false;xui.arr.each(j,function(r,e){if(r.type=="split"){return}if(l){f=r.id;return a=false}if(r.id==m){l=true}},null,true);if(a){f=j[j.length-1].id}c=d.getSubNodeByItemId("ITEM",f).get(0);break;case"down":a=true;l=false;xui.arr.each(j,function(r,e){if(r.type=="split"){return}if(l){f=r.id;return a=false}if(r.id==m){l=true}});if(a){f=j[0].id}c=d.getSubNodeByItemId("ITEM",f).get(0);break;case"left":if(o=d.$parentPopMenu){if(o=d.$parentPopMenu.$highLight){c=o}}break;case"right":if((o=d.$subPopMenuShowed)&&o==d.$allPops[m]){o.activate()}break}if(c&&c.tagName){try{c.focus()}catch(g){}}}},TOP:{onMouseover:function(a){a.$scrollToTop=true;a.$scrollStep=1;a.boxing()._scrollToTop()},onMouseout:function(a){a.$scrollToTop=false;a.$scrollStep=1},onClick:function(a){a.$scrollStep*=2}},BOTTOM:{onMouseover:function(a){a.$scrollTobottom=true;a.$scrollStep=1;a.boxing()._scrollToBottom()},onMouseout:function(a){a.$scrollTobottom=false;a.$scrollStep=1},onClick:function(a){a.$scrollStep*=2}},ITEMS:{afterKeydown:function(b,c){var a=xui.Event.getKey(c).key;if(a=="tab"||a=="enter"){return true}else{if(a=="esc"){do{b.boxing().hide()}while(b=b.$parentPopMenu);return false}else{return false}}}},BORDER:{onMouseout:function(a,b,c){a.box._mouseout(a,b,c)}}},DataModel:({expression:{ini:"",action:function(){}},autoFontColor:{ini:false,action:function(){this.boxing().refresh()}},autoIconColor:{ini:true,action:function(){this.boxing().refresh()}},autoItemColor:{ini:false,action:function(){this.boxing().refresh()}},iconColors:null,itemColors:null,fontColors:null,dock:null,tabindex:null,tips:null,border:null,resizer:null,dragSortable:null,showEffects:"Blur",hideEffects:"",autoTips:false,shadow:true,_maxHeight:360,_maxWidth:460,left:-10000,parentID:"",hideAfterClick:true,autoHide:false,height:{$spaceunit:1,ini:"auto"},width:{$spaceunit:1,ini:"auto"},position:"absolute",noIcon:{ini:false,action:function(){this.boxing().refresh()}},$hborder:0,$vborder:0}),EventHandlers:{onShowSubMenu:function(a,b,c){},beforeHide:function(a,b){},onHide:function(a){},onMenuSelected:function(a,b,c){}},RenderTrigger:function(){var a=this;a.boxing().adjustSize();(a.$beforeDestroy=(a.$beforeDestroy||{}))["sub-pops"]=function(b){xui.each(a.$allPops,function(c){if(c&&!c.$noDestroyByParentMenu){if(c["xui.UI"]&&!c.isEmpty()&&!c.isDestroyed()){c.destroy()}else{if(c["xui.UIProfile"]&&!c.destroyed){c.__gc()}else{if(c["xui.Dom"]&&!c.isEmpty()){c.remove()}}}}})}},_initIconColors:function(d,f){var c=[],b=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],e=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],a=["#F19B60","#49CD81","#0277bd","#A693EB","#42a3af","#B0E0E6","#F06292"];switch(d){case"icon":c=b;if(f.iconColors&&f.iconColors.length>0){c=f.iconColors}break;case"font":c=e;if(f.fontColors&&f.fontColors.length>0){c=f.fontColors}break;case"item":c=a;if(f.itemColors&&f.itemColors.length>0){c=f.itemColors}break}return c},_autoColor:function(d,c,f){c=c||0;if(f.autoFontColor||d.fontColor){var e=this._initIconColors("font",f);while(c&&c>(e.length-1)){c=c-e.length}if(!d.fontColor){d.fontColor=e[c]}d._fontColor=d.fontColor?";color:"+d.fontColor:""}if(f.autoIconColor||d.iconColor){var b=this._initIconColors("icon",f);while(c&&c>(b.length-1)){c=c-b.length}if(!d.iconColor){d.iconColor=b[c]}d._iconColor=d.iconColor?";color:"+d.iconColor:""}if(f.autoItemColor||d.itemColor){var a=this._initIconColors("item",f);while(c&&c>(a.length-1)){c=c-a.length}if(!d.itemColor){d.itemColor=a[c]}d._itemColor=d.itemColor?";background-color:"+d.itemColor:"";d._fontColor=";color:#ffffff";d._iconColor=";color:#ffffff"}},_beforeSerialized:function(a){var b=arguments.callee.upper.call(this,a),c=b.properties;delete c.left;delete c.top;delete c.right;delete c.bottom;delete c.width;delete c.height;return b},_mouseout:function(d,g){if(d.properties.autoHide){var j=xui.Event.getPos(g),c,f,a;xui.arr.each(d.$popGrp,function(b){b=xui([b]);f=b.offset();c=b.cssSize();if(j.left>=f.left&&j.top>=f.top&&j.left<=f.left+c.width&&j.top<=f.top+c.height){a=1;return false}});if(!a){while(a=d.$parentPopMenu){d=a}d.boxing().hide(true,null,g);if(d.$popGrp){d.$popGrp.length=0}}}},_prepareData:function(b){var c=arguments.callee.upper.call(this,b),d="display:none",a=this,e=b.properties;if(e.noIcon){c._iconDisplay=d}xui.arr.each(c.items,function(g){var f=g.index;if(!f){f=xui.arr.indexOf(c.items,g)}a._autoColor(g,f,e)});return c},_prepareItem:function(a,b){var c="display:none;",d=a.properties;b.add=b.add||"";b.displayAdd=b.add?"":c;b.displaySub=b.sub?"":c;b._itemDisplay=b.hidden?c:"";if(!b.image){b.imageClass=b.imageClass?b.imageClass:"xuicon xui-icon-placeholder";if(xui.str.startWith("xui-")){b.imageClass="xuicon "+b.imageClass}}else{b.imageClass="xuicon xui-icon-placeholder "}b._iconDisplay=d.noIcon?c:"";b.type=b.type||"button";if(b.type=="checkbox"){b._fi_checkboxCls1="xui-uicmd-check";b._fi_checkboxCls2=b.value?"xuicon-checked xui-uicmd-check-checked":""}else{if(b.type=="radiobox"){b._fi_radioboxCls1="xui-uicmd-radio";b._fi_radioboxCls2=b.value?"xuicon-checked xui-uicmd-radio-checked":""}}},_onresize:null}});xui.Class("xui.UI.MenuBar",["xui.UI","xui.absList"],{Instance:{updateItem:function(d,c){var b=this,f=b.get(0),a=f.properties.items;if(xui.arr.subIndexOf(a,"id",d)!=-1){arguments.callee.upper.call(b,d,c)}else{var e=0;xui.each(f.$allPops,function(g){g.updateItem(d,c);e=1});if(!e){arguments.callee.upper.call(b,d,c)}}return b},_pop:function(m,b){var n=this,e=n.get(0);if(e.$curPop){n.hide()}if(!m.sub){return}if(e.beforePopMenu&&false==e.boxing().beforePopMenu(e,m,b)){return}else{xui.use(b).tagClass("-active");var d,c=m.id,j=e.properties,f=j.parentID||xui.ini.$rootContainer,g="$allPops";e.$curPop=c;e.$curElem=b;e.$menuPop=c;e[g]=e[g]||{};if(!e[g][c]){var l=function(o){var q={position:"absolute",items:o,autoHide:!!j.autoShowTime};if(j.showEffects){q.showEffects=j.showEffects}if(j.hideEffects){q.hideEffects=j.hideEffects}var r=xui.create("PopMenu",q);e.getSubNode("POOL").append(r);r.onHide(function(s){n.hide(false)}).onMenuSelected(function(w,s,u){return e.boxing().onMenuSelected(e,w,s,u)}).onShowSubMenu(function(w,s,u){return e.boxing().onShowSubMenu(e,w,s,u)});r.get(0).$hideMenuPool=e.getSubNode("POOL");r.get(0)[g]=e[g];e[g][c]=r};if(xui.isArr(m.sub)&&m.sub.length){l(m.sub)}else{if(e.onGetPopMenu){var a=e.boxing().onGetPopMenu(e,m,l);if(xui.isArr(a)&&a.length){l(m.sub=a)}}}}if(e[g][c]){e[g][c].pop(xui(b),1,f?xui.get(e,["host",f])?e.host[f].getContainer():xui(f):null)}return false}},_afterInsertItems:function(){this.clearPopCache()},hide:function(a){var b=this.get(0),d,e=b.$curPop,c=b.$curElem;if(d=b.$allPops[e]){if(false!==arguments[0]){d.hide(false,a)}b.getSubNode("POOL").append(d.reBoxing());xui([c]).tagClass("-active",false)}b.$menuPop=b.$curPop=b.$curElem=null},clearPopCache:function(){var a=this.get(0);if(a.renderId){a.getSubNode("POOL").empty();a.$allPops=a.$curPop=a.$curElem=null}}},Initialize:function(){xui.SC("xui.UI.PopMenu")},Static:{_nocap2tip:true,Templates:{tagName:"div",className:"{_className};{_vAlign}",style:"{_style}",POOL:{tagName:"div"},BORDER:{className:"xui-uibar xui-uiborder-radius",tagName:"div",style:"border:{borderStyle};{_hAlign}",LIST:{tagName:"div",HANDLER:{className:"xuifont",$fonticon:"xui-icon-placeholder",style:"{handler}"},ITEMS:{$order:1,text:"{items}"}}},$submap:{items:{ITEM:{style:"{itemStyle}{_itemDisplay}{_itemColor}",className:"xui-uimenu",ITEMI:{ITEMC:{ITEMA:{tabindex:"{_tabindex}",className:" {typeCls} {disabled}",ICON:{$order:1,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle} {_iconColor}",text:"{iconFontCode}"},CAPTION:{$order:2,text:"{caption}",style:"{captionDisplay}  {_fontColor}"}}}}}}}},Appearances:{KEY:{position:"absolute",left:0,top:0},POOL:{width:0,height:0,visibility:"hidden",position:"absolute",left:"-10000px",top:"-10000px"},BORDER:{left:0,top:0},HANDLER:{height:"100%",width:"0.5em",background:"url("+xui.ini.img_handler+") repeat-y left top",cursor:"move","vertical-align":"middle"},LIST:{padding:".125em"},ITEMS:{"vertical-align":"middle"},ITEM:{"white-space":"nowrap","vertical-align":"top",overflow:"hidden",margin:"0 .25em 0 .25em",},"ITEM *":{cursor:"pointer"},ITEMI:{padding:"0 .25em","vertical-align":"top"},ITEMC:{padding:".25em 0","vertical-align":"top"},ITEMA:{display:xui.$inlineBlock},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle","font-size":"1em"}},Behaviors:{ITEM:{onMouseover:function(b,f,j){var d=b.properties,a=j;if(d.disabled){return}var c=b.getItemByDom(j),g=c.id;if(c.disabled){return}xui.use(a).tagClass("-hover");if(b.$menuPop){if(b.$menuPop!=g){b.boxing()._pop(c,a)}}else{if(d.autoShowTime){xui.resetRun(b.$xid+":autoShowTime",function(){b.boxing()._pop(c,a)},d.autoShowTime)}}},onMouseout:function(d,f,a){var b=d.properties;if(b.disabled){return}var n=d.getItemByDom(a);if(n.disabled){return}if(n.id!=b.value){xui.use(a).tagClass("-hover",false);xui.use(a).tagClass("-active",false)}if(b.autoShowTime){var j=d.$allPops;if(j=j&&j[d.$curPop]){var c=j.get(0).getRoot(),l=xui.Event.getPos(f),o=c.cssSize(),m=3,g=c.offset();if(l.left>g.left&&l.top>g.top-m&&l.left<g.left+o.width&&l.top<g.top+o.height){}else{j.hide()}}xui.resetRun(d.$xid+":autoShowTime",null)}},onMousedown:function(a,d,g){var c=a.properties;if(c.disabled){return}var b=a.getItemByDom(g),f=b.id;if(b.disabled){return}xui.use(g).tagClass("-active");c.value=b.id;return a.boxing()._pop(b,g)},onMouseup:function(a,c,d){var b=a.getItemByDom(d);if(a.$menuPop!=b.id){xui.use(d).tagClass("-active",false)}},onKeydown:function(c,g,a){var n=xui.Event.getKey(g),m=n.key,b=n.shiftKey,l=xui(a),f=c.getRoot().nextFocus(true,true,false),j=c.getRoot().nextFocus(false,true,false);switch(xui.Event.getKey(g).key){case"tab":if(b){if(l.get(0)!=f.get(0)){f.focus(true);return false}}else{if(l.get(0)!=j.get(0)){j.focus(true);return false}}break;case"left":case"up":var d=l.nextFocus(false,true,false);if(l.get(0)==f.get(0)){j.focus(true)}else{l.nextFocus(false)}return false;break;case"right":case"down":var d=l.nextFocus(true,false,false);if(l.get(0)==j.get(0)){f.focus(true)}else{l.nextFocus()}return false;break;case"enter":l.onMousedown();break}},onClick:function(b,f,g){var c=b.getItemByDom(g),d=b.properties;xui.use(g).tagClass("-active");var a=b.boxing();xui.each(a.getItems(),function(e){if(e.id!=c.id){a.getSubNodeByItemId("ITEM",e.id).tagClass("-hover",false);a.getSubNodeByItemId("ITEM",e.id).tagClass("-active",false)}});d.value=c.id;if(b.$menuPop!=c.id){if(b.onMenuBtnClick){b.boxing().onMenuBtnClick(b,c,g)}}}}},DataModel:{listKey:null,dragSortable:null,autoTips:false,expression:{ini:"",action:function(){}},autoFontColor:{ini:false,action:function(){this.boxing().refresh()}},autoIconColor:{ini:false,action:function(){this.boxing().refresh()}},autoItemColor:{ini:false,action:function(){this.boxing().refresh()}},iconColors:null,itemColors:null,fontColors:null,value:{ini:"",action:function(){}},height:{$spaceunit:1,ini:"auto",readonly:true},width:{$spaceunit:1,ini:"auto"},border:{ini:"outset",listbox:["none","flat","inset","outset","groove","ridge"],action:function(a){var b=this,c=b.properties;b.box._borderType(b,a,c.sideBarStatus,c.sideBarType.split("-"),true)}},parentID:"",hAlign:{ini:"left",listbox:["left","center","right"],action:function(a){this.getSubNode("BORDER").css("textAlign",a)}},vAlign:{ini:"middle",listbox:["top","middle","bottom"],action:function(a){this.getSubNode("POOL").css("vertical-align:",a)}},$hborder:1,$vborder:1,left:0,top:0,autoShowTime:200,handler:{ini:true,action:function(a){this.getSubNode("HANDLER").css("display",a?"":"none")}},position:"absolute",dock:{ini:"top",listbox:["top","bottom","left","right"]}},LayoutTrigger:function(){var a=this.properties,b=this.getSubNode("BORDER");a.$hborder=a.$vborder=b._borderW("left")},EventHandlers:{onGetPopMenu:function(a,b,c){},onMenuBtnClick:function(a,b,c){},beforePopMenu:function(a,b,c){},onShowSubMenu:function(a,d,b,c){},onMenuSelected:function(a,d,b,c){}},RenderTrigger:function(){if(this.properties.disabled){this.boxing().setDisabled(true,true)}},_prepareData:function(c){var a="display:none;";var d=arguments.callee.upper.call(this,c);var e=c.properties,b=this;d._hAlign=e.hAlign!="left"?("text-align:"+e.hAlign+";"):"";d._vAlign=e.vAlign!="center"?("vertical-align:"+e.vAlign+";"):"";d.handler=d.handler?"":a;xui.arr.each(d.items,function(g){var f=g.index;if(!f){f=xui.arr.indexOf(d.items,g)}b._autoColor(g,f,e)});d._itemDisplay=d.hidden?a:"";return d},_initIconColors:function(d,f){var c=[],b=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],e=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],a=["#F19B60","#49CD81","#0277bd","#A693EB","#42a3af","#B0E0E6","#F06292"];switch(d){case"icon":c=b;if(f.iconColors&&f.iconColors.length>0){c=f.iconColors}break;case"font":c=e;if(f.fontColors&&f.fontColors.length>0){c=f.fontColors}break;case"item":c=a;if(f.itemColors&&f.itemColors.length>0){c=f.itemColors}break}return c},_autoColor:function(d,c,f){c=c||0;if(f.autoFontColor||d.fontColor){var e=this._initIconColors("font",f);while(c&&c>(e.length-1)){c=c-e.length}if(!d.fontColor){d.fontColor=e[c]}d._fontColor=d.fontColor?";color:"+d.fontColor:""}if(f.autoIconColor||d.iconColor){var b=this._initIconColors("icon",f);while(c&&c>(b.length-1)){c=c-b.length}if(!d.iconColor){d.iconColor=b[c]}d._iconColor=d.iconColor?";color:"+d.iconColor:""}if(f.autoItemColor||d.itemColor){var a=this._initIconColors("item",f);while(c&&c>(a.length-1)){c=c-a.length}if(!d.itemColor){d.itemColor=a[c]}d._itemColor=d.itemColor?";background-color:"+d.itemColor:"";d._fontColor=";color:#ffffff";d._iconColor=";color:#ffffff"}},}});xui.Class("xui.UI.ToolBar",["xui.UI","xui.absList"],{Instance:{updateItem:function(f,d){if(d.type){return arguments.callee.upper.call(this,f,d)}else{var s=this,c=s.get(0),n=c.box,u=c.properties.items,w=c.queryItems(u,function(b){return typeof b=="object"?b.id===f:b==f},true,true,true),o,x,m,l,j,g,e,r;if(xui.isStr(d)){d={caption:d}}if(w.length){w=w[0];if(x=w[0]){if(xui.isSet(d.id)){d.id+=""}if(d.id&&f!==d.id){o=d.id;var a=c.ItemIdMapSubSerialId,q;if(!a[o]){if(q=a[f]){a[o]=q;delete a[f];c.SubSerialIdMapItem[q].id=o}else{x.id=o}}}delete d.id;if(xui.isEmpty(d)){return s}m=c.getSubNodeByItemId("ICON",o||f);l=c.getSubNodeByItemId("CAPTION",o||f);j=c.getSubNodeByItemId("ITEM",o||f);g=c.getSubNodeByItemId("LABEL",o||f);e=c.getSubNodeByItemId("BTN",o||f);if("value" in d&&d.value!==x.value){c.getSubNodeByItemId("BTN",o||f).tagClass("-checked",!!d.value)}if("caption" in d&&d.caption!==x.caption){l.html(d.caption);if(d.caption&&!x.caption){l.css("display","")}if(!d.caption&&x.caption){l.css("display","none")}}if("label" in d&&d.label!==x.label){g.html(d.label);if(d.label&&!x.label){g.css("display","")}if(!d.label&&x.label){g.css("display","none")}}if("disabled" in d&&d.disabled!==x.disabled){if(d.disabled){j.addClass("xui-ui-itemdisabled")}else{j.removeClass("xui-ui-itemdisabled")}e.onMouseout(true,{$force:true})}if("image" in d&&d.image!==x.image){m.css("background-image",d.image)}if("imagePos" in d&&d.imagePos!==x.imagePos){m.css("background-position",d.imagePos)}if("imageClass" in d&&d.imageClass!==x.imageClass){if(x.imageClass){m.removeClass(x.imageClass)}if(d.imageClass){m.addClass(d.imageClass)}}if("hidden" in d){var A=!!d.hidden;if(A){if(x.hidden!==true){j.css("display","none")}}else{if(x.hidden===true){j.css("display","")}}}xui.merge(x,d,"all")}}return s}},showItem:function(b,a){return this.each(function(c){var d=c.getItemByItemId(b);if(d){d.hidden=a===false;c.getSubNodeByItemId("ITEM",b).css("display",a===false?"none":"")}})},showGroup:function(a,b){return this.each(function(c){xui.arr.each(c.properties.items,function(e){if(e.id==a){e.hidden=b===false;return false}});var d=c.getSubNodeByItemId("GROUP",a);d.css("display",b===false?"none":"");xui.resetRun(c.$xid+":showgrp",function(){if(c.renderId&&c.getRootNode().offsetWidth){xui.UI.$dock(c,true,true)}})})}},Static:{_focusNodeKey:"BTN",_ITEMKEY:"GROUP",Templates:{tagName:"div",className:"{_className}",style:"{_style}",ITEMS:{className:"xui-uibar xui-uiborder-outset xui-uiborder-radius",tagName:"div",style:"{mode}",text:"{items}"},$submap:{items:{GROUP:{className:"{groupClass}",style:"{grpDisplay} {_groupStyle}",HANDLER:{className:"xuifont",$fonticon:"xui-icon-placeholder",style:"{mode2}"},LIST:{$order:1,tagName:"text",text:"{sub}"}}},"items.sub":{ITEM:{style:"{_itemDisplay}",className:" {disabled}",IBWRAP:{tagName:"div",SPLIT:{style:"{splitDisplay}",className:"xui-uiborder-l xui-uiborder-r",text:"&nbsp;"},LABEL:{style:"{labelDisplay}",text:"{label}"},BTN:{tagName:"button",className:"xui-uiborder-hidden xui-uiborder-radius xui-showfocus {itemClass}{itemcls}",style:"{itemStyle} {_boxDisplay}{_itemColor}",tabindex:"{_tabindex}",BOXWRAP:{tagName:"div",RULER:{},ICON:{$order:1,className:"xuicon {imageClass} {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{_iconFontSize}{imageDisplay}{iconStyle}{_iconColor}",text:"{iconFontCode}"},CAPTION:{$order:1,text:"{caption}",style:"{_fontSize}{captionDisplay}{_fontColor}"},DROP:{$order:3,className:"xuifont",$fonticon:"xui-uicmd-arrowdrop",style:"{_dropDisplay}"}}}}}}}},Appearances:{KEY:{position:"absolute",overflow:"hidden",left:0,top:0},RULER:{padding:"0",margin:"0",width:"0"},ICON:{margin:0,"vertical-align":"middle"},ITEMS:{display:"block","padding-bottom":".125em"},HANDLER:{height:"100%",width:".75em",background:"url("+xui.ini.img_handler+") repeat-y left top",cursor:"move","vertical-align":"middle"},GROUP:{position:"static",padding:".125em .25em 0 .125em","vertical-align":"middle"},ITEM:{"vertical-align":"middle",padding:"0 .125em",margin:"0"},SPLIT:{$order:1,width:"0","vertical-align":"middle",margin:"0 .25em"},BTN:{padding:".25em",cursor:"pointer","*width":"auto","*overflow":"visible"},BOX:{height:"auto"},"LABEL, CAPTION":{"vertical-align":"middle","margin-left":".25em","margin-right":".25em","font-size":"1em"},LABEL:{cursor:"default",padding:".25em"},DROP:{"vertical-align":"middle"}},Behaviors:{NoTips:["GROUP","HANDLER"],HoverEffected:{BTN:["BTN"]},ClickEffected:{BTN:["BTN"]},DraggableKeys:["HANDLER"],DroppableKeys:["GROUP","ITEMS"],BTN:{onClick:function(c,f,g){if(c.properties.disabled){return false}var b=xui.use(g).parent(3).id(),a=c.getItemByDom(b);if(a.disabled){return false}var d=c.getItemByDom(g);if(d.disabled){return false}xui.use(g).focus(true);if(d.type=="statusButton"){xui.use(g).tagClass("-checked",d.value=!d.value)}c.boxing().onClick(c,d,a,f,g,d.id);return false}}},DataModel:{expression:{ini:"",action:function(){}},listKey:null,iconColors:null,itemColors:null,fontColors:null,autoFontColor:{ini:false,action:function(){this.boxing().refresh()}},autoIconColor:{ini:true,action:function(){this.boxing().refresh()}},autoItemColor:{ini:false,action:function(){this.boxing().refresh()}},height:{ini:"auto",readonly:true},iconFontSize:{ini:"",action:function(a){this.getSubNode("ICON",true).css("font-size",a)}},width:{$spaceunit:1,ini:"auto"},left:{$spaceunit:1,ini:0},top:{$spaceunit:1,ini:0},handler:{ini:true,action:function(a){this.getSubNode("HANDLER",true).css("display",a?"":"none")}},position:"absolute",hAlign:{ini:"left",listbox:["left","center","right"],action:function(a){this.getSubNode("ITEMS",true).css("textAlign",a)}},dock:{ini:"top",listbox:["top","bottom","left","right"]}},EventHandlers:{onClick:function(a,b,f,d,g,c){}},_adjustItems:function(c){if(!c){c=[xui.stamp()+""]}if(xui.isStr(c)){c=[c]}var d=xui.copy(c),b;xui.arr.each(d,function(e,a){if(xui.isArr(e)){e={id:xui.id(),sub:e}}if(xui.isHash(e)){d[a]=xui.copy(e);d[a].sub=[];if(e.sub){xui.arr.each(e.sub,function(f){d[a].sub.push(xui.isHash(f)?xui.copy(f):{id:f+""})})}}});return d},_onDrop:function(d,l,b,m,j,o){var g=d.getKey(xui.use(b).id()),c=j.profile,a=j.domId,f,n=xui.absObj.$specialChars;f=xui.clone(c.getItemByDom(a),function(q,e){return !n[(e+"").charAt(0)]});c.boxing().removeItems([f.id],"GROUP",true);if(g==d.keys.GROUP){d.boxing().insertItems([f],o.id,true)}else{d.boxing().insertItems([f])}j._new=f;return false},_prepareData:function(b){var e=arguments.callee.upper.call(this,b);var c=b.properties,a=this;e.mode=c.hAlign!="left"?("text-align:"+c.hAlign+";"):"";xui.arr.each(e.items,function(d){if(d.sub){xui.arr.each(d.sub,function(f){var g=f.index;if(!g){g=xui.arr.indexOf(d.sub,f)}a._autoColor(f,g,c)})}});return e},_initIconColors:function(d,f){var c=[],b=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],e=["#E6945C","#46C37B","#195ead","#9E8CE0","#1f8d9b","#87CEEB","#e04d7f"],a=["#F19B60","#49CD81","#0277bd","#A693EB","#42a3af","#B0E0E6","#F06292"];switch(d){case"icon":c=b;if(f.iconColors&&f.iconColors.length>0){c=f.iconColors}break;case"font":c=e;if(f.fontColors&&f.fontColors.length>0){c=f.fontColors}break;case"item":c=a;if(f.itemColors&&f.itemColors.length>0){c=f.itemColors}break}return c},_autoColor:function(d,c,f){c=c||0;if(f.autoFontColor||d.fontColor){var e=this._initIconColors("font",f);while(c&&c>(e.length-1)){c=c-e.length}if(!d.fontColor){d.fontColor=e[c]}d._fontColor=d.fontColor?";color:"+d.fontColor:""}if(f.autoIconColor||d.iconColor){var b=this._initIconColors("icon",f);while(c&&c>(b.length-1)){c=c-b.length}if(!d.iconColor){d.iconColor=b[c]}d._iconColor=d.iconColor?";color:"+d.iconColor:""}if(f.autoItemColor||d.itemColor){var a=this._initIconColors("item",f);while(c&&c>(a.length-1)){c=c-a.length}if(!d.itemColor){d.itemColor=a[c]}d._itemColor=d.itemColor?";background-color:"+d.itemColor:"";d._fontColor=";color:#ffffff";d._iconColor=";color:#ffffff"}},_prepareItem:function(d,e,w,n,o,q,f,j){var s=this,c=d.properties,l="display:none",g=d.properties.tabindex,r=function(A,a,H,D,E,F,B,C){var x=a[xui.UI.$tag_subId]=typeof C=="string"?C:("a_"+A.pickSubId("aitem")),G;if(typeof H=="string"){H={caption:H}}if(false!==B){A.ItemIdMapSubSerialId[H.id]=x;A.SubSerialIdMapItem[x]=H}if(H.object){a.object=s._prepareInlineObj(A,H,g)}else{xui.arr.each(xui.toArr("itemWidth,bgimg,position,itemHeight,imgWidth,imgHeight,itemPadding,itemMargin,iconFontSize,fontSize,autoItemSize,autoImgSize"),function(I){H[I]=xui.isSet(H[I])?H[I]:c[I]});if(H.statusButton){H.type="statusButton";delete H.statusButton}else{if(H.dropButton){H.type="dropButton";delete H.dropButton}else{if(H.split){H.type="split";delete H.split}}}if(H.type!=="split"&&!H.caption){H.caption=""}xui.UI.adjustData(A,H,a);if(H.type=="statusButton"&&!!H.value){a.itemcls=" xui-uiborder-hidden-checked "+A.getClass("BTN","-checked",!!H.value)}a._tabindex=g;a.splitDisplay=a.type=="split"?"":l;a.labelDisplay=a.label?"":l;a._iconFontSize=a.iconFontSize;a._fontSize=a.fontSize;a._boxStyle=a.boxStyle;a.captionDisplay=a.caption?"":l;a._dropDisplay=H.type=="dropButton"?"":l;a._boxDisplay=(a.type!=="split"&&(a.caption||a.image||a.imageClass))?"":l}a._itemDisplay=H.hidden?l:"";H._pid=D};if(e.sub){xui.arr.each(e.sub,function(a){var x=a.index;if(!x){x=xui.arr.indexOf(e.sub,a)}s._autoColor(a,x,c)})}if(n){r(d,e,w,n,o,q,f,j)}else{var m=[],b,u=w.sub||[];n=w.id;e.mode2=("handler" in w)?(w.handler?"":l):(d.properties.handler?"":l);e.grpDisplay=w.hidden?l:"";e._groupStyle=w.groupStyle?w.groupStyle:"";e.sub=m;xui.arr.each(u,function(a){b={id:a.id,groupStyle:e.groupStyle};r(d,b,a,n,o,q,f,j);m.push(b)})}}}});xui.Class("xui.UI.Layout",["xui.UI","xui.absList"],{Instance:{setChildren:function(c,b){var a=this;this.removeChildren(true,true,true);xui.addChild({children:c},a,a.getModule(),a.getModule())},getAllFormValues:function(b){var c=this.getChildren(),d=xui.absValue.pack(c),f={},e=this.get(0);xui.arr.each(e.children,function(j){var a=j[0].boxing(),g=a.getProperties().name||j[0].alias;if(a.Class["xui.UI.Tabs"]){f[g]=a.getAllFormValues(b)}else{if(a.Class["xui.UI.Block"]||a.Class["xui.UI.Panel"]||a.Class["xui.UI.Layout"]){xui.merge(f,a.getAllFormValues(b),"all")}else{if(a.getFormValues){xui.merge(f,a.getFormValues(),"all")}else{if(a.getUIValue){f[g]=a.getUIValue()}else{if(a.getValue){f[g]=a.getValue()}}}}}});return f},getPanel:function(a){return this.get(0).getSubNodeByItemId("PANEL",a)},append:function(d,a,c,b){var e=this.get(0);return arguments.callee.upper.call(this,d,a||"main",c,b)},insertItems:function(a,d,c,b){return this._insertItems(a,d,c,b)},_insertItems:function(g,c,q,s){var d,l,m,j,a,e,f,o="before",n=this._afterInsertItems;return this.each(function(u){f=u.box;m=u.properties.items;if(!s){j=xui.arr.subIndexOf(m,"id",c);if(j==-1){o=q?"before":"after"}else{if(m[j].id=="main"){o=q?"before":"after"}else{o=m[j].pos||"after"}}l=f._adjustItems2(g,o)}else{l=f._adjustItems(g)}if(j==-1){xui.arr.insertAny(m,l,q?0:-1)}else{xui.arr.insertAny(m,l,q?j:j+1)}if(u.renderId){e=f._prepareItems(u,l,c);a=u._buildItems("items",e);if(u.$attached){for(var r=0,b;b=u.$attached[r++];){if(b._render){b._render(true)}}delete u.$attached}u.getRoot().prepend(a);u.adjustSize();t=null}if(n){u.boxing()._afterInsertItems(u,e,c,q)}})},_afterRemoveItems:function(a){if(a.renderId){a.adjustSize()}},updateItem:function(g,f){var r=this,e=r.get(0),d=e.properties.type=="vertical",b=function(C,B){return e.getSubNodeByItemId(C,B)},l=e.box,s=e.properties.items,x=e.queryItems(s,function(B){return typeof B=="object"?B.id===g:B==g},true,true,true),m,A,u,w,j,q;if(typeof f!="object"){return}if(x.length){x=x[0];if(typeof x[0]!="object"){A=x[2][x[1]]={id:x[0]}}else{A=x[0]}if(xui.isSet(f.id)){f.id+=""}if(f.id&&g!==f.id){m=f.id;var a=e.ItemIdMapSubSerialId,n;if(!a[m]){if(n=a[g]){a[m]=n;delete a[g];e.SubSerialIdMapItem[n].id=m}else{A.id=m}}}delete f.id;if(xui.isEmpty(f)){return r}var o=false;w=b("ITEM",g);if(!w.isEmpty()){if(f.hasOwnProperty("size")){f.size=Math.round(parseFloat(""+f.size));if(f.size!=A._size){A._size=f.size;if(d){w.height(f.size)}else{w.width(f.size)}o=true}}if(f.hasOwnProperty("hidden")){f.hidden=!!f.hidden;if(f.hidden!==A.hidden){b("ITEM",g).css("display",f.hidden?"none":"");o=true}}if(f.hasOwnProperty("locked")){f.locked=!!f.locked;if(f.locked!==A.locked){b("MOVE",g).css({display:f.locked?"none":"",cursor:f.locked?"default":d?"n-resize":"w-resize"});b("CMD",g).css("display",(("cmd" in f)?f.cmd:A.cmd)&&!f.locked?"":"none");o=true}}if(f.hasOwnProperty("folded")){f.folded=!!f.folded;if(f.folded!==A.folded){e.boxing().fireCmdClickEvent(g)}}if(f.hasOwnProperty("cmd")){f.cmd=!!f.cmd;if(f.cmd!==A.cmd){b("CMD",g).css("display",f.cmd&&!(("locked" in f)?f.locked:A.locked)?"":"none")}}var c={};if(f.hasOwnProperty("panelBgClr")){c["background-color"]=f.panelBgClr}if(f.hasOwnProperty("panelBgImg")){c["background-image"]=f.panelBgImg?("url("+xui.adjustRes(f.panelBgImg)+")"):""}if(f.hasOwnProperty("panelBgImgPos")){c["position-color"]=f.panelBgImgPos}if(f.hasOwnProperty("panelBgImgRepeat")){c["background-repeat"]=f.panelBgImgRepeat}if(f.hasOwnProperty("panelBgImgAttachment")){c["background-attachment"]=f.panelBgImgAttachment}if(f.hasOwnProperty("overflow")){var n=f.overflow;if(n){if(n.indexOf(":")!=-1){xui.arr.each(n.split(/\s*;\s*/g),function(C){var B=C.split(/\s*:\s*/g);if(B.length>1){c[xui.str.trim(B[0])]=xui.str.trim(B[1]||"")}})}}c.overflow=n||""}if(!xui.isEmpty(c)){b("PANEL",g).css(c)}}xui.merge(A,f,"all");if(o){e.adjustSize()}}return r},fireCmdClickEvent:function(a){this.getSubNodeByItemId("CMD",a).onMousedown();return this}},Static:{Templates:{tagName:"div",style:"{_style}",className:"{_className} {_trans}",text:"{items}",$submap:{items:{ITEM:{tagName:"div",className:"{cls1} {itemClass}",style:"{itemStyle};{display}",MOVE:{$order:0,tagName:"div",className:"xui-ui-unselectable xui-uibar {clsmovebg} {cls2} ",style:"{moveDisplay};cursor:{_cursor}"},CMD:{$order:1,tagName:"span",style:"{cmdDisplay}",className:"xui-node xui-ui-unselectable xuifont {cls3}",$fonticon:"{_fi_cls3} "},PANEL:{tagName:"div",className:"xui-uibase xui-uicontainer",style:"position:absolute;{_bginfo};{_overflow};",text:xui.UI.$childTag}}}}},Appearances:{KEY:{position:"absolute",overflow:"hidden",left:0,top:0},"KEY-trans, KEY-trans > ITEM, KEY-trans > ITEM > PANEL, KEY-trans > ITEM > MOVE, KEY-trans > ITEM > CMD":{$order:100,"background-color":"transparent",border:"none"},MOVE:{$order:0,position:"absolute","z-index":"10"},CMD:{position:"absolute",cursor:"pointer","z-index":"20"},ITEM:{position:"absolute","z-index":1,overflow:"hidden","border-width":xui.browser.opr?"0":null},PANEL:{position:"absolute",overflow:"auto",left:0,top:0,"border-width":xui.browser.opr?"0":null},"ITEM-MAIN":{left:0,right:0,top:0,bottom:0},"ITEM-TOP, ITEM-BOTTOM":{left:0,right:0},"ITEM-LEFT, ITEM-RIGHT":{top:0,bottom:0},"MOVE-TOP, MOVE-BOTTOM":{width:"100%",height:xui.browser.contentBox?".45em":".53333em",cursor:"n-resize"},"MOVE-LEFT, MOVE-RIGHT":{height:"100%",width:xui.browser.contentBox?".45em":".53333em",cursor:"w-resize"},"MOVE-TOP":{bottom:0},"MOVE-BOTTOM":{top:0},"MOVE-LEFT":{right:"0"},"MOVE-RIGHT":{left:0},"CMD-TOP, CMD-BOTTOM, CMD-LEFT, CMD-RIGHT":{padding:0,"border-radius":"0","-moz-border-radius":"0","-webkit-border-radius":"0","-o-border-radius":"0","-ms-border-radius":"0","-khtml-border-radius":"0"},"CMD-TOP":{$order:1,left:"50%","margin-left":"-1em",bottom:0,width:"2em",height:xui.browser.contentBox?".36667em":".45em","text-align":"center"},"CMD-BOTTOM":{$order:1,left:"50%","margin-left":"-1em",top:0,width:"2em",height:xui.browser.contentBox?".46667em":".45em","text-align":"center"},"CMD-LEFT":{$order:1,top:"50%","margin-top":"-1em",right:0,height:"2em",width:xui.browser.contentBox?".36667em":".45em","line-height":"2em"},"CMD-RIGHT":{$order:1,top:"50%","margin-top":"-1em",left:0,height:"2em",width:xui.browser.contentBox?".36667em":".45em","line-height":"2em"},"MOVE-MAIN":{$order:5,display:"none"},"CMD-MAIN":{$order:5,display:"none"}},Behaviors:{DroppableKeys:["PANEL"],PanelKeys:["PANEL"],HoverEffected:{MOVE:"MOVE",CMD:["MOVE","CMD"]},ClickEffected:{CMD:"CMD"},MOVE:{beforeMousedown:function(f,q,a){if(xui.Event.getBtn(q)!="left"){return}var r=f.getSubId(a),B=f.getItemByDom(a);if(B.folded){return}if(B.locked){return}var j=f.getItemByItemId("main"),d=f.getSubNode("ITEM",r),g=f.getSubNodeByItemId("ITEM","main"),x=xui.use(a).css("cursor"),A=f.properties,l,s,n,u,c,b;f.pos=B.pos;if(A.type=="vertical"){l=f._cur=d.height();n=g.height();if(B.pos=="before"){c=l-B.min;b=Math.round(B.max?Math.min(parseFloat(B.max)-l,(n-j.min)):(n-j.min))}else{c=Math.round(B.max?Math.min(parseFloat(B.max)-l,(n-j.min)):(n-j.min));b=l-B.min}xui.use(a).startDrag(q,{dragType:"copy",targetReposition:false,verticalOnly:true,maxTopOffset:c,maxBottomOffset:b,dragCursor:x,targetWidth:xui.browser.ie?xui.use(a).offsetWidth():null,targetHeight:xui.browser.ie?xui.use(a).offsetHeight():null,targetCallback:xui.browser.ie?function(e){e.tagClass("-(top|bottom)",false)}:null})}else{s=f._cur=d.width();u=g.width();if(B.pos=="before"){c=s-B.min;b=Math.round(B.max?Math.min(parseFloat(B.max)-s,(u-j.min)):(u-j.min))}else{c=Math.round(B.max?Math.min(parseFloat(B.max)-s,(u-j.min)):(u-j.min));b=s-B.min}xui.use(a).startDrag(q,{dragType:"copy",targetReposition:false,horizontalOnly:true,maxLeftOffset:c,maxRightOffset:b,dragCursor:x,targetWidth:xui.browser.ie?xui.use(a).offsetWidth():null,targetHeight:xui.browser.ie?xui.use(a).offsetHeight():null,targetCallback:xui.browser.ie?function(e){e.tagClass("-(left|right)",false)}:null})}f._limited=0},onDrag:function(f,j,m){var c=f.properties,l=xui.DragDrop,g=xui.DragDrop._profile,a=0;if(c.type=="vertical"){if((g.y<=g.restrictedTop)||(g.y>=g.restrictedBottom)){a=true}}else{if(g.x<=g.restrictedLeft||g.x>=g.restrictedRight){a=true}}if(a){if(!f._limited){g.proxyNode.addClass("xui-alert");f._limited=true}}else{if(f._limited){g.proxyNode.removeClass("xui-alert");f._limited=0}}},onDragstop:function(g,s,a){var B=g.properties,x=B.height,d=B.width,f=xui.use(a).parent(),b=g.getRoot(),A=g.getItemByDom(a),q=0,w,n=null,c=null,u;for(var m=0,j=B.items.length;m<j;m++){if(!B.items[m].hidden){q+=B.items[m].size||80}if(B.items[m].id=="main"){u=B.items[m]}}if(B.type=="vertical"){c=b.height();A._size=g._cur+(g.pos=="before"?1:-1)*xui.DragDrop.getProfile().offset.y;f.height(g.$isEm(x)?g.$px2em(A._size,f)+"em":A._size);w=q*A._size/c}else{n=b.width();A._size=g._cur+(g.pos=="before"?1:-1)*xui.DragDrop.getProfile().offset.x;f.width(g.$isEm(d)?g.$px2em(A._size,f)+"em":A._size);w=q*A._size/n}u.size-=w-A.size;A.size=w;xui.UI.$tryResize(g,n,c,true);g._limited=0}},CMD:{onMousedown:function(j,q,b){if(xui.Event.getBtn(q)!="left"){return}var w=j.properties,s=j.getSubId(b),u=j.getItemByDom(b),c=j.getRoot(),l=j.getItemByItemId("main"),g=j.getSubNodeByItemId("ITEM","main"),d=j.getSubNode("ITEM",s),a=j.getSubNode("PANEL",s),f=j.getSubNode("MOVE",s),n=(u.locked?0:w.type=="vertical"?f.offsetHeight():f.offsetWidth());if(w.type=="vertical"){if(u.folded){d.height(u._size);a.show();u.folded=false;if(u.pos=="before"){xui.use(b).replaceClass(/bottom/g,"top")}else{xui.use(b).replaceClass(/top/g,"bottom")}if(!u.locked){f.css("cursor","n-resize")}j.getSubNode("MOVE").tagClass("-checked",false)}else{d.height(n);a.hide();u.folded=true;if(u.pos=="before"){xui.use(b).replaceClass(/top/g,"bottom")}else{xui.use(b).replaceClass(/bottom/g,"top")}if(!u.locked){f.css("cursor","default")}j.getSubNode("MOVE").tagClass("-checked")}xui.UI.$tryResize(j,null,c.height(),true)}else{if(u.folded){d.width(u._size);a.show();u.folded=false;if(u.pos=="before"){xui.use(b).replaceClass(/right/g,"left")}else{xui.use(b).replaceClass(/left/g,"right")}if(!u.locked){f.css("cursor","w-resize")}j.getSubNode("MOVE").tagClass("-checked",false)}else{d.width(n);a.hide();u.folded=true;if(u.pos=="before"){xui.use(b).replaceClass(/left/g,"right")}else{xui.use(b).replaceClass(/right/g,"left")}if(!u.locked){f.css("cursor","default")}j.getSubNode("MOVE").tagClass("-checked")}xui.UI.$tryResize(j,c.width(),null,true)}return false}},PANEL:{onClick:function(a,d,f){var c=a.properties,b=a.getItemByDom(f);if(c.disabled||b.disabled){return false}if(a.onClickPanel){return a.boxing().onClickPanel(a,b,d,f)}}}},DataModel:{rotate:null,selectable:true,disabled:null,position:"absolute",type:{listbox:["vertical","horizontal"],ini:"vertical",action:function(d,e){if(d!=e){var c=this,g="auto",a=c.getSubNode("ITEM",true),b=c.getSubNode("MOVE",true),f=c.getSubNode("CMD",true);b.merge(a).merge(f);if(d=="vertical"){b.replaceClass(/(-left)(\b)/ig,"-top$2");b.replaceClass(/(-right)(\b)/ig,"-bottom$2");a.each(function(j){xui(j).height(xui(j).width())}).css({left:0,top:g,right:g,bottom:g})}else{b.replaceClass(/(-top)(\b)/ig,"-left$2");b.replaceClass(/(-bottom)(\b)/ig,"-right$2");a.each(function(j){xui(j).width(xui(j).height())}).css({left:g,top:0,right:g,bottom:g})}c.adjustSize()}}},dock:"fill",listKey:null,width:{$spaceunit:1,ini:"18em"},height:{$spaceunit:1,ini:"18em"},dragSortable:null,flexSize:{ini:false,action:function(){this.adjustSize()}},transparent:{ini:false,action:function(a){this.getRoot().tagClass("-trans",!!a)}},items:{ini:[]}},EventHandlers:{onClickPanel:function(a,b,c,d){}},_adjustItems2:function(b,c){var a=[];xui.arr.each(b,function(d){if(d.id!="main"){a.push(d=xui.isHash(d)?d:{id:""+d});d.pos=c}});xui.arr.each(a,function(d){d.id=xui.isStr(d.id)?d.id:xui.id();d.min=d.min||10;d._size=d.size=Math.round(parseFloat(d.size))||80;d.locked=typeof d.locked=="boolean"?d.locked:false;d.folded=typeof d.folded=="boolean"?d.folded:false;d.hidden=typeof d.hidden=="boolean"?d.hidden:false;d.cmd=typeof d.cmd=="boolean"?d.cmd:true});return a},_adjustItems:function(c){var a,d=[],e=[],b=0;xui.arr.each(c,function(g,f){g=xui.copy(g);if(g.id=="main"){a=g;b=f}else{if(g.pos=="before"){d.push(g)}else{if(g.pos=="after"){e.push(g)}else{if(b){g.pos="after";e.push(g)}else{g.pos="after";d.push(g)}}}}});a=a||{};a.id="main";a.min=a.min||10;a.size=Math.round(parseFloat(a.size))||80;c.length=0;xui.arr.insertAny(c,this._adjustItems2(d,"before"));xui.arr.insertAny(c,a);xui.arr.insertAny(c,this._adjustItems2(e,"after"));return c},_prepareData:function(a){var c=a.properties;if(!c.items||!xui.isArr(c.items)){c.items=xui.clone([{id:"before",pos:"before",locked:false,size:60,min:50,max:200},{id:"after",pos:"after",locked:false,size:60,min:50,max:200}])}c.items=this._adjustItems(c.items);var b=arguments.callee.upper.call(this,a);b._trans=b.transparent?a.getClass("KEY","-trans"):"";return b},_prepareItems:function(b,a){var c=arguments.callee.upper.apply(this,arguments);xui.arr.each(a,function(d){delete d.caption});return c},_prepareItem:function(d,f,e){var g=d.properties,c=g.width,a=g.height,b;if(f.id=="main"){f.cls1=d.getClass("ITEM","-main");f.cls2=d.getClass("MOVE","-main");f.cls3=d.getClass("CMD","-main")}else{var j;if(g.type=="vertical"){f.clsmovebg="xui-uiborder-t xui-uiborder-b";if(f.pos=="before"){j="top"}else{j="bottom"}}else{f.clsmovebg="xui-uiborder-l xui-uiborder-r";if(f.pos=="before"){j="left"}else{j="right"}}f.cls1=d.getClass("ITEM","-"+j);f.cls2=d.getClass("MOVE","-"+j);f.cls3=d.getClass("CMD","-"+j);f._fi_cls3="xui-icon-arrow"+j;f.display=f.hidden?"display:none":"";f._cursor=f.locked?"default":(g.type=="vertical")?"n-resize":"w-resize";f.cmdDisplay=(f.cmd&&!f.locked)?"":"display:none";f.moveDisplay=!f.locked?"":"display:none"}f._bginfo="";if(b=f.panelBgClr||g.panelBgClr){f._bginfo+="background-color:"+b+";"}if(b=f.panelBgImg||g.panelBgImg){f._bginfo+="background-image:url("+xui.adjustRes(b)+");"}if(b=f.panelBgImgPos||g.panelBgImgPos){f._bginfo+="background-position:"+b+";"}if(b=f.panelBgImgRepeat||g.panelBgImgRepeat){f._bginfo+="background-repeat:"+b+";"}if(b=f.panelBgImgAttachment||g.panelBgImgAttachment){f._bginfo+="background-attachment:"+b+";"}if(xui.isStr(f.overflow)){f._overflow=f.overflow.indexOf(":")!=-1?(f.overflow):(f.overflow?("overflow:"+f.overflow):"")}else{if(xui.isStr(g.overflow)){f._overflow=g.overflow.indexOf(":")!=-1?(g.overflow):(g.overflow?("overflow:"+g.overflow):"")}}},RenderTrigger:function(){var a,b=this;xui.arr.each(b.properties.items,function(c){if(c.id!="main"){if(c.folded&&(a=b.getSubIdByItemId(c.id))){c.folded=false;b.getSubNode("CMD",a).onMousedown()}}})},_onresize:function(c,s,q){var o=c.properties,l,C=c.keys.ITEM,m=c.keys.PANEL,e=c.getItemByItemId("main"),b=e.min||10,d=o.flexSize,a=0,r,j,f=xui.$us(c),B=function(D,E){return c.$forceu(D,f>0?"em":"px",E)},u=c.getEmSize()/c.getRoot()._getEmSize();if(s){s=c.$px(s)}if(q){q=c.$px(q)}var n={},x={};xui.arr.each(o.items,function(D){l=c.getSubIdByItemId(D.id);n[l]={};x[l]={};if(d&&!D.hidden){a+=D.size||80}});var A=function(D,O,F,I,Q,K,N){var S,H,T,M,G=0,E=0,R=0,P=0,J=K;xui.arr.each(D.items,function(U){if(U.id=="main"){return}if(U.pos=="before"){M=c.getSubIdByItemId(U.id);r=c.getSubNode("MOVE",M),j=(U.locked?0:o.type=="vertical"?r.offsetHeight():r.offsetWidth());if(U.hidden){H=0;x[M][F]=Math.round(d?parseFloat(O*Math.min(1,(U.size/a))):U._size)}else{if(U.folded){H=x[M][F]=j}else{P++;H=T=Math.round(d?parseFloat(O*Math.min(1,(U.size/a))):U._size);if(H>K+U.min){H-=K}else{K=H-U.min;H=U.min}H-=N;H=Math.max(H,j)}}x[M][I]=G;G+=H;n[M][I]=0;n[M][F]=H-j;x[M][Q]=n[M][Q]="auto";x[M][F]=H;b+=j}});xui.arr.each(D.items,function(U){if(U.id=="main"){return}if(U.pos=="after"){M=c.getSubIdByItemId(U.id);r=c.getSubNode("MOVE",M),j=(U.locked?0:o.type=="vertical"?r.offsetHeight():r.offsetWidth());if(U.hidden){H=0;x[M][F]=Math.round(d?parseFloat(O*Math.min(1,(U.size/a))):U._size)}else{if(U.folded){H=x[M][F]=j}else{P++;H=T=Math.round(d?parseFloat(O*Math.min(1,(U.size/a))):U._size);if(H>K+U.min){H-=K}else{K=H-U.min;H=U.min}H-=N;H=Math.max(H,j)}}x[M][Q]=E;E+=H;n[M][Q]=0;n[M][F]=H-j;x[M][I]=n[M][I]="auto";x[M][F]=H;b+=j}},null,true);R=G+E;if(O-R>=b||N){S=c.getSubIdByItemId("main");x[S][F]=n[S][F]=O-R;x[S][I]=G}else{var L=xui.toArr(arguments);if(!J){L[L.length-2]=(b-(O-R))/P}else{L[L.length-2]=J;L[L.length-1]=(b-(O-R))/P}A.apply(null,L)}};if(o.type!="vertical"){if(!xui.isNull(s)){A(o,s,"width","left","right",0,0)}if(!xui.isNull(q)){xui.each(n,function(D,E){x[E].height=D.height=q})}}else{if(!xui.isNull(q)){A(o,q,"height","top","bottom",0,0)}if(!xui.isNull(s)){xui.each(n,function(D,E){x[E].width=D.width=s})}}var g=function(E,D){xui.arr.each("left,width,right".split(","),function(F){if(F in E){E[F]=c.$forceu(E[F],"em",D)}})},w=function(E,D){xui.arr.each("top,height,bottom".split(","),function(F){if(F in E){E[F]=c.$forceu(E[F],"em",D)}})};xui.each(x,function(H,I){var G=c.getSubNode("PANEL",I),E=c.getSubNode("ITEM",I);if(f>0){var F=f>0?G._getEmSize(u):null,D=f>0?E._getEmSize(u):null;g(n[I],D);g(x[I],D);w(n[I],F);w(x[I],F)}G.cssRegion(n[I],true);if(n[I].width){xui.UI._adjustConW(c,G,n[I].width)}E.cssRegion(x[I])})}}});xui.Class("xui.UI.TreeGrid",["xui.UI","xui.absValue"],{Instance:{activate:function(){var b=this.get(0),a;if(!b.renderId){return}b.getSubNode("ROWS22").nextFocus(true,true,true);return this},_setCtrlValue:function(a){return this.each(function(c){if(!c.renderId){return}if(c.properties.activeMode=="none"){return}var g=c.boxing(),m=g.getUIValue(),b=c.properties,f=c.rowMap,d=b.activeMode=="row"?["CELLS1","CELLS2","MARK"]:"CELL",e=function(n,o){return c.getSubNodes(n,o)},j=function(n){var q=c.rowMap2;if(b.activeMode=="row"){return q[n]}else{if(!n){return}var o=(""+n).split("|");return xui.get(c.rowMap,[q[o[0]],"_cells",o[1]])}};if(b.selMode=="single"){var l=j(m);if(m&&l){e(d,l).tagClass("-checked",false)}l=j(a);if(l){e(d,l).tagClass("-checked")}}else{if(b.selMode=="multi"||b.selMode=="multibycheckbox"){m=m?(""+m).split(b.valueSeparator):[];a=a?(""+a).split(b.valueSeparator):[];xui.arr.each(m,function(q,n){if(q=j(q)){if(n=f[q]){delete n._selected}e(d,q).tagClass("-checked",false)}});xui.arr.each(a,function(n){if(n=j(n)){if(i=f[n]){i._selected=1}e(d,n).tagClass("-checked")}});if(a.length===0){e("HFMARK").tagClass("-checked",false);delete c._$checkAll}}}})},calculateGridValue:function(){var e=this.get(0),b=e.properties,j=b.gridValueFormula,o=null,l,c,n,q,d=xui.ExcelFormula,m,g,a;if(e.beforeGridValueCalculated&&false!==(n=e.boxing().beforeGridValueCalculated(e))){o=n}else{if(j){g=b.header.length;a=b.rows.length;if(d.validate(j)){q={};if(l=d.getRefCells(j,g,a)){xui.each(l,function(f,r){c=d.toCoordinate(r);m=b.rows[c.row].cells[c.col];q[r]=m.value})}o=d.calculate(j,q,g,a)}}}if(e.afterGridValueCalculated){e.boxing().afterGridValueCalculated(e,o)}e._$gridvalue=o;if(b.excelCellId&&e._$oldgridvalue!==e._$gridvalue){e.boxing().notifyExcel(false)}return e._$oldgridvalue=o},notifyExcel:xui.UI.Input.prototype.notifyExcel,getExcelCellValue:function(){var e=this.get(0),b=e.properties,j,l,c,o,n,q,d=xui.ExcelFormula,m,g,a;if(b.excelCellId){o=("_$gridvalue" in e)?e._$gridvalue:this.caculateGridValue();if(xui.isSet(n=(e.onGetExcelCellValue&&e.boxing().onGetExcelCellValue(e,b.excelCellId,o)))){o=n}return o}return null},applyCellFormula:function(a,c,b){return this.each(function(m){var g=m.box,u,o,q,s,r,x={},f,e=m.properties,A=e.rows,n=xui.arr.indexOf(e.header,a._col),d=xui.arr.indexOf(A,a._row),l=xui.ExcelFormula;if(u=g._getCellFormula(m,a,l.toColumnChr(n+1),d+1)){var w=l.getRefCells(u,n,d);if(!w){return}xui.each(w,function(j,B){f=l.toCoordinate(B);tcell=A[f.row].cells[f.col];x[B]=tcell.value});r=l.calculate(u,x,n,d);if(r!==a.value){s=[a._serialId,r,a,u];if(m.beforeApplyFormula&&false===m.boxing().beforeApplyFormula(m,a,r,u)){}else{g._updCell(m,s[0],{value:s[1]},c,b,true)}if(m.afterApplyFormulas){m.boxing().afterApplyFormulas(m,[s])}}}})},triggerFormulas:function(a,c,b){return this.each(function(w){var n=w.box,I,f=w.properties,s=f.rows,j=s.length,E=f.header.length,H=xui.ExcelFormula,C={},d,B;xui.arr.each(f.rows,function(J,l){xui.arr.each(J.cells,function(L,K){if(L===a){I=H.toCellId(K,l)}if(d=n._getCellFormula(w,L,H.toColumnChr(K+1),l+1)){C[H.toCellId(K,l)]=[L,d]}})});if(I){delete C[I]}if(xui.isEmpty(C)){return}var e={};xui.each(C,function(l,J){if(l=H.getRefCells(l[1],E,j)){e[J]=l}});var o,u,A={},g,G=[],r,q,m={},x;if(I){m[I]=1}do{o=0;xui.filter(e,function(J,l){x=0;if(!I){x=1}else{for(var K in J){if(K in m){x=1;break}}}if(!x){return false}u=true;for(var K in J){if(!I&&(K in C)){u=false}else{if(!(K in A)){g=H.toCoordinate(K);B=s[g.row].cells[g.col];A[K]=B.value}}}if(u){r=C[l];q=H.calculate(r[1],A,E,j);if(q!==r[0].value){G.push([r[0],q,r[1],r[0]._serialId]);if(I){m[l]=1}}delete C[l];o++;return false}})}while(!xui.isEmpty(C)&&o>0);for(var F=0,D=G.length;F<D;F++){if(w.beforeApplyFormula&&false===w.boxing().beforeApplyFormula(w,G[F][0],G[F][1],G[F][2])){}else{n._updCell(w,G[F][3],{value:G[F][1]},c,b,false)}}if(w.afterApplyFormulas){w.boxing().afterApplyFormulas(w,G)}if(f.gridValueFormula){w.boxing().calculateGridValue(false)}})},_insertRowsToDom:function(c,a,q,d,o,A){if(q){var g=c.rowMap[q];if(g&&!g._inited){return}}if(!a){a=[]}var u,r,B,j=c.box,b=c.properties,B=c.getSubNode("FHCELL").width();if(B){B=c.$forceu(B)}xui.arr.each(a,function(l){l._row0DfW=B?("width:"+B):"";xui.arr.each(l.cells,function(D,E){D.width=D._col._colWidth})});if(c.properties.freezedRow){var n=c.getSubNode("ROWS12");if(!n.isEmpty()&&n.query("div","id",/-ROWS12\:/).isEmpty()){delete c._passFreezedRow}}var f=c._buildItems("rows21",a),e=c._buildItems("rows22",a);if(!d){if(q){u=c.getSubNode("SUB1",q);r=c.getSubNode("SUB2",q)}else{u=c.getSubNode("ROWS21");r=c.getSubNode("ROWS22")}if(o){u.prepend(f);r.prepend(e)}else{u.append(f);r.append(e)}}else{u=c.getSubNode("ROW1",d);r=c.getSubNode("ROW2",d);if(o){u.addPrev(f);r.addPrev(e)}else{u.addNext(f);r.addNext(e)}}xui.arr.each(a,function(l){if(l.sub){l.open=false;if(false===j.getCellOption(c,l,"iniFold")){c.boxing()._toggleRows([l],true,false,true)}}});if(A&&A.length){var m=[],x=[];xui.arr.each(A,function(l){if(j.getCellOption(c,l,"editable")&&(j.getCellOption(c,l,"editMode")=="inline"||j.getCellOption(c,l,"type")=="dropbutton")){m.push(l)}});A.length=0;if(m.length){for(var w=0,s=m.length,n;w<s;w++){n=parseInt(w/25,10);if(!x[n]){x[n]=[]}x[n].push(m[w])}m.length=0;var C=function(){if(x.length){var E=x.shift();if(E&&E.length){for(var F=0,D=E.length;F<D;F++){if(c&&c.box&&!c.destroyed&&E[F]&&E[F]._row){c.box._editCell(c,E[F],null,true)}}xui.asyRun(C)}}else{x=null}};xui.asyRun(C)}}delete c.$allrowscache1;delete c.$allrowscache2;c.box._adjustBody(c,"addrow")},_refreshHeader:function(c){var b=this.get(0),a=b.properties,d=b.box,m=xui.clone(a.grpCols,false,2),e,f,n=this.getRows("data");xui.breakO(b.colMap,2);c=d._adjustHeader(c||[]);e=d._prepareHeader(b,c);a.header=c;this.removeAllRows();b.getSubNodes(["HCELL","HSCELL"],true).remove();var l,j;if(e.length){l=b._buildItems("header1",e);b.getSubNode("HCELLS1").append(l);j=b._buildItems("header2",e);b.getSubNode("LHCELL").addPrev(j)}if(m&&xui.isArr(m)&&m.length>0){m=d._adjustGrpColsData(b,m);a.grpCols=m;f=d._prepareGrpCols(b,m,e);if(f&&f.length){l=b._buildItems("grpCols1",f);b.getSubNode("GRPCELLBOX1").append(l);j=b._buildItems("grpCols2",f);b.getSubNode("GRPCELLBOX2").append(j)}d._adjustColsWidth(b);d._adjustColsHeight(b);b.adjustSize()}if(n&&n.length){this.setRows(n)}d._adjustBody(b,"refreshheader");var g=b.properties.colOptions;xui.arr.each(e,function(q){if(xui.isFun(q.colRenderer||g.colRenderer)){(q.colRenderer||g.colRenderer).call(null,b,q)}});if(a.treeMode=="infirstcell"){b.getSubNode("HCELLA",e[0]._serialId).prepend(b.getSubNode("LTAGCMDS")).prepend(b.getSubNode("HFMARK"))}if(b.$col_pop){b.$col_pop.destroy(true);delete b.$col_pop}xui.each(b.$cache_editor,function(q){if(!q.destroyed){q.destroy(true)}});b.$cache_editor={}},_toggleRows:function(c,b){var a=this;if(c&&c.length){xui.arr.each(c,function(d){if(d.id){a.toggleRow(d.id,b)}})}},autoRowHeight:function(a){return this.each(function(c){if(c.renderId){var b=xui.Event;if(b.__realtouch){b.__simulatedMousedown=1}if(a&&c.rowMap2[a]){c.getSubNode("FHANDLER",c.rowMap2[a]).onDblclick(true)}else{xui.each(c.rowMap,function(e,d){c.getSubNode("FHANDLER",d).onDblclick(true)})}if(b.__realtouch){b.__simulatedMousedown=0}}})},autoColWidth:function(a){return this.each(function(c){if(c.renderId){var b=xui.Event;if(b.__realtouch){b.__simulatedMousedown=1}if(a&&c.colMap2[a]){c.getSubNode("HHANDLER",c.colMap2[a]).onDblclick(true)}else{xui.each(c.colMap,function(e,d){c.getSubNode("HHANDLER",d).onDblclick(true)})}if(b.__realtouch){b.__simulatedMousedown=0}}})},autoColHeight:function(){return this.each(function(b){if(b.renderId){var a=xui.Event;if(a.__realtouch){a.__simulatedMousedown=1}b.getSubNode("FHANDLER").onDblclick(true);if(a.__realtouch){a.__simulatedMousedown=0}}})},addHotRow:function(a){var b=this.get(0);if(b.renderId){b.box._addTempRow(b,a||null)}return this},getHotRow:function(a){return this.getRowbyRowId(this.Class._temprowid,a)},updateHotRow:function(a,c,b){return this.updateRow(this.Class._temprowid,{cells:a},c,b)},removeHotRow:function(){var a=this.get(0);a.box._sethotrowoutterblur(a,true);delete a.__hastmpRow;this.removeRows([a.box._temprowid],false);return this},isDirtied:function(){var a=false,b=this.get(0);if(b._dirty){return true}xui.each(b.rowMap,function(c){if(c._dirty||c._oValue!==c.value||(("unit" in c)&&c._oUnit!==c.unit)){a=true;return false}});xui.each(b.cellMap,function(c){if(c._dirty||c._oValue!==c.value||(("unit" in c)&&c._oUnit!==c.unit)){a=true;return false}});return a},isCellDirtied:function(a){return a._dirty||a._oValue!==a.value||(("unit" in a)&&a._oUnit!==a.unit)},isRowDirtied:function(e){var d=this,c=e._dirty||e._oValue!==e.value;if(prf._dirty){return true}for(var b=0,a=e.cells.length;b<a;b++){if(d.isCellDirtied(cell)){return true}}return false},_getObjByDom:function(d,b){var c=this.get(0),a=c.getSubId(typeof d=="string"?d.charAt(0)=="!"?((d=xui.use(d).get(0))&&d.id):d:d.id);return c[b=="row"?"rowMap":b=="col"?"colMap":"cellMap"][a]},getRowByDom:function(c,b,a){return this.get(0).box._getRow(this.get(0),this._getObjByDom(c,"row"),b,a)},getHeaderByDom:function(a){return this._getObjByDom(a,"col")},getCellByDom:function(a){return this._getObjByDom(a,"cell")},getRows:function(j,e){var f=this.get(0).properties.rows,d,c,g=this.get(0);if(!xui.isArr(f)){return[]}if(j=="data"||j=="min"||j=="map"||j=="value"){d=xui.clone(f,true);if(d&&d.length&&d[d.length-1]&&d[d.length-1].id==this.constructor._temprowid){d.pop()}if(j=="value"){var l=[];xui.arr.each(f,function(m,a){var b=g.box._getRow(g,m,j,e);l.push(b)});d=l}if(j=="min"){xui.arr.each(d,function(b,a){if(d[a].cells){xui.each(c=d[a]=d[a].cells,function(m,n){c[n]=m.value})}})}else{if(j=="map"){d=this.getRawData(null,e)}}return d}else{return f}},getRowbyRowId:function(g,e,a){var d=this.get(0),b=d.rowMap2,f=d.properties.rows,c;if(xui.isNumb(g)){g=xui.get(f,[g==-1?(f.length-1):g,"id"])}if(b&&b[g]){return d.box._getRow(d,d.rowMap[b[g]],e,a)}if((b=d.queryItems(f,function(l,j){return l.id==g},1,1))&&b.length){return d.box._getRow(d,b[0],e,a)}},getRowbyCell:function(a,c,b){return this.constructor._getRow(this.get(0),a._row,c,b)},toggleRow:function(a,e,c,g,j){var d=this,b=this.get(0),l=arguments.callee,f=b.rowMap2,n=b.properties.rows;if(xui.isNumb(a)){a=xui.get(n,[a==-1?(n.length-1):a,"id"])}if(f&&f[a]){var m=b.rowMap[f[a]];if(m&&m.sub&&(!xui.isSet(e)||!!e!==!!m._checked)){b.box._setSub(b,m,xui.isSet(e)?!!e:!m._checked,c,g||c,j)}}else{xui.arr.each(n,function(o){if(o.sub){l.call(d,o.id,e,c,true,j)}})}return this},showRows:function(f,b){var e=this,d=e.get(0),a=xui(),c=xui(),g=d.properties;f=xui.isHash(f)?f.id:xui.isArr(f)?f:f===0?[0]:f?(f+"").split(g.valueSeparator):null;if(!f){f=xui.get(e.getActiveRow(),"id")||((g.$UIvalue||g.value)+"");f=f.split(g.valueSeparator)}if(f&&f.length){xui.arr.each(f,function(j,l){if(l=e.getRowbyRowId(j)){if(b===false){if(!l.hidden){c.merge(e.getSubNodes(["ROW1","ROW2"],l._serialId))}}else{if(l.hidden){a.merge(e.getSubNodes(["ROW1","ROW2"],l._serialId))}}l.hidden=b===false}})}if(!a.isEmpty()){a.css("display","")}if(!c.isEmpty()){c.css("display","none")}return this},updateRow:function(r,n,o,j){var K=this,m=K.get(0),s=m.box,l=m.properties,B;if(!r&&r!==0){r=xui.get(K.getActiveRow(),"id")||((l.$UIvalue||l.value)+"").split(l.valueSeparator)[0]}orow=K.getRowbyRowId(r);if(!orow){return K}var F=l.dirtyMark,c=F&&l.showDirtyMark,H=orow.id==s._temprowid,f=xui.absObj.$specialChars,q;if(!xui.isHash(n)){if(xui.isArr(n)){n={cells:n}}else{n={value:n}}}n=xui.filter(n,function(M,b,L){L=!f[b.charAt(0)];if(!L){q=q||{};q[b]=M}return L});if(j){if(m.beforeRowUpdated&&false===m.boxing().beforeRowUpdated(m,orow,n,H,q)){return}}if(!xui.isEmpty(n)){if(orow){var E=orow._serialId,x,a,u;if(xui.isSet(n.id)){n.id+=""}if(n.id&&n.id!==r){u=n.id;var e=m.rowMap2,w;if(!e[u]){if(w=e[r]){e[u]=w;delete e[r];m.rowMap[w].id=u;xui.each(m.colMap,function(b){if(b=b._cells){b[u]=b[r];delete b[r]}})}}}else{n.id=r}if(xui.isEmpty(n)){return K}if(("group" in n&&n.group!=orow.group)||"cells" in n||("sub" in n&&!((n.sub===true&&!orow.sub)||(!n.sub&&orow.sub===true)))){var C="__special",A=orow._pid?m.rowMap[orow._pid].id:null;orow.id=C;m.rowMap2[C]=m.rowMap2[u||r];delete m.rowMap2[u||r];xui.each(m.colMap,function(b){if(b=b._cells){delete b[u||r]}});orow=xui.clone(orow,true);xui.merge(orow,n,"all");if("sub" in n&&!n.sub){delete orow.sub}K.insertRows([orow],A,C,true);K.removeRows([C]);if(m.properties.activeMode=="row"){var J=m.properties.$UIvalue||"",d=(""+J).split(m.properties.valueSeparator);if(d.length&&xui.arr.indexOf(d,r)!=-1){if(u){xui.arr.removeValue(d,r)}K.setUIValue(d.join(m.properties.valueSeparator),true,null,"sub")}}}else{if("sub" in n){x=s._getToggleNode(m,E);if(n.sub){x.addClass("xui-uicmd-toggle");if(orow._layer){x.removeClass("xui-uicmd-empty")}}else{x.removeClass("xui-uicmd-toggle");if(orow._layer){x.addClass("xui-uicmd-empty")}}}a=K.getSubNodes(["CELLS1","CELLS2"],E);if(x=m.$px(n.height)){m.box._adjusteditorH(m,a.height(orow._rowHeight=m.$forceu(x)),x)}if(x=n.rowStyle){a.attr("style",a.attr("style")+";"+x)}if(x=n.rowClass){a.addClass(x)}if(n.hasOwnProperty("disabled")){var g="xui-uicell-disabled";if(n.disabled){a.addClass(g)}else{a.removeClass(g)}}if(n.hasOwnProperty("readonly")){var g="xui-ui-readonly";if(n.readonly){a.addClass(g)}else{a.removeClass(g)}}if(x=n.firstCellStyle){(a=K.getSubNode("FCELL",E)).first().attr("style",a.attr("style")+";"+x)}if(x=n.firstCellClass){K.getSubNode("FCELL",E).first().addClass(x)}if(n.hasOwnProperty("value")&&!xui.isSet(n.caption)){n.caption=n.value+""}if(n.hasOwnProperty("caption")){K.getSubNode("FCELLCAPTION",E).get(0).innerHTML=n.caption||""}if(n.hasOwnProperty("rowResizer")){x=!!n.rowResizer;K.getSubNode("FHANDLER",E).css("display",(n.rowResizer=x)?"block":"none")}if(n.hasOwnProperty("hidden")){var I=!!n.hidden;if(I){if(orow.hidden!==true){K.getSubNodes(["ROW1","ROW2"],E).css("display","none")}}else{if(orow.hidden===true){K.getSubNodes(["ROW1","ROW2"],E).css("display","")}}}xui.merge(orow,n,"all");if(n.hasOwnProperty("value")){var D=m.getSubNode("CELLA",E);if(!F||o===false){orow._oValue=orow.value}else{if(orow.value===orow._oValue){if(c){D.removeClass("xui-ui-dirty")}}else{if(c){D.addClass("xui-ui-dirty")}}}if(orow._editor){orow._editor.setValue(n.value,true,"editorini")}}}}else{var G=K.get(0).queryItems(K.getRows(),function(b){return typeof b=="object"?b.id===r:b==r},true,true,true);if(G.length){xui.merge(orow=G[0][0],n,"all")}}orow._dirty=true}if(j){if(m.afterRowUpdated){m.boxing().afterRowUpdated(m,orow,n,H,q)}}return K},insertRows:function(a,r,f,q,l){var C=arguments[4],D=this,A=D.constructor,e=D.get(0);if(xui.isHash(a)){a=[a]}if(a&&xui.isArr(a)&&a.length>0){var d=e.properties,u=e.rowMap2,n=d.rowOptions,B=e.rowMap,x,w,o,s;if(r===true){v=d.$UIvalue||d.value;if(v){v=(v+"").split(d.valueSeparator)}r=v[0]}r=u&&u[r];if(f===true){v=d.$UIvalue||d.value;if(v){v=(v+"").split(d.valueSeparator)}f=v[0]}f=u&&u[f];if(f){o=e.rowMap[f];if(o){r=o._pid}}a=A._adjustRows(e,a,l);if(!r){w=xui.isArr(d.rows)?d.rows:(d.rows=[])}else{s=B&&B[r];w=xui.isArr(s.sub)?s.sub:(s.sub=[])}var m;if(e.renderId){if(!r||s._inited){x=[];m=A._prepareItems(e,a,r,x);D._insertRowsToDom(e,m,r,f,q,x);xui.arr.each(a,function(b){if(xui.isFun(b.rowRenderer||n.rowRenderer)){(b.rowRenderer||n.rowRenderer).call(null,e,b)}})}else{if(r&&!s.inited){e.box._getToggleNode(e,r).removeClass("xui-icon-placeholder xui-uicmd-none").addClass("xui-uicmd-toggle")}}}if(!f){xui.arr.insertAny(w,a,q?0:-1)}else{var g=xui.arr.subIndexOf(w,"_serialId",f);xui.arr.insertAny(w,a,q?g:(g+1))}if(e.renderId){e.box._asy(e)}if(m&&m.length){xui.breakO(m,2);m.length=0}}if(C!==false&&e.renderId&&e.__hastmpRow){e.box.__ensurehotrow(e,null)}if(e.$itemFilter){var j=[];xui.arr.each(a,function(F){if(F.sub&&!F.hidden){if(true!==e.$itemFilter(F,"checkSub",e)){var c;for(var E=0,b=F.sub.length;E<b;E++){if(!F.sub[E].hidden){c=1;break}}if(!c){j.push(F.id)}}else{j.push(F.id)}}});if(j.length){D.showRows(j,false)}}return D},doFilter:xui.absList.prototype.doFilter,removeRows:function(a){var d=arguments[1],l=this,e=l.get(0);if(!e.rowMap2){return}var c=e.properties,j=e.cellMap,b=[],g,f=0;a=xui.isHash(a)?[a.id]:xui.isArr(a)?a:a===0?[0]:a?(a+"").split(c.valueSeparator):null;if(!a){a=xui.get(l.getActiveRow(),"id")||((c.$UIvalue||c.value)+"");a=a.split(c.valueSeparator)}if(!a||!a.length){return l}xui.arr.each(a,function(n,m){if(xui.isNumb(n)){n=c.rows[n]&&c.rows[n].id}a[m]=""+n});xui.arr.each(a,function(u){if(u=e.rowMap2[u]){f++;var s;if(s=e.rowMap[u]){var o=s._cells,q=s.id,n;if(s.sub&&xui.isArr(s.sub)){var m=[];xui.arr.each(s.sub,function(w){m.push(w.id)});l.removeRows(m)}xui.each(o,function(x,w){delete j[x]._col._cells[q];xui.breakO(j[x]);delete j[x];e.reclaimSubId(x.slice(3),"cell")});if(n=s._pid?(n=e.rowMap[s._pid])?n.sub:null:e.properties.rows){if(xui.isArr(n)){xui.filter(n,function(w){return w._serialId!=u})}}delete e.rowMap2[q];xui.breakO(e.rowMap[u]);delete e.rowMap[u];b.push(e.getSubNode("ROW1",u).get(0));b.push(e.getSubNode("ROW2",u).get(0))}e.reclaimSubId(u.slice(3),"row")}else{var r=function(x){var w=xui.arr.subIndexOf(x,"id",u);if(w!==-1){f++;xui.arr.removeFrom(x,w)}xui.arr.each(x,function(A){if(A.sub){r(A.sub)}})};r(c.rows)}});if(f>0){if(g=c.$UIvalue){if((g=(""+g).split(c.valueSeparator)).length>1){xui.filter(g,function(m){return xui.arr.indexOf(a,m)==-1});c.$UIvalue=g.join(c.valueSeparator)}else{if(xui.arr.indexOf(a,c.$UIvalue)!=-1){c.$UIvalue=null}}}xui(b).remove();if(e.$activeCell&&!xui.Dom.byId(e.$activeCell)){delete e.$activeCell}if(e.$activeRow&&!xui.Dom.byId(e.$activeRow)){delete e.$activeRow}delete e.$allrowscache1;delete e.$allrowscache2;e.box._asy(e);e.box._adjustBody(e,"delrow")}if(d!==false&&e.renderId&&e.__hastmpRow){e.box.__ensurehotrow(e,null)}e._dirty=1;return l},insertCol:function(g,f,n){var e=this.get(0),d=e.properties,u=e.box,s=d.rows,b,l,C,B;n=xui.isNumb(n)?n:-1;if(n===-1||d.header.length<n){n=d.header.length}if(n<0){n=0}if(d.treeMode=="infirstcell"&&n===0){return false}var q=n<=d.freezedColumn-1;var a=d.grpCols;if(a&&xui.isArr(a)&&a.length){for(var A=0,w=a.length,r;A<w;A++){r=a[A];if(r.from>n){r.from++;r.to++}else{if(n>=r.from&&n<=r.to){r.to++}}}}if(e.renderId){C=u._parepareCol(e,g,d.header);g=C[0];xui.arr.insertAny(d.header,g,n);l=e.getSubNode(q?"HCELLS1":"HCELLS2").children().get(n-1);if(l){xui(l).addNext(e._buildItems(q?"header1":"header2",[C[1]]))}var o=e.properties.colOptions;if(xui.isFun(g.colRenderer||o.colRenderer)){(g.colRenderer||o.colRenderer).call(null,e,g)}d.grpCols=u._adjustGrpColsData(e,a);u._adjustColsWidth(e);u._adjustColsHeight(e);u._adjustBody(e,"addcol")}else{xui.arr.insertAny(d.header,g,n)}f=xui.isArr(f)?f:[];var x=0,c=function(m){var j=[];xui.arr.each(m,function(E,D){if(E.group){c(E.sub)}else{b=f[x];l=e.getSubNode(q?"CELLS1":"CELLS2",E._serialId).children().get(n-1);if(l){B=u._prepareCell(e,b,E,g,j);xui.arr.insertAny(E.cells,B[0],n);xui(l).addNext(e._buildItems(q?"rows1.cells":"rows2.cells",[B[1]]))}else{xui.arr.insertAny(E.cells,b||{},n)}}x++});if(j.length){xui.arr.each(j,function(D){if(u.getCellOption(e,D,"editable")&&(u.getCellOption(e,D,"editMode")=="inline"||u.getCellOption(e,D,"type")=="dropbutton")){u._editCell(e,D)}});j.length=0}};if(s&&xui.isArr(s)){c(s)}e._dirty=1},removeCols:function(a){var d=arguments[1],n=this,f=n.get(0),j=f.box,c=f.properties,m=f.cellMap,e=xui.UI.$tag_subId,b=[],l=0;a=xui.isArr(a)?a:(a+"").split(c.valueSeparator);xui.arr.each(a,function(r,q){a[q]=""+r});if(a&&a.length>1){a.sort(function(o,s){var q=xui.arr.indexOf(c.header,o);if(q==-1){q=xui.arr.subIndexOf(c.header,"id",o)}var r=xui.arr.indexOf(c.header,s);if(r==-1){r=xui.arr.subIndexOf(c.header,"id",s)}return q>r?1:q===r?0:-1})}var g=c.grpCols;if(g&&xui.isArr(g)&&g.length){xui.arr.each(a,function(u){var s=xui.arr.indexOf(c.header,u);if(s==-1){s=xui.arr.subIndexOf(c.header,"id",u)}if(s==-1){return}for(var r=0,q=g.length,o;r<q;r++){o=g[r];if(o.from>s){o.from--;o.to--}else{if(s>=o.from&&s<=o.to){o.to--}}}},null,true);xui.filter(g,function(s){var q=s.to>=s.from;if(!q&&f.renderId){f.getSubNode(["HCELL","HSCELL"],s[e]).remove();delete f.colMap[s[e]];delete f.colMap2[s.id]}return q})}xui.arr.each(a,function(x){var q=xui.arr.indexOf(c.header,x);if(q==-1){q=xui.arr.subIndexOf(c.header,"id",x)}if(q==-1){return}if(f.colMap2&&(x=f.colMap2[x])){l++;var o;if(o=f.colMap[x]){var w=o._cells,s=o.id;xui.each(w,function(B,A){b.push(f.getSubNode("CELL",B).get(0));delete m[B]._row._cells[s];xui.breakO(m[B]);delete m[B];f.reclaimSubId(B.slice(3),"cell")});delete f.colMap2[s];xui.breakO(f.colMap[x]);delete f.colMap[x];var r;r=f.getSubNode("HCELL",x).get(0);if(r){b.push(r)}r=f.getSubNode("HSCELL",x).get(0);if(r){b.push(r)}}f.reclaimSubId(x.slice(3),"header")}var u=function(A){xui.arr.each(A,function(B){if(B.cells){xui.arr.removeFrom(B.cells,q)}if(B.sub){u(B.sub)}})};u(c.rows);xui.arr.removeFrom(c.header,q)},null,true);if(l>0){xui(b).remove();if(f.$activeCell&&!xui.Dom.byId(f.$activeCell)){delete f.$activeCell}c.grpCols=j._adjustGrpColsData(f,g);j._adjustColsWidth(f);j._adjustColsHeight(f);j._adjustBody(f,"delcol")}f._dirty=1;return n},removeAllRows:function(){var c=arguments[0],b=this.get(0),d=b.box,e=b.properties;if(!e.rows||e.rows.length<0){return this}for(var a in b.cellMap){b.reclaimSubId(a.slice(3),"cell")}for(var a in b.rowMap){b.reclaimSubId(a.slice(3),"row")}xui.each(b.colMap,function(f){f._cells={}});xui.breakO([b.rowMap,b.cellMap],3);b.rowMap={};b.cellMap={};b.rowMap2={};delete b.$activeCell;delete b.$activeRow;b.properties.rows.length=0;if(b.renderId){if(b.$sl!=0){b.getSubNode("HEADER2").get(0).scrollLeft=b.$sl=0}b.getSubNodes(["SCROLL21","SCROLL22"]).scrollTop(0).scrollLeft(0);b.getSubNodes(["ROWS21","ROWS22"]).empty()}delete b.$allrowscache1;delete b.$allrowscache2;b.properties.$UIvalue=null;if(c!==false&&b.renderId&&b.__hastmpRow){d.__ensurehotrow(b,null)}d._adjustBody(b,"delrow");return this},updateGridValue:function(){return this.each(function(a){var b=a.properties;delete a._dirty;xui.each(a.rowMap,function(c){c._oValue=c.value;if("unit" in c){c._oUnit=c.unit}delete c._dirty});xui.each(a.cellMap,function(c){c._oValue=c.value;if("unit" in c){c._oUnit=c.unit}delete c._dirty});if(b.dirtyMark&&b.showDirtyMark){a.getSubNode("CELLA",true).removeClass("xui-ui-dirty")}})},updateRowValue:function(c){var b=this.get(0),d=this.getRowbyRowId(c),a=[],e=b.properties;xui.arr.each(d.cells,function(f){if(f._oValue!==f.value||(("unit" in f)&&f._oUnit!==f.unit)){f._oValue=f.value;if("unit" in f){f._oUnit=f.unit}delete f._dirty;if(e.dirtyMark){a.push(b.getSubNode("CELLA",f._serialId).get(0))}}});d._oValue=d.value;delete d._dirty;if(e.dirtyMark){a.push(b.getSubNode("CELLA",d._serialId).get(0))}if(e.dirtyMark&&e.showDirtyMark){xui(a).removeClass("xui-ui-dirty")}},updateColValue:function(d){var c=this.get(0),b=this.getHeaderByColId(d),a=[],e=c.properties;xui.arr.each(b.cells,function(f){if(f._oValue!==f.value||(("unit" in f)&&f._oUnit!==f.unit)){f._oValue=f.value;if("unit" in f){f._oUnit=f.unit}delete f._dirty;if(e.dirtyMark){a.push(c.getSubNode("CELLA",f._serialId).get(0))}}});if(e.dirtyMark&&e.showDirtyMark){xui(a).removeClass("xui-ui-dirty")}},updateCellValue:function(a){var c=this,b=c.get(0),d=b.properties;if(typeof a=="string"){a=c.getCell(a)}if(a._oValue!==a.value||(("unit" in a)&&a._oUnit!==a.unit)){a._oValue=a.value;if("unit" in a){a._oUnit=a.unit}delete a._dirty;if(d.dirtyMark){b.getSubNode("CELLA",a._serialId).removeClass("xui-ui-dirty")}}return c},resetCellValue:function(a){var c=this,b=c.get(0),d=b.properties;if(typeof a=="string"){a=c.getCell(a)}if(a._oValue!==a.value||(("unit" in a)&&a._oUnit!==a.unit)){a.value=a._oValue;if("unit" in a){a.unit=a._oUnit}delete a._dirty;b.box._renderCell(b,a,{},b.getSubNode("CELLA",a._serialId))}return c},getActiveRow:function(d,a){var b,c=this.get(0);if(c.properties.activeMode!="row"){return}if(!(b=c.$activeRow)){return}b=c.rowMap[c.getSubId(b)];return c.box._getRow(c,b,d,a)},setActiveRow:function(d,b){var c,e,a=this.get(0);if(a.properties.activeMode!="row"){return}a.box._activeRow(a,false);if(!(e=this.getRowbyRowId(d))){return}if(!(c=a.getSubNodes(["CELLS1","CELLS2"],e._serialId)).isEmpty()){a.box._activeRow(a,c.get(0).id);if(!b){c.scrollIntoView()}}return this},getRowMap:function(f){var c=this.get(0),a=c.boxing(),e=c.properties,b,d;if(xui.isHash(f)){f=f.id}if(!xui.isSet(f)&&c.renderId&&!c.destroyed){if(e.activeMode="row"){if(b=a.getActiveRow()){f=b.id}}else{if(e.activeMode="cell"){if(b=a.getActiveCell()){f=b._row.id}}}}return a.getRowbyRowId(f,"map")},setRowMap:function(d,c,b,a){if(xui.isHash(d)){d=d.id}return this.each(function(l){var f=l.boxing(),m=l.properties,g;if(!d&&l.renderId&&!l.destroyed){if(m.activeMode="row"){if(g=f.getActiveRow()){d=g.id}}else{if(m.activeMode="cell"){if(g=f.getActiveCell()){d=g._row.id}}}}if(d){var n=f.getRowbyRowId(d),o=f.getHeader("min");d=n.id;var j=l.box._adjustRows(l,[c]),e=j[0].cells;xui.arr.each(n.cells,function(r,q){xui.isDefined(e[q]&&e[q].value)&&f.updateCellByRowCol(d,o[q],e[q],b,a)})}m.rowMap=c})},getHeader:function(f){var e=this.get(0).properties.header;if(!xui.isArr(e)){return[]}if(f=="data"){return xui.clone(e,true)}else{if(f=="min"){var d=xui.clone(e,true),c;xui.arr.each(d,function(b,a){d[a]=b.id});return d}else{return e}}},getHeaderByColId:function(d,c){var a=this.get(0).properties.header,b;if(xui.isNumb(d)){d=xui.get(profile.properties.header,[d,"id"])}b=xui.arr.subIndexOf(a,"id",d);return b==-1?null:c=="data"?xui.clone(a[b],true):c=="min"?a[b].id:a[b]},getHeaderByCell:function(a,c){var b=a._col;return !b?null:c=="data"?xui.clone(b,true):c=="min"?b.id:b},updateHeader:function(c,w){var r=this,f=r.get(0),a=f.properties,e=r.getHeaderByColId(c),s;if(!e){var g=a.grpCols,l=xui.arr.subIndexOf(g,"id",c);e=g[l];s=true}if(e){if(typeof w!="object"){w={caption:w+""}}else{xui.filter(w,true)}delete w.id;if(f.renderId){var q=e._serialId,u,m,j;if(!s){if(u=w.width){u=f.$px(u);var d=[];j=r.getSubNode("HCELL",q).get(0);if(j){d.push(j)}j=r.getSubNode("HSCELL",q).get(0);if(j){d.push(j)}xui.each(e._cells,function(b){d.push(r.getSubNode("CELL",b).get(0))});f.box._adjusteditorW(f,xui(d).width(e._colWidth=f.$forceu(u)),u);r.getSubNode("SCROLL22").onScroll();r.constructor._adjustColsWidth(r.get(0));r.constructor._adjustBody(r.get(0),"setcol")}if(w.hasOwnProperty("visibility")&&!w.hasOwnProperty("hidden")){w.hidden=!w.visibility}if(w.hasOwnProperty("hidden")){var o=!!w.hidden;if(o){if(e.hidden!==true){r.showColumn(c,false)}}else{if(e.hidden===true){r.showColumn(c,true)}}}if("type" in w){delete e.editorCacheKey}}if(u=w.headerStyle||w.colStyle){(m=r.getSubNodes(["HCELLA","HSCELLA"],q)).attr("style",m.attr("style")+";"+u)}if(u=w.headerClass){r.getSubNodes(["HCELLA","HSCELLA"],q).addClass(u)}if(w.hasOwnProperty("caption")){r.getSubNodes(["HCELLCAPTION","HSCELLCAPTION"],q).get(0).innerHTML=w.caption}if("colResizer" in w){u=!!w.colResizer;r.getSubNode("HHANDLER",q).css("display",(w.colResizer=u)?"block":"none")}}xui.merge(e,w,"all");if("flexSize" in w){f.adjustSize()}}},showColumn:function(c,j){var f=this.get(0),a=f.colMap2,l=f.colMap,e,b,m,g,d=[];if(e=l[b=a[c]]){if(f.beforeColShowHide&&false===f.boxing().beforeColShowHide(f,c,j)){return false}g=f.getSubNode("HCELL",b).get(0);if(g){d.push(g)}g=f.getSubNode("HSCELL",b).get(0);if(g){d.push(g)}xui.each(e._cells,function(n){d.push(f.getSubNode("CELL",n).get(0))});xui(d).css("display",(e.hidden=(j===false?true:false))?"none":"");if(f.afterColShowHide){f.boxing().afterColShowHide(f,c,j)}}f.box._adjustColsWidth(f);f.box._adjustBody(f,"setcol");return true},sortColumn:function(c,f,e){var d=this.get(0),b=d.colMap2[c],a=d.colMap[b];if(b&&a){if(xui.isBool(f)){a._order=!f}if(xui.isFun(e)){a.sortby=e}d.getSubNode("HCELLA",b).onClick()}return this},getCell:function(f,e){var c=this,d=this.get(0),b,a;xui.each(d.cellMap,function(g){if(g.id&&g.id===f){f=g._serialId;return false}});b=d.cellMap[f];return !b?null:e=="data"?xui.merge({rowId:b._row.id,colId:b._col.id},xui.clone(b,true)):e=="min"?b.value:e=="map"?((a={})&&((a[b._col.id]=b.value)||1)&&a):b},getCellbyRowCol:function(c,a,g){var l=this,d=l.get(0),j,e;if(xui.isNumb(c)){c=xui.get(d.properties.rows,[c,"id"])}if(xui.isNumb(a)){a=xui.get(d.properties.header,[a,"id"])}j=xui.get(d.rowMap,[d.rowMap2[c],"_cells",a]);j=j&&d.cellMap[j];if(!j){var n=l.getRowbyRowId(c),f=l.getHeader("min"),b;if(n&&n.cells){b=xui.arr.indexOf(f,a);if(b!=-1){j=n.cells[b]}}}return !j?null:g=="data"?xui.merge({rowId:c,colId:a},xui.clone(j,true)):g=="min"?j.value:g=="map"?((e={})&&((e[a]=j.value)||1)&&e):j},getCells:function(d,b,a){var c={};xui.each(this.get(0).cellMap,function(e){if((d?(d==e._row.id):1)&&(b?(b==e._col.id):1)){c[e.id]=a=="data"?xui.merge({rowId:e._row.id,colId:e._col.id},xui.clone(e,true)):a=="min"?e.value:e}});return c},updateCellByRowCol:function(d,b,o,j,f,g){var l,m=this,a=m.constructor;if(l=a._getCellId(m.get(0),d,b)){a._updCell(m.get(0),l,o,j,f,g)}else{var n=m.getRowbyRowId(d),e=m.getHeader("min"),c;if(n&&n.cells){c=xui.arr.indexOf(e,b);if(c!=-1){if(!xui.isHash(n.cells[c])){n.cells[c]={value:n.cells[c]}}xui.merge(n.cells[c],o)}}}return m},getCellPos:function(a,b){if(!a||!a._row||!a._col){return null}var d=this.get(0),c=xui.arr.indexOf(a._row.cells,a),e=xui.arr.indexOf(d.properties.rows,a._row);return c==-1||e==-1?null:b?xui.ExcelFormula.toCellId(c,e):{row:e,col:c}},updateCellByRowCol2:function(d,c,f,e){var a=d.indexOf(":")!=-1?d.split(":"):xui.ExcelFormula.toCoordinate("A3",true),g=parseInt(a[0],10),b=parseInt(a[1],10);return this.updateCellByRowCol(g,b,c,f,e)},updateCell:function(e,b,g,f,c){var a=this,d=this.get(0);xui.each(d.cellMap,function(j){if(j.id&&j.id===e){e=j._serialId;return false}});a.constructor._updCell(d,e,b,g,f,c);return a},editCellbyRowCol:function(d,c){var b=this.get(0),a=b.box;a._editCell(b,a._getCellId(b,d,c));return this},editCell:function(a){if(a=a?a:this.get(0).getSubId(this.get(0).$activeCell+"")){this.constructor._editCell(this.get(0),a)}return this},editFirstCell:function(d){var e=this.get(0),g=function(r){return e.box.getCellOption(e,q,r)},q=typeof d=="string"?(e.rowMap[e.rowMap2[d]]):d,j;if(!e.properties.firstCellEditable||!q){return}if(g(e,q,"disabled")||g(e,q,"readonly")){return}if(!(e&&e.renderId)||e.destroyed){return}var f=e.getSubNode("FCELLCAPTION",q._serialId);if(!f.isEmpty()){if(e.beforeIniEditor){j=e.boxing().beforeIniEditor(e,q,f,b,"row");if(j===false){return}}var b=f.parent(),n=b.cssSize(),c=e.getSubNode("BORDER"),o=c.contentBox()?2:0,a=f.offset(null,b),m=b.offset(null,c);if(m.left>n.width-8){return}j=e.$cache_editor.firstCellEditor;if(!j||!j["xui.UI"]||j.isDestroyed()){j=new xui.UI.ComboInput({type:"input",zIndex:100});e.$cache_editor.firstCellEditor=j}j.setWidth(n.width-a.left+o).setHeight(n.height+o).setValue(q.value||q.value||"");if(e.onBeginEdit){e.boxing().onBeginEdit(e,q,j,"row")}j.undo=function(){var r=this,s=r.get(0)&&r.get(0).$row;r.undo=null;if(e.box){if(s&&s._oValue!==s.value&&s.id!=e.box._temprowid&&e.onRowDirtied){e.boxing().onRowDirtied(e,s)}}if(r.get(0)&&r.get(0).box){r.getSubNode("INPUT").onBlur(true);r.getRoot().setBlurTrigger("tg_editor_blur:"+e.$xid);if(e.properties){r.beforeUnitUpdated(null).afterUIValueSet(null).beforeNextFocus(null).onCancel(null).onFileDlgOpen(null);r.setValue("",true,"editorreset")}delete r.get(0).$row;delete r.get(0)._smartnav;delete r.get(0).$editMode;r.hide()}if(s){delete s._editor}e.$curEditor=null;if(e.onEndEdit){e.boxing().onEndEdit(e,s,r,"row")}if(r.get(0)){r.destroy(true)}r=null};j.afterUIValueSet(function(B,x,s,A,r){var u={value:s},w;if(B.properties.hasOwnProperty("tagVar")&&!xui.isEmpty(w=B.properties.tagVar)){u.tagVar=w}if(false!==(e.beforeEditApply&&e.boxing().beforeEditApply(e,q,u,j,r,"row"))){e.boxing().updateRow(q.id,{value:s,caption:s+""});xui.tryF(j.undo,[],j)}}).beforeNextFocus(function(u,s){xui.tryF(j.undo,[true],j);var r=xui.Event.getEventPara(s);if(r.key=="enter"){r.$key="right"}e.getSubNode("CELLA",q._serialId).onKeydown(true,r);return false}).onCancel(function(){xui.tryF(j.undo,[],j)});c.append(j);j.reBoxing().show((a.left+m.left-1)+"px",(m.top-1)+"px");var l=j.getRoot();l.setBlurTrigger("tg_editor_blur:"+e.$xid,function(){xui.tryF(j.undo,[],j);return false});j.get(0).$row=q;j.get(0)._smartnav=true;q._editor=j;e.$curEditor=j;j.activate()}return this},focusCellbyRowCol:function(f,d){var b=this.get(0),a=b.box,e=a._getCellId(b,f,d),c=b.getSubNode("CELLA",e);if(c&&c.get(0)){c.focus(true)}return this},focusCell:function(a){var b=a._serialId;this.get(0).getSubNode("CELLA",b).focus(true);return this},getActiveCell:function(e){var c,d=this.get(0),a,b;if(d.properties.activeMode!="cell"){return}if(!(c=d.$activeCell)){return}b=d.cellMap[d.getSubId(c)];return !b?null:e=="data"?xui.merge({rowId:b._row.id,colId:b._col.id},xui.clone(b,true)):e=="min"?b.value:e=="map"?((a={})&&((a[b._col.id]=b.value)||1)&&a):b},setActiveCell:function(e,c){var d,a,b=this.get(0);if(b.properties.activeMode!="cell"){return}b.box._activeCell(b,false);if(typeof e=="object"){a=e}else{a=this.getCellbyRowCol(e,c)}if(!a){return}if(!(d=b.getSubNode("CELL",a._serialId)).isEmpty()){b.box._activeCell(b,d.get(0).id)}return this},getDirtied:function(c,a){var b={};xui.each(this.get(0).cellMap,function(d){if((d._oValue!==d.value||(("unit" in d)&&d._oUnit!==d.unit))&&(c?(c==d._row.id):1)&&(a?(a==d._col.id):1)){b[d.id]={rowId:d._row.id,colId:d._col.id,value:d.value,_oValue:d._oValue};if("unit" in d){b[d.id]._oUnit=d._oUnit}}});return b},getSubNodeInGrid:function(b,e,d){var c=this,a=(xui.isSet(e)&&xui.isSet(d))?c.getCellbyRowCol(e,d):d?c.getHeaderByColId(d):e?c.getRowbyRowId(e):null;return c.getSubNode(b,(a&&a._serialId)||true)},getInlineEditors:function(c,a){var b={};xui.each(this.getCells(c,a),function(d,e){b[e]=d._editor});return b},getEditor:function(){return xui.get(this.get(0),["$curEditor"])},updateEditor:function(c,a,d){var b=this.getEditor();if(b){if(xui.isHash(d)){b.setProperties(d,true)}if(xui.isDefined(a)){b.setCaption(a,true)}if(xui.isDefined(c)){b.setUIValue(c,true)}}return this},getEditCell:function(){return xui.get(this.get(0),["$cellInEditor"])},offEditor:function(d,a){var c=this.get(0),b;if(!c){return}if(b=c.$curEditor){xui.tryF(b.undo,[],b)}if(!a){xui.each(c.cellMap,function(f){if(b=f._editor){b.destroy();delete f._editor}})}if(d){var e=c.box.getCellOption;xui.each(c.cellMap,function(f){if(e(c,f,"editable")&&(e(c,f,"editMode")=="inline"||e(c,f,"type")=="dropbutton")){c.box._editCell(c,f,null,true)}})}},adjustEditor:function(f){var e=this,b=this.get(0),g=this.getRoot().contentBox();if(b&&b.$curEditor){var d=b.$curEditor,j=b.$cellInEditor;if(typeof f=="function"){f.apply(e,[d,j])}else{if(d.KEY=="xui.UI.ComboInput"){var c=b.getSubNode("CELL",j.id),a=c.offset(null,b.getSubNode("SCROLL22")),l=c.cssSize();d.setLeft(a.left-1).setTop(a.top-1).setWidth(l.width+g+1).setHeight(l.height+g).reLayout(true)}}}return e}},Before:function(b,a,c){if(b=="xui.UI.TreeGrid"){this.Behaviors.CELLS1=this.Behaviors.CELLS2;this.Behaviors.GCELLA=this.Behaviors.CELLA}return arguments.callee.upper.apply(this,arguments)},Initialize:function(){this.addTemplateKeys(["ALT","PROGRESS"]);this.getCellPro=this.getCellOption;var a=this.prototype;a.getColumn=a.getHeader;a.updateColumn=a.updateHeader;a.getColByDom=a.getHeaderByDom;a.getColByColId=a.getHeaderByColId;a.getColByCell=a.getHeaderByCell},Static:{HasHtmlTableNode:1,DIRYMARKICON:"DIRTYMARK",Templates:{tagName:"div",style:"{_style}",className:"{_className}",BORDER:{tagName:"div",BOX:{tagName:"table",cellspacing:"0",cellpadding:"0",className:"xui-uibase",TBODY:{tagName:"tbody",TRHEADER:{tagName:"tr",TDHEADER1:{tagName:"td",HEADER1:{tagName:"div",style:"{showHeader}",HI1:{tagName:"div",HCELLS1:{tagName:"div",style:"{headerHeight}",FHCELL:{$order:0,style:"{rowHandlerDisplay};{_row0DfW};height:{_hcellheight};",className:"xui-uiborder-noradius xui-uibar xui-uiborder-outset {cellCls}",tabindex:"{_tabindex}",HCELLA:{style:"{firstCellStyle};",className:"xui-v-wrapper xui-showfocus {firstCellClass}",HHANDLER:{tagName:"div",style:"{colDDDisplay}"},FHANDLER:{tagName:"div",style:"{rowDDDisplay}"},HFMARK:{$order:1,className:"xuifont",$fonticon:"xui-uicmd-check",style:"{_rowMarkDisplay}"},LTAGCMDS:{$order:2,tagName:"span",className:"xui-ltag-cmds",text:"{ltagCmds}"},GRIDCAPTION:{$order:5,text:"{gridHandlerCaption}"},SORT:{className:"xuifont",$fonticon:"xui-icon-sort",style:"{sortDisplay}"}}},OTHERHCELLS:{$order:1,tagName:"text",text:"{header1}"}},GRPCELLBOX1:{tagName:"div",style:"{headerHeight};",GRPCELLS:{$order:3,tagName:"text",text:"{grpCols1}"}}}}},TDHEADER2:{tagName:"td",HEADER2:{$order:0,tagName:"div",className:"xui-uibar",style:"{showHeader}",HI2:{tagName:"div",HCELLS2:{tagName:"div",style:"{headerHeight};",OTHERHCELLS:{$order:1,tagName:"text",text:"{header2}"},LHCELL:{$order:2,className:"xui-v-wrapper xui-uibar",style:"width:{tagCmdWidth}em;height:100%;text-align: center",LHCELLINNER:{$order:1,text:"{headerTail}"},RTAGCMDS:{$order:1,tagName:"span",className:"xui-rtag-cmds",text:"{rtagCmds}"}}},GRPCELLBOX2:{tagName:"div",style:"{headerHeight};",GRPCELLS:{$order:3,tagName:"text",text:"{grpCols2}"}}}}}},TRLOCKED1:{tagName:"tr",TDBODY11:{tagName:"td",SCROLL11:{$order:1,tagName:"div",className:"",BODY11:{tagName:"div",ROWS11:{$order:1,tagName:"div",text:"{rows11}"}}}},TDBODY12:{tagName:"td",SCROLL12:{$order:1,tagName:"div",className:"{_rowfreezed}",BODY12:{tagName:"div",ROWS12:{$order:1,tagName:"div",text:"{rows12}"}}}}},TRBODY:{tagName:"tr",TDBODY21:{tagName:"td",SCROLL21:{$order:1,tagName:"div",className:"{_columnfreezed}",BODY21:{tagName:"div",ROWS21:{$order:1,tagName:"div",text:"{rows21}"}}}},TDBODY22:{tagName:"td",SCROLL22:{$order:1,tagName:"div",BODY22:{tagName:"div",ROWS22:{$order:1,tagName:"div",text:"{rows22}"}}}}},TRTAIL:{tagName:"tr",TDTAIL1:{tagName:"td"},TDTAIL2:{tagName:"td"}}}},COLLIST:{tagName:"div",COLLISTDROP:{className:"xuifont xui-special-icon",$fonticon:"xui-icon-triangle-down"}},ARROW:{className:"xuifont xui-special-icon",$fonticon:"xui-icon-bigup",text:"&nbsp;"}},DIRTYMARK:{},$submap:{header1:function(f,e,c,b,a,d){if(d>f.properties.freezedColumn){return}f.colMap[c._serialId]._region=1;b="header";xui.UI.$doTemplate(f,e,c,b,a);return b},header2:function(f,e,c,b,a,d){if(d>f.properties.freezedColumn){f.colMap[c._serialId]._region=2;b="header";xui.UI.$doTemplate(f,e,c,b,a);return b}},header:{HCELL:{style:"width:{_cellWidth};height:{_hcellheight};{colDisplay};",className:"xui-uiborder-noradius xui-uibar xui-uiborder-outset {cellCls}",HCELLA:{className:"xui-v-wrapper xui-showfocus {headerClass}",style:"{headerStyle};{colStyle}",tabindex:"{_tabindex}",HCELLCAPTION:{$order:5,className:"xui-v-node",text:"{caption}"},SORT:{className:"xuifont",$fonticon:"xui-icon-sort",style:"{sortDisplay}"},HHANDLER:{$order:2,tagName:"div",style:"{colDDDisplay}"}}}},grpCols1:function(f,e,c,b,a,d){var d=f.properties.freezedColumn-1,g=f.colMap;if(c.from>d){return}if(c.to>d){g[c._serialId]._region=2;g[c._serialId]._shadow=1;b="grpColsShadow";xui.UI.$doTemplate(f,e,c,b,a)}else{g[c._serialId]._region=1;b="grpCols";xui.UI.$doTemplate(f,e,c,b,a)}return b},grpCols2:function(f,e,c,b,a,d){var d=f.properties.freezedColumn-1;if(c.to>d){f.colMap[c._serialId]._region=2;b="grpCols";xui.UI.$doTemplate(f,e,c,b,a);return b}},grpCols:{HCELL:{style:"position:absolute;width:{_cellWidth};height:{_hcellheight};top:{_hcelltop};left:{_hcellleft};",className:"xui-uiborder-noradius xui-uibar xui-uiborder-outset {cellCls}",HCELLA:{className:"xui-v-wrapper xui-showfocus {headerClass}",style:"{headerStyle};{colStyle}",tabindex:"{_tabindex}",HCELLCAPTION:{$order:5,className:"xui-v-node",text:"{caption}"},HHANDLER:{$order:2,tagName:"div",style:"{colDDDisplay}"}}}},grpColsShadow:{HSCELL:{style:"position:absolute;width:{_cellWidth};height:{_hcellheight};top:{_hcelltop};left:{_hcellleft};",className:"xui-uiborder-noradius xui-uibar xui-uiborder-outset {cellCls}",HSCELLA:{className:"xui-v-wrapper xui-showfocus {headerClass}",style:"{headerStyle};{colStyle}",tabindex:"{_tabindex}",HSCELLCAPTION:{className:"xui-v-node",text:"{caption}"}}}},grpCols:{HCELL:{style:"position:absolute;width:{_cellWidth};height:{_hcellheight};top:{_hcelltop};left:{_hcellleft};",className:"xui-uiborder-noradius xui-uibar xui-uiborder-outset {cellCls}",HCELLA:{className:"xui-v-wrapper xui-showfocus {headerClass}",style:"{headerStyle};{colStyle}",tabindex:"{_tabindex}",HCELLCAPTION:{$order:5,className:"xui-v-node",text:"{caption}"},HHANDLER:{$order:2,tagName:"div",style:"{colDDDisplay}"}}}},rows11:function(f,e,c,b,a,d){if(f._passFreezedRow){return false}if(d>f.properties.freezedRow){return false}f.rowMap[c._serialId]._region=1;xui.UI.$doTemplate(f,e,c,"row1",a,d,"rows1")},rows12:function(f,e,c,b,a,d){if(f._passFreezedRow){return false}if(d>f.properties.freezedRow){return false}f.rowMap[c._serialId]._region=1;xui.UI.$doTemplate(f,e,c,"row2",a,d,"rows2")},rows21:function(f,e,c,b,a,d){if(!f._passFreezedRow&&d<=f.properties.freezedRow){return}f.rowMap[c._serialId]._region=2;xui.UI.$doTemplate(f,e,c,"row1",a,d,"rows1")},rows22:function(f,e,c,b,a,d){if(!f._passFreezedRow&&d<=f.properties.freezedRow){return}f._passFreezedRow=1;f.rowMap[c._serialId]._region=2;xui.UI.$doTemplate(f,e,c,"row2",a,d,"rows2")},row1:{ROW1:{tagName:"div",style:"{rowDisplay}",CELLS1:{$order:2,tagName:"div",className:"xui-uirowbg xui-uiborder-b xui-uiborder-light {rowCls} {rowClass}",style:"{_rowHeight};{rowStyle}",CELLHANDLER:{tagName:"text",text:"{_handler_cell}"},GRPCELL2:{tagName:"text",text:"{_firstcell_grp}"},OTHERCELLS:{tagName:"text",$order:2,text:"{cells}"}},SUB1:{$order:3,tagName:"div"}}},row2:{ROW2:{tagName:"div",style:"{rowDisplay}",CELLS2:{$order:2,tagName:"div",className:"xui-uirowbg xui-uiborder-b xui-uiborder-light {rowCls} {rowClass}",style:"{_rowHeight};{rowStyle}",GRPCELL2:{tagName:"text",text:"{_firstcell_grp}"},OTHERCELLS:{tagName:"text",$order:2,text:"{cells}"},LCELL:{$order:3,className:"xui-v-wrapper",LCELLINNER:{$order:1,text:"{rowTail}"},RTAGCMDS:{$order:2,tagName:"span",className:"xui-rtag-cmds",text:"{rtagCmds}"}}},SUB2:{$order:3,tagName:"div"}}},"rows1._handler_cell":function(f,e,c,b,a,d){xui.UI.$doTemplate(f,e,c,f.properties.treeMode=="infirstcell"?"rows1._handler_cell2":"rows1._handler_cell1",a)},"rows1._handler_cell1":{FCELL:{$order:0,style:"{rowHandlerDisplay};{_row0DfW};",className:"xui-uiborder-r xui-uiborder-light {cellCls}",CELLA:{tabindex:"{_tabindex}",style:"{cellStyle}{firstCellStyle}",className:"xui-v-wrapper xui-showfocus {cellClass}{firstCellClass}",MARK:{$order:1,className:"xuifont",$fonticon:"xui-uicmd-check",style:"{_rowMarkDisplay}"},ROWLRULER:{$order:2,style:"{_treeMode};{_rulerW}"},ROWNUM:{$order:3,className:"xui-ui-readonly",style:"{_rowNumbDisplay}"},ROWTOGGLE:{$order:4,style:"{_treeMode};",className:"xuifont",$fonticon:"{_fi_togglemark}"},LTAGCMDS:{$order:1,tagName:"span",className:"xui-ltag-cmds",style:"{_ltagDisplay}",text:"{ltagCmds}"},FCELLCAPTION:{$order:5,className:"xui-v-node",text:""},FHANDLER:{$order:0,tagName:"div",style:"{rowDDDisplay}"}}}},"rows1._handler_cell2":{FCELL:{$order:0,style:"{rowHandlerDisplay};{_row0DfW};",className:"xui-uiborder-r xui-uiborder-light {cellCls}",CELLA:{tabindex:"{_tabindex}",style:"{cellStyle}{firstCellStyle}",className:"xui-v-wrapper xui-showfocus {cellClass}{firstCellClass}",FHANDLER:{$order:6,tagName:"div",style:"{rowDDDisplay}"}}}},"rows1._firstcell_grp":function(f,e,c,b,a,d){if(f.properties.treeMode!="infirstcell"){return}if(!f.properties.freezedColumn){return}xui.UI.$doTemplate(f,e,c,"rows._firstcell_grp",a)},"rows2._firstcell_grp":function(f,e,c,b,a,d){if(f.properties.treeMode!="infirstcell"){return}if(f.properties.freezedColumn){return}xui.UI.$doTemplate(f,e,c,"rows._firstcell_grp",a)},"rows._firstcell_grp":{GCELL:{$order:0,className:"{cellCls}",GCELLA:{tabindex:"{_tabindex}",style:"{cellStyle}{firstCellStyle}",className:"xui-v-wrapper xui-showfocus {cellClass}{firstCellClass}",MARK:{$order:1,$customId:1,className:"xuifont",$fonticon:"xui-uicmd-check",style:"{_rowMarkDisplay}"},ROWLRULER:{$order:2,$customId:1,style:"{_treeMode};{_rulerW}"},ROWNUM:{$order:3,$customId:1,className:"xui-ui-readonly",style:"{_rowNumbDisplay}"},ROWTOGGLE:{$order:4,$customId:1,style:"{_treeMode};",className:"xuifont",$fonticon:"{_fi_togglemark}"},LTAGCMDS:{$order:1,$customId:1,tagName:"span",style:"{_ltagDisplay}",text:"{ltagCmds}"},FCELLCAPTION:{$order:5,$customId:1,className:"xui-v-node",text:"{caption}"}}}},"rows1.cells":function(g,f,c,b,a,d){if(d>g.properties.freezedColumn){return}b="rows.cells";var e=g.box._tplMap2[c.type]||".input";if(g.properties.treeMode=="infirstcell"&&d==1&&e==".input"){e="._first_cell"}xui.UI.$doTemplate(g,f,c,b+e,a);return b},"rows2.cells":function(g,f,c,b,a,d){if(d<=g.properties.freezedColumn){return}b="rows.cells";var e=g.box._tplMap2[c.type]||".input";if(g.properties.treeMode=="infirstcell"&&d==1&&e==".input"){e="._first_cell"}xui.UI.$doTemplate(g,f,c,b+e,a);return b},"rows.cells._first_cell":{CELL:{style:"width:{_cellWidth};{cellDisplay};",className:"xui-uiborder-r xui-uiborder-light xui-treegrid-fcell {cellCls}",CELLA:{className:"xui-v-wrapper xui-showfocus {cellClass}",style:"{bgcolor};{cellStyle}",tabindex:"{_tabindex}",MARK:{$order:1,$customId:1,className:"xuifont",$fonticon:"xui-uicmd-check",style:"{_rowMarkDisplay}"},ROWLRULER:{$order:2,$customId:1,style:"{_treeMode};{_rulerW}"},ROWNUM:{$order:3,$customId:1,className:"xui-ui-readonly",style:"{_rowNumbDisplay}"},ROWTOGGLE:{$order:4,$customId:1,style:"{_treeMode};",className:"xuifont",$fonticon:"{_fi_togglemark}"},LTAGCMDS:{$order:1,$customId:1,tagName:"span",style:"{_ltagDisplay}",text:"{ltagCmds}"},CELLCAPTION:{$order:5,style:"{color}",className:"xui-v-node xui-treegrid-fcellcaption",text:"{_caption}"}}}},"rows.cells.input":{CELL:{style:"width:{_cellWidth};{cellDisplay};",className:"xui-uiborder-r xui-uiborder-light {cellCls}",CELLA:{className:"xui-v-wrapper xui-showfocus {cellClass}",style:"{bgcolor};{cellStyle}",tabindex:"{_tabindex}",CELLCAPTION:{className:"xui-v-node",style:"{color}",text:"{_caption}"}}}},"rows.cells.textarea":{CELL:{style:"width:{_cellWidth};{cellDisplay};",className:"xui-uiborder-r xui-uiborder-light {cellCls}",CELLA:{className:"xui-v-wrapper xui-showfocus xui-cls-wordwrap {cellClass}",style:"{bgcolor};{cellStyle}",tabindex:"{_tabindex}",CELLCAPTION:{className:"xui-v-node",style:"{color}",text:"{_caption}"}}}},"rows.cells.button":{CELL:{style:"width:{_cellWidth};{cellDisplay};",className:"xui-uiborder-r xui-uiborder-light {cellCls}",CELLA:{tagName:"button",className:"xui-node xui-showfocus xui-wrapper xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius xui-treegrid-tgbtn {cellClass}",style:"{cellStyle}",tabindex:"{_tabindex}",CELLCAPTION:{className:"xui-v-node",text:"{_caption}"}}}},"rows.cells.checkbox":{CELL:{style:"width:{_cellWidth};{cellDisplay}",className:"xui-uiborder-r xui-uiborder-light {cellCls}",CELLA:{className:"xui-v-wrapper xui-showfocus {cellClass}",style:"{cellStyle}",tabindex:"{_tabindex}",CHECKBOX:{className:"xuifont xui-uicmd-check",$fonticon:"{_fi_checkboxCls}"}}}},"rows.cells.progress":{CELL:{style:"width:{_cellWidth};{cellDisplay}",className:"xui-uiborder-r xui-uiborder-light {cellCls}",CELLA:{className:"xui-showfocus {cellClass}",style:"{cellStyle}",tabindex:"{_tabindex}",PROGRESS:{$order:2,tagName:"div",className:"xui-v-wrapper xui-uibar",style:"width:{progress};",CELLCAPTION:{className:"xui-v-node",text:"{_caption}"}}}}},"rows1._handler_cell1.ltagCmds":function(f,e,d,b,a){if(d.id==f.box._temprowid){return}var c=d.buttonType||d.type;xui.UI.$doTemplate(f,e,d,"rows.tagCmds"+(f.box._tplMap[c]||".button"),a)},"rows._firstcell_grp.ltagCmds":function(f,e,d,b,a){var c=d.buttonType||d.type;xui.UI.$doTemplate(f,e,d,"rows.tagCmds"+(f.box._tplMap[c]||".button"),a)},"rows.cells._first_cell.ltagCmds":function(f,e,d,b,a){var c=d.buttonType||d.type;xui.UI.$doTemplate(f,e,d,"rows.tagCmds"+(f.box._tplMap[c]||".button"),a)},"rows2.rtagCmds":function(f,e,d,b,a){var c=d.buttonType||d.type;xui.UI.$doTemplate(f,e,d,"rows.tagCmds"+(f.box._tplMap[c]||".button"),a)},ltagCmds:function(f,e,d,b,a){var c=d.buttonType||d.type;xui.UI.$doTemplate(f,e,d,"rows.tagCmds"+(f.box._tplMap[c]||".button"),a)},rtagCmds:function(f,e,d,b,a){var c=d.buttonType||d.type;xui.UI.$doTemplate(f,e,d,"rows.tagCmds"+(f.box._tplMap[c]||".button"),a)},"rows.tagCmds.text":xui.UI.$getTagCmdsTpl("text"),"rows.tagCmds.button":xui.UI.$getTagCmdsTpl("button"),"rows.tagCmds.image":xui.UI.$getTagCmdsTpl("image")}},Appearances:{KEY:{display:"block",position:"absolute",overflow:"hidden"},BORDER:{"border-top":"solid 1px",margin:"1px 0px 0px 0px"},"LTAGCMDS, RTAGCMDS":{padding:0,margin:0,"vertical-align":"middle"},"HFMARK, MARK":{"margin-left":".5em"},DIRTYMARK:{position:"absolute",width:"1em",height:"1em",left:"1px",top:"1px","z-index":10},BOX:{"border-collapse":"collapse",height:"100%",width:"100%"},"HEADER1, HEADER2":{position:"relative",overflow:"hidden","text-align":"left"},"HI1, HI2":{position:"relative"},"GRPCELLBOX1, GRPCELLBOX2":{position:"absolute",overflow:"visible",left:0,top:0,width:0,height:0},"SCROLL11, SCROLL12, SCROLL21, SCROLL22":{position:"relative","text-align":"left"},"SCROLL11, SCROLL12, SCROLL21":{overflow:"hidden"},SCROLL22:{overflow:"auto"},ARROW:{position:"absolute","z-index":"20",left:0,top:0,display:"none",width:"auto",height:"auto","font-weight":"bold","text-align":"center","font-size":"2em"},"ARROW:before":{"margin-left":"-50%"},COLLIST:{position:"absolute","z-index":"10",left:0,top:0,cursor:"pointer",visibility:"hidden"},COLLISTDROP:{position:"absolute",left:0,bottom:0,cursor:"pointer"},"BODY11, BODY12, BODY21, BODY22":{overflow:"visible",position:"absolute",left:0,top:0},SORT:{position:"absolute",right:".25em",bottom:".25em"},HHANDLER:{position:"absolute",background:xui.browser.ie?"url("+xui.ini.img_bg+")":null,width:".5em",top:"0",right:"0",height:"100%",cursor:"e-resize"},"HCELLS1, HCELLS2, CELLS1, CELLS2":{"overflow-y":xui.browser.ie?"hidden":"",position:"relative",background:"transparent","white-space":"nowrap"},"HCELLS1, HCELLS2, GRPCELLBOX1, GRPCELLBOX2":{overflow:"visible"},"CELLS1, CELLS2":{overflow:"visible"},"CELLS1-group FCELL, CELLS2-group FCELL":{"border-right":0,"padding-right":"1px",overflow:"visible"},"CELLS1-group FCELLCAPTION, CELLS1-group CELLA,  CELLS1-group GCELLA, CELLS1-group ROWNUM, CELLS2-group FCELLCAPTION, CELLS2-group CELLA, CELLS2-group GCELLA":{"font-weight":"bold",overflow:"visible"},"CELLS1-active, CELLS2-active, CELL-active, CELL-active CELLA":{$order:5,"background-color":"#DDDDDD"},"CELLS1-hot, CELLS2-hot":{$order:6,"background-color":"#FFE97F"},"CELLS2-hot LTAGCMDS, CELLS2-hot RTAGCMDS":{$order:6,display:"none"},"CELLS1-checked, CELLS2-checked, CELLS1-checked .xui-node, CELLS2-checked .xui-node, CELL-checked, CELL-checked .xui-node":{$order:6,"background-color":"#ABABAB",color:"#fff"},"FCELL CELLA, GCELL GCELLA":{"text-align":"left"},"FHCELL HCELLA, HSCELLA":{"text-align":"center"},"CELLCAPTION,HCELLCAPTION,HSCELLCAPTION,SORT,HHANDLER":{"vertical-align":"middle"},"CELLCAPTION,HCELLCAPTION,HSCELLCAPTION,FCELLCAPTION,GRIDCAPTION":{"max-width":"100%","text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden","font-size":"1em"},"FCELL FCELLCAPTION, FHCELL GRIDCAPTION":{display:"inline"},"CELL-textarea CELLCAPTION":{$order:10,"white-space":"normal"},FHANDLER:{position:"absolute",height:".5em",left:"0",width:"100%",bottom:"0",cursor:"n-resize","z-index":10},"FCELLCAPTION, ROWNUM":{"vertical-align":"middle",overflow:"hidden"},"FHCELL, HCELL, HSCELL":{padding:0,"vertical-align":"bottom"},"ROW1, ROW2":{position:"relative",zoom:xui.browser.ie?1:null,width:xui.browser.ie?"100%":null},ROWNUM:{"padding-right":".5em"},"FCELL, CELL":{height:"100%","padding-left":"1px",position:"relative",overflow:xui.browser.ie6?"hidden":"","vertical-align":"top",display:xui.$inlineBlock},GCELL:{height:"100%",width:"100%","padding-left":"1px",position:"relative",overflow:xui.browser.ie6?"hidden":"","vertical-align":"top",display:xui.$inlineBlock},"LHCELL, LCELL":{height:"100%",position:"relative","vertical-align":"top"},"CELLS1-alt, CELLS2-alt":{$order:1,"background-color":"#EFF8FF"},"CELL-input":{},"CELL-number, CELL-spin, CELL-currency":{"text-align":"right"},"CELL-counter":{"text-align":"center"},"CELL-checkbox":{"text-align":"center"},"KEY-tgbtn":{$order:100,width:"100%",padding:0,"vertical-align":"text-bottom","line-height":"100%",height:"100%"},"CELLS1-hover, CELLS2-hover":{$order:4,"background-color":"#F6F6F6"},'CELL-hover, CELL-hover .xui-node[class*="xui-treegrid-"]':{$order:5,"background-color":"#C5C5C5 !important"},"FCELL CELLA, GCELL GCELLA, HCELLA, HSCELLA":{position:"relative","text-overflow":"ellipsis"},"HCELLA, HSCELLA":{$order:3,"text-align":"center","vertical-align":"middle","line-height":"inherit"},"HCELLA, HSCELLA, CELLA, GCELLA":{display:"block",overflow:"hidden","-moz-box-flex":"1","outline-offset":"-1px","-moz-outline-offset":(xui.browser.gek&&xui.browser.ver<3)?"-1px !important":null,height:"100%",width:xui.browser.ie?"100%":"","line-height":"inherit"},"CELLA-inline":{$order:5,display:xui.$inlineBlock,width:"auto","-moz-box-flex":0},PROGRESS:{border:"none",height:"100%","line-height":"1.83333em",overflow:"visible",opacity:0.7,"*filter":"alpha(opacity=70)"},"PROGRESS CELLCAPTION":{overflow:"visible"},"CHECKBOX, MARK":{cursor:"pointer","vertical-align":"middle"},"SUB1, SUM22":{zoom:xui.browser.ie?1:null,height:0,position:"relative",overflow:"visible"},ROWTOGGLE:{padding:"0 .334em 0 0"}},_objectProp:{rowOptions:1,colOptions:1},Behaviors:{HoverEffected:{ROWTOGGLE:"ROWTOGGLE",GCELL:"GCELL",CELL:"CELL",HCELL:["HCELL","HSCELL"],HSCELL:["HCELL","HSCELL"],FHCELL:"FHCELL",FCELL:"FHCELL",CMD:"CMD",SCROLL22:"SCROLL22",BODY11:"BODY11",BODY12:"BODY12",BODY21:"BODY22",BODY11:"BODY22",HEADER1:"HEADER1",HEADER2:"HEADER2"},ClickEffected:{ROWTOGGLE:"ROWTOGGLE",GCELL:"GCELL",CELL:"CELL",HCELL:["HCELL","HSCELL"],HSCELL:["HCELL","HSCELL"],CMD:"CMD"},DraggableKeys:["FCELL"],DroppableKeys:["SCROLL21","SCROLL22","CELLS1","CELLS2","FCELL"],HFMARK:{onClick:function(a,c,d){if(a.properties.selMode!="multi"&&a.properties.selMode!="multibycheckbox"){return}var b=[];xui.each(a.rowMap,function(e){b.push(e.id)});if(a._$checkAll){delete a._$checkAll;a.boxing().setUIValue("",null,null,"checkbox");xui.use(d).tagClass("-checked",false);a.boxing().onRowSelected(a,"allrows",c,d,-1)}else{a._$checkAll=true;xui.use(d).tagClass("-checked");a.boxing().setUIValue(b.join(a.properties.valueSeparator),null,null,"click");a.boxing().onRowSelected(a,"allrows",c,d,1)}return false}},TRLOCKED1:{onMouseover:function(a,b,c){a.box.$cancelHoverEditor(a)}},TRTAIL:{onMouseover:function(a,b,c){a.box.$cancelHoverEditor(a)}},TDBODY21:{onMouseover:function(a,b,c){a.box.$cancelHoverEditor(a)}},TRHEADER:{onMouseover:function(a,b,c){a.box.$cancelHoverEditor(a)}},SCROLL22:{onScroll:function(c,f,g){var d=xui.use(g).get(0),a=d.scrollLeft||0,b=d.scrollTop||0;if(c.$sl!=a){c.getSubNodes(["HEADER2","SCROLL12"]).scrollLeft(c.$sl=a)}if(c.$st!=b){c.getSubNode("SCROLL21").get(0).scrollTop=c.$st=b;if((b=c.getSubNode("SCROLL21").get(0).scrollTop)&&b!=c.$st){d.scrollTop=c.$st=b}}}},SCROLL21:{onScroll:function(b,d,f){var c=xui.use(f).get(0),a=c.scrollTop||0;if(b.$st!=a){b.getSubNode("SCROLL22").get(0).scrollTop=b.$st=a}}},HEADER2:{onScroll:function(b,d,f){var c=xui.use(f).get(0),a=c.scrollLeft||0;if(b.$sl!=a){b.getSubNodes(["SCROLL12","SCROLL22"]).scrollLeft(b.$sl=a)}}},SCROLL12:{onScroll:function(b,d,f){var c=xui.use(f).get(0),a=c.scrollLeft||0;if(b.$sl!=a){b.getSubNodes(["HEADER2","SCROLL22"]).scrollLeft(b.$sl=a)}}},HHANDLER:{beforeMousedown:function(j,m,a){if(xui.Event.getBtn(m)!="left"){return}var d=j.properties,c=j.getSubId(a),g=j.colMap[c],f;if(g&&g._isgroup){f=j.getSubNode("HHANDLER",j.properties.header[g.to]._serialId)}else{f=xui(a)}var l=f.parent(2).width()-j.$px(d._minColW),n=j.getSubNode("SCROLL22"),b=n.offset().left+n.width()-xui.Event.getPos(m).left-4;if(d.disabled){return false}if(g&&g.disabled){return false}f.startDrag(m,{horizontalOnly:true,dragType:"blank",dragDefer:2,maxLeftOffset:l,maxRightOffset:b,targetReposition:false});xui.use(a).parent(2).onMouseout(true,{$force:true}).onMouseup(true)},onDragbegin:function(a,b,c){xui.DragDrop.getProfile().proxyNode.css({height:a.getRoot().height()+"px",width:"4px",backgroundColor:"#DDDDDD",cursor:"e-resize"})},onDrag:function(c,g,l){var j=xui.DragDrop,f=j.getProfile(),a=0;if(f.x<=f.restrictedLeft||f.x>=f.restrictedRight){a=true}if(a){if(!c._limited){f.proxyNode.css("backgroundColor","#ff6600");c._limited=true}}else{if(c._limited){f.proxyNode.css("backgroundColor","#DDDDDD");c._limited=0}}},onDragstop:function(g,n,b){var c=g.properties,d=xui(b).parent(2),r=g.keys,f=g.colMap[g.getSubId(b)],j=d.width(),s=j+xui.DragDrop.getProfile().offset.x,u;if(f){if(f&&f._isgroup){f=g.properties.header[f.to];d=g.getSubNode("HCELL",f._serialId)}if(f.hasOwnProperty("maxWidth")){s=Math.min(g.$px(f.maxWidth),s)}if(f.hasOwnProperty("minWidth")){s=Math.max(g.$px(f.minWidth),s)}}if(g.beforeColResized&&false===g.boxing().beforeColResized(g,f?f.id:null,s)){g._limited=0;return}u=g.$forceu(s);d.width(u);if(f){if(f.flexSize){var u=parseFloat(f.width),m=s/g._relAvailable,q=j/g._relAvailable;f.width=(u/q-u)*m/(1-m)+g.$picku(f.width)}else{f.width=u}f._colWidth=u}var a=[],l=[];if(g.getKey(xui.use(b).parent(2).id())==r.FHCELL){g.box._setRowHanderW(g,s)}else{var A=f._cells,x;xui.each(A,function(e){if(!(x=g.getSubNode(r.CELL,e)).isEmpty()){a.push(x.id())}});g.box._adjusteditorW(g,xui(a).width(u),s)}if(g.afterColResized){g.boxing().afterColResized(g,f?f.id:null,s)}g.getSubNode("SCROLL22").onScroll();g.box._adjustColsWidth(g);g.box._adjustBody(g,"setcol");g._limited=0},onClick:function(){return false},onDblclick:function(j,m,a){var d=j.properties,f=xui.use(a).parent(2),c=j.getSubId(a);col=j.colMap[c];if(col&&col._isgroup){col=j.properties.header[col.to];f=j.getSubNode("HCELL",col._serialId)}if(col&&col.flexSize){return}if(j.getRootNode().clientHeight<=0){return}if(j.getKey(xui.use(a).parent(2).id())==j.keys.FHCELL){j.box._setRowHanderW(j,true);return}var s=col._cells,u=j.getClass("CELLA","-inline"),g,b=[],l=[],q,r;xui.each(s,function(e){g=j.getSubNode("CELLA",e);if(g._nodes.length){b.push(g.get(0));l.push(g.addClass(u).width())}});if(d.treeMode=="infirstcell"&&d.header[0]==col){j.getSubNode("GCELLA",true).each(function(e){l.push(xui(e).addClass(u).width());xui(e).removeClass(u)})}l.push(j.$px(d._minColW));q=parseFloat(Math.max.apply(null,l));if(q>j.$px(d._maxColW)){q=j.$px(d._maxColW)}if(j.beforeColResized&&false===j.boxing().beforeColResized(j,col?col.id:null,q)){return}if(col){if(col.hasOwnProperty("maxWidth")){q=Math.min(j.$px(col.maxWidth),q)}if(col.hasOwnProperty("minWidth")){q=Math.max(j.$px(col.minWidth),q)}}q+=2;r=j.$forceu(q);j.box._adjusteditorW(j,xui(b).parent().width(r),q);f.width(col.width=col._colWidth=r);xui(b).removeClass(u);if(j.afterColResized){j.boxing().afterColResized(j,col.id,q)}j.box._adjustColsWidth(j);j.box._adjustBody(j,"setcol");return false}},FHANDLER:{beforeMousedown:function(d,f,a){if(xui.Event.getBtn(f)!="left"){return}var b=d.properties,l=d.rowMap[d.getSubId(a)],c=xui(a),m=c.parent(3).height()-d.$px(b._minRowH),j=d.getSubNode("SCROLL21"),g=j.offset().top+j.height()-xui.Event.getPos(f).top-4;if(b.disabled||(l&&l.disabled)){return false}c.startDrag(f,{verticalOnly:true,dragType:"blank",dragDefer:2,maxTopOffset:m,maxBottomOffset:g,targetReposition:false});xui.use(a).parent(2).onMouseout(true,{$force:true}).onMouseup(true);if(!l){d.getSubNode("COLLIST").css("visibility","hidden")}},onDragbegin:function(a,b,c){xui.DragDrop.getProfile().proxyNode.css({width:a.getRoot().width()+"px",height:"4px",backgroundColor:"#DDDDDD",cursor:"n-resize"})},onDrag:function(c,g,l){var j=xui.DragDrop,f=j.getProfile(),a=0;if(f.y<=f.restrictedTop||f.y>=f.restrictedBottom){a=true}if(a){if(!c._limited){f.proxyNode.css("backgroundColor","#ff6600");c._limited=true}}else{if(c._limited){f.proxyNode.css("backgroundColor","#DDDDDD");c._limited=0}}},onDragstop:function(f,m,a){var b=f.getSubId(a),d=xui(a).parent(3),l=d.height()+xui.DragDrop.getProfile().offset.y,n=f.rowMap[f.getSubId(a)],c=f.properties,j=c.header,g=c.headerHeight;if(xui.browser.ie&&xui.browser.ver<=8&&l%2==1){l+=1}if(f.beforeRowResized&&false===f.boxing().beforeRowResized(f,n?n.id:null,l)){f._limited=0;return}if(f.getKey(xui.use(a).parent(2).id())==f.keys.FHCELL){c.headerHeight=f.$forceu(l);f.box._adjustColsHeight(f);f.adjustSize()}else{n.height=f.$forceu(l);f.getSubNode("CELLS2",b).height(n.height);d.height(n._rowHeight=n.height);f.box._adjusteditorH(f,d,n._rowHeight)}if(f.afterRowResized){f.boxing().afterRowResized(f,n?n.id:null,l)}f.box._adjustBody(f,"setrow");f._limited=0},onDblclick:function(d,f,j){var l=d.properties,a=d.getSubId(j),g,b;if(d.getRootNode().clientHeight<=0){return}if(a){g=d.rowMap[a];b=d.getSubNodes(["CELLS2","CELLS1"],a);var c=b.height("auto").height();if(d.beforeRowResized&&false===d.boxing().beforeRowResized(d,g.id,c)){return}b.height(g.height=g._rowHeight=d.$forceu(c));d.box._adjusteditorH(d,b,c)}else{var c=(d._headerLayers||0+1)*d.$px(d.box.$DataStruct.headerHeight);if(d.beforeRowResized&&false===d.boxing().beforeRowResized(d,null,c)){return}d.box._adjustColsHeight(d,true);l.headerHeight=d.$forceu(c,d.$picku(l.headerHeight));d.adjustSize()}if(d.afterRowResized){d.boxing().afterRowResized(d,g?g.id:null,c)}d.box._adjustBody(d,"setrow");return false},onClick:function(){return false}},ROWTOGGLE:{onClick:function(b,d,g){var c=b.properties,a,f=b.rowMap[b.getSubId(g)];if(!f){a=b.cellMap[b.getSubId(g)];if(a){f=a._row}}if(!f){return}if(c.disabled||f.disabled){return false}if(!f.sub){return}b.box._setSub(b,f,!f._checked);return false},beforeMousedown:function(){return false}},HSCELLA:{onClick:function(a,b,c){a.getSubNode("HCELLA",a.getSubId(c)).onClick(true)}},HCELLA:{onClick:function(g,m,a){var c=g.properties,b=g.getSubId(a),d=g.colMap[b];if(!d){if(g.onClickGridHandler){g.boxing().onClickGridHandler(g,m,a)}if(c.disabled){return false}if(!c.colSortable){return}}else{if(g.onClickHeader){g.boxing().onClickHeader(g,d,m,a)}if(c.disabled||d.disabled){return false}if(!(d.hasOwnProperty("colSortable")?d.colSortable:c.colSortable)){return}}if(d&&d._isgroup){d=g.properties.header[d.from]}if(g.beforeColSorted&&false===g.boxing().beforeColSorted(g,d)){return false}var j=(d?d._order:g._order)||false,q=(d?d.type:null)||"input",r=d?d.sortby:null,l=d?xui.arr.indexOf(c.header,d):-1,o=arguments.callee,n=o.fun||(o.fun=function(e,F,E,x,M,P,L,K){var I,D,B,O=arguments.callee;if(F){I=F.sub;D=e.getSubNode("SUB1",F._serialId).get(0);B=e.getSubNode("SUB2",F._serialId).get(0)}else{F={_inited:true};I=e.properties.rows;D=e.getSubNode("ROWS21").get(0);B=e.getSubNode("ROWS22").get(0)}var Z=[],X=[],U=[],J,N;var C=[],A=[],Y=[],W=[];xui.arr.each(I,function(aa){if(aa._region==1){return}if(aa.sub&&aa.sub.length>1){O(e,aa,E,x,M,P,null)}Z[Z.length]=E==-1?aa.caption:(J=aa.cells)?(J=J[E])?J.value:"":aa[E];U[U.length]=E==-1?aa:(J=aa.cells)?J[E]:aa[E];X[X.length]=X.length});var R;if(typeof M!="function"){switch(x){case"number":case"spin":case"counter":case"currency":N=function(aa){return parseFloat(aa)||0};break;case"datetime":case"date":N=function(aa){return xui.isDate(aa)?aa.getTime():xui.isFinite(aa)?parseInt(aa,10):0};break;default:N=function(aa){return aa||""}}R=function(aa,ad){var ab=N(Z[aa]),ac=N(Z[ad]);return(ab>ac?(P?1:-1):ab===ac?(aa>ad?-1:1):(P?-1:1))}}else{R=function(aa,ab){return M.apply(e,[aa,ab,Z,P,E,U])}}X.sort(R);var T=F._inited,V=xui.copy(I),S;if(T){C=D.childNodes;A=B.childNodes}xui.arr.each(X,function(ab,aa){I[aa]=V[ab];if(T){Y[aa]=C[ab];W[aa]=A[ab]}});if(T){var H=document.createDocumentFragment(),G=document.createDocumentFragment();for(var Q=0;J=Y[Q];Q++){H.appendChild(J)}for(var Q=0;J=W[Q];Q++){G.appendChild(J)}if(L){D.insertBefore(H,L);B.insertBefore(G,K)}else{D.appendChild(H);B.appendChild(G)}}});var w,u,s;if(g.__hastmpRow){w=g.properties.rows.pop();u=g.getSubNode("ROWS21").get(0).lastChild;s=g.getSubNode("ROWS22").get(0).lastChild}n(g,null,l,q,r,j,u,s);if(g.__hastmpRow){g.properties.rows.push(w)}g.getSubNode("SORT",true).css("display","none");var f=(d?g.getSubNode("SORT",d._serialId):g.getSubNode("SORT")).css("display","");f.tagClass("-checked",d?(!(d._order=!d._order)):(!(g._order=!g._order)));g.box._asy(g);delete g.$allrowscache1;delete g.$allrowscache2;if(g.afterColSorted){g.boxing().afterColSorted(g,d)}},beforeMousedown:function(b,d,j){if(xui.Event.getBtn(d)!="left"){return}var c=b.properties;if(c.disabled){return}var a=b.colMap[b.getSubId(j)];if(!a||a._isgroup){return}if(c.disabled||a.disabled){return false}if(c.treeMode=="infirstcell"&&c.header[0]==a){return false}if(!(a.hasOwnProperty("colMovable")?a.colMovable:c.colMovable)){return}if(false===b.boxing().beforeColDrag(b,a.id)){return}var l=xui.Event.getPos(d),g=xui(j),f=b.getSubId(j);g.startDrag(d,{dragType:"icon",shadowFrom:g.parent(),dragCursor:"pointer",targetLeft:l.left+12,targetTop:l.top+12,targetReposition:false,dragDefer:2,dragKey:b.$xid+":col",dragData:g.parent().id(),tagVar:a._region})},onDragbegin:function(a,b,c){xui(c).parent().onMouseout(true,{$force:true});xui(c).onMouseup(true)},beforeMouseover:function(g,l,a){var c=g.properties,b=g.getSubId(a),d=g.colMap[b];if(!d||d._isgroup){return}if(c.disabled||d.disabled){return false}var j=xui.DragDrop.getProfile();if(!j.dragData||j.dragKey!=g.$xid+":col"){return}if(j.tagVar!=d._region){return}var n=xui.use(a).parent().xid();if(false===g.box._colDragCheck(g,n)){return}xui.DragDrop.setDropElement(a).setDropFace(a,"move");var o=xui.use(n).get(0),f=o.offsetLeft+(d._region==2?g._leftregionw:0),m=o.offsetTop+o.offsetHeight;g.getSubNode("ARROW").left(f).top(m).css("display","block")},beforeMouseout:function(c,f,g){var d=c.properties,l=c.getSubId(g),b=c.colMap[l];if(!b){return}if(d.disabled||b.disabled){return false}var j=xui.DragDrop.getProfile();if(!j.dragData||j.dragKey!=c.$xid+":col"){return}var a=xui.use(g).parent().xid();xui.DragDrop.setDropElement(null).setDropFace(null,"none");if(false===c.box._colDragCheck(c,a)){return}c.getSubNode("ARROW").css("display","none")},onDrop:function(d,D,o){var w=d.properties,u=d.box,x=d.getSubId(o),l=xui.UI.$tag_subId,g=d.colMap[x];if(!g){return}if(w.disabled||g.disabled){return false}var H=xui.use(o).parent().xid();d.getSubNode("ARROW").css("display","none");if(false===u._colDragCheck(d,H)){return}var G=xui.DragDrop.getProfile().dragData,q=G&&d.getSubId(G),s=d.getSubId(H),F=d.colMap,a=F[q],c=F[s];if(false===d.boxing().beforeColMoved(d,a.id,c.id)){return}xui.DragDrop.setDropFace(H,"none");var f=xui.arr.subIndexOf(w.header,"_serialId",q),B=xui.arr.subIndexOf(w.header,"_serialId",s);if(f===B||f===B-1){return}d.getSubNode("HCELL",s).addPrev(xui(xui.DragDrop.getProfile().dragData));xui.each(c._cells,function(j,e){d.getSubNode("CELL",j).addPrev(d.getSubNode("CELL",a._cells[e]))});var E=w.header[f];xui.arr.insertAny(w.header,E,B);xui.arr.removeFrom(w.header,f+(f>B?1:0));var n=d.queryItems(w.rows,true,true);xui.arr.each(n,function(e){e=e.cells?e.cells:e;if(!e||!xui.isArr(e)){return}E=e[f];xui.arr.removeFrom(e,f);xui.arr.insertAny(e,E,B)});var b=w.grpCols;if(b&&xui.isArr(b)&&b.length){for(var C=0,A=b.length,r;C<A;C++){r=b[C];if(r.from>B){r.from++;r.to++}else{if(B>=r.from&&B<=r.to){r.to++}}}for(var C=0,A=b.length,r;C<A;C++){r=b[C];if(r.from>f){r.from--;r.to--}else{if(f>=r.from&&f<=r.to){r.to--}}}xui.filter(b,function(j){var e=j.to>=j.from;if(!e&&d.renderId){d.getSubNodes(["HCELL","HSCELL"],j[l]).remove();delete d.colMap[j[l]];delete d.colMap2[j.id]}return e});w.grpCols=u._adjustGrpColsData(d,b);u._adjustColsWidth(d);u._adjustColsHeight(d)}d.boxing().afterColMoved(d,a.id,c.id);delete d.$allrowscache1;delete d.$allrowscache2},onMouseover:function(f,g,a){var c=f.properties,b=f.getSubId(a),d=f.colMap[b];if(d){if(c.disabled||d.disabled){return false}if(!(d.hasOwnProperty("colHidable")?d.colHidable:c.colHidable)){return}if(!(d.hasOwnProperty("colDroppable")?d.colDroppable:c.colDroppable)){return}}else{if(c.disabled){return false}if(!c.colHidable){return}}xui.resetRun(f.$xid+":collist",null);var l={},j=xui.use(a).parent().offset(null,f.getSubNode("BOX")),m=xui.use(a).parent().cssSize();if(m.width<16){return}l.height=f.$forceu(m.height);l.left=f.$forceu(j.left);l.top=f.$forceu(j.top);f.getSubNode("COLLIST").cssRegion(l).css("visibility","visible")},onMouseout:function(b,d,f){var c=b.properties,g=b.getSubId(f),a=b.colMap[g];if(a){if(c.disabled||a.disabled){return false}if(!(a.hasOwnProperty("colHidable")?a.colHidable:c.colHidable)){return}}else{if(c.disabled){return false}if(!c.colHidable){return}}xui.resetRun(b.$xid+":collist",function(){if(!b.box){return}b.getSubNode("COLLIST").css({visibility:"hidden",left:0+b.$picku(),top:0+b.$picku()})})},onContextmenu:function(b,c,d){if(b.onContextmenu){var a=b.getSubId(d);return b.boxing().onContextmenu(b,c,d,a?b.colMap[a]:null,xui.Event.getPos(c))!==false}}},COLLIST:{onMouseover:function(a,b,c){xui.resetRun(a.$xid+":collist",null)},onMouseout:function(a,b,c){xui.resetRun(a.$xid+":collist",function(){if(!a.box){return}xui.use(c).css("visibility","hidden")})},onClick:function(c,f,g){var d=c.properties;if(!c.$col_pop){var b=[],a;xui.arr.each(c.properties.header,function(e){if(e.hasOwnProperty("colHidable")?e.colHidable:d.colHidable){b.push({id:e.id,caption:e.caption,type:"checkbox",value:e.hidden!==true})}});if(b.length){a=c.$col_pop=new xui.UI.PopMenu({hideAfterClick:false,items:b}).render(true);a.onMenuSelected(function(m,j,l){var e=1;xui.arr.each(m.properties.items,function(n){if(n.value!==false){return e=false}});if(!e){c.boxing().showColumn(j.id,j.value)}else{m.getSubNodeByItemId("CHECKBOX",j.id).tagClass("-checked");j.value=true}})}}if(c.$col_pop){c.$col_pop.pop(g)}}},CELLS2:{afterMouseover:function(b,d,g){var c=b.properties;if(c.disabled){return}if(c.disableHoverEffect===true){return}if(c.disableHoverEffect&&/\bCELLS2\b/.test(c.disableHoverEffect||"")){return}var a=b.getSubId(g);b.getSubNodes(["CELLS1","CELLS2"],a).tagClass("-hover");if(b.onRowHover){var f=b.rowMap[a];b.boxing().onRowHover(b,f,true,d,g)}},afterMouseout:function(b,d,g){var c=b.properties;if(c.disabled){return}if(c.disableHoverEffect===true){return}if(c.disableHoverEffect&&/\bCELLS2\b/.test(c.disableHoverEffect||"")){return}var a=b.getSubId(g);b.getSubNodes(["CELLS1","CELLS2"],a).tagClass("-hover",false);if(b.onRowHover){var f=b.rowMap[a];b.boxing().onRowHover(b,f,false,d,g)}},onDblclick:function(d,f,a){var c=d.properties,m=d.rowMap[d.getSubId(a)],l=xui.Event.getSrc(f),b=l&&(l.id||""),g=d.keys,j=d.getKey(b);while(!j){l=l.offsetParent;j=d.getKey(b=l.id)}if(!m||c.disabled||m.disabled){return false}if(b&&xui.UIProfile.getFromDom(b)!=d){return false}if(j==g.ROWTOGGLE||j==g.MARK){return false}if(d.onDblclickRow){if(m){d.box._activeRow(d,false);d.boxing().setActiveRow(m.id,true)}d.boxing().onDblclickRow(d,m,f,a)}return false},onClick:function(c,f,j){var d=c.properties,a=c.getSubId(j),l=c.keys,g=c.rowMap[a],b=xui.Event.getSrc(f).id||"";if(d.disabled||g.disabled){return false}if(b&&xui.UIProfile.getFromDom(b)!=c){return false}if(c.onClickRow){if(g){c.boxing().setActiveRow(g.id,true)}c.boxing().onClickRow(c,g,f,j);c.boxing().swiperight(c,g,f,j)}}},CELL:{onMouseover:function(c,j,l){if(false==c.box.$cancelHoverEditor(c)){return}var d=c.box,g=c.properties,a=xui.use(l).id(),b;if(g.disableHoverEffect===true){return}if(g.disableHoverEffect&&/\bCELL\b/.test(g.disableHoverEffect||"")){return}a=a.split(":")[2];if(!a){return}a=c.cellMap[a];if(!a){return}if(d.getCellOption(c,a,"disabled")){return}var f=d.getCellOption(c,a,"editMode");if(d.getCellOption(c,a,"editable")&&xui.str.startWith(f,"hover")){if(f=="hoversharp"&&d.getCellOption(c,a,"type")=="file"){}else{xui.resetRun(c.key+":"+c.$xid+":hovereditor",function(){if(c.destroyed){return}c.box._editCell(c,c.getSubId(l),true)});return false}}}},GCELL:{onMouseover:function(a,b,c){a.box.$cancelHoverEditor(a)}},CELLA:{onDblclick:function(c,j,a){var m=c.cellMap[c.getSubId(a)];if(!m){return}if(c.properties.disabled){return}var g=c.box,f=g.getCellOption,l=f(c,m,"type"),d=f(c,m,"disabled"),b=f(c,m,"editable");if(!d&&(!b||(l=="button"||l=="label"))){c.boxing().onDblclickCell(c,m,j,a);if(l=="button"){return false}}},afterMousedown:function(a,b,c){xui.setNodeData(c,"_tmp_forcefocus")},onClick:function(c,x,j){var q=c.properties,m=c.box,A=m.getCellOption,b=c.cellMap[c.getSubId(j)],r;if(b){if(c.properties.disabled){return false}var d=A(c,b,"type"),f=A(c,b,"disabled"),o=A(c,b,"readonly"),u=A(c,b,"event"),n=q.activeMode,s=A(c,b,"editable");if(!f&&(!s||(d=="button"||d=="label"))){if(typeof u=="function"&&false===u.call(c._host||c,c,b,null,null,x,j)){}else{if(c.onClickCell){c.boxing().onClickCell(c,b,x,j)}}if(d=="button"){return false}}if(!f&&!o&&d=="checkbox"){if(s){m._updCell(c,b,!b.value,q.dirtyMark,true,true);c.box._trycheckrowdirty(c,b);var w=b._row.id==c.box._temprowid;if(w){c.__needchecktmprow=true;c.box._sethotrowoutterblur(c)}}}if(!q.editable){if(n=="cell"){if(A(c,b,"disabled")){return false}r=xui(j).parent().id();m._sel(c,"cell",j,r,x)}else{if(n=="row"){if(q.disabled||b._row.disabled){return false}r=xui(j).parent(3).id();m._sel(c,"row",j,r,x)}}}else{if(q.activeMode=="row"){r=xui(j).parent(3).id();m._sel(c,"row",j,r,x)}}}else{var g=c.rowMap[c.getSubId(j)];if(q.disabled||g.disabled){return false}if(c.keys.MARK){var l=c.getKey(xui.Event.getSrc(x).id||""),a=l==c.keys.MARK}if(!a){if(typeof u=="function"&&false===u.call(c._host||c,c,g,null,null,x,j)){}else{if(c.onClickRowHandler){if(g){c.boxing().setActiveRow(g.id)}c.boxing().onClickRowHandler(c,g,x,j)}}if(g.group){c.box._getToggleNode(c,g._serialId).onClick()}}if(q.activeMode=="row"){r=xui(j).parent(3).id();m._sel(c,"row",j,r,x)}}if(c.box){if(xui.use(j).get(0)){if(!xui.getNodeData(j,"_tmp_forcefocus")){c.box._focusEvent(c,x,j)}}}},onFocus:function(a,b,c){xui.setNodeData(c,"_tmp_forcefocus",1);a.box._focusEvent(a,b,c)},onKeydown:function(f,V,B){var X={tab:1,left:1,right:1,up:1,down:1},I=xui.Event.getKey(V),u=I.key;if(u=="enter"){xui(B).onClick();return}if(!X[u]){return}var L=f.cellMap[f.getSubId(B)];if(f.beforeCellKeydown&&false===f.boxing().beforeCellKeydown(f,L,I)){return false}var R=f.properties,K=I.shiftKey,U=I.ctrlKey,j=xui(B),O=f.getSubNode("SCROLL11"),N=f.getSubNode("SCROLL12"),A=f.getSubNode("SCROLL21"),x=f.getSubNode("SCROLL22"),T=new RegExp("^"+f.box.$Keys.CELLA+":"+f.serialId+":"),w=!!N.offsetWidth(),b=!!A.offsetWidth(),a=!!x.offsetHeight(),G=O.nextFocus(true,true,false,T),F=N.nextFocus(true,true,false,T),m=A.nextFocus(true,true,false,T),l=x.nextFocus(true,true,false,T),D=O.nextFocus(false,true,false,T),C=N.nextFocus(false,true,false,T),d=A.nextFocus(false,true,false,T),c=x.nextFocus(false,true,false,T),n=w?b?G:F:b?m:l,s=x?c:N?C:A?d:D,M=j.parent(),H=M.parent().id(),q=f.getSubId(H),o=L?L._row:f.rowMap[f.getSubId(B)],P=o&&o.id==f.box._temprowid,W=L?(L._row._region+""+L._col._region):(o._region+"1"),Q;var E=function(e){if(B!=n.xid()){var Y;if(!M.get(0).previousSibling||!M.get(0).previousSibling.clientWidth){switch(W){case"11":case"21":if(a){if(B==m.xid()){C.focus(true);Y=1}else{var Z=f.getSubNode("ROW2",q).prev();if(Z){Z.nextFocus(false,true,true,T);Y=1}}}break;case"12":case"22":if(b){f.getSubNode("CELLS1",q).last(2).focus(true);Y=1}break}}if(!Y){j.nextFocus(false,false,true,T)}return false}else{if(e){s.focus(true)}}},g=function(e){if(B!=s.xid()){var Y;if(W=="11"||W=="21"?!M.get(0).nextSibling:(!(Q=M.get(0).nextSibling)||!Q.clientWidth)){switch(W){case"11":case"21":if(a){f.getSubNode("CELLS2",q).first(2).focus(true);Y=1}break;case"12":case"22":if(b){if(B==C.xid()){m.focus(true);Y=1}else{var Z=f.getSubNode("ROW1",q).next();if(Z){Z.nextFocus(true,true,true,T);Y=1}}}break}}if(!Y){j.nextFocus(true,false,true,T)}return false}else{if(e){J()}}},r=function(Y){var aa=1,af=j.parent().get(0),ac=af.parentNode.childNodes.length;while(af=af.previousSibling){aa++}af=j.parent(2).get(0);if(!f.$allrowscache2){f.box._cacheRows(f)}var ab=xui.arr.indexOf(W=="12"||W=="22"?f.$allrowscache2:f.$allrowscache1,af),ad=f.$allrowscache2.length,Z=0;if(u=="up"){ab--;if(ab==-1){ab=ad-1;aa--;if(aa==0){aa=ac}}}else{ab++;if(ab==ad){Z=1;ab=0;aa++;if(aa==ac+1){aa=1}}}var e=xui((W=="12"||W=="22"?f.$allrowscache2:f.$allrowscache1)[ab]).first(),ae=e;if(aa>1){ae=ae.next(aa-1)}if(ae.isEmpty()){ae=e}if(ae&&!ae.isEmpty()){ae=ae.first()}if(!ae.isEmpty()){return[ae,Z]}return null},S=function(){var e;if(B!=n.xid()){if(j.get(0)==F.get(0)||j.get(0)==l.get(0)){if(b){e=d}else{e=D}}if(!e){e=r(true)[0]}}else{e=s}if(e){e.focus(true)}},J=function(){var ab,aa;if(B!=s.xid()){if(j.get(0)==D.get(0)||j.get(0)==d.get(0)){if(w){aa=F}else{aa=l}}if(!aa){aa=r();ab=aa[1];aa=aa[0]}}else{aa=n;ab=1}if(ab&&R.hotRowMode!="none"){var e;if(!L){var Z=f.rowMap[f.getSubId(B)];if(!Z){return false}}e=(R.hotRowRequired||"").split(R.valueSeparator)[0]||(L&&L._col&&L._col.id);var Y=true;if(f.__hastmpRow){Y=f.box._checkNewLine(f,"keydown");if(!f.$allrowscache2){f.box._cacheRows(f)}}if(Y){f.box._addTempRow(f,e);return false}}else{if(aa){aa.focus(true)}}};switch(u){case"tab":if(K){if(false===E(P)){return false}}else{if(false===g(P)){return false}}break;case"left":if(false===E(true)){return false}break;case"right":if(false===g(true)){return false}break;case"up":if(U){if(o&&!(R.disabled||o.disabled)&&(o.group||o.sub)){f.box._getToggleNode(f,o._serialId).onClick();return false}}S();return false;break;case"down":if(U){if(o&&!(R.disabled||o.disabled)&&(o.group||o.sub)){f.box._getToggleNode(f,o._serialId).onClick();return false}}J();return false;break}},onContextmenu:function(b,c,d){if(b.onContextmenu){var a=b.getSubId(d);return b.boxing().onContextmenu(b,c,d,a?(b.cellMap[a]||b.rowMap[a]):null,xui.Event.getPos(c))!==false}}},CMD:{onClick:function(a,d,g){var c=a.properties,j=xui.use(g).id().split("_"),b=j[j.length-1];j.pop();var f=a.rowMap[a.getSubId(j.join("_"))];if(c.disabled||(f&&f.disabled)){return false}if(a.onCmd){if(f){a.boxing().setActiveRow(f.id,true)}a.boxing().onCmd(a,f,b,d,g)}return false}}},DataModel:{expression:{ini:"",action:function(){}},directInput:true,listKey:null,currencyTpl:"$ *",numberTpl:"",valueSeparator:";",activeRow:{hidden:true,ini:null},activeCell:{hidden:true,ini:null},rowMap:{hidden:true,ini:null},selMode:{ini:"none",listbox:["single","none","multi","multibycheckbox"],action:function(a){this.getSubNodes(["HFMARK","MARK"],true).css("display",(a=="multi"||a=="multibycheckbox")?"":"none")}},editMode:{ini:"focus",listbox:["focus","sharp","hover","hoversharp","inline"]},dock:"fill",togglePlaceholder:false,isFormField:{hidden:true,ini:false},altRowsBg:{ini:false,action:function(g){var d=this;var c=d.getClass("CELLS1","-alt"),a=d.getSubNode("CELLS1",true),l=d.getSubNode("CELLS2",true),b,f,e;a.removeClass(c);l.removeClass(c);if(g){alt=[];b=0;l.each(function(m,j){if(m.clientHeight){m=xui([m]);f=xui([a.get(j)]);if((b++)%2==1){if(!f.hasClass(c)){f.addClass(c)}if(!m.hasClass(c)){m.addClass(c)}}else{if(f.hasClass(c)){f.removeClass(c)}if(m.hasClass(c)){m.removeClass(c)}}}})}}},rowNumbered:{ini:false,action:function(o){var n=this,j=n.CF.getNumberedStr||function(f){return f},c=n.getSubNode("ROWNUM",true),g=0,b=n.rowMap,u,m=0,e=0,d=[],a=[],s="",q,r;c.css("display",o?"":"none");if(o){c.each(function(f){if(u=b[n.getSubId(f.id)]){e=u._layer;if(e>m){d.push(g);a.push(s);s=s+g+".";g=0}else{if(e<m){while(e<m--){g=d.pop();s=a.pop()}}}g++;m=e;u._autoNumber=j(s+g);q=u.rowNumber||u._autoNumber;if(r=f.firstChild){if(r.nodeValue!=q){r.nodeValue=q}}else{f.appendChild(document.createTextNode(q))}}})}else{c.text("")}}},editable:false,firstCellEditable:false,$subMargin:"1.375em",iniFold:true,animCollapse:false,position:"absolute",width:"25em",height:"18em",_minColW:".5em",_maxColW:"25em",_minRowH:"1.83333em",gridHandlerCaption:{ini:"",action:function(a){a=(xui.isSet(a)?a:"")+"";this.getSubNode("GRIDCAPTION").html(xui.adjustRes(a,true))}},headerTail:{ini:"",action:function(a){a=(xui.isSet(a)?a:"")+"";this.getSubNode("LHCELLINNER").html(xui.adjustRes(a,true))}},rowHandlerWidth:{$spaceunit:1,ini:"5em",set:function(a){var b=this;if(b.renderId){b.box._setRowHanderW(b,a)}else{b.properties.rowHandlerWidth=a}}},showHeader:{ini:true,action:function(a){this.getSubNodes(["HEADER1","HEADER2"]).css("display",a?"":"none")}},headerHeight:{$spaceunit:1,ini:"2em",action:function(a){var b=this,c=b.properties;b.box._adjustColsHeight(b);b.adjustSize()}},rowHeight:{$spaceunit:1,ini:"2em",action:function(a){this.box._adjusteditorH(this,this.getSubNodes(["CELLS1","CELLS2"],true).height(a),a)}},_colDfWidth:"8em",rowHandler:{ini:true,action:function(a){this.getSubNode("FHCELL").css("display",a?"":"none");this.getSubNode("FCELL",true).css("display",a?"":"none");this.box._adjustColsWidth(this);this.box._adjustBody(this,"rowhandler")}},rowResizer:{ini:false,action:function(a){this.getSubNode("FHANDLER",true).css("display",a?"":"none")}},colHidable:false,colResizer:{ini:true,action:function(a){this.getSubNode("HHANDLER",true).css("display",a?"":"none")}},colSortable:{ini:true,action:function(a){if(!a){this.getSubNode("SORT",true).css("display","none")}}},colMovable:false,header:{ini:{},set:function(a){var b=this;if(b.renderId){b.boxing()._refreshHeader(a)}else{b.properties.header=xui.copy(a)}}},uidColumn:"",grpCols:{ini:{},set:function(a){var b=this;b.properties.grpCols=xui.copy(a);if(b.renderId){b.boxing()._refreshHeader(xui.clone(b.properties.header,false,2))}}},rows:{ini:{},set:function(a){var b=this;if(b.renderId){b.boxing().removeAllRows(false).insertRows(a)}else{b.properties.rows=xui.copy(a)}}},rawData:{ini:[],set:function(q){if(!q||!xui.isArr(q)||!q.length){return}var a=this,n={},g=[],r=[],f,d,b=q.length,e;for(f=0;f<b;f++){if(!xui.isHash(e=q[f])){return}for(var c in e){if(!(c in n)){n[c]=[]}n[c][f]=e[c]}}d=0;for(var c in n){g.push(c);for(f=0;f<b;f++){if(!r[f]){r[f]=[]}r[f][d]=n[c][f]}d++}var m=a.boxing();if(m.getHeader("min").join(";")!=g.join(";")){m.setHeader(g)}m.setRows(r)},get:function(f,d){var n=this,e=n.properties,u=e.header,A=this.box._temprowid,q=f&&f.cells&&xui.isArr(f.cells),g=q?[f]:xui.isArr(f)&&f[0]&&f[0].cells&&xui.isArr(f[0].cells)?f:e.rows,r=u.length,x=g.length,c=[],b,C,m,B=[];if(x){for(var w=0;w<r;w++){c.push(u[w].id)}for(var s=0;s<x;s++){if(!q&&g[s].id==A){continue}if(g[s].group||!g[s].cells){continue}var a={};for(var w=0;w<r;w++){C=c[w];b=g[s].cells[w];if(d&&C.indexOf(":")!=-1){m=C.split(":");a[m[0]]=("value" in b)?b.value:b;a[m[1]]=("caption" in b)?b.caption:null}else{a[C.split(":")[0]]=("value" in b)?b.value:b}}B.push(a)}}return q?B[0]:B}},dataset:{ini:{},get:function(){var b=this,a=b.boxing(),c=b.properties;return{name:c.gridHandlerCaption,dimensions:a.getHeader("min"),source:a.getRows("min")}},set:function(a){var c=this,b=c.boxing(),e=c.properties;var d=xui.isFun(a.getDataset)?a.getDataset():a;if((a=e.tagVar.datasetAdapter)&&xui.isFun(a)){d=a.call(b,d,c)}if((a=b.datasetAdapter)&&xui.isFun(a)){d=a.call(b,d,c)}if(b.beforeApplyDataset&&false===b.beforeApplyDataset(c,d)){}else{if("name" in d){b.setGridHandlerCaption(d.name)}if("dimensions" in d){b.setHeader(d.dimensions)}if("source" in d){b.setRows(d.source)}}}},tagCmds:{ini:[],action:function(){this.boxing().refresh()}},activeMode:{ini:"row",listbox:["row","cell","none"],action:function(b){var a=this;if(b!="cell"&&a.$activeCell){xui(a.$activeCell).tagClass("-active",false);delete a.$activeCell}if(b!="row"&&a.$activeRow){xui(a.$activeRow).tagClass("-active",false);delete a.$activeRow}}},rowOptions:{ini:{},action:function(c){var a=this.boxing(),b=a.getRows("data");a.removeAllRows();a.insertRows(b)}},colOptions:{ini:{},action:function(c){var a=this.boxing(),b=a.getRows("data");a.removeAllRows();a.insertRows(b)}},treeMode:{ini:"inhandler",listbox:["none","inhandler","infirstcell"],action:function(a,b){if((b=="inhandler"&&a=="infirstcell")||(b=="infirstcell"&&a=="inhandler")){this.boxing().refresh()}else{this.getSubNodes(["ROWLRULER","ROWTOGGLE"],true).css("display",a?"":"none")}}},freezedColumn:{ini:0,action:function(){this.boxing().refresh();this.box._adjustColsWidth(this)}},freezedRow:{ini:0,action:function(){this.boxing().refresh()}},hotRowMode:{ini:"none",listbox:["none","show","hide","auto"],action:function(a){if(this.renderId){if(a=="none"){this.boxing().removeHotRow()}else{this.box.__ensurehotrow(this,null)}}}},excelCellId:{ini:"",action:function(){this.boxing().notifyExcel(false)}},gridValueFormula:"",hotRowNumber:"[*]",hotRowCellCap:"(*)",hotRowRequired:"",noCtrlKey:true},EventHandlers:{onBodyLayout:function(b,a){},beforeApplyDataset:function(a,b){},beforeCellKeydown:function(b,a,c){},afterCellFocused:function(b,a,c){},beforeInitHotRow:function(a){},onInitHotRow:function(a,b){},beforeHotRowAdded:function(c,a,d,b){},afterHotRowAdded:function(a,b){},onGetContent:function(a,b,c){},onRowSelected:function(b,f,c,d,a){},onCmd:function(a,f,c,b,d){},beforeFold:function(a,b){},beforeExpand:function(a,b){},afterFold:function(a,b){},afterExpand:function(a,b){},beforeColDrag:function(a,b){},beforeColMoved:function(b,c,a){},afterColMoved:function(b,c,a){},beforeColSorted:function(b,a){},afterColSorted:function(b,a){},beforeColShowHide:function(b,c,a){},afterColShowHide:function(b,c,a){},beforeColResized:function(b,c,a){},afterColResized:function(b,c,a){},beforeRowResized:function(b,c,a){},afterRowResized:function(b,c,a){},swiperight:function(a,d,b,c){},swipeup:function(a,b,c,d){},swipedown:function(a,b,c,d){},beforePrepareRow:function(b,c,a){},beforePrepareCol:function(b,a){},beforeRowActive:function(a,b){},afterRowActive:function(a,b){},beforeCellActive:function(b,a){},afterCellActive:function(b,a){},beforeCellUpdated:function(c,a,b,d){},afterCellUpdated:function(c,a,b,d){},beforeRowUpdated:function(b,c,a,d){},afterRowUpdated:function(b,c,a,d){},onRowDirtied:function(a,b){},onRowHover:function(b,f,a,c,d){},onClickHeader:function(b,a,c,d){},onClickRow:function(a,d,b,c){},onClickRowHandler:function(a,d,b,c){},onDblclickRow:function(a,d,b,c){},onClickCell:function(b,a,c,d){},onDblclickCell:function(b,a,c,d){},onClickGridHandler:function(a,b,c){},beforeIniEditor:function(e,a,b,c,d){},onBeginEdit:function(d,a,c,b){},beforeEditApply:function(f,b,c,e,a,d){},onEndEdit:function(d,a,c,b){},onFileDlgOpen:function(c,b,a,d){},beforeComboPop:function(c,b,a,g,d,f){},beforePopShow:function(d,b,a,e,c){},afterPopShow:function(c,b,a,d){},onCommand:function(d,b,a,e,c){},onEditorClick:function(d,b,a,c,e){},beforeUnitUpdated:function(d,b,a,c){},beforeApplyFormula:function(b,a,c,d){},afterApplyFormulas:function(b,a){},beforeGridValueCalculated:function(a){},afterGridValueCalculated:function(a,b){},onGetExcelCellValue:function(b,a,c){}},RenderTrigger:function(){var b=this,c=b.box,e=b.properties,a=b.boxing(),d=c.getCellOption;b.destroyTrigger=function(){var f=this,g=f.properties;xui.each(f.cellMap,function(j){if(j._editor){j._editor.destroy()}});xui.breakO([f.colMap,f.rowMap,f.cellMap],3);g.header.length=0;g.rows.length=0;g.grpCols.length=0};b.$cache_editor={};if(!e.iniFold){a._toggleRows(e.rows,true)}xui.arr.each(e.header,function(f){if(xui.isFun(f.colRenderer||e.colOptions.colRenderer)){(f.colRenderer||e.colOptions.colRenderer).call(null,b,f)}});if(e.treeMode=="infirstcell"){b.getSubNode("HCELLA",e.header[0]._serialId).prepend(b.getSubNode("LTAGCMDS")).prepend(b.getSubNode("HFMARK"))}xui.arr.each(e.rows,function(f){if(xui.isFun(f.rowRenderer||e.rowOptions.rowRenderer)){(f.rowRenderer||e.rowOptions.rowRenderer).call(null,b,f)}if(false===d(b,f,"iniFold")){a._toggleRows([f],true)}});b.box.__ensurehotrow(b,null);xui.each(b.cellMap,function(f){if(d(b,f,"editable")&&(d(b,f,"editMode")=="inline"||d(b,f,"type")=="dropbutton")){c._editCell(b,f)}});if(e.excelCellId){b.boxing().calculateGridValue()}},LayoutTrigger:function(){var b=this,c=b.box,d=b.properties,a=b.boxing();if(xui.isArr(d.grpCols)){xui.arr.each(d.grpCols,function(e){if(xui.isFun(e.colRenderer||d.colOptions.colRenderer)){(e.colRenderer||d.colOptions.colRenderer).call(null,b,e)}});c._adjustColsHeight(b)}b.box._asy(b);b.box._adjustBody(b,"render")},_tplMap:{text:".text",button:".button",image:".image"},_tplMap2:{textarea:".textarea",checkbox:".checkbox",button:".button",progress:".progress"},_focusEvent:function(c,d,g){var b=c.boxing(),j=c.properties,a=c.cellMap[c.getSubId(g)],f;c.box._focuscell(c,d,g);if(c.afterCellFocused){if(a){f=a._row}else{f=c.rowMap[c.getSubId(g)]}b.afterCellFocused(c,a,f)}if(j.hotRowMode!="none"){var a=c.cellMap[c.getSubId(g)],f;if(a){f=a._row}else{f=c.rowMap[c.getSubId(g)]}if(c.__hastmpRow&&c.__needchecktmprow&&f.id!==c.box._temprowid){c.box._checkNewLine(c,"focuscell")}}},_tagCmdWidth:function(a){var c=a.properties;var b=0;if(c.tagCmds){xui.arr.each(c.tagCmds,function(d){if(d.tagCmdsAlign&&d.tagCmdsAlign!="left"){switch(d.buttonType){case"button":b=b+2;break;case"image":b=b+2;break;case"text":b=b+d.text?d.text.length:1;break}}})}return b},_haderTail:function(a){var d=a.properties;var c="操作";if(!d.tagCmds){var b=false;xui.arr.each(d.tagCmds,function(e){if(e.tagCmdsAlign&&e.tagCmdsAlign!="left"){var f=true}});if(b){c=d.headerTail?d.headerTail:"操作"}else{c=""}}else{c=""}return c},__ensurehotrow:function(c,a){var f=c.properties,d=c.box,b=false;if(!d||!c.renderId||f.hotRowMode=="none"){return}if(c.__hastmpRow){var e=c.properties.rows;if(e.length===0||e[e.length-1].id!=c.box._temprowid){b=true}}else{b=true}if(b){switch(f.hotRowMode){case"auto":if(!f.rows||f.rows.length===0){d._addTempRow(c,a)}break;case"show":d._addTempRow(c,a);break}}},_temprowid:"_ r _temp_",isHotRow:function(a){return a&&(a.id||a)===this._temprowid},_addTempRow:function(e,b){var j=e.properties;if(j.readonly||j.disabled||!j.header||j.header.length<=0){return false}e.box._sethotrowoutterblur(e,true);delete e.__hastmpRow;e.boxing().removeRows([this._temprowid],false);if(e.beforeInitHotRow&&false===e.boxing().beforeInitHotRow(e)){return false}e.__needchecktmprow=true;var d={},g={cells:d},f=(j.hotRowRequired||"").split(j.valueSeparator),a={caption:j.hotRowCellCap},c=e.boxing();if(f.length){xui.arr.each(j.header,function(l,m){if(xui.arr.indexOf(f,l.id)!=-1){d[l.id]=a}else{if(xui.isSet(l.defaultValue)){d[l.id]=l.defaultValue}}})}if(e.onInitHotRow){g=c.onInitHotRow(e,g)||g}if(xui.isArr(g)){g={cells:g}}else{if(!xui.isHash(g)){g={cells:[g]}}}g.id=this._temprowid;g.rowNumber=j.hotRowNumber;g.rowClass=e.getClass("CELLS2","-hot");c.insertRows([g],null,null,false,false);e.__hastmpRow=true;if(b!==null){c.focusCellbyRowCol(g.id,b||j.header[0].id);e.box._sethotrowoutterblur(e)}},_checkNewLine:function(f,c){var a=f.properties;f.box._sethotrowoutterblur(f,true);if(!f.__hastmpRow){return}delete f.__needchecktmprow;var q=f.boxing(),e=this._temprowid,r=a.hotRowRequired&&a.hotRowRequired.split(a.valueSeparator),m=q.getRowbyRowId(e,"map",true),u=!!c;if(!m){return}if(r&&r.length){for(var o=0,n,s,g=r.length;o<g;o++){n=xui.arr.subIndexOf(a.header,"id",r[o]);if(n!=-1&&!(xui.isHash(s=m[r[o].split(":")[0]])?s.value:s)){u=null;break}}}var b=q.getRowbyRowId(e,"data",true);delete b.id;delete b.rowClass;delete b.rowNumber;xui.arr.each(b.cells,function(j){if(j.id.indexOf("-c_")==0){delete j.id}if(j.caption===a.hotRowCellCap){delete j.caption}});if(f.beforeHotRowAdded){var d=q.beforeHotRowAdded(f,m,b,!c);if(xui.isDefined(d)){u=d===true?d:d===false?d:null}}if(u===null){if(a.hotRowMode=="hide"||a.hotRowMode=="auto"){f.box._sethotrowoutterblur(f)}return false}else{if(u===false){if(a.hotRowMode=="hide"||a.hotRowMode=="auto"){delete f.__hastmpRow;q.removeRows([e],false);if(a.rows.length===0&&a.hotRowMode=="auto"){this._addTempRow(f,null)}}return false}else{if(u===true){delete f.__hastmpRow;q.removeRows([e],false);q.insertRows(b,null,null,false,true);m=a.rows[a.rows.length-1];m._dirty=1;if(f.afterHotRowAdded){q.afterHotRowAdded(f,m)}if(a.hotRowMode=="show"){if(!f.__hastmpRow){this._addTempRow(f,null)}}return true}else{f.__needchecktmprow=true;if(xui.isHash(u)){q.focusCell(u)}else{q.focusCell(q.getCell(u))}f.box._sethotrowoutterblur(f);return false}}}},_sethotrowoutterblur:function(b,a){var c=function(d){return b.getSubNode(d).get(0)};b.getSubNode("ROWS22").setBlurTrigger(b.$domId+":ROWS22",a?null:function(j,g){var f=xui.Event.getSrc(g),d=f==c("SCROLL11")||f==c("SCROLL12")||f==c("SCROLL21")||f==c("SCROLL22")?"focusin":"focusout";b.__tmpRowBlurTrigger=xui.asyRun(function(){if(!b.box){return}b.box._checkNewLine(b,d)})},xui([c("ROWS11"),c("ROWS12"),c("ROWS21"),c("ROWS22")]),null,true);if(a){if(b.__tmpRowBlurTrigger){xui.clearTimeout(b.__tmpRowBlurTrigger);delete b.__tmpRowBlurTrigger}}},_cacheRows:function(c){var b=c.getSubNodes("CELLS1",true).get(),a=c.getSubNodes("CELLS2",true).get();xui.filter(b,function(d){return !!d.clientHeight});xui.filter(a,function(d){return !!d.clientHeight});c.$allrowscache1=b;c.$allrowscache2=a},_asy:function(c){var e=c.properties,a=c.boxing(),d=c.$xid;if(e.altRowsBg){xui.resetRun(d+"1",function(){if(c.rowMap){a.setAltRowsBg(true,true)}})}if(e.rowNumbered){xui.resetRun(d+"2",function(){if(c.rowMap){a.setRowNumbered(true,true)}})}},_setRowHanderW:function(d,g){var a=d.properties,e=d._$subMargin||(d._$subMargin=d.$px(a.$subMargin)),b=d.rowMap,j=d.getSubNode("FHCELL"),c,l;if(xui.isFinite(g)||d.$isEm(g)||d.$isPx(g)){l=d.$forceu(g)}else{if(g===true){var f=[],m;d.getSubNode("FCELLCAPTION",true).each(function(n){if((m=n.parentNode).parentNode.offsetHeight>0&&xui.Dom.getStyle(m,"overflow")!="visible"){if(c=b[d.getSubId(n.id)]){f.push(xui([n]).width()+c._layer*e)}}});f.push(d.$px(a._minColW));l=d.$forceu(Math.max.apply(null,f)+e*2)}else{l=d.$forceu(j.width())}}if(l){if(d.$px(l)<d.$px(a._minColW)){l=d.$em(a._minColW)+"em"}if(d.$px(l)<=0){return}if(a.rowHandlerWidth!=l){j.width(a.rowHandlerWidth=l);d.getSubNode("FCELL",true).width(l);d.getSubNode("GCELL",true).width(l);d.box._adjustColsWidth(d);d.box._adjustBody(d,"rowhandler")}}},_onStartDrag:function(a,b,d){var c=a.rowMap[a.getSubId(d)];if(c&&c.id==a.box._temprowid){return false}var f=xui.Event.getPos(b);a.$_ond=d;xui.use(d).startDrag(b,{dragSource:a.$xid,dragType:"icon",shadowFrom:xui.use(d).parent()._get(0),targetLeft:f.left+12,targetTop:f.top+12,dragCursor:"pointer",dragDefer:2,dragKey:a.box.getDragKey(a,d),dragData:a.box.getDragData(a,b,d)});return false},_onDropTest:function(b,j,a,n,g,q){var c=g&&g.domId,f=a,l=g&&g.profile,o;if(f){var d=b.getKey(f),m=b.keys,r=b.rowMap[b.getSubId(f)];if(d==m.FCELL&&!r.sub){return false}if(b.properties.rowHandler){if(d==m.CELLS2||d==m.SCROLL22){return false}}else{if(d==m.CELLS1||d==m.SCROLL21){return false}}}if(l&&l.$xid==b.$xid){if(c&&b.getSubId(c)==b.getSubId(f)){return false}o=b.$_ond;a=xui(a).get(0);if(xui.get(a,["parentNode","previousSibling"])==o){return false}do{if(a==o){a=o=null;return false}}while(a&&(a=a.parentNode)&&a!==document&&a!==window);a=o=null}},_onDragstop:function(b,f,g,a,d,c){delete b.$_ond},_onDrop:function(g,o,d,s,m,w){if(!m.profile||!m.profile[g.KEY]){return}var l=g.getKey(d),f=m.profile,c=m.domId,j,r=g.keys,u=xui.absObj.$specialChars,q=g.boxing(),n=xui.copy(q.getUIValue(true)),a=f.rowMap[f.getSubId(c)],x=g.rowMap[g.getSubId(d)];a=xui.clone(a,function(e,b){return !u[(b+"").charAt(0)]});f.boxing().removeRows([a.id]);if(l==r.SCROLL21||l==r.SCROLL22){q.insertRows([a],null,null,false)}else{if((l==r.FCELL)&&x.sub){q.insertRows([a],x.id,null,false)}else{if(l==r.CELLS1||l==r.CELLS2){q.insertRows([a],x._pid,x.id,true)}}}if(n&&n.length){if(xui.arr.indexOf(n,a.id)!=-1){q.setUIValue(n,true,null,"drop")}}m._new=a;return false},_beforeSerialized:function(c){var g=arguments.callee.upper.call(this,c),a=c.properties,f=xui.absObj.$specialChars,j=g.properties,e=xui.$us(c),d=e==2?"em":e==-2?"px":null,b;j.header=xui.clone(a.header,function(q,l,n,m){if(n===2&&l==="width"&&q&&q!="auto"){m[l]=c.$forceu(q,d);return false}else{return !f[((n===1?q.id:l)+"").charAt(0)]&&q!=undefined}});j.grpCols=xui.clone(a.grpCols,function(n,l,m){if(m===2&&l==="width"&&n&&n!="auto"){h[l]=c.$forceu(n,d);return false}else{return !f[((m===1?n.id:l)+"").charAt(0)]&&n!=undefined}});j.rows=xui.clone(a.rows,function(n,l,m){if(m===2&&l==="height"&&n&&n!="auto"){h[l]=c.$forceu(n,d);return false}else{return !f[((m===1?n.id:l)+"").charAt(0)]&&n!=undefined&&((l=="id"&&typeof(n)=="string")?n.charAt(0)!="-":true)}});if(xui.isEmpty(j.header)){delete j.header}if(xui.isEmpty(j.grpCols)){delete j.grpCols}if(xui.isEmpty(j.rows)){delete j.rows}delete j.activeRow;delete j.activeCell;delete j.rawData;delete j.dataset;return g},_clsCache:{},_colDragCheck:function(d,g){var f=d.properties,a=xui.DragDrop.getProfile(),c=a.dragKey,e=a.dragData,b=d.colMap[d.getSubId(g)];if(!b||b._isgroup){return false}if(f.treeMode=="infirstcell"&&f.header[0]==b){return false}if(!(b.hasOwnProperty("colMovable")?b.colMovable:d.properties.colMovable)){return false}if(!c||!e||c!=(d.$xid+":col")){return false}if(e==xui.use(g).id()||e==xui.use(g).prev().id()){return false}},_prepareData:function(a){var b=arguments.callee.upper.call(this,a),c="display:none",d=a.properties;a.rowMap2={};a.rowMap={};a.cellMap={};b.showHeader=d.showHeader?"":c;b.colDDDisplay=d.colResizer?"":c;b.rowDDDisplay=d.rowResizer?"":c;b.rowHandlerDisplay=d.rowHandler?"":c;b.sortDisplay=c;b._rowMarkDisplay=(d.selMode=="multi"||d.selMode=="multibycheckbox")?"":"display:none;";if(!d.header||!xui.isArr(d.header)){d.header=[]}if(!d.grpCols||!xui.isArr(d.grpCols)){d.grpCols=[]}if(!d.rows||!xui.isArr(d.rows)){d.rows=[]}b.tagCmdWidth=this._tagCmdWidth(a);b.haderTail=this._haderTail(a);d.header=this._adjustHeader(d.header);b.header=this._prepareHeader(a,d.header);b.header1=b.header2=b.header;d.grpCols=this._adjustGrpColsData(a,d.grpCols);b.grpCols=this._prepareGrpCols(a,d.grpCols,b.header);b.grpCols1=b.grpCols2=b.grpCols;b._row0DfW=b.rowHandlerWidth?("width:"+a.$forceu(b.rowHandlerWidth)):"";if(a.$isEm(d.headerHeight)){b.headerHeight=a.$forceu(a.$px(d.headerHeight,0,true),"em")}if(a.$isEm(d.rowHeight)){b.rowHeight=a.$forceu(a.$px(d.rowHeight,0,true),"em")}if(a.$isEm(d.rowHandlerWidth)){b.headerHeight=a.$forceu(a.$px(d.rowHandlerWidth,0,true),"em")}arguments.callee.upper.call(this,a);d.rows=this._adjustRows(a,d.rows);b.rows11=b.rows12=b.rows21=b.rows22=this._prepareItems(a,d.rows);b.tagCmds=xui.clone(d.colOptions.tagCmds||b.tagCmds);if(b.tagCmds){this._prepareCmds(a,b,function(e){var f=e.pos||e.tag;return !f||f!="row"})}b._columnfreezed=d.freezedColumn?"xui-ui-shadow-r xui-uiborder-r xui-uiborder-dark":"";b._rowfreezed=d.freezedRow?"xui-ui-shadow-b xui-uiborder-b xui-uiborder-dark":"";return b},_parepareCol:function(f,d,q,l){var c=xui.UI.$tag_subId,b=f.properties,g=f.$px(b.headerHeight),j=f.getRoot().contentBox()?2:0,o="display:none",s,r=1,m,e,n;if(!xui.isHash(d)){e=d+"";d={id:e}}else{e=d.id+""}d._cells={};s=f.pickSubId("header");d[c]="-h_"+s;d.id=d.id||s;while((m=xui.arr.subIndexOf(q,"id",d.id))!=-1&&m!==l){d.id=s+(r++)}f.colMap[d[c]]=d;var a=f.$px(d.width)||f.$px(b._colDfWidth);if("relWidth" in d){d.flexSize=d.relWidth;delete d.relWidth}if(!d.flexSize){if(d.hasOwnProperty("minWidth")){a=Math.max(a,f.$px(d.minWidth))}if(d.hasOwnProperty("maxWidth")){a=Math.min(a,f.$px(d.minWidth))}}d.width=d._cellWidth=d._colWidth=f.$forceu(a);d._hcellheight=f.$forceu(g-j);n={sortDisplay:o,rowHandlerDisplay:b.rowHandler?"":o};n[c]=d[c];n._tabindex=b.tabindex;n.colDDDisplay=(("colResizer" in d)?d.colResizer:b.colResizer)?"":o;if(d.hasOwnProperty("visibility")&&!d.hasOwnProperty("hidden")){d.hidden=!d.visibility}n.colDisplay=d.hidden===true?o:"";n.firstCellStyle=b.colOptions.firstCellStyle||"";n.firstCellClass=b.colOptions.firstCellClass||"";n.enumClass=d.enumClass;if(!d.type){d.type=b.colOptions.type||"input"}if(!(("caption" in d)&&xui.isDefined(d.caption))){d.caption=e}xui.UI.adjustData(f,d,n,"sub");f.colMap2[d.id]=d[c];return[d,n]},_prepareCell:function(e,m,o,d,n,c,f){var l=this,b=xui.UI.$tag_subId,a=e.properties,j="display:none",g={};m=xui.isSet(m)?xui.isHash(m)?m:{value:m}:{};m._row=o;m._col=d;m[b]="-c_"+e.pickSubId("cell");m.id=m.id||m[b];l._adjustCell(e,m,g);e.cellMap[g[b]]=m;if(n){n.push(m)}o._cells[d.id]=g[b];d._cells[o.id]=g[b];if(a.treeMode=="infirstcell"&&f===0&&c){g._treeMode=c._treeMode;g._rulerW=c._rulerW;g._fi_togglemark=c._fi_togglemark;g._rowMarkDisplay=c._rowMarkDisplay;g._rowNumbDisplay=c._rowNumbDisplay;g._ltagDisplay=c._ltagDisplay;g.ltagCmds=c.ltagCmds;g[xui.UI.$tag_subId_c]=c[xui.UI.$tag_subId]}return[m,g]},_prepareGrpCols:function(e,a,b){var d=e.properties;if(d.showHeader&&a&&xui.isArr(a)&&a.length){var H=d.header,F=e.$px(d.headerHeight),c=e.getRoot().contentBox()?2:0,f=xui.UI.$tag_subId,q="display:none",l=[],u,r,I,J,s,K=e._headerLayers,I=F/(K+1),G=false;for(var E=0,C=a.length,g;E<C;E++){u={};r=0;G=false;J=0;g=a[E];xui.UI.adjustData(e,g,u,"sub");for(var D=0,A;D<=g.to;D++){A=H[D];x=b[D];s=e.$px(x._colWidth);if(D===g.from){G=true;u._hcellleft=e.$forceu(J)}J+=s+c;if(G&&!A.hidden){r+=s+c}}u._colWidth=u._cellWidth=e.$forceu(r-c);u._hcellheight=e.$forceu(I-c);u._hcelltop=e.$forceu(I*(g._layer-1));u._tabindex=d.tabindex;u.colDDDisplay=(("colResizer" in g)?g.colResizer:d.colResizer)?"":q;l.push(u)}for(var D=0,B=H.length,A,x;D<B;D++){A=H[D];x=b[D];if(A._grp&&A._grp.length){x._hcellheight=e.$forceu(F-A._grp.length*I-c)}}return l}},_prepareHeader:function(b,a){var e=[],c,d=b.properties;b.colMap2={};b.colMap={};xui.arr.each(a,function(g,f){if(b.beforePrepareCol&&false===b.boxing().beforePrepareCol(b,g)){return}c=b.box._parepareCol(b,g,a,f);a[f]=c[0];e.push(c[1])});return e},_renderCell:function(e,b,j,E,f){var H,n=["input","password","combobox","checkbox","listbox","file","getter","helpinput","button","dropbutton","cmdbox","cmd","popbox","textarea","label","date","profile","image","text","time","datetime","color","spin","counter","currency","number","split"];if(b._col&&b._col.type){H=b._col.type}var L=e.box.getCellOption,g=L(e,b,"type");if(xui.arr.indexOf(n,g)==-1){g=H}var q="",o="",I,l=E,F=j&&xui.isStr(j._caption)?j._caption:j&&xui.isStr(b.caption)?j.caption:xui.isStr(b.caption)?b.caption:null,J=/</g,M="xui-uicell-disabled",a="xui-ui-readonly",d=function(P,c,R,O,Q){return((Q=c.renderer||c._renderer)?xui.UI._applyRenderer(P,Q,c,R):(R&&typeof R.caption=="string")?R.caption:typeof O=="function"?O(c.value,P,c):(xui.isSet(c.value)?(""+c.value):""))||""},G=function(O,P,c){return O?xui.Date.getText(O,L(P,c,"dateEditorTpl")||"ymdhn"):""},D=function(O,P,c){return O?xui.Date.getText(O,L(P,c,"dateEditorTpl")||"ymd"):""},C=function(c){return c?(c+"").replace(J,"&lt;").replace(/\t/g,"    ").replace(/(\r\n|\n|\r)/g,"<br />"):""},B=function(c){return(c||c===0)?((c*100).toFixed(2)+"%"):""},A=function(O,P,c){if(O||O===0){return xui.formatNumeric(parseFloat(O),L(P,c,"precision"),L(P,c,"groupingSeparator"),L(P,c,"decimalSeparator"),L(P,c,"forceFillZero"),L(P,c,"trimTailZero"))}else{return""}},x=function(P,Q,c){if(P||P===0){var O=L(Q,c,"precision");return xui.formatNumeric(parseFloat(P),xui.isSet(O)?O:2,L(Q,c,"groupingSeparator"),L(Q,c,"decimalSeparator"),L(Q,c,"forceFillZero"),L(Q,c,"trimTailZero"))}else{return""}},w=function(P,S,c){var R=L(S,c,"editorListItems");if(!R){if(R=L(S,c,"editorListKey")){R=xui.UI.getCachedData(typeof(R)=="function"?R():R)}}if((typeof(R)=="function"?(R=R()):R)&&R.length){for(var Q=0,O=R.length;Q<O;Q++){if(R[Q].id===P){return R[Q].caption||P}}}return u(P,S,c)},u=function(O,Q,c){if(O){O=O+"";var P=O.indexOf("=");if(P!=-1){c.value=O.substr(0,P);return O.substr(P+1)}}return O},s=function(O,c){return O+(c.unit?" "+c.unit:"")};if(E&&E.get(0)){E=E.last()}switch(g){case"counter":var r=parseFloat(b.value);b.value=(r||r===0)?r:null;I=s(F||d(e,b,j,A),b);var N=L(e,b,"numberTpl");if(N&&I){I=N.replace("*",I)}if(E){E.html(I,false)}break;case"currency":var r=parseFloat((b.value+"").replace(/[^\d.-]/g,""));b.value=(r||r===0)?r:null;I=s(F||d(e,b,j,x),b);var N=L(e,b,"currencyTpl");if(N&&I!==""){I=N.replace("*",I)}if(E){E.html(I,false)}break;case"date":b.value=xui.isDate(b.value)?b.value:xui.isFinite(b.value)?new Date(parseInt(b.value,10)):xui.Date.parse(b.value);I=s(F||d(e,b,j,D),b);if(E){E.html(I,false)}break;case"datetime":b.value=xui.isDate(b.value)?b.value:xui.isFinite(b.value)?new Date(parseInt(b.value,10)):xui.Date.parse(b.value);I=s(F||d(e,b,j,G),b);if(E){E.html(I,false)}break;case"input":b.value=b.value||"";I=s(F||d(e,b,j),b);if(E){E.html(I,false)}break;case"textarea":b.value=b.value||"";I=s(F||d(e,b,j,C),b);if(E){E.html(I,false)}break;case"color":var K=xui.UI.ColorPicker._ensureValue(0,b.value);b.value=b.value?((K!=="transparent"?"#":"")+K):"";I=s(F||d(e,b,j),b);if(b.value){q=xui.UI.ColorPicker.getTextColor(b.value);if(E){E.html(I,false);E.css("color",q);E.parent().css("backgroundColor",b.value)}else{j.color="color:"+q+";";j.bgcolor="background-color:"+b.value+";"}}else{if(E){E.html(I,false);E.css("color","");E.parent().css("backgroundColor","")}else{}}break;case"checkbox":b.value=b.value==="0"?false:!!b.value;I=s(b.value+"",b);if(E){E.tagClass("-checked",b.value)}else{j._fi_checkboxCls=b.value?"xuifont-checked xui-uicmd-check-checked":""}break;case"progress":b.value=parseFloat(b.value)||0;b.value=Math.min(Math.max(b.value,0),1);I=s(F||d(e,b,j,B),b);if(E){E.first().html(I,false);E.width(I)}else{j.progress=I}break;case"listbox":b.value=b.hasOwnProperty("value")?b.value:"";I=xui.adjustRes(s(F||d(e,b,j,w),b));if(E){E.html((I===null||I===undefined)?b.value:I,false)}break;case"dropbox":case"cmdbox":b.value=b.hasOwnProperty("value")?b.value:"";I=xui.adjustRes(s(F||d(e,b,j,u),b));if(E){E.html((I===null||I===undefined)?b.value:I,false)}break;default:b.value=b.hasOwnProperty("value")?b.value:"";I=xui.adjustRes(s(F||d(e,b,j),b));if(E){E.html((I===null||I===undefined)?b.value:I,false)}}if("_renderer" in b){delete b._renderer}b._caption=b._$tips=b._$tmpcap=I;var o=L(e,b,"disabled"),m=L(e,b,"readonly");if(j){j.cellCls=e.getClass("CELL","-"+g)+(o?(" "+M):"")+(m?(" "+a):"");j.type=g;j.value=b.value;j._caption=I;j.cellStyle=L(e,b,"cellStyle");j.cellClass=L(e,b,"cellClass")}else{if(o){l.parent().addClass(M)}else{l.parent().removeClass(M)}if(m){l.parent().addClass(a)}else{l.parent().removeClass(a)}if(o=f.cellStyle){l.attr("style",l.attr("style")+";"+o)}if(o=f.cellUnclass){l.removeClass(o)}if(o=f.cellClass){l.addClass(o)}}return b},_applyRendererEx:function(e,f,d,a,b,c){if(a){if(c=a._col){b(c,f,d);b(c.tagVar,f,d)}if(c=a._row){b(c,f,d);b(c.tagVar,f,d)}}},_prepareItems:function(f,c,A,F){var B=this,e=f.properties,r=e.treeMode,E=f._$subMargin||(f._$subMargin=f.$px(e.$subMargin)),K=f.rowMap2,H=f.rowMap,w=A?H[A]?(H[A]._layer+1):0:0,j=xui.UI.$tag_subId,I=f._id||(f._id=new xui.id()),q=[],G,g,u,m,s,J,o=e.rowOptions,x=f.$itemFilter,n="display:none";r=!(!r||r=="none");if(x){x("begin","prepareItem",f)}for(var D=0,C=c.length;D<C;D++){m=c[D];if(!m.id||K[m.id]){while(K[u=I.next()]){}m.id="-"+u}else{m.id+=""}if(f.beforePrepareRow&&false===f.boxing().beforePrepareRow(f,m,A,F)){continue}G="-r_"+f.pickSubId("row");m[j]=G;H[G]=m;m._pid=A;m._cells={};m._layer=w;m._tabindex=e.tabindex;m._rowMarkDisplay=(e.selMode=="multi"||e.selMode=="multibycheckbox")?"":n;m._treeMode=r?"":n;m._rowNumbDisplay=e.rowNumbered?"":n;u={id:m.id};u.rowCls="";if(m.disabled){u.rowCls+=" xui-uicell-disabled"}if(m.readonly){u.rowCls+=" xui-ui-readonly"}if(m.group){u.group=1;u.rowCls+=" "+f.getClass("CELLS1","-group")+" xui-uiborder-r xui-uiborder-light"}if(x){m.hidden=!!x(m,"prepareItem",f)}if(m.hidden){u.rowDisplay=n}u._row0DfW=e.rowHandlerWidth?("width:"+f.$forceu(e.rowHandlerWidth)):"";u._rulerW="width:"+(m.rulerWidth||f.$forceu(4+w*E));u._rowHeight=f.$forceu(m._rowHeight||m.height||e.rowHeight,"em");m._rowHeight=u._rowHeight;u._rowHeight="height:"+u._rowHeight;u.rowHandlerDisplay=e.rowHandler?"":n;u.rowDDDisplay=(("rowResizer" in m)?m.rowResizer:e.rowResizer)?"":n;u.firstCellStyle=m.firstCellStyle||o.firstCellStyle||"";u.firstCellClass=m.firstCellClass||o.firstCellClass||"";g=u.cells=[];u[j]=G;u._fi_togglemark=m.sub?("xui-uicmd-toggle"+(m._checked?" xuifont-checked xui-uicmd-toggle-checked":"")):(e.togglePlaceholder?"xui-icon-placeholder":"xui-uicmd-none");K[m.id]=G;if(!m.hasOwnProperty("caption")&&m.hasOwnProperty("value")){m.caption=""+m.value}m._oValue=m.value;if(m.caption&&!m.tips){m._$tips=m.caption}xui.UI.adjustData(f,m,u,"sub");u.tagCmds=xui.clone(u.tagCmds||o.tagCmds||e.tagCmds);if(u.tagCmds){this._prepareCmds(f,u,function(a){var b=a.pos||a.tag;return !b||!(b=="header"||b=="header row"||b=="all")})}if(m.group){m.cells=null}if((s=m.cells)){xui.arr.each(e.header,function(b,a){J=f.box._prepareCell(f,s[a],m,b,F,u,a);s[a]=J[0];g.push(J[1])})}var d={};xui.merge(d,u,function(b,a){return xui.isNumb(b)||xui.isStr(b)||a=="ltagCmds"});d[xui.UI.$tag_subId_c]=u[xui.UI.$tag_subId];u._handler_cell=xui.clone(d);if(e.treeMode=="infirstcell"){if(m.group){u._firstcell_grp=xui.clone(d)}u._rulerW=u._fi_togglemark="";u._treeMode=u.tMarkDisplay=u.tNumbDisplay=u._ltagDisplay=n;u.ltagCmds=null}q.push(u)}if(x){x("end","prepareItem",f)}return q},_adjustCell:function(e,a,g){var b=this,j=e.properties,c=a._col,f=b.getCellOption(e,a,"cellRenderer")||j.renderer,d=b.getCellOption(e,a,"cellCapTpl");if(d){a._caption=d}xui.UI.adjustData(e,a,g,"sub");if(f){a._renderer=f}if(!g._cellWidth){g._cellWidth=c._colWidth}g._tabindex=j.tabindex;g.cellDisplay=c.hidden===true?"display:none;":"";b._renderCell(e,a,g);a._oValue=a.value;if("unit" in a){a._oUnit=a.unit}},_setSub:function(g,B,x,A,m,s){var u=g.domId,b=g.boxing(),e=g.properties,n=g.rowMap2[B.id],c=g.box._getToggleNode(g,n),w=g.getSubNodes(["SUB1","SUB2"],n),f=xui(w.get(0)),d=xui(w.get(1));if(xui.Thread.isAlive(g.key+g.id)){return}if(!x){if(B._checked){if(b.beforeFold&&false===b.beforeFold(g,B)){return}var a=function(){w.css({display:"none",height:0,overflow:""});c.tagClass("-checked",false);B._checked=false;if(e.dynDestory||B.dynDestory){var F=B.sub,r=[];for(var E=0,D=F.length;E<D;E++){r.push(F[E].id)}g.boxing().removeRows(r);B.sub=true;delete B._inited}if(b.afterFold){b.afterFold(g,B)}xui.resetRun(u,function(G){g.box._asy(g);delete g.$allrowscache1;delete g.$allrowscache2;g.box._adjustBody(g,"foldrow");if(G){xui.tryF(G,[g,B],b)}},0,[s])};if(!m){if(e.animCollapse){w.css("overflow","hidden");w.animate({height:[d.height(),0]},null,a,200,null,"expoOut",g.key+g.id).start()}else{a()}}else{a()}}if(A&&B.sub&&!e.dynDestory&&!B.dynDestory){xui.arr.each(B.sub,function(r){if(r.sub&&r.sub.length){g.box._setSub(g,r,x,A,true,s)}})}}else{if(!B._checked){if(b.beforeExpand&&false===b.beforeExpand(g,B)){return}var a=function(D,r){if(xui.browser.ie&&xui.browser.ver<=8){c.css({backgroundImage:"",backgroundRepeat:"",backgroundPositionX:"",backgroundPositionY:"",backgroundColor:"",backgroundAttachment:""})}else{c.removeClass("xui-icon-loading")}if(!D){B._checked=true;if(b.afterExpand){b.afterExpand(g,B)}}w.css({display:"",height:"auto",overflow:""});if((e.freezedRow||e.rowHandler)&&!f.height()&&(r=d.height())){f.height(r)}xui.resetRun(u,function(E){g.box._asy(g);delete g.$allrowscache1;delete g.$allrowscache2;g.box._adjustBody(g,"expandrow");if(E){xui.tryF(E,[g,B],b)}},0,[s])},C=function(F,O,E,I,H,G,M,r){var N=F.boxing(),D=F.properties,L=r===false;if(!L&&!O._inited){delete O.sub;O._inited=true;if(r){if(typeof r=="string"){G.html(O.sub=r,false);M.addClass("xui-uiborder-r xui-uiborder-b xui-uiborder-light")}else{if(r["xui.Template"]||r["xui.UI"]){G.append(O.sub=r.render(true));M.addClass("xui-uiborder-r xui-uiborder-b xui-uiborder-light")}else{if(xui.isArr(r)){N.insertRows(r,O.id);if(!O.sub){O.sub=r}}}}var P=0,K=N.getUIValue(true);if(K&&K.length){xui.arr.each(r,function(Q){if(xui.arr.indexOf(K,Q.id||Q)!=-1){P=1;return false}});if(P){N._setCtrlValue(N.getUIValue())}}}}if(!L){I.tagClass("-checked")}if(!m){M.css("height","0px").css("display","");if(D.animCollapse){var J=0;G.children().each(function(Q){J+=Q.offsetHeight});M.css("overflow","hidden");M.animate({height:[0,J]},null,function(){a(L)},200,null,"expoIn",F.key+F.id).start()}else{a(L)}}else{a(L)}},l=B.sub,j=function(r){C(g,B,u,c,f,d,w,r)},o;if((o=typeof l)=="string"||o=="object"){j(l)}else{if(g.onGetContent){if(xui.browser.ie&&xui.browser.ver<=8){c.css("background","url("+xui.ini.img_busy+") no-repeat")}else{c.addClass("xui-icon-loading")}var q=g.boxing().onGetContent(g,B,j);if(q||q===false){if(q===true){B._inited=true}j(q)}}}}if(A&&B.sub){xui.arr.each(B.sub,function(r){if(r.sub&&r.sub.length&&!r._checked){g.box._setSub(g,r,x,A,true,s)}})}}},_getCellId:function(a,c,b){if(xui.isNumb(c)){c=xui.get(a.properties.rows,[c,"id"])}if(xui.isNumb(b)){b=xui.get(a.properties.header,[b,"id"])}return xui.get(a.rowMap,[a.rowMap2[c],"_cells",b])},_updCell:function(f,x,g,l,d,r){var q=f.box,e=f.properties,s=e.dirtyMark,a=s&&e.showDirtyMark,b=xui.absObj.$specialChars,c,u,w,n;if(typeof x=="string"){c=f.cellMap[x]}else{c=x;x=c._serialId}if(!c||!c._row){return}w=c._row.id==q._temprowid;if(w&&c.caption==e.hotRowCellCap){delete c.caption}if(!xui.isHash(g)){g={value:g}}g=xui.filter(g,function(C,A,B){B=!b[A.charAt(0)];if(!B){n=n||{};n[A]=C}return B});if(d){if(f.beforeCellUpdated&&false===f.boxing().beforeCellUpdated(f,c,g,w,n)){return}}if(!xui.isEmpty(g)){delete c._$tips;delete c._$tmpcap;xui.merge(c,g,"all");u=f.getSubNode("CELLA",x);if("type" in g){var m={};q._adjustCell(f,c,m);u.parent().replace(f._buildItems("rows2.cells",[m]));u=f.getSubNode("CELLA",x)}else{var o=q.getCellOption(f,c,"cellCapTpl");if(o){c.caption=xui.adjustRes(o,true,false,null,null,c)}c=q._renderCell(f,c,null,u,g)}var j=c._editor;if("value" in g){if(!s||l===false){c._oValue=c.value}if("unit" in c){c._oUnit=c.unit}else{if(c.value===c._oValue&&(!("unit" in c)||c._oUnit===c.unit)){if(a){u.removeClass("xui-ui-dirty")}}else{if(a){u.addClass("xui-ui-dirty")}}}if(j){j.setValue(c.value,true,"editorini")}if(r!==false){xui.resetRun(f.key+":"+f.$xid+":"+c.id,function(){if(f&&f.box){f.boxing().triggerFormulas(c,"updatecell")}})}}if(("caption" in g)&&j&&j.setCaption){j.setCaption(g.caption||null,true)}c._dirty=1}if(d){if(f.afterCellUpdated){f.boxing().afterCellUpdated(f,c,g,w,n)}}},_ensureValue:function(b,c){if(b.properties.selMode=="multi"||b.properties.selMode=="multibycheckbox"){var a=xui.isArr(c)?c:(c?(""+c):"").split(b.properties.valueSeparator);xui.arr.removeValue(a,this._temprowid);a.sort();return a.join(b.properties.valueSeparator)}else{return c==this._temprowid?null:c}},_sel:function(d,f,l,u,C){var m=d.properties;if(m.activeMode!=f){return}var c=d.getSubId(u),D=f=="cell"?d.cellMap:d.rowMap,q=d.boxing(),n=D[c],F=xui.Event.getKey(C),g=f=="cell"?(n._row.id+"|"+n._col.id):n.id,r=m.selMode;switch(r){case"none":q.onRowSelected(d,n,C,l,0);break;case"multibycheckbox":if(d.keys.MARK){var o=d.getKey(xui.Event.getSrc(C).id||""),a=o==d.keys.MARK;if(!a){q.onRowSelected(d,n,C,l,0);break}}case"multi":var x=q.getUIValue(),b=x?(""+x).split(m.valueSeparator):[],j=1;if(b.length&&(F.ctrlKey||F.shiftKey||m.noCtrlKey)){if(F.shiftKey&&f=="row"){if(d.$firstV._pid!=n._pid){return false}var s=m.rows;if(n._pid){var E=D[n._pid];if(E){s=E.sub}}var A=xui.arr.subIndexOf(s,"id",d.$firstV.id),w=xui.arr.subIndexOf(s,"id",n.id),B;b.length=0;for(B=Math.min(A,w);B<=Math.max(A,w);B++){b.push(s[B].id)}}else{if(xui.arr.indexOf(b,g)!=-1){xui.arr.removeValue(b,g);j=-1}else{b.push(g)}}b.sort();x=b.join(m.valueSeparator);if(q.getUIValue()!=x){q.setUIValue(x,null,null,"click");if(q.get(0)&&q.getUIValue()==x){q.onRowSelected(d,n,C,l,j)}}break}case"single":if(q.getUIValue()!=g){d.$firstV=n;q.setUIValue(g,null,null,"click");if(q.get(0)&&q.getUIValue()==g){q.onRowSelected(d,n,C,l,1)}}break}},_activeCell:function(c,e){if(c.properties.activeMode!="cell"){return}if(c.$activeCell==e){return}var a=null;if(c.$activeCell){xui(c.$activeCell).tagClass("-active",false);delete c.$activeCell}if(e!==false){var b=c.getSubId(e),d=c.cellMap;a=d[b];if(c.beforeCellActive&&(false===c.boxing().beforeCellActive(c,a))){return}xui(c.$activeCell=e).tagClass("-active")}if(c.afterCellActive){c.boxing().afterCellActive(c,a)}},_activeRow:function(d,f){if(d.properties.activeMode!="row"){return}if(d.$activeRow==f){return}var c=null,b;if(d.$activeRow){b=d.getSubId(d.$activeRow);d.getSubNodes(["CELLS1","CELLS2"],b).tagClass("-active",false);delete d.$activeRow}if(f!==false){var a=d.getSubId(f),e=d.rowMap;c=e[a];if(d.beforeRowActive&&(false===d.boxing().beforeRowActive(d,c))){return}b=d.getSubId(d.$activeRow=f);d.getSubNodes(["CELLS1","CELLS2"],b).tagClass("-active")}if(d.afterRowActive){d.boxing().afterRowActive(d,c)}},_getCellFormula:function(e,b,c,g){var d,f=e.properties,a=function(m,l){m=xui.isStr(m)?m:("="+m);return m.replace(/(\B)(\?)([0-9]+\b)/g,"$1"+l+"$3").replace(/(\b)(_)([0-9]+\b)/g,"$1"+l+"$3")},j=function(l,m){l=xui.isStr(l)?l:("="+l);return l.replace(/(\b[A-Z]+)(\?)(\B)/g,"$1"+m+"$3").replace(/(\b[A-Z]+)(_)(\b)/g,"$1"+m+"$3")};return(b&&(d=b.formula))?d:(b&&(d=b._row)&&(d=d.formula))?a(d,c):((d=f.rowOptions)&&(d=d.formula))?a(d,c):(b&&(d=b._col)&&(d=d.formula))?j(d,g):((d=f.colOptions)&&(d=d.formula))?j(d,g):null},getCellOption:function(d,a,c){var b=a,e=d.properties;return(b&&b.hasOwnProperty(c)&&xui.isSet(b=b[c]))?b:((b=e.rowOptions)&&b.hasOwnProperty(c)&&xui.isSet(b=b[c]))?b:(a&&(b=a._col)&&b.hasOwnProperty(c)&&xui.isSet(b=b[c]))?b:((b=e.colOptions)&&b.hasOwnProperty(c)&&xui.isSet(b=b[c]))?b:((b=e)&&b.hasOwnProperty(c)&&xui.isSet(b=b[c]))?b:null},_trycheckrowdirty:function(b,a){if(!a||!a._row){return}xui.resetRun(b.key+":"+b.$xid+":"+a._row.id,function(){if(!b.box){return}var d=b.$cellInEditor;if(a._row&&(!d||(d._row&&d._row!=a._row))){var c=false;xui.arr.each(a._row.cells,function(e){if(e._oValue!==e.value||(("unit" in e)&&e._oUnit!==e.unit)){c=true;return false}});if(c&&a._row.id!=b.box._temprowid&&b.onRowDirtied){b.boxing().onRowDirtied(b,a._row)}}},100)},_adjusteditorW:function(c,a,b){if(a){a.each(function(e,d){if(!(d=e.id)){return}d=d.split(":")[2];if(d=c.cellMap[d]){if(d._editor){d._editor.setWidth(b)}}})}},_adjusteditorH:function(c,b,a){b.each(function(f,e){if(!(e=f.id)){return}e=e.split(":")[2];if(e=c.rowMap[e]){e=e.cells;for(var d in e){d=e[d];if(d._editor){d._editor.setHeight(c.$addpx(a,1,d._editor.getRootNode()))}}}})},_editCell:function(m,L,al,I){var P=typeof L=="string"?(m.cellMap[L]||m.cellMap[m.cellMap2[L]]):L;if(!P){return}L=P._serialId;var o=m.box,N=function(an,ao){return o.getCellOption(m,ao||P,an)};if(N("disabled")||N("readonly")||!N("editable")){return}var a,ad=this,J=m.properties,Y=m.getRoot().contentBox(),am=N("type")||"input",r=P._col,j=r.id,E=P._row,aa=E.id,ac=aa==m.box._temprowid,W=N("editMode"),D=W=="inline"||(N("type")=="dropbutton"),l=m.getSubNode("SCROLL"+E._region+r._region),V=m.getSubNode("CELL",L),x=J.treeMode=="infirstcell"&&m.getSubNode("ROWTOGGLE",L);if(x&&(x.isEmpty()||!x.get(0).clientWidth)){x=null}if(!D){a=m.$curEditor;if(a){xui.tryF(a.undo,[],a)}a=null}if(D&&P._editor){if(!I){P._editor.activate()}return}else{if(am=="checkbox"||am=="button"){if(!I){m.getSubNode("CELLA",L).focus(true)}return}}if((a=N("customEditor"))&&typeof a.iniEditor=="function"){a.iniEditor(m,P,V);if(!I){xui.tryF(a.activate,[],a)}if(m.onBeginEdit){m.boxing().onBeginEdit(m,P,a,"cell")}}else{if(m.beforeIniEditor){a=m.boxing().beforeIniEditor(m,P,V,l,"cell");if(a===false){return}}if(am=="label"){if(!I){m.getSubNode("CELLA",L).focus(true)}return}if(!a||!a["xui.UI"]){var O=N("editorAutoPop"),A=N("editorCacheKey"),e=N("editorProperties"),K=N("editorCC"),u=N("editorCS"),w=N("editorEvents"),G=N("editorFormat"),ak=N("editorMask"),C=N("editorReadonly"),c=N("editorHAlign"),Z=N("editorDropListWidth"),af=N("editorDropListHeight"),d=N("editorCommandBtn"),ae,ah;if(!D){if(A&&m.$cache_editor[A]){a=m.$cache_editor[A]}if(a&&(!a.get(0)||a.isDestroyed())){a=nulll}}if(!a){var X={dirtyMark:false,cachePopWnd:false,left:-1000,top:-1000,position:"absolute",visibility:"hidden",zIndex:100};if(D){xui.merge(X,{left:0,top:0,cachePopWnd:true,width:m.$px(P._col._colWidth)+(Y?2:1),height:m.$px(P._row._rowHeight)+(Y?1:0),visibility:"visible",zIndex:100},"all")}a=new xui.UI.ComboInput(X)}switch(am){case"spin":case"counter":case"currency":a.setType(am);xui.each(xui.toArr("precision,increment,min,max,maxlength,currencyTpl,numberTpl,groupingSeparator,decimalSeparator,forceFillZero,trimTailZero,unit,units"),function(ao,an){v=N(ao);if(am=="currency"){if(ao=="precision"&&!v){v=2}}else{if(ao=="precision"&&!v){v=0}if(ao=="increment"&&!v){v=1}}if(xui.isSet(v)){a["set"+xui.str.initial(ao)](v)}});break;case"progress":a.setType("spin").setMax(1).setMin(0).setPrecision(4).setIncrement(0.01);break;case"input":a.setType("none");break;case"checkbox":a.setType("checkbox");break;case"textarea":a.setType("none").setMultiLines(true).setCommandBtn("save").onCommand(function(an){an.boxing().hide()});if(!D){xui.tryF(a.setResizer,[true],a)}break;case"date":case"datetime":var F=N("dateEditorTpl");if(F){a.setDateEditorTpl(F)}case"listbox":case"combobox":case"helpinput":case"time":case"color":case"getter":case"popbox":case"dropbutton":case"cmdbox":a.setType(am);if(m.box.getCellOption(m,P,"disabled")){}else{a.beforeComboPop(function(ao,at,aq,ar){var an=ao.$cell,ap=m.box.getCellOption(m,an,"event");if(typeof ap=="function"){return ap.call(m._host||m,m,an,ao,at,aq,ar)}else{return m.boxing().beforeComboPop(m,an,ao,at,aq,ar)}});if(m.beforePopShow){a.beforePopShow(function(an,ap,ao){return m.boxing().beforePopShow(m,an.$cell,an,ap,ao)})}if(m.afterPopShow){a.afterPopShow(function(an,ao){return m.boxing().afterPopShow(m,an.$cell,an,ao)})}if(am=="popbox"||am=="cmdbox"||am=="getter"||am=="dropbutton"){if(m.onEditorClick){a.onClick(function(ao,ap,aq,an){return m.boxing().onEditorClick(m,ao.$cell,ao,an,aq)})}}}break;case"file":a.setType(am);break}if(m.onCommand){a.onCommand(function(an,ap,ao){return m.boxing().onCommand(m,an.$cell,an,ap,ao)})}P._editor=a;if(D){V.append(a)}else{l.append(a)}if(!D&&A){m.$cache_editor[A]=a}if(a.setInputReadonly){a.setInputReadonly(!!C)}if(a.setDropListWidth&&Z){a.setDropListWidth(Z)}if(a.setDropListHeight&&af){a.setDropListHeight(af)}if(a.setHAlign&&c){a.setHAlign(c)}if(a.setCommandBtn&&d){a.setCommandBtn(d)}if(G){if(typeof G=="function"&&a.beforeFormatCheck){a.beforeFormatCheck(G)}else{if(typeof G=="string"&&a.setValueFormat){a.setValueFormat(G)}}}if(ak&&a.setMask){a.setMask(ak)}if(e){ah={};var aj=m.getProperties();xui.each(e,function(ao,an){ah=aj[an]});a.setProperties(e)}if(K){a.setCustomClass(xui.clone(K,2))}if(u){a.setCustomStyle(xui.clone(u,2))}if(w){a.setEvents(w)}if(!D){a.resetValue()}switch(am){case"listbox":case"combobox":case"helpinput":if(ae=N("editorListItems")){a.setListKey(null);a.setItems(typeof(ae)=="function"?ae():ae)}else{if(ae=N("editorListKey")){a.setItems(null);a.setListKey(typeof(ae)=="function"?ae():ae)}}break}a.setValue(xui.isSet(P.$editorValue)?P.$editorValue:P.value,true,"editorini");delete P.$editorValue;if(a.setCaption){if(e&&("caption" in e)&&xui.isDefined(e.caption)){a.setCaption(e.caption,true)}else{if(am=="cmdbox"||am=="popbox"||am=="button"||am=="dropbutton"){a.setCaption(P._caption||P._$tmpcap||P.caption||"",true)}}}if(P.$tag){if(a.setCaption){a.setCaption(P.$tag)}else{if(a.setValue){a.setValue(P.$tag,null,"editortag")}}}a.get(0).$cell=P;a.get(0)._smartnav=true;a.undo=D?null:function(an,aq){var ap=this;ap.undo=null;if(m.box){m.box._trycheckrowdirty(m,m.$cellInEditor)}if(!aq){if(ap.get(0)&&ap.get(0).box){ap.getSubNode("INPUT").onBlur(true);if(an&&xui.str.endWith(W,"sharp")){P._ignorefocus=1;m.boxing().focusCell(m.$cellInEditor);xui.asyRun(function(){delete P._ignorefocus})}}ap.getRoot().setBlurTrigger(m.$xid+":editor");if(m.properties&&!m.properties.directInput){ap.beforeUnitUpdated(null).afterUIValueSet(null).beforeNextFocus(null).onCancel(null).afterPopHide(null);ap.setValue("",true,"editorreset")}if(G){if(ap.beforeFormatCheck){ap.beforeFormatCheck(null)}if(ap.setValueFormat){ap.setValueFormat("")}}if(ak){if(ap.setMask){ap.setMask("")}}if(ap.setInputReadonly){ap.setInputReadonly(!C)}if(Z){if(ap.setDropListWidth){ap.setDropListWidth(0)}}if(af){if(ap.setDropListHeight){ap.setDropListHeight(0)}}if(ah){ap.setProperties(ah);ah=null}delete ap.get(0).$cell;delete ap.get(0)._smartnav;ap.hide();if(xui.isFun(ap.collapse)){ap.collapse()}}if(w){var ao={};xui.each(w,function(at,ar){ao[ar]=null});ap.setEvents(ao)}m.$curEditor=null;m.$cellInEditor=null;if(m.onEndEdit){m.boxing().onEndEdit(m,P,ap,"cell")}if(!A&&ap.get(0)){ap.destroy(true)}P._editor=ap=null};var ag=m.boxing(),R=ag.getCellPos(P),U,b,T=function(an){if(R){return ag.getCellbyRowCol(R.row,R.col)}else{return an.$cell}};a.beforeUnitUpdated(function(ao,an){U=T(ao);if(m.beforeUnitUpdated&&false===ag.beforeUnitUpdated(m,U,ao,an)){return false}ad._updCell(m,U,{value:U.value,unit:an},m.properties.dirtyMark,true,true);if((b=T(ao))&&b!==U){ao.$cell=b;b._editor=a;if(!D){m.$cellInEditor=b}}}).afterUIValueSet(function(av,ar,ao,au,an){U=T(av);if(!U){return}var at=N("type",U),ap;switch(at){case"number":case"spin":case"counter":case"progress":ao=parseFloat(ao);ao=(ao||ao===0)?ao:null;break;case"currency":ao=parseFloat((""+ao).replace(/[^\d.-]/g,""));ao=(ao||ao===0)?ao:null;break;case"cmdbox":case"button":case"dropbutton":case"popbox":case"combobox":case"listbox":case"helpinput":ap=av.boxing().getShowValue();break}var aq={value:ao};if(xui.isDefined(ap)){aq.caption=ap}if(av.properties.hasOwnProperty("tagVar")&&!xui.isEmpty(av.properties.tagVar)){aq.tagVar=av.properties.tagVar}if(false!==(m.beforeEditApply&&m.boxing().beforeEditApply(m,U,aq,a,an,"cell"))){ad._updCell(m,U,aq,m.properties.dirtyMark,true,true);if((b=T(av))&&b!==U){av.$cell=b;b._editor=a;if(!D){m.$cellInEditor=b}}if(xui.str.endWith(W,"sharp")&&at!="spin"&&at!="counter"){xui.tryF(a.undo,[true],a)}}}).beforeNextFocus(function(ap,ao){if(a.undo){xui.tryF(a.undo,[true],a)}var an=xui.Event.getEventPara(ao);if(an.key=="enter"){an.$key="right"}m.getSubNode("CELLA",P._serialId).onKeydown(true,an);return false}).onFileDlgOpen(function(an,ao){if(m.onFileDlgOpen){m.boxing().onFileDlgOpen(m,P,an,ao)}});if(!D){a.onCancel(function(){if(a){xui.tryF(a.undo,[],a)}}).afterPopHide(function(ap,ao,an){if(xui.str.endWith(W,"sharp")){xui.tryF(a.undo,[an!="blur"&&an!="call"],a)}}).getRoot().setBlurTrigger(m.$xid+":editor",function(){if(a){xui.tryF(a.undo,[],a)}return false});var ab=V.offset(null,l),q=V.cssSize(),B=x?x.offset(null,V):null,S=x?x.width():null;if(B){B.left+=S}if(x&&(B.left>q.width-8)){return}if(am=="textarea"){a.setWidth(Math.max(200,q.width-(x?B.left:0)+(Y?3:0))).setHeight(Math.max(100,q.height+(Y?2:0))).reLayout(true,true).reBoxing().popToTop(V,4,l)}else{a.setWidth(q.width-(x?B.left:0)+(Y?3:0)).setHeight(q.height+(Y?2:0)).reLayout(true);a.reBoxing().show((ab.left+(x?B.left:0)-(Y?1:0))+"px",(ab.top-(Y?1:0))+"px")}var g,Q=am=="cmdbox"||am=="cmdbox"||am=="listbox"||am=="file",H=Q||am=="date"||am=="time"||am=="datetime"||am=="color",n=a.getInputReadonly&&a.getInputReadonly(),s=xui.str.endWith(W,"sharp")&&(O||n||H);if(!I){if(xui.isFun(a.expand)&&O!==false&&(s||((xui.str.endWith(W,"sharp")||W=="focus")&&(O||Q)))){g=1;a.expand(V,false,null)}}a.get(0).$editMode=W;if(!D){a.setVisibility(s?"hidden":"visible")}if(!xui.str.startWith(W,"hover")||!al){if(!I){xui.asyRun(function(){if(!m.box){return}var an=a;if(an.get(0)&&an.get(0).box){if(g&&a.getPopWnd){an=a.getPopWnd()}if(an){xui.tryF(an&&an.activate,[],an);an.get(0)._stopmouseupcaret=1}}})}}else{var f=function(){if(a){a.getRoot().onMouseout(null,"tg-hover-edit")}},M=function(){if(a){a.getRoot().onMouseout(function(){if(a){xui.tryF(a.undo,[],a)}},"tg-hover-edit")}},ai=function(){};a.onFocus(f).beforePopShow(function(ao,ap,an){f();a.onBlur(null);if(m.beforePopShow){return m.boxing().beforePopShow(m,ao.$cell,ao,ap,an)}}).afterPopHide(function(){M();a.onBlur(ai)}).onBlur(ai);if(!I&&!g){xui.tryF(a&&a.activate,[],a)}}}if(m.onBeginEdit){m.boxing().onBeginEdit(m,P,a,"cell")}}}if(!D){m.$curEditor=a;m.$cellInEditor=P}if(ac){m.__needchecktmprow=true;m.box._sethotrowoutterblur(m)}},_adjustBody:function(b,a,c){if(!b.renderId||b.destroyed){return}xui.resetRun(b.$xid+"4",function(){if(!b.renderId||b.destroyed){return}var u=b.properties,I=xui.$us(b),M=function(l,w){return b.$forceu(l,I>0?"em":"px",w)},n=b.getSubNode("BORDER").cssSize(),D=b.getRoot().contentBox()?2:0,d=b.$px(n.width),f=b.$px(n.height),K=u.rowHandler?(b.$px(u.rowHandlerWidth)+D):0,J,G=b.getSubNode("HEADER1"),F=b.getSubNode("HEADER2"),j=b.getSubNode("BODY12"),Q=b.getSubNode("BODY21"),o=b.getSubNode("SCROLL11"),m=b.getSubNode("SCROLL12"),T=b.getSubNode("SCROLL21"),S=b.getSubNode("SCROLL22"),L=F.height(),H=j.height();if(u.freezedColumn){xui.arr.each(u.header,function(l,w){if(w==u.freezedColumn){return false}if(!l.hidden){K+=b.$px(l.width)+D}})}if(H&&u.freezedRow){H-=1}if(K&&u.freezedColumn){K-=1}J=d-K;b._leftregionw=K;F.width(M(J));S.width(M(J));xui.asyRun(function(){var ab=Q.isEmpty(),Y=T.isEmpty(),w=j.isEmpty(),ac=m.isEmpty(),Z=u.freezedRow,aa=!Y?((S.isScrollBarShowed("x")?xui.Dom.getScrollBarSize():0)+"px"):"",ad=!Y?S.scrollTop():0,X=(Z&&!ac)?S.scrollLeft():0,l=(Z&&!w)?((S.isScrollBarShowed("y")?xui.Dom.getScrollBarSize():0)+"px"):"";if(!ab){Q.css("padding-bottom",aa)}if(Z&&!w){j.css("padding-right",l)}if(!Y){T.scrollTop(ad)}if(Z&&!ac){m.scrollLeft(X)}},100);o.height(H?M(H):0);m.height(H?M(H):0);T.height(M(f-L-H));S.height(M(f-L-H));o.css("display",H&&b._leftregionw?"":"none");m.css("display",H?"":"none");T.css("display",b._leftregionw?"":"none");S.css("overflow","hidden");var x=b.box._adjustRelWith(b);var C=b.getSubNode("ROWS22"),g=b.getSubNode("HCELLS2"),q=b.properties.header,R=b.getSubNode("SCROLL22"),P,U,r,E=b.keys,W,O,B,A;if(C.get(0).clientHeight){if(g.get(0).clientHeight){if(P=g.get(0).childNodes){U=P.length;while(U){if(P[U-1].clientHeight){r=P[U-1];break}--U}}W=r?(r.offsetWidth+r.offsetLeft+100):0;B=M(W);A=M(O=W)}else{if(P=C.get(0).childNodes){U=P.length;while(U){if(P[U-1].clientHeight){r=P[U-1];break}--U}if(r){var s=b.getSubId(r.id);P=b.getSubNode("CELLS2",s);if(P=P.get(0).childNodes){U=P.length;while(U){if(P[U-1].clientHeight){r=P[U-1];break}--U}}}}}}if(r){A=M(O=r.offsetLeft)}else{var u=b.properties,e=u.header,V=u.rows,N=0;xui.arr.each(e,function(l){if(l.hidden!==true){N+=("_colWidth" in l)?b.$px(l._colWidth):(b.$px(l.width)+D)}});A=M(O=N)}P=r=null;if(B){g.parent().width(B)}if(A){C.width(A)}R.css("overflow","auto");if(O>R.width()+D){x="auto"}R.css("overflowX",x);R.onScroll();if(b.onBodyLayout){b.boxing().onBodyLayout(b,a)}if(c){c()}});if(a!="render"&&a!="rowhandler"&&a!="foldrow"&&a!="expandrow"&&a!="setcol"&&a!="resize"){xui.resetRun(b.key+":"+b.$xid,function(){if(b&&b.box){b.boxing().triggerFormulas(null,a)}})}},_adjustHeader:function(c){var d=xui.copy(c),b;xui.arr.each(d,function(e,a){d[a]=xui.copy(e)});return d},_adjustGrpColsData:function(f,q){if(!xui.isArr(q)){return xui.copy(q)}var b=f.properties,n=b.header,u=n.length,s=(u+"").length,d=xui.UI.$tag_subId,w=xui.copy(q,function(a){a.from=parseInt(a.from,10)||0;a.to=parseInt(a.to,10)||0;return a.from<=u&&a.to<=u&&a.to>=a.from});xui.arr.each(w,function(j,a){w[a]=xui.isHash?xui.copy(j):{}});xui.arr.stableSort(w,function(a,j){return a.from>j.from?1:a.from==j.from?(a.to>j.to?-1:a.to==j.to?0:1):-1});for(var g=0,e=w.length,x;g<e;g++){x=w[g];x[d]=x[d]||("-g_"+f.pickSubId("grpCol"));x.id=x.id||x[d];if(!x.caption){x.caption=x.id}x._isgroup=1;delete x._grp;f.colMap[x[d]]=x;f.colMap2[x.id]=x[d]}xui.arr.each(w,function(A,m){for(var a=0;a<m;a++){if(w[m]["to"]>w[a].from&&w[m].from<w[a]["to"]){if(w[m]["to"]>w[a]["to"]){w[m]["to"]=w[a]["to"]}(w[m]._grp||(w[m]._grp=[])).push(w[a].id)}}});xui.arr.each(n,function(a){delete a._grp});var r=0;for(var g=0,e=w.length,x,c;g<e;g++){x=w[g];for(var l=x.from;l<=x.to;l++){c=n[l];(c._grp||(c._grp=[])).push(x.id);if(!x._layer){x._layer=c._grp.length}r=Math.max(r,x._layer)}}f._headerLayers=r;return w},_adjustRows:function(d,l,g){var q,e,j={},o={},r={},b=d.properties,n=b.uidColumn,s,u,c,f=[];if(n){n=xui.arr.subIndexOf(b.header,"id",n)}else{n=-1}xui.arr.each(b.header,function(m,a){s=m.id||m;u=null;if(!g&&s.indexOf(":")!=-1){u=s.split(":")}if(u&&u[0]&&u[1]){o[u[0]]=r[u[1]]=a;f.push(u[0],u[1]);c=1}else{j[s]=a;f.push(s)}});if(xui.isArr(l)&&l.length&&typeof l[0]!="object"){q=[l]}else{q=xui.copy(l)}xui.arr.each(q,function(a,B){if(xui.isArr(a)){q[B]={cells:xui.copy(a)}}else{q[B]=xui.copy(a)}if(c&&xui.isArr(q[B].cells)){var E=q[B].cells,D=[],m;for(var x=0,w=f.length;x<w;x++){m=f[x];if(m in j){D.push(E[x])}else{if(m in o){D.push({value:E[x],caption:E[++x]})}}}q[B].cells=D}var C=(xui.isHash(q[B])&&(!q[B].cells||!xui.isObj(q[B].cells)))?1:(q[B].cells&&xui.isHash(q[B].cells))?2:0;if(!a.group&&C){var F=[],A;xui.each(C==1?q[B]:q[B].cells,function(G,H){if(H in j){F[j[H]]=xui.isHash(G)?G:{value:G}}else{if(H in o){A=F[o[H]]||{};A.value=G;F[o[H]]=A}if(H in r){A=F[r[H]]||{};A.caption=G;F[r[H]]=A}}});q[B].cells=F}xui.arr.each(e=q[B].cells,function(H,G){if(xui.isDefined(H)){if(!!H&&xui.isHash(H)){e[G]=xui.copy(H)}else{e[G]={value:H}}}});if(!("id" in q[B])&&n!=-1&&e[n]&&e[n].value){q[B].id=e[n].value}});return q},_adjustColsWidth:function(f){var b=f.properties,s=b.header,u=b.grpCols,q=f.getRoot().contentBox()?2:0;if(b.showHeader){if(u&&xui.isArr(u)&&u.length){var C,g,x,w=false,a,B=0;for(var r=0,e=u.length,A,d;r<e;r++){g=x=0;w=false;A=u[r];C=0;for(var l=0,c;l<=A.to;l++){c=s[l];a=f.$px(c._colWidth,null,true);if(b.freezedColumn&&b.freezedColumn==l&&!B){B=C}if(l===A.from){w=true;g=C}C+=a+q;if(w&&!c.hidden){x+=a+q}}d=f.getSubNode("HCELL",A._serialId);if(x>q){d.css({display:"",left:f.$forceu(g-(b.freezedColumn?(A.to>b.freezedColumn-1?B:(b.rowHandler?-(f.$px(b.rowHandlerWidth)+q):0)):0)),width:f.$forceu(x-q)})}else{d.css({display:"none"})}if(b.freezedColumn&&b.rowHandler&&A._shadow){d=f.getSubNode("HSCELL",A._serialId);if(x>q){d.css({display:"",left:f.$forceu(g+(f.$px(b.rowHandlerWidth)+q)),width:f.$forceu(x-q)})}else{d.css({display:"none"})}}}}}},_adjustColsHeight:function(d,b){var x=d.colMap,A=d.colMap2,s=d._headerLayers,j=d.properties.headerHeight,w=d.$px(j,0,true),o=d.$px(d.box.$DataModel.headerHeight.ini,0,true)*(s+1),q=d.getRoot().contentBox()?1:0,a,r,f,e,m,n,u,c,g;if(b||w<o){w=o}d.getSubNodes(["HCELLS1","HCELLS2","GRPCELLBOX1","GRPCELLBOX2"]).height(d.$px2em(w)+"em");g=d.$px2em(w-q)+"em";d.getSubNode("FHCELL").css({height:g});if(!s){d.getSubNode("HCELL",true).css({height:g})}else{f=w/(s+1);d.getSubNode("HCELL",true).each(function(B){e=d.getSubId(B.id);if(e=x[e]){if(e&&e._isgroup){u=0;for(var l in x){a=x[l];if(a._isgroup&&a._layer<e._layer&&a.from<=e.to&&a.to>=e.from){u+=d.$px(a.height||f)}}xui(B).top(d.$px2em(u)+"em");n=d.$px(e.height||f)}else{if(e._grp&&(r=e._grp.length)){c=0;for(var l=0;l<r;l++){if(a=A[e._grp[l]]){c+=d.$px(x[a].height||f)}}n=w-c}else{n=w}}xui(B).height(d.$px2em(n-q)+"em");if(e&&e._isgroup&&e._shadow){B=d.getSubNode("HSCELL",e._serialId);xui(B).top(d.$px2em(u)+"em");xui(B).height(d.$px2em(n-q)+"em")}}})}},_focuscell:function(d,l,a){if(d.properties.disabled||d.properties.readonly){return}if(!xui.use(a).get(0)){return}if(!d.$_ensureOnce){d.$_ensureOnce=1;xui.asyRun(function(){d.$_ensureOnce=0})}else{return}var c=d.properties,g=d.box,f=g.getCellOption,o=d.cellMap[d.getSubId(a)],j=c.activeMode,b;if(o&&o._ignorefocus){return}if(o){var n=false,m=f(d,o,"type");if(f(d,o,"editable")){if(f(d,o,"disabled")||f(d,o,"readonly")){n=false}else{n=true;if((f(d,o,"editMode")=="inline"&&m!=="label")||m=="dropbutton"){if(o._editor){o._editor.activate()}}else{g._editCell(d,o._serialId);xui(a).parent().tagClass("-active",false);xui.asyRun(function(){if(!d.box){return}xui.use(a).parent().onMouseout(true,{$force:true}).parent().onMouseout(true,{$force:true})})}}}if(!n){if(o&&j=="cell"){b=xui.use(a).parent().id();g._activeCell(d,b)}}else{if(o&&j=="cell"){g._activeCell(d,false)}}}else{var q=d.rowMap[d.getSubId(a)];if(f(d,q,"editable")){if(f(d,q,"disabled")||f(d,q,"readonly")){}else{d.boxing().editFirstCell(q)}}}if(j=="row"){b=xui.use(a).parent(2).id();g._activeRow(d,b)}},_getToggleNode:function(a,b){return a.getSubNode("ROWTOGGLE",b)},_showTips:function(e,d,g){if(e.properties.disableTips){return}if(e.onShowTips){return e.boxing().onShowTips(e,d,g)}if(!xui.Tips){return}var j=e.keys,l,b,a,f,c;if(e.properties.disabled){return}a=d.id;f=xui.get(d,["parentNode","id"])||"";c=xui.get(d,["parentNode","parentNode","id"])||"";b=e.getSubId(a);if(a.indexOf(j.FHCELL)==0||f.indexOf(j.FHCELL)==0||c.indexOf(j.FHCELL)==0){l={tips:e.properties.tips}}else{if(a.indexOf(j.FCELL)==0||f.indexOf(j.FCELL)==0){l=e.rowMap[b]}else{if(a.indexOf(j.HCELL)==0||a.indexOf(j.HSCELL)==0||f.indexOf(j.HCELLA)==0){l=e.colMap[b]}else{if(a.indexOf(j.CELL)==0||f.indexOf(j.CELLA)==0){l=e.cellMap[b]}}}}if(l){xui.Tips.show(g,("tips" in l)?l.tips:(l._$tips||l._caption||l.caption));return false}else{return true}},_adjustRelWith:function(b){var a=b.properties,u,q=b.colMap,n=b.getSubNode("SCROLL22"),j=b.getSubNode("BODY22"),r=j.contentBox()?2:0,B=n.width(),F=0,d=0;b.getSubNodes("HCELL",true).each(function(l){if(l.clientHeight){F=l.offsetWidth-b.$px(l.style.width);return false}});var e=0,A=0,x=[],m=[],g;xui.each(b.colMap,function(l){if(l.hidden||l._isgroup){return}if(l._region==1){return}if(!l.flexSize){e+=b.$px(l.width)}else{A+=b.$px(l.width);x.push(l);m.push(l)}d++});var f=b.getSubNode("LHCELL").get(0).clientWidth||0;b.getSubNodes("LCELL",true).each(function(l){if(l.children.length){f=Math.max(f,l.clientWidth)}});b.__lcellW=f;if(!x.length){g="auto";b.box._adjustColsWidth(b);return}else{g="hidden";if(n.scrollable("y")){B-=xui.Dom.getScrollBarSize()}}B-=b.__lcellW;b._relWTotal=A;b._relAvailable=B-(e+d*F);while(x.length&&B!=e+d*F){var G=b._relAvailable,H=0,s,C=x.length,E=0;for(var D=C-1;D>=0;D--){var c=x[D],o=D===0?(G-H):Math.round(G*(b.$px(c.width)/A));if(o<0){o=0}u=o;if(c.hasOwnProperty("minWidth")){if((s=b.$px(c.minWidth))>o){e+=s;u=s;xui.arr.removeFrom(x,D);E++}}if(c.hasOwnProperty("maxWidth")){if((s=b.$px(c.maxWidth))<o){e+=s;u=s;xui.arr.removeFrom(x,D);E++}}c._colWidth=b.$forceu(u);H+=u}if(E===0||E===C){break}}b.box._adjustColsWidth(b);if(m.length){xui.arr.each(m,function(w){var I,l=[];xui.each(w._cells,function(J){I=b.getSubNode("CELL",J);if(I._nodes.length){l.push(I.get(0))}});I=b.getSubNode("HCELL",w._serialId);if(I._nodes.length){l.push(I.get(0))}b.box._adjusteditorW(b,xui(l).width(w._colWidth),b.$px(w._colWidth)+r)})}return g},_getRow:function(e,g,d,c){if(g){if(d=="data"){return xui.clone(g,true)}else{if(d=="value"){var f={};xui.each(g.cells||g,function(a,l){f[a._col.id]=("value" in a)?a.value:a});return f}else{if(d=="min"){var b=[];xui.each(g.cells||g,function(a,l){b[l]=("value" in a)?a.value:a});return b}else{if(d=="map"){return e.boxing().getRawData(g,c)}else{return g}}}}}},$cancelHoverEditor:function(d){if(d.destroyed){return}var c=xui.get(d,["$curEditor","_nodes",0,"$editMode"])||"",a;if(xui.str.startWith(c,"hover")){var b=d.$curEditor;if(c=="hover"&&(a=b.get(0))&&a.$poplink){return false}xui.tryF(b.undo,[],b)}},_onresize:function(b,w,u){var a=b.properties,C=function(f){return b.getSubNode(f)},m=xui.$us(b),E=function(f,F){return b.$forceu(f,m>0?"em":"px",F)},x=b.getRoot(),B=x.contentBox()?2:0,o=a.rowHandler?(b.$px(a.rowHandlerWidth)+B):0,n,A=C("BORDER"),j=C("HEADER1"),g=C("HEADER2"),D=C("BODY12"),c=C("BODY21"),e=C("SCROLL11"),d=C("SCROLL12"),s=C("SCROLL21"),q=C("SCROLL22"),r=g.height(),l=D.height();w=w?b.$px(w,null,true):w;u=u?b.$px(u,null,true):u;A.cssSize({width:w?E(w):null,height:u?E(u):null});if(w){if(a.freezedColumn){xui.arr.each(a.header,function(f,F){if(F==a.freezedColumn){return false}if(!f.hidden){o+=b.$px(f.width)+B}})}if(l&&a.freezedRow){l-=1}if(o&&a.freezedColumn){o-=1}n=w-o;b._leftregionw=o;g.width(E(n))}if(u){e.height(l?E(l):0);d.height(l?E(l):0);s.height(E(u-r-l));q.height(E(u-r-l));e.css("display",l?"":"none");d.css("display",l?"":"none")}if(w){e.css("display",b._leftregionw?"":"none");s.css("display",b._leftregionw?"":"none")}if(b.$forceRelayout){this._adjustColsWidth(b);this._adjustColsHeight(b)}this._adjustBody(b,"resize")}}});xui.Class("xui.UI.MTreeGrid",["xui.UI","xui.absValue"],{Instance:{activate:function(){var b=this.get(0),a;if(!b.renderId){return}b.getSubNode("ROWS22").nextFocus(true,true,true);return this},_setCtrlValue:function(a){return this.each(function(c){if(!c.renderId){return}if(c.properties.activeMode=="none"){return}var g=c.boxing(),m=g.getUIValue(),b=c.properties,f=c.rowMap,d=b.activeMode=="row"?["CELLS1","CELLS2","MARK"]:"CELL",e=function(n,o){return c.getSubNodes(n,o)},j=function(n){var q=c.rowMap2;if(b.activeMode=="row"){return q[n]}else{if(!n){return}var o=(""+n).split("|");return xui.get(c.rowMap,[q[o[0]],"_cells",o[1]])}};if(b.selMode=="single"){var l=j(m);if(m&&l){e(d,l).tagClass("-checked",false)}l=j(a);if(l){e(d,l).tagClass("-checked")}}else{if(b.selMode=="multi"||b.selMode=="multibycheckbox"){m=m?(""+m).split(b.valueSeparator):[];a=a?(""+a).split(b.valueSeparator):[];xui.arr.each(m,function(q,n){if(q=j(q)){if(n=f[q]){delete n._selected}e(d,q).tagClass("-checked",false)}});xui.arr.each(a,function(n){if(n=j(n)){if(i=f[n]){i._selected=1}e(d,n).tagClass("-checked")}});if(a.length===0){e("HFMARK").tagClass("-checked",false);delete c._$checkAll}}}})},calculateGridValue:function(){var e=this.get(0),b=e.properties,j=b.gridValueFormula,o=null,l,c,n,q,d=xui.ExcelFormula,m,g,a;if(e.beforeGridValueCalculated&&false!==(n=e.boxing().beforeGridValueCalculated(e))){o=n}else{if(j){g=b.header.length;a=b.rows.length;if(d.validate(j)){q={};if(l=d.getRefCells(j,g,a)){xui.each(l,function(f,r){c=d.toCoordinate(r);m=b.rows[c.row].cells[c.col];q[r]=m.value})}o=d.calculate(j,q,g,a)}}}if(e.afterGridValueCalculated){e.boxing().afterGridValueCalculated(e,o)}e._$gridvalue=o;if(b.excelCellId&&e._$oldgridvalue!==e._$gridvalue){e.boxing().notifyExcel(false)}return e._$oldgridvalue=o},notifyExcel:xui.UI.Input.prototype.notifyExcel,getExcelCellValue:function(){var e=this.get(0),b=e.properties,j,l,c,o,n,q,d=xui.ExcelFormula,m,g,a;if(b.excelCellId){o=("_$gridvalue" in e)?e._$gridvalue:this.caculateGridValue();if(xui.isSet(n=(e.onGetExcelCellValue&&e.boxing().onGetExcelCellValue(e,b.excelCellId,o)))){o=n}return o}return null},applyCellFormula:function(a,c,b){return this.each(function(m){var g=m.box,u,o,q,s,r,x={},f,e=m.properties,A=e.rows,n=xui.arr.indexOf(e.header,a._col),d=xui.arr.indexOf(A,a._row),l=xui.ExcelFormula;if(u=g._getCellFormula(m,a,l.toColumnChr(n+1),d+1)){var w=l.getRefCells(u,n,d);if(!w){return}xui.each(w,function(j,B){f=l.toCoordinate(B);tcell=A[f.row].cells[f.col];x[B]=tcell.value});r=l.calculate(u,x,n,d);if(r!==a.value){s=[a._serialId,r,a,u];if(m.beforeApplyFormula&&false===m.boxing().beforeApplyFormula(m,a,r,u)){}else{g._updCell(m,s[0],{value:s[1]},c,b,true)}if(m.afterApplyFormulas){m.boxing().afterApplyFormulas(m,[s])}}}})},triggerFormulas:function(a,c,b){return this.each(function(w){var n=w.box,I,f=w.properties,s=f.rows,j=s.length,E=f.header.length,H=xui.ExcelFormula,C={},d,B;xui.arr.each(f.rows,function(J,l){xui.arr.each(J.cells,function(L,K){if(L===a){I=H.toCellId(K,l)}if(d=n._getCellFormula(w,L,H.toColumnChr(K+1),l+1)){C[H.toCellId(K,l)]=[L,d]}})});if(I){delete C[I]}if(xui.isEmpty(C)){return}var e={};xui.each(C,function(l,J){if(l=H.getRefCells(l[1],E,j)){e[J]=l}});var o,u,A={},g,G=[],r,q,m={},x;if(I){m[I]=1}do{o=0;xui.filter(e,function(J,l){x=0;if(!I){x=1}else{for(var K in J){if(K in m){x=1;break}}}if(!x){return false}u=true;for(var K in J){if(!I&&(K in C)){u=false}else{if(!(K in A)){g=H.toCoordinate(K);B=s[g.row].cells[g.col];A[K]=B.value}}}if(u){r=C[l];q=H.calculate(r[1],A,E,j);if(q!==r[0].value){G.push([r[0],q,r[1],r[0]._serialId]);if(I){m[l]=1}}delete C[l];o++;return false}})}while(!xui.isEmpty(C)&&o>0);for(var F=0,D=G.length;F<D;F++){if(w.beforeApplyFormula&&false===w.boxing().beforeApplyFormula(w,G[F][0],G[F][1],G[F][2])){}else{n._updCell(w,G[F][3],{value:G[F][1]},c,b,false)}}if(w.afterApplyFormulas){w.boxing().afterApplyFormulas(w,G)}if(f.gridValueFormula){w.boxing().calculateGridValue(false)}})},_insertRowsToDom:function(c,a,q,d,o,A){if(q){var g=c.rowMap[q];if(g&&!g._inited){return}}if(!a){a=[]}var u,r,B,j=c.box,b=c.properties,B=c.getSubNode("FHCELL").width();if(B){B=c.$forceu(B)}xui.arr.each(a,function(l){l._row0DfW=B?("width:"+B):"";xui.arr.each(l.cells,function(D,E){D.width=D._col._colWidth})});if(c.properties.freezedRow){var n=c.getSubNode("ROWS12");if(!n.isEmpty()&&n.query("div","id",/-ROWS12\:/).isEmpty()){delete c._passFreezedRow}}var f=c._buildItems("rows21",a),e=c._buildItems("rows22",a);if(!d){if(q){u=c.getSubNode("SUB1",q);r=c.getSubNode("SUB2",q)}else{u=c.getSubNode("ROWS21");r=c.getSubNode("ROWS22")}if(o){u.prepend(f);r.prepend(e)}else{u.append(f);r.append(e)}}else{u=c.getSubNode("ROW1",d);r=c.getSubNode("ROW2",d);if(o){u.addPrev(f);r.addPrev(e)}else{u.addNext(f);r.addNext(e)}}xui.arr.each(a,function(l){if(l.sub){l.open=false;if(false===j.getCellOption(c,l,"iniFold")){c.boxing()._toggleRows([l],true,false,true)}}});if(A&&A.length){var m=[],x=[];xui.arr.each(A,function(l){if(j.getCellOption(c,l,"editable")&&(j.getCellOption(c,l,"editMode")=="inline"||j.getCellOption(c,l,"type")=="dropbutton")){m.push(l)}});A.length=0;if(m.length){for(var w=0,s=m.length,n;w<s;w++){n=parseInt(w/25,10);if(!x[n]){x[n]=[]}x[n].push(m[w])}m.length=0;var C=function(){if(x.length){var E=x.shift();if(E&&E.length){for(var F=0,D=E.length;F<D;F++){if(c&&c.box&&!c.destroyed&&E[F]&&E[F]._row){c.box._editCell(c,E[F],null,true)}}xui.asyRun(C)}}else{x=null}};xui.asyRun(C)}}delete c.$allrowscache1;delete c.$allrowscache2;c.box._adjustBody(c,"addrow")},_refreshHeader:function(c){var b=this.get(0),a=b.properties,d=b.box,m=xui.clone(a.grpCols,false,2),e,f,n=this.getRows("data");xui.breakO(b.colMap,2);c=d._adjustHeader(c||[]);e=d._prepareHeader(b,c);a.header=c;this.removeAllRows();b.getSubNodes(["HCELL","HSCELL"],true).remove();var l,j;if(e.length){l=b._buildItems("header1",e);b.getSubNode("HCELLS1").append(l);j=b._buildItems("header2",e);b.getSubNode("LHCELL").addPrev(j)}if(m&&xui.isArr(m)&&m.length>0){m=d._adjustGrpColsData(b,m);a.grpCols=m;f=d._prepareGrpCols(b,m,e);if(f&&f.length){l=b._buildItems("grpCols1",f);b.getSubNode("GRPCELLBOX1").append(l);j=b._buildItems("grpCols2",f);b.getSubNode("GRPCELLBOX2").append(j)}d._adjustColsWidth(b);d._adjustColsHeight(b);b.adjustSize()}if(n&&n.length){this.setRows(n)}d._adjustBody(b,"refreshheader");var g=b.properties.colOptions;xui.arr.each(e,function(q){if(xui.isFun(q.colRenderer||g.colRenderer)){(q.colRenderer||g.colRenderer).call(null,b,q)}});if(a.treeMode=="infirstcell"){b.getSubNode("HCELLA",e[0]._serialId).prepend(b.getSubNode("LTAGCMDS")).prepend(b.getSubNode("HFMARK"))}if(b.$col_pop){b.$col_pop.destroy(true);delete b.$col_pop}xui.each(b.$cache_editor,function(q){if(!q.destroyed){q.destroy(true)}});b.$cache_editor={}},_toggleRows:function(c,b){var a=this;if(c&&c.length){xui.arr.each(c,function(d){if(d.id){a.toggleRow(d.id,b)}})}},autoRowHeight:function(a){return this.each(function(c){if(c.renderId){var b=xui.Event;if(b.__realtouch){b.__simulatedMousedown=1}if(a&&c.rowMap2[a]){c.getSubNode("FHANDLER",c.rowMap2[a]).onDblclick(true)}else{xui.each(c.rowMap,function(e,d){c.getSubNode("FHANDLER",d).onDblclick(true)})}if(b.__realtouch){b.__simulatedMousedown=0}}})},autoColWidth:function(a){return this.each(function(c){if(c.renderId){var b=xui.Event;if(b.__realtouch){b.__simulatedMousedown=1}if(a&&c.colMap2[a]){c.getSubNode("HHANDLER",c.colMap2[a]).onDblclick(true)}else{xui.each(c.colMap,function(e,d){c.getSubNode("HHANDLER",d).onDblclick(true)})}if(b.__realtouch){b.__simulatedMousedown=0}}})},autoColHeight:function(){return this.each(function(b){if(b.renderId){var a=xui.Event;if(a.__realtouch){a.__simulatedMousedown=1}b.getSubNode("FHANDLER").onDblclick(true);if(a.__realtouch){a.__simulatedMousedown=0}}})},addHotRow:function(a){var b=this.get(0);if(b.renderId){b.box._addTempRow(b,a||null)}return this},getHotRow:function(a){return this.getRowbyRowId(this.Class._temprowid,a)},updateHotRow:function(a,c,b){return this.updateRow(this.Class._temprowid,{cells:a},c,b)},removeHotRow:function(){var a=this.get(0);a.box._sethotrowoutterblur(a,true);delete a.__hastmpRow;this.removeRows([a.box._temprowid],false);return this},isDirtied:function(){var a=false,b=this.get(0);if(b._dirty){return true}xui.each(b.rowMap,function(c){if(c._dirty||c._oValue!==c.value||(("unit" in c)&&c._oUnit!==c.unit)){a=true;return false}});xui.each(b.cellMap,function(c){if(c._dirty||c._oValue!==c.value||(("unit" in c)&&c._oUnit!==c.unit)){a=true;return false}});return a},isCellDirtied:function(a){return a._dirty||a._oValue!==a.value||(("unit" in a)&&a._oUnit!==a.unit)},isRowDirtied:function(e){var d=this,c=e._dirty||e._oValue!==e.value;if(prf._dirty){return true}for(var b=0,a=e.cells.length;b<a;b++){if(d.isCellDirtied(cell)){return true}}return false},_getObjByDom:function(d,b){var c=this.get(0),a=c.getSubId(typeof d=="string"?d.charAt(0)=="!"?((d=xui.use(d).get(0))&&d.id):d:d.id);return c[b=="row"?"rowMap":b=="col"?"colMap":"cellMap"][a]},getRowByDom:function(c,b,a){return this.get(0).box._getRow(this.get(0),this._getObjByDom(c,"row"),b,a)},getHeaderByDom:function(a){return this._getObjByDom(a,"col")},getCellByDom:function(a){return this._getObjByDom(a,"cell")},getRows:function(j,e){var f=this.get(0).properties.rows,d,c,g=this.get(0);if(!xui.isArr(f)){return[]}if(j=="data"||j=="min"||j=="map"||j=="value"){d=xui.clone(f,true);if(d&&d.length&&d[d.length-1]&&d[d.length-1].id==this.constructor._temprowid){d.pop()}if(j=="value"){var l=[];xui.arr.each(f,function(m,a){var b=g.box._getRow(g,m,j,e);l.push(b)});d=l}if(j=="min"){xui.arr.each(d,function(b,a){if(d[a].cells){xui.each(c=d[a]=d[a].cells,function(m,n){c[n]=m.value})}})}else{if(j=="map"){d=this.getRawData(null,e)}}return d}else{return f}},getRowbyRowId:function(g,e,a){var d=this.get(0),b=d.rowMap2,f=d.properties.rows,c;if(xui.isNumb(g)){g=xui.get(f,[g==-1?(f.length-1):g,"id"])}if(b&&b[g]){return d.box._getRow(d,d.rowMap[b[g]],e,a)}if((b=d.queryItems(f,function(l,j){return l.id==g},1,1))&&b.length){return d.box._getRow(d,b[0],e,a)}},getRowbyCell:function(a,c,b){return this.constructor._getRow(this.get(0),a._row,c,b)},toggleRow:function(a,e,c,g,j){var d=this,b=this.get(0),l=arguments.callee,f=b.rowMap2,n=b.properties.rows;if(xui.isNumb(a)){a=xui.get(n,[a==-1?(n.length-1):a,"id"])}if(f&&f[a]){var m=b.rowMap[f[a]];if(m&&m.sub&&(!xui.isSet(e)||!!e!==!!m._checked)){b.box._setSub(b,m,xui.isSet(e)?!!e:!m._checked,c,g||c,j)}}else{xui.arr.each(n,function(o){if(o.sub){l.call(d,o.id,e,c,true,j)}})}return this},showRows:function(f,b){var e=this,d=e.get(0),a=xui(),c=xui(),g=d.properties;f=xui.isHash(f)?f.id:xui.isArr(f)?f:f===0?[0]:f?(f+"").split(g.valueSeparator):null;if(!f){f=xui.get(e.getActiveRow(),"id")||((g.$UIvalue||g.value)+"");f=f.split(g.valueSeparator)}if(f&&f.length){xui.arr.each(f,function(j,l){if(l=e.getRowbyRowId(j)){if(b===false){if(!l.hidden){c.merge(e.getSubNodes(["ROW1","ROW2"],l._serialId))}}else{if(l.hidden){a.merge(e.getSubNodes(["ROW1","ROW2"],l._serialId))}}l.hidden=b===false}})}if(!a.isEmpty()){a.css("display","")}if(!c.isEmpty()){c.css("display","none")}return this},updateRow:function(r,n,o,j){var K=this,m=K.get(0),s=m.box,l=m.properties,B;if(!r&&r!==0){r=xui.get(K.getActiveRow(),"id")||((l.$UIvalue||l.value)+"").split(l.valueSeparator)[0]}orow=K.getRowbyRowId(r);if(!orow){return K}var F=l.dirtyMark,c=F&&l.showDirtyMark,H=orow.id==s._temprowid,f=xui.absObj.$specialChars,q;if(!xui.isHash(n)){if(xui.isArr(n)){n={cells:n}}else{n={value:n}}}n=xui.filter(n,function(M,b,L){L=!f[b.charAt(0)];if(!L){q=q||{};q[b]=M}return L});if(j){if(m.beforeRowUpdated&&false===m.boxing().beforeRowUpdated(m,orow,n,H,q)){return}}if(!xui.isEmpty(n)){if(orow){var E=orow._serialId,x,a,u;if(xui.isSet(n.id)){n.id+=""}if(n.id&&n.id!==r){u=n.id;var e=m.rowMap2,w;if(!e[u]){if(w=e[r]){e[u]=w;delete e[r];m.rowMap[w].id=u;xui.each(m.colMap,function(b){if(b=b._cells){b[u]=b[r];delete b[r]}})}}}else{n.id=r}if(xui.isEmpty(n)){return K}if(("group" in n&&n.group!=orow.group)||"cells" in n||("sub" in n&&!((n.sub===true&&!orow.sub)||(!n.sub&&orow.sub===true)))){var C="__special",A=orow._pid?m.rowMap[orow._pid].id:null;orow.id=C;m.rowMap2[C]=m.rowMap2[u||r];delete m.rowMap2[u||r];xui.each(m.colMap,function(b){if(b=b._cells){delete b[u||r]}});orow=xui.clone(orow,true);xui.merge(orow,n,"all");if("sub" in n&&!n.sub){delete orow.sub}K.insertRows([orow],A,C,true);K.removeRows([C]);if(m.properties.activeMode=="row"){var J=m.properties.$UIvalue||"",d=(""+J).split(m.properties.valueSeparator);if(d.length&&xui.arr.indexOf(d,r)!=-1){if(u){xui.arr.removeValue(d,r)}K.setUIValue(d.join(m.properties.valueSeparator),true,null,"sub")}}}else{if("sub" in n){x=s._getToggleNode(m,E);if(n.sub){x.addClass("xui-uicmd-toggle");if(orow._layer){x.removeClass("xui-uicmd-empty")}}else{x.removeClass("xui-uicmd-toggle");if(orow._layer){x.addClass("xui-uicmd-empty")}}}a=K.getSubNodes(["CELLS1","CELLS2"],E);if(x=m.$px(n.height)){m.box._adjusteditorH(m,a.height(orow._rowHeight=m.$forceu(x)),x)}if(x=n.rowStyle){a.attr("style",a.attr("style")+";"+x)}if(x=n.rowClass){a.addClass(x)}if(n.hasOwnProperty("disabled")){var g="xui-uicell-disabled";if(n.disabled){a.addClass(g)}else{a.removeClass(g)}}if(n.hasOwnProperty("readonly")){var g="xui-ui-readonly";if(n.readonly){a.addClass(g)}else{a.removeClass(g)}}if(x=n.firstCellStyle){(a=K.getSubNode("FCELL",E)).first().attr("style",a.attr("style")+";"+x)}if(x=n.firstCellClass){K.getSubNode("FCELL",E).first().addClass(x)}if(n.hasOwnProperty("value")&&!xui.isSet(n.caption)){n.caption=n.value+""}if(n.hasOwnProperty("caption")){K.getSubNode("FCELLCAPTION",E).get(0).innerHTML=n.caption||""}if(n.hasOwnProperty("rowResizer")){x=!!n.rowResizer;K.getSubNode("FHANDLER",E).css("display",(n.rowResizer=x)?"block":"none")}if(n.hasOwnProperty("hidden")){var I=!!n.hidden;if(I){if(orow.hidden!==true){K.getSubNodes(["ROW1","ROW2"],E).css("display","none")}}else{if(orow.hidden===true){K.getSubNodes(["ROW1","ROW2"],E).css("display","")}}}xui.merge(orow,n,"all");if(n.hasOwnProperty("value")){var D=m.getSubNode("CELLA",E);if(!F||o===false){orow._oValue=orow.value}else{if(orow.value===orow._oValue){if(c){D.removeClass("xui-ui-dirty")}}else{if(c){D.addClass("xui-ui-dirty")}}}if(orow._editor){orow._editor.setValue(n.value,true,"editorini")}}}}else{var G=K.get(0).queryItems(K.getRows(),function(b){return typeof b=="object"?b.id===r:b==r},true,true,true);if(G.length){xui.merge(orow=G[0][0],n,"all")}}orow._dirty=true}if(j){if(m.afterRowUpdated){m.boxing().afterRowUpdated(m,orow,n,H,q)}}return K},insertRows:function(a,r,f,q,l){var C=arguments[4],D=this,A=D.constructor,e=D.get(0);if(xui.isHash(a)){a=[a]}if(a&&xui.isArr(a)&&a.length>0){var d=e.properties,u=e.rowMap2,n=d.rowOptions,B=e.rowMap,x,w,o,s;if(r===true){v=d.$UIvalue||d.value;if(v){v=(v+"").split(d.valueSeparator)}r=v[0]}r=u&&u[r];if(f===true){v=d.$UIvalue||d.value;if(v){v=(v+"").split(d.valueSeparator)}f=v[0]}f=u&&u[f];if(f){o=e.rowMap[f];if(o){r=o._pid}}a=A._adjustRows(e,a,l);if(!r){w=xui.isArr(d.rows)?d.rows:(d.rows=[])}else{s=B&&B[r];w=xui.isArr(s.sub)?s.sub:(s.sub=[])}var m;if(e.renderId){if(!r||s._inited){x=[];m=A._prepareItems(e,a,r,x);D._insertRowsToDom(e,m,r,f,q,x);xui.arr.each(a,function(b){if(xui.isFun(b.rowRenderer||n.rowRenderer)){(b.rowRenderer||n.rowRenderer).call(null,e,b)}})}else{if(r&&!s.inited){e.box._getToggleNode(e,r).removeClass("xui-icon-placeholder xui-uicmd-none").addClass("xui-uicmd-toggle")}}}if(!f){xui.arr.insertAny(w,a,q?0:-1)}else{var g=xui.arr.subIndexOf(w,"_serialId",f);xui.arr.insertAny(w,a,q?g:(g+1))}if(e.renderId){e.box._asy(e)}if(m&&m.length){xui.breakO(m,2);m.length=0}}if(C!==false&&e.renderId&&e.__hastmpRow){e.box.__ensurehotrow(e,null)}if(e.$itemFilter){var j=[];xui.arr.each(a,function(F){if(F.sub&&!F.hidden){if(true!==e.$itemFilter(F,"checkSub",e)){var c;for(var E=0,b=F.sub.length;E<b;E++){if(!F.sub[E].hidden){c=1;break}}if(!c){j.push(F.id)}}else{j.push(F.id)}}});if(j.length){D.showRows(j,false)}}return D},doFilter:xui.absList.prototype.doFilter,removeRows:function(a){var d=arguments[1],l=this,e=l.get(0);if(!e.rowMap2){return}var c=e.properties,j=e.cellMap,b=[],g,f=0;a=xui.isHash(a)?[a.id]:xui.isArr(a)?a:a===0?[0]:a?(a+"").split(c.valueSeparator):null;if(!a){a=xui.get(l.getActiveRow(),"id")||((c.$UIvalue||c.value)+"");a=a.split(c.valueSeparator)}if(!a||!a.length){return l}xui.arr.each(a,function(n,m){if(xui.isNumb(n)){n=c.rows[n]&&c.rows[n].id}a[m]=""+n});xui.arr.each(a,function(u){if(u=e.rowMap2[u]){f++;var s;if(s=e.rowMap[u]){var o=s._cells,q=s.id,n;if(s.sub&&xui.isArr(s.sub)){var m=[];xui.arr.each(s.sub,function(w){m.push(w.id)});l.removeRows(m)}xui.each(o,function(x,w){delete j[x]._col._cells[q];xui.breakO(j[x]);delete j[x];e.reclaimSubId(x.slice(3),"cell")});if(n=s._pid?(n=e.rowMap[s._pid])?n.sub:null:e.properties.rows){if(xui.isArr(n)){xui.filter(n,function(w){return w._serialId!=u})}}delete e.rowMap2[q];xui.breakO(e.rowMap[u]);delete e.rowMap[u];b.push(e.getSubNode("ROW1",u).get(0));b.push(e.getSubNode("ROW2",u).get(0))}e.reclaimSubId(u.slice(3),"row")}else{var r=function(x){var w=xui.arr.subIndexOf(x,"id",u);if(w!==-1){f++;xui.arr.removeFrom(x,w)}xui.arr.each(x,function(A){if(A.sub){r(A.sub)}})};r(c.rows)}});if(f>0){if(g=c.$UIvalue){if((g=(""+g).split(c.valueSeparator)).length>1){xui.filter(g,function(m){return xui.arr.indexOf(a,m)==-1});c.$UIvalue=g.join(c.valueSeparator)}else{if(xui.arr.indexOf(a,c.$UIvalue)!=-1){c.$UIvalue=null}}}xui(b).remove();if(e.$activeCell&&!xui.Dom.byId(e.$activeCell)){delete e.$activeCell}if(e.$activeRow&&!xui.Dom.byId(e.$activeRow)){delete e.$activeRow}delete e.$allrowscache1;delete e.$allrowscache2;e.box._asy(e);e.box._adjustBody(e,"delrow")}if(d!==false&&e.renderId&&e.__hastmpRow){e.box.__ensurehotrow(e,null)}e._dirty=1;return l},insertCol:function(g,f,n){var e=this.get(0),d=e.properties,u=e.box,s=d.rows,b,l,C,B;n=xui.isNumb(n)?n:-1;if(n===-1||d.header.length<n){n=d.header.length}if(n<0){n=0}if(d.treeMode=="infirstcell"&&n===0){return false}var q=n<=d.freezedColumn-1;var a=d.grpCols;if(a&&xui.isArr(a)&&a.length){for(var A=0,w=a.length,r;A<w;A++){r=a[A];if(r.from>n){r.from++;r.to++}else{if(n>=r.from&&n<=r.to){r.to++}}}}if(e.renderId){C=u._parepareCol(e,g,d.header);g=C[0];xui.arr.insertAny(d.header,g,n);l=e.getSubNode(q?"HCELLS1":"HCELLS2").children().get(n-1);if(l){xui(l).addNext(e._buildItems(q?"header1":"header2",[C[1]]))}var o=e.properties.colOptions;if(xui.isFun(g.colRenderer||o.colRenderer)){(g.colRenderer||o.colRenderer).call(null,e,g)}d.grpCols=u._adjustGrpColsData(e,a);u._adjustColsWidth(e);u._adjustColsHeight(e);u._adjustBody(e,"addcol")}else{xui.arr.insertAny(d.header,g,n)}f=xui.isArr(f)?f:[];var x=0,c=function(m){var j=[];xui.arr.each(m,function(E,D){if(E.group){c(E.sub)}else{b=f[x];l=e.getSubNode(q?"CELLS1":"CELLS2",E._serialId).children().get(n-1);if(l){B=u._prepareCell(e,b,E,g,j);xui.arr.insertAny(E.cells,B[0],n);xui(l).addNext(e._buildItems(q?"rows1.cells":"rows2.cells",[B[1]]))}else{xui.arr.insertAny(E.cells,b||{},n)}}x++});if(j.length){xui.arr.each(j,function(D){if(u.getCellOption(e,D,"editable")&&(u.getCellOption(e,D,"editMode")=="inline"||u.getCellOption(e,D,"type")=="dropbutton")){u._editCell(e,D)}});j.length=0}};if(s&&xui.isArr(s)){c(s)}e._dirty=1},removeCols:function(a){var d=arguments[1],n=this,f=n.get(0),j=f.box,c=f.properties,m=f.cellMap,e=xui.UI.$tag_subId,b=[],l=0;a=xui.isArr(a)?a:(a+"").split(c.valueSeparator);xui.arr.each(a,function(r,q){a[q]=""+r});if(a&&a.length>1){a.sort(function(o,s){var q=xui.arr.indexOf(c.header,o);if(q==-1){q=xui.arr.subIndexOf(c.header,"id",o)}var r=xui.arr.indexOf(c.header,s);if(r==-1){r=xui.arr.subIndexOf(c.header,"id",s)}return q>r?1:q===r?0:-1})}var g=c.grpCols;if(g&&xui.isArr(g)&&g.length){xui.arr.each(a,function(u){var s=xui.arr.indexOf(c.header,u);if(s==-1){s=xui.arr.subIndexOf(c.header,"id",u)}if(s==-1){return}for(var r=0,q=g.length,o;r<q;r++){o=g[r];if(o.from>s){o.from--;o.to--}else{if(s>=o.from&&s<=o.to){o.to--}}}},null,true);xui.filter(g,function(s){var q=s.to>=s.from;if(!q&&f.renderId){f.getSubNode(["HCELL","HSCELL"],s[e]).remove();delete f.colMap[s[e]];delete f.colMap2[s.id]}return q})}xui.arr.each(a,function(x){var q=xui.arr.indexOf(c.header,x);if(q==-1){q=xui.arr.subIndexOf(c.header,"id",x)}if(q==-1){return}if(f.colMap2&&(x=f.colMap2[x])){l++;var o;if(o=f.colMap[x]){var w=o._cells,s=o.id;xui.each(w,function(B,A){b.push(f.getSubNode("CELL",B).get(0));delete m[B]._row._cells[s];xui.breakO(m[B]);delete m[B];f.reclaimSubId(B.slice(3),"cell")});delete f.colMap2[s];xui.breakO(f.colMap[x]);delete f.colMap[x];var r;r=f.getSubNode("HCELL",x).get(0);if(r){b.push(r)}r=f.getSubNode("HSCELL",x).get(0);if(r){b.push(r)}}f.reclaimSubId(x.slice(3),"header")}var u=function(A){xui.arr.each(A,function(B){if(B.cells){xui.arr.removeFrom(B.cells,q)}if(B.sub){u(B.sub)}})};u(c.rows);xui.arr.removeFrom(c.header,q)},null,true);if(l>0){xui(b).remove();if(f.$activeCell&&!xui.Dom.byId(f.$activeCell)){delete f.$activeCell}c.grpCols=j._adjustGrpColsData(f,g);j._adjustColsWidth(f);j._adjustColsHeight(f);j._adjustBody(f,"delcol")}f._dirty=1;return n},removeAllRows:function(){var c=arguments[0],b=this.get(0),d=b.box,e=b.properties;if(!e.rows||e.rows.length<0){return this}for(var a in b.cellMap){b.reclaimSubId(a.slice(3),"cell")}for(var a in b.rowMap){b.reclaimSubId(a.slice(3),"row")}xui.each(b.colMap,function(f){f._cells={}});xui.breakO([b.rowMap,b.cellMap],3);b.rowMap={};b.cellMap={};b.rowMap2={};delete b.$activeCell;delete b.$activeRow;b.properties.rows.length=0;if(b.renderId){if(b.$sl!=0){b.getSubNode("HEADER2").get(0).scrollLeft=b.$sl=0}b.getSubNodes(["SCROLL21","SCROLL22"]).scrollTop(0).scrollLeft(0);b.getSubNodes(["ROWS21","ROWS22"]).empty()}delete b.$allrowscache1;delete b.$allrowscache2;b.properties.$UIvalue=null;if(c!==false&&b.renderId&&b.__hastmpRow){d.__ensurehotrow(b,null)}d._adjustBody(b,"delrow");return this},updateGridValue:function(){return this.each(function(a){var b=a.properties;delete a._dirty;xui.each(a.rowMap,function(c){c._oValue=c.value;if("unit" in c){c._oUnit=c.unit}delete c._dirty});xui.each(a.cellMap,function(c){c._oValue=c.value;if("unit" in c){c._oUnit=c.unit}delete c._dirty});if(b.dirtyMark&&b.showDirtyMark){a.getSubNode("CELLA",true).removeClass("xui-ui-dirty")}})},updateRowValue:function(c){var b=this.get(0),d=this.getRowbyRowId(c),a=[],e=b.properties;xui.arr.each(d.cells,function(f){if(f._oValue!==f.value||(("unit" in f)&&f._oUnit!==f.unit)){f._oValue=f.value;if("unit" in f){f._oUnit=f.unit}delete f._dirty;if(e.dirtyMark){a.push(b.getSubNode("CELLA",f._serialId).get(0))}}});d._oValue=d.value;delete d._dirty;if(e.dirtyMark){a.push(b.getSubNode("CELLA",d._serialId).get(0))}if(e.dirtyMark&&e.showDirtyMark){xui(a).removeClass("xui-ui-dirty")}},updateColValue:function(d){var c=this.get(0),b=this.getHeaderByColId(d),a=[],e=c.properties;xui.arr.each(b.cells,function(f){if(f._oValue!==f.value||(("unit" in f)&&f._oUnit!==f.unit)){f._oValue=f.value;if("unit" in f){f._oUnit=f.unit}delete f._dirty;if(e.dirtyMark){a.push(c.getSubNode("CELLA",f._serialId).get(0))}}});if(e.dirtyMark&&e.showDirtyMark){xui(a).removeClass("xui-ui-dirty")}},updateCellValue:function(a){var c=this,b=c.get(0),d=b.properties;if(typeof a=="string"){a=c.getCell(a)}if(a._oValue!==a.value||(("unit" in a)&&a._oUnit!==a.unit)){a._oValue=a.value;if("unit" in a){a._oUnit=a.unit}delete a._dirty;if(d.dirtyMark){b.getSubNode("CELLA",a._serialId).removeClass("xui-ui-dirty")}}return c},resetCellValue:function(a){var c=this,b=c.get(0),d=b.properties;if(typeof a=="string"){a=c.getCell(a)}if(a._oValue!==a.value||(("unit" in a)&&a._oUnit!==a.unit)){a.value=a._oValue;if("unit" in a){a.unit=a._oUnit}delete a._dirty;b.box._renderCell(b,a,{},b.getSubNode("CELLA",a._serialId))}return c},getActiveRow:function(d,a){var b,c=this.get(0);if(c.properties.activeMode!="row"){return}if(!(b=c.$activeRow)){return}b=c.rowMap[c.getSubId(b)];return c.box._getRow(c,b,d,a)},setActiveRow:function(c){var b,d,a=this.get(0);if(a.properties.activeMode!="row"){return}a.box._activeRow(a,false);if(!(d=this.getRowbyRowId(c))){return}if(!(b=a.getSubNodes(["CELLS1","CELLS2"],d._serialId)).isEmpty()){a.box._activeRow(a,b.get(0).id);b.scrollIntoView()}return this},getRowMap:function(f){var c=this.get(0),a=c.boxing(),e=c.properties,b,d;if(xui.isHash(f)){f=f.id}if(!xui.isSet(f)&&c.renderId&&!c.destroyed){if(e.activeMode="row"){if(b=a.getActiveRow()){f=b.id}}else{if(e.activeMode="cell"){if(b=a.getActiveCell()){f=b._row.id}}}}return a.getRowbyRowId(f,"map")},setRowMap:function(d,c,b,a){if(xui.isHash(d)){d=d.id}return this.each(function(l){var f=l.boxing(),m=l.properties,g;if(!d&&l.renderId&&!l.destroyed){if(m.activeMode="row"){if(g=f.getActiveRow()){d=g.id}}else{if(m.activeMode="cell"){if(g=f.getActiveCell()){d=g._row.id}}}}if(d){var n=f.getRowbyRowId(d),o=f.getHeader("min");d=n.id;var j=l.box._adjustRows(l,[c]),e=j[0].cells;xui.arr.each(n.cells,function(r,q){xui.isDefined(e[q]&&e[q].value)&&f.updateCellByRowCol(d,o[q],e[q],b,a)})}m.rowMap=c})},getHeader:function(f){var e=this.get(0).properties.header;if(!xui.isArr(e)){return[]}if(f=="data"){return xui.clone(e,true)}else{if(f=="min"){var d=xui.clone(e,true),c;xui.arr.each(d,function(b,a){d[a]=b.id});return d}else{return e}}},getHeaderByColId:function(d,c){var a=this.get(0).properties.header,b;if(xui.isNumb(d)){d=xui.get(profile.properties.header,[d,"id"])}b=xui.arr.subIndexOf(a,"id",d);return b==-1?null:c=="data"?xui.clone(a[b],true):c=="min"?a[b].id:a[b]},getHeaderByCell:function(a,c){var b=a._col;return !b?null:c=="data"?xui.clone(b,true):c=="min"?b.id:b},updateHeader:function(c,w){var r=this,f=r.get(0),a=f.properties,e=r.getHeaderByColId(c),s;if(!e){var g=a.grpCols,l=xui.arr.subIndexOf(g,"id",c);e=g[l];s=true}if(e){if(typeof w!="object"){w={caption:w+""}}else{xui.filter(w,true)}delete w.id;if(f.renderId){var q=e._serialId,u,m,j;if(!s){if(u=w.width){u=f.$px(u);var d=[];j=r.getSubNode("HCELL",q).get(0);if(j){d.push(j)}j=r.getSubNode("HSCELL",q).get(0);if(j){d.push(j)}xui.each(e._cells,function(b){d.push(r.getSubNode("CELL",b).get(0))});f.box._adjusteditorW(f,xui(d).width(e._colWidth=f.$forceu(u)),u);r.getSubNode("SCROLL22").onScroll();r.constructor._adjustColsWidth(r.get(0));r.constructor._adjustBody(r.get(0),"setcol")}if(w.hasOwnProperty("visibility")&&!w.hasOwnProperty("hidden")){w.hidden=!w.visibility}if(w.hasOwnProperty("hidden")){var o=!!w.hidden;if(o){if(e.hidden!==true){r.showColumn(c,false)}}else{if(e.hidden===true){r.showColumn(c,true)}}}if("type" in w){delete e.editorCacheKey}}if(u=w.headerStyle||w.colStyle){(m=r.getSubNodes(["HCELLA","HSCELLA"],q)).attr("style",m.attr("style")+";"+u)}if(u=w.headerClass){r.getSubNodes(["HCELLA","HSCELLA"],q).addClass(u)}if(w.hasOwnProperty("caption")){r.getSubNodes(["HCELLCAPTION","HSCELLCAPTION"],q).get(0).innerHTML=w.caption}if("colResizer" in w){u=!!w.colResizer;r.getSubNode("HHANDLER",q).css("display",(w.colResizer=u)?"block":"none")}}xui.merge(e,w,"all");if("flexSize" in w){f.adjustSize()}}},showColumn:function(c,j){var f=this.get(0),a=f.colMap2,l=f.colMap,e,b,m,g,d=[];if(e=l[b=a[c]]){if(f.beforeColShowHide&&false===f.boxing().beforeColShowHide(f,c,j)){return false}g=f.getSubNode("HCELL",b).get(0);if(g){d.push(g)}g=f.getSubNode("HSCELL",b).get(0);if(g){d.push(g)}xui.each(e._cells,function(n){d.push(f.getSubNode("CELL",n).get(0))});xui(d).css("display",(e.hidden=(j===false?true:false))?"none":"");if(f.afterColShowHide){f.boxing().afterColShowHide(f,c,j)}}f.box._adjustColsWidth(f);f.box._adjustBody(f,"setcol");return true},sortColumn:function(c,f,e){var d=this.get(0),b=d.colMap2[c],a=d.colMap[b];if(b&&a){if(xui.isBool(f)){a._order=!f}if(xui.isFun(e)){a.sortby=e}d.getSubNode("HCELLA",b).onClick()}return this},getCell:function(f,e){var c=this,d=this.get(0),b,a;xui.each(d.cellMap,function(g){if(g.id&&g.id===f){f=g._serialId;return false}});b=d.cellMap[f];return !b?null:e=="data"?xui.merge({rowId:b._row.id,colId:b._col.id},xui.clone(b,true)):e=="min"?b.value:e=="map"?((a={})&&((a[b._col.id]=b.value)||1)&&a):b},getCellbyRowCol:function(c,a,g){var l=this,d=l.get(0),j,e;if(xui.isNumb(c)){c=xui.get(d.properties.rows,[c,"id"])}if(xui.isNumb(a)){a=xui.get(d.properties.header,[a,"id"])}j=xui.get(d.rowMap,[d.rowMap2[c],"_cells",a]);j=j&&d.cellMap[j];if(!j){var n=l.getRowbyRowId(c),f=l.getHeader("min"),b;if(n&&n.cells){b=xui.arr.indexOf(f,a);if(b!=-1){j=n.cells[b]}}}return !j?null:g=="data"?xui.merge({rowId:c,colId:a},xui.clone(j,true)):g=="min"?j.value:g=="map"?((e={})&&((e[a]=j.value)||1)&&e):j},getCells:function(d,b,a){var c={};xui.each(this.get(0).cellMap,function(e){if((d?(d==e._row.id):1)&&(b?(b==e._col.id):1)){c[e.id]=a=="data"?xui.merge({rowId:e._row.id,colId:e._col.id},xui.clone(e,true)):a=="min"?e.value:e}});return c},updateCellByRowCol:function(d,b,o,j,f,g){var l,m=this,a=m.constructor;if(l=a._getCellId(m.get(0),d,b)){a._updCell(m.get(0),l,o,j,f,g)}else{var n=m.getRowbyRowId(d),e=m.getHeader("min"),c;if(n&&n.cells){c=xui.arr.indexOf(e,b);if(c!=-1){if(!xui.isHash(n.cells[c])){n.cells[c]={value:n.cells[c]}}xui.merge(n.cells[c],o)}}}return m},getCellPos:function(a,b){if(!a||!a._row||!a._col){return null}var d=this.get(0),c=xui.arr.indexOf(a._row.cells,a),e=xui.arr.indexOf(d.properties.rows,a._row);return c==-1||e==-1?null:b?xui.ExcelFormula.toCellId(c,e):{row:e,col:c}},updateCellByRowCol2:function(d,c,f,e){var a=d.indexOf(":")!=-1?d.split(":"):xui.ExcelFormula.toCoordinate("A3",true),g=parseInt(a[0],10),b=parseInt(a[1],10);return this.updateCellByRowCol(g,b,c,f,e)},updateCell:function(e,b,g,f,c){var a=this,d=this.get(0);xui.each(d.cellMap,function(j){if(j.id&&j.id===e){e=j._serialId;return false}});a.constructor._updCell(d,e,b,g,f,c);return a},editCellbyRowCol:function(d,c){var b=this.get(0),a=b.box;a._editCell(b,a._getCellId(b,d,c));return this},editCell:function(a){if(a=a?a:this.get(0).getSubId(this.get(0).$activeCell+"")){this.constructor._editCell(this.get(0),a)}return this},editFirstCell:function(d){var e=this.get(0),g=function(r){return e.box.getCellOption(e,q,r)},q=typeof d=="string"?(e.rowMap[e.rowMap2[d]]):d,j;if(!e.properties.firstCellEditable||!q){return}if(g(e,q,"disabled")||g(e,q,"readonly")){return}if(!(e&&e.renderId)||e.destroyed){return}var f=e.getSubNode("FCELLCAPTION",q._serialId);if(!f.isEmpty()){if(e.beforeIniEditor){j=e.boxing().beforeIniEditor(e,q,f,b,"row");if(j===false){return}}var b=f.parent(),n=b.cssSize(),c=e.getSubNode("BORDER"),o=c.contentBox()?2:0,a=f.offset(null,b),m=b.offset(null,c);if(m.left>n.width-8){return}j=e.$cache_editor.firstCellEditor;if(!j||!j["xui.UI"]||j.isDestroyed()){j=new xui.UI.ComboInput({type:"input",zIndex:100});e.$cache_editor.firstCellEditor=j}j.setWidth(n.width-a.left+o).setHeight(n.height+o).setValue(q.value||q.value||"");if(e.onBeginEdit){e.boxing().onBeginEdit(e,q,j,"row")}j.undo=function(){var r=this,s=r.get(0)&&r.get(0).$row;r.undo=null;if(e.box){if(s&&s._oValue!==s.value&&s.id!=e.box._temprowid&&e.onRowDirtied){e.boxing().onRowDirtied(e,s)}}if(r.get(0)&&r.get(0).box){r.getSubNode("INPUT").onBlur(true);r.getRoot().setBlurTrigger("tg_editor_blur:"+e.$xid);if(e.properties){r.beforeUnitUpdated(null).afterUIValueSet(null).beforeNextFocus(null).onCancel(null).onFileDlgOpen(null);r.setValue("",true,"editorreset")}delete r.get(0).$row;delete r.get(0)._smartnav;delete r.get(0).$editMode;r.hide()}if(s){delete s._editor}e.$curEditor=null;if(e.onEndEdit){e.boxing().onEndEdit(e,s,r,"row")}if(r.get(0)){r.destroy(true)}r=null};j.afterUIValueSet(function(B,x,s,A,r){var u={value:s},w;if(B.properties.hasOwnProperty("tagVar")&&!xui.isEmpty(w=B.properties.tagVar)){u.tagVar=w}if(false!==(e.beforeEditApply&&e.boxing().beforeEditApply(e,q,u,j,r,"row"))){e.boxing().updateRow(q.id,{value:s,caption:s+""});xui.tryF(j.undo,[],j)}}).beforeNextFocus(function(u,s){xui.tryF(j.undo,[true],j);var r=xui.Event.getEventPara(s);if(r.key=="enter"){r.$key="right"}e.getSubNode("CELLA",q._serialId).onKeydown(true,r);return false}).onCancel(function(){xui.tryF(j.undo,[],j)});c.append(j);j.reBoxing().show((a.left+m.left-1)+"px",(m.top-1)+"px");var l=j.getRoot();l.setBlurTrigger("tg_editor_blur:"+e.$xid,function(){xui.tryF(j.undo,[],j);return false});j.get(0).$row=q;j.get(0)._smartnav=true;q._editor=j;e.$curEditor=j;j.activate()}return this},focusCellbyRowCol:function(f,d){var b=this.get(0),a=b.box,e=a._getCellId(b,f,d),c=b.getSubNode("CELLA",e);if(c&&c.get(0)){c.focus(true)}return this},focusCell:function(a){var b=a._serialId;this.get(0).getSubNode("CELLA",b).focus(true);return this},getActiveCell:function(e){var c,d=this.get(0),a,b;if(d.properties.activeMode!="cell"){return}if(!(c=d.$activeCell)){return}b=d.cellMap[d.getSubId(c)];return !b?null:e=="data"?xui.merge({rowId:b._row.id,colId:b._col.id},xui.clone(b,true)):e=="min"?b.value:e=="map"?((a={})&&((a[b._col.id]=b.value)||1)&&a):b},setActiveCell:function(e,c){var d,a,b=this.get(0);if(b.properties.activeMode!="cell"){return}b.box._activeCell(b,false);if(typeof e=="object"){a=e}else{a=this.getCellbyRowCol(e,c)}if(!a){return}if(!(d=b.getSubNode("CELL",a._serialId)).isEmpty()){b.box._activeCell(b,d.get(0).id)}return this},getDirtied:function(c,a){var b={};xui.each(this.get(0).cellMap,function(d){if((d._oValue!==d.value||(("unit" in d)&&d._oUnit!==d.unit))&&(c?(c==d._row.id):1)&&(a?(a==d._col.id):1)){b[d.id]={rowId:d._row.id,colId:d._col.id,value:d.value,_oValue:d._oValue};if("unit" in d){b[d.id]._oUnit=d._oUnit}}});return b},getSubNodeInGrid:function(b,e,d){var c=this,a=(xui.isSet(e)&&xui.isSet(d))?c.getCellbyRowCol(e,d):d?c.getHeaderByColId(d):e?c.getRowbyRowId(e):null;return c.getSubNode(b,(a&&a._serialId)||true)},getInlineEditors:function(c,a){var b={};xui.each(this.getCells(c,a),function(d,e){b[e]=d._editor});return b},getEditor:function(){return xui.get(this.get(0),["$curEditor"])},updateEditor:function(c,a,d){var b=this.getEditor();if(b){if(xui.isHash(d)){b.setProperties(d,true)}if(xui.isDefined(a)){b.setCaption(a,true)}if(xui.isDefined(c)){b.setUIValue(c,true)}}return this},getEditCell:function(){return xui.get(this.get(0),["$cellInEditor"])},offEditor:function(d,a){var c=this.get(0),b;if(!c){return}if(b=c.$curEditor){xui.tryF(b.undo,[],b)}if(!a){xui.each(c.cellMap,function(f){if(b=f._editor){b.destroy();delete f._editor}})}if(d){var e=c.box.getCellOption;xui.each(c.cellMap,function(f){if(e(c,f,"editable")&&(e(c,f,"editMode")=="inline"||e(c,f,"type")=="dropbutton")){c.box._editCell(c,f,null,true)}})}},adjustEditor:function(f){var e=this,b=this.get(0),g=this.getRoot().contentBox();if(b&&b.$curEditor){var d=b.$curEditor,j=b.$cellInEditor;if(typeof f=="function"){f.apply(e,[d,j])}else{if(d.KEY=="xui.UI.ComboInput"){var c=b.getSubNode("CELL",j.id),a=c.offset(null,b.getSubNode("SCROLL22")),l=c.cssSize();d.setLeft(a.left-1).setTop(a.top-1).setWidth(l.width+g+1).setHeight(l.height+g).reLayout(true)}}}return e}},Before:function(b,a,c){if(b=="xui.UI.TreeGrid"){this.Behaviors.CELLS1=this.Behaviors.CELLS2;this.Behaviors.GCELLA=this.Behaviors.CELLA}return arguments.callee.upper.apply(this,arguments)},Initialize:function(){this.addTemplateKeys(["ALT","PROGRESS"]);this.getCellPro=this.getCellOption;var a=this.prototype;a.getColumn=a.getHeader;a.updateColumn=a.updateHeader;a.getColByDom=a.getHeaderByDom;a.getColByColId=a.getHeaderByColId;a.getColByCell=a.getHeaderByCell},Static:{HasHtmlTableNode:1,DIRYMARKICON:"DIRTYMARK",Templates:{tagName:"div",style:"{_style}",className:"{_className}",BORDER:{tagName:"div",BOX:{tagName:"table",cellspacing:"0",cellpadding:"0",className:"xui-uibase",TBODY:{tagName:"tbody",TRHEADER:{tagName:"tr",TDHEADER1:{tagName:"td",HEADER1:{tagName:"div",style:"{showHeader}",HI1:{tagName:"div",HCELLS1:{tagName:"div",style:"{headerHeight}",FHCELL:{$order:0,style:"{rowHandlerDisplay};{_row0DfW};height:{_hcellheight};",className:"xui-uiborder-noradius xui-uibar xui-uiborder-outset {cellCls}",tabindex:"{_tabindex}",HCELLA:{style:"{firstCellStyle};",className:"xui-v-wrapper xui-showfocus {firstCellClass}",HHANDLER:{tagName:"div",style:"{colDDDisplay}"},FHANDLER:{tagName:"div",style:"{rowDDDisplay}"},HFMARK:{$order:1,className:"xuifont",$fonticon:"xui-uicmd-check",style:"{_rowMarkDisplay}"},LTAGCMDS:{$order:2,tagName:"span",className:"xui-ltag-cmds",text:"{ltagCmds}"},GRIDCAPTION:{$order:5,text:"{gridHandlerCaption}"},SORT:{className:"xuifont",$fonticon:"xui-icon-sort",style:"{sortDisplay}"}}},OTHERHCELLS:{$order:1,tagName:"text",text:"{header1}"}},GRPCELLBOX1:{tagName:"div",style:"{headerHeight};",GRPCELLS:{$order:3,tagName:"text",text:"{grpCols1}"}}}}},TDHEADER2:{tagName:"td",HEADER2:{$order:0,tagName:"div",className:"xui-uibar",style:"{showHeader}",HI2:{tagName:"div",HCELLS2:{tagName:"div",style:"{headerHeight};",OTHERHCELLS:{$order:1,tagName:"text",text:"{header2}"},LHCELL:{$order:2,className:"xui-v-wrapper xui-uibar",style:"width:{tagCmdWidth}em;height:100%;text-align: center",LHCELLINNER:{$order:1,text:"{headerTail}"},RTAGCMDS:{$order:1,tagName:"span",className:"xui-rtag-cmds",text:"{rtagCmds}"}}},GRPCELLBOX2:{tagName:"div",style:"{headerHeight};",GRPCELLS:{$order:3,tagName:"text",text:"{grpCols2}"}}}}}},TRLOCKED1:{tagName:"tr",TDBODY11:{tagName:"td",SCROLL11:{$order:1,tagName:"div",className:"",BODY11:{tagName:"div",ROWS11:{$order:1,tagName:"div",text:"{rows11}"}}}},TDBODY12:{tagName:"td",SCROLL12:{$order:1,tagName:"div",className:"{_rowfreezed}",BODY12:{tagName:"div",ROWS12:{$order:1,tagName:"div",text:"{rows12}"}}}}},TRBODY:{tagName:"tr",TDBODY21:{tagName:"td",SCROLL21:{$order:1,tagName:"div",className:"{_columnfreezed}",BODY21:{tagName:"div",ROWS21:{$order:1,tagName:"div",text:"{rows21}"}}}},TDBODY22:{tagName:"td",SCROLL22:{$order:1,tagName:"div",BODY22:{tagName:"div",ROWS22:{$order:1,tagName:"div",text:"{rows22}"}}}}},TRTAIL:{tagName:"tr",TDTAIL1:{tagName:"td"},TDTAIL2:{tagName:"td"}}}},COLLIST:{tagName:"div",COLLISTDROP:{className:"xuifont xui-special-icon",$fonticon:"xui-icon-triangle-down"}},ARROW:{className:"xuifont xui-special-icon",$fonticon:"xui-icon-bigup",text:"&nbsp;"}},DIRTYMARK:{},$submap:{header1:function(f,e,c,b,a,d){if(d>f.properties.freezedColumn){return}f.colMap[c._serialId]._region=1;b="header";xui.UI.$doTemplate(f,e,c,b,a);return b},header2:function(f,e,c,b,a,d){if(d>f.properties.freezedColumn){f.colMap[c._serialId]._region=2;b="header";xui.UI.$doTemplate(f,e,c,b,a);return b}},header:{HCELL:{style:"width:{_cellWidth};height:{_hcellheight};{colDisplay};",className:"xui-uiborder-noradius xui-uibar xui-uiborder-outset {cellCls}",HCELLA:{className:"xui-v-wrapper xui-showfocus {headerClass}",style:"{headerStyle};{colStyle}",tabindex:"{_tabindex}",HCELLCAPTION:{$order:5,className:"xui-v-node",text:"{caption}"},SORT:{className:"xuifont",$fonticon:"xui-icon-sort",style:"{sortDisplay}"},HHANDLER:{$order:2,tagName:"div",style:"{colDDDisplay}"}}}},grpCols1:function(f,e,c,b,a,d){var d=f.properties.freezedColumn-1,g=f.colMap;if(c.from>d){return}if(c.to>d){g[c._serialId]._region=2;g[c._serialId]._shadow=1;b="grpColsShadow";xui.UI.$doTemplate(f,e,c,b,a)}else{g[c._serialId]._region=1;b="grpCols";xui.UI.$doTemplate(f,e,c,b,a)}return b},grpCols2:function(f,e,c,b,a,d){var d=f.properties.freezedColumn-1;if(c.to>d){f.colMap[c._serialId]._region=2;b="grpCols";xui.UI.$doTemplate(f,e,c,b,a);return b}},grpCols:{HCELL:{style:"position:absolute;width:{_cellWidth};height:{_hcellheight};top:{_hcelltop};left:{_hcellleft};",className:"xui-uiborder-noradius xui-uibar xui-uiborder-outset {cellCls}",HCELLA:{className:"xui-v-wrapper xui-showfocus {headerClass}",style:"{headerStyle};{colStyle}",tabindex:"{_tabindex}",HCELLCAPTION:{$order:5,className:"xui-v-node",text:"{caption}"},HHANDLER:{$order:2,tagName:"div",style:"{colDDDisplay}"}}}},grpColsShadow:{HSCELL:{style:"position:absolute;width:{_cellWidth};height:{_hcellheight};top:{_hcelltop};left:{_hcellleft};",className:"xui-uiborder-noradius xui-uibar xui-uiborder-outset {cellCls}",HSCELLA:{className:"xui-v-wrapper xui-showfocus {headerClass}",style:"{headerStyle};{colStyle}",tabindex:"{_tabindex}",HSCELLCAPTION:{className:"xui-v-node",text:"{caption}"}}}},grpCols:{HCELL:{style:"position:absolute;width:{_cellWidth};height:{_hcellheight};top:{_hcelltop};left:{_hcellleft};",className:"xui-uiborder-noradius xui-uibar xui-uiborder-outset {cellCls}",HCELLA:{className:"xui-v-wrapper xui-showfocus {headerClass}",style:"{headerStyle};{colStyle}",tabindex:"{_tabindex}",HCELLCAPTION:{$order:5,className:"xui-v-node",text:"{caption}"},HHANDLER:{$order:2,tagName:"div",style:"{colDDDisplay}"}}}},rows11:function(f,e,c,b,a,d){if(f._passFreezedRow){return false}if(d>f.properties.freezedRow){return false}f.rowMap[c._serialId]._region=1;xui.UI.$doTemplate(f,e,c,"row1",a,d,"rows1")},rows12:function(f,e,c,b,a,d){if(f._passFreezedRow){return false}if(d>f.properties.freezedRow){return false}f.rowMap[c._serialId]._region=1;xui.UI.$doTemplate(f,e,c,"row2",a,d,"rows2")},rows21:function(f,e,c,b,a,d){if(!f._passFreezedRow&&d<=f.properties.freezedRow){return}f.rowMap[c._serialId]._region=2;xui.UI.$doTemplate(f,e,c,"row1",a,d,"rows1")},rows22:function(f,e,c,b,a,d){if(!f._passFreezedRow&&d<=f.properties.freezedRow){return}f._passFreezedRow=1;f.rowMap[c._serialId]._region=2;xui.UI.$doTemplate(f,e,c,"row2",a,d,"rows2")},row1:{ROW1:{tagName:"div",style:"{rowDisplay}",CELLS1:{$order:2,tagName:"div",className:"xui-uirowbg xui-uiborder-b xui-uiborder-light {rowCls} {rowClass}",style:"{_rowHeight};{rowStyle}",CELLHANDLER:{tagName:"text",text:"{_handler_cell}"},GRPCELL2:{tagName:"text",text:"{_firstcell_grp}"},OTHERCELLS:{tagName:"text",$order:2,text:"{cells}"}},SUB1:{$order:3,tagName:"div"}}},row2:{ROW2:{tagName:"div",style:"{rowDisplay}",CELLS2:{$order:2,tagName:"div",className:"xui-uirowbg xui-uiborder-b xui-uiborder-light {rowCls} {rowClass}",style:"{_rowHeight};{rowStyle}",GRPCELL2:{tagName:"text",text:"{_firstcell_grp}"},OTHERCELLS:{tagName:"text",$order:2,text:"{cells}"},LCELL:{$order:3,className:"xui-v-wrapper",LCELLINNER:{$order:1,text:"{rowTail}"},RTAGCMDS:{$order:2,tagName:"span",className:"xui-rtag-cmds",text:"{rtagCmds}"}}},SUB2:{$order:3,tagName:"div"}}},"rows1._handler_cell":function(f,e,c,b,a,d){xui.UI.$doTemplate(f,e,c,f.properties.treeMode=="infirstcell"?"rows1._handler_cell2":"rows1._handler_cell1",a)},"rows1._handler_cell1":{FCELL:{$order:0,style:"{rowHandlerDisplay};{_row0DfW};",className:"xui-uiborder-r xui-uiborder-light {cellCls}",CELLA:{tabindex:"{_tabindex}",style:"{cellStyle}{firstCellStyle}",className:"xui-v-wrapper xui-showfocus {cellClass}{firstCellClass}",MARK:{$order:1,className:"xuifont",$fonticon:"xui-uicmd-check",style:"{_rowMarkDisplay}"},ROWLRULER:{$order:2,style:"{_treeMode};{_rulerW}"},ROWNUM:{$order:3,className:"xui-ui-readonly",style:"{_rowNumbDisplay}"},ROWTOGGLE:{$order:4,style:"{_treeMode};",className:"xuifont",$fonticon:"{_fi_togglemark}"},LTAGCMDS:{$order:1,tagName:"span",className:"xui-ltag-cmds",style:"{_ltagDisplay}",text:"{ltagCmds}"},FCELLCAPTION:{$order:5,className:"xui-v-node",text:""},FHANDLER:{$order:0,tagName:"div",style:"{rowDDDisplay}"}}}},"rows1._handler_cell2":{FCELL:{$order:0,style:"{rowHandlerDisplay};{_row0DfW};",className:"xui-uiborder-r xui-uiborder-light {cellCls}",CELLA:{tabindex:"{_tabindex}",style:"{cellStyle}{firstCellStyle}",className:"xui-v-wrapper xui-showfocus {cellClass}{firstCellClass}",FHANDLER:{$order:6,tagName:"div",style:"{rowDDDisplay}"}}}},"rows1._firstcell_grp":function(f,e,c,b,a,d){if(f.properties.treeMode!="infirstcell"){return}if(!f.properties.freezedColumn){return}xui.UI.$doTemplate(f,e,c,"rows._firstcell_grp",a)},"rows2._firstcell_grp":function(f,e,c,b,a,d){if(f.properties.treeMode!="infirstcell"){return}if(f.properties.freezedColumn){return}xui.UI.$doTemplate(f,e,c,"rows._firstcell_grp",a)},"rows._firstcell_grp":{GCELL:{$order:0,className:"{cellCls}",GCELLA:{tabindex:"{_tabindex}",style:"{cellStyle}{firstCellStyle}",className:"xui-v-wrapper xui-showfocus {cellClass}{firstCellClass}",MARK:{$order:1,$customId:1,className:"xuifont",$fonticon:"xui-uicmd-check",style:"{_rowMarkDisplay}"},ROWLRULER:{$order:2,$customId:1,style:"{_treeMode};{_rulerW}"},ROWNUM:{$order:3,$customId:1,className:"xui-ui-readonly",style:"{_rowNumbDisplay}"},ROWTOGGLE:{$order:4,$customId:1,style:"{_treeMode};",className:"xuifont",$fonticon:"{_fi_togglemark}"},LTAGCMDS:{$order:1,$customId:1,tagName:"span",style:"{_ltagDisplay}",text:"{ltagCmds}"},FCELLCAPTION:{$order:5,$customId:1,className:"xui-v-node",text:"{caption}"}}}},"rows1.cells":function(g,f,c,b,a,d){if(d>g.properties.freezedColumn){return}b="rows.cells";var e=g.box._tplMap2[c.type]||".input";if(g.properties.treeMode=="infirstcell"&&d==1&&e==".input"){e="._first_cell"}xui.UI.$doTemplate(g,f,c,b+e,a);return b},"rows2.cells":function(g,f,c,b,a,d){if(d<=g.properties.freezedColumn){return}b="rows.cells";var e=g.box._tplMap2[c.type]||".input";if(g.properties.treeMode=="infirstcell"&&d==1&&e==".input"){e="._first_cell"}xui.UI.$doTemplate(g,f,c,b+e,a);return b},"rows.cells._first_cell":{CELL:{style:"width:{_cellWidth};{cellDisplay};",className:"xui-uiborder-r xui-uiborder-light xui-treegrid-fcell {cellCls}",CELLA:{className:"xui-v-wrapper xui-showfocus {cellClass}",style:"{bgcolor};{cellStyle}",tabindex:"{_tabindex}",MARK:{$order:1,$customId:1,className:"xuifont",$fonticon:"xui-uicmd-check",style:"{_rowMarkDisplay}"},ROWLRULER:{$order:2,$customId:1,style:"{_treeMode};{_rulerW}"},ROWNUM:{$order:3,$customId:1,className:"xui-ui-readonly",style:"{_rowNumbDisplay}"},ROWTOGGLE:{$order:4,$customId:1,style:"{_treeMode};",className:"xuifont",$fonticon:"{_fi_togglemark}"},LTAGCMDS:{$order:1,$customId:1,tagName:"span",style:"{_ltagDisplay}",text:"{ltagCmds}"},CELLCAPTION:{$order:5,style:"{color}",className:"xui-v-node xui-treegrid-fcellcaption",text:"{_caption}"}}}},"rows.cells.input":{CELL:{style:"width:{_cellWidth};{cellDisplay};",className:"xui-uiborder-r xui-uiborder-light {cellCls}",CELLA:{className:"xui-v-wrapper xui-showfocus {cellClass}",style:"{bgcolor};{cellStyle}",tabindex:"{_tabindex}",CELLCAPTION:{className:"xui-v-node",style:"{color}",text:"{_caption}"}}}},"rows.cells.textarea":{CELL:{style:"width:{_cellWidth};{cellDisplay};",className:"xui-uiborder-r xui-uiborder-light {cellCls}",CELLA:{className:"xui-v-wrapper xui-showfocus xui-cls-wordwrap {cellClass}",style:"{bgcolor};{cellStyle}",tabindex:"{_tabindex}",CELLCAPTION:{className:"xui-v-node",style:"{color}",text:"{_caption}"}}}},"rows.cells.button":{CELL:{style:"width:{_cellWidth};{cellDisplay};",className:"xui-uiborder-r xui-uiborder-light {cellCls}",CELLA:{tagName:"button",className:"xui-node xui-showfocus xui-wrapper xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius xui-treegrid-tgbtn {cellClass}",style:"{cellStyle}",tabindex:"{_tabindex}",CELLCAPTION:{className:"xui-v-node",text:"{_caption}"}}}},"rows.cells.checkbox":{CELL:{style:"width:{_cellWidth};{cellDisplay}",className:"xui-uiborder-r xui-uiborder-light {cellCls}",CELLA:{className:"xui-v-wrapper xui-showfocus {cellClass}",style:"{cellStyle}",tabindex:"{_tabindex}",CHECKBOX:{className:"xuifont xui-uicmd-check",$fonticon:"{_fi_checkboxCls}"}}}},"rows.cells.progress":{CELL:{style:"width:{_cellWidth};{cellDisplay}",className:"xui-uiborder-r xui-uiborder-light {cellCls}",CELLA:{className:"xui-showfocus {cellClass}",style:"{cellStyle}",tabindex:"{_tabindex}",PROGRESS:{$order:2,tagName:"div",className:"xui-v-wrapper xui-uibar",style:"width:{progress};",CELLCAPTION:{className:"xui-v-node",text:"{_caption}"}}}}},"rows1._handler_cell1.ltagCmds":function(f,e,d,b,a){if(d.id==f.box._temprowid){return}var c=d.buttonType||d.type;xui.UI.$doTemplate(f,e,d,"rows.tagCmds"+(f.box._tplMap[c]||".button"),a)},"rows._firstcell_grp.ltagCmds":function(f,e,d,b,a){var c=d.buttonType||d.type;xui.UI.$doTemplate(f,e,d,"rows.tagCmds"+(f.box._tplMap[c]||".button"),a)},"rows.cells._first_cell.ltagCmds":function(f,e,d,b,a){var c=d.buttonType||d.type;xui.UI.$doTemplate(f,e,d,"rows.tagCmds"+(f.box._tplMap[c]||".button"),a)},"rows2.rtagCmds":function(f,e,d,b,a){var c=d.buttonType||d.type;xui.UI.$doTemplate(f,e,d,"rows.tagCmds"+(f.box._tplMap[c]||".button"),a)},ltagCmds:function(f,e,d,b,a){var c=d.buttonType||d.type;xui.UI.$doTemplate(f,e,d,"rows.tagCmds"+(f.box._tplMap[c]||".button"),a)},rtagCmds:function(f,e,d,b,a){var c=d.buttonType||d.type;xui.UI.$doTemplate(f,e,d,"rows.tagCmds"+(f.box._tplMap[c]||".button"),a)},"rows.tagCmds.text":xui.UI.$getTagCmdsTpl("text"),"rows.tagCmds.button":xui.UI.$getTagCmdsTpl("button"),"rows.tagCmds.image":xui.UI.$getTagCmdsTpl("image")}},Appearances:{KEY:{display:"block",position:"absolute",overflow:"hidden"},BORDER:{"border-top":"solid 1px",margin:"1px 0px 0px 0px"},"LTAGCMDS, RTAGCMDS":{padding:0,margin:0,"vertical-align":"middle"},"HFMARK, MARK":{"margin-left":".5em"},DIRTYMARK:{position:"absolute",width:"1em",height:"1em",left:"1px",top:"1px","z-index":10},BOX:{"border-collapse":"collapse",height:"100%",width:"100%"},"HEADER1, HEADER2":{position:"relative",overflow:"hidden","text-align":"left"},"HI1, HI2":{position:"relative"},"GRPCELLBOX1, GRPCELLBOX2":{position:"absolute",overflow:"visible",left:0,top:0,width:0,height:0},"SCROLL11, SCROLL12, SCROLL21":{position:"relative","text-align":"left"},"SCROLL11, SCROLL12, SCROLL21":{overflow:"hidden"},SCROLL22:{"text-align":"left",overflow:"auto"},ARROW:{position:"absolute","z-index":"20",left:0,top:0,display:"none",width:"auto",height:"auto","font-weight":"bold","text-align":"center","font-size":"2em"},"ARROW:before":{"margin-left":"-50%"},COLLIST:{position:"absolute","z-index":"10",left:0,top:0,cursor:"pointer",visibility:"hidden"},COLLISTDROP:{position:"absolute",left:0,bottom:0,cursor:"pointer"},"BODY11, BODY12, BODY21, BODY22":{overflow:"visible",position:"absolute",left:0,top:0},SORT:{position:"absolute",right:".25em",bottom:".25em"},HHANDLER:{position:"absolute",background:xui.browser.ie?"url("+xui.ini.img_bg+")":null,width:".5em",top:"0",right:"0",height:"100%",cursor:"e-resize"},"HCELLS1, HCELLS2, CELLS1, CELLS2":{"overflow-y":xui.browser.ie?"hidden":"",position:"relative",background:"transparent","white-space":"nowrap"},"HCELLS1, HCELLS2, GRPCELLBOX1, GRPCELLBOX2":{overflow:"visible"},"CELLS1, CELLS2":{overflow:"visible"},"CELLS1-group FCELL, CELLS2-group FCELL":{"border-right":0,"padding-right":"1px",overflow:"visible"},"CELLS1-group FCELLCAPTION, CELLS1-group CELLA,  CELLS1-group GCELLA, CELLS1-group ROWNUM, CELLS2-group FCELLCAPTION, CELLS2-group CELLA, CELLS2-group GCELLA":{"font-weight":"bold",overflow:"visible"},"CELLS1-active, CELLS2-active, CELL-active, CELL-active CELLA":{$order:5,"background-color":"#DDDDDD"},"CELLS1-hot, CELLS2-hot":{$order:6,"background-color":"#FFE97F"},"CELLS2-hot LTAGCMDS, CELLS2-hot RTAGCMDS":{$order:6,display:"none"},"CELLS1-checked, CELLS2-checked, CELLS1-checked .xui-node, CELLS2-checked .xui-node, CELL-checked, CELL-checked .xui-node":{$order:6,"background-color":"#ABABAB",color:"#fff"},"FCELL CELLA, GCELL GCELLA":{"text-align":"left"},"FHCELL HCELLA, HSCELLA":{"text-align":"center"},"CELLCAPTION,HCELLCAPTION,HSCELLCAPTION,SORT,HHANDLER":{"vertical-align":"middle"},"CELLCAPTION,HCELLCAPTION,HSCELLCAPTION,FCELLCAPTION,GRIDCAPTION":{"max-width":"100%","text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden","font-size":"1em"},"FCELL FCELLCAPTION, FHCELL GRIDCAPTION":{display:"inline"},"CELL-textarea CELLCAPTION":{$order:10,"white-space":"normal"},FHANDLER:{position:"absolute",height:".5em",left:"0",width:"100%",bottom:"0",cursor:"n-resize","z-index":10},"FCELLCAPTION, ROWNUM":{"vertical-align":"middle",overflow:"hidden"},"FHCELL, HCELL, HSCELL":{padding:0,"vertical-align":"bottom"},"ROW1, ROW2":{position:"relative",zoom:xui.browser.ie?1:null,width:xui.browser.ie?"100%":null},ROWNUM:{"padding-right":".5em"},"FCELL, CELL":{height:"100%","padding-left":"1px",position:"relative",overflow:xui.browser.ie6?"hidden":"","vertical-align":"top",display:xui.$inlineBlock},GCELL:{height:"100%",width:"100%","padding-left":"1px",position:"relative",overflow:xui.browser.ie6?"hidden":"","vertical-align":"top",display:xui.$inlineBlock},"LHCELL, LCELL":{height:"100%",position:"relative","vertical-align":"top"},"CELLS1-alt, CELLS2-alt":{$order:1,"background-color":"#EFF8FF"},"CELL-input":{},"CELL-number, CELL-spin, CELL-currency":{"text-align":"right"},"CELL-counter":{"text-align":"center"},"CELL-checkbox":{"text-align":"center"},"KEY-tgbtn":{$order:100,width:"100%",padding:0,"vertical-align":"text-bottom","line-height":"100%",height:"100%"},"CELLS1-hover, CELLS2-hover":{$order:4,"background-color":"#F6F6F6"},'CELL-hover, CELL-hover .xui-node[class*="xui-treegrid-"]':{$order:5,"background-color":"#C5C5C5 !important"},"FCELL CELLA, GCELL GCELLA, HCELLA, HSCELLA":{position:"relative","text-overflow":"ellipsis"},"HCELLA, HSCELLA":{$order:3,"text-align":"center","vertical-align":"middle","line-height":"inherit"},"HCELLA, HSCELLA, CELLA, GCELLA":{display:"block",overflow:"hidden","-moz-box-flex":"1","outline-offset":"-1px","-moz-outline-offset":(xui.browser.gek&&xui.browser.ver<3)?"-1px !important":null,height:"100%",width:xui.browser.ie?"100%":"","line-height":"inherit"},"CELLA-inline":{$order:5,display:xui.$inlineBlock,width:"auto","-moz-box-flex":0},PROGRESS:{border:"none",height:"100%","line-height":"1.83333em",overflow:"visible",opacity:0.7,"*filter":"alpha(opacity=70)"},"PROGRESS CELLCAPTION":{overflow:"visible"},"CHECKBOX, MARK":{cursor:"pointer","vertical-align":"middle"},"SUB1, SUM22":{zoom:xui.browser.ie?1:null,height:0,position:"relative",overflow:"visible"},ROWTOGGLE:{padding:"0 .334em 0 0"}},_objectProp:{rowOptions:1,colOptions:1},Behaviors:{BORDER:{},HoverEffected:{ROWTOGGLE:"ROWTOGGLE",GCELL:"GCELL",CELL:"CELL",HCELL:["HCELL","HSCELL"],HSCELL:["HCELL","HSCELL"],FHCELL:"FHCELL",FCELL:"FHCELL",CMD:"CMD",SCROLL22:"SCROLL22",BODY11:"BODY11",BODY12:"BODY12",BODY21:"BODY22",BODY11:"BODY22",HEADER1:"HEADER1",HEADER2:"HEADER2"},ClickEffected:{ROWTOGGLE:"ROWTOGGLE",GCELL:"GCELL",CELL:"CELL",HCELL:["HCELL","HSCELL"],HSCELL:["HCELL","HSCELL"],CMD:"CMD"},DraggableKeys:["FCELL"],DroppableKeys:["SCROLL21","SCROLL22","CELLS1","CELLS2","FCELL"],HFMARK:{onClick:function(a,c,d){if(a.properties.selMode!="multi"&&a.properties.selMode!="multibycheckbox"){return}var b=[];xui.each(a.rowMap,function(e){b.push(e.id)});if(a._$checkAll){delete a._$checkAll;a.boxing().setUIValue("",null,null,"checkbox");xui.use(d).tagClass("-checked",false);a.boxing().onRowSelected(a,"allrows",c,d,-1)}else{a._$checkAll=true;xui.use(d).tagClass("-checked");a.boxing().setUIValue(b.join(a.properties.valueSeparator),null,null,"click");a.boxing().onRowSelected(a,"allrows",c,d,1)}return false}},TRLOCKED1:{onMouseover:function(a,b,c){a.box.$cancelHoverEditor(a)}},TRTAIL:{onMouseover:function(a,b,c){a.box.$cancelHoverEditor(a)}},TDBODY21:{onMouseover:function(a,b,c){a.box.$cancelHoverEditor(a)}},TRHEADER:{onMouseover:function(a,b,c){a.box.$cancelHoverEditor(a)}},SCROLL22:{swipedown:function(a,d,f){var c=a.getItemByDom(f),b=a.boxing();if(a.swipedown){b.swipedown(a,c,d,f);return false}},swipeleft:function(a,d,f){var c=a.getItemByDom(f),b=a.boxing();if(a.swipeleft){b.swipeleft(a,c,d,f);return false}},swipeup:function(a,d,f){var c=a.getItemByDom(f),b=a.boxing();if(a.swipeup){b.swipeup(a,c,d,f);return false}},onScroll:function(c,f,g){var d=xui.use(g).get(0),a=d.scrollLeft||0,b=d.scrollTop||0;if(c.$sl!=a){c.getSubNodes(["HEADER2","SCROLL12"]).scrollLeft(c.$sl=a)}if(c.$st!=b){c.getSubNode("SCROLL21").get(0).scrollTop=c.$st=b;if((b=c.getSubNode("SCROLL21").get(0).scrollTop)&&b!=c.$st){d.scrollTop=c.$st=b}}}},SCROLL21:{onScroll:function(b,d,f){var c=xui.use(f).get(0),a=c.scrollTop||0;if(b.$st!=a){b.getSubNode("SCROLL22").get(0).scrollTop=b.$st=a}}},HEADER2:{onScroll:function(b,d,f){var c=xui.use(f).get(0),a=c.scrollLeft||0;if(b.$sl!=a){b.getSubNodes(["SCROLL12","SCROLL22"]).scrollLeft(b.$sl=a)}}},SCROLL12:{onScroll:function(b,d,f){var c=xui.use(f).get(0),a=c.scrollLeft||0;if(b.$sl!=a){b.getSubNodes(["HEADER2","SCROLL22"]).scrollLeft(b.$sl=a)}}},HHANDLER:{beforeMousedown:function(j,m,a){if(xui.Event.getBtn(m)!="left"){return}var d=j.properties,c=j.getSubId(a),g=j.colMap[c],f;if(g&&g._isgroup){f=j.getSubNode("HHANDLER",j.properties.header[g.to]._serialId)}else{f=xui(a)}var l=f.parent(2).width()-j.$px(d._minColW),n=j.getSubNode("SCROLL22"),b=n.offset().left+n.width()-xui.Event.getPos(m).left-4;if(d.disabled){return false}if(g&&g.disabled){return false}f.startDrag(m,{horizontalOnly:true,dragType:"blank",dragDefer:2,maxLeftOffset:l,maxRightOffset:b,targetReposition:false});xui.use(a).parent(2).onMouseout(true,{$force:true}).onMouseup(true)},onDragbegin:function(a,b,c){xui.DragDrop.getProfile().proxyNode.css({height:a.getRoot().height()+"px",width:"4px",backgroundColor:"#DDDDDD",cursor:"e-resize"})},onDrag:function(c,g,l){var j=xui.DragDrop,f=j.getProfile(),a=0;if(f.x<=f.restrictedLeft||f.x>=f.restrictedRight){a=true}if(a){if(!c._limited){f.proxyNode.css("backgroundColor","#ff6600");c._limited=true}}else{if(c._limited){f.proxyNode.css("backgroundColor","#DDDDDD");c._limited=0}}},onDragstop:function(g,n,b){var c=g.properties,d=xui(b).parent(2),r=g.keys,f=g.colMap[g.getSubId(b)],j=d.width(),s=j+xui.DragDrop.getProfile().offset.x,u;if(f){if(f&&f._isgroup){f=g.properties.header[f.to];d=g.getSubNode("HCELL",f._serialId)}if(f.hasOwnProperty("maxWidth")){s=Math.min(g.$px(f.maxWidth),s)}if(f.hasOwnProperty("minWidth")){s=Math.max(g.$px(f.minWidth),s)}}if(g.beforeColResized&&false===g.boxing().beforeColResized(g,f?f.id:null,s)){g._limited=0;return}u=g.$forceu(s);d.width(u);if(f){if(f.flexSize){var u=parseFloat(f.width),m=s/g._relAvailable,q=j/g._relAvailable;f.width=(u/q-u)*m/(1-m)+g.$picku(f.width)}else{f.width=u}f._colWidth=u}var a=[],l=[];if(g.getKey(xui.use(b).parent(2).id())==r.FHCELL){g.box._setRowHanderW(g,s)}else{var A=f._cells,x;xui.each(A,function(e){if(!(x=g.getSubNode(r.CELL,e)).isEmpty()){a.push(x.id())}});g.box._adjusteditorW(g,xui(a).width(u),s)}if(g.afterColResized){g.boxing().afterColResized(g,f?f.id:null,s)}g.getSubNode("SCROLL22").onScroll();g.box._adjustColsWidth(g);g.box._adjustBody(g,"setcol");g._limited=0},onClick:function(){return false},onDblclick:function(j,m,a){var d=j.properties,f=xui.use(a).parent(2),c=j.getSubId(a);col=j.colMap[c];if(col&&col._isgroup){col=j.properties.header[col.to];f=j.getSubNode("HCELL",col._serialId)}if(col&&col.flexSize){return}if(j.getRootNode().clientHeight<=0){return}if(j.getKey(xui.use(a).parent(2).id())==j.keys.FHCELL){j.box._setRowHanderW(j,true);return}var s=col._cells,u=j.getClass("CELLA","-inline"),g,b=[],l=[],q,r;xui.each(s,function(e){g=j.getSubNode("CELLA",e);if(g._nodes.length){b.push(g.get(0));l.push(g.addClass(u).width())}});if(d.treeMode=="infirstcell"&&d.header[0]==col){j.getSubNode("GCELLA",true).each(function(e){l.push(xui(e).addClass(u).width());xui(e).removeClass(u)})}l.push(j.$px(d._minColW));q=parseFloat(Math.max.apply(null,l));if(q>j.$px(d._maxColW)){q=j.$px(d._maxColW)}if(j.beforeColResized&&false===j.boxing().beforeColResized(j,col?col.id:null,q)){return}if(col){if(col.hasOwnProperty("maxWidth")){q=Math.min(j.$px(col.maxWidth),q)}if(col.hasOwnProperty("minWidth")){q=Math.max(j.$px(col.minWidth),q)}}q+=2;r=j.$forceu(q);j.box._adjusteditorW(j,xui(b).parent().width(r),q);f.width(col.width=col._colWidth=r);xui(b).removeClass(u);if(j.afterColResized){j.boxing().afterColResized(j,col.id,q)}j.box._adjustColsWidth(j);j.box._adjustBody(j,"setcol");return false}},FHANDLER:{beforeMousedown:function(d,f,a){if(xui.Event.getBtn(f)!="left"){return}var b=d.properties,l=d.rowMap[d.getSubId(a)],c=xui(a),m=c.parent(3).height()-d.$px(b._minRowH),j=d.getSubNode("SCROLL21"),g=j.offset().top+j.height()-xui.Event.getPos(f).top-4;if(b.disabled||(l&&l.disabled)){return false}c.startDrag(f,{verticalOnly:true,dragType:"blank",dragDefer:2,maxTopOffset:m,maxBottomOffset:g,targetReposition:false});xui.use(a).parent(2).onMouseout(true,{$force:true}).onMouseup(true);if(!l){d.getSubNode("COLLIST").css("visibility","hidden")}},onDragbegin:function(a,b,c){xui.DragDrop.getProfile().proxyNode.css({width:a.getRoot().width()+"px",height:"4px",backgroundColor:"#DDDDDD",cursor:"n-resize"})},onDrag:function(c,g,l){var j=xui.DragDrop,f=j.getProfile(),a=0;if(f.y<=f.restrictedTop||f.y>=f.restrictedBottom){a=true}if(a){if(!c._limited){f.proxyNode.css("backgroundColor","#ff6600");c._limited=true}}else{if(c._limited){f.proxyNode.css("backgroundColor","#DDDDDD");c._limited=0}}},onDragstop:function(f,m,a){var b=f.getSubId(a),d=xui(a).parent(3),l=d.height()+xui.DragDrop.getProfile().offset.y,n=f.rowMap[f.getSubId(a)],c=f.properties,j=c.header,g=c.headerHeight;if(xui.browser.ie&&xui.browser.ver<=8&&l%2==1){l+=1}if(f.beforeRowResized&&false===f.boxing().beforeRowResized(f,n?n.id:null,l)){f._limited=0;return}if(f.getKey(xui.use(a).parent(2).id())==f.keys.FHCELL){c.headerHeight=f.$forceu(l);f.box._adjustColsHeight(f);f.adjustSize()}else{n.height=f.$forceu(l);f.getSubNode("CELLS2",b).height(n.height);d.height(n._rowHeight=n.height);f.box._adjusteditorH(f,d,n._rowHeight)}if(f.afterRowResized){f.boxing().afterRowResized(f,n?n.id:null,l)}f.box._adjustBody(f,"setrow");f._limited=0},onDblclick:function(d,f,j){var l=d.properties,a=d.getSubId(j),g,b;if(d.getRootNode().clientHeight<=0){return}if(a){g=d.rowMap[a];b=d.getSubNodes(["CELLS2","CELLS1"],a);var c=b.height("auto").height();if(d.beforeRowResized&&false===d.boxing().beforeRowResized(d,g.id,c)){return}b.height(g.height=g._rowHeight=d.$forceu(c));d.box._adjusteditorH(d,b,c)}else{var c=(d._headerLayers||0+1)*d.$px(d.box.$DataStruct.headerHeight);if(d.beforeRowResized&&false===d.boxing().beforeRowResized(d,null,c)){return}d.box._adjustColsHeight(d,true);l.headerHeight=d.$forceu(c,d.$picku(l.headerHeight));d.adjustSize()}if(d.afterRowResized){d.boxing().afterRowResized(d,g?g.id:null,c)}d.box._adjustBody(d,"setrow");return false},onClick:function(){return false}},ROWTOGGLE:{onClick:function(b,d,g){var c=b.properties,a,f=b.rowMap[b.getSubId(g)];if(!f){a=b.cellMap[b.getSubId(g)];if(a){f=a._row}}if(!f){return}if(c.disabled||f.disabled){return false}if(!f.sub){return}b.box._setSub(b,f,!f._checked);return false},beforeMousedown:function(){return false}},HSCELLA:{onClick:function(a,b,c){a.getSubNode("HCELLA",a.getSubId(c)).onClick(true)}},HCELLA:{onClick:function(g,m,a){var c=g.properties,b=g.getSubId(a),d=g.colMap[b];if(!d){if(g.onClickGridHandler){g.boxing().onClickGridHandler(g,m,a)}if(c.disabled){return false}if(!c.colSortable){return}}else{if(g.onClickHeader){g.boxing().onClickHeader(g,d,m,a)}if(c.disabled||d.disabled){return false}if(!(d.hasOwnProperty("colSortable")?d.colSortable:c.colSortable)){return}}if(d&&d._isgroup){d=g.properties.header[d.from]}if(g.beforeColSorted&&false===g.boxing().beforeColSorted(g,d)){return false}var j=(d?d._order:g._order)||false,q=(d?d.type:null)||"input",r=d?d.sortby:null,l=d?xui.arr.indexOf(c.header,d):-1,o=arguments.callee,n=o.fun||(o.fun=function(e,F,E,x,M,P,L,K){var I,D,B,O=arguments.callee;if(F){I=F.sub;D=e.getSubNode("SUB1",F._serialId).get(0);B=e.getSubNode("SUB2",F._serialId).get(0)}else{F={_inited:true};I=e.properties.rows;D=e.getSubNode("ROWS21").get(0);B=e.getSubNode("ROWS22").get(0)}var Z=[],X=[],U=[],J,N;var C=[],A=[],Y=[],W=[];xui.arr.each(I,function(aa){if(aa._region==1){return}if(aa.sub&&aa.sub.length>1){O(e,aa,E,x,M,P,null)}Z[Z.length]=E==-1?aa.caption:(J=aa.cells)?(J=J[E])?J.value:"":aa[E];U[U.length]=E==-1?aa:(J=aa.cells)?J[E]:aa[E];X[X.length]=X.length});var R;if(typeof M!="function"){switch(x){case"number":case"spin":case"counter":case"currency":N=function(aa){return parseFloat(aa)||0};break;case"datetime":case"date":N=function(aa){return xui.isDate(aa)?aa.getTime():xui.isFinite(aa)?parseInt(aa,10):0};break;default:N=function(aa){return aa||""}}R=function(aa,ad){var ab=N(Z[aa]),ac=N(Z[ad]);return(ab>ac?(P?1:-1):ab===ac?(aa>ad?-1:1):(P?-1:1))}}else{R=function(aa,ab){return M.apply(e,[aa,ab,Z,P,E,U])}}X.sort(R);var T=F._inited,V=xui.copy(I),S;if(T){C=D.childNodes;A=B.childNodes}xui.arr.each(X,function(ab,aa){I[aa]=V[ab];if(T){Y[aa]=C[ab];W[aa]=A[ab]}});if(T){var H=document.createDocumentFragment(),G=document.createDocumentFragment();for(var Q=0;J=Y[Q];Q++){H.appendChild(J)}for(var Q=0;J=W[Q];Q++){G.appendChild(J)}if(L){D.insertBefore(H,L);B.insertBefore(G,K)}else{D.appendChild(H);B.appendChild(G)}}});var w,u,s;if(g.__hastmpRow){w=g.properties.rows.pop();u=g.getSubNode("ROWS21").get(0).lastChild;s=g.getSubNode("ROWS22").get(0).lastChild}n(g,null,l,q,r,j,u,s);if(g.__hastmpRow){g.properties.rows.push(w)}g.getSubNode("SORT",true).css("display","none");var f=(d?g.getSubNode("SORT",d._serialId):g.getSubNode("SORT")).css("display","");f.tagClass("-checked",d?(!(d._order=!d._order)):(!(g._order=!g._order)));g.box._asy(g);delete g.$allrowscache1;delete g.$allrowscache2;if(g.afterColSorted){g.boxing().afterColSorted(g,d)}},beforeMousedown:function(b,d,j){if(xui.Event.getBtn(d)!="left"){return}var c=b.properties;if(c.disabled){return}var a=b.colMap[b.getSubId(j)];if(!a||a._isgroup){return}if(c.disabled||a.disabled){return false}if(c.treeMode=="infirstcell"&&c.header[0]==a){return false}if(!(a.hasOwnProperty("colMovable")?a.colMovable:c.colMovable)){return}if(false===b.boxing().beforeColDrag(b,a.id)){return}var l=xui.Event.getPos(d),g=xui(j),f=b.getSubId(j);g.startDrag(d,{dragType:"icon",shadowFrom:g.parent(),dragCursor:"pointer",targetLeft:l.left+12,targetTop:l.top+12,targetReposition:false,dragDefer:2,dragKey:b.$xid+":col",dragData:g.parent().id(),tagVar:a._region})},onDragbegin:function(a,b,c){xui(c).parent().onMouseout(true,{$force:true});xui(c).onMouseup(true)},beforeMouseover:function(g,l,a){var c=g.properties,b=g.getSubId(a),d=g.colMap[b];if(!d||d._isgroup){return}if(c.disabled||d.disabled){return false}var j=xui.DragDrop.getProfile();if(!j.dragData||j.dragKey!=g.$xid+":col"){return}if(j.tagVar!=d._region){return}var n=xui.use(a).parent().xid();if(false===g.box._colDragCheck(g,n)){return}xui.DragDrop.setDropElement(a).setDropFace(a,"move");var o=xui.use(n).get(0),f=o.offsetLeft+(d._region==2?g._leftregionw:0),m=o.offsetTop+o.offsetHeight;g.getSubNode("ARROW").left(f).top(m).css("display","block")},beforeMouseout:function(c,f,g){var d=c.properties,l=c.getSubId(g),b=c.colMap[l];if(!b){return}if(d.disabled||b.disabled){return false}var j=xui.DragDrop.getProfile();if(!j.dragData||j.dragKey!=c.$xid+":col"){return}var a=xui.use(g).parent().xid();xui.DragDrop.setDropElement(null).setDropFace(null,"none");if(false===c.box._colDragCheck(c,a)){return}c.getSubNode("ARROW").css("display","none")},onDrop:function(d,D,o){var w=d.properties,u=d.box,x=d.getSubId(o),l=xui.UI.$tag_subId,g=d.colMap[x];if(!g){return}if(w.disabled||g.disabled){return false}var H=xui.use(o).parent().xid();d.getSubNode("ARROW").css("display","none");if(false===u._colDragCheck(d,H)){return}var G=xui.DragDrop.getProfile().dragData,q=G&&d.getSubId(G),s=d.getSubId(H),F=d.colMap,a=F[q],c=F[s];if(false===d.boxing().beforeColMoved(d,a.id,c.id)){return}xui.DragDrop.setDropFace(H,"none");var f=xui.arr.subIndexOf(w.header,"_serialId",q),B=xui.arr.subIndexOf(w.header,"_serialId",s);if(f===B||f===B-1){return}d.getSubNode("HCELL",s).addPrev(xui(xui.DragDrop.getProfile().dragData));xui.each(c._cells,function(j,e){d.getSubNode("CELL",j).addPrev(d.getSubNode("CELL",a._cells[e]))});var E=w.header[f];xui.arr.insertAny(w.header,E,B);xui.arr.removeFrom(w.header,f+(f>B?1:0));var n=d.queryItems(w.rows,true,true);xui.arr.each(n,function(e){e=e.cells?e.cells:e;if(!e||!xui.isArr(e)){return}E=e[f];xui.arr.removeFrom(e,f);xui.arr.insertAny(e,E,B)});var b=w.grpCols;if(b&&xui.isArr(b)&&b.length){for(var C=0,A=b.length,r;C<A;C++){r=b[C];if(r.from>B){r.from++;r.to++}else{if(B>=r.from&&B<=r.to){r.to++}}}for(var C=0,A=b.length,r;C<A;C++){r=b[C];if(r.from>f){r.from--;r.to--}else{if(f>=r.from&&f<=r.to){r.to--}}}xui.filter(b,function(j){var e=j.to>=j.from;if(!e&&d.renderId){d.getSubNodes(["HCELL","HSCELL"],j[l]).remove();delete d.colMap[j[l]];delete d.colMap2[j.id]}return e});w.grpCols=u._adjustGrpColsData(d,b);u._adjustColsWidth(d);u._adjustColsHeight(d)}d.boxing().afterColMoved(d,a.id,c.id);delete d.$allrowscache1;delete d.$allrowscache2},onMouseover:function(f,g,a){var c=f.properties,b=f.getSubId(a),d=f.colMap[b];if(d){if(c.disabled||d.disabled){return false}if(!(d.hasOwnProperty("colHidable")?d.colHidable:c.colHidable)){return}if(!(d.hasOwnProperty("colDroppable")?d.colDroppable:c.colDroppable)){return}}else{if(c.disabled){return false}if(!c.colHidable){return}}xui.resetRun(f.$xid+":collist",null);var l={},j=xui.use(a).parent().offset(null,f.getSubNode("BOX")),m=xui.use(a).parent().cssSize();if(m.width<16){return}l.height=f.$forceu(m.height);l.left=f.$forceu(j.left);l.top=f.$forceu(j.top);f.getSubNode("COLLIST").cssRegion(l).css("visibility","visible")},onMouseout:function(b,d,f){var c=b.properties,g=b.getSubId(f),a=b.colMap[g];if(a){if(c.disabled||a.disabled){return false}if(!(a.hasOwnProperty("colHidable")?a.colHidable:c.colHidable)){return}}else{if(c.disabled){return false}if(!c.colHidable){return}}xui.resetRun(b.$xid+":collist",function(){if(!b.box){return}b.getSubNode("COLLIST").css({visibility:"hidden",left:0+b.$picku(),top:0+b.$picku()})})},onContextmenu:function(b,c,d){if(b.onContextmenu){var a=b.getSubId(d);return b.boxing().onContextmenu(b,c,d,a?b.colMap[a]:null,xui.Event.getPos(c))!==false}}},COLLIST:{onMouseover:function(a,b,c){xui.resetRun(a.$xid+":collist",null)},onMouseout:function(a,b,c){xui.resetRun(a.$xid+":collist",function(){if(!a.box){return}xui.use(c).css("visibility","hidden")})},onClick:function(c,f,g){var d=c.properties;if(!c.$col_pop){var b=[],a;xui.arr.each(c.properties.header,function(e){if(e.hasOwnProperty("colHidable")?e.colHidable:d.colHidable){b.push({id:e.id,caption:e.caption,type:"checkbox",value:e.hidden!==true})}});if(b.length){a=c.$col_pop=new xui.UI.PopMenu({hideAfterClick:false,items:b}).render(true);a.onMenuSelected(function(m,j,l){var e=1;xui.arr.each(m.properties.items,function(n){if(n.value!==false){return e=false}});if(!e){c.boxing().showColumn(j.id,j.value)}else{m.getSubNodeByItemId("CHECKBOX",j.id).tagClass("-checked");j.value=true}})}}if(c.$col_pop){c.$col_pop.pop(g)}}},CELLS2:{afterMouseover:function(b,d,g){var c=b.properties;if(c.disabled){return}if(c.disableHoverEffect===true){return}if(c.disableHoverEffect&&/\bCELLS2\b/.test(c.disableHoverEffect||"")){return}var a=b.getSubId(g);b.getSubNodes(["CELLS1","CELLS2"],a).tagClass("-hover");if(b.onRowHover){var f=b.rowMap[a];b.boxing().onRowHover(b,f,true,d,g)}},afterMouseout:function(b,d,g){var c=b.properties;if(c.disabled){return}if(c.disableHoverEffect===true){return}if(c.disableHoverEffect&&/\bCELLS2\b/.test(c.disableHoverEffect||"")){return}var a=b.getSubId(g);b.getSubNodes(["CELLS1","CELLS2"],a).tagClass("-hover",false);if(b.onRowHover){var f=b.rowMap[a];b.boxing().onRowHover(b,f,false,d,g)}},onDblclick:function(d,f,a){var c=d.properties,m=d.rowMap[d.getSubId(a)],l=xui.Event.getSrc(f),b=l&&(l.id||""),g=d.keys,j=d.getKey(b);while(!j){l=l.offsetParent;j=d.getKey(b=l.id)}if(!m||c.disabled||m.disabled){return false}if(b&&xui.UIProfile.getFromDom(b)!=d){return false}if(j==g.ROWTOGGLE||j==g.MARK){return false}if(d.onDblclickRow){if(m){d.boxing().setActiveRow(m.id)}d.boxing().onDblclickRow(d,m,f,a)}return false},onClick:function(c,f,j){var d=c.properties,a=c.getSubId(j),l=c.keys,g=c.rowMap[a],b=xui.Event.getSrc(f).id||"";if(d.disabled||g.disabled){return false}if(b&&xui.UIProfile.getFromDom(b)!=c){return false}if(c.onClickRow){if(g){c.boxing().setActiveRow(g.id)}c.boxing().onClickRow(c,g,f,j);c.boxing().swiperight(c,g,f,j)}}},CELL:{onMouseover:function(c,j,l){if(false==c.box.$cancelHoverEditor(c)){return}var d=c.box,g=c.properties,a=xui.use(l).id(),b;if(g.disableHoverEffect===true){return}if(g.disableHoverEffect&&/\bCELL\b/.test(g.disableHoverEffect||"")){return}a=a.split(":")[2];if(!a){return}a=c.cellMap[a];if(!a){return}if(d.getCellOption(c,a,"disabled")){return}var f=d.getCellOption(c,a,"editMode");if(d.getCellOption(c,a,"editable")&&xui.str.startWith(f,"hover")){if(f=="hoversharp"&&d.getCellOption(c,a,"type")=="file"){}else{xui.resetRun(c.key+":"+c.$xid+":hovereditor",function(){if(c.destroyed){return}c.box._editCell(c,c.getSubId(l),true)});return false}}}},GCELL:{onMouseover:function(a,b,c){a.box.$cancelHoverEditor(a)}},CELLA:{onDblclick:function(c,j,a){var m=c.cellMap[c.getSubId(a)];if(!m){return}if(c.properties.disabled){return}var g=c.box,f=g.getCellOption,l=f(c,m,"type"),d=f(c,m,"disabled"),b=f(c,m,"editable");if(!d&&(!b||(l=="button"||l=="label"))){c.boxing().onDblclickCell(c,m,j,a);if(l=="button"){return false}}},afterMousedown:function(a,b,c){xui.setNodeData(c,"_tmp_forcefocus")},onClick:function(c,x,j){var q=c.properties,m=c.box,A=m.getCellOption,b=c.cellMap[c.getSubId(j)],r;if(b){if(c.properties.disabled){return false}var d=A(c,b,"type"),f=A(c,b,"disabled"),o=A(c,b,"readonly"),u=A(c,b,"event"),n=q.activeMode,s=A(c,b,"editable");if(!f&&(!s||(d=="button"||d=="label"))){if(typeof u=="function"&&false===u.call(c._host||c,c,b,null,null,x,j)){}else{if(c.onClickCell){c.boxing().onClickCell(c,b,x,j)}}if(d=="button"){return false}}if(!f&&!o&&d=="checkbox"){if(s){m._updCell(c,b,!b.value,q.dirtyMark,true,true);c.box._trycheckrowdirty(c,b);var w=b._row.id==c.box._temprowid;if(w){c.__needchecktmprow=true;c.box._sethotrowoutterblur(c)}}}if(!q.editable){if(n=="cell"){if(A(c,b,"disabled")){return false}r=xui(j).parent().id();m._sel(c,"cell",j,r,x)}else{if(n=="row"){if(q.disabled||b._row.disabled){return false}r=xui(j).parent(3).id();m._sel(c,"row",j,r,x)}}}else{if(q.activeMode=="row"){r=xui(j).parent(3).id();m._sel(c,"row",j,r,x)}}}else{var g=c.rowMap[c.getSubId(j)];if(q.disabled||g.disabled){return false}if(c.keys.MARK){var l=c.getKey(xui.Event.getSrc(x).id||""),a=l==c.keys.MARK}if(!a){if(typeof u=="function"&&false===u.call(c._host||c,c,g,null,null,x,j)){}else{if(c.onClickRowHandler){if(g){c.boxing().setActiveRow(g.id)}c.boxing().onClickRowHandler(c,g,x,j)}}if(g.group){c.box._getToggleNode(c,g._serialId).onClick()}}if(q.activeMode=="row"){r=xui(j).parent(3).id();m._sel(c,"row",j,r,x)}}if(c.box){if(xui.use(j).get(0)){if(!xui.getNodeData(j,"_tmp_forcefocus")){c.box._focusEvent(c,x,j)}}}},onFocus:function(a,b,c){xui.setNodeData(c,"_tmp_forcefocus",1);a.box._focusEvent(a,b,c)},onKeydown:function(f,V,B){var X={tab:1,left:1,right:1,up:1,down:1},I=xui.Event.getKey(V),u=I.key;if(u=="enter"){xui(B).onClick();return}if(!X[u]){return}var L=f.cellMap[f.getSubId(B)];if(f.beforeCellKeydown&&false===f.boxing().beforeCellKeydown(f,L,I)){return false}var R=f.properties,K=I.shiftKey,U=I.ctrlKey,j=xui(B),O=f.getSubNode("SCROLL11"),N=f.getSubNode("SCROLL12"),A=f.getSubNode("SCROLL21"),x=f.getSubNode("SCROLL22"),T=new RegExp("^"+f.box.$Keys.CELLA+":"+f.serialId+":"),w=!!N.offsetWidth(),b=!!A.offsetWidth(),a=!!x.offsetHeight(),G=O.nextFocus(true,true,false,T),F=N.nextFocus(true,true,false,T),m=A.nextFocus(true,true,false,T),l=x.nextFocus(true,true,false,T),D=O.nextFocus(false,true,false,T),C=N.nextFocus(false,true,false,T),d=A.nextFocus(false,true,false,T),c=x.nextFocus(false,true,false,T),n=w?b?G:F:b?m:l,s=x?c:N?C:A?d:D,M=j.parent(),H=M.parent().id(),q=f.getSubId(H),o=L?L._row:f.rowMap[f.getSubId(B)],P=o&&o.id==f.box._temprowid,W=L?(L._row._region+""+L._col._region):(o._region+"1"),Q;var E=function(e){if(B!=n.xid()){var Y;if(!M.get(0).previousSibling||!M.get(0).previousSibling.clientWidth){switch(W){case"11":case"21":if(a){if(B==m.xid()){C.focus(true);Y=1}else{var Z=f.getSubNode("ROW2",q).prev();if(Z){Z.nextFocus(false,true,true,T);Y=1}}}break;case"12":case"22":if(b){f.getSubNode("CELLS1",q).last(2).focus(true);Y=1}break}}if(!Y){j.nextFocus(false,false,true,T)}return false}else{if(e){s.focus(true)}}},g=function(e){if(B!=s.xid()){var Y;if(W=="11"||W=="21"?!M.get(0).nextSibling:(!(Q=M.get(0).nextSibling)||!Q.clientWidth)){switch(W){case"11":case"21":if(a){f.getSubNode("CELLS2",q).first(2).focus(true);Y=1}break;case"12":case"22":if(b){if(B==C.xid()){m.focus(true);Y=1}else{var Z=f.getSubNode("ROW1",q).next();if(Z){Z.nextFocus(true,true,true,T);Y=1}}}break}}if(!Y){j.nextFocus(true,false,true,T)}return false}else{if(e){J()}}},r=function(Y){var aa=1,af=j.parent().get(0),ac=af.parentNode.childNodes.length;while(af=af.previousSibling){aa++}af=j.parent(2).get(0);if(!f.$allrowscache2){f.box._cacheRows(f)}var ab=xui.arr.indexOf(W=="12"||W=="22"?f.$allrowscache2:f.$allrowscache1,af),ad=f.$allrowscache2.length,Z=0;if(u=="up"){ab--;if(ab==-1){ab=ad-1;aa--;if(aa==0){aa=ac}}}else{ab++;if(ab==ad){Z=1;ab=0;aa++;if(aa==ac+1){aa=1}}}var e=xui((W=="12"||W=="22"?f.$allrowscache2:f.$allrowscache1)[ab]).first(),ae=e;if(aa>1){ae=ae.next(aa-1)}if(ae.isEmpty()){ae=e}if(ae&&!ae.isEmpty()){ae=ae.first()}if(!ae.isEmpty()){return[ae,Z]}return null},S=function(){var e;if(B!=n.xid()){if(j.get(0)==F.get(0)||j.get(0)==l.get(0)){if(b){e=d}else{e=D}}if(!e){e=r(true)[0]}}else{e=s}if(e){e.focus(true)}},J=function(){var ab,aa;if(B!=s.xid()){if(j.get(0)==D.get(0)||j.get(0)==d.get(0)){if(w){aa=F}else{aa=l}}if(!aa){aa=r();ab=aa[1];aa=aa[0]}}else{aa=n;ab=1}if(ab&&R.hotRowMode!="none"){var e;if(!L){var Z=f.rowMap[f.getSubId(B)];if(!Z){return false}}e=(R.hotRowRequired||"").split(R.valueSeparator)[0]||(L&&L._col&&L._col.id);var Y=true;if(f.__hastmpRow){Y=f.box._checkNewLine(f,"keydown");if(!f.$allrowscache2){f.box._cacheRows(f)}}if(Y){f.box._addTempRow(f,e);return false}}else{if(aa){aa.focus(true)}}};switch(u){case"tab":if(K){if(false===E(P)){return false}}else{if(false===g(P)){return false}}break;case"left":if(false===E(true)){return false}break;case"right":if(false===g(true)){return false}break;case"up":if(U){if(o&&!(R.disabled||o.disabled)&&(o.group||o.sub)){f.box._getToggleNode(f,o._serialId).onClick();return false}}S();return false;break;case"down":if(U){if(o&&!(R.disabled||o.disabled)&&(o.group||o.sub)){f.box._getToggleNode(f,o._serialId).onClick();return false}}J();return false;break}},onContextmenu:function(b,c,d){if(b.onContextmenu){var a=b.getSubId(d);return b.boxing().onContextmenu(b,c,d,a?(b.cellMap[a]||b.rowMap[a]):null,xui.Event.getPos(c))!==false}}},CMD:{onClick:function(a,d,g){var c=a.properties,j=xui.use(g).id().split("_"),b=j[j.length-1];j.pop();var f=a.rowMap[a.getSubId(j.join("_"))];if(c.disabled||(f&&f.disabled)){return false}if(a.onCmd){if(f){a.boxing().setActiveRow(f.id)}a.boxing().onCmd(a,f,b,d,g)}return false}}},DataModel:{expression:{ini:"",action:function(){}},directInput:true,listKey:null,currencyTpl:"$ *",numberTpl:"",valueSeparator:";",activeRow:{hidden:true,ini:null},activeCell:{hidden:true,ini:null},rowMap:{hidden:true,ini:null},selMode:{ini:"none",listbox:["single","none","multi","multibycheckbox"],action:function(a){this.getSubNodes(["HFMARK","MARK"],true).css("display",(a=="multi"||a=="multibycheckbox")?"":"none")}},editMode:{ini:"focus",listbox:["focus","sharp","hover","hoversharp","inline"]},dock:"fill",togglePlaceholder:false,isFormField:{hidden:true,ini:false},altRowsBg:{ini:false,action:function(g){var d=this;var c=d.getClass("CELLS1","-alt"),a=d.getSubNode("CELLS1",true),l=d.getSubNode("CELLS2",true),b,f,e;a.removeClass(c);l.removeClass(c);if(g){alt=[];b=0;l.each(function(m,j){if(m.clientHeight){m=xui([m]);f=xui([a.get(j)]);if((b++)%2==1){if(!f.hasClass(c)){f.addClass(c)}if(!m.hasClass(c)){m.addClass(c)}}else{if(f.hasClass(c)){f.removeClass(c)}if(m.hasClass(c)){m.removeClass(c)}}}})}}},rowNumbered:{ini:false,action:function(o){var n=this,j=n.CF.getNumberedStr||function(f){return f},c=n.getSubNode("ROWNUM",true),g=0,b=n.rowMap,u,m=0,e=0,d=[],a=[],s="",q,r;c.css("display",o?"":"none");if(o){c.each(function(f){if(u=b[n.getSubId(f.id)]){e=u._layer;if(e>m){d.push(g);a.push(s);s=s+g+".";g=0}else{if(e<m){while(e<m--){g=d.pop();s=a.pop()}}}g++;m=e;u._autoNumber=j(s+g);q=u.rowNumber||u._autoNumber;if(r=f.firstChild){if(r.nodeValue!=q){r.nodeValue=q}}else{f.appendChild(document.createTextNode(q))}}})}else{c.text("")}}},editable:false,firstCellEditable:false,$subMargin:"1.375em",iniFold:true,animCollapse:false,position:"absolute",width:"25em",height:"18em",_minColW:".5em",_maxColW:"25em",_minRowH:"1.83333em",gridHandlerCaption:{ini:"",action:function(a){a=(xui.isSet(a)?a:"")+"";this.getSubNode("GRIDCAPTION").html(xui.adjustRes(a,true))}},headerTail:{ini:"",action:function(a){a=(xui.isSet(a)?a:"")+"";this.getSubNode("LHCELLINNER").html(xui.adjustRes(a,true))}},rowHandlerWidth:{$spaceunit:1,ini:"5em",set:function(a){var b=this;if(b.renderId){b.box._setRowHanderW(b,a)}else{b.properties.rowHandlerWidth=a}}},showHeader:{ini:true,action:function(a){this.getSubNodes(["HEADER1","HEADER2"]).css("display",a?"":"none")}},headerHeight:{$spaceunit:1,ini:"2em",action:function(a){var b=this,c=b.properties;b.box._adjustColsHeight(b);b.adjustSize()}},rowHeight:{$spaceunit:1,ini:"2em",action:function(a){this.box._adjusteditorH(this,this.getSubNodes(["CELLS1","CELLS2"],true).height(a),a)}},_colDfWidth:"8em",rowHandler:{ini:true,action:function(a){this.getSubNode("FHCELL").css("display",a?"":"none");this.getSubNode("FCELL",true).css("display",a?"":"none");this.box._adjustColsWidth(this);this.box._adjustBody(this,"rowhandler")}},rowResizer:{ini:false,action:function(a){this.getSubNode("FHANDLER",true).css("display",a?"":"none")}},colHidable:false,colResizer:{ini:true,action:function(a){this.getSubNode("HHANDLER",true).css("display",a?"":"none")}},colSortable:{ini:true,action:function(a){if(!a){this.getSubNode("SORT",true).css("display","none")}}},colMovable:false,header:{ini:{},set:function(a){var b=this;if(b.renderId){b.boxing()._refreshHeader(a)}else{b.properties.header=xui.copy(a)}}},uidColumn:"",grpCols:{ini:{},set:function(a){var b=this;b.properties.grpCols=xui.copy(a);if(b.renderId){b.boxing()._refreshHeader(xui.clone(b.properties.header,false,2))}}},rows:{ini:{},set:function(a){var b=this;if(b.renderId){b.boxing().removeAllRows(false).insertRows(a)}else{b.properties.rows=xui.copy(a)}}},rawData:{ini:[],set:function(q){if(!q||!xui.isArr(q)||!q.length){return}var a=this,n={},g=[],r=[],f,d,b=q.length,e;for(f=0;f<b;f++){if(!xui.isHash(e=q[f])){return}for(var c in e){if(!(c in n)){n[c]=[]}n[c][f]=e[c]}}d=0;for(var c in n){g.push(c);for(f=0;f<b;f++){if(!r[f]){r[f]=[]}r[f][d]=n[c][f]}d++}var m=a.boxing();if(m.getHeader("min").join(";")!=g.join(";")){m.setHeader(g)}m.setRows(r)},get:function(f,d){var n=this,e=n.properties,u=e.header,A=this.box._temprowid,q=f&&f.cells&&xui.isArr(f.cells),g=q?[f]:xui.isArr(f)&&f[0]&&f[0].cells&&xui.isArr(f[0].cells)?f:e.rows,r=u.length,x=g.length,c=[],b,C,m,B=[];if(x){for(var w=0;w<r;w++){c.push(u[w].id)}for(var s=0;s<x;s++){if(!q&&g[s].id==A){continue}if(g[s].group||!g[s].cells){continue}var a={};for(var w=0;w<r;w++){C=c[w];b=g[s].cells[w];if(d&&C.indexOf(":")!=-1){m=C.split(":");a[m[0]]=("value" in b)?b.value:b;a[m[1]]=("caption" in b)?b.caption:null}else{a[C.split(":")[0]]=("value" in b)?b.value:b}}B.push(a)}}return q?B[0]:B}},dataset:{ini:{},get:function(){var b=this,a=b.boxing(),c=b.properties;return{name:c.gridHandlerCaption,dimensions:a.getHeader("min"),source:a.getRows("min")}},set:function(a){var c=this,b=c.boxing(),e=c.properties;var d=xui.isFun(a.getDataset)?a.getDataset():a;if((a=e.tagVar.datasetAdapter)&&xui.isFun(a)){d=a.call(b,d,c)}if((a=b.datasetAdapter)&&xui.isFun(a)){d=a.call(b,d,c)}if(b.beforeApplyDataset&&false===b.beforeApplyDataset(c,d)){}else{if("name" in d){b.setGridHandlerCaption(d.name)}if("dimensions" in d){b.setHeader(d.dimensions)}if("source" in d){b.setRows(d.source)}}}},tagCmds:{ini:[],action:function(){this.boxing().refresh()}},activeMode:{ini:"row",listbox:["row","cell","none"],action:function(b){var a=this;if(b!="cell"&&a.$activeCell){xui(a.$activeCell).tagClass("-active",false);delete a.$activeCell}if(b!="row"&&a.$activeRow){xui(a.$activeRow).tagClass("-active",false);delete a.$activeRow}}},rowOptions:{ini:{},action:function(c){var a=this.boxing(),b=a.getRows("data");a.removeAllRows();a.insertRows(b)}},colOptions:{ini:{},action:function(c){var a=this.boxing(),b=a.getRows("data");a.removeAllRows();a.insertRows(b)}},treeMode:{ini:"inhandler",listbox:["none","inhandler","infirstcell"],action:function(a,b){if((b=="inhandler"&&a=="infirstcell")||(b=="infirstcell"&&a=="inhandler")){this.boxing().refresh()}else{this.getSubNodes(["ROWLRULER","ROWTOGGLE"],true).css("display",a?"":"none")}}},freezedColumn:{ini:0,action:function(){this.boxing().refresh();this.box._adjustColsWidth(this)}},freezedRow:{ini:0,action:function(){this.boxing().refresh()}},hotRowMode:{ini:"none",listbox:["none","show","hide","auto"],action:function(a){if(this.renderId){if(a=="none"){this.boxing().removeHotRow()}else{this.box.__ensurehotrow(this,null)}}}},excelCellId:{ini:"",action:function(){this.boxing().notifyExcel(false)}},gridValueFormula:"",hotRowNumber:"[*]",hotRowCellCap:"(*)",hotRowRequired:"",noCtrlKey:true},EventHandlers:{onBodyLayout:function(b,a){},beforeApplyDataset:function(a,b){},onScroll:function(a,b){},beforeCellKeydown:function(b,a,c){},afterCellFocused:function(b,a,c){},beforeInitHotRow:function(a){},onInitHotRow:function(a,b){},beforeHotRowAdded:function(c,a,d,b){},afterHotRowAdded:function(a,b){},onGetContent:function(a,b,c){},onRowSelected:function(b,f,c,d,a){},onCmd:function(a,f,c,b,d){},beforeFold:function(a,b){},beforeExpand:function(a,b){},afterFold:function(a,b){},afterExpand:function(a,b){},beforeColDrag:function(a,b){},beforeColMoved:function(b,c,a){},afterColMoved:function(b,c,a){},beforeColSorted:function(b,a){},afterColSorted:function(b,a){},beforeColShowHide:function(b,c,a){},afterColShowHide:function(b,c,a){},beforeColResized:function(b,c,a){},afterColResized:function(b,c,a){},beforeRowResized:function(b,c,a){},afterRowResized:function(b,c,a){},swiperight:function(a,d,b,c){},swipeup:function(a,b,c,d){},swipedown:function(a,b,c,d){},beforePrepareRow:function(b,c,a){},beforePrepareCol:function(b,a){},beforeRowActive:function(a,b){},afterRowActive:function(a,b){},beforeCellActive:function(b,a){},afterCellActive:function(b,a){},beforeCellUpdated:function(c,a,b,d){},afterCellUpdated:function(c,a,b,d){},beforeRowUpdated:function(b,c,a,d){},afterRowUpdated:function(b,c,a,d){},onRowDirtied:function(a,b){},onRowHover:function(b,f,a,c,d){},onClickHeader:function(b,a,c,d){},onClickRow:function(a,d,b,c){},onClickRowHandler:function(a,d,b,c){},onDblclickRow:function(a,d,b,c){},onClickCell:function(b,a,c,d){},onDblclickCell:function(b,a,c,d){},onClickGridHandler:function(a,b,c){},beforeIniEditor:function(e,a,b,c,d){},onBeginEdit:function(d,a,c,b){},beforeEditApply:function(f,b,c,e,a,d){},onEndEdit:function(d,a,c,b){},onFileDlgOpen:function(c,b,a,d){},beforeComboPop:function(c,b,a,g,d,f){},beforePopShow:function(d,b,a,e,c){},afterPopShow:function(c,b,a,d){},onCommand:function(d,b,a,e,c){},onEditorClick:function(d,b,a,c,e){},beforeUnitUpdated:function(d,b,a,c){},beforeApplyFormula:function(b,a,c,d){},afterApplyFormulas:function(b,a){},beforeGridValueCalculated:function(a){},afterGridValueCalculated:function(a,b){},onGetExcelCellValue:function(b,a,c){}},RenderTrigger:function(){var b=this,c=b.box,e=b.properties,a=b.boxing(),d=c.getCellOption;b.destroyTrigger=function(){var f=this,g=f.properties;xui.each(f.cellMap,function(j){if(j._editor){j._editor.destroy()}});xui.breakO([f.colMap,f.rowMap,f.cellMap],3);g.header.length=0;g.rows.length=0;g.grpCols.length=0};b.$cache_editor={};if(!e.iniFold){a._toggleRows(e.rows,true)}xui.arr.each(e.header,function(f){if(xui.isFun(f.colRenderer||e.colOptions.colRenderer)){(f.colRenderer||e.colOptions.colRenderer).call(null,b,f)}});if(e.treeMode=="infirstcell"){b.getSubNode("HCELLA",e.header[0]._serialId).prepend(b.getSubNode("LTAGCMDS")).prepend(b.getSubNode("HFMARK"))}xui.arr.each(e.rows,function(f){if(xui.isFun(f.rowRenderer||e.rowOptions.rowRenderer)){(f.rowRenderer||e.rowOptions.rowRenderer).call(null,b,f)}if(false===d(b,f,"iniFold")){a._toggleRows([f],true)}});b.box.__ensurehotrow(b,null);xui.each(b.cellMap,function(f){if(d(b,f,"editable")&&(d(b,f,"editMode")=="inline"||d(b,f,"type")=="dropbutton")){c._editCell(b,f)}});if(e.excelCellId){b.boxing().calculateGridValue()}},LayoutTrigger:function(){var b=this,c=b.box,d=b.properties,a=b.boxing();if(xui.isArr(d.grpCols)){xui.arr.each(d.grpCols,function(e){if(xui.isFun(e.colRenderer||d.colOptions.colRenderer)){(e.colRenderer||d.colOptions.colRenderer).call(null,b,e)}});c._adjustColsHeight(b)}b.box._asy(b);b.box._adjustBody(b,"render")},_tplMap:{text:".text",button:".button",image:".image"},_tplMap2:{textarea:".textarea",checkbox:".checkbox",button:".button",progress:".progress"},_focusEvent:function(c,d,g){var b=c.boxing(),j=c.properties,a=c.cellMap[c.getSubId(g)],f;c.box._focuscell(c,d,g);if(c.afterCellFocused){if(a){f=a._row}else{f=c.rowMap[c.getSubId(g)]}b.afterCellFocused(c,a,f)}if(j.hotRowMode!="none"){var a=c.cellMap[c.getSubId(g)],f;if(a){f=a._row}else{f=c.rowMap[c.getSubId(g)]}if(c.__hastmpRow&&c.__needchecktmprow&&f.id!==c.box._temprowid){c.box._checkNewLine(c,"focuscell")}}},_tagCmdWidth:function(a){var c=a.properties;var b=0;if(c.tagCmds){xui.arr.each(c.tagCmds,function(d){if(d.tagCmdsAlign&&d.tagCmdsAlign!="left"){switch(d.buttonType){case"button":b=b+2;break;case"image":b=b+2;break;case"text":b=b+d.text?d.text.length:1;break}}})}return b},_haderTail:function(a){var d=a.properties;var c="操作";if(!d.tagCmds){var b=false;xui.arr.each(d.tagCmds,function(e){if(e.tagCmdsAlign&&e.tagCmdsAlign!="left"){var f=true}});if(b){c=d.headerTail?d.headerTail:"操作"}else{c=""}}else{c=""}return c},__ensurehotrow:function(c,a){var f=c.properties,d=c.box,b=false;if(!d||!c.renderId||f.hotRowMode=="none"){return}if(c.__hastmpRow){var e=c.properties.rows;if(e.length===0||e[e.length-1].id!=c.box._temprowid){b=true}}else{b=true}if(b){switch(f.hotRowMode){case"auto":if(!f.rows||f.rows.length===0){d._addTempRow(c,a)}break;case"show":d._addTempRow(c,a);break}}},_temprowid:"_ r _temp_",isHotRow:function(a){return a&&(a.id||a)===this._temprowid},_addTempRow:function(e,b){var j=e.properties;if(j.readonly||j.disabled||!j.header||j.header.length<=0){return false}e.box._sethotrowoutterblur(e,true);delete e.__hastmpRow;e.boxing().removeRows([this._temprowid],false);if(e.beforeInitHotRow&&false===e.boxing().beforeInitHotRow(e)){return false}e.__needchecktmprow=true;var d={},g={cells:d},f=(j.hotRowRequired||"").split(j.valueSeparator),a={caption:j.hotRowCellCap},c=e.boxing();if(f.length){xui.arr.each(j.header,function(l,m){if(xui.arr.indexOf(f,l.id)!=-1){d[l.id]=a}else{if(xui.isSet(l.defaultValue)){d[l.id]=l.defaultValue}}})}if(e.onInitHotRow){g=c.onInitHotRow(e,g)||g}if(xui.isArr(g)){g={cells:g}}else{if(!xui.isHash(g)){g={cells:[g]}}}g.id=this._temprowid;g.rowNumber=j.hotRowNumber;g.rowClass=e.getClass("CELLS2","-hot");c.insertRows([g],null,null,false,false);e.__hastmpRow=true;if(b!==null){c.focusCellbyRowCol(g.id,b||j.header[0].id);e.box._sethotrowoutterblur(e)}},_checkNewLine:function(f,c){var a=f.properties;f.box._sethotrowoutterblur(f,true);if(!f.__hastmpRow){return}delete f.__needchecktmprow;var q=f.boxing(),e=this._temprowid,r=a.hotRowRequired&&a.hotRowRequired.split(a.valueSeparator),m=q.getRowbyRowId(e,"map",true),u=!!c;if(!m){return}if(r&&r.length){for(var o=0,n,s,g=r.length;o<g;o++){n=xui.arr.subIndexOf(a.header,"id",r[o]);if(n!=-1&&!(xui.isHash(s=m[r[o].split(":")[0]])?s.value:s)){u=null;break}}}var b=q.getRowbyRowId(e,"data",true);delete b.id;delete b.rowClass;delete b.rowNumber;xui.arr.each(b.cells,function(j){if(j.id.indexOf("-c_")==0){delete j.id}if(j.caption===a.hotRowCellCap){delete j.caption}});if(f.beforeHotRowAdded){var d=q.beforeHotRowAdded(f,m,b,!c);if(xui.isDefined(d)){u=d===true?d:d===false?d:null}}if(u===null){if(a.hotRowMode=="hide"||a.hotRowMode=="auto"){f.box._sethotrowoutterblur(f)}return false}else{if(u===false){if(a.hotRowMode=="hide"||a.hotRowMode=="auto"){delete f.__hastmpRow;q.removeRows([e],false);if(a.rows.length===0&&a.hotRowMode=="auto"){this._addTempRow(f,null)}}return false}else{if(u===true){delete f.__hastmpRow;q.removeRows([e],false);q.insertRows(b,null,null,false,true);m=a.rows[a.rows.length-1];m._dirty=1;if(f.afterHotRowAdded){q.afterHotRowAdded(f,m)}if(a.hotRowMode=="show"){if(!f.__hastmpRow){this._addTempRow(f,null)}}return true}else{f.__needchecktmprow=true;if(xui.isHash(u)){q.focusCell(u)}else{q.focusCell(q.getCell(u))}f.box._sethotrowoutterblur(f);return false}}}},_sethotrowoutterblur:function(b,a){var c=function(d){return b.getSubNode(d).get(0)};b.getSubNode("ROWS22").setBlurTrigger(b.$domId+":ROWS22",a?null:function(j,g){var f=xui.Event.getSrc(g),d=f==c("SCROLL11")||f==c("SCROLL12")||f==c("SCROLL21")||f==c("SCROLL22")?"focusin":"focusout";b.__tmpRowBlurTrigger=xui.asyRun(function(){if(!b.box){return}b.box._checkNewLine(b,d)})},xui([c("ROWS11"),c("ROWS12"),c("ROWS21"),c("ROWS22")]),null,true);if(a){if(b.__tmpRowBlurTrigger){xui.clearTimeout(b.__tmpRowBlurTrigger);delete b.__tmpRowBlurTrigger}}},_cacheRows:function(c){var b=c.getSubNodes("CELLS1",true).get(),a=c.getSubNodes("CELLS2",true).get();xui.filter(b,function(d){return !!d.clientHeight});xui.filter(a,function(d){return !!d.clientHeight});c.$allrowscache1=b;c.$allrowscache2=a},_asy:function(c){var e=c.properties,a=c.boxing(),d=c.$xid;if(e.altRowsBg){xui.resetRun(d+"1",function(){if(c.rowMap){a.setAltRowsBg(true,true)}})}if(e.rowNumbered){xui.resetRun(d+"2",function(){if(c.rowMap){a.setRowNumbered(true,true)}})}},_setRowHanderW:function(d,g){var a=d.properties,e=d._$subMargin||(d._$subMargin=d.$px(a.$subMargin)),b=d.rowMap,j=d.getSubNode("FHCELL"),c,l;if(xui.isFinite(g)||d.$isEm(g)||d.$isPx(g)){l=d.$forceu(g)}else{if(g===true){var f=[],m;d.getSubNode("FCELLCAPTION",true).each(function(n){if((m=n.parentNode).parentNode.offsetHeight>0&&xui.Dom.getStyle(m,"overflow")!="visible"){if(c=b[d.getSubId(n.id)]){f.push(xui([n]).width()+c._layer*e)}}});f.push(d.$px(a._minColW));l=d.$forceu(Math.max.apply(null,f)+e*2)}else{l=d.$forceu(j.width())}}if(l){if(d.$px(l)<d.$px(a._minColW)){l=d.$em(a._minColW)+"em"}if(d.$px(l)<=0){return}if(a.rowHandlerWidth!=l){j.width(a.rowHandlerWidth=l);d.getSubNode("FCELL",true).width(l);d.getSubNode("GCELL",true).width(l);d.box._adjustColsWidth(d);d.box._adjustBody(d,"rowhandler")}}},_onStartDrag:function(a,b,d){var c=a.rowMap[a.getSubId(d)];if(c&&c.id==a.box._temprowid){return false}var f=xui.Event.getPos(b);a.$_ond=d;xui.use(d).startDrag(b,{dragSource:a.$xid,dragType:"icon",shadowFrom:xui.use(d).parent()._get(0),targetLeft:f.left+12,targetTop:f.top+12,dragCursor:"pointer",dragDefer:2,dragKey:a.box.getDragKey(a,d),dragData:a.box.getDragData(a,b,d)});return false},_onDropTest:function(b,j,a,n,g,q){var c=g&&g.domId,f=a,l=g&&g.profile,o;if(f){var d=b.getKey(f),m=b.keys,r=b.rowMap[b.getSubId(f)];if(d==m.FCELL&&!r.sub){return false}if(b.properties.rowHandler){if(d==m.CELLS2||d==m.SCROLL22){return false}}else{if(d==m.CELLS1||d==m.SCROLL21){return false}}}if(l&&l.$xid==b.$xid){if(c&&b.getSubId(c)==b.getSubId(f)){return false}o=b.$_ond;a=xui(a).get(0);if(xui.get(a,["parentNode","previousSibling"])==o){return false}do{if(a==o){a=o=null;return false}}while(a&&(a=a.parentNode)&&a!==document&&a!==window);a=o=null}},_onDragstop:function(b,f,g,a,d,c){delete b.$_ond},_onDrop:function(g,o,d,s,m,w){if(!m.profile||!m.profile[g.KEY]){return}var l=g.getKey(d),f=m.profile,c=m.domId,j,r=g.keys,u=xui.absObj.$specialChars,q=g.boxing(),n=xui.copy(q.getUIValue(true)),a=f.rowMap[f.getSubId(c)],x=g.rowMap[g.getSubId(d)];a=xui.clone(a,function(e,b){return !u[(b+"").charAt(0)]});f.boxing().removeRows([a.id]);if(l==r.SCROLL21||l==r.SCROLL22){q.insertRows([a],null,null,false)}else{if((l==r.FCELL)&&x.sub){q.insertRows([a],x.id,null,false)}else{if(l==r.CELLS1||l==r.CELLS2){q.insertRows([a],x._pid,x.id,true)}}}if(n&&n.length){if(xui.arr.indexOf(n,a.id)!=-1){q.setUIValue(n,true,null,"drop")}}m._new=a;return false},_beforeSerialized:function(c){var g=arguments.callee.upper.call(this,c),a=c.properties,f=xui.absObj.$specialChars,j=g.properties,e=xui.$us(c),d=e==2?"em":e==-2?"px":null,b;j.header=xui.clone(a.header,function(q,l,n,m){if(n===2&&l==="width"&&q&&q!="auto"){m[l]=c.$forceu(q,d);return false}else{return !f[((n===1?q.id:l)+"").charAt(0)]&&q!=undefined}});j.grpCols=xui.clone(a.grpCols,function(n,l,m){if(m===2&&l==="width"&&n&&n!="auto"){h[l]=c.$forceu(n,d);return false}else{return !f[((m===1?n.id:l)+"").charAt(0)]&&n!=undefined}});j.rows=xui.clone(a.rows,function(n,l,m){if(m===2&&l==="height"&&n&&n!="auto"){h[l]=c.$forceu(n,d);return false}else{return !f[((m===1?n.id:l)+"").charAt(0)]&&n!=undefined&&((l=="id"&&typeof(n)=="string")?n.charAt(0)!="-":true)}});if(xui.isEmpty(j.header)){delete j.header}if(xui.isEmpty(j.grpCols)){delete j.grpCols}if(xui.isEmpty(j.rows)){delete j.rows}delete j.activeRow;delete j.activeCell;delete j.rawData;delete j.dataset;return g},_clsCache:{},_colDragCheck:function(d,g){var f=d.properties,a=xui.DragDrop.getProfile(),c=a.dragKey,e=a.dragData,b=d.colMap[d.getSubId(g)];if(!b||b._isgroup){return false}if(f.treeMode=="infirstcell"&&f.header[0]==b){return false}if(!(b.hasOwnProperty("colMovable")?b.colMovable:d.properties.colMovable)){return false}if(!c||!e||c!=(d.$xid+":col")){return false}if(e==xui.use(g).id()||e==xui.use(g).prev().id()){return false}},_prepareData:function(a){var b=arguments.callee.upper.call(this,a),c="display:none",d=a.properties;a.rowMap2={};a.rowMap={};a.cellMap={};b.showHeader=d.showHeader?"":c;b.colDDDisplay=d.colResizer?"":c;b.rowDDDisplay=d.rowResizer?"":c;b.rowHandlerDisplay=d.rowHandler?"":c;b.sortDisplay=c;b._rowMarkDisplay=(d.selMode=="multi"||d.selMode=="multibycheckbox")?"":"display:none;";if(!d.header||!xui.isArr(d.header)){d.header=[]}if(!d.grpCols||!xui.isArr(d.grpCols)){d.grpCols=[]}if(!d.rows||!xui.isArr(d.rows)){d.rows=[]}b.tagCmdWidth=this._tagCmdWidth(a);b.haderTail=this._haderTail(a);d.header=this._adjustHeader(d.header);b.header=this._prepareHeader(a,d.header);b.header1=b.header2=b.header;d.grpCols=this._adjustGrpColsData(a,d.grpCols);b.grpCols=this._prepareGrpCols(a,d.grpCols,b.header);b.grpCols1=b.grpCols2=b.grpCols;b._row0DfW=b.rowHandlerWidth?("width:"+a.$forceu(b.rowHandlerWidth)):"";if(a.$isEm(d.headerHeight)){b.headerHeight=a.$forceu(a.$px(d.headerHeight,0,true),"em")}if(a.$isEm(d.rowHeight)){b.rowHeight=a.$forceu(a.$px(d.rowHeight,0,true),"em")}if(a.$isEm(d.rowHandlerWidth)){b.headerHeight=a.$forceu(a.$px(d.rowHandlerWidth,0,true),"em")}arguments.callee.upper.call(this,a);d.rows=this._adjustRows(a,d.rows);b.rows11=b.rows12=b.rows21=b.rows22=this._prepareItems(a,d.rows);b.tagCmds=xui.clone(d.colOptions.tagCmds||b.tagCmds);if(b.tagCmds){this._prepareCmds(a,b,function(e){var f=e.pos||e.tag;return !f||f!="row"})}b._columnfreezed=d.freezedColumn?"xui-ui-shadow-r xui-uiborder-r xui-uiborder-dark":"";b._rowfreezed=d.freezedRow?"xui-ui-shadow-b xui-uiborder-b xui-uiborder-dark":"";return b},_parepareCol:function(f,d,q,l){var c=xui.UI.$tag_subId,b=f.properties,g=f.$px(b.headerHeight),j=f.getRoot().contentBox()?2:0,o="display:none",s,r=1,m,e,n;if(!xui.isHash(d)){e=d+"";d={id:e}}else{e=d.id+""}d._cells={};s=f.pickSubId("header");d[c]="-h_"+s;d.id=d.id||s;while((m=xui.arr.subIndexOf(q,"id",d.id))!=-1&&m!==l){d.id=s+(r++)}f.colMap[d[c]]=d;var a=f.$px(d.width)||f.$px(b._colDfWidth);if("relWidth" in d){d.flexSize=d.relWidth;delete d.relWidth}if(!d.flexSize){if(d.hasOwnProperty("minWidth")){a=Math.max(a,f.$px(d.minWidth))}if(d.hasOwnProperty("maxWidth")){a=Math.min(a,f.$px(d.minWidth))}}d.width=d._cellWidth=d._colWidth=f.$forceu(a);d._hcellheight=f.$forceu(g-j);n={sortDisplay:o,rowHandlerDisplay:b.rowHandler?"":o};n[c]=d[c];n._tabindex=b.tabindex;n.colDDDisplay=(("colResizer" in d)?d.colResizer:b.colResizer)?"":o;if(d.hasOwnProperty("visibility")&&!d.hasOwnProperty("hidden")){d.hidden=!d.visibility}n.colDisplay=d.hidden===true?o:"";n.firstCellStyle=b.colOptions.firstCellStyle||"";n.firstCellClass=b.colOptions.firstCellClass||"";if(!d.type){d.type=b.colOptions.type||"input"}if(!(("caption" in d)&&xui.isDefined(d.caption))){d.caption=e}xui.UI.adjustData(f,d,n,"sub");f.colMap2[d.id]=d[c];return[d,n]},_prepareCell:function(e,m,o,d,n,c,f){var l=this,b=xui.UI.$tag_subId,a=e.properties,j="display:none",g={};m=xui.isSet(m)?xui.isHash(m)?m:{value:m}:{};m._row=o;m._col=d;m[b]="-c_"+e.pickSubId("cell");m.id=m.id||m[b];l._adjustCell(e,m,g);e.cellMap[g[b]]=m;if(n){n.push(m)}o._cells[d.id]=g[b];d._cells[o.id]=g[b];if(a.treeMode=="infirstcell"&&f===0&&c){g._treeMode=c._treeMode;g._rulerW=c._rulerW;g._fi_togglemark=c._fi_togglemark;g._rowMarkDisplay=c._rowMarkDisplay;g._rowNumbDisplay=c._rowNumbDisplay;g._ltagDisplay=c._ltagDisplay;g.ltagCmds=c.ltagCmds;g[xui.UI.$tag_subId_c]=c[xui.UI.$tag_subId]}return[m,g]},_prepareGrpCols:function(e,a,b){var d=e.properties;if(d.showHeader&&a&&xui.isArr(a)&&a.length){var H=d.header,F=e.$px(d.headerHeight),c=e.getRoot().contentBox()?2:0,f=xui.UI.$tag_subId,q="display:none",l=[],u,r,I,J,s,K=e._headerLayers,I=F/(K+1),G=false;for(var E=0,C=a.length,g;E<C;E++){u={};r=0;G=false;J=0;g=a[E];xui.UI.adjustData(e,g,u,"sub");for(var D=0,A;D<=g.to;D++){A=H[D];x=b[D];s=e.$px(x._colWidth);if(D===g.from){G=true;u._hcellleft=e.$forceu(J)}J+=s+c;if(G&&!A.hidden){r+=s+c}}u._colWidth=u._cellWidth=e.$forceu(r-c);u._hcellheight=e.$forceu(I-c);u._hcelltop=e.$forceu(I*(g._layer-1));u._tabindex=d.tabindex;u.colDDDisplay=(("colResizer" in g)?g.colResizer:d.colResizer)?"":q;l.push(u)}for(var D=0,B=H.length,A,x;D<B;D++){A=H[D];x=b[D];if(A._grp&&A._grp.length){x._hcellheight=e.$forceu(F-A._grp.length*I-c)}}return l}},_prepareHeader:function(b,a){var e=[],c,d=b.properties;b.colMap2={};b.colMap={};xui.arr.each(a,function(g,f){if(b.beforePrepareCol&&false===b.boxing().beforePrepareCol(b,g)){return}c=b.box._parepareCol(b,g,a,f);a[f]=c[0];e.push(c[1])});return e},_renderCell:function(e,b,j,E,f){var H,n=["input","password","combobox","checkbox","listbox","file","getter","helpinput","button","dropbutton","cmdbox","cmd","popbox","textarea","label","date","profile","image","text","time","datetime","color","spin","counter","currency","number","split"];if(b._col&&b._col.type){H=b._col.type}var L=e.box.getCellOption,g=L(e,b,"type");if(xui.arr.indexOf(n,g)==-1){g=H}var q="",o="",I,l=E,F=j&&xui.isStr(j._caption)?j._caption:j&&xui.isStr(b.caption)?j.caption:xui.isStr(b.caption)?b.caption:null,J=/</g,M="xui-uicell-disabled",a="xui-ui-readonly",d=function(P,c,R,O,Q){return((Q=c.renderer||c._renderer)?xui.UI._applyRenderer(P,Q,c,R):(R&&typeof R.caption=="string")?R.caption:typeof O=="function"?O(c.value,P,c):(xui.isSet(c.value)?(""+c.value):""))||""},G=function(O,P,c){return O?xui.Date.getText(O,L(P,c,"dateEditorTpl")||"ymdhn"):""},D=function(O,P,c){return O?xui.Date.getText(O,L(P,c,"dateEditorTpl")||"ymd"):""},C=function(c){return c?(c+"").replace(J,"&lt;").replace(/\t/g,"    ").replace(/(\r\n|\n|\r)/g,"<br />"):""},B=function(c){return(c||c===0)?((c*100).toFixed(2)+"%"):""},A=function(O,P,c){if(O||O===0){return xui.formatNumeric(parseFloat(O),L(P,c,"precision"),L(P,c,"groupingSeparator"),L(P,c,"decimalSeparator"),L(P,c,"forceFillZero"),L(P,c,"trimTailZero"))}else{return""}},x=function(P,Q,c){if(P||P===0){var O=L(Q,c,"precision");return xui.formatNumeric(parseFloat(P),xui.isSet(O)?O:2,L(Q,c,"groupingSeparator"),L(Q,c,"decimalSeparator"),L(Q,c,"forceFillZero"),L(Q,c,"trimTailZero"))}else{return""}},w=function(P,S,c){var R=L(S,c,"editorListItems");if(!R){if(R=L(S,c,"editorListKey")){R=xui.UI.getCachedData(typeof(R)=="function"?R():R)}}if((typeof(R)=="function"?(R=R()):R)&&R.length){for(var Q=0,O=R.length;Q<O;Q++){if(R[Q].id===P){return R[Q].caption||P}}}return u(P,S,c)},u=function(O,Q,c){if(O){O=O+"";var P=O.indexOf("=");if(P!=-1){c.value=O.substr(0,P);return O.substr(P+1)}}return O},s=function(O,c){return O+(c.unit?" "+c.unit:"")};if(E&&E.get(0)){E=E.last()}switch(g){case"counter":var r=parseFloat(b.value);b.value=(r||r===0)?r:null;I=s(F||d(e,b,j,A),b);var N=L(e,b,"numberTpl");if(N&&I){I=N.replace("*",I)}if(E){E.html(I,false)}break;case"currency":var r=parseFloat((b.value+"").replace(/[^\d.-]/g,""));b.value=(r||r===0)?r:null;I=s(F||d(e,b,j,x),b);var N=L(e,b,"currencyTpl");if(N&&I!==""){I=N.replace("*",I)}if(E){E.html(I,false)}break;case"date":b.value=xui.isDate(b.value)?b.value:xui.isFinite(b.value)?new Date(parseInt(b.value,10)):xui.Date.parse(b.value);I=s(F||d(e,b,j,D),b);if(E){E.html(I,false)}break;case"datetime":b.value=xui.isDate(b.value)?b.value:xui.isFinite(b.value)?new Date(parseInt(b.value,10)):xui.Date.parse(b.value);I=s(F||d(e,b,j,G),b);if(E){E.html(I,false)}break;case"input":b.value=b.value||"";I=s(F||d(e,b,j),b);if(E){E.html(I,false)}break;case"textarea":b.value=b.value||"";I=s(F||d(e,b,j,C),b);if(E){E.html(I,false)}break;case"color":var K=xui.UI.ColorPicker._ensureValue(0,b.value);b.value=b.value?((K!=="transparent"?"#":"")+K):"";I=s(F||d(e,b,j),b);if(b.value){q=xui.UI.ColorPicker.getTextColor(b.value);if(E){E.html(I,false);E.css("color",q);E.parent().css("backgroundColor",b.value)}else{j.color="color:"+q+";";j.bgcolor="background-color:"+b.value+";"}}else{if(E){E.html(I,false);E.css("color","");E.parent().css("backgroundColor","")}else{}}break;case"checkbox":b.value=b.value==="0"?false:!!b.value;I=s(b.value+"",b);if(E){E.tagClass("-checked",b.value)}else{j._fi_checkboxCls=b.value?"xuifont-checked xui-uicmd-check-checked":""}break;case"progress":b.value=parseFloat(b.value)||0;b.value=Math.min(Math.max(b.value,0),1);I=s(F||d(e,b,j,B),b);if(E){E.first().html(I,false);E.width(I)}else{j.progress=I}break;case"listbox":b.value=b.hasOwnProperty("value")?b.value:"";I=xui.adjustRes(s(F||d(e,b,j,w),b));if(E){E.html((I===null||I===undefined)?b.value:I,false)}break;case"dropbox":case"cmdbox":b.value=b.hasOwnProperty("value")?b.value:"";I=xui.adjustRes(s(F||d(e,b,j,u),b));if(E){E.html((I===null||I===undefined)?b.value:I,false)}break;default:b.value=b.hasOwnProperty("value")?b.value:"";I=xui.adjustRes(s(F||d(e,b,j),b));if(E){E.html((I===null||I===undefined)?b.value:I,false)}}if("_renderer" in b){delete b._renderer}b._caption=b._$tips=b._$tmpcap=I;var o=L(e,b,"disabled"),m=L(e,b,"readonly");if(j){j.cellCls=e.getClass("CELL","-"+g)+(o?(" "+M):"")+(m?(" "+a):"");j.type=g;j.value=b.value;j._caption=I;j.cellStyle=L(e,b,"cellStyle");j.cellClass=L(e,b,"cellClass")}else{if(o){l.parent().addClass(M)}else{l.parent().removeClass(M)}if(m){l.parent().addClass(a)}else{l.parent().removeClass(a)}if(o=f.cellStyle){l.attr("style",l.attr("style")+";"+o)}if(o=f.cellUnclass){l.removeClass(o)}if(o=f.cellClass){l.addClass(o)}}return b},_applyRendererEx:function(e,f,d,a,b,c){if(a){if(c=a._col){b(c,f,d);b(c.tagVar,f,d)}if(c=a._row){b(c,f,d);b(c.tagVar,f,d)}}},_prepareItems:function(f,c,A,F){var B=this,e=f.properties,r=e.treeMode,E=f._$subMargin||(f._$subMargin=f.$px(e.$subMargin)),K=f.rowMap2,H=f.rowMap,w=A?H[A]?(H[A]._layer+1):0:0,j=xui.UI.$tag_subId,I=f._id||(f._id=new xui.id()),q=[],G,g,u,m,s,J,o=e.rowOptions,x=f.$itemFilter,n="display:none";r=!(!r||r=="none");if(x){x("begin","prepareItem",f)}for(var D=0,C=c.length;D<C;D++){m=c[D];if(!m.id||K[m.id]){while(K[u=I.next()]){}m.id="-"+u}else{m.id+=""}if(f.beforePrepareRow&&false===f.boxing().beforePrepareRow(f,m,A,F)){continue}G="-r_"+f.pickSubId("row");m[j]=G;H[G]=m;m._pid=A;m._cells={};m._layer=w;m._tabindex=e.tabindex;m._rowMarkDisplay=(e.selMode=="multi"||e.selMode=="multibycheckbox")?"":n;m._treeMode=r?"":n;m._rowNumbDisplay=e.rowNumbered?"":n;u={id:m.id};u.rowCls="";if(m.disabled){u.rowCls+=" xui-uicell-disabled"}if(m.readonly){u.rowCls+=" xui-ui-readonly"}if(m.group){u.group=1;u.rowCls+=" "+f.getClass("CELLS1","-group")+" xui-uiborder-r xui-uiborder-light"}if(x){m.hidden=!!x(m,"prepareItem",f)}if(m.hidden){u.rowDisplay=n}u._row0DfW=e.rowHandlerWidth?("width:"+f.$forceu(e.rowHandlerWidth)):"";u._rulerW="width:"+(m.rulerWidth||f.$forceu(4+w*E));u._rowHeight=f.$forceu(m._rowHeight||m.height||e.rowHeight,"em");m._rowHeight=u._rowHeight;u._rowHeight="height:"+u._rowHeight;u.rowHandlerDisplay=e.rowHandler?"":n;u.rowDDDisplay=(("rowResizer" in m)?m.rowResizer:e.rowResizer)?"":n;u.firstCellStyle=m.firstCellStyle||o.firstCellStyle||"";u.firstCellClass=m.firstCellClass||o.firstCellClass||"";g=u.cells=[];u[j]=G;u._fi_togglemark=m.sub?("xui-uicmd-toggle"+(m._checked?" xuifont-checked xui-uicmd-toggle-checked":"")):(e.togglePlaceholder?"xui-icon-placeholder":"xui-uicmd-none");K[m.id]=G;if(!m.hasOwnProperty("caption")&&m.hasOwnProperty("value")){m.caption=""+m.value}m._oValue=m.value;if(m.caption&&!m.tips){m._$tips=m.caption}xui.UI.adjustData(f,m,u,"sub");u.tagCmds=xui.clone(u.tagCmds||o.tagCmds||e.tagCmds);if(u.tagCmds){this._prepareCmds(f,u,function(a){var b=a.pos||a.tag;return !b||!(b=="header"||b=="header row"||b=="all")})}if(m.group){m.cells=null}if((s=m.cells)){xui.arr.each(e.header,function(b,a){J=f.box._prepareCell(f,s[a],m,b,F,u,a);s[a]=J[0];g.push(J[1])})}var d={};xui.merge(d,u,function(b,a){return xui.isNumb(b)||xui.isStr(b)||a=="ltagCmds"});d[xui.UI.$tag_subId_c]=u[xui.UI.$tag_subId];u._handler_cell=xui.clone(d);if(e.treeMode=="infirstcell"){if(m.group){u._firstcell_grp=xui.clone(d)}u._rulerW=u._fi_togglemark="";u._treeMode=u.tMarkDisplay=u.tNumbDisplay=u._ltagDisplay=n;u.ltagCmds=null}q.push(u)}if(x){x("end","prepareItem",f)}return q},_adjustCell:function(e,a,g){var b=this,j=e.properties,c=a._col,f=b.getCellOption(e,a,"cellRenderer")||j.renderer,d=b.getCellOption(e,a,"cellCapTpl");if(d){a._caption=d}xui.UI.adjustData(e,a,g,"sub");if(f){a._renderer=f}if(!g._cellWidth){g._cellWidth=c._colWidth}g._tabindex=j.tabindex;g.cellDisplay=c.hidden===true?"display:none;":"";b._renderCell(e,a,g);a._oValue=a.value;if("unit" in a){a._oUnit=a.unit}},_setSub:function(g,B,x,A,m,s){var u=g.domId,b=g.boxing(),e=g.properties,n=g.rowMap2[B.id],c=g.box._getToggleNode(g,n),w=g.getSubNodes(["SUB1","SUB2"],n),f=xui(w.get(0)),d=xui(w.get(1));if(xui.Thread.isAlive(g.key+g.id)){return}if(!x){if(B._checked){if(b.beforeFold&&false===b.beforeFold(g,B)){return}var a=function(){w.css({display:"none",height:0,overflow:""});c.tagClass("-checked",false);B._checked=false;if(e.dynDestory||B.dynDestory){var F=B.sub,r=[];for(var E=0,D=F.length;E<D;E++){r.push(F[E].id)}g.boxing().removeRows(r);B.sub=true;delete B._inited}if(b.afterFold){b.afterFold(g,B)}xui.resetRun(u,function(G){g.box._asy(g);delete g.$allrowscache1;delete g.$allrowscache2;g.box._adjustBody(g,"foldrow");if(G){xui.tryF(G,[g,B],b)}},0,[s])};if(!m){if(e.animCollapse){w.css("overflow","hidden");w.animate({height:[d.height(),0]},null,a,200,null,"expoOut",g.key+g.id).start()}else{a()}}else{a()}}if(A&&B.sub&&!e.dynDestory&&!B.dynDestory){xui.arr.each(B.sub,function(r){if(r.sub&&r.sub.length){g.box._setSub(g,r,x,A,true,s)}})}}else{if(!B._checked){if(b.beforeExpand&&false===b.beforeExpand(g,B)){return}var a=function(D,r){if(xui.browser.ie&&xui.browser.ver<=8){c.css({backgroundImage:"",backgroundRepeat:"",backgroundPositionX:"",backgroundPositionY:"",backgroundColor:"",backgroundAttachment:""})}else{c.removeClass("xui-icon-loading")}if(!D){B._checked=true;if(b.afterExpand){b.afterExpand(g,B)}}w.css({display:"",height:"auto",overflow:""});if((e.freezedRow||e.rowHandler)&&!f.height()&&(r=d.height())){f.height(r)}xui.resetRun(u,function(E){g.box._asy(g);delete g.$allrowscache1;delete g.$allrowscache2;g.box._adjustBody(g,"expandrow");if(E){xui.tryF(E,[g,B],b)}},0,[s])},C=function(F,O,E,I,H,G,M,r){var N=F.boxing(),D=F.properties,L=r===false;if(!L&&!O._inited){delete O.sub;O._inited=true;if(r){if(typeof r=="string"){G.html(O.sub=r,false);M.addClass("xui-uiborder-r xui-uiborder-b xui-uiborder-light")}else{if(r["xui.Template"]||r["xui.UI"]){G.append(O.sub=r.render(true));M.addClass("xui-uiborder-r xui-uiborder-b xui-uiborder-light")}else{if(xui.isArr(r)){N.insertRows(r,O.id);if(!O.sub){O.sub=r}}}}var P=0,K=N.getUIValue(true);if(K&&K.length){xui.arr.each(r,function(Q){if(xui.arr.indexOf(K,Q.id||Q)!=-1){P=1;return false}});if(P){N._setCtrlValue(N.getUIValue())}}}}if(!L){I.tagClass("-checked")}if(!m){M.css("height","0px").css("display","");if(D.animCollapse){var J=0;G.children().each(function(Q){J+=Q.offsetHeight});M.css("overflow","hidden");M.animate({height:[0,J]},null,function(){a(L)},200,null,"expoIn",F.key+F.id).start()}else{a(L)}}else{a(L)}},l=B.sub,j=function(r){C(g,B,u,c,f,d,w,r)},o;if((o=typeof l)=="string"||o=="object"){j(l)}else{if(g.onGetContent){if(xui.browser.ie&&xui.browser.ver<=8){c.css("background","url("+xui.ini.img_busy+") no-repeat")}else{c.addClass("xui-icon-loading")}var q=g.boxing().onGetContent(g,B,j);if(q||q===false){if(q===true){B._inited=true}j(q)}}}}if(A&&B.sub){xui.arr.each(B.sub,function(r){if(r.sub&&r.sub.length&&!r._checked){g.box._setSub(g,r,x,A,true,s)}})}}},_getCellId:function(a,c,b){if(xui.isNumb(c)){c=xui.get(a.properties.rows,[c,"id"])}if(xui.isNumb(b)){b=xui.get(a.properties.header,[b,"id"])}return xui.get(a.rowMap,[a.rowMap2[c],"_cells",b])},_updCell:function(f,x,g,l,d,r){var q=f.box,e=f.properties,s=e.dirtyMark,a=s&&e.showDirtyMark,b=xui.absObj.$specialChars,c,u,w,n;if(typeof x=="string"){c=f.cellMap[x]}else{c=x;x=c._serialId}if(!c||!c._row){return}w=c._row.id==q._temprowid;if(w&&c.caption==e.hotRowCellCap){delete c.caption}if(!xui.isHash(g)){g={value:g}}g=xui.filter(g,function(C,A,B){B=!b[A.charAt(0)];if(!B){n=n||{};n[A]=C}return B});if(d){if(f.beforeCellUpdated&&false===f.boxing().beforeCellUpdated(f,c,g,w,n)){return}}if(!xui.isEmpty(g)){delete c._$tips;delete c._$tmpcap;xui.merge(c,g,"all");u=f.getSubNode("CELLA",x);if("type" in g){var m={};q._adjustCell(f,c,m);u.parent().replace(f._buildItems("rows2.cells",[m]));u=f.getSubNode("CELLA",x)}else{var o=q.getCellOption(f,c,"cellCapTpl");if(o){c.caption=xui.adjustRes(o,true,false,null,null,c)}c=q._renderCell(f,c,null,u,g)}var j=c._editor;if("value" in g){if(!s||l===false){c._oValue=c.value}if("unit" in c){c._oUnit=c.unit}else{if(c.value===c._oValue&&(!("unit" in c)||c._oUnit===c.unit)){if(a){u.removeClass("xui-ui-dirty")}}else{if(a){u.addClass("xui-ui-dirty")}}}if(j){j.setValue(c.value,true,"editorini")}if(r!==false){xui.resetRun(f.key+":"+f.$xid+":"+c.id,function(){if(f&&f.box){f.boxing().triggerFormulas(c,"updatecell")}})}}if(("caption" in g)&&j&&j.setCaption){j.setCaption(g.caption||null,true)}c._dirty=1}if(d){if(f.afterCellUpdated){f.boxing().afterCellUpdated(f,c,g,w,n)}}},_ensureValue:function(b,c){if(b.properties.selMode=="multi"||b.properties.selMode=="multibycheckbox"){var a=xui.isArr(c)?c:(c?(""+c):"").split(b.properties.valueSeparator);xui.arr.removeValue(a,this._temprowid);a.sort();return a.join(b.properties.valueSeparator)}else{return c==this._temprowid?null:c}},_sel:function(d,f,l,u,C){var m=d.properties;if(m.activeMode!=f){return}var c=d.getSubId(u),D=f=="cell"?d.cellMap:d.rowMap,q=d.boxing(),n=D[c],F=xui.Event.getKey(C),g=f=="cell"?(n._row.id+"|"+n._col.id):n.id,r=m.selMode;switch(r){case"none":q.onRowSelected(d,n,C,l,0);break;case"multibycheckbox":if(d.keys.MARK){var o=d.getKey(xui.Event.getSrc(C).id||""),a=o==d.keys.MARK;if(!a){q.onRowSelected(d,n,C,l,0);break}}case"multi":var x=q.getUIValue(),b=x?(""+x).split(m.valueSeparator):[],j=1;if(b.length&&(F.ctrlKey||F.shiftKey||m.noCtrlKey)){if(F.shiftKey&&f=="row"){if(d.$firstV._pid!=n._pid){return false}var s=m.rows;if(n._pid){var E=D[n._pid];if(E){s=E.sub}}var A=xui.arr.subIndexOf(s,"id",d.$firstV.id),w=xui.arr.subIndexOf(s,"id",n.id),B;b.length=0;for(B=Math.min(A,w);B<=Math.max(A,w);B++){b.push(s[B].id)}}else{if(xui.arr.indexOf(b,g)!=-1){xui.arr.removeValue(b,g);j=-1}else{b.push(g)}}b.sort();x=b.join(m.valueSeparator);if(q.getUIValue()!=x){q.setUIValue(x,null,null,"click");if(q.get(0)&&q.getUIValue()==x){q.onRowSelected(d,n,C,l,j)}}break}case"single":if(q.getUIValue()!=g){d.$firstV=n;q.setUIValue(g,null,null,"click");if(q.get(0)&&q.getUIValue()==g){q.onRowSelected(d,n,C,l,1)}}break}},_activeCell:function(c,e){if(c.properties.activeMode!="cell"){return}if(c.$activeCell==e){return}var a=null;if(c.$activeCell){xui(c.$activeCell).tagClass("-active",false);delete c.$activeCell}if(e!==false){var b=c.getSubId(e),d=c.cellMap;a=d[b];if(c.beforeCellActive&&(false===c.boxing().beforeCellActive(c,a))){return}xui(c.$activeCell=e).tagClass("-active")}if(c.afterCellActive){c.boxing().afterCellActive(c,a)}},_activeRow:function(d,f){if(d.properties.activeMode!="row"){return}if(d.$activeRow==f){return}var c=null,b;if(d.$activeRow){b=d.getSubId(d.$activeRow);d.getSubNodes(["CELLS1","CELLS2"],b).tagClass("-active",false);delete d.$activeRow}if(f!==false){var a=d.getSubId(f),e=d.rowMap;c=e[a];if(d.beforeRowActive&&(false===d.boxing().beforeRowActive(d,c))){return}b=d.getSubId(d.$activeRow=f);d.getSubNodes(["CELLS1","CELLS2"],b).tagClass("-active")}if(d.afterRowActive){d.boxing().afterRowActive(d,c)}},_getCellFormula:function(e,b,c,g){var d,f=e.properties,a=function(m,l){m=xui.isStr(m)?m:("="+m);return m.replace(/(\B)(\?)([0-9]+\b)/g,"$1"+l+"$3").replace(/(\b)(_)([0-9]+\b)/g,"$1"+l+"$3")},j=function(l,m){l=xui.isStr(l)?l:("="+l);return l.replace(/(\b[A-Z]+)(\?)(\B)/g,"$1"+m+"$3").replace(/(\b[A-Z]+)(_)(\b)/g,"$1"+m+"$3")};return(b&&(d=b.formula))?d:(b&&(d=b._row)&&(d=d.formula))?a(d,c):((d=f.rowOptions)&&(d=d.formula))?a(d,c):(b&&(d=b._col)&&(d=d.formula))?j(d,g):((d=f.colOptions)&&(d=d.formula))?j(d,g):null},getCellOption:function(d,a,c){var b=a,e=d.properties;return(b&&b.hasOwnProperty(c)&&xui.isSet(b=b[c]))?b:((b=e.rowOptions)&&b.hasOwnProperty(c)&&xui.isSet(b=b[c]))?b:(a&&(b=a._col)&&b.hasOwnProperty(c)&&xui.isSet(b=b[c]))?b:((b=e.colOptions)&&b.hasOwnProperty(c)&&xui.isSet(b=b[c]))?b:((b=e)&&b.hasOwnProperty(c)&&xui.isSet(b=b[c]))?b:null},_trycheckrowdirty:function(b,a){if(!a||!a._row){return}xui.resetRun(b.key+":"+b.$xid+":"+a._row.id,function(){if(!b.box){return}var d=b.$cellInEditor;if(a._row&&(!d||(d._row&&d._row!=a._row))){var c=false;xui.arr.each(a._row.cells,function(e){if(e._oValue!==e.value||(("unit" in e)&&e._oUnit!==e.unit)){c=true;return false}});if(c&&a._row.id!=b.box._temprowid&&b.onRowDirtied){b.boxing().onRowDirtied(b,a._row)}}},100)},_adjusteditorW:function(c,a,b){if(a){a.each(function(e,d){if(!(d=e.id)){return}d=d.split(":")[2];if(d=c.cellMap[d]){if(d._editor){d._editor.setWidth(b)}}})}},_adjusteditorH:function(c,b,a){b.each(function(f,e){if(!(e=f.id)){return}e=e.split(":")[2];if(e=c.rowMap[e]){e=e.cells;for(var d in e){d=e[d];if(d._editor){d._editor.setHeight(c.$addpx(a,1,d._editor.getRootNode()))}}}})},_editCell:function(m,L,al,I){var P=typeof L=="string"?(m.cellMap[L]||m.cellMap[m.cellMap2[L]]):L;if(!P){return}L=P._serialId;var o=m.box,N=function(an,ao){return o.getCellOption(m,ao||P,an)};if(N("disabled")||N("readonly")||!N("editable")){return}var a,ad=this,J=m.properties,Y=m.getRoot().contentBox(),am=N("type")||"input",r=P._col,j=r.id,E=P._row,aa=E.id,ac=aa==m.box._temprowid,W=N("editMode"),D=W=="inline"||(N("type")=="dropbutton"),l=m.getSubNode("SCROLL"+E._region+r._region),V=m.getSubNode("CELL",L),x=J.treeMode=="infirstcell"&&m.getSubNode("ROWTOGGLE",L);if(x&&(x.isEmpty()||!x.get(0).clientWidth)){x=null}if(!D){a=m.$curEditor;if(a){xui.tryF(a.undo,[],a)}a=null}if(D&&P._editor){if(!I){P._editor.activate()}return}else{if(am=="checkbox"||am=="button"){if(!I){m.getSubNode("CELLA",L).focus(true)}return}}if((a=N("customEditor"))&&typeof a.iniEditor=="function"){a.iniEditor(m,P,V);if(!I){xui.tryF(a.activate,[],a)}if(m.onBeginEdit){m.boxing().onBeginEdit(m,P,a,"cell")}}else{if(m.beforeIniEditor){a=m.boxing().beforeIniEditor(m,P,V,l,"cell");if(a===false){return}}if(am=="label"){if(!I){m.getSubNode("CELLA",L).focus(true)}return}if(!a||!a["xui.UI"]){var O=N("editorAutoPop"),A=N("editorCacheKey"),e=N("editorProperties"),K=N("editorCC"),u=N("editorCS"),w=N("editorEvents"),G=N("editorFormat"),ak=N("editorMask"),C=N("editorReadonly"),c=N("editorHAlign"),Z=N("editorDropListWidth"),af=N("editorDropListHeight"),d=N("editorCommandBtn"),ae,ah;if(!D){if(A&&m.$cache_editor[A]){a=m.$cache_editor[A]}if(a&&(!a.get(0)||a.isDestroyed())){a=nulll}}if(!a){var X={dirtyMark:false,cachePopWnd:false,left:-1000,top:-1000,position:"absolute",visibility:"hidden",zIndex:100};if(D){xui.merge(X,{left:0,top:0,cachePopWnd:true,width:m.$px(P._col._colWidth)+(Y?2:1),height:m.$px(P._row._rowHeight)+(Y?1:0),visibility:"visible",zIndex:100},"all")}a=new xui.UI.ComboInput(X)}switch(am){case"spin":case"counter":case"currency":a.setType(am);xui.each(xui.toArr("precision,increment,min,max,maxlength,currencyTpl,numberTpl,groupingSeparator,decimalSeparator,forceFillZero,trimTailZero,unit,units"),function(ao,an){v=N(ao);if(am=="currency"){if(ao=="precision"&&!v){v=2}}else{if(ao=="precision"&&!v){v=0}if(ao=="increment"&&!v){v=1}}if(xui.isSet(v)){a["set"+xui.str.initial(ao)](v)}});break;case"progress":a.setType("spin").setMax(1).setMin(0).setPrecision(4).setIncrement(0.01);break;case"input":a.setType("none");break;case"checkbox":a.setType("checkbox");break;case"textarea":a.setType("none").setMultiLines(true).setCommandBtn("save").onCommand(function(an){an.boxing().hide()});if(!D){xui.tryF(a.setResizer,[true],a)}break;case"date":case"datetime":var F=N("dateEditorTpl");if(F){a.setDateEditorTpl(F)}case"listbox":case"combobox":case"helpinput":case"time":case"color":case"getter":case"popbox":case"dropbutton":case"cmdbox":a.setType(am);if(m.box.getCellOption(m,P,"disabled")){}else{a.beforeComboPop(function(ao,at,aq,ar){var an=ao.$cell,ap=m.box.getCellOption(m,an,"event");if(typeof ap=="function"){return ap.call(m._host||m,m,an,ao,at,aq,ar)}else{return m.boxing().beforeComboPop(m,an,ao,at,aq,ar)}});if(m.beforePopShow){a.beforePopShow(function(an,ap,ao){return m.boxing().beforePopShow(m,an.$cell,an,ap,ao)})}if(m.afterPopShow){a.afterPopShow(function(an,ao){return m.boxing().afterPopShow(m,an.$cell,an,ao)})}if(am=="popbox"||am=="cmdbox"||am=="getter"||am=="dropbutton"){if(m.onEditorClick){a.onClick(function(ao,ap,aq,an){return m.boxing().onEditorClick(m,ao.$cell,ao,an,aq)})}}}break;case"file":a.setType(am);break}if(m.onCommand){a.onCommand(function(an,ap,ao){return m.boxing().onCommand(m,an.$cell,an,ap,ao)})}P._editor=a;if(D){V.append(a)}else{l.append(a)}if(!D&&A){m.$cache_editor[A]=a}if(a.setInputReadonly){a.setInputReadonly(!!C)}if(a.setDropListWidth&&Z){a.setDropListWidth(Z)}if(a.setDropListHeight&&af){a.setDropListHeight(af)}if(a.setHAlign&&c){a.setHAlign(c)}if(a.setCommandBtn&&d){a.setCommandBtn(d)}if(G){if(typeof G=="function"&&a.beforeFormatCheck){a.beforeFormatCheck(G)}else{if(typeof G=="string"&&a.setValueFormat){a.setValueFormat(G)}}}if(ak&&a.setMask){a.setMask(ak)}if(e){ah={};var aj=m.getProperties();xui.each(e,function(ao,an){ah=aj[an]});a.setProperties(e)}if(K){a.setCustomClass(xui.clone(K,2))}if(u){a.setCustomStyle(xui.clone(u,2))}if(w){a.setEvents(w)}if(!D){a.resetValue()}switch(am){case"listbox":case"combobox":case"helpinput":if(ae=N("editorListItems")){a.setListKey(null);a.setItems(typeof(ae)=="function"?ae():ae)}else{if(ae=N("editorListKey")){a.setItems(null);a.setListKey(typeof(ae)=="function"?ae():ae)}}break}a.setValue(xui.isSet(P.$editorValue)?P.$editorValue:P.value,true,"editorini");delete P.$editorValue;if(a.setCaption){if(e&&("caption" in e)&&xui.isDefined(e.caption)){a.setCaption(e.caption,true)}else{if(am=="cmdbox"||am=="popbox"||am=="button"||am=="dropbutton"){a.setCaption(P._caption||P._$tmpcap||P.caption||"",true)}}}if(P.$tag){if(a.setCaption){a.setCaption(P.$tag)}else{if(a.setValue){a.setValue(P.$tag,null,"editortag")}}}a.get(0).$cell=P;a.get(0)._smartnav=true;a.undo=D?null:function(an,aq){var ap=this;ap.undo=null;if(m.box){m.box._trycheckrowdirty(m,m.$cellInEditor)}if(!aq){if(ap.get(0)&&ap.get(0).box){ap.getSubNode("INPUT").onBlur(true);if(an&&xui.str.endWith(W,"sharp")){P._ignorefocus=1;m.boxing().focusCell(m.$cellInEditor);xui.asyRun(function(){delete P._ignorefocus})}}ap.getRoot().setBlurTrigger(m.$xid+":editor");if(m.properties&&!m.properties.directInput){ap.beforeUnitUpdated(null).afterUIValueSet(null).beforeNextFocus(null).onCancel(null).afterPopHide(null);ap.setValue("",true,"editorreset")}if(G){if(ap.beforeFormatCheck){ap.beforeFormatCheck(null)}if(ap.setValueFormat){ap.setValueFormat("")}}if(ak){if(ap.setMask){ap.setMask("")}}if(ap.setInputReadonly){ap.setInputReadonly(!C)}if(Z){if(ap.setDropListWidth){ap.setDropListWidth(0)}}if(af){if(ap.setDropListHeight){ap.setDropListHeight(0)}}if(ah){ap.setProperties(ah);ah=null}delete ap.get(0).$cell;delete ap.get(0)._smartnav;ap.hide();if(xui.isFun(ap.collapse)){ap.collapse()}}if(w){var ao={};xui.each(w,function(at,ar){ao[ar]=null});ap.setEvents(ao)}m.$curEditor=null;m.$cellInEditor=null;if(m.onEndEdit){m.boxing().onEndEdit(m,P,ap,"cell")}if(!A&&ap.get(0)){ap.destroy(true)}P._editor=ap=null};var ag=m.boxing(),R=ag.getCellPos(P),U,b,T=function(an){if(R){return ag.getCellbyRowCol(R.row,R.col)}else{return an.$cell}};a.beforeUnitUpdated(function(ao,an){U=T(ao);if(m.beforeUnitUpdated&&false===ag.beforeUnitUpdated(m,U,ao,an)){return false}ad._updCell(m,U,{value:U.value,unit:an},m.properties.dirtyMark,true,true);if((b=T(ao))&&b!==U){ao.$cell=b;b._editor=a;if(!D){m.$cellInEditor=b}}}).afterUIValueSet(function(av,ar,ao,au,an){U=T(av);if(!U){return}var at=N("type",U),ap;switch(at){case"number":case"spin":case"counter":case"progress":ao=parseFloat(ao);ao=(ao||ao===0)?ao:null;break;case"currency":ao=parseFloat((""+ao).replace(/[^\d.-]/g,""));ao=(ao||ao===0)?ao:null;break;case"cmdbox":case"button":case"dropbutton":case"popbox":case"combobox":case"listbox":case"helpinput":ap=av.boxing().getShowValue();break}var aq={value:ao};if(xui.isDefined(ap)){aq.caption=ap}if(av.properties.hasOwnProperty("tagVar")&&!xui.isEmpty(av.properties.tagVar)){aq.tagVar=av.properties.tagVar}if(false!==(m.beforeEditApply&&m.boxing().beforeEditApply(m,U,aq,a,an,"cell"))){ad._updCell(m,U,aq,m.properties.dirtyMark,true,true);if((b=T(av))&&b!==U){av.$cell=b;b._editor=a;if(!D){m.$cellInEditor=b}}if(xui.str.endWith(W,"sharp")&&at!="spin"&&at!="counter"){xui.tryF(a.undo,[true],a)}}}).beforeNextFocus(function(ap,ao){if(a.undo){xui.tryF(a.undo,[true],a)}var an=xui.Event.getEventPara(ao);if(an.key=="enter"){an.$key="right"}m.getSubNode("CELLA",P._serialId).onKeydown(true,an);return false}).onFileDlgOpen(function(an,ao){if(m.onFileDlgOpen){m.boxing().onFileDlgOpen(m,P,an,ao)}});if(!D){a.onCancel(function(){if(a){xui.tryF(a.undo,[],a)}}).afterPopHide(function(ap,ao,an){if(xui.str.endWith(W,"sharp")){xui.tryF(a.undo,[an!="blur"&&an!="call"],a)}}).getRoot().setBlurTrigger(m.$xid+":editor",function(){if(a){xui.tryF(a.undo,[],a)}return false});var ab=V.offset(null,l),q=V.cssSize(),B=x?x.offset(null,V):null,S=x?x.width():null;if(B){B.left+=S}if(x&&(B.left>q.width-8)){return}if(am=="textarea"){a.setWidth(Math.max(200,q.width-(x?B.left:0)+(Y?3:0))).setHeight(Math.max(100,q.height+(Y?2:0))).reLayout(true,true).reBoxing().popToTop(V,4,l)}else{a.setWidth(q.width-(x?B.left:0)+(Y?3:0)).setHeight(q.height+(Y?2:0)).reLayout(true);a.reBoxing().show((ab.left+(x?B.left:0)-(Y?1:0))+"px",(ab.top-(Y?1:0))+"px")}var g,Q=am=="cmdbox"||am=="cmdbox"||am=="listbox"||am=="file",H=Q||am=="date"||am=="time"||am=="datetime"||am=="color",n=a.getInputReadonly&&a.getInputReadonly(),s=xui.str.endWith(W,"sharp")&&(O||n||H);if(!I){if(xui.isFun(a.expand)&&O!==false&&(s||((xui.str.endWith(W,"sharp")||W=="focus")&&(O||Q)))){g=1;a.expand(V,false,null)}}a.get(0).$editMode=W;if(!D){a.setVisibility(s?"hidden":"visible")}if(!xui.str.startWith(W,"hover")||!al){if(!I){xui.asyRun(function(){if(!m.box){return}var an=a;if(an.get(0)&&an.get(0).box){if(g&&a.getPopWnd){an=a.getPopWnd()}if(an){xui.tryF(an&&an.activate,[],an);an.get(0)._stopmouseupcaret=1}}})}}else{var f=function(){if(a){a.getRoot().onMouseout(null,"tg-hover-edit")}},M=function(){if(a){a.getRoot().onMouseout(function(){if(a){xui.tryF(a.undo,[],a)}},"tg-hover-edit")}},ai=function(){};a.onFocus(f).beforePopShow(function(ao,ap,an){f();a.onBlur(null);if(m.beforePopShow){return m.boxing().beforePopShow(m,ao.$cell,ao,ap,an)}}).afterPopHide(function(){M();a.onBlur(ai)}).onBlur(ai);if(!I&&!g){xui.tryF(a&&a.activate,[],a)}}}if(m.onBeginEdit){m.boxing().onBeginEdit(m,P,a,"cell")}}}if(!D){m.$curEditor=a;m.$cellInEditor=P}if(ac){m.__needchecktmprow=true;m.box._sethotrowoutterblur(m)}},_adjustBody:function(b,a,c){if(!b.renderId||b.destroyed){return}xui.resetRun(b.$xid+"4",function(){if(!b.renderId||b.destroyed){return}var u=b.properties,I=xui.$us(b),M=function(l,w){return b.$forceu(l,I>0?"em":"px",w)},n=b.getSubNode("BORDER").cssSize(),D=b.getRoot().contentBox()?2:0,d=b.$px(n.width),f=b.$px(n.height),K=u.rowHandler?(b.$px(u.rowHandlerWidth)+D):0,J,G=b.getSubNode("HEADER1"),F=b.getSubNode("HEADER2"),j=b.getSubNode("BODY12"),Q=b.getSubNode("BODY21"),o=b.getSubNode("SCROLL11"),m=b.getSubNode("SCROLL12"),T=b.getSubNode("SCROLL21"),S=b.getSubNode("SCROLL22"),L=F.height(),H=j.height();if(u.freezedColumn){xui.arr.each(u.header,function(l,w){if(w==u.freezedColumn){return false}if(!l.hidden){K+=b.$px(l.width)+D}})}if(H&&u.freezedRow){H-=1}if(K&&u.freezedColumn){K-=1}J=d-K;b._leftregionw=K;F.width(M(J));S.width(M(J));xui.asyRun(function(){var ab=Q.isEmpty(),Y=T.isEmpty(),w=j.isEmpty(),ac=m.isEmpty(),Z=u.freezedRow,aa=!Y?((S.isScrollBarShowed("x")?xui.Dom.getScrollBarSize():0)+"px"):"",ad=!Y?S.scrollTop():0,X=(Z&&!ac)?S.scrollLeft():0,l=(Z&&!w)?((S.isScrollBarShowed("y")?xui.Dom.getScrollBarSize():0)+"px"):"";if(!ab){Q.css("padding-bottom",aa)}if(Z&&!w){j.css("padding-right",l)}if(!Y){T.scrollTop(ad)}if(Z&&!ac){m.scrollLeft(X)}},100);o.height(H?M(H):0);m.height(H?M(H):0);T.height(M(f-L-H));S.height(M(f-L-H));o.css("display",H&&b._leftregionw?"":"none");m.css("display",H?"":"none");T.css("display",b._leftregionw?"":"none");S.css("overflow","hidden");var x=b.box._adjustRelWith(b);var C=b.getSubNode("ROWS22"),g=b.getSubNode("HCELLS2"),q=b.properties.header,R=b.getSubNode("SCROLL22"),P,U,r,E=b.keys,W,O,B,A;if(C.get(0).clientHeight){if(g.get(0).clientHeight){if(P=g.get(0).childNodes){U=P.length;while(U){if(P[U-1].clientHeight){r=P[U-1];break}--U}}W=r?(r.offsetWidth+r.offsetLeft+100):0;B=M(W);A=M(O=W)}else{if(P=C.get(0).childNodes){U=P.length;while(U){if(P[U-1].clientHeight){r=P[U-1];break}--U}if(r){var s=b.getSubId(r.id);P=b.getSubNode("CELLS2",s);if(P=P.get(0).childNodes){U=P.length;while(U){if(P[U-1].clientHeight){r=P[U-1];break}--U}}}}}}if(r){A=M(O=r.offsetLeft)}else{var u=b.properties,e=u.header,V=u.rows,N=0;xui.arr.each(e,function(l){if(l.hidden!==true){N+=("_colWidth" in l)?b.$px(l._colWidth):(b.$px(l.width)+D)}});A=M(O=N)}P=r=null;if(B){g.parent().width(B)}if(A){C.width(A)}R.css("overflow","auto");if(O>R.width()+D){x="auto"}R.css("overflowX",x);R.onScroll();if(b.onBodyLayout){b.boxing().onBodyLayout(b,a)}if(c){c()}});if(a!="render"&&a!="rowhandler"&&a!="foldrow"&&a!="expandrow"&&a!="setcol"&&a!="resize"){xui.resetRun(b.key+":"+b.$xid,function(){if(b&&b.box){b.boxing().triggerFormulas(null,a)}})}},_adjustHeader:function(c){var d=xui.copy(c),b;xui.arr.each(d,function(e,a){d[a]=xui.copy(e)});return d},_adjustGrpColsData:function(f,q){if(!xui.isArr(q)){return xui.copy(q)}var b=f.properties,n=b.header,u=n.length,s=(u+"").length,d=xui.UI.$tag_subId,w=xui.copy(q,function(a){a.from=parseInt(a.from,10)||0;a.to=parseInt(a.to,10)||0;return a.from<=u&&a.to<=u&&a.to>=a.from});xui.arr.each(w,function(j,a){w[a]=xui.isHash?xui.copy(j):{}});xui.arr.stableSort(w,function(a,j){return a.from>j.from?1:a.from==j.from?(a.to>j.to?-1:a.to==j.to?0:1):-1});for(var g=0,e=w.length,x;g<e;g++){x=w[g];x[d]=x[d]||("-g_"+f.pickSubId("grpCol"));x.id=x.id||x[d];if(!x.caption){x.caption=x.id}x._isgroup=1;delete x._grp;f.colMap[x[d]]=x;f.colMap2[x.id]=x[d]}xui.arr.each(w,function(A,m){for(var a=0;a<m;a++){if(w[m]["to"]>w[a].from&&w[m].from<w[a]["to"]){if(w[m]["to"]>w[a]["to"]){w[m]["to"]=w[a]["to"]}(w[m]._grp||(w[m]._grp=[])).push(w[a].id)}}});xui.arr.each(n,function(a){delete a._grp});var r=0;for(var g=0,e=w.length,x,c;g<e;g++){x=w[g];for(var l=x.from;l<=x.to;l++){c=n[l];(c._grp||(c._grp=[])).push(x.id);if(!x._layer){x._layer=c._grp.length}r=Math.max(r,x._layer)}}f._headerLayers=r;return w},_adjustRows:function(d,l,g){var q,e,j={},o={},r={},b=d.properties,n=b.uidColumn,s,u,c,f=[];if(n){n=xui.arr.subIndexOf(b.header,"id",n)}else{n=-1}xui.arr.each(b.header,function(m,a){s=m.id||m;u=null;if(!g&&s.indexOf(":")!=-1){u=s.split(":")}if(u&&u[0]&&u[1]){o[u[0]]=r[u[1]]=a;f.push(u[0],u[1]);c=1}else{j[s]=a;f.push(s)}});if(xui.isArr(l)&&l.length&&typeof l[0]!="object"){q=[l]}else{q=xui.copy(l)}xui.arr.each(q,function(a,B){if(xui.isArr(a)){q[B]={cells:xui.copy(a)}}else{q[B]=xui.copy(a)}if(c&&xui.isArr(q[B].cells)){var E=q[B].cells,D=[],m;for(var x=0,w=f.length;x<w;x++){m=f[x];if(m in j){D.push(E[x])}else{if(m in o){D.push({value:E[x],caption:E[++x]})}}}q[B].cells=D}var C=(xui.isHash(q[B])&&(!q[B].cells||!xui.isObj(q[B].cells)))?1:(q[B].cells&&xui.isHash(q[B].cells))?2:0;if(!a.group&&C){var F=[],A;xui.each(C==1?q[B]:q[B].cells,function(G,H){if(H in j){F[j[H]]=xui.isHash(G)?G:{value:G}}else{if(H in o){A=F[o[H]]||{};A.value=G;F[o[H]]=A}if(H in r){A=F[r[H]]||{};A.caption=G;F[r[H]]=A}}});q[B].cells=F}xui.arr.each(e=q[B].cells,function(H,G){if(xui.isDefined(H)){if(!!H&&xui.isHash(H)){e[G]=xui.copy(H)}else{e[G]={value:H}}}});if(!("id" in q[B])&&n!=-1&&e[n]&&e[n].value){q[B].id=e[n].value}});return q},_adjustColsWidth:function(f){var b=f.properties,s=b.header,u=b.grpCols,q=f.getRoot().contentBox()?2:0;if(b.showHeader){if(u&&xui.isArr(u)&&u.length){var C,g,x,w=false,a,B=0;for(var r=0,e=u.length,A,d;r<e;r++){g=x=0;w=false;A=u[r];C=0;for(var l=0,c;l<=A.to;l++){c=s[l];a=f.$px(c._colWidth,null,true);if(b.freezedColumn&&b.freezedColumn==l&&!B){B=C}if(l===A.from){w=true;g=C}C+=a+q;if(w&&!c.hidden){x+=a+q}}d=f.getSubNode("HCELL",A._serialId);if(x>q){d.css({display:"",left:f.$forceu(g-(b.freezedColumn?(A.to>b.freezedColumn-1?B:(b.rowHandler?-(f.$px(b.rowHandlerWidth)+q):0)):0)),width:f.$forceu(x-q)})}else{d.css({display:"none"})}if(b.freezedColumn&&b.rowHandler&&A._shadow){d=f.getSubNode("HSCELL",A._serialId);if(x>q){d.css({display:"",left:f.$forceu(g+(f.$px(b.rowHandlerWidth)+q)),width:f.$forceu(x-q)})}else{d.css({display:"none"})}}}}}},_adjustColsHeight:function(d,b){var x=d.colMap,A=d.colMap2,s=d._headerLayers,j=d.properties.headerHeight,w=d.$px(j,0,true),o=d.$px(d.box.$DataModel.headerHeight.ini,0,true)*(s+1),q=d.getRoot().contentBox()?1:0,a,r,f,e,m,n,u,c,g;if(b||w<o){w=o}d.getSubNodes(["HCELLS1","HCELLS2","GRPCELLBOX1","GRPCELLBOX2"]).height(d.$px2em(w)+"em");g=d.$px2em(w-q)+"em";d.getSubNode("FHCELL").css({height:g});if(!s){d.getSubNode("HCELL",true).css({height:g})}else{f=w/(s+1);d.getSubNode("HCELL",true).each(function(B){e=d.getSubId(B.id);if(e=x[e]){if(e&&e._isgroup){u=0;for(var l in x){a=x[l];if(a._isgroup&&a._layer<e._layer&&a.from<=e.to&&a.to>=e.from){u+=d.$px(a.height||f)}}xui(B).top(d.$px2em(u)+"em");n=d.$px(e.height||f)}else{if(e._grp&&(r=e._grp.length)){c=0;for(var l=0;l<r;l++){if(a=A[e._grp[l]]){c+=d.$px(x[a].height||f)}}n=w-c}else{n=w}}xui(B).height(d.$px2em(n-q)+"em");if(e&&e._isgroup&&e._shadow){B=d.getSubNode("HSCELL",e._serialId);xui(B).top(d.$px2em(u)+"em");xui(B).height(d.$px2em(n-q)+"em")}}})}},_focuscell:function(d,l,a){if(d.properties.disabled||d.properties.readonly){return}if(!xui.use(a).get(0)){return}if(!d.$_ensureOnce){d.$_ensureOnce=1;xui.asyRun(function(){d.$_ensureOnce=0})}else{return}var c=d.properties,g=d.box,f=g.getCellOption,o=d.cellMap[d.getSubId(a)],j=c.activeMode,b;if(o&&o._ignorefocus){return}if(o){var n=false,m=f(d,o,"type");if(f(d,o,"editable")){if(f(d,o,"disabled")||f(d,o,"readonly")){n=false}else{n=true;if((f(d,o,"editMode")=="inline"&&m!=="label")||m=="dropbutton"){if(o._editor){o._editor.activate()}}else{g._editCell(d,o._serialId);xui(a).parent().tagClass("-active",false);xui.asyRun(function(){if(!d.box){return}xui.use(a).parent().onMouseout(true,{$force:true}).parent().onMouseout(true,{$force:true})})}}}if(!n){if(o&&j=="cell"){b=xui.use(a).parent().id();g._activeCell(d,b)}}else{if(o&&j=="cell"){g._activeCell(d,false)}}}else{var q=d.rowMap[d.getSubId(a)];if(f(d,q,"editable")){if(f(d,q,"disabled")||f(d,q,"readonly")){}else{d.boxing().editFirstCell(q)}}}if(j=="row"){b=xui.use(a).parent(2).id();g._activeRow(d,b)}},_getToggleNode:function(a,b){return a.getSubNode("ROWTOGGLE",b)},_showTips:function(e,d,g){if(e.properties.disableTips){return}if(e.onShowTips){return e.boxing().onShowTips(e,d,g)}if(!xui.Tips){return}var j=e.keys,l,b,a,f,c;if(e.properties.disabled){return}a=d.id;f=xui.get(d,["parentNode","id"])||"";c=xui.get(d,["parentNode","parentNode","id"])||"";b=e.getSubId(a);if(a.indexOf(j.FHCELL)==0||f.indexOf(j.FHCELL)==0||c.indexOf(j.FHCELL)==0){l={tips:e.properties.tips}}else{if(a.indexOf(j.FCELL)==0||f.indexOf(j.FCELL)==0){l=e.rowMap[b]}else{if(a.indexOf(j.HCELL)==0||a.indexOf(j.HSCELL)==0||f.indexOf(j.HCELLA)==0){l=e.colMap[b]}else{if(a.indexOf(j.CELL)==0||f.indexOf(j.CELLA)==0){l=e.cellMap[b]}}}}if(l){xui.Tips.show(g,("tips" in l)?l.tips:(l._$tips||l._caption||l.caption));return false}else{return true}},_adjustRelWith:function(b){var a=b.properties,u,q=b.colMap,n=b.getSubNode("SCROLL22"),j=b.getSubNode("BODY22"),r=j.contentBox()?2:0,B=n.width(),F=0,d=0;b.getSubNodes("HCELL",true).each(function(l){if(l.clientHeight){F=l.offsetWidth-b.$px(l.style.width);return false}});var e=0,A=0,x=[],m=[],g;xui.each(b.colMap,function(l){if(l.hidden||l._isgroup){return}if(l._region==1){return}if(!l.flexSize){e+=b.$px(l.width)}else{A+=b.$px(l.width);x.push(l);m.push(l)}d++});var f=b.getSubNode("LHCELL").get(0).clientWidth||0;b.getSubNodes("LCELL",true).each(function(l){if(l.children.length){f=Math.max(f,l.clientWidth)}});b.__lcellW=f;if(!x.length){g="auto";b.box._adjustColsWidth(b);return}else{g="hidden";if(n.scrollable("y")){B-=xui.Dom.getScrollBarSize()}}B-=b.__lcellW;b._relWTotal=A;b._relAvailable=B-(e+d*F);while(x.length&&B!=e+d*F){var G=b._relAvailable,H=0,s,C=x.length,E=0;for(var D=C-1;D>=0;D--){var c=x[D],o=D===0?(G-H):Math.round(G*(b.$px(c.width)/A));if(o<0){o=0}u=o;if(c.hasOwnProperty("minWidth")){if((s=b.$px(c.minWidth))>o){e+=s;u=s;xui.arr.removeFrom(x,D);E++}}if(c.hasOwnProperty("maxWidth")){if((s=b.$px(c.maxWidth))<o){e+=s;u=s;xui.arr.removeFrom(x,D);E++}}c._colWidth=b.$forceu(u);H+=u}if(E===0||E===C){break}}b.box._adjustColsWidth(b);if(m.length){xui.arr.each(m,function(w){var I,l=[];xui.each(w._cells,function(J){I=b.getSubNode("CELL",J);if(I._nodes.length){l.push(I.get(0))}});I=b.getSubNode("HCELL",w._serialId);if(I._nodes.length){l.push(I.get(0))}b.box._adjusteditorW(b,xui(l).width(w._colWidth),b.$px(w._colWidth)+r)})}return g},_getRow:function(e,g,d,c){if(g){if(d=="data"){return xui.clone(g,true)}else{if(d=="value"){var f={};xui.each(g.cells||g,function(a,l){f[a._col.id]=("value" in a)?a.value:a});return f}else{if(d=="min"){var b=[];xui.each(g.cells||g,function(a,l){b[l]=("value" in a)?a.value:a});return b}else{if(d=="map"){return e.boxing().getRawData(g,c)}else{return g}}}}}},$cancelHoverEditor:function(d){if(d.destroyed){return}var c=xui.get(d,["$curEditor","_nodes",0,"$editMode"])||"",a;if(xui.str.startWith(c,"hover")){var b=d.$curEditor;if(c=="hover"&&(a=b.get(0))&&a.$poplink){return false}xui.tryF(b.undo,[],b)}},_onresize:function(b,w,u){var a=b.properties,C=function(f){return b.getSubNode(f)},m=xui.$us(b),E=function(f,F){return b.$forceu(f,m>0?"em":"px",F)},x=b.getRoot(),B=x.contentBox()?2:0,o=a.rowHandler?(b.$px(a.rowHandlerWidth)+B):0,n,A=C("BORDER"),j=C("HEADER1"),g=C("HEADER2"),D=C("BODY12"),c=C("BODY21"),e=C("SCROLL11"),d=C("SCROLL12"),s=C("SCROLL21"),q=C("SCROLL22"),r=g.height(),l=D.height();w=w?b.$px(w,null,true):w;u=u?b.$px(u,null,true):u;A.cssSize({width:w?E(w):null,height:u?E(u):null});if(w){if(a.freezedColumn){xui.arr.each(a.header,function(f,F){if(F==a.freezedColumn){return false}if(!f.hidden){o+=b.$px(f.width)+B}})}if(l&&a.freezedRow){l-=1}if(o&&a.freezedColumn){o-=1}n=w-o;b._leftregionw=o;g.width(E(n))}if(u){e.height(l?E(l):0);d.height(l?E(l):0);s.height(E(u-r-l));q.height(E(u-r-l));e.css("display",l?"":"none");d.css("display",l?"":"none")}if(w){e.css("display",b._leftregionw?"":"none");s.css("display",b._leftregionw?"":"none")}if(b.$forceRelayout){this._adjustColsWidth(b);this._adjustColsHeight(b)}this._adjustBody(b,"resize")}}});xui.Class("xui.UI.Slider",["xui.UI","xui.absValue"],{Instance:{_setCtrlValue:function(a){return this.each(function(e){var d=e.properties,l=d.steps,j=function(b){return e.getSubNode(b)},o=j("IND1"),m=j("IND2"),g=j("BG"),r=d.type=="vertical",f=e.box._v2a(e,a),u=r?"top":"left",q=r?"height":"width",n,s=xui.adjustRes(d.labelCaption,true)||"";if(d.isRange){o[u](f[0]+"%");m[u](f[1]+"%");g[u](f[0]+"%")[q]((f[1]-f[0])+"%");n=(d.numberTpl+"").replace(/[*12]/g,function(b){return b=="1"?xui.formatNumeric(f[0],d.precision||0,null,null,true):b=="2"?xui.formatNumeric(f[1],d.precision||0,null,null,true):s})}else{o[u](f[0]+"%");g[q](f[0]+"%");n=(d.numberTpl+"").replace(/1[^2]*2/,"1").replace("1",xui.formatNumeric(f[0],d.precision||0,null,null,true));if(n.indexOf("*")!=-1){n=n.replace("*",s)}else{n+=s}}if(d.labelPos!="none"&&parseFloat(d.labelSize)){e.getSubNode("LABEL").html(n)}})},_setDirtyMark:function(){return arguments.callee.upper.apply(this,["BOX"])}},Static:{Templates:{style:"{_style}",className:"{_className} xui-ui-ellipsis {_cls}",LABEL:{className:"{_required}",style:"{labelShow};width:{_labelSize};{labelHAlign}",text:"{labelCaption}"},BOX:{tagName:"div",RULER:{$order:1,tagName:"div",className:"xui-uiborder-flat xui-uibase xui-uiborder-radius",BG:{tagName:"div",className:"xui-uibar xui-uiborder-radius"}},IND:{$order:2,IND1:{tagName:"span",className:"xui-uibar xui-uigradient xui-ui-btn xui-uiborder-circle xuicon xui-icon-placeholder",style:"{_showD}",tabindex:"{tabindex}"},IND2:{tagName:"span",className:"xui-uibar xui-uigradient xui-ui-btn xui-uiborder-circle xuicon xui-icon-placeholder",style:"{_showD2}",tabindex:"{tabindex}"}},DECREASE:{style:"{_showDes}",className:"xuifont",$fonticon:"{_fi_decls}",tabindex:"{tabindex}"},INCREASE:{style:"{_showIns}",className:"xuifont",$fonticon:"{_fi_incls}",tabindex:"{tabindex}"}}},Appearances:{"IND, BT, RULER, IND1, IND2, DECREASE, INCREASE":{position:"absolute"},LABEL:{"z-index":1,top:0,left:0,display:xui.browser.isWebKit?"-webkit-flex":"flex",position:"absolute","padding-top":".5em"},BOX:{position:"absolute",left:0,top:0,width:"100%",height:"100%"},"KEY-h BOX":{$order:1,height:"2em"},"KEY-v BOX":{$order:2,width:"2em"},"KEY-v LABEL":{"writing-mode":"tb-rl",filter:"flipv fliph"},"KEY-h DECREASE, KEY-h INCREASE":{top:"50%","margin-top":"-.5em"},"KEY-h IND1,KEY-h IND2, KEY-v IND1,KEY-v IND2":{padding:0,margin:0},"KEY-h DECREASE":{$order:1,left:0},"KEY-h INCREASE":{$order:1,right:0},BG:{position:"absolute",left:0,top:0,height:"100%",width:"100%"},"KEY-h IND":{"z-index":1,top:"50%",height:xui.browser.contentBox?"2px":"4px","margin-top":"-1px"},"KEY-h RULER":{$order:2,top:"50%",height:xui.browser.contentBox?"2px":"4px","margin-top":"-2px"},"KEY-v DECREASE, KEY-v INCREASE":{$order:10,left:"50%","margin-left":"-.5em"},"KEY-v DECREASE":{$order:10,top:0},"KEY-v INCREASE":{$order:10,bottom:0},"KEY-v IND":{$order:10,"z-index":1,left:"50%",width:xui.browser.contentBox?"2px":"4px","margin-left":"-1px"},"KEY-v RULER":{$order:10,"z-index":1,left:"50%",width:xui.browser.contentBox?"2px":"4px","margin-left":"-2px"},"KEY-h IND1,KEY-h IND2":{$order:1,"z-index":2,left:0,top:0,cursor:"e-resize","margin-top":"-.5em","margin-left":"-.5em"},"KEY-v IND1,KEY-v IND2":{$order:10,"z-index":2,left:0,top:0,cursor:"n-resize","margin-top":"-.5em","margin-left":"-.5em"}},Behaviors:{HoverEffected:{IND1:"IND1",IND2:"IND2",DECREASE:"DECREASE",INCREASE:"INCREASE"},ClickEffected:{IND1:"IND1",IND2:"IND2",DECREASE:"DECREASE",INCREASE:"INCREASE"},IND:{onClick:function(c,m,a){var b=c.properties;if(b.disabled||b.readonly){return false}var u=xui.use(a).offset(),s=xui.Event.getPos(m),g=c.box._v2a(c,c.properties.$UIvalue),f,d,o=b.type=="vertical",n=o?"top":"left",l=o?"top":"left",j=o?"height":"width",r=s[n]-u[n],q=(r/xui.use(a)[j]())*100;if(!b.isRange){g[0]=q}else{f=c.getSubNode("IND1")[l](),d=c.getSubNode("IND2")[l]();if(Math.abs(f-r)<Math.abs(d-r)){g[0]=q}else{g[1]=q}}c.boxing().setUIValue(c.box._adjustValue(c,g),null,null,"click")}},IND1:{onKeydown:function(c,f,g){var d=c.properties;if(d.disabled||d.readonly){return}var b=d.type=="vertical",a=xui.Event.getKey(f).key;if(a==(b?"up":"left")){c.box._auto(c,false)}if(a==(b?"down":"right")){c.box._auto(c,true)}},onKeyout:function(a){xui.Thread.abort(a.$xid+":auto")},onKeyup:function(a){xui.Thread.abort(a.$xid+":auto")},beforeMousedown:function(b,g,l){if(xui.Event.getBtn(g)!="left"){return}var f=b.properties;if(f.disabled||f.readonly){return}var a=f.type=="vertical",j=a?"top":"left",d=a?"height":"width",c=b.box;xui.use(l).startDrag(g,{widthIncrement:f.steps?b._size/f.steps:null,dragType:"none",targetReposition:true,horizontalOnly:a?true:null,verticalOnly:a?null:true,maxLeftOffset:xui.use(l)[j](),maxRightOffset:xui.use(l).parent()[d]()-xui.use(l)[j](),dragCursor:"default"});xui.use(l).css("zIndex",10).focus(true);b.getSubNode("IND2").css("zIndex",5)},beforeDragbegin:function(b,c,d){var a=b.properties.type=="vertical";xui(d)[a?"top":"left"](b.__x=b.$px(xui.use(d)[a?"top":"left"]()))},onDrag:function(c,d,g){var f=xui.DragDrop.getProfile().offset,b=c.properties.type=="vertical",a=c.box._v2a(c,c.properties.$UIvalue);a[0]=((c.__x+f[b?"y":"x"])/xui.use(g).parent()[b?"height":"width"]())*100;c.boxing().setUIValue(c.box._adjustValue(c,a),null,null,"drag")},onDragstop:function(a,b,c){xui(c).onMouseout(true,{$force:true}).onMouseup(true)},onClick:function(){return false}},IND2:{onKeydown:function(c,f,g){var d=c.properties;if(d.disabled||d.readonly){return}var b=d.type=="vertical",a=xui.Event.getKey(f).key;if(a==(b?"up":"left")){c.box._auto(c,false)}if(a==(b?"down":"right")){c.box._auto(c,true)}},onKeyout:function(a){xui.Thread.abort(a.$xid+":auto")},onKeyup:function(a){xui.Thread.abort(a.$xid+":auto")},beforeMousedown:function(b,g,l){if(xui.Event.getBtn(g)!="left"){return}var f=b.properties;if(f.disabled||f.readonly){return}var a=f.type=="vertical",j=a?"top":"left",d=a?"height":"width",c=b.box;xui.use(l).startDrag(g,{widthIncrement:f.steps?b._size/f.steps:null,dragType:"none",targetReposition:true,horizontalOnly:a?true:null,verticalOnly:a?null:true,maxLeftOffset:xui.use(l)[j](),maxRightOffset:xui.use(l).parent()[d]()-xui.use(l)[j](),dragCursor:"default"});xui.use(l).css("zIndex",10).focus(true);b.getSubNode("IND1").css("zIndex",5)},beforeDragbegin:function(b,c,d){var a=b.properties.type=="vertical";xui(d)[a?"top":"left"](b.__x=b.$px(xui.use(d)[a?"top":"left"]()))},onDrag:function(c,d,g){var f=xui.DragDrop.getProfile().offset,b=c.properties.type=="vertical",a=c.box._v2a(c,c.properties.$UIvalue);a[1]=((c.__x+f[b?"y":"x"])/xui.use(g).parent()[b?"height":"width"]())*100;c.boxing().setUIValue(c.box._adjustValue(c,a),null,null,"drag2")},onDragstop:function(a,b,c){xui(c).onMouseout(true,{$force:true}).onMouseup(true)},onClick:function(){return false}},DECREASE:{onMousedown:function(a){if(a.properties.disabled||a.properties.readonly){return}a.box._auto(a,false)},onMouseout:function(a){if(a.properties.disabled||a.properties.readonly){return}xui.Thread.abort(a.$xid+":auto")},onMouseup:function(a){if(a.properties.disabled||a.properties.readonly){return}xui.Thread.abort(a.$xid+":auto")}},INCREASE:{onMousedown:function(a){if(a.properties.disabled||a.properties.readonly){return}a.box._auto(a,true)},onMouseout:function(a){if(a.properties.disabled||a.properties.readonly){return}xui.Thread.abort(a.$xid+":auto")},onMouseup:function(a){if(a.properties.disabled||a.properties.readonly){return}xui.Thread.abort(a.$xid+":auto")}},LABEL:{onClick:function(a,b,c){if(a.properties.disabled){return false}if(a.onLabelClick){a.boxing().onLabelClick(a,b,c)}},onDblClick:function(a,b,c){if(a.properties.disabled){return false}if(a.onLabelDblClick){a.boxing().onLabelDblClick(a,b,c)}},onMousedown:function(a,b,c){if(xui.Event.getBtn(b)!="left"){return}if(a.properties.disabled){return false}if(a.onLabelActive){a.boxing().onLabelActive(a,b,c)}}}},DataModel:{position:"absolute",expression:{ini:"",action:function(){}},width:{$spaceunit:1,ini:"15em"},height:{$spaceunit:1,ini:"4em"},precision:0,numberTpl:"* - 1% ~ 2%",steps:0,value:"0:0",type:{listbox:["vertical","horizontal"],ini:"horizontal",action:function(a){this.boxing().refresh()}},isRange:{ini:true,action:function(a){this.boxing().refresh()}},showIncreaseHandle:{ini:true,action:function(a){this.adjustSize()}},showDecreaseHandle:{ini:true,action:function(a){this.adjustSize()}},labelSize:{$spaceunit:2,ini:0,action:function(a){this.getSubNode("LABEL").css({display:a?"":"none"});xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelPos:{ini:"left",listbox:["none","left","top","right","bottom"],action:function(a){xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelGap:{$spaceunit:2,ini:4,action:function(a){xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelCaption:{ini:"",action:function(a){var b=this.properties;if(b.labelPos!="none"&&parseFloat(b.labelSize)){this.getSubNode("LABEL").html(xui.adjustRes((xui.isSet(a)?a:"")+"",true))}}},labelHAlign:{ini:"right",listbox:["","left","center","right"],action:function(a){this.getSubNode("LABEL").css({textAlign:a||"",justifyContent:a=="right"?"flex-end":a=="center"?"center":a=="left"?"flex-start":""})}},labelVAlign:{ini:"top",listbox:["","top","middle","bottom"],action:function(a){this.getSubNode("LABEL").css("align-items",a=="bottom"?"flex-end":a=="middle"?"center":a=="top"?"flex-start":"")}}},EventHandlers:{onLabelClick:function(a,b,c){},onLabelDblClick:function(a,b,c){},onLabelActive:function(a,b,c){}},_prepareData:function(c){var f=arguments.callee.upper.call(this,c),e="display:none",b,a;f._showDes=f.showDecreaseHandle?"":e,f._showIns=f.showIncreaseHandle?"":e,f._showD2=f.isRange?"":e;f._cls=c.getClass("KEY",f.type=="vertical"?"-v":"-h");f._labelHAlign="text-align:"+(a=f.labelHAlign||"")+";justify-content:"+(a=="right"?"flex-end":a=="center"?"center":a=="left"?"flex-start":"");f._labelVAlign="align-items:"+((a=f.labelVAlign)=="bottom"?"flex-end":a=="middle"?"center":a=="top"?"flex-start":"");f.labelShow=f.labelPos!="none"&&f.labelSize&&f.labelSize!="auto"?"":"display:none";f._labelSize=f.labelSize?"":0+c.$picku();if(f.labelPos!="none"&&f.labelSize&&f.labelCaption){f.labelCaption=xui.adjustRes(f.labelCaption,true)}f._fi_decls="xui-icon-single"+(f.type=="vertical"?"up":"left");f._fi_incls="xui-icon-single"+(f.type=="vertical"?"down":"right");return f},_adjustValue:function(c,d){var e=c.properties,a=[];a[0]=parseFloat(d[0])||0;a[1]=parseFloat(d[1])||0;if(e.steps){d=100/e.steps;a[0]=Math.ceil(a[0]/d);if(e.isRange){a[1]=Math.ceil(a[1]/d)}}return e.isRange?a.join(":"):(a[0]+"")},_ensureValue:function(d,n){var c=d.properties,m=String(n).split(":"),f=0,j=c.steps?c.steps:100,l=[],g=function(b){return parseFloat(b)||0},e=function(b){return Math.min(j,Math.max(f,b))};l[0]=g(m[0]);if(c.isRange){l[1]=g(m[1]);if(l[0]>l[1]){m=l[1];l[1]=l[0];l[0]=m}}l[0]=e(l[0]);if(c.isRange){l[1]=e(l[1])}return c.isRange?l.join(":"):(l[0]+"")},_v2a:function(d,b){var a=d.properties.steps,c;b=typeof b=="string"?b.split(":"):b;b[0]=parseFloat(b[0])||0;b[1]=parseFloat(b[1])||0;if(a){b[0]=b[0]*100/a}if(a){b[1]=b[1]*100/a}if(b[0]>b[1]){c=b[0];b[1]=b[0];b[0]=c}return b},_auto:function(e,g){var a=e.$xid+":auto";if(xui.Thread.isAlive(a)){return}var b=e.properties,l,d=(b.steps?100/b.steps:1)*(g?1:-1),c={delay:300},f=e.box._v2a(e,b.$UIvalue),j=function(){f[0]+=d;if(b.isRange){f[1]+=d}e.boxing().setUIValue(e.box._adjustValue(e,f),null,null,"auto");c.delay*=0.8};c.task=j;xui.Thread(a,[c],500,null,j,null,true).start()},_onresize:function(e,K,G){var d=e.properties,j=d.type,N=function(f){return e.getSubNode(f)},L=N("KEY"),F=N("RULER"),s=N("IND"),A=N("IND1"),m=e.$px(".75em"),B=N("BOX"),o=N("LABEL"),c=N("INCREASE"),b=N("DECREASE"),J=xui.browser.contentBox,q=xui.$us(e),P=function(f,w){return e.$forceu(f,q>0?"em":"px",w)},M=e.getEmSize()/L._getEmSize(),l=o._getEmSize(M),r=F._getEmSize(M),I=s._getEmSize(M),o=e.getSubNode("LABEL"),H=d.labelPos,n=(H=="none"||!H)?0:e.$px(d.labelSize,l)||0,O=(H=="none"||!H)?0:e.$px(d.labelGap)||0,E,a,Q,g;if(K&&K!="auto"){K=e.$px(K)}if(G&&G!="auto"){G=e.$px(G)}B.cssPos({left:P(E=H=="left"?n:0),top:P(a=H=="top"?n:0)});b.css("display",d.showDecreaseHandle?"":"none");c.css("display",d.showIncreaseHandle?"":"none");if(j=="vertical"){B.cssSize({width:"",height:P(g=G===null?null:Math.max(0,(G-((H=="top"||H=="bottom")?n:0))))});var D=e.$px("1em"),C=d.showIncreaseHandle?D:0,x=d.showDecreaseHandle?D:0,u=xui.browser.contentBox?A._borderH("top"):0;if(g){F.top(P(C+m,r)).height(P(g-C-x-2*m,r));s.top(P(C+m-u,I)).height(P(g-C-x-2*m,I))}if(n){o.cssRegion({left:P(K===null?null:Math.max(0,H=="right"?(B.width()+O):0),l),top:P(G===null?null:Math.max(0,H=="bottom"?(G-n+O):0),l),width:"",height:P(G===null?null:Math.max(0,((H=="top"||H=="bottom")?(n-O):G)),l)})}}else{B.cssSize({width:P(Q=K===null?null:Math.max(0,(K-((H=="left"||H=="right")?n:0)))),height:""});var D=e.$px("1em"),C=d.showDecreaseHandle?D:0,x=d.showIncreaseHandle?D:0,u=!J?0:A._borderW("left");if(Q){F.left(P(C+m,r)).width(P(Q-C-x-2*m,r));s.left(P(C+m-u,I)).width(P(Q-C-x-2*m,I))}if(n){o.cssRegion({left:P(K===null?null:Math.max(0,H=="right"?(K-n+O):0),l),top:P(G===null?null:Math.max(0,H=="bottom"?(B.height()+O):0),l),width:P(K===null?null:Math.max(0,((H=="left"||H=="right")?(n-O):K)),l),height:P(G===null?null:Math.max(0,((H=="top"||H=="bottom")?(n-O):G)),l)})}}}}});xui.Class("xui.UI.Dialog","xui.UI.Widget",{Instance:{setChildren:function(c,b){var a=this;this.removeChildren(true,true,true);xui.addChild({children:c},a,a.getModule(),a.getModule())},showModal:function(b,d,c,e,a){this.show(b,true,d,c,e,a)},show:function(b,c,e,d,f,a){b=b||xui("body");return this.each(function(m){if(m.inShowing){return}var l,o=m.properties,n=xui.$us(m),j=m.boxing();switch(o.initPos){case"auto":if(xui.isHash(e)){d=e.top;e=e.left}else{d=(d||d===0)?d:m.$px(o.top);e=(e||e===0)?e:m.$px(o.left)}break;case"center":if(xui.isHash(e)){d=e.top+(e.height-m.$px(o.height))/2;e=e.left+(e.width-m.$px(o.width))/2}else{var r=b.get(0)==xui("body").get(0)?xui.win:(b["xui.UI"]?b.getRoot():b),q=r==xui.win&&xui.ini.$zoomScale||1;d=(d||d===0)?d:Math.max(0,(r.height()/q-m.$px(o.height))/2+r.scrollTop()/q);e=(e||e===0)?e:Math.max(0,(r.width()/q-m.$px(o.width))/2+r.scrollLeft()/q)}break}if(e<0){e=0}if(d<0){d=0}if(o.status=="max"){e=d=0}var g=function(){b.append(j);var x=m.box,u=m.getRoot(),A=function(B,C){return m.$forceu(B,n>0?"em":"px",C)};if(o.iframeAutoLoad||o.ajaxAutoLoad){xui.UI.Div._applyAutoLoad(m)}if((c||o.modal)&&!m.$inModal){x._modal(m)}j.activate();var w=m._$rs_args,s=function(){if(m.onShow){m.boxing().onShow(m)}delete m.inShowing;delete m.$inThread;xui.tryF(f);if(o&&o.activeAnim){xui.asyRun(function(){if(m&&!m.destroyed){j.setActiveAnim(o.activeAnim,true)}})}};if(o.status=="min"){x._min(m,"normal",s,true)}else{if(o.status=="max"){x._max(m,"normal",s,a)}else{xui.UI.$doResize(m,(w&&w[1])||o.width,(w&&w[2])||o.height);u.show(e||e===0?A(e):null,d||d===0?A(d):null,s,null,a);x._refreshRegion(m)}}};m.inShowing=1;if(l=o.fromRegion){m.$inThread=xui.Dom.animate({border:"solid 1px #555",background:"#888",opacity:0.1},{left:[l.left,e],top:[l.top,d],width:[l.width,m.$px(o.width)],height:[l.height,m.$px(o.height)]},null,g,300,0,"expoIn").start()}else{g()}})},hide:function(a){this.each(function(d){var g=d.properties,e=d.box,f=xui.$us(d),c=d.getRoot();var b=function(){if(d.inHiding){return}d.inHiding=1;if(d.$inModal){e._unModal(d)}if(g.status=="max"||g.status=="min"){var m=g.status;e._restore(d);g.status=m}var l=g.fromRegion,j=function(){delete d.inHiding;delete d.$inThread};if(l){d.$inThread=xui.Dom.animate({border:"solid 1px #555",background:"#888",opacity:0.1},{left:[d.$px(g.left),l.left],top:[d.$px(g.top),l.top],width:[d.$px(g.width),l.width],height:[d.$px(g.height),l.height]},null,j,300,0,"expoOut").start()}else{j()}};c.hide(b,null,a)});return this},close:function(b,a){return this.each(function(e){if(false!==b&&e.beforeClose&&false===e.boxing().beforeClose(e)){return}if(e.inClosing){return}e.inClosing=1;var f=e.properties,d=f.fromRegion,c=function(){e.boxing().destroy(a);delete e.inClosing;delete e.$inThread};if(d){e.$inThread=xui.Dom.animate({border:"solid 1px #555",background:"#888",opacity:0.1},{left:[f.left,d.left],top:[f.top,d.top],width:[f.width,d.width],height:[f.height,d.height]},null,c,300,0,"expoOut").start()}else{c()}})},activate:function(a){var b=this,c=this.get(0),d;c.box._active(c,a);this.getChildren(null,true).each(function(g){if(xui.get(g,["properties","defaultFocus"])){try{xui.asyRun(function(){g.boxing().activate()})}catch(f){}d=1;return false}});xui.asyRun(function(){if(a!==false&&!d){try{c.getSubNode("CAPTION").focus(true)}catch(f){}}if(b.onActivated){b.onActivated(c)}})},isPinned:function(){return !!xui.get(this.get(0),["properties","pinned"])}},Initialize:function(){var b=this,a=b.getTemplate();xui.merge(a.FRAME.BORDER,{tabindex:"{tabindex}",className:"xui-uiborder-outset xui-uiborder-box xui-uiborder-radius-big",TABSTOP1:{$order:-1},TBAR:{tagName:"div",style:"{_displayBar}",className:"xui-uibar-top",TBARTDL:{className:"xui-uibar-tdl xui-uibar xui-uiborder-radius-big-tl",TBARTDLT:{className:"xui-uibar-tdlt"}},TBARTDM:{$order:1,className:"xui-uibar-tdm xui-uibar",TBARTDMT:{className:"xui-uibar-tdmt"}},TBARTDR:{$order:2,className:"xui-uibar-tdr xui-uibar xui-uiborder-radius-big-tr",TBARTDRT:{className:"xui-uibar-tdrt"}},BARCMDL:{$order:3,tagName:"div",className:"xui-uibar-cmdl",style:"{_align}",RULER:{className:"xui-ui-ruler"},LTAGCMDS:{tagName:"span",className:"xui-ltag-cmds",style:"{_ltagDisplay}",text:"{ltagCmds}"},ICON:{$order:2,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{tabindex:"{tabindex}",className:"xui-title-node",text:"{caption}",$order:3}},BARCMDR:{$order:4,tagName:"div",className:"xui-uibar-cmdr",RTAGCMDS:{$order:0,tagName:"span",className:"xui-rtag-cmds",style:"{_rtagDisplay}",text:"{rtagCmds}"},INFO:{className:"xuicon",$fonticon:"xui-uicmd-info",style:"{infoDisplay}",$order:2},OPT:{className:"xuicon",$fonticon:"xui-uicmd-opt",style:"{optDisplay}",$order:3},PIN:{$order:4,className:"xuicon",$fonticon:"xui-uicmd-pin",style:"{pinDisplay}"},LAND:{$order:5,className:"xuicon",$fonticon:"xui-uicmd-land",style:"{landDisplay}"},REFRESH:{className:"xuicon",$fonticon:"xui-uicmd-refresh",style:"{refreshDisplay}",$order:6},MIN:{$order:7,className:"xuicon",$fonticon:"xui-uicmd-min",style:"{minDisplay}"},RESTORE:{$order:8,className:"xuicon",$fonticon:"xui-uicmd-restore",style:"display:none;"},MAX:{$order:9,className:"xuicon",$fonticon:"xui-uicmd-max",style:"{maxDisplay}"},CLOSE:{$order:10,className:"xuicon",$fonticon:"xui-uicmd-close",style:"{closeDisplay}"}},TBARTDB:{$order:5,tagName:"div",className:"xui-uibar-tdb xui-uiborder-inset xui-uiborder-radius"}},MAIN:{$order:2,tagName:"div",className:"xui-uicon-main xui-uibar",MAINI:{tagName:"div",className:"xui-uicon-maini xui-uibar",PANEL:{tagName:"div",style:"{_panelstyle};{_overflow};",className:"xui-uibar xui-uicontainer",text:"{html}"+xui.UI.$childTag}}},BBAR:{$order:3,tagName:"div",className:"xui-uibar-bottom",BBARTDL:{$order:1,className:"xui-uibar-tdl xui-uibar xui-uiborder-radius-big-bl"},BBARTDM:{$order:2,className:"xui-uibar-tdm xui-uibar"},BBARTDR:{$order:3,className:"xui-uibar-tdr xui-uibar xui-uiborder-radius-big-br"}},TABSTOP2:{$order:9}},"all");a.$submap=xui.UI.$getTagCmdsTpl();b.setTemplate(a);xui.alert=b.alert;xui.confirm=b.confirm;xui.pop=b.pop;xui.prompt=b.prompt},Static:{Appearances:{KEY:{overflow:"visible"},"LTAGCMDS, RTAGCMDS":{padding:0,margin:0,"vertical-align":"middle"},"TABSTOP1,TABSTOP2":{height:0,width:"16px",display:"inline",position:"absolute"},"TBART, BBART":{"border-spacing":0,"border-collapse":"separate"},MAINI:{"padding-top":".16667em"},PANEL:{position:"relative",overflow:"auto"},CAPTION:{display:"inline","vertical-align":xui.browser.ie6?"baseline":"middle"},BORDER:{position:"relative",outline:0}},Behaviors:{DroppableKeys:["PANEL"],PanelKeys:["PANEL"],DraggableKeys:["LAND"],NoDraggableKeys:["LAND","MIN","MAX","RESTORE","PIN","INFO","OPT","CLOSE","REFRESH","CMD"],HoverEffected:{LAND:"LAND",MIN:"MIN",MAX:"MAX",RESTORE:"RESTORE",PIN:"PIN",INFO:"INFO",OPT:"OPT",CLOSE:"CLOSE",REFRESH:"REFRESH",CMD:"CMD",ICON:"ICON"},ClickEffected:{LAND:"LAND",MIN:"MIN",MAX:"MAX",RESTORE:"RESTORE",PIN:"PIN",INFO:"INFO",OPT:"OPT",CLOSE:"CLOSE",REFRESH:"REFRESH",CMD:"CMD",ICON:"ICON"},onMousedown:function(a,b){if(!a.$inModal){a.box._active(a)}},afterKeydown:function(f,j){var g=xui.Event.getKey(j);if((j.$key||j.keyCode||j.charCode)==9){if(xui.browser.ie){var l="xui::_specialforietab";if(!xui.Dom.byId(l)){xui("body").append("<div style='display:none;position:absolute;' id="+l+"></div>")}xui.Dom.byId(l).innerHTML=xui.stamp()+""}var d=f.getSubNode("TABSTOP1").get(0),c=f.getSubNode("TABSTOP2").get(0),a=xui.Event.getSrc(j),b;if(g.shiftKey){if(a!==d){d.tabIndex=a.tabIndex}c.removeAttribute("tabIndex")}else{if(a!==c){c.tabIndex=a.tabIndex}d.removeAttribute("tabIndex")}d=c=a=null}},onDragstop:function(d){var f=d.properties,e=xui.$us(d),b=d.getRoot(),g=b.cssPos(),a=null,c=null;if(d.$px(f.left)!==g.left){f.left=a=d.$forceu(g.left,null)}if(d.$px(f.top)!==g.top){f.top=c=d.$forceu(g.top,null)}b.cssPos({left:a,top:c});if(d.onMove&&(a!==null||c!==null)){d.boxing().onMove(d,a,c,null,null)}},TABSTOP1:{onFocus:function(f,q,a){var j=parseInt(xui.use(a).get(0).tabIndex||1+"",10)-1;var c=f.getRoot().get(0).getElementsByTagName("*"),r,d;for(var m=0,g=c.length,b;b=c[m];m++){if(b.nodeType==1){if(b.tabIndex&&b.tabIndex<=j){if(!r){r=(d=b).tabIndex}if(b.tabIndex>r){r=(d=b).tabIndex}if(r===j){break}}}}if(b){xui(b).focus(true);xui.use(a).get(0).tabIndex=b.tabIndex}else{b=f.getRoot().nextFocus(false,true,false);xui(b).focus(true);xui.use(a).get(0).tabIndex=b.get(0).tabIndex}c=b=null}},TABSTOP2:{onFocus:function(f,q,a){var j=parseInt(xui.use(a).get(0).tabIndex||1+"")+1;var c=f.getRoot().get(0).getElementsByTagName("*"),r,d;for(var m=0,g=c.length,b;b=c[m];m++){if(b.nodeType==1){if(b.tabIndex&&b.tabIndex>=j){if(!r){r=(d=b).tabIndex}if(b.tabIndex<r){r=(d=b).tabIndex}if(r===j){break}}}}if(b){xui(b).focus(true);xui.use(a).get(0).tabIndex=b.tabIndex}else{b=f.getRoot().nextFocus(true,true,false);xui(b).focus(true);xui.use(a).get(0).tabIndex=b.get(0).tabIndex}c=b=null}},TBAR:{beforeMousedown:function(c,f,j){if(c.$inDesign){return}if(xui.Event.getBtn(f)!="left"){return}if(c.getKey(xui.Event.getSrc(f).parentNode.id)==c.keys.BARCMDR){return}if(c.properties.status=="max"){return false}if(c.properties.movable&&!c._locked){c.box._active(c);var a=c.getRoot(),d=a.cssRegion(),b=a.parent().cssRegion(),g=c.getEmSize();a.startDrag(f,{dragDefer:2,maxLeftOffset:d.left,maxRightOffset:b.width-d.left-g,maxTopOffset:d.top,maxBottomOffset:b.height-d.top-g,magneticDistance:g,xMagneticLines:[0,b.width-d.width],yMagneticLines:[0,b.height-d.height],targetOffsetParent:a.parent()})}},onDblclick:function(a,b,c){if(a.getKey(xui.Event.getSrc(b).parentNode.id)==a.keys.BARCMDR){return}if(!a.properties.maxBtn){return}if(a.properties.status=="max"){a.box._restore(a)}else{a.box._max(a)}}},PIN:{onClick:function(d,f,g){var c=d.keys.PIN,b=d.properties,a=d.boxing();if(d.beforePin&&false===d.boxing().beforePin(d,b.pinned)){return}b.pinned=!b.pinned;d.getSubNode("PIN").tagClass("-checked",b.pinned);d._locked=b.pinned;if(b.resizer){if(!b.pinned){if(b.status!="min"){a._resizer()}}else{if(d.$resizer){a._unResizer()}}}}},MIN:{onClick:function(a,b,c){a.box._min(a,null,null,true)}},MAX:{onClick:function(a,b,c){a.box._max(a,null,null,true)}},RESTORE:{onClick:function(a,b,c){a.box._restore(a)}},LAND:{onClick:function(a,b,c){a.boxing().onLand(a,b,c)}},PANEL:{onClick:function(a,c,d){var b=a.properties;if(b.disabled){return false}if(a.onClickPanel){return a.boxing().onClickPanel(a,c,d)}}},INFO:{onClick:function(a,b,c){a.boxing().onShowInfo(a,b,c)}},OPT:{onClick:function(a,b,c){a.boxing().onShowOptions(a,b,c)}},REFRESH:{onClick:function(a,b,c){a.boxing().onRefresh(a)}},CLOSE:{onClick:function(a,b,c){a.boxing().close()}},CMD:{onClick:function(a,b,c){var d=a.properties;if(d.disabled){return false}if(a.onCmd){a.boxing().onCmd(a,xui.use(c).id().split("_")[1],b,c)}return false}}},DataModel:{rotate:null,selectable:true,tips:null,border:null,disabled:null,dock:"none",showEffects:"Classic",hideEffects:"",initPos:{ini:"center",listbox:["auto","center"]},iframeAutoLoad:{ini:"",action:function(){xui.UI.Div._applyAutoLoad(this)}},ajaxAutoLoad:{ini:"",action:function(){xui.UI.Div._applyAutoLoad(this)}},html:{html:1,action:function(a,b,c){this.getSubNode("PANEL").html(xui.adjustRes(a,0,1),null,null,c)}},caption:{ini:undefined,action:function(a){a=(xui.isSet(a)?a:"")+"";this.getSubNode("CAPTION").html(xui.adjustRes(a,true))}},image:{format:"image",action:function(a){xui.UI.$iconAction(this)}},imagePos:{action:function(a){this.getSubNode("ICON").css("backgroundPosition",a||"center")}},imageBgSize:{action:function(a){this.getSubNode("ICON").css("backgroundSize",a||"")}},imageClass:{ini:"",action:function(a,b){xui.UI.$iconAction(this,"ICON",b)}},iconFontCode:{action:function(a){xui.UI.$iconAction(this)}},shadow:true,resizer:true,movable:true,displayBar:{ini:true,action:function(a){var b=this.getSubNode("TBAR");if(a){b.css("display","")}else{b.css("display","none")}}},minBtn:{ini:true,action:function(a){var b=this.getSubNode("MIN");if(a){b.setInlineBlock()}else{b.css("display","none")}}},maxBtn:{ini:true,action:function(a){var b=this.getSubNode("MAX");if(a){b.setInlineBlock()}else{b.css("display","none")}}},restoreBtn:{ini:true,action:function(a){var b=this.getSubNode("RESTORE");if(a){b.setInlineBlock()}else{b.css("display","none")}}},infoBtn:{ini:false,action:function(a){this.getSubNode("INFO").css("display",a?"":"none")}},optBtn:{ini:false,action:function(a){this.getSubNode("OPT").css("display",a?"":"none")}},closeBtn:{ini:true,action:function(a){var b=this.getSubNode("CLOSE");if(a){b.setInlineBlock()}else{b.css("display","none")}}},refreshBtn:{ini:false,action:function(a){this.getSubNode("REFRESH").css("display",a?"":"none")}},pinBtn:{ini:false,action:function(a){var b=this.getSubNode("PIN");if(a){b.setInlineBlock()}else{b.css("display","none")}}},landBtn:{ini:false,action:function(a){var b=this.getSubNode("LAND");if(a){b.setInlineBlock()}else{b.css("display","none")}}},width:{$spaceunit:1,ini:"25em"},height:{$spaceunit:1,ini:"25em"},minWidth:200,minHeight:100,position:"absolute",fromRegion:{hidden:true,ini:null},modal:{ini:false,action:function(a){if(this.box){if(a){this.box._modal(this)}else{this.box._unModal(this)}}}},status:{ini:"normal",listbox:["normal","min","max"],action:function(d,e){var c=this,a=c.box;if(d=="min"){a._min(c,e,null,true)}else{if(d=="max"){a._max(c,e,null,true)}else{a._restore(c,e)}}}},hAlign:{ini:"left",listbox:["left","center","right"],action:function(a){this.getSubNode("BARCMDL").css("textAlign",a)}},tagCmds:{ini:[],action:function(){this.boxing().refresh()}},$hborder:1,$vborder:1},EventHandlers:{onIniPanelView:function(a){},onShow:function(a){},onActivated:function(a){},beforePin:function(a,b){},beforeStatusChanged:function(c,a,b){},afterStatusChanged:function(c,a,b){},onClickPanel:function(a,b,c){},onLand:function(a,b,c){},beforeClose:function(a){},onShowInfo:function(a,b,c){},onShowOptions:function(a,b,c){},onRefresh:function(a){},onCmd:function(a,c,b,d){}},RenderTrigger:function(){var a=this;a.destroyTrigger=function(){var b=this;if(b.$inModal){b.box._unModal(b)}}},LayoutTrigger:function(){var c=this,d=c.properties;if(d.modal){var e=c.$modalDiv&&c.$modalDiv.parent(),a=c.box;if(e&&e.get(0)&&e.get(0)!==c.getRootNode()){a._unModal(c)}a._modal(c)}},_prepareData:function(c){var d=arguments.callee.upper.call(this,c),b="display:none";d._displayBar=d.displayBar?"":b;d.minDisplay=d.minBtn?"":b;d.maxDisplay=d.maxBtn?"":b;d.infoDisplay=d.infoBtn?"":b;d.optDisplay=d.optBtn?"":b;d.closeDisplay=d.closeBtn?"":b;d.pinDisplay=d.pinBtn?"":b;d.landDisplay=d.landBtn?"":b;d.refreshDisplay=d.refreshBtn?"":b;d._align="text-align:"+d.hAlign+";";var a=c.properties.status;if(a=="min"||a=="max"){c.$noR=1}if(xui.isStr(d.overflow)){d._overflow=d.overflow.indexOf(":")!=-1?(d.overflow):(d.overflow?("overflow:"+d.overflow):"")}if(!xui.isEmpty(d.tagCmds)){this._prepareCmds(c,d)}return d},_min:function(d,f,r,e){var c=d.getRoot(),j=d.box,b=c.parent(),l=d.boxing(),s=d.properties,q=xui.Dom._getEffects(s.showEffects,1);if(d.$inThread){d.$inThread.abort()}if(!f){f=s.status}if(d.beforeStatusChanged&&false===d.boxing().beforeStatusChanged(d,"min",f)){return}if(f=="max"){j._unMax(d)}else{j._refreshRegion(d)}d.getSubNodes(["PANEL","BBAR"]).css("display","none");if(s.minBtn){if(s.restoreBtn){d.getSubNode("RESTORE").setInlineBlock()}d.getSubNode("MIN").css("display","none")}if(s.resizer&&d.$resizer){l._unResizer()}s.status="min";var n=c.height(),m=d.getSubNode("BORDER").height(),g=d.getSubNode("TBAR").height();c.cssSize({width:s.minWidth,height:g+n-m},true);if(d.afterStatusChanged){d.boxing().afterStatusChanged(d,"min",f)}if(q&&xui.browser.ie678){xui.filter(q.params,function(u,a){return !!xui.Dom._cssfake[a]})}c.show(null,null,r,null,e)},_max:function(d,f,m,e){var c=d.getRoot(),g=d.box,j=d.boxing(),b=c.parent(),n=d.properties,l=xui.Dom._getEffects(n.showEffects,1);if(!f){f=n.status}if(d.$inThread){d.$inThread.abort()}if(d.beforeStatusChanged&&false===d.boxing().beforeStatusChanged(d,"max",f)){return}if(f=="min"){g._unMin(d)}else{g._refreshRegion(d)}if(n.pinBtn){d.getSubNode("PIN").css("display","none")}if(n.maxBtn){d.getSubNode("MAX").css("display","none");if(n.restoreBtn){d.getSubNode("RESTORE").setInlineBlock()}}if(n.resizer&&d.$resizer){j._unResizer()}n.status="max";j.setDock("cover",true);if(d.afterStatusChanged){d.boxing().afterStatusChanged(d,"max",f)}if(l&&xui.browser.ie678){xui.filter(l.params,function(q,a){return !!xui.Dom._cssfake[a]})}c.show(null,null,m,null,e)},_restore:function(c,a){var e=c.getRoot(),d=c.box,b=c.properties;if(!a){a=b.status}b.status="normal";if(c.beforeStatusChanged&&false===c.boxing().beforeStatusChanged(c,"normal",a)){return}if(a=="max"){d._unMax(c)}if(a=="min"){d._unMin(c)}c.getSubNode("BORDER").ieRemedy();c.getSubNode("RESTORE").css("display","none")},_unMax:function(c){var b=c.properties,a=c.boxing();c.getSubNode("MAX").setInlineBlock();if(b.pinBtn){c.getSubNode("PIN").setInlineBlock()}if(b.resizer&&!b.pinned){a._resizer()}a.setDock("none");c.adjustSize(true);if(c.afterStatusChanged){c.boxing().afterStatusChanged(c,"normal",status)}},_unMin:function(c){var b=c.properties,a=c.boxing();c.getSubNodes(["PANEL","BBAR"]).css("display","block");c.getSubNode("MIN").setInlineBlock();if(b.resizer&&!b.pinned){a._resizer()}c.getRoot().cssSize({width:b.width,height:b.height});c.adjustSize(true)},_active:function(d,a){var b=this;if(d.$inDesign){return}if(a!==false&&xui.$cache.unique.activeWndId==d.$xid){return}b._deActive();if(a!==false){var f=xui(d.domId),e=f.topZindex(),c=parseInt(f.css("zIndex"),0);f.css("zIndex",e>c?e:c);d.getSubNode("TBAR").tagClass("-focus");xui.$cache.unique.activeWndId=d.$xid}},_deActive:function(){var a;if(a=xui.UI._cache["$"+xui.$cache.unique.activeWndId]){a.getSubNode("TBAR").tagClass("-focus",false)}delete xui.$cache.unique.activeWndId},_modal:function(d){var c=d.getRoot(),a,f=c.parent(),e;if(!f.isEmpty()){if(!d.$inModal){e=d.$modalDiv;if(!e||!e.get(0)||!e.get(0).parentNode){e=d.$modalDiv=xui.create("<div class='xui-cover xui-custom xui-cover-modal' style='left:0;top:0;position:absolute;overflow:hidden;display:block;z-index:0;'></div>");e.setSelectable(false)}f.append(e);if(f.get(0)===document.body||f.get(0)===document||f.get(0)===window){f=xui.win}e.css({display:"block",width:Math.max(f.width(),f.scrollWidth())+"px",height:Math.max(f.height(),f.scrollHeight())+"px"}).onMousedown(function(){return d.$inDesign?null:false}).topZindex(true);if(d.$inDesign){e.onClick(function(){c.onClick(true)})}f.onSize(function(l){l=xui(l);var g=l.width()+"px",j=l.height()+"px";e.css({width:g,height:j});xui.asyRun(function(){var m=Math.max(l.width(),l.scrollWidth())+"px",n=Math.max(l.height(),l.scrollHeight())+"px";e.css({width:m,height:n})})},"dialog:"+d.serialId);var b=(parseInt(e.css("zIndex"),10)||0)+1;c.css("zIndex",b);if(b>=xui.Dom.TOP_ZINDEX){xui.Dom.TOP_ZINDEX=b+1}d.$inModal=true;f.setBlurTrigger(d.$xid+"_anti",true,xui([e.get(0),d.getRootNode()]))}}},_unModal:function(a){if(a.$inModal){var c=a.$modalDiv.parent();if(c.get(0)===document.body||c.get(0)===document||c.get(0)===window){c=xui.win}c.onSize(null,"dialog:"+a.serialId);a.getRoot().css("zIndex",0);a.$modalDiv.css("display","none");var b=a.getSubNode("BORDER");if(!b.isEmpty()){b.append(a.$modalDiv)}a.$inModal=false;c.setBlurTrigger(a.$xid+"_anti")}},_refreshRegion:function(b){if(!b.renderId){return}var f=b.properties,a=b.getRoot(),d=xui.$us(b),e=function(g,j){return b.$forceu(g,d>0?"em":"px",j)},c=a.cssRegion();c.left=e(c.left);c.top=e(c.top);c.width=e(c.width);c.height=e(c.height);return xui.merge(f,c,function(j,g){return f[g]!="auto"})},_adjust:function(g,q,f,o,a,m){q=xui.adjustRes(q||"");if(!xui.isSet(f)||f===""){f=q;q=o||""}var b=g.$div.reBoxing(),j="xui:temp:dialog",l=arguments.callee,n,c;if(!xui.Dom.byId(j)){e=l._cache=b.clone(false);xui("body").append(e);e.css({overflow:"visible",position:"absolute",visibility:"visible",left:xui.Dom.HIDE_VALUE,top:xui.Dom.HIDE_VALUE}).id(j,true)}var e=l._cache;e.width("auto").height("auto");e.html(f,false);var r=e.cssSize();r.width+=10;r.height+=10;b.html(f);if(r.width>500){r.width=500;e.width(500);r.height=e.offsetHeight()+10;e.width("auto")}e.html("",false);r.height+=10;if(r.height>400){r.height=400}if(r.width<150){r.width=150}if(r.height<30){r.height=30}b.cssSize(r).css("overflow","auto").show();var d=g.getRoot()._getEmSize();n=r.width+d*2;c=r.height+d*7.5;g.setCaption(q).setWidth(n).setHeight(c);return{width:n,height:c}},alert:function(q,j,o,f,e,n,r,a,g){var m=arguments.callee,l;if(g||!(l=m.dialog)||!l.get(0)||(!l.get(0).renderId)){l=new xui.UI.Dialog({overflow:"hidden",minBtn:false,maxBtn:false,pinBtn:false,resizer:false},{beforeClose:function(){xui.tryF(l._$onClose);l._$onClose=null;if(!g){l.hide();return false}},onHotKeydown:function(w,u){if(u.key=="esc"){l.close()}}});var d=l.$cmd=new xui.UI.Div({height:"2.5em",dock:"bottom",zIndex:10},null,null,null,{KEY:"text-align:center;padding-top:.5em"}),c=l.$btn=new xui.UI.SButton({position:"relative",tabindex:1},{onClick:function(){l.close()},onHotKeydown:function(w,u){if(u.key=="enter"){l.close()}}},null,null,{KEY:"margin:0 .5em"});d.append(c);var b=l.$div=new xui.UI.Div({left:10,top:10});l.append(d).append(b).render();if(!g){m.dialog=l}}l._$onClose=o;l.$btn.setCaption("&nbsp;&nbsp;"+(f||xui.wrapRes("$inline.ok"))+"&nbsp;&nbsp;");var s=xui.UI.Dialog._adjust(l,q,j,"Alert");if(r&&r["xui.UI"]){r=r.getContainer(a)}if(!xui.isSet(r)){r=xui("body")}l.show(r,true,e,n);xui.resetRun("dlg_focus:"+l.get(0).$xid,function(){l.$btn.activate()});return l},confirm:function(o,s,r,w,j,d,f,n,q,a,g){var m=arguments.callee,l;if(g||!(l=m.dialog)||!l.get(0)||(!l.get(0).renderId)){l=new xui.UI.Dialog({overflow:"hidden",minBtn:false,maxBtn:false,pinBtn:false,resizer:false},{beforeClose:function(){if(!l._$_clicked){xui.tryF(l._$onNo,["close"])}else{delete l._$_clicked}l._$onYes=l._$onNo=null;if(!g){l.hide();return false}},onHotKeydown:function(A,x){if(x.key=="esc"){l.close()}}});var e=l.$cmd=new xui.UI.Div({height:"2.5em",dock:"bottom",zIndex:10},null,null,null,{KEY:"text-align:center;padding-top:.5em"}),c=l.$btn1=new xui.UI.SButton({tabindex:1,position:"relative"},{onClick:function(){xui.tryF(l._$onYes,["yes"]);l._$_clicked=1;l.close()}},null,null,{KEY:"margin:0 .5em"});e.append(c);c=l.$btn2=new xui.UI.SButton({tabindex:1,position:"relative"},{onClick:function(){xui.tryF(l._$onNo,["no"]);l._$_clicked=1;l.close()}},null,null,{KEY:"margin:0 .5em"});e.append(c);var b=l.$div=new xui.UI.Div({left:10,top:10});l.append(e).append(b).render();if(!g){m.dialog=l}}l._$onYes=r;l._$onNo=w;delete l._$_clicked;l.$btn1.setCaption("&nbsp;&nbsp;"+(j||xui.wrapRes("$inline.yes"))+"&nbsp;&nbsp;");l.$btn2.setCaption("&nbsp;&nbsp;"+(d||xui.wrapRes("$inline.no"))+"&nbsp;&nbsp;");var u=xui.UI.Dialog._adjust(l,o,s,"Confirm");if(q&&q["xui.UI"]){q=q.getContainer(a)}if(!xui.isSet(q)){q=xui("body")}l.show(q,true,f,n);xui.resetRun("dlg_focus:"+l.get(0).$xid,function(){l.$btn2.activate()});return l},pop:function(l,f,e,d,j,m,a){var g=new xui.UI.Dialog({overflow:"hidden",minBtn:false,maxBtn:false,pinBtn:false,resizer:false},{onHotKeydown:function(q,o){if(o.key=="esc"){g.close()}}}),c=g.$cmd=new xui.UI.Div({height:"2.5em",dock:"bottom",zIndex:10},null,null,null,{KEY:"text-align:center;padding-top:.5em"}).append(g.$btn=new xui.UI.SButton({caption:"&nbsp;&nbsp;"+(e||"$inline.ok")+"&nbsp;&nbsp;",tabindex:1,position:"relative"},{onClick:function(){g.destroy()},onHotKeydown:function(q,o){if(o.key=="enter"){g.close()}}},null,null,{KEY:"margin:0 .5em"})),b=g.$div=new xui.UI.Div({left:10,top:10,width:"7em"}).setCustomStyle({KEY:"overflow:visible"});g.append(c).append(b).render();var n=xui.UI.Dialog._adjust(g,l,f,"Message");if(m&&m["xui.UI"]){m=m.getContainer(a)}if(!xui.isSet(m)){m=xui("body")}g.show(m,false,d,j);xui.resetRun("dlg_focus:"+g.get(0).$xid,function(){g.$btn.activate()});return g},prompt:function(q,u,j,s,w,g,c,e,o,r,a,f){var l,n=arguments.callee;if(f||!(l=n.dialog)||!l.get(0)||(!l.get(0).renderId)){l=new xui.UI.Dialog({overflow:"hidden",minBtn:false,maxBtn:false,pinBtn:false,left:e||200,top:o||200,width:"25em",height:"11em",conDockPadding:{left:".5em",right:".5em",top:0,bottom:0}},{beforeClose:function(){if(!l._$_clickYes){xui.tryF(l._$onNo,["no"])}else{delete l._$_clickYes}l._$input.setValue("",false,"prompt");l._$onYes=l._$onNo=null;if(!f){l.hide();return false}}});var b=l._$caption=new xui.UI.Div({height:"1.5em",dock:"top"}),d=new xui.UI.Div({height:"2.5em",dock:"bottom",zIndex:10},null,null,null,{KEY:"text-align:center;padding-top:.5em"}).append(l.$btn1=new xui.UI.SButton({position:"relative",tabindex:1},{onClick:function(){if(false!==xui.tryF(l._$onYes,[l._$input.getUIValue()])){l._$_clickYes=1;l.close()}}},null,null,{KEY:"margin:0 .5em"}));d.append(l.$btn2=new xui.UI.SButton({tabindex:1,position:"relative"},{onClick:function(){l.close()}},null,null,{KEY:"margin:0 .5em"}));var m=l._$input=new xui.UI.Input({dock:"fill",multiLines:true});l.append(b).append(d).append(m).render();if(!f){n.dialog=l}}l.setCaption(q||"Prompt");l._$caption.setHtml(u||"");l._$input.setValue(j||"",true,"prompt");l._$onYes=s;l._$onNo=w;delete l._$_clickYes;l.$btn1.setCaption("&nbsp;&nbsp;"+(g||xui.wrapRes("$inline.ok"))+"&nbsp;&nbsp;");l.$btn2.setCaption("&nbsp;&nbsp;"+(c||xui.wrapRes("$inline.cancel"))+"&nbsp;&nbsp;");if(r&&r["xui.UI"]){r=r.getContainer(a)}if(!xui.isSet(r)){r=xui("body")}l.show(r,true,e,o);xui.resetRun("dlg_focus:"+l.get(0).$xid,function(){l._$input.activate()});return l},_onresize:function(n,A,x,f){if(A&&n.properties.status=="min"){A=n.properties.minWidth}var m=n.properties,s=xui.$us(n),B=function(C,D){return n.$forceu(C,s>0?"em":"px",D)},w=arguments.callee.upper.apply(this,arguments),r={},l=n.getSubNode("BORDER"),j=n.getSubNode("TBAR"),g=n.getSubNode("PANEL"),c=n.getSubNode("BBAR"),b=n.getSubNode("MAIN"),a=n.getSubNode("MAINI"),e=l.contentBox(),d=g.contentBox(),q,o,u;if(A){A=n.$px(A)}if(x){x=n.$px(x)}if(w.left){w.left=n.$px(w.left)}if(w.top){w.top=n.$px(w.top)}if(w.width){w.width=n.$px(w.width)}if(w.height){w.height=n.$px(w.height)}if(x){if(x=="auto"){r.height=x}else{q=j.offsetHeight(true);o=c.offsetHeight(true);if((u=w.height-q-o)>0){r.height=u}}}if(x){r.height=r.height-a._paddingH()-(e?0:l._borderH())-(d?0:g._borderH())}if(A){r.width=w.width-(parseFloat(a.css("paddingRight"))||0)-(parseFloat(a.css("borderRightWidth"))||0)-(parseFloat(b.css("paddingLeft"))||0)-(parseFloat(b.css("borderLeftWidth"))||0)}-(e?0:l._borderW())-(d?0:g._borderW());if(A&&s>0){r.width=B(r.width)}if(x&&s>0){r.height=B(r.height)}g.cssSize(r,true);if(A){xui.UI._adjustConW(n,g,r.width)}}}});xui.Class("xui.UI.MDialog","xui.UI.Widget",{Instance:{setChildren:function(c,b){var a=this;this.removeChildren(true,true,true);xui.addChild({children:c},a,a.getModule(),a.getModule())},showModal:function(b,d,c,e,a){this.show(b,true,d,c,e,a)},show:function(b,c,e,d,f,a){b=b||xui("body");return this.each(function(m){if(m.inShowing){return}var l,o=m.properties,n=xui.$us(m),j=m.boxing();switch(o.initPos){case"auto":if(xui.isHash(e)){d=e.top;e=e.left}else{d=(d||d===0)?d:m.$px(o.top);e=(e||e===0)?e:m.$px(o.left)}break;case"center":if(xui.isHash(e)){d=e.top+(e.height-m.$px(o.height))/2;e=e.left+(e.width-m.$px(o.width))/2}else{var r=b.get(0)==xui("body").get(0)?xui.win:(b["xui.UI"]?b.getRoot():b),q=r==xui.win&&xui.ini.$zoomScale||1;d=(d||d===0)?d:Math.max(0,(r.height()/q-m.$px(o.height))/2+r.scrollTop()/q);e=(e||e===0)?e:Math.max(0,(r.width()/q-m.$px(o.width))/2+r.scrollLeft()/q)}break}if(e<0){e=0}if(d<0){d=0}if(o.status=="max"){e=d=0}if(o.status=="left"){e=d=0}if(o.status=="right"){d=0;e=Math.max(0,(r.width()/q-m.$px(o.width))+r.scrollLeft()/q)}var g=function(){b.append(j);var x=m.box,u=m.getRoot(),A=function(B,C){return m.$forceu(B,n>0?"em":"px",C)};if(o.iframeAutoLoad||o.ajaxAutoLoad){xui.UI.Div._applyAutoLoad(m)}if((c||o.modal)&&!m.$inModal){x._modal(m)}j.activate();var w=m._$rs_args,s=function(){if(m.onShow){m.boxing().onShow(m)}delete m.inShowing;delete m.$inThread;xui.tryF(f);if(o&&o.activeAnim){xui.asyRun(function(){if(m&&!m.destroyed){j.setActiveAnim(o.activeAnim,true)}})}};if(o.status=="min"){x._min(m,"normal",s,true)}else{if(o.status=="max"){x._max(m,"normal",s,a)}else{xui.UI.$doResize(m,(w&&w[1])||o.width,(w&&w[2])||o.height);u.show(e||e===0?A(e):null,d||d===0?A(d):null,s,null,a);x._refreshRegion(m)}}};m.inShowing=1;if(l=o.fromRegion){m.$inThread=xui.Dom.animate({border:"solid 1px #555",background:"#888",opacity:0.1},{left:[l.left,e],top:[l.top,d],width:[l.width,m.$px(o.width)],height:[l.height,m.$px(o.height)]},null,g,300,0,"expoIn").start()}else{g()}})},hide:function(a){this.each(function(d){var g=d.properties,e=d.box,f=xui.$us(d),c=d.getRoot();var b=function(){if(d.inHiding){return}d.inHiding=1;if(d.$inModal){e._unModal(d)}if(g.status=="max"||g.status=="min"||status=="left"||status=="right"){var m=g.status;e._restore(d);g.status=m}var l=g.fromRegion,j=function(){delete d.inHiding;delete d.$inThread};if(l){d.$inThread=xui.Dom.animate({border:"solid 1px #555",background:"#888",opacity:0.1},{left:[d.$px(g.left),l.left],top:[d.$px(g.top),l.top],width:[d.$px(g.width),l.width],height:[d.$px(g.height),l.height]},null,j,300,0,"expoOut").start()}else{j()}};c.hide(b,null,a)});return this},close:function(b,a){return this.each(function(e){if(false!==b&&e.beforeClose&&false===e.boxing().beforeClose(e)){return}if(e.inClosing){return}e.inClosing=1;var f=e.properties,d=f.fromRegion,c=function(){e.boxing().destroy(a);delete e.inClosing;delete e.$inThread};if(d){e.$inThread=xui.Dom.animate({border:"solid 1px #555",background:"#888",opacity:0.1},{left:[f.left,d.left],top:[f.top,d.top],width:[f.width,d.width],height:[f.height,d.height]},null,c,300,0,"expoOut").start()}else{c()}})},activate:function(a){var b=this,c=this.get(0),d;c.box._active(c,a);this.getChildren(null,true).each(function(g){if(xui.get(g,["properties","defaultFocus"])){try{xui.asyRun(function(){g.boxing().activate()})}catch(f){}d=1;return false}});xui.asyRun(function(){if(a!==false&&!d){try{c.getSubNode("CAPTION").focus(true)}catch(f){}}if(b.onActivated){b.onActivated(c)}})},isPinned:function(){return !!xui.get(this.get(0),["properties","pinned"])}},Initialize:function(){var b=this,a=b.getTemplate();xui.merge(a.FRAME.BORDER,{tabindex:"{tabindex}",className:"xui-uiborder-outset xui-uiborder-box xui-uiborder-radius-big",TABSTOP1:{$order:-1},TBAR:{tagName:"div",style:"{_displayBar}",className:"xui-uibar-top",TBARTDL:{className:"xui-uibar-tdl xui-uibar xui-uiborder-radius-big-tl",TBARTDLT:{className:"xui-uibar-tdlt"}},TBARTDM:{$order:1,className:"xui-uibar-tdm xui-uibar",TBARTDMT:{className:"xui-uibar-tdmt"}},TBARTDR:{$order:2,className:"xui-uibar-tdr xui-uibar xui-uiborder-radius-big-tr",TBARTDRT:{className:"xui-uibar-tdrt"}},BARCMDL:{$order:3,tagName:"div",className:"xui-uibar-cmdl",style:"{_align}",RULER:{className:"xui-ui-ruler"},LTAGCMDS:{tagName:"span",className:"xui-ltag-cmds",style:"{_ltagDisplay}",text:"{ltagCmds}"},ICON:{$order:2,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{tabindex:"{tabindex}",className:"xui-title-node",text:"{caption}",$order:3}},BARCMDR:{$order:4,tagName:"div",className:"xui-uibar-cmdr",RTAGCMDS:{$order:0,tagName:"span",className:"xui-rtag-cmds",style:"{_rtagDisplay}",text:"{rtagCmds}"},INFO:{className:"xuicon",$fonticon:"xui-uicmd-info",style:"{infoDisplay}",$order:2},OPT:{className:"xuicon",$fonticon:"xui-uicmd-opt",style:"{optDisplay}",$order:3},PIN:{$order:4,className:"xuicon",$fonticon:"xui-uicmd-pin",style:"{pinDisplay}"},LAND:{$order:5,className:"xuicon",$fonticon:"xui-uicmd-land",style:"{landDisplay}"},REFRESH:{className:"xuicon",$fonticon:"xui-uicmd-refresh",style:"{refreshDisplay}",$order:6},MIN:{$order:7,className:"xuicon",$fonticon:"xui-uicmd-min",style:"{minDisplay}"},RESTORE:{$order:8,className:"xuicon",$fonticon:"xui-uicmd-restore",style:"display:none;"},MAX:{$order:9,className:"xuicon",$fonticon:"xui-uicmd-max",style:"{maxDisplay}"},CLOSE:{$order:10,className:"xuicon",$fonticon:"xui-uicmd-close",style:"{closeDisplay}"}},TBARTDB:{$order:5,tagName:"div",className:"xui-uibar-tdb xui-uiborder-inset xui-uiborder-radius"}},MAIN:{$order:2,tagName:"div",className:"xui-uicon-main xui-uibar",MAINI:{tagName:"div",className:"xui-uicon-maini xui-uibar",PANEL:{tagName:"div",style:"{_panelstyle};{_overflow};",className:"xui-uibar xui-uicontainer",text:"{html}"+xui.UI.$childTag}}},BBAR:{$order:3,tagName:"div",style:"{_displayBar}",className:"xui-uibar-bottom",BBARTDL:{$order:1,className:"xui-uibar-tdl xui-uibar xui-uiborder-radius-big-bl"},BBARTDM:{$order:2,className:"xui-uibar-tdm xui-uibar"},BBARTDR:{$order:3,className:"xui-uibar-tdr xui-uibar xui-uiborder-radius-big-br"}},TABSTOP2:{$order:9}},"all");a.$submap=xui.UI.$getTagCmdsTpl();b.setTemplate(a);xui.alert=b.alert;xui.confirm=b.confirm;xui.pop=b.pop;xui.prompt=b.prompt},Static:{Appearances:{KEY:{overflow:"visible"},"LTAGCMDS, RTAGCMDS":{padding:0,margin:0,"vertical-align":"middle"},"TABSTOP1,TABSTOP2":{height:0,width:"16px",display:"inline",position:"absolute"},"TBART, BBART":{"border-spacing":0,"border-collapse":"separate"},MAINI:{"padding-top":".16667em"},PANEL:{position:"relative",overflow:"auto"},CAPTION:{display:"inline","vertical-align":xui.browser.ie6?"baseline":"middle"},BORDER:{position:"relative",outline:0}},Behaviors:{DroppableKeys:["PANEL"],PanelKeys:["PANEL"],DraggableKeys:["LAND"],NoDraggableKeys:["LAND","MIN","MAX","RESTORE","PIN","INFO","OPT","CLOSE","REFRESH","CMD"],HoverEffected:{LAND:"LAND",MIN:"MIN",MAX:"MAX",RESTORE:"RESTORE",PIN:"PIN",INFO:"INFO",OPT:"OPT",CLOSE:"CLOSE",REFRESH:"REFRESH",CMD:"CMD",ICON:"ICON"},ClickEffected:{LAND:"LAND",MIN:"MIN",MAX:"MAX",RESTORE:"RESTORE",PIN:"PIN",INFO:"INFO",OPT:"OPT",CLOSE:"CLOSE",REFRESH:"REFRESH",CMD:"CMD",ICON:"ICON"},onMousedown:function(a,b){if(!a.$inModal){a.box._active(a)}},afterKeydown:function(f,j){var g=xui.Event.getKey(j);if((j.$key||j.keyCode||j.charCode)==9){if(xui.browser.ie){var l="xui::_specialforietab";if(!xui.Dom.byId(l)){xui("body").append("<div style='display:none;position:absolute;' id="+l+"></div>")}xui.Dom.byId(l).innerHTML=xui.stamp()+""}var d=f.getSubNode("TABSTOP1").get(0),c=f.getSubNode("TABSTOP2").get(0),a=xui.Event.getSrc(j),b;if(g.shiftKey){if(a!==d){d.tabIndex=a.tabIndex}c.removeAttribute("tabIndex")}else{if(a!==c){c.tabIndex=a.tabIndex}d.removeAttribute("tabIndex")}d=c=a=null}},onDragstop:function(d){var f=d.properties,e=xui.$us(d),b=d.getRoot(),g=b.cssPos(),a=null,c=null;if(d.$px(f.left)!==g.left){f.left=a=d.$forceu(g.left,null)}if(d.$px(f.top)!==g.top){f.top=c=d.$forceu(g.top,null)}b.cssPos({left:a,top:c});if(d.onMove&&(a!==null||c!==null)){d.boxing().onMove(d,a,c,null,null)}},TABSTOP1:{onFocus:function(f,q,a){var j=parseInt(xui.use(a).get(0).tabIndex||1+"",10)-1;var c=f.getRoot().get(0).getElementsByTagName("*"),r,d;for(var m=0,g=c.length,b;b=c[m];m++){if(b.nodeType==1){if(b.tabIndex&&b.tabIndex<=j){if(!r){r=(d=b).tabIndex}if(b.tabIndex>r){r=(d=b).tabIndex}if(r===j){break}}}}if(b){xui(b).focus(true);xui.use(a).get(0).tabIndex=b.tabIndex}else{b=f.getRoot().nextFocus(false,true,false);xui(b).focus(true);xui.use(a).get(0).tabIndex=b.get(0).tabIndex}c=b=null}},TABSTOP2:{onFocus:function(f,q,a){var j=parseInt(xui.use(a).get(0).tabIndex||1+"")+1;var c=f.getRoot().get(0).getElementsByTagName("*"),r,d;for(var m=0,g=c.length,b;b=c[m];m++){if(b.nodeType==1){if(b.tabIndex&&b.tabIndex>=j){if(!r){r=(d=b).tabIndex}if(b.tabIndex<r){r=(d=b).tabIndex}if(r===j){break}}}}if(b){xui(b).focus(true);xui.use(a).get(0).tabIndex=b.tabIndex}else{b=f.getRoot().nextFocus(true,true,false);xui(b).focus(true);xui.use(a).get(0).tabIndex=b.get(0).tabIndex}c=b=null}},TBAR:{beforeMousedown:function(c,f,j){if(c.$inDesign){return}if(xui.Event.getBtn(f)!="left"){return}if(c.getKey(xui.Event.getSrc(f).parentNode.id)==c.keys.BARCMDR){return}if(c.properties.status=="max"){return false}if(c.properties.movable&&!c._locked){c.box._active(c);var a=c.getRoot(),d=a.cssRegion(),b=a.parent().cssRegion(),g=c.getEmSize();a.startDrag(f,{dragDefer:2,maxLeftOffset:d.left,maxRightOffset:b.width-d.left-g,maxTopOffset:d.top,maxBottomOffset:b.height-d.top-g,magneticDistance:g,xMagneticLines:[0,b.width-d.width],yMagneticLines:[0,b.height-d.height],targetOffsetParent:a.parent()})}},onDblclick:function(a,b,c){if(a.getKey(xui.Event.getSrc(b).parentNode.id)==a.keys.BARCMDR){return}if(!a.properties.maxBtn){return}if(a.properties.status=="max"){a.box._restore(a)}else{a.box._max(a)}}},PIN:{onClick:function(d,f,g){var c=d.keys.PIN,b=d.properties,a=d.boxing();if(d.beforePin&&false===d.boxing().beforePin(d,b.pinned)){return}b.pinned=!b.pinned;d.getSubNode("PIN").tagClass("-checked",b.pinned);d._locked=b.pinned;if(b.resizer){if(!b.pinned){if(b.status!="min"){a._resizer()}}else{if(d.$resizer){a._unResizer()}}}}},MIN:{onClick:function(a,b,c){a.box._min(a,null,null,true)}},MAX:{onClick:function(a,b,c){a.box._max(a,null,null,true)}},RESTORE:{onClick:function(a,b,c){a.box._restore(a)}},LAND:{onClick:function(a,b,c){a.boxing().onLand(a,b,c)}},PANEL:{onClick:function(a,c,d){var b=a.properties;if(b.disabled){return false}if(a.onClickPanel){return a.boxing().onClickPanel(a,c,d)}}},INFO:{onClick:function(a,b,c){a.boxing().onShowInfo(a,b,c)}},OPT:{onClick:function(a,b,c){a.boxing().onShowOptions(a,b,c)}},REFRESH:{onClick:function(a,b,c){a.boxing().onRefresh(a)}},CLOSE:{onClick:function(a,b,c){a.boxing().close()}},CMD:{onClick:function(a,b,c){var d=a.properties;if(d.disabled){return false}if(a.onCmd){a.boxing().onCmd(a,xui.use(c).id().split("_")[1],b,c)}return false}}},DataModel:{rotate:null,selectable:true,tips:null,border:null,disabled:null,dock:"none",showEffects:"Classic",hideEffects:"",initPos:{ini:"center",listbox:["auto","center"]},iframeAutoLoad:{ini:"",action:function(){xui.UI.Div._applyAutoLoad(this)}},ajaxAutoLoad:{ini:"",action:function(){xui.UI.Div._applyAutoLoad(this)}},html:{html:1,action:function(a,b,c){this.getSubNode("PANEL").html(xui.adjustRes(a,0,1),null,null,c)}},caption:{ini:undefined,action:function(a){a=(xui.isSet(a)?a:"")+"";this.getSubNode("CAPTION").html(xui.adjustRes(a,true))}},image:{format:"image",action:function(a){xui.UI.$iconAction(this)}},imagePos:{action:function(a){this.getSubNode("ICON").css("backgroundPosition",a||"center")}},imageBgSize:{action:function(a){this.getSubNode("ICON").css("backgroundSize",a||"")}},imageClass:{ini:"",action:function(a,b){xui.UI.$iconAction(this,"ICON",b)}},iconFontCode:{action:function(a){xui.UI.$iconAction(this)}},shadow:true,resizer:true,movable:true,minBtn:{ini:true,action:function(a){var b=this.getSubNode("MIN");if(a){b.setInlineBlock()}else{b.css("display","none")}}},maxBtn:{ini:true,action:function(a){var b=this.getSubNode("MAX");if(a){b.setInlineBlock()}else{b.css("display","none")}}},restoreBtn:{ini:true,action:function(a){var b=this.getSubNode("RESTORE");if(a){b.setInlineBlock()}else{b.css("display","none")}}},infoBtn:{ini:false,action:function(a){this.getSubNode("INFO").css("display",a?"":"none")}},optBtn:{ini:false,action:function(a){this.getSubNode("OPT").css("display",a?"":"none")}},closeBtn:{ini:true,action:function(a){var b=this.getSubNode("CLOSE");if(a){b.setInlineBlock()}else{b.css("display","none")}}},refreshBtn:{ini:false,action:function(a){this.getSubNode("REFRESH").css("display",a?"":"none")}},pinBtn:{ini:false,action:function(a){var b=this.getSubNode("PIN");if(a){b.setInlineBlock()}else{b.css("display","none")}}},landBtn:{ini:false,action:function(a){var b=this.getSubNode("LAND");if(a){b.setInlineBlock()}else{b.css("display","none")}}},displayBar:{ini:false,action:function(a){var b=this.getSubNode("TBAR");if(a){b.css("display","")}else{b.css("display","none")}}},width:{$spaceunit:1,ini:"25em"},height:{$spaceunit:1,ini:"25em"},minWidth:200,minHeight:100,position:"absolute",fromRegion:{hidden:true,ini:null},modal:{ini:false,action:function(a){if(this.box){if(a){this.box._modal(this)}else{this.box._unModal(this)}}}},status:{ini:"normal",listbox:["normal","min","max","left","right"],action:function(d,e){var c=this,a=c.box;if(d=="min"){a._min(c,e,null,true)}else{if(d=="max"){a._max(c,e,null,true)}else{a._restore(c,e)}}}},hAlign:{ini:"left",listbox:["left","center","right"],action:function(a){this.getSubNode("BARCMDL").css("textAlign",a)}},tagCmds:{ini:[],action:function(){this.boxing().refresh()}},$hborder:1,$vborder:1},EventHandlers:{onIniPanelView:function(a){},onShow:function(a){},onActivated:function(a){},beforePin:function(a,b){},beforeStatusChanged:function(c,a,b){},afterStatusChanged:function(c,a,b){},onClickPanel:function(a,b,c){},onLand:function(a,b,c){},beforeClose:function(a){},onShowInfo:function(a,b,c){},onShowOptions:function(a,b,c){},onRefresh:function(a){},onCmd:function(a,c,b,d){}},RenderTrigger:function(){var a=this;a.destroyTrigger=function(){var b=this;if(b.$inModal){b.box._unModal(b)}}},LayoutTrigger:function(){var c=this,d=c.properties;if(d.modal){var e=c.$modalDiv&&c.$modalDiv.parent(),a=c.box;if(e&&e.get(0)&&e.get(0)!==c.getRootNode()){a._unModal(c)}a._modal(c)}},_prepareData:function(c){var d=arguments.callee.upper.call(this,c),b="display:none";d._displayBar=d.displayBar?"":b;d.minDisplay=d.minBtn?"":b;d.maxDisplay=d.maxBtn?"":b;d.infoDisplay=d.infoBtn?"":b;d.optDisplay=d.optBtn?"":b;d.closeDisplay=d.closeBtn?"":b;d.pinDisplay=d.pinBtn?"":b;d.landDisplay=d.landBtn?"":b;d.refreshDisplay=d.refreshBtn?"":b;d._align="text-align:"+d.hAlign+";";var a=c.properties.status;if(a=="min"||a=="max"||a=="left"||a=="right"){c.$noR=1}if(xui.isStr(d.overflow)){d._overflow=d.overflow.indexOf(":")!=-1?(d.overflow):(d.overflow?("overflow:"+d.overflow):"")}if(!xui.isEmpty(d.tagCmds)){this._prepareCmds(c,d)}return d},_min:function(d,f,r,e){var c=d.getRoot(),j=d.box,b=c.parent(),l=d.boxing(),s=d.properties,q=xui.Dom._getEffects(s.showEffects,1);if(d.$inThread){d.$inThread.abort()}if(!f){f=s.status}if(d.beforeStatusChanged&&false===d.boxing().beforeStatusChanged(d,"min",f)){return}if(f=="max"){j._unMax(d)}else{j._refreshRegion(d)}d.getSubNodes(["PANEL","BBAR"]).css("display","none");if(s.minBtn){if(s.restoreBtn){d.getSubNode("RESTORE").setInlineBlock()}d.getSubNode("MIN").css("display","none")}if(s.resizer&&d.$resizer){l._unResizer()}s.status="min";var n=c.height(),m=d.getSubNode("BORDER").height(),g=d.getSubNode("TBAR").height();c.cssSize({width:s.minWidth,height:g+n-m},true);if(d.afterStatusChanged){d.boxing().afterStatusChanged(d,"min",f)}if(q&&xui.browser.ie678){xui.filter(q.params,function(u,a){return !!xui.Dom._cssfake[a]})}c.show(null,null,r,null,e)},_max:function(d,f,m,e){var c=d.getRoot(),g=d.box,j=d.boxing(),b=c.parent(),n=d.properties,l=xui.Dom._getEffects(n.showEffects,1);if(!f){f=n.status}if(d.$inThread){d.$inThread.abort()}if(d.beforeStatusChanged&&false===d.boxing().beforeStatusChanged(d,"max",f)){return}if(f=="min"){g._unMin(d)}else{g._refreshRegion(d)}if(n.pinBtn){d.getSubNode("PIN").css("display","none")}if(n.maxBtn){d.getSubNode("MAX").css("display","none");if(n.restoreBtn){d.getSubNode("RESTORE").setInlineBlock()}}if(n.resizer&&d.$resizer){j._unResizer()}n.status="max";j.setDock("cover",true);if(d.afterStatusChanged){d.boxing().afterStatusChanged(d,"max",f)}if(l&&xui.browser.ie678){xui.filter(l.params,function(q,a){return !!xui.Dom._cssfake[a]})}c.show(null,null,m,null,e)},_restore:function(c,a){var e=c.getRoot(),d=c.box,b=c.properties;if(!a){a=b.status}b.status="normal";if(c.beforeStatusChanged&&false===c.boxing().beforeStatusChanged(c,"normal",a)){return}if(a=="max"){d._unMax(c)}if(a=="min"){d._unMin(c)}c.getSubNode("BORDER").ieRemedy();c.getSubNode("RESTORE").css("display","none")},_unMax:function(c){var b=c.properties,a=c.boxing();c.getSubNode("MAX").setInlineBlock();if(b.pinBtn){c.getSubNode("PIN").setInlineBlock()}if(b.resizer&&!b.pinned){a._resizer()}a.setDock("none");c.adjustSize(true);if(c.afterStatusChanged){c.boxing().afterStatusChanged(c,"normal",status)}},_unMin:function(c){var b=c.properties,a=c.boxing();c.getSubNodes(["PANEL","BBAR"]).css("display","block");c.getSubNode("MIN").setInlineBlock();if(b.resizer&&!b.pinned){a._resizer()}c.getRoot().cssSize({width:b.width,height:b.height});c.adjustSize(true)},_active:function(d,a){var b=this;if(d.$inDesign){return}if(a!==false&&xui.$cache.unique.activeWndId==d.$xid){return}b._deActive();if(a!==false){var f=xui(d.domId),e=f.topZindex(),c=parseInt(f.css("zIndex"),0);f.css("zIndex",e>c?e:c);d.getSubNode("TBAR").tagClass("-focus");xui.$cache.unique.activeWndId=d.$xid}},_deActive:function(){var a;if(a=xui.UI._cache["$"+xui.$cache.unique.activeWndId]){a.getSubNode("TBAR").tagClass("-focus",false)}delete xui.$cache.unique.activeWndId},_modal:function(d){var c=d.getRoot(),a,f=c.parent(),e;if(!f.isEmpty()){if(!d.$inModal){e=d.$modalDiv;if(!e||!e.get(0)||!e.get(0).parentNode){e=d.$modalDiv=xui.create("<div class='xui-cover xui-custom xui-cover-modal' style='left:0;top:0;position:absolute;overflow:hidden;display:block;z-index:0;'></div>");e.setSelectable(false)}f.append(e);if(f.get(0)===document.body||f.get(0)===document||f.get(0)===window){f=xui.win}e.css({display:"block",width:Math.max(f.width(),f.scrollWidth())+"px",height:Math.max(f.height(),f.scrollHeight())+"px"}).onMousedown(function(){return d.$inDesign?null:false}).topZindex(true);if(d.$inDesign){e.onClick(function(){c.onClick(true)})}f.onSize(function(l){l=xui(l);var g=l.width()+"px",j=l.height()+"px";e.css({width:g,height:j});xui.asyRun(function(){var m=Math.max(l.width(),l.scrollWidth())+"px",n=Math.max(l.height(),l.scrollHeight())+"px";e.css({width:m,height:n})})},"dialog:"+d.serialId);var b=(parseInt(e.css("zIndex"),10)||0)+1;c.css("zIndex",b);if(b>=xui.Dom.TOP_ZINDEX){xui.Dom.TOP_ZINDEX=b+1}d.$inModal=true;f.setBlurTrigger(d.$xid+"_anti",true,xui([e.get(0),d.getRootNode()]))}}},_unModal:function(a){if(a.$inModal){var c=a.$modalDiv.parent();if(c.get(0)===document.body||c.get(0)===document||c.get(0)===window){c=xui.win}c.onSize(null,"dialog:"+a.serialId);a.getRoot().css("zIndex",0);a.$modalDiv.css("display","none");var b=a.getSubNode("BORDER");if(!b.isEmpty()){b.append(a.$modalDiv)}a.$inModal=false;c.setBlurTrigger(a.$xid+"_anti")}},_refreshRegion:function(b){if(!b.renderId){return}var f=b.properties,a=b.getRoot(),d=xui.$us(b),e=function(g,j){return b.$forceu(g,d>0?"em":"px",j)},c=a.cssRegion();c.left=e(c.left);c.top=e(c.top);c.width=e(c.width);c.height=e(c.height);return xui.merge(f,c,"all")},_adjust:function(g,q,f,o,a,m){q=xui.adjustRes(q||"");if(!xui.isSet(f)||f===""){f=q;q=o||""}var b=g.$div.reBoxing(),j="xui:temp:dialog",l=arguments.callee,n,c;if(!xui.Dom.byId(j)){e=l._cache=b.clone(false);xui("body").append(e);e.css({overflow:"visible",position:"absolute",visibility:"visible",left:xui.Dom.HIDE_VALUE,top:xui.Dom.HIDE_VALUE}).id(j,true)}var e=l._cache;e.width("auto").height("auto");e.html(f,false);var r=e.cssSize();r.width+=10;r.height+=10;b.html(f);if(r.width>500){r.width=500;e.width(500);r.height=e.offsetHeight()+10;e.width("auto")}e.html("",false);r.height+=10;if(r.height>400){r.height=400}if(r.width<150){r.width=150}if(r.height<30){r.height=30}b.cssSize(r).css("overflow","auto").show();var d=g.getRoot()._getEmSize();n=r.width+d*2;c=r.height+d*7.5;g.setCaption(q).setWidth(n).setHeight(c);return{width:n,height:c}},alert:function(o,g,n,e,d,m,q,a,f){var l=arguments.callee,j,s;g=g?g.replace("<br/>","/n"):o;if(f||!(j=l.dialog)||!j.get(0)||(!j.get(0).renderId)){j=new xui.UI.MDialog({overflow:"hidden",displayBar:false,shadow:false,width:"20em",height:"25em",modal:true,resizer:false},{beforeClose:function(){xui.tryF(j._$onClose);j._$onClose=null;if(!f){j.hide();return false}},onHotKeydown:function(w,u){if(u.key=="esc"){j.close()}}});j.setCustomStyle({BORDER:{"border-width":"0em"},MAINI:{"background-color":"#ffffff00"},MAIN:{"background-color":"#ffffff00",border:"0em"},PANEL:{"background-color":"#ffffff00",border:"0em"}});var r=new xui.UI.SVGPaper({dock:"fill",activeAnim:"zoomAlert"});r.append(xui.create("xui.UI.Icon").setLeft("2em").setTop("3em").setImageClass("xui-icon-error").setIconFontSize("3em").setIconColor("#FFD700"));s=new xui.svg.pathComb({vAlign:"33.33%",attr:{x:0,y:0,KEY:{fill:"204-#6BBED2:0-#23538A:50-#82BBD1:100",stroke:"#000000",path:"M,44,38C,40,38,36,41,36,45.03831417624522L,36,139.09578544061299C,36,142.99500509578544,39.53956375838928,146.1340996168582,43.936241610738264,146.1340996168582L,79.40132130872487,146.1340996168582C,77.93569228187918,147.62190965517243,77.12416107382552,149.2366268965517,77.12416107382552,150.9329501915709C,77.12416107382552,158.17983521072802,91.81477919463089,164.04980842911883,109.95134228187925,164.04980842911883C,128.0879053691275,164.04980842911883,142.77852348993292,158.17983521072802,142.77852348993292,150.9329501915709C,142.77852348993292,149.2366268965517,141.96699228187913,147.62190965517243,140.50136325503354,146.1340996168582L,243.06375838926192,146.1340996168582C,247.46042902684565,146.1340996168582,251,142.99500509578544,251,139.09578544061299L,251,45.03831417624522C,251,41.13908812260536,247.46042902684565,38,243.06375838926192,38L,43.936241610738264,38ZM,82.89597315436244,165.32950191570882C,72.93083137583893,165.32950191570882,64.85906040268456,168.765581302682,64.85906040268456,173.00766283524905C,64.85906040268456,177.2497443678161,72.93083137583893,180.68582375478928,82.89597315436244,180.68582375478928C,92.861122147651,180.68582375478928,100.93288590604027,177.2497443678161,100.93288590604027,173.00766283524905C,100.93288590604027,168.765581302682,92.861122147651,165.32950191570882,82.89597315436244,165.32950191570882ZM,64.85906040268456,184.5249042145594C,59.27857667785233,184.5249042145594,54.75838926174495,187.10196375478927,54.75838926174495,190.28352490421452C,54.75838926174495,193.46508605363982,59.27857667785233,196.04214559386975,64.85906040268456,196.04214559386975C,70.4395441275168,196.04214559386975,74.95973154362416,193.46508605363982,74.95973154362416,190.28352490421452C,74.95973154362416,187.10196375478927,70.4395441275168,184.5249042145594,64.85906040268456,184.5249042145594ZM,47.54362416107381,198.60153256704982C,43.95616879194631,198.60153256704982,41.0503355704698,200.03322804597707,41.0503355704698,201.80076628352492C,41.0503355704698,203.568291724138,43.95616879194631,205,47.54362416107381,205C,51.13107953020135,205,54.036912751677846,203.568291724138,54.036912751677846,201.80076628352492C,54.036912751677846,200.03322804597707,51.13107953020135,198.60153256704982,47.54362416107381,198.60153256704982Z"},TEXT:{text:o+"\n"+g,"font-size":"18px",fill:"#fff"}}});var c=j.$cmd=new xui.UI.Div({height:"2.5em",dock:"bottom",borderType:"none",zIndex:10},null,null,null,{KEY:"text-align:center;padding-top:.25em;border-top:dotted 2px #666666;background-color: #ffffff00;border-width:0em"}),b=j.$btn=new xui.UI.Button({position:"relative",width:"18em",height:"2em",tabindex:1},{onClick:function(){j.close()},onHotKeydown:function(w,u){if(u.key=="enter"){j.close()}}},null,null,{KEY:"margin:0 .5em"});c.append(b);j.append(c).render();r.append(s);j.append(r).render();if(!f){l.dialog=j}}j._$onClose=n;j.$btn.setCaption("&nbsp;&nbsp;"+(e||xui.wrapRes("$inline.ok"))+"&nbsp;&nbsp;");if(q&&q["xui.UI"]){q=q.getContainer(a)}if(!xui.isSet(q)){q=xui("body")}j.show(q,true,d,m);xui.resetRun("dlg_focus:"+j.get(0).$xid,function(){j.$btn.activate()});return j},confirm:function(o,u,r,w,j,d,f,n,q,a,g){var m=arguments.callee,l;if(g||!(l=m.dialog)||!l.get(0)||(!l.get(0).renderId)){l=new xui.UI.MDialog({overflow:"hidden",displayBar:false,shadow:false,width:"20em",height:"25em",modal:true,resizer:false},{beforeClose:function(){if(!l._$_clicked){xui.tryF(l._$onNo,["close"])}else{delete l._$_clicked}l._$onYes=l._$onNo=null;if(!g){l.hide();return false}},onHotKeydown:function(A,x){if(x.key=="esc"){l.close()}}});l.setCustomStyle({BORDER:{"border-width":"0em"},MAINI:{"background-color":"#ffffff00"},MAIN:{"background-color":"#ffffff00",border:"0em"},PANEL:{"background-color":"#ffffff00",border:"0em"}});var s=new xui.UI.SVGPaper({dock:"fill",activeAnim:"zoomAlert"});s.append(xui.create("xui.UI.Icon").setLeft("2em").setTop("3em").setImageClass("xui-uicmd-info").setIconFontSize("3em").setIconColor("#FFD700"));path=new xui.svg.pathComb({vAlign:"33.33%",attr:{x:0,y:0,KEY:{fill:"204-#6BBED2:0-#23538A:50-#82BBD1:100",stroke:"#000000",path:"M,19.99999978712562,36.35299171611439L,19.99999978712562,36.35299171611439C,19.99999978712562,27.321475539568972,31.799162041515697,20.000000108631788,46.35416426939723,20.000000108631788L,58.33333625798325,20.000000108631788L,58.33333625798325,20.000000108631788L,115.83334482333024,20.000000108631788L,223.64583097563715,20.000000108631788C,230.63540758869132,20.000000108631788,237.33868822437256,21.722883711342362,242.28106413612156,24.789669746483085C,247.22340917538682,27.856455781623794,250.00001089415068,32.01590880664122,250.00001089415068,36.35299171611439L,250.00001089415068,77.23551048709786L,250.00001089415068,77.23551048709786L,250.00001089415068,101.76501426659644L,250.00001089415068,101.76501426659644C,250.00001089415068,110.79653512007405,238.2008563578815,118.11801990421694,223.64583869375812,118.11801990421694L,115.83335254145113,118.11801990421694L,40.71668666955408,159.69991308362225L,58.33334397610419,118.11801990421694L,46.35417198751814,118.11801990421694C,31.79916975963663,118.11801990421694,20.000007505246558,110.79653512007405,20.000007505246558,101.76501426659644L,20.000007505246558,101.76501426659644L,20.000007505246558,77.23551048709786L,20.000007505246558,77.23551048709786Z"},TEXT:{text:o,"font-size":"18px",fill:"#fff"}}});var e=l.$cmd=new xui.UI.Div({height:"2.5em",dock:"bottom",borderType:"none",zIndex:10},null,null,null,{KEY:"text-align:center;padding-top:.25em;border-top:dotted 2px #666666;background-color: #ffffff00;border-width:0em"}),c=l.$btn1=new xui.UI.SButton({tabindex:1,position:"relative",imageClass:"xui-icon-right",width:"8em",height:"2em"},{onClick:function(){xui.tryF(l._$onYes,["yes"]);l._$_clicked=1;l.close()}},null,null,{KEY:"margin:0 .5em"});e.append(c);c=l.$btn2=new xui.UI.SButton({tabindex:2,width:"8em",height:"2em",imageClass:"xui-uicmd-delete",position:"relative"},{onClick:function(){xui.tryF(l._$onNo,["no"]);l._$_clicked=1;l.close()}},null,null,{KEY:"margin:0 .5em"});e.append(c);var b=l.$div=new xui.UI.Div({left:10,top:10});e.append(c);l.append(e).render();s.append(path);l.append(s).render();if(!g){m.dialog=l}}l._$onYes=r;l._$onNo=w;delete l._$_clicked;l.$btn1.setCaption("&nbsp;&nbsp;"+(j||xui.wrapRes("$inline.yes"))+"&nbsp;&nbsp;");l.$btn2.setCaption("&nbsp;&nbsp;"+(d||xui.wrapRes("$inline.no"))+"&nbsp;&nbsp;");if(q&&q["xui.UI"]){q=q.getContainer(a)}if(!xui.isSet(q)){q=xui("body")}l.show(q,true,f,n);xui.resetRun("dlg_focus:"+l.get(0).$xid,function(){l.$btn2.activate()});return l},pop:function(l,f,e,d,j,m,a){var g=new xui.UI.Dialog({overflow:"hidden",minBtn:false,maxBtn:false,pinBtn:false,resizer:false},{onHotKeydown:function(q,o){if(o.key=="esc"){g.close()}}}),c=g.$cmd=new xui.UI.Div({height:"2.5em",dock:"bottom",zIndex:10},null,null,null,{KEY:"text-align:center;padding-top:.5em"}).append(g.$btn=new xui.UI.SButton({caption:"&nbsp;&nbsp;"+(e||"$inline.ok")+"&nbsp;&nbsp;",tabindex:1,position:"relative"},{onClick:function(){g.destroy()},onHotKeydown:function(q,o){if(o.key=="enter"){g.close()}}},null,null,{KEY:"margin:0 .5em"})),b=g.$div=new xui.UI.Div({left:10,top:10,width:"7em"}).setCustomStyle({KEY:"overflow:visible"});g.append(c).append(b).render();var n=xui.UI.Dialog._adjust(g,l,f,"Message");if(m&&m["xui.UI"]){m=m.getContainer(a)}if(!xui.isSet(m)){m=xui("body")}g.show(m,false,d,j);xui.resetRun("dlg_focus:"+g.get(0).$xid,function(){g.$btn.activate()});return g},prompt:function(x,s,o,a,j,c,f,d,l,g,e,u){var r,w=arguments.callee;if(u||!(r=w.dialog)||!r.get(0)||(!r.get(0).renderId)){r=new xui.UI.MDialog({overflow:"hidden",displayBar:false,shadow:false,width:"20em",height:"25em",modal:true,resizer:false},{beforeClose:function(){if(!r._$_clickYes){xui.tryF(r._$onNo,["no"])}else{delete r._$_clickYes}r._$input.setValue("",false,"prompt");r._$onYes=r._$onNo=null;if(!u){r.hide();return false}}});r.setCustomStyle({BORDER:{"border-width":"0em"},MAINI:{"background-color":"#ffffff00"},MAIN:{"background-color":"#ffffff00",border:"0em"},PANEL:{"background-color":"#ffffff00",border:"0em"}});var n=new xui.UI.SVGPaper({dock:"fill",activeAnim:"zoomAlert"});var m=new xui.svg.pathComb({vAlign:"33.33%",animDraw:'"2s linear',attr:{x:0,y:0,KEY:{fill:"204-#6BBED2:0-#23538A:50-#82BBD1:100",stroke:"#000000",path:"M,10,10L,49.999899999999975,10L,49.999899999999975,10L,110.00001249999997,10L,250,10L,250,87.91713545950735L,250,87.91713545950735L,250,120.8634851437852L,250,143.57222430199647L,110.000011,143.57222430199647L,10.388461780000018,209.0416495374849L,50.00000619999998,143.57222430199647L,10,143.57222430199647L,10,121.31018811782678L,10,87.91713545950735L,10,87.91713545950735Z",x:10,y:10},TEXT:{text:"Rect","font-size":"12px",fill:"#fff","font-weight":"bold"}}});n.append(xui.create("xui.svg.text").setSvgTag("Shapes:Text").setAttr({x:58,y:28,text:x,"font-size":"14px","font-weight":"",fill:"#F2F9FE"}));var q=new xui.UI.Div({height:"2.5em",dock:"bottom",borderType:"none",zIndex:10},null,null,null,{KEY:"text-align:center;padding-top:.25em;border-top:dotted 2px #666666;background-color: #ffffff00;border-width:0em"}).append(r.$btn1=new xui.UI.SButton({position:"relative",width:"8em",height:"2em",imageClass:"xui-icon-right",tabindex:1},{onClick:function(){if(false!==xui.tryF(r._$onYes,[r._$input.getUIValue()])){r._$_clickYes=1;r.close()}}},null,null,{KEY:"margin:0 .5em"}));q.append(r.$btn2=new xui.UI.SButton({tabindex:1,width:"8em",height:"2em",imageClass:"xui-uicmd-delete",position:"relative"},{onClick:function(){r.close()}},null,null,{KEY:"margin:0 .5em"}));var b=r._$input=new xui.UI.Input({left:"1.5em",top:"4em",width:"16.5em",height:"5.5em",multiLines:true});r.append(q).render();n.append(m);n.append(b);r.append(n).render();if(!u){w.dialog=r}}r.setCaption(x||"Prompt");r._$input.setValue(o||"",true,"prompt");r._$onYes=a;r._$onNo=j;delete r._$_clickYes;r.$btn1.setCaption("&nbsp;&nbsp;"+(c||xui.wrapRes("$inline.ok"))+"&nbsp;&nbsp;");r.$btn2.setCaption("&nbsp;&nbsp;"+(f||xui.wrapRes("$inline.cancel"))+"&nbsp;&nbsp;");if(g&&g["xui.UI"]){g=g.getContainer(e)}if(!xui.isSet(g)){g=xui("body")}r.show(g,true,d,l);xui.resetRun("dlg_focus:"+r.get(0).$xid,function(){r._$input.activate()});return r},_onresize:function(n,A,x,f){if(A&&n.properties.status=="min"){A=n.properties.minWidth}var m=n.properties,s=xui.$us(n),B=function(C,D){return n.$forceu(C,s>0?"em":"px",D)},w=arguments.callee.upper.apply(this,arguments),r={},l=n.getSubNode("BORDER"),j=n.getSubNode("TBAR"),g=n.getSubNode("PANEL"),c=n.getSubNode("BBAR"),b=n.getSubNode("MAIN"),a=n.getSubNode("MAINI"),e=l.contentBox(),d=g.contentBox(),q,o,u;if(A){A=n.$px(A)}if(x){x=n.$px(x)}if(w.left){w.left=n.$px(w.left)}if(w.top){w.top=n.$px(w.top)}if(w.width){w.width=n.$px(w.width)}if(w.height){w.height=n.$px(w.height)}if(x){if(x=="auto"){r.height=x}else{q=j.offsetHeight(true);o=c.offsetHeight(true);if((u=w.height-q-o)>0){r.height=u}}}if(x){r.height=r.height-a._paddingH()-(e?0:l._borderH())-(d?0:g._borderH())}if(A){r.width=w.width-(parseFloat(a.css("paddingRight"))||0)-(parseFloat(a.css("borderRightWidth"))||0)-(parseFloat(b.css("paddingLeft"))||0)-(parseFloat(b.css("borderLeftWidth"))||0)}-(e?0:l._borderW())-(d?0:g._borderW());if(A&&s>0){r.width=B(r.width)}if(x&&s>0){r.height=B(r.height)}g.cssSize(r,true);if(A){xui.UI._adjustConW(n,g,r.width)}}}});(function webpackUniversalModuleDefinition(a,b){if(typeof exports==="object"&&typeof module==="object"){module.exports=b()}else{if(typeof define==="function"&&define.amd){define("Raphael",[],b)}else{if(typeof exports==="object"){exports.Raphael=b()}else{a.Raphael=b()}}}})(this,function(){return(function(a){var b={};function c(e){if(b[e]){return b[e].exports}var d=b[e]={exports:{},id:e,loaded:false};a[e].call(d.exports,d,d.exports,c);d.loaded=true;return d.exports}c.m=a;c.c=b;c.p="";return c(0)})([function(c,b,d){var a,e;!(a=[d(1),d(3),d(4)],e=function(f){f._in_xui=1;return f}.apply(b,a),e!==undefined&&(c.exports=e))},function(c,b,d){var a,e;!(a=[d(2)],e=function(bk){function bq(R){if(bq.is(R,"function")){return W?R():bk.on("raphael.DOMload",R)}else{if(bq.is(R,F)){return bq._engine.create[bA](bq,R.splice(0,3+bq.is(R[0],br))).add(R)}else{var g=Array.prototype.slice.call(arguments,0);if(bq.is(g[g.length-1],"function")){var E=g.pop();return W?E.call(bq._engine.create[bA](bq,g)):bk.on("raphael.DOMload",function(){E.call(bq._engine.create[bA](bq,g))})}else{return bq._engine.create[bA](bq,arguments)}}}}bq.version="2.2.0";bq.eve=bk;var W,bD=/[, ]+/,aD={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},ag=/\{(\d+)\}/g,bH="prototype",bE="hasOwnProperty",bd={doc:document,win:window},aN={was:Object.prototype[bE].call(bd.win,"Raphael"),is:bd.win.Raphael},bR=function(){this.ca=this.customAttributes={}},ay,bI="appendChild",bA="apply",aE="concat",aa=("ontouchstart" in bd.win)||bd.win.DocumentTouch&&bd.doc instanceof DocumentTouch,bv="",bp=" ",q=String,r="split",bJ="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel contextmenu"[r](bp),bx={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},au=q.prototype.toLowerCase,aR=Math,bQ=aR.max,at=aR.min,av=aR.abs,a1=aR.pow,aq=aR.PI,br="number",f="string",F="array",C="toString",L="fill",aV=Object.prototype.toString,bK={},B="push",ak=bq._ISURL=/^url\(['"]?(.+?)['"]?\)$/i,aj=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,M={"NaN":1,"Infinity":1,"-Infinity":1},ax=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,N=aR.round,ab="setAttribute",bU=parseFloat,bS=parseInt,a2=q.prototype.toUpperCase,by=bq._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-dashoffset":0,"stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0,"class":""},bw=bq._availableAnimAttrs={blur:br,"clip-rect":"csv",cx:br,cy:br,fill:"colour","fill-opacity":br,"font-size":br,height:br,opacity:br,path:"path",r:br,rx:br,ry:br,stroke:"colour","stroke-opacity":br,"stroke-width":br,transform:"transform",width:br,x:br,y:br},bB=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]/g,bn=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,aG={hs:1,rg:1},aW=/,?([achlmqrstvxz]),?/gi,bo=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,am=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,az=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/ig,ba=bq._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,Y={},I=function(E,g){return E.key-g.key},bC=function(E,g){return bU(E)-bU(g)},an=function(){},aF=function(g){return g},A=bq._rectPath=function(g,bW,E,R,S){if(S){return[["M",g+S,bW],["l",E-S*2,0],["a",S,S,0,0,1,S,S],["l",0,R-S*2],["a",S,S,0,0,1,-S,S],["l",S*2-E,0],["a",S,S,0,0,1,-S,-S],["l",0,S*2-R],["a",S,S,0,0,1,S,-S],["z"]]}return[["M",g,bW],["l",E,0],["l",0,R],["l",-E,0],["z"]]},ae=function(g,S,R,E){if(E==null){E=R}return[["M",g,S],["m",0,-E],["a",R,E,0,1,1,0,2*E],["a",R,E,0,1,1,0,-2*E],["z"]]},ap=bq._getPath={path:function(g){return g.attr("path")},circle:function(E){var g=E.attrs;return ae(g.cx,g.cy,g.r)},ellipse:function(E){var g=E.attrs;return ae(g.cx,g.cy,g.rx,g.ry)},rect:function(E){var g=E.attrs;return A(g.x,g.y,g.width,g.height,g.r)},image:function(E){var g=E.attrs;return A(g.x,g.y,g.width,g.height)},text:function(g){var E=g._getBBox();return A(E.x,E.y,E.width,E.height)},set:function(g){var E=g._getBBox();return A(E.x,E.y,E.width,E.height)}},ac=bq.mapPath=function(b0,bX){if(!bX){return b0}var bY,bW,R,g,bZ,S,E;b0=bs(b0);for(R=0,bZ=b0.length;R<bZ;R++){E=b0[R];for(g=1,S=E.length;g<S;g+=2){bY=bX.x(E[g],E[g+1]);bW=bX.y(E[g],E[g+1]);E[g]=bY;E[g+1]=bW}}return b0};bq._g=bd;bq.type=(bd.win.SVGAngle||bd.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML");if(bq.type=="VML"){var bf=bd.doc.createElement("div"),bg;bf.innerHTML='<v:shape adj="1"/>';bg=bf.firstChild;bg.style.behavior="url(#default#VML)";if(!(bg&&typeof bg.adj=="object")){return(bq.type=bv)}bf=null}bq.svg=!(bq.vml=bq.type=="VML");bq._Paper=bR;bq.fn=ay=bR.prototype=bq.prototype;bq._id=0;bq.is=function(E,g){g=au.call(g);if(g=="finite"){return !M[bE](+E)}if(g=="array"){return E instanceof Array}return(g=="null"&&E===null)||(g==typeof E&&E!==null)||(g=="object"&&E===Object(E))||(g=="array"&&Array.isArray&&Array.isArray(E))||aV.call(E).slice(8,-1).toLowerCase()==g};function bt(R){if(typeof R=="function"||Object(R)!==R){return R}var E=new R.constructor;for(var g in R){if(R[bE](g)){E[g]=bt(R[g])}}return E}bq.angle=function(bW,bY,R,bX,E,S){if(E==null){var g=bW-R,bZ=bY-bX;if(!g&&!bZ){return 0}return(180+aR.atan2(-bZ,-g)*180/aq+360)%360}else{return bq.angle(bW,bY,E,S)-bq.angle(R,bX,E,S)}};bq.rad=function(g){return g%360*aq/180};bq.deg=function(g){return Math.round((g*180/aq%360)*1000)/1000};bq.snapTo=function(E,S,g){g=bq.is(g,"finite")?g:10;if(bq.is(E,F)){var R=E.length;while(R--){if(av(E[R]-S)<=g){return E[R]}}}else{E=+E;var bW=S%E;if(bW<g){return S-bW}if(bW>E-g){return S-bW+E}}return S};var aZ=bq.createUUID=(function(g,E){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(g,E).toUpperCase()}})(/[xy]/g,function(R){var E=aR.random()*16|0,g=R=="x"?E:(E&3|8);return g.toString(16)});bq.setWindow=function(g){bk("raphael.setWindow",bq,bd.win,g);bd.win=g;bd.doc=bd.win.document;if(bq._engine.initWin){bq._engine.initWin(bd.win)}};var V=function(R){if(bq.vml){var g=/^\s+|\s+$/g;var bW;try{var bX=new ActiveXObject("htmlfile");bX.write("<body>");bX.close();bW=bX.body}catch(bY){bW=createPopup().document.body}var E=bW.createTextRange();V=T(function(bZ){try{bW.style.color=q(bZ).replace(g,bv);var b0=E.queryCommandValue("ForeColor");b0=((b0&255)<<16)|(b0&65280)|((b0&16711680)>>>16);return"#"+("000000"+b0.toString(16)).slice(-6)}catch(b1){return"none"}})}else{var S=bd.doc.createElement("i");S.title="Rapha\xebl Colour Picker";S.style.display="none";bd.doc.body.appendChild(S);V=T(function(bZ){S.style.color=bZ;return bd.doc.defaultView.getComputedStyle(S,bv).getPropertyValue("color")})}return V(R)},aI=function(){return"hsb("+[this.h,this.s,this.b]+")"},bu=function(){return"hsl("+[this.h,this.s,this.l]+")"},H=function(){return this.hex},Q=function(bW,S,E){if(S==null&&bq.is(bW,"object")&&"r" in bW&&"g" in bW&&"b" in bW){E=bW.b;S=bW.g;bW=bW.r}if(S==null&&bq.is(bW,f)){var R=bq.getRGB(bW);bW=R.r;S=R.g;E=R.b}if(bW>1||S>1||E>1){bW/=255;S/=255;E/=255}return[bW,S,E]},Z=function(bW,S,E,bX){bW*=255;S*=255;E*=255;var R={r:bW,g:S,b:E,hex:bq.rgb(bW,S,E),toString:H};bq.is(bX,"finite")&&(R.opacity=bX);return R};bq.color=function(g){var E;if(bq.is(g,"object")&&"h" in g&&"s" in g&&"b" in g){E=bq.hsb2rgb(g);g.r=E.r;g.g=E.g;g.b=E.b;g.hex=E.hex}else{if(bq.is(g,"object")&&"h" in g&&"s" in g&&"l" in g){E=bq.hsl2rgb(g);g.r=E.r;g.g=E.g;g.b=E.b;g.hex=E.hex}else{if(bq.is(g,"string")){g=bq.getRGB(g)}if(bq.is(g,"object")&&"r" in g&&"g" in g&&"b" in g){E=bq.rgb2hsl(g);g.h=E.h;g.s=E.s;g.l=E.l;E=bq.rgb2hsb(g);g.v=E.b}else{g={hex:"none"};g.r=g.g=g.b=g.h=g.s=g.v=g.l=-1}}}g.toString=H;return g};bq.hsb2rgb=function(bY,b1,bZ,bW){if(this.is(bY,"object")&&"h" in bY&&"s" in bY&&"b" in bY){bZ=bY.b;b1=bY.s;bW=bY.o;bY=bY.h}bY*=360;var bX,b0,E,S,g;bY=(bY%360)/60;g=bZ*b1;S=g*(1-av(bY%2-1));bX=b0=E=bZ-g;bY=~~bY;bX+=[g,S,0,0,S,g][bY];b0+=[S,g,g,S,0,0][bY];E+=[0,0,S,g,g,S][bY];return Z(bX,b0,E,bW)};bq.hsl2rgb=function(bZ,b1,bX,bW){if(this.is(bZ,"object")&&"h" in bZ&&"s" in bZ&&"l" in bZ){bX=bZ.l;b1=bZ.s;bZ=bZ.h}if(bZ>1||b1>1||bX>1){bZ/=360;b1/=100;bX/=100}bZ*=360;var bY,b0,E,S,g;bZ=(bZ%360)/60;g=2*b1*(bX<0.5?bX:1-bX);S=g*(1-av(bZ%2-1));bY=b0=E=bX-g/2;bZ=~~bZ;bY+=[g,S,0,0,S,g][bZ];b0+=[S,g,g,S,0,0][bZ];E+=[0,0,S,g,g,S][bZ];return Z(bY,b0,E,bW)};bq.rgb2hsb=function(bZ,bY,E){E=Q(bZ,bY,E);bZ=E[0];bY=E[1];E=E[2];var bX,bW,R,b0;R=bQ(bZ,bY,E);b0=R-at(bZ,bY,E);bX=(b0==0?null:R==bZ?(bY-E)/b0:R==bY?(E-bZ)/b0+2:(bZ-bY)/b0+4);bX=((bX+360)%6)*60/360;bW=b0==0?0:b0/R;return{h:bX,s:bW,b:R,toString:aI}};bq.rgb2hsl=function(E,bY,b1){b1=Q(E,bY,b1);E=b1[0];bY=b1[1];b1=b1[2];var b2,bX,b0,bZ,bW,R;bZ=bQ(E,bY,b1);bW=at(E,bY,b1);R=bZ-bW;b2=(R==0?null:bZ==E?(bY-b1)/R:bZ==bY?(b1-E)/R+2:(E-bY)/R+4);b2=((b2+360)%6)*60/360;b0=(bZ+bW)/2;bX=(R==0?0:b0<0.5?R/(2*b0):R/(2-2*b0));return{h:b2,s:bX,l:b0,toString:bu}};bq._path2string=function(){return this.join(",").replace(aW,"$1")};function j(S,R){for(var g=0,E=S.length;g<E;g++){if(S[g]===R){return S.push(S.splice(g,1)[0])}}}function T(S,E,g){function R(){var bW=Array.prototype.slice.call(arguments,0),bY=bW.join("\u2400"),bX=R.cache=R.cache||{},bZ=R.count=R.count||[];if(bX[bE](bY)){j(bZ,bY);return g?g(bX[bY]):bX[bY]}bZ.length>=1000&&delete bX[bZ.shift()];bZ.push(bY);bX[bY]=S[bA](E,bW);return g?g(bX[bY]):bX[bY]}return R}var O=bq._preload=function(R,E){var g=bd.doc.createElement("img");g.style.cssText="position:absolute;left:-9999em;top:-9999em";g.onload=function(){E.call(this);this.onload=null;bd.doc.body.removeChild(this)};g.onerror=function(){bd.doc.body.removeChild(this)};bd.doc.body.appendChild(g);g.src=R};function n(){return this.hex}bq.getRGB=T(function(g){if(!g||!!((g=q(g)).indexOf("-")+1)){return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:n}}if(g=="none"){return{r:-1,g:-1,b:-1,hex:"none",toString:n}}!(aG[bE](g.toLowerCase().substring(0,2))||g.charAt()=="#")&&(g=V(g));var bW,E,R,bY,S,b0,bZ,bX=g.match(aj);if(bX){if(bX[2]){bY=bS(bX[2].substring(5),16);R=bS(bX[2].substring(3,5),16);E=bS(bX[2].substring(1,3),16)}if(bX[3]){bY=bS((b0=bX[3].charAt(3))+b0,16);R=bS((b0=bX[3].charAt(2))+b0,16);E=bS((b0=bX[3].charAt(1))+b0,16)}if(bX[4]){bZ=bX[4][r](bn);E=bU(bZ[0]);bZ[0].slice(-1)=="%"&&(E*=2.55);R=bU(bZ[1]);bZ[1].slice(-1)=="%"&&(R*=2.55);bY=bU(bZ[2]);bZ[2].slice(-1)=="%"&&(bY*=2.55);bX[1].toLowerCase().slice(0,4)=="rgba"&&(S=bU(bZ[3]));bZ[3]&&bZ[3].slice(-1)=="%"&&(S/=100)}if(bX[5]){bZ=bX[5][r](bn);E=bU(bZ[0]);bZ[0].slice(-1)=="%"&&(E*=2.55);R=bU(bZ[1]);bZ[1].slice(-1)=="%"&&(R*=2.55);bY=bU(bZ[2]);bZ[2].slice(-1)=="%"&&(bY*=2.55);(bZ[0].slice(-3)=="deg"||bZ[0].slice(-1)=="\xb0")&&(E/=360);bX[1].toLowerCase().slice(0,4)=="hsba"&&(S=bU(bZ[3]));bZ[3]&&bZ[3].slice(-1)=="%"&&(S/=100);return bq.hsb2rgb(E,R,bY,S)}if(bX[6]){bZ=bX[6][r](bn);E=bU(bZ[0]);bZ[0].slice(-1)=="%"&&(E*=2.55);R=bU(bZ[1]);bZ[1].slice(-1)=="%"&&(R*=2.55);bY=bU(bZ[2]);bZ[2].slice(-1)=="%"&&(bY*=2.55);(bZ[0].slice(-3)=="deg"||bZ[0].slice(-1)=="\xb0")&&(E/=360);bX[1].toLowerCase().slice(0,4)=="hsla"&&(S=bU(bZ[3]));bZ[3]&&bZ[3].slice(-1)=="%"&&(S/=100);return bq.hsl2rgb(E,R,bY,S)}bX={r:E,g:R,b:bY,toString:n};bX.hex="#"+(16777216|bY|(R<<8)|(E<<16)).toString(16).slice(1);bq.is(S,"finite")&&(bX.opacity=S);return bX}return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:n}},bq);bq.hsb=T(function(R,E,g){return bq.hsb2rgb(R,E,g).hex});bq.hsl=T(function(R,E,g){return bq.hsl2rgb(R,E,g).hex});bq.rgb=T(function(bW,S,E){function R(g){return(g+0.5)|0}return"#"+(16777216|R(E)|(R(S)<<8)|(R(bW)<<16)).toString(16).slice(1)});bq.getColor=function(E){var R=this.getColor.start=this.getColor.start||{h:0,s:1,b:E||0.75},g=this.hsb2rgb(R.h,R.s,R.b);R.h+=0.075;if(R.h>1){R.h=0;R.s-=0.2;R.s<=0&&(this.getColor.start={h:0,s:1,b:R.b})}return g.hex};bq.getColor.reset=function(){delete this.start};function aw(R,bX){var bW=[];for(var E=0,g=R.length;g-2*!bX>E;E+=2){var S=[{x:+R[E-2],y:+R[E-1]},{x:+R[E],y:+R[E+1]},{x:+R[E+2],y:+R[E+3]},{x:+R[E+4],y:+R[E+5]}];if(bX){if(!E){S[0]={x:+R[g-2],y:+R[g-1]}}else{if(g-4==E){S[3]={x:+R[0],y:+R[1]}}else{if(g-2==E){S[2]={x:+R[0],y:+R[1]};S[3]={x:+R[2],y:+R[3]}}}}}else{if(g-4==E){S[3]=S[2]}else{if(!E){S[0]={x:+R[E],y:+R[E+1]}}}}bW.push(["C",(-S[0].x+6*S[1].x+S[2].x)/6,(-S[0].y+6*S[1].y+S[2].y)/6,(S[1].x+6*S[2].x-S[3].x)/6,(S[1].y+6*S[2].y-S[3].y)/6,S[2].x,S[2].y])}return bW}bq.parsePathString=function(g){if(!g){return null}var R=a0(g);if(R.arr){return a6(R.arr)}var S={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},E=[];if(bq.is(g,F)&&bq.is(g[0],F)){E=a6(g)}if(!E.length){q(g).replace(bo,function(bX,bW,b0){var bZ=[],bY=bW.toLowerCase();b0.replace(az,function(b2,b1){b1&&bZ.push(+b1)});if(bY=="m"&&bZ.length>2){E.push([bW][aE](bZ.splice(0,2)));bY="l";bW=bW=="m"?"l":"L"}if(bY=="r"){E.push([bW][aE](bZ))}else{while(bZ.length>=S[bY]){E.push([bW][aE](bZ.splice(0,S[bY])));if(!S[bY]){break}}}})}E.toString=bq._path2string;R.arr=a6(E);return E};bq.parseTransformString=T(function(E){if(!E){return null}var R={r:3,s:4,t:2,m:6},g=[];if(bq.is(E,F)&&bq.is(E[0],F)){g=a6(E)}if(!g.length){q(E).replace(am,function(bW,S,bZ){var bY=[],bX=au.call(S);bZ.replace(az,function(b1,b0){b0&&bY.push(+b0)});g.push([S][aE](bY))})}g.toString=bq._path2string;return g});var a0=function(E){var g=a0.ps=a0.ps||{};if(g[E]){g[E].sleep=100}else{g[E]={sleep:100}}setTimeout(function(){for(var R in g){if(g[bE](R)&&R!=E){g[R].sleep--;!g[R].sleep&&delete g[R]}}});return g[E]};bq.findDotsAtSegment=function(E,g,cg,ce,bY,bW,b1,bZ,b9){var b6=1-b9,cb=a1(b6,3),cc=a1(b6,2),b3=b9*b9,b0=b3*b9,b5=cb*E+cc*3*b9*cg+b6*3*b9*b9*bY+b0*b1,b2=cb*g+cc*3*b9*ce+b6*3*b9*b9*bW+b0*bZ,ca=E+2*b9*(cg-E)+b3*(bY-2*cg+E),b8=g+2*b9*(ce-g)+b3*(bW-2*ce+g),cf=cg+2*b9*(bY-cg)+b3*(b1-2*bY+cg),cd=ce+2*b9*(bW-ce)+b3*(bZ-2*bW+ce),b7=b6*E+b9*cg,b4=b6*g+b9*ce,S=b6*bY+b9*b1,R=b6*bW+b9*bZ,bX=(90-aR.atan2(ca-cf,b8-cd)*180/aq);(ca>cf||b8<cd)&&(bX+=180);return{x:b5,y:b2,m:{x:ca,y:b8},n:{x:cf,y:cd},start:{x:b7,y:b4},end:{x:S,y:R},alpha:bX}};bq.bezierBBox=function(E,g,S,R,b0,bY,bX,bW){if(!bq.is(E,"array")){E=[E,g,S,R,b0,bY,bX,bW]}var bZ=a5.apply(null,E);return{x:bZ.min.x,y:bZ.min.y,x2:bZ.max.x,y2:bZ.max.y,width:bZ.max.x-bZ.min.x,height:bZ.max.y-bZ.min.y}};bq.isPointInsideBBox=function(E,g,R){return g>=E.x&&g<=E.x2&&R>=E.y&&R<=E.y2};bq.isBBoxIntersect=function(R,E){var g=bq.isPointInsideBBox;return g(E,R.x,R.y)||g(E,R.x2,R.y)||g(E,R.x,R.y2)||g(E,R.x2,R.y2)||g(R,E.x,E.y)||g(R,E.x2,E.y)||g(R,E.x,E.y2)||g(R,E.x2,E.y2)||(R.x<E.x2&&R.x>E.x||E.x<R.x2&&E.x>R.x)&&(R.y<E.y2&&R.y>E.y||E.y<R.y2&&E.y>R.y)};function aL(g,bY,bX,bW,S){var R=-3*bY+9*bX-9*bW+3*S,E=g*R+6*bY-12*bX+6*bW;return g*E-3*bY+3*bX}function bj(b9,bW,b8,R,b7,E,b4,g,b1){if(b1==null){b1=1}b1=b1>1?1:b1<0?0:b1;var b2=b1/2,b3=12,bY=[-0.1252,0.1252,-0.3678,0.3678,-0.5873,0.5873,-0.7699,0.7699,-0.9041,0.9041,-0.9816,0.9816],b6=[0.2491,0.2491,0.2335,0.2335,0.2032,0.2032,0.1601,0.1601,0.1069,0.1069,0.0472,0.0472],S=0;for(var b5=0;b5<b3;b5++){var bZ=b2*bY[b5]+b2,b0=aL(bZ,b9,b8,b7,b4),ca=aL(bZ,bW,R,E,g),bX=b0*b0+ca*ca;S+=b6[b5]*aR.sqrt(bX)}return b2*S}function aT(R,b3,E,b2,g,b0,b5,bZ,b1){if(b1<0||bj(R,b3,E,b2,g,b0,b5,bZ)<b1){return}var b4=1,S=b4/2,bX=b4-S,bW,bY=0.01;bW=bj(R,b3,E,b2,g,b0,b5,bZ,bX);while(av(bW-b1)>bY){S/=2;bX+=(bW<b1?1:-1)*S;bW=bj(R,b3,E,b2,g,b0,b5,bZ,bX)}return bX}function bc(S,b4,R,b2,g,b1,b6,b0){if(bQ(S,R)<at(g,b6)||at(S,R)>bQ(g,b6)||bQ(b4,b2)<at(b1,b0)||at(b4,b2)>bQ(b1,b0)){return}var bZ=(S*b2-b4*R)*(g-b6)-(S-R)*(g*b0-b1*b6),bY=(S*b2-b4*R)*(b1-b0)-(b4-b2)*(g*b0-b1*b6),bW=(S-R)*(b1-b0)-(b4-b2)*(g-b6);if(!bW){return}var b5=bZ/bW,b3=bY/bW,bX=+b5.toFixed(2),E=+b3.toFixed(2);if(bX<+at(S,R).toFixed(2)||bX>+bQ(S,R).toFixed(2)||bX<+at(g,b6).toFixed(2)||bX>+bQ(g,b6).toFixed(2)||E<+at(b4,b2).toFixed(2)||E>+bQ(b4,b2).toFixed(2)||E<+at(b1,b0).toFixed(2)||E>+bQ(b1,b0).toFixed(2)){return}return{x:b5,y:b3}}function a3(E,g){return aY(E,g)}function aU(E,g){return aY(E,g,1)}function aY(cf,ce,cd){var S=bq.bezierBBox(cf),E=bq.bezierBBox(ce);if(!bq.isBBoxIntersect(S,E)){return cd?0:[]}var b8=bj.apply(0,cf),b7=bj.apply(0,ce),bZ=bQ(~~(b8/5),1),bY=bQ(~~(b7/5),1),b5=[],b4=[],R={},cg=cd?0:[];for(var ca=0;ca<bZ+1;ca++){var b6=bq.findDotsAtSegment.apply(bq,cf.concat(ca/bZ));b5.push({x:b6.x,y:b6.y,t:ca/bZ})}for(ca=0;ca<bY+1;ca++){b6=bq.findDotsAtSegment.apply(bq,ce.concat(ca/bY));b4.push({x:b6.x,y:b6.y,t:ca/bY})}for(ca=0;ca<bZ;ca++){for(var b9=0;b9<bY;b9++){var cc=b5[ca],g=b5[ca+1],cb=b4[b9],bX=b4[b9+1],b3=av(g.x-cc.x)<0.001?"y":"x",b2=av(bX.x-cb.x)<0.001?"y":"x",bW=bc(cc.x,cc.y,g.x,g.y,cb.x,cb.y,bX.x,bX.y);if(bW){if(R[bW.x.toFixed(4)]==bW.y.toFixed(4)){continue}R[bW.x.toFixed(4)]=bW.y.toFixed(4);var b1=cc.t+av((bW[b3]-cc[b3])/(g[b3]-cc[b3]))*(g.t-cc.t),b0=cb.t+av((bW[b2]-cb[b2])/(bX[b2]-cb[b2]))*(bX.t-cb.t);if(b1>=0&&b1<=1.001&&b0>=0&&b0<=1.001){if(cd){cg++}else{cg.push({x:bW.x,y:bW.y,t1:at(b1,1),t2:at(b0,1)})}}}}}return cg}bq.pathIntersection=function(E,g){return bM(E,g)};bq.pathIntersectionNumber=function(E,g){return bM(E,g,1)};function bM(R,g,b9){R=bq._path2curve(R);g=bq._path2curve(g);var b7,bX,b6,S,b4,bY,E,b1,cd,cc,ce=b9?0:[];for(var b5=0,bZ=R.length;b5<bZ;b5++){var cb=R[b5];if(cb[0]=="M"){b7=b4=cb[1];bX=bY=cb[2]}else{if(cb[0]=="C"){cd=[b7,bX].concat(cb.slice(1));b7=cd[6];bX=cd[7]}else{cd=[b7,bX,b7,bX,b4,bY,b4,bY];b7=b4;bX=bY}for(var b3=0,b8=g.length;b3<b8;b3++){var ca=g[b3];if(ca[0]=="M"){b6=E=ca[1];S=b1=ca[2]}else{if(ca[0]=="C"){cc=[b6,S].concat(ca.slice(1));b6=cc[6];S=cc[7]}else{cc=[b6,S,b6,S,E,b1,E,b1];b6=E;S=b1}var b0=aY(cd,cc,b9);if(b9){ce+=b0}else{for(var b2=0,bW=b0.length;b2<bW;b2++){b0[b2].segment1=b5;b0[b2].segment2=b3;b0[b2].bez1=cd;b0[b2].bez2=cc}ce=ce.concat(b0)}}}}}return ce}bq.isPointInsidePath=function(E,g,S){var R=bq.pathBBox(E);return bq.isPointInsideBBox(R,g,S)&&bM(E,[["M",g,S],["H",R.x2+10]],1)%2==1};bq._removedFactory=function(g){return function(){bk("raphael.log",null,"Rapha\xebl: you are calling to method \u201c"+g+"\u201d of removed object",g)}};var U=bq.pathBBox=function(b8){var b1=a0(b8);if(b1.bbox){return bt(b1.bbox)}if(!b8){return{x:0,y:0,width:0,height:0,x2:0,y2:0}}b8=bs(b8);var b4=0,b3=0,bX=[],R=[],S;for(var bZ=0,b7=b8.length;bZ<b7;bZ++){S=b8[bZ];if(S[0]=="M"){b4=S[1];b3=S[2];bX.push(b4);R.push(b3)}else{var b0=a5(b4,b3,S[1],S[2],S[3],S[4],S[5],S[6]);bX=bX[aE](b0.min.x,b0.max.x);R=R[aE](b0.min.y,b0.max.y);b4=S[5];b3=S[6]}}var g=at[bA](0,bX),b5=at[bA](0,R),bY=bQ[bA](0,bX),bW=bQ[bA](0,R),E=bY-g,b6=bW-b5,b2={x:g,y:b5,x2:bY,y2:bW,width:E,height:b6,cx:g+E/2,cy:b5+b6/2};b1.bbox=bt(b2);return b2},a6=function(E){var g=bt(E);g.toString=bq._path2string;return g},o=bq._pathToRelative=function(S){var bZ=a0(S);if(bZ.rel){return a6(bZ.rel)}if(!bq.is(S,F)||!bq.is(S&&S[0],F)){S=bq.parsePathString(S)}var b2=[],b4=0,b3=0,b7=0,b6=0,R=0;if(S[0][0]=="M"){b4=S[0][1];b3=S[0][2];b7=b4;b6=b3;R++;b2.push(["M",b4,b3])}for(var bY=R,b8=S.length;bY<b8;bY++){var g=b2[bY]=[],b5=S[bY];if(b5[0]!=au.call(b5[0])){g[0]=au.call(b5[0]);switch(g[0]){case"a":g[1]=b5[1];g[2]=b5[2];g[3]=b5[3];g[4]=b5[4];g[5]=b5[5];g[6]=+(b5[6]-b4).toFixed(3);g[7]=+(b5[7]-b3).toFixed(3);break;case"v":g[1]=+(b5[1]-b3).toFixed(3);break;case"m":b7=b5[1];b6=b5[2];default:for(var bX=1,b0=b5.length;bX<b0;bX++){g[bX]=+(b5[bX]-((bX%2)?b4:b3)).toFixed(3)}}}else{g=b2[bY]=[];if(b5[0]=="m"){b7=b5[1]+b4;b6=b5[2]+b3}for(var bW=0,E=b5.length;bW<E;bW++){b2[bY][bW]=b5[bW]}}var b1=b2[bY].length;switch(b2[bY][0]){case"z":b4=b7;b3=b6;break;case"h":b4+=+b2[bY][b1-1];break;case"v":b3+=+b2[bY][b1-1];break;default:b4+=+b2[bY][b1-2];b3+=+b2[bY][b1-1]}}b2.toString=bq._path2string;bZ.rel=a6(b2);return b2},x=bq._pathToAbsolute=function(b3){var R=a0(b3);if(R.abs){return a6(R.abs)}if(!bq.is(b3,F)||!bq.is(b3&&b3[0],F)){b3=bq.parsePathString(b3)}if(!b3||!b3.length){return[["M",0,0]]}var b9=[],bY=0,bX=0,b1=0,b0=0,S=0;if(b3[0][0]=="M"){bY=+b3[0][1];bX=+b3[0][2];b1=bY;b0=bX;S++;b9[0]=["M",bY,bX]}var b8=b3.length==3&&b3[0][0]=="M"&&b3[1][0].toUpperCase()=="R"&&b3[2][0].toUpperCase()=="Z";for(var b2,g,b6=S,bZ=b3.length;b6<bZ;b6++){b9.push(b2=[]);g=b3[b6];if(g[0]!=a2.call(g[0])){b2[0]=a2.call(g[0]);switch(b2[0]){case"A":b2[1]=g[1];b2[2]=g[2];b2[3]=g[3];b2[4]=g[4];b2[5]=g[5];b2[6]=+(g[6]+bY);b2[7]=+(g[7]+bX);break;case"V":b2[1]=+g[1]+bX;break;case"H":b2[1]=+g[1]+bY;break;case"R":var bW=[bY,bX][aE](g.slice(1));for(var b5=2,b7=bW.length;b5<b7;b5++){bW[b5]=+bW[b5]+bY;bW[++b5]=+bW[b5]+bX}b9.pop();b9=b9[aE](aw(bW,b8));break;case"M":b1=+g[1]+bY;b0=+g[2]+bX;default:for(b5=1,b7=g.length;b5<b7;b5++){b2[b5]=+g[b5]+((b5%2)?bY:bX)}}}else{if(g[0]=="R"){bW=[bY,bX][aE](g.slice(1));b9.pop();b9=b9[aE](aw(bW,b8));b2=["R"][aE](g.slice(-2))}else{for(var b4=0,E=g.length;b4<E;b4++){b2[b4]=g[b4]}}}switch(b2[0]){case"Z":bY=b1;bX=b0;break;case"H":bY=b2[1];break;case"V":bX=b2[1];break;case"M":b1=b2[b2.length-2];b0=b2[b2.length-1];default:bY=b2[b2.length-2];bX=b2[b2.length-1]}}b9.toString=bq._path2string;R.abs=a6(b9);return b9},a4=function(E,S,g,R){return[E,S,g,R,g,R]},K=function(E,S,bY,bW,g,R){var bX=1/3,bZ=2/3;return[bX*E+bZ*bY,bX*S+bZ*bW,bX*g+bZ*bY,bX*R+bZ*bW,g,R]},al=function(b5,cC,ce,cc,b6,b0,S,b4,cB,b7){var cb=aq*120/180,g=aq/180*(+b6||0),ci=[],cf,cw=T(function(cy,cF,cx){var cE=cy*aR.cos(cx)-cF*aR.sin(cx),cD=cy*aR.sin(cx)+cF*aR.cos(cx);return{x:cE,y:cD}});if(!b7){cf=cw(b5,cC,-g);b5=cf.x;cC=cf.y;cf=cw(b4,cB,-g);b4=cf.x;cB=cf.y;var E=aR.cos(aq/180*b6),b2=aR.sin(aq/180*b6),ck=(b5-b4)/2,cj=(cC-cB)/2;var cu=(ck*ck)/(ce*ce)+(cj*cj)/(cc*cc);if(cu>1){cu=aR.sqrt(cu);ce=cu*ce;cc=cu*cc}var R=ce*ce,cn=cc*cc,cp=(b0==S?-1:1)*aR.sqrt(av((R*cn-R*cj*cj-cn*ck*ck)/(R*cj*cj+cn*ck*ck))),b9=cp*ce*cj/cc+(b5+b4)/2,b8=cp*-cc*ck/ce+(cC+cB)/2,bZ=aR.asin(((cC-b8)/cc).toFixed(9)),bY=aR.asin(((cB-b8)/cc).toFixed(9));bZ=b5<b9?aq-bZ:bZ;bY=b4<b9?aq-bY:bY;bZ<0&&(bZ=aq*2+bZ);bY<0&&(bY=aq*2+bY);if(S&&bZ>bY){bZ=bZ-aq*2}if(!S&&bY>bZ){bY=bY-aq*2}}else{bZ=b7[0];bY=b7[1];b9=b7[2];b8=b7[3]}var b3=bY-bZ;if(av(b3)>cb){var ca=bY,cd=b4,b1=cB;bY=bZ+cb*(S&&bY>bZ?1:-1);b4=b9+ce*aR.cos(bY);cB=b8+cc*aR.sin(bY);ci=al(b4,cB,ce,cc,b6,0,S,cd,b1,[bY,ca,b9,b8])}b3=bY-bZ;var bX=aR.cos(bZ),cA=aR.sin(bZ),bW=aR.cos(bY),cz=aR.sin(bY),cl=aR.tan(b3/4),co=4/3*ce*cl,cm=4/3*cc*cl,cv=[b5,cC],ct=[b5+co*cA,cC-cm*bX],cs=[b4+co*cz,cB-cm*bW],cq=[b4,cB];ct[0]=2*cv[0]-ct[0];ct[1]=2*cv[1]-ct[1];if(b7){return[ct,cs,cq][aE](ci)}else{ci=[ct,cs,cq][aE](ci).join()[r](",");var cg=[];for(var cr=0,ch=ci.length;cr<ch;cr++){cg[cr]=cr%2?cw(ci[cr-1],ci[cr],g).y:cw(ci[cr],ci[cr+1],g).x}return cg}},bT=function(E,g,S,R,b0,bZ,bY,bX,b1){var bW=1-b1;return{x:a1(bW,3)*E+a1(bW,2)*3*b1*S+bW*3*b1*b1*b0+a1(b1,3)*bY,y:a1(bW,3)*g+a1(bW,2)*3*b1*R+bW*3*b1*b1*bZ+a1(b1,3)*bX}},a5=T(function(R,g,bW,S,b7,b6,b3,b0){var b5=(b7-2*bW+R)-(b3-2*b7+bW),b2=2*(bW-R)-2*(b7-bW),bZ=R-bW,bY=(-b2+aR.sqrt(b2*b2-4*b5*bZ))/2/b5,bX=(-b2-aR.sqrt(b2*b2-4*b5*bZ))/2/b5,b1=[g,b0],b4=[R,b3],E;av(bY)>"1e12"&&(bY=0.5);av(bX)>"1e12"&&(bX=0.5);if(bY>0&&bY<1){E=bT(R,g,bW,S,b7,b6,b3,b0,bY);b4.push(E.x);b1.push(E.y)}if(bX>0&&bX<1){E=bT(R,g,bW,S,b7,b6,b3,b0,bX);b4.push(E.x);b1.push(E.y)}b5=(b6-2*S+g)-(b0-2*b6+S);b2=2*(S-g)-2*(b6-S);bZ=g-S;bY=(-b2+aR.sqrt(b2*b2-4*b5*bZ))/2/b5;bX=(-b2-aR.sqrt(b2*b2-4*b5*bZ))/2/b5;av(bY)>"1e12"&&(bY=0.5);av(bX)>"1e12"&&(bX=0.5);if(bY>0&&bY<1){E=bT(R,g,bW,S,b7,b6,b3,b0,bY);b4.push(E.x);b1.push(E.y)}if(bX>0&&bX<1){E=bT(R,g,bW,S,b7,b6,b3,b0,bX);b4.push(E.x);b1.push(E.y)}return{min:{x:at[bA](0,b4),y:at[bA](0,b1)},max:{x:bQ[bA](0,b4),y:bQ[bA](0,b1)}}}),bs=bq._path2curve=T(function(b0,E){var bW=!E&&a0(b0);if(!E&&bW.curve){return a6(bW.curve)}var b1=x(b0),g=E&&x(E),b2={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},b9={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},b8=function(cf,cg,cd){var cc,ch,ce={T:1,Q:1};if(!cf){return["C",cg.x,cg.y,cg.x,cg.y,cg.x,cg.y]}!(cf[0] in ce)&&(cg.qx=cg.qy=null);switch(cf[0]){case"M":cg.X=cf[1];cg.Y=cf[2];break;case"A":cf=["C"][aE](al[bA](0,[cg.x,cg.y][aE](cf.slice(1))));break;case"S":if(cd=="C"||cd=="S"){cc=cg.x*2-cg.bx;ch=cg.y*2-cg.by}else{cc=cg.x;ch=cg.y}cf=["C",cc,ch][aE](cf.slice(1));break;case"T":if(cd=="Q"||cd=="T"){cg.qx=cg.x*2-cg.qx;cg.qy=cg.y*2-cg.qy}else{cg.qx=cg.x;cg.qy=cg.y}cf=["C"][aE](K(cg.x,cg.y,cg.qx,cg.qy,cf[1],cf[2]));break;case"Q":cg.qx=cf[1];cg.qy=cf[2];cf=["C"][aE](K(cg.x,cg.y,cf[1],cf[2],cf[3],cf[4]));break;case"L":cf=["C"][aE](a4(cg.x,cg.y,cf[1],cf[2]));break;case"H":cf=["C"][aE](a4(cg.x,cg.y,cf[1],cg.y));break;case"V":cf=["C"][aE](a4(cg.x,cg.y,cg.x,cf[1]));break;case"Z":cf=["C"][aE](a4(cg.x,cg.y,cg.X,cg.Y));break}return cf},b6=function(cc,cd){if(cc[cd].length>7){cc[cd].shift();var ce=cc[cd];while(ce.length){b5[cd]="A";g&&(b3[cd]="A");cc.splice(cd++,0,["C"][aE](ce.splice(0,6)))}cc.splice(cd,1);bY=bQ(b1.length,g&&g.length||0)}},bX=function(cg,cf,cd,cc,ce){if(cg&&cf&&cg[ce][0]=="M"&&cf[ce][0]!="M"){cf.splice(ce,0,["M",cc.x,cc.y]);cd.bx=0;cd.by=0;cd.x=cg[ce][1];cd.y=cg[ce][2];bY=bQ(b1.length,g&&g.length||0)}},b5=[],b3=[],R="",ca="";for(var b4=0,bY=bQ(b1.length,g&&g.length||0);b4<bY;b4++){b1[b4]&&(R=b1[b4][0]);if(R!="C"){b5[b4]=R;b4&&(ca=b5[b4-1])}b1[b4]=b8(b1[b4],b2,ca);if(b5[b4]!="A"&&R=="C"){b5[b4]="C"}b6(b1,b4);if(g){g[b4]&&(R=g[b4][0]);if(R!="C"){b3[b4]=R;b4&&(ca=b3[b4-1])}g[b4]=b8(g[b4],b9,ca);if(b3[b4]!="A"&&R=="C"){b3[b4]="C"}b6(g,b4)}bX(b1,g,b2,b9,b4);bX(g,b1,b9,b2,b4);var b7=b1[b4],cb=g&&g[b4],bZ=b7.length,S=g&&cb.length;b2.x=b7[bZ-2];b2.y=b7[bZ-1];b2.bx=bU(b7[bZ-4])||b2.x;b2.by=bU(b7[bZ-3])||b2.y;b9.bx=g&&(bU(cb[S-4])||b9.x);b9.by=g&&(bU(cb[S-3])||b9.y);b9.x=g&&cb[S-2];b9.y=g&&cb[S-1]}if(!g){bW.curve=a6(b1)}return g?[b1,g]:b1},null,a6),bi=bq._parseDots=T(function(b0){var bZ=[];for(var bW=0,b1=b0.length;bW<b1;bW++){var g={},bY=b0[bW].match(/^([^:]*):?([\d\.]*)/);g.color=bq.getRGB(bY[1]);if(g.color.error){return null}g.opacity=g.color.opacity;g.color=g.color.hex;bY[2]&&(g.offset=bY[2]+"%");bZ.push(g)}for(bW=1,b1=bZ.length-1;bW<b1;bW++){if(!bZ[bW].offset){var E=bU(bZ[bW-1].offset||0),R=0;for(var S=bW+1;S<b1;S++){if(bZ[S].offset){R=bZ[S].offset;break}}if(!R){R=100;S=b1}R=bU(R);var bX=(R-E)/(S-bW+1);for(;bW<S;bW++){E+=bX;bZ[bW].offset=E+"%"}}}return bZ}),aQ=bq._tear=function(g,E){g==E.top&&(E.top=g.prev);g==E.bottom&&(E.bottom=g.next);g.next&&(g.next.prev=g.prev);g.prev&&(g.prev.next=g.next)},X=bq._tofront=function(g,E){if(E.top===g){return}aQ(g,E);g.next=null;g.prev=E.top;E.top.next=g;E.top=g},J=bq._toback=function(g,E){if(E.bottom===g){return}aQ(g,E);g.next=E.bottom;g.prev=null;E.bottom.prev=g;E.bottom=g},aB=bq._insertafter=function(E,g,R){aQ(E,R);g==R.top&&(R.top=E);g.next&&(g.next.prev=E);E.next=g.next;E.prev=g;g.next=E},s=bq._insertbefore=function(E,g,R){aQ(E,R);g==R.bottom&&(R.bottom=E);g.prev&&(g.prev.next=E);E.prev=g.prev;g.prev=E;E.next=g},D=bq.toMatrix=function(R,g){var S=U(R),E={_:{transform:bv},getBBox:function(){return S}};ah(E,g);return E.matrix},aH=bq.transformPath=function(E,g){return ac(E,D(E,g))},ah=bq._extractTransform=function(E,cc){if(cc==null){return E._.transform}cc=q(cc).replace(/\.{3}|\u2026/g,E._.transform||bv);var b4=bq.parseTransformString(cc),b2=0,b0=0,bZ=0,b6=1,b5=1,cd=E._,b7=new bh;cd.transform=b4||[];if(b4){for(var b8=0,b1=b4.length;b8<b1;b8++){var b3=b4[b8],g=b3.length,bW=q(b3[0]).toLowerCase(),cb=b3[0]!=bW,bY=cb?b7.invert():0,ca,S,b9,R,bX;if(bW=="t"&&g==3){if(cb){ca=bY.x(0,0);S=bY.y(0,0);b9=bY.x(b3[1],b3[2]);R=bY.y(b3[1],b3[2]);b7.translate(b9-ca,R-S)}else{b7.translate(b3[1],b3[2])}}else{if(bW=="r"){if(g==2){bX=bX||E.getBBox(1);b7.rotate(b3[1],bX.x+bX.width/2,bX.y+bX.height/2);b2+=b3[1]}else{if(g==4){if(cb){b9=bY.x(b3[2],b3[3]);R=bY.y(b3[2],b3[3]);b7.rotate(b3[1],b9,R)}else{b7.rotate(b3[1],b3[2],b3[3])}b2+=b3[1]}}}else{if(bW=="s"){if(g==2||g==3){bX=bX||E.getBBox(1);b7.scale(b3[1],b3[g-1],bX.x+bX.width/2,bX.y+bX.height/2);b6*=b3[1];b5*=b3[g-1]}else{if(g==5){if(cb){b9=bY.x(b3[3],b3[4]);R=bY.y(b3[3],b3[4]);b7.scale(b3[1],b3[2],b9,R)}else{b7.scale(b3[1],b3[2],b3[3],b3[4])}b6*=b3[1];b5*=b3[2]}}}else{if(bW=="m"&&g==7){b7.add(b3[1],b3[2],b3[3],b3[4],b3[5],b3[6])}}}}cd.dirtyT=1;E.matrix=b7}}E.matrix=b7;cd.sx=b6;cd.sy=b5;cd.deg=b2;cd.dx=b0=b7.e;cd.dy=bZ=b7.f;if(b6==1&&b5==1&&!b2&&cd.bbox){cd.bbox.x+=+b0;cd.bbox.y+=+bZ}else{cd.dirtyT=1}},w=function(E){var g=E[0];switch(g.toLowerCase()){case"t":return[g,0,0];case"m":return[g,1,0,0,1,0,0];case"r":if(E.length==4){return[g,0,E[2],E[3]]}else{return[g,0]}case"s":if(E.length==5){return[g,1,1,E[3],E[4]]}else{if(E.length==3){return[g,1,1]}else{return[g,1]}}}},bl=bq._equaliseTransform=function(bW,S){S=q(S).replace(/\.{3}|\u2026/g,bW);bW=bq.parseTransformString(bW)||[];S=bq.parseTransformString(S)||[];var g=bQ(bW.length,S.length),b0=[],b1=[],R=0,E,bX,bZ,bY;for(;R<g;R++){bZ=bW[R]||w(S[R]);bY=S[R]||w(bZ);if((bZ[0]!=bY[0])||(bZ[0].toLowerCase()=="r"&&(bZ[2]!=bY[2]||bZ[3]!=bY[3]))||(bZ[0].toLowerCase()=="s"&&(bZ[3]!=bY[3]||bZ[4]!=bY[4]))){return}b0[R]=[];b1[R]=[];for(E=0,bX=bQ(bZ.length,bY.length);E<bX;E++){E in bZ&&(b0[R][E]=bZ[E]);E in bY&&(b1[R][E]=bY[E])}}return{from:b0,to:b1}};bq._getContainer=function(g,bW,R,S){var E;E=S==null&&!bq.is(g,"object")?bd.doc.getElementById(g):g;if(E==null){return}if(E.tagName){if(bW==null){return{container:E,width:E.style.pixelWidth||E.offsetWidth,height:E.style.pixelHeight||E.offsetHeight}}else{return{container:E,width:bW,height:R}}}return{container:1,x:g,y:bW,width:R,height:S}};bq.pathToRelative=o;bq._engine={};bq.path2curve=bs;bq.matrix=function(E,g,bX,bW,S,R){return new bh(E,g,bX,bW,S,R)};function bh(E,g,bX,bW,S,R){if(E!=null){this.a=+E;this.b=+g;this.c=+bX;this.d=+bW;this.e=+S;this.f=+R}else{this.a=1;this.b=0;this.c=0;this.d=1;this.e=0;this.f=0}}(function(R){R.add=function(b7,b4,b2,b0,bY,bX){var bW=[[],[],[]],S=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],b6=[[b7,b2,bY],[b4,b0,bX],[0,0,1]],b5,b3,b1,bZ;if(b7&&b7 instanceof bh){b6=[[b7.a,b7.c,b7.e],[b7.b,b7.d,b7.f],[0,0,1]]}for(b5=0;b5<3;b5++){for(b3=0;b3<3;b3++){bZ=0;for(b1=0;b1<3;b1++){bZ+=S[b5][b1]*b6[b1][b3]}bW[b5][b3]=bZ}}this.a=bW[0][0];this.b=bW[1][0];this.c=bW[0][1];this.d=bW[1][1];this.e=bW[0][2];this.f=bW[1][2]};R.invert=function(){var bW=this,S=bW.a*bW.d-bW.b*bW.c;return new bh(bW.d/S,-bW.b/S,-bW.c/S,bW.a/S,(bW.c*bW.f-bW.d*bW.e)/S,(bW.b*bW.e-bW.a*bW.f)/S)};R.clone=function(){return new bh(this.a,this.b,this.c,this.d,this.e,this.f)};R.translate=function(S,bW){this.add(1,0,0,1,S,bW)};R.scale=function(bW,bY,S,bX){bY==null&&(bY=bW);(S||bX)&&this.add(1,0,0,1,S,bX);this.add(bW,0,0,bY,0,0);(S||bX)&&this.add(1,0,0,1,-S,-bX)};R.rotate=function(bW,S,bZ){bW=bq.rad(bW);S=S||0;bZ=bZ||0;var bY=+aR.cos(bW).toFixed(9),bX=+aR.sin(bW).toFixed(9);this.add(bY,bX,-bX,bY,S,bZ);this.add(1,0,0,1,-S,-bZ)};R.x=function(S,bW){return S*this.a+bW*this.c+this.e};R.y=function(S,bW){return S*this.b+bW*this.d+this.f};R.get=function(S){return +this[q.fromCharCode(97+S)].toFixed(4)};R.toString=function(){return bq.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()};R.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"};R.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]};function E(S){return S[0]*S[0]+S[1]*S[1]}function g(S){var bW=aR.sqrt(E(S));S[0]&&(S[0]/=bW);S[1]&&(S[1]/=bW)}R.split=function(){var bW={};bW.dx=this.e;bW.dy=this.f;var bY=[[this.a,this.c],[this.b,this.d]];bW.scalex=aR.sqrt(E(bY[0]));g(bY[0]);bW.shear=bY[0][0]*bY[1][0]+bY[0][1]*bY[1][1];bY[1]=[bY[1][0]-bY[0][0]*bW.shear,bY[1][1]-bY[0][1]*bW.shear];bW.scaley=aR.sqrt(E(bY[1]));g(bY[1]);bW.shear/=bW.scaley;var S=-bY[0][1],bX=bY[1][1];if(bX<0){bW.rotate=bq.deg(aR.acos(bX));if(S<0){bW.rotate=360-bW.rotate}}else{bW.rotate=bq.deg(aR.asin(S))}bW.isSimple=!+bW.shear.toFixed(9)&&(bW.scalex.toFixed(9)==bW.scaley.toFixed(9)||!bW.rotate);bW.isSuperSimple=!+bW.shear.toFixed(9)&&bW.scalex.toFixed(9)==bW.scaley.toFixed(9)&&!bW.rotate;bW.noRotation=!+bW.shear.toFixed(9)&&!bW.rotate;return bW};R.toTransformString=function(S){var bW=S||this[r]();if(bW.isSimple){bW.scalex=+bW.scalex.toFixed(4);bW.scaley=+bW.scaley.toFixed(4);bW.rotate=+bW.rotate.toFixed(4);return(bW.dx||bW.dy?"t"+[bW.dx,bW.dy]:bv)+(bW.scalex!=1||bW.scaley!=1?"s"+[bW.scalex,bW.scaley,0,0]:bv)+(bW.rotate?"r"+[bW.rotate,0,0]:bv)}else{return"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}})(bh.prototype);var bL=function(){this.returnValue=false},u=function(){return this.originalEvent.preventDefault()},aS=function(){this.cancelBubble=true},af=function(){return this.originalEvent.stopPropagation()},ao=function(E){var g=bd.doc.documentElement.scrollTop||bd.doc.body.scrollTop,R=bd.doc.documentElement.scrollLeft||bd.doc.body.scrollLeft;return{x:E.clientX+R,y:E.clientY+g}},P=(function(){if(bd.doc.addEventListener){return function(bW,R,E,g){var S=function(bY){var bZ=ao(bY);return E.call(g,bY,bZ.x,bZ.y)};bW.addEventListener(R,S,false);if(aa&&bx[R]){var bX=function(b1){var b2=ao(b1),bZ=b1;for(var bY=0,b0=b1.targetTouches&&b1.targetTouches.length;bY<b0;bY++){if(b1.targetTouches[bY].target==bW){b1=b1.targetTouches[bY];b1.originalEvent=bZ;b1.preventDefault=u;b1.stopPropagation=af;break}}return E.call(g,b1,b2.x,b2.y)};bW.addEventListener(bx[R],bX,false)}return function(){bW.removeEventListener(R,S,false);if(aa&&bx[R]){bW.removeEventListener(bx[R],bX,false)}return true}}}else{if(bd.doc.attachEvent){return function(bX,S,R,E){var bW=function(b0){b0=b0||bd.win.event;var bZ=bd.doc.documentElement.scrollTop||bd.doc.body.scrollTop,b1=bd.doc.documentElement.scrollLeft||bd.doc.body.scrollLeft,bY=b0.clientX+b1,b2=b0.clientY+bZ;b0.preventDefault=b0.preventDefault||bL;b0.stopPropagation=b0.stopPropagation||aS;return R.call(E,b0,bY,b2)};bX.attachEvent("on"+S,bW);var g=function(){bX.detachEvent("on"+S,bW);return true};return g}}}})(),aJ=[],bz=function(bZ){var b2=bZ.clientX,b1=bZ.clientY,b4=bd.doc.documentElement.scrollTop||bd.doc.body.scrollTop,b5=bd.doc.documentElement.scrollLeft||bd.doc.body.scrollLeft,R,S=aJ.length;while(S--){R=aJ[S];if(aa&&bZ.touches){var bX=bZ.touches.length,bW;while(bX--){bW=bZ.touches[bX];if(bW.identifier==R.el._drag.id){b2=bW.clientX;b1=bW.clientY;(bZ.originalEvent?bZ.originalEvent:bZ).preventDefault();break}}}else{bZ.preventDefault()}var E=R.el.node,g,bY=E.nextSibling,b3=E.parentNode,b0=E.style.display;bd.win.opera&&b3.removeChild(E);E.style.display="none";g=R.el.paper.getElementByPoint(b2,b1);E.style.display=b0;bd.win.opera&&(bY?b3.insertBefore(E,bY):b3.appendChild(E));g&&bk("raphael.drag.over."+R.el.id,R.el,g);b2+=b5;b1+=b4;bk("raphael.drag.move."+R.el.id,R.move_scope||R.el,b2-R.el._drag.x,b1-R.el._drag.y,b2,b1,bZ)}},l=function(R){bq.unmousemove(bz).unmouseup(l);var E=aJ.length,g;while(E--){g=aJ[E];g.el._drag={};bk("raphael.drag.end."+g.el.id,g.end_scope||g.start_scope||g.move_scope||g.el,R)}aJ=[]},aA=bq.el={};for(var bb=bJ.length;bb--;){(function(g){bq[g]=aA[g]=function(R,E){if(bq.is(R,"function")){this.events=this.events||[];this.events.push({name:g,f:R,unbind:P(this.shape||this.node||bd.doc,g,R,E||this)})}return this};bq["un"+g]=aA["un"+g]=function(S){var R=this.events||[],E=R.length;while(E--){if(R[E].name==g&&(bq.is(S,"undefined")||R[E].f==S)){R[E].unbind();R.splice(E,1);!R.length&&delete this.events}}return this}})(bJ[bb])}aA.data=function(E,S){var R=Y[this.id]=Y[this.id]||{};if(arguments.length==0){return R}if(arguments.length==1){if(bq.is(E,"object")){for(var g in E){if(E[bE](g)){this.data(g,E[g])}}return this}bk("raphael.data.get."+this.id,this,R[E],E);return R[E]}R[E]=S;bk("raphael.data.set."+this.id,this,S,E);return this};aA.removeData=function(g){if(g==null){Y[this.id]={}}else{Y[this.id]&&delete Y[this.id][g]}return this};aA.getData=function(){return bt(Y[this.id]||{})};aA.hover=function(S,g,R,E){return this.mouseover(S,R).mouseout(g,E||R)};aA.unhover=function(E,g){return this.unmouseover(E).unmouseout(g)};var ar=[];aA.drag=function(E,bX,bW,g,R,S){function bY(b2){if(("which" in b2)?(b2.which==2||b2.which==3):(b2.button==4||b2.button==2)){return}(b2.originalEvent||b2).preventDefault();var bZ=b2.clientX,b5=b2.clientY,b1=bd.doc.documentElement.scrollTop||bd.doc.body.scrollTop,b3=bd.doc.documentElement.scrollLeft||bd.doc.body.scrollLeft;this._drag.id=b2.identifier;if(aa&&b2.touches){var b0=b2.touches.length,b4;while(b0--){b4=b2.touches[b0];this._drag.id=b4.identifier;if(b4.identifier==this._drag.id){bZ=b4.clientX;b5=b4.clientY;break}}}this._drag.x=bZ+b3;this._drag.y=b5+b1;!aJ.length&&bq.mousemove(bz).mouseup(l);aJ.push({el:this,move_scope:g,start_scope:R,end_scope:S});bX&&bk.on("raphael.drag.start."+this.id,bX);E&&bk.on("raphael.drag.move."+this.id,E);bW&&bk.on("raphael.drag.end."+this.id,bW);bk("raphael.drag.start."+this.id,R||g||this,b2.clientX+b3,b2.clientY+b1,b2)}this._drag={};ar.push({el:this,start:bY});this.mousedown(bY);return this};aA.onDragOver=function(g){g?bk.on("raphael.drag.over."+this.id,g):bk.unbind("raphael.drag.over."+this.id)};aA.undrag=function(){var g=ar.length;while(g--){if(ar[g].el==this){this.unmousedown(ar[g].start);ar.splice(g,1);bk.unbind("raphael.drag.*."+this.id)}}!ar.length&&bq.unmousemove(bz).unmouseup(l);aJ=[]};ay.circle=function(g,S,R){var E=bq._engine.circle(this,g||0,S||0,R||0);this.__set__&&this.__set__.push(E);return E};ay.rect=function(g,bX,E,S,bW){var R=bq._engine.rect(this,g||0,bX||0,E||0,S||0,bW||0);this.__set__&&this.__set__.push(R);return R};ay.ellipse=function(g,bW,S,R){var E=bq._engine.ellipse(this,g||0,bW||0,S||0,R||0);this.__set__&&this.__set__.push(E);return E};ay.path=function(g){g&&!bq.is(g,f)&&!bq.is(g[0],F)&&(g+=bv);var E=bq._engine.path(bq.format[bA](bq,arguments),this);this.__set__&&this.__set__.push(E);return E};ay.image=function(bW,g,bX,E,S){var R=bq._engine.image(this,bW||"about:blank",g||0,bX||0,E||0,S||0);this.__set__&&this.__set__.push(R);return R};ay.text=function(g,S,R){var E=bq._engine.text(this,g||0,S||0,q(R));this.__set__&&this.__set__.push(E);return E};ay.set=function(E){!bq.is(E,"array")&&(E=Array.prototype.splice.call(arguments,0,arguments.length));var g=new ai(E);this.__set__&&this.__set__.push(g);g.paper=this;g.type="set";return g};ay.setStart=function(g){this.__set__=g||this.set()};ay.setFinish=function(E){var g=this.__set__;delete this.__set__;return g};ay.getSize=function(){var g=this.canvas.parentNode;return{width:g.offsetWidth,height:g.offsetHeight}};ay.setSize=function(E,g){return bq._engine.setSize.call(this,E,g)};ay.setViewBox=function(g,bW,E,S,R){return bq._engine.setViewBox.call(this,g,bW,E,S,R)};ay.top=ay.bottom=null;ay.raphael=bq;var bV=function(R){var bW=R.getBoundingClientRect(),b0=R.ownerDocument,bX=b0.body,g=b0.documentElement,S=g.clientTop||bX.clientTop||0,bY=g.clientLeft||bX.clientLeft||0,bZ=bW.top+(bd.win.pageYOffset||g.scrollTop||bX.scrollTop)-S,E=bW.left+(bd.win.pageXOffset||g.scrollLeft||bX.scrollLeft)-bY;return{y:bZ,x:E}};ay.getElementByPoint=function(E,bZ){var bY=this,R=bY.canvas,bX=bd.doc.elementFromPoint(E,bZ);if(bd.win.opera&&bX.tagName=="svg"){var bW=bV(R),S=R.createSVGRect();S.x=E-bW.x;S.y=bZ-bW.y;S.width=S.height=1;var g=R.getIntersectionList(S,null);if(g.length){bX=g[g.length-1]}}if(!bX){return null}while(bX.parentNode&&bX!=R.parentNode&&!bX.raphael){bX=bX.parentNode}bX==bY.canvas.parentNode&&(bX=R);bX=bX&&bX.raphael?bY.getById(bX.raphaelid):null;return bX};ay.getElementsByBBox=function(g){var E=this.set();this.forEach(function(R){if(bq.isBBoxIntersect(R.getBBox(),g)){E.push(R)}});return E};ay.getById=function(E){var g=this.bottom;while(g){if(g.id==E){return g}g=g.next}return null};ay.forEach=function(R,g){var E=this.bottom;while(E){if(R.call(g,E)===false){return this}E=E.next}return this};ay.getElementsByPoint=function(g,R){var E=this.set();this.forEach(function(S){if(S.isPointInside(g,R)){E.push(S)}});return E};function bF(){return this.x+bp+this.y}function be(){return this.x+bp+this.y+bp+this.width+" \xd7 "+this.height}aA.isPointInside=function(g,R){var E=this.realPath=ap[this.type](this);if(this.attr("transform")&&this.attr("transform").length){E=bq.transformPath(E,this.attr("transform"))}return bq.isPointInsidePath(E,g,R)};aA.getBBox=function(E){if(this.removed){return{}}var g=this._;if(E){if(g.dirty||!g.bboxwt){this.realPath=ap[this.type](this);g.bboxwt=U(this.realPath);g.bboxwt.toString=be;g.dirty=0}return g.bboxwt}if(g.dirty||g.dirtyT||!g.bbox){if(g.dirty||!this.realPath){g.bboxwt=0;this.realPath=ap[this.type](this)}g.bbox=U(ac(this.realPath,this.matrix));g.bbox.toString=be;g.dirty=g.dirtyT=0}return g.bbox};aA.clone=function(){if(this.removed){return null}var g=this.paper[this.type]().attr(this.attr());this.__set__&&this.__set__.push(g);return g};aA.glow=function(bY){if(this.type=="text"){return null}bY=bY||{};var R={width:(bY.width||10)+(+this.attr("stroke-width")||1),fill:bY.fill||false,opacity:bY.opacity==null?0.5:bY.opacity,offsetx:bY.offsetx||0,offsety:bY.offsety||0,color:bY.color||"#000"},bX=R.width/2,S=this.paper,g=S.set(),bW=this.realPath||ap[this.type](this);bW=this.matrix?ac(bW,this.matrix):bW;for(var E=1;E<bX+1;E++){g.push(S.path(bW).attr({stroke:R.color,fill:R.fill?R.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(R.width/bX*E).toFixed(3),opacity:+(R.opacity/bX).toFixed(3)}))}return g.insertBefore(this).translate(R.offsetx,R.offsety)};var a7={},aX=function(E,g,bW,S,b0,bZ,bY,bX,R){if(R==null){return bj(E,g,bW,S,b0,bZ,bY,bX)}else{return bq.findDotsAtSegment(E,g,bW,S,b0,bZ,bY,bX,aT(E,g,bW,S,b0,bZ,bY,bX,R))}},aM=function(g,E){return function(b6,bW,bX){b6=bs(b6);var b2,b1,R,bY,S="",b5={},b3,b0=0;for(var bZ=0,b4=b6.length;bZ<b4;bZ++){R=b6[bZ];if(R[0]=="M"){b2=+R[1];b1=+R[2]}else{bY=aX(b2,b1,R[1],R[2],R[3],R[4],R[5],R[6]);if(b0+bY>bW){if(E&&!b5.start){b3=aX(b2,b1,R[1],R[2],R[3],R[4],R[5],R[6],bW-b0);S+=["C"+b3.start.x,b3.start.y,b3.m.x,b3.m.y,b3.x,b3.y];if(bX){return S}b5.start=S;S=["M"+b3.x,b3.y+"C"+b3.n.x,b3.n.y,b3.end.x,b3.end.y,R[5],R[6]].join();b0+=bY;b2=+R[5];b1=+R[6];continue}if(!g&&!E){b3=aX(b2,b1,R[1],R[2],R[3],R[4],R[5],R[6],bW-b0);return{x:b3.x,y:b3.y,alpha:b3.alpha}}}b0+=bY;b2=+R[5];b1=+R[6]}S+=R.shift()+R}b5.end=S;b3=g?b0:E?b5:bq.findDotsAtSegment(b2,b1,R[0],R[1],R[2],R[3],R[4],R[5],1);b3.alpha&&(b3={x:b3.x,y:b3.y,alpha:b3.alpha});return b3}};var bO=aM(1),bG=aM(),aK=aM(0,1);bq.getTotalLength=bO;bq.getPointAtLength=bG;bq.getSubpath=function(E,S,R){if(this.getTotalLength(E)-R<0.000001){return aK(E,S).end}var g=aK(E,R,1);return S?aK(g,S).end:g};aA.getTotalLength=function(){var g=this.getPath();if(!g){return}if(this.node.getTotalLength){return this.node.getTotalLength()}return bO(g)};aA.getPointAtLength=function(g){var E=this.getPath();if(!E){return}return bG(E,g)};aA.getPath=function(){var E,g=bq._getPath[this.type];if(this.type=="text"||this.type=="set"){return}if(g){E=g(this)}return E};aA.getSubpath=function(R,E){var g=this.getPath();if(!g){return}return bq.getSubpath(g,R,E)};var aP=bq.easing_formulas={linear:function(g){return g},"<":function(g){return a1(g,1.7)},">":function(g){return a1(g,0.48)},"<>":function(bZ){var S=0.48-bZ/1.04,R=aR.sqrt(0.1734+S*S),g=R-S,bY=a1(av(g),1/3)*(g<0?-1:1),bX=-R-S,bW=a1(av(bX),1/3)*(bX<0?-1:1),E=bY+bW+0.5;return(1-E)*3*E*E+E*E*E},backIn:function(E){var g=1.70158;return E*E*((g+1)*E-g)},backOut:function(E){E=E-1;var g=1.70158;return E*E*((g+1)*E+g)+1},elastic:function(g){if(g==!!g){return g}return a1(2,-10*g)*aR.sin((g-0.075)*(2*aq)/0.3)+1},bounce:function(S){var E=7.5625,R=2.75,g;if(S<(1/R)){g=E*S*S}else{if(S<(2/R)){S-=(1.5/R);g=E*S*S+0.75}else{if(S<(2.5/R)){S-=(2.25/R);g=E*S*S+0.9375}else{S-=(2.625/R);g=E*S*S+0.984375}}}return g}};aP.easeIn=aP["ease-in"]=aP["<"];aP.easeOut=aP["ease-out"]=aP[">"];aP.easeInOut=aP["ease-in-out"]=aP["<>"];aP["back-in"]=aP.backIn;aP["back-out"]=aP.backOut;var bN=[],bP=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(g){setTimeout(g,16)},aC=function(){var bY=+new Date,b6=0;for(;b6<bN.length;b6++){var cc=bN[b6];if(cc.el.removed||cc.paused){continue}var S=bY-cc.start,b4=cc.ms,b3=cc.easing,b7=cc.from,b1=cc.diff,E=cc.to,b0=cc.t,bX=cc.el,b2={},g,ca={},ce;if(cc.initstatus){S=(cc.initstatus*cc.anim.top-cc.prev)/(cc.percent-cc.prev)*b4;cc.status=cc.initstatus;delete cc.initstatus;cc.stop&&bN.splice(b6--,1)}else{cc.status=(cc.prev+(cc.percent-cc.prev)*(S/b4))/cc.anim.top}if(S<0){continue}if(S<b4){var R=b3(S/b4);for(var b5 in b7){if(b7[bE](b5)){switch(bw[b5]){case br:g=+b7[b5]+R*b4*b1[b5];break;case"colour":g="rgb("+[a9(N(b7[b5].r+R*b4*b1[b5].r)),a9(N(b7[b5].g+R*b4*b1[b5].g)),a9(N(b7[b5].b+R*b4*b1[b5].b))].join(",")+")";break;case"path":g=[];for(var b9=0,bZ=b7[b5].length;b9<bZ;b9++){g[b9]=[b7[b5][b9][0]];for(var b8=1,cb=b7[b5][b9].length;b8<cb;b8++){g[b9][b8]=+b7[b5][b9][b8]+R*b4*b1[b5][b9][b8]}g[b9]=g[b9].join(bp)}g=g.join(bp);break;case"transform":if(b1[b5].real){g=[];for(b9=0,bZ=b7[b5].length;b9<bZ;b9++){g[b9]=[b7[b5][b9][0]];for(b8=1,cb=b7[b5][b9].length;b8<cb;b8++){g[b9][b8]=b7[b5][b9][b8]+R*b4*b1[b5][b9][b8]}}}else{var cd=function(cf){return +b7[b5][cf]+R*b4*b1[b5][cf]};g=[["m",cd(0),cd(1),cd(2),cd(3),cd(4),cd(5)]]}break;case"csv":if(b5=="clip-rect"){g=[];b9=4;while(b9--){g[b9]=+b7[b5][b9]+R*b4*b1[b5][b9]}}break;default:var bW=[][aE](b7[b5]);g=[];b9=bX.paper.customAttributes[b5].length;while(b9--){g[b9]=+bW[b9]+R*b4*b1[b5][b9]}break}b2[b5]=g}}bX.attr(b2);(function(ch,cf,cg){setTimeout(function(){bk("raphael.anim.frame."+ch,cf,cg)})})(bX.id,bX,cc.anim)}else{(function(ch,cg,cf){setTimeout(function(){bk("raphael.anim.frame."+cg.id,cg,cf);bk("raphael.anim.finish."+cg.id,cg,cf);bq.is(ch,"function")&&ch.call(cg)})})(cc.callback,bX,cc.anim);bX.attr(E);bN.splice(b6--,1);if(cc.repeat>1&&!cc.next){for(ce in E){if(E[bE](ce)){ca[ce]=cc.totalOrigin[ce]}}cc.el.attr(ca);ad(cc.anim,cc.el,cc.anim.percents[0],null,cc.totalOrigin,cc.repeat-1)}if(cc.next&&!cc.stop){ad(cc.anim,cc.el,cc.next,null,cc.totalOrigin,cc.repeat)}}}bN.length&&bP(aC)},a9=function(g){return g>255?255:g<0?0:g};aA.animateWith=function(E,S,R,g,bY,b3){var bX=this;if(bX.removed){b3&&b3.call(bX);return bX}var b1=R instanceof m?R:bq.animation(R,g,bY,b3),b0,bZ;ad(b1,bX,b1.percents[0],null,bX.attr());for(var bW=0,b2=bN.length;bW<b2;bW++){if(bN[bW].anim==S&&bN[bW].el==E){bN[b2-1].start=bN[bW].start;break}}return bX};function a8(b5,S,E,b4,b3,bZ){var b0=3*S,b2=3*(b4-S)-b0,g=1-b0-b2,bY=3*E,b1=3*(b3-E)-bY,b6=1-bY-b1;function bX(b7){return((g*b7+b2)*b7+b0)*b7}function R(b7,b9){var b8=bW(b7,b9);return((b6*b8+b1)*b8+bY)*b8}function bW(b7,ce){var cd,cc,ca,b8,cb,b9;for(ca=b7,b9=0;b9<8;b9++){b8=bX(ca)-b7;if(av(b8)<ce){return ca}cb=(3*g*ca+2*b2)*ca+b0;if(av(cb)<0.000001){break}ca=ca-b8/cb}cd=0;cc=1;ca=b7;if(ca<cd){return cd}if(ca>cc){return cc}while(cd<cc){b8=bX(ca);if(av(b8-b7)<ce){return ca}if(b7>b8){cd=ca}else{cc=ca}ca=(cc-cd)/2+cd}return ca}return R(b5,1/(200*bZ))}aA.onAnimation=function(g){g?bk.on("raphael.anim.frame."+this.id,g):bk.unbind("raphael.anim.frame."+this.id);return this};function m(bW,R){var E=[],S={};this.ms=R;this.times=1;if(bW){for(var g in bW){if(bW[bE](g)){S[bU(g)]=bW[g];E.push(bU(g))}}E.sort(bC)}this.anim=S;this.top=E[E.length-1];this.percents=E}m.prototype.delay=function(E){var g=new m(this.anim,this.ms);g.times=this.times;g.del=+E||0;return g};m.prototype.repeat=function(E){var g=new m(this.anim,this.ms);g.del=this.del;g.times=aR.floor(bQ(E,0))||1;return g};function ad(cg,R,g,ce,bY,b2){g=bU(g);var cn,bX,b1,co=[],b8,b7,bW,ca=cg.ms,cf={},S={},b4={};if(ce){for(cj=0,b3=bN.length;cj<b3;cj++){var cl=bN[cj];if(cl.el.id==R.id&&cl.anim==cg){if(cl.percent!=g){bN.splice(cj,1);b1=1}else{bX=cl}R.attr(cl.totalOrigin);break}}}else{ce=+S}for(var cj=0,b3=cg.percents.length;cj<b3;cj++){if(cg.percents[cj]==g||cg.percents[cj]>ce*cg.top){g=cg.percents[cj];b7=cg.percents[cj-1]||0;ca=ca/cg.top*(g-b7);b8=cg.percents[cj+1];cn=cg.anim[g];break}else{if(ce){R.attr(cg.anim[cg.percents[cj]])}}}if(!cn){return}if(!bX){for(var cc in cn){if(cn[bE](cc)){if(bw[bE](cc)||R.paper.customAttributes[bE](cc)){cf[cc]=R.attr(cc);(cf[cc]==null)&&(cf[cc]=by[cc]);S[cc]=cn[cc];switch(bw[cc]){case br:b4[cc]=(S[cc]-cf[cc])/ca;break;case"colour":cf[cc]=bq.getRGB(cf[cc]);var cd=bq.getRGB(S[cc]);b4[cc]={r:(cd.r-cf[cc].r)/ca,g:(cd.g-cf[cc].g)/ca,b:(cd.b-cf[cc].b)/ca};break;case"path":var bZ=bs(cf[cc],S[cc]),b6=bZ[1];cf[cc]=bZ[0];b4[cc]=[];for(cj=0,b3=cf[cc].length;cj<b3;cj++){b4[cc][cj]=[0];for(var ci=1,ck=cf[cc][cj].length;ci<ck;ci++){b4[cc][cj][ci]=(b6[cj][ci]-cf[cc][cj][ci])/ca}}break;case"transform":var cq=R._,cp=bl(cq[cc],S[cc]);if(cp){cf[cc]=cp.from;S[cc]=cp.to;b4[cc]=[];b4[cc].real=true;for(cj=0,b3=cf[cc].length;cj<b3;cj++){b4[cc][cj]=[cf[cc][cj][0]];for(ci=1,ck=cf[cc][cj].length;ci<ck;ci++){b4[cc][cj][ci]=(S[cc][cj][ci]-cf[cc][cj][ci])/ca}}}else{var cb=(R.matrix||new bh),cm={_:{transform:cq.transform},getBBox:function(){return R.getBBox(1)}};cf[cc]=[cb.a,cb.b,cb.c,cb.d,cb.e,cb.f];ah(cm,S[cc]);S[cc]=cm._.transform;b4[cc]=[(cm.matrix.a-cb.a)/ca,(cm.matrix.b-cb.b)/ca,(cm.matrix.c-cb.c)/ca,(cm.matrix.d-cb.d)/ca,(cm.matrix.e-cb.e)/ca,(cm.matrix.f-cb.f)/ca]}break;case"csv":var E=q(cn[cc])[r](bD),b0=q(cf[cc])[r](bD);if(cc=="clip-rect"){cf[cc]=b0;b4[cc]=[];cj=b0.length;while(cj--){b4[cc][cj]=(E[cj]-cf[cc][cj])/ca}}S[cc]=E;break;default:E=[][aE](cn[cc]);b0=[][aE](cf[cc]);b4[cc]=[];cj=R.paper.customAttributes[cc].length;while(cj--){b4[cc][cj]=((E[cj]||0)-(b0[cj]||0))/ca}break}}}}var b9=cn.easing,ch=bq.easing_formulas[b9];if(!ch){ch=q(b9).match(ax);if(ch&&ch.length==5){var b5=ch;ch=function(cr){return a8(cr,+b5[1],+b5[2],+b5[3],+b5[4],ca)}}else{ch=aF}}bW=cn.start||cg.start||+new Date;cl={anim:cg,percent:g,timestamp:bW,start:bW+(cg.del||0),status:0,initstatus:ce||0,stop:false,ms:ca,easing:ch,from:cf,diff:b4,to:S,el:R,callback:cn.callback,prev:b7,next:b8,repeat:b2||cg.times,origin:R.attr(),totalOrigin:bY};bN.push(cl);if(ce&&!bX&&!b1){cl.stop=true;cl.start=new Date-ca*ce;if(bN.length==1){return aC()}}if(b1){cl.start=new Date-cl.ms*ce}bN.length==1&&bP(aC)}else{bX.initstatus=ce;bX.start=new Date-bX.ms*ce}bk("raphael.anim.start."+R.id,R,cg)}bq.animation=function(R,g,bY,b0){if(R instanceof m){return R}if(bq.is(bY,"function")||!bY){b0=b0||bY||null;bY=null}R=Object(R);g=+g||0;var E={},b1,bX;for(bX in R){if(R[bE](bX)&&bU(bX)!=bX&&bU(bX)+"%"!=bX){b1=true;E[bX]=R[bX]}}if(!b1){if(b0){var bZ=0;for(var S in R){var bW=bS(S);if(R[bE](S)&&bW>bZ){bZ=bW}}bZ+="%";!R[bZ].callback&&(R[bZ].callback=b0)}return new m(R,g)}else{bY&&(E.easing=bY);b0&&(E.callback=b0);return new m({100:E},g)}};aA.animate=function(S,g,bX,bW){var E=this;if(E.removed){bW&&bW.call(E);return E}var R=S instanceof m?S:bq.animation(S,g,bX,bW);ad(R,E,R.percents[0],null,E.attr());return E};aA.setTime=function(E,g){if(E&&g!=null){this.status(E,at(g,E.ms)/E.ms)}return this};aA.status=function(bW,S){var E=[],R=0,g,bX;if(S!=null){ad(bW,this,-1,at(S,1));return this}else{g=bN.length;for(;R<g;R++){bX=bN[R];if(bX.el.id==this.id&&(!bW||bX.anim==bW)){if(bW){return bX.status}E.push({anim:bX.anim,status:bX.status})}}if(bW){return 0}return E}};aA.pause=function(E){for(var g=0;g<bN.length;g++){if(bN[g].el.id==this.id&&(!E||bN[g].anim==E)){if(bk("raphael.anim.pause."+this.id,this,bN[g].anim)!==false){bN[g].paused=true}}}return this};aA.resume=function(E){for(var g=0;g<bN.length;g++){if(bN[g].el.id==this.id&&(!E||bN[g].anim==E)){var R=bN[g];if(bk("raphael.anim.resume."+this.id,this,R.anim)!==false){delete R.paused;this.status(R.anim,R.status)}}}return this};aA.stop=function(E){for(var g=0;g<bN.length;g++){if(bN[g].el.id==this.id&&(!E||bN[g].anim==E)){if(bk("raphael.anim.stop."+this.id,this,bN[g].anim)!==false){bN.splice(g--,1)}}}return this};function bm(E){for(var g=0;g<bN.length;g++){if(bN[g].el.paper==E){bN.splice(g--,1)}}}bk.on("raphael.remove",bm);bk.on("raphael.clear",bm);aA.toString=function(){return"Rapha\xebl\u2019s object"};var ai=function(g){this.items=[];this.length=0;this.type="set";if(g){for(var E=0,R=g.length;E<R;E++){if(g[E]&&(g[E].constructor==aA.constructor||g[E].constructor==ai)){this[this.items.length]=this.items[this.items.length]=g[E];this.length++}}}},G=ai.prototype;G.push=function(){var S,g;for(var E=0,R=arguments.length;E<R;E++){S=arguments[E];if(S&&(S.constructor==aA.constructor||S.constructor==ai)){g=this.items.length;this[g]=this.items[g]=S;this.length++}}return this};G.pop=function(){this.length&&delete this[this.length--];return this.items.pop()};G.forEach=function(S,g){for(var E=0,R=this.items.length;E<R;E++){if(S.call(g,this.items[E],E)===false){return this}}return this};for(var aO in aA){if(aA[bE](aO)){G[aO]=(function(g){return function(){var E=arguments;return this.forEach(function(R){R[g][bA](R,E)})}})(aO)}}G.attr=function(E,bX){if(E&&bq.is(E,F)&&bq.is(E[0],"object")){for(var g=0,bW=E.length;g<bW;g++){this.items[g].attr(E[g])}}else{for(var R=0,S=this.items.length;R<S;R++){this.items[R].attr(E,bX)}}return this};G.clear=function(){while(this.length){this.pop()}};G.splice=function(S,bY,bZ){S=S<0?bQ(this.length+S,0):S;bY=bQ(0,at(this.length-S,bY));var R=[],g=[],E=[],bW;for(bW=2;bW<arguments.length;bW++){E.push(arguments[bW])}for(bW=0;bW<bY;bW++){g.push(this[S+bW])}for(;bW<this.length-S;bW++){R.push(this[S+bW])}var bX=E.length;for(bW=0;bW<bX+R.length;bW++){this.items[S+bW]=this[S+bW]=bW<bX?E[bW]:R[bW-bX]}bW=this.items.length=this.length-=bY-bX;while(this[bW]){delete this[bW++]}return new ai(g)};G.exclude=function(R){for(var g=0,E=this.length;g<E;g++){if(this[g]==R){this.splice(g,1);return true}}};G.animate=function(R,g,bY,b0){(bq.is(bY,"function")||!bY)&&(b0=bY||null);var bX=this.items.length,S=bX,b1,bZ=this,bW;if(!bX){return this}b0&&(bW=function(){!--bX&&b0.call(bZ)});bY=bq.is(bY,f)?bY:bW;var E=bq.animation(R,g,bY,bW);b1=this.items[--S].animate(E);while(S--){this.items[S]&&!this.items[S].removed&&this.items[S].animateWith(b1,E,E);(this.items[S]&&!this.items[S].removed)||bX--}return this};G.insertAfter=function(E){var g=this.items.length;while(g--){this.items[g].insertAfter(E)}return this};G.getBBox=function(){var g=[],bX=[],E=[],S=[];for(var R=this.items.length;R--;){if(!this.items[R].removed){var bW=this.items[R].getBBox();g.push(bW.x);bX.push(bW.y);E.push(bW.x+bW.width);S.push(bW.y+bW.height)}}g=at[bA](0,g);bX=at[bA](0,bX);E=bQ[bA](0,E);S=bQ[bA](0,S);return{x:g,y:bX,x2:E,y2:S,width:E-g,height:S-bX}};G.clone=function(R){R=this.paper.set();for(var g=0,E=this.items.length;g<E;g++){R.push(this.items[g].clone())}return R};G.toString=function(){return"Rapha\xebl\u2018s set"};G.glow=function(E){var g=this.paper.set();this.forEach(function(R,S){var bW=R.glow(E);if(bW!=null){bW.forEach(function(bX,bY){g.push(bX)})}});return g};G.isPointInside=function(g,R){var E=false;this.forEach(function(S){if(S.isPointInside(g,R)){E=true;return false}});return E};bq.registerFont=function(E){if(!E.face){return E}this.fonts=this.fonts||{};var S={w:E.w,face:{},glyphs:{}},R=E.face["font-family"];for(var bY in E.face){if(E.face[bE](bY)){S.face[bY]=E.face[bY]}}if(this.fonts[R]){this.fonts[R].push(S)}else{this.fonts[R]=[S]}if(!E.svg){S.face["units-per-em"]=bS(E.face["units-per-em"],10);for(var bW in E.glyphs){if(E.glyphs[bE](bW)){var bX=E.glyphs[bW];S.glyphs[bW]={w:bX.w,k:{},d:bX.d&&"M"+bX.d.replace(/[mlcxtrv]/g,function(bZ){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[bZ]||"M"})+"z"};if(bX.k){for(var g in bX.k){if(bX[bE](g)){S.glyphs[bW].k[g]=bX.k[g]}}}}}}return E};ay.getFont=function(bZ,b0,E,S){S=S||"normal";E=E||"normal";b0=+b0||{normal:400,bold:700,lighter:300,bolder:800}[b0]||400;if(!bq.fonts){return}var bW=bq.fonts[bZ];if(!bW){var R=new RegExp("(^|\\s)"+bZ.replace(/[^\w\d\s+!~.:_-]/g,bv)+"(\\s|$)","i");for(var g in bq.fonts){if(bq.fonts[bE](g)){if(R.test(g)){bW=bq.fonts[g];break}}}}var bX;if(bW){for(var bY=0,b1=bW.length;bY<b1;bY++){bX=bW[bY];if(bX.face["font-weight"]==b0&&(bX.face["font-style"]==E||!bX.face["font-style"])&&bX.face["font-stretch"]==S){break}}}return bX};ay.print=function(bZ,bY,g,b2,b4,cc,R,E){cc=cc||"middle";R=bQ(at(R||0,1),-1);E=bQ(at(E||1,3),1);var cb=q(g)[r](bv),b8=0,ca=0,b6=bv,cd;bq.is(b2,"string")&&(b2=this.getFont(b2));if(b2){cd=(b4||16)/b2.face["units-per-em"];var bW=b2.face.bbox[r](bD),b1=+bW[0],S=bW[3]-bW[1],bX=0,b3=+bW[1]+(cc=="baseline"?S+(+b2.face.descent):S/2);for(var b7=0,b0=cb.length;b7<b0;b7++){if(cb[b7]=="\n"){b8=0;b9=0;ca=0;bX+=S*E}else{var b5=ca&&b2.glyphs[cb[b7-1]]||{},b9=b2.glyphs[cb[b7]];b8+=ca?(b5.w||b2.w)+(b5.k&&b5.k[cb[b7]]||0)+(b2.w*R):0;ca=1}if(b9&&b9.d){b6+=bq.transformPath(b9.d,["t",b8*cd,bX*cd,"s",cd,cd,b1,b3,"t",(bZ-b1)/cd,(bY-b3)/cd])}}}return this.path(b6).attr({fill:"#000",stroke:"none"})};ay.add=function(S){if(bq.is(S,"array")){var R=this.set(),E=0,bW=S.length,g;for(;E<bW;E++){g=S[E]||{};aD[bE](g.type)&&R.push(this[g.type]().attr(g))}}return R};bq.format=function(E,R){var g=bq.is(R,F)?[0][aE](R):arguments;E&&bq.is(E,f)&&g.length-1&&(E=E.replace(ag,function(bW,S){return g[++S]==null?bv:g[S]}));return E||bv};bq.fullfill=(function(){var R=/\{([^\}]+)\}/g,g=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,E=function(bX,bW,bY){var S=bY;bW.replace(g,function(b1,b0,bZ,b3,b2){b0=b0||b3;if(S){if(b0 in S){S=S[b0]}typeof S=="function"&&b2&&(S=S())}});S=(S==null||S==bY?bX:S)+"";return S};return function(bW,S){return String(bW).replace(R,function(bY,bX){return E(bY,bX,S)})}})();bq.ninja=function(){if(aN.was){bd.win.Raphael=aN.is}else{window.Raphael=undefined;try{delete window.Raphael}catch(g){}}return bq};bq.st=G;bk.on("raphael.DOMload",function(){W=true});(function(S,E,R){if(S.readyState==null&&S.addEventListener){S.addEventListener(E,R=function(){S.removeEventListener(E,R,false);S.readyState="complete"},false);S.readyState="loading"}function g(){(/in/).test(S.readyState)?setTimeout(g,9):bq.eve("raphael.DOMload")}g()})(document,"DOMContentLoaded");return bq}.apply(b,a),e!==undefined&&(c.exports=e))},function(c,b,d){var a,e;(function(r){var m="0.4.2",s="hasOwnProperty",g=/[\.\/]/,f="*",o=function(){},n=function(x,w){return x-w},l,q,u={n:{}},j=function(w,N){w=String(w);var H=u,E=q,I=Array.prototype.slice.call(arguments,2),K=j.listeners(w),J=0,G=false,B,A=[],F={},C=[],x=l,L=[];l=w;q=0;for(var D=0,M=K.length;D<M;D++){if("zIndex" in K[D]){A.push(K[D].zIndex);if(K[D].zIndex<0){F[K[D].zIndex]=K[D]}}}A.sort(n);while(A[J]<0){B=F[A[J++]];C.push(B.apply(N,I));if(q){q=E;return C}}for(D=0;D<M;D++){B=K[D];if("zIndex" in B){if(B.zIndex==A[J]){C.push(B.apply(N,I));if(q){break}do{J++;B=F[A[J]];B&&C.push(B.apply(N,I));if(q){break}}while(B)}else{F[B.zIndex]=B}}else{C.push(B.apply(N,I));if(q){break}}}q=E;l=x;return C.length?C:null};j._events=u;j.listeners=function(w){var G=w.split(g),E=u,K,F,x,C,J,B,D,H,I=[E],A=[];for(C=0,J=G.length;C<J;C++){H=[];for(B=0,D=I.length;B<D;B++){E=I[B].n;F=[E[G[C]],E[f]];x=2;while(x--){K=F[x];if(K){H.push(K);A=A.concat(K.f||[])}}}I=H}return A};j.on=function(w,B){w=String(w);if(typeof B!="function"){return function(){}}var D=w.split(g),C=u;for(var x=0,A=D.length;x<A;x++){C=C.n;C=C.hasOwnProperty(D[x])&&C[D[x]]||(C[D[x]]={n:{}})}C.f=C.f||[];for(x=0,A=C.f.length;x<A;x++){if(C.f[x]==B){return o}}C.f.push(B);return function(E){if(+E==+E){B.zIndex=+E}}};j.f=function(x){var w=[].slice.call(arguments,1);return function(){j.apply(null,[x,null].concat(w).concat([].slice.call(arguments,0)))}};j.stop=function(){q=1};j.nt=function(w){if(w){return new RegExp("(?:\\.|\\/|^)"+w+"(?:\\.|\\/|$)").test(l)}return l};j.nts=function(){return l.split(g)};j.off=j.unbind=function(x,E){if(!x){j._events=u={n:{}};return}var G=x.split(g),F,I,A,C,J,B,D,H=[u];for(C=0,J=G.length;C<J;C++){for(B=0;B<H.length;B+=A.length-2){A=[B,1];F=H[B].n;if(G[C]!=f){if(F[G[C]]){A.push(F[G[C]])}}else{for(I in F){if(F[s](I)){A.push(F[I])}}}H.splice.apply(H,A)}}for(C=0,J=H.length;C<J;C++){F=H[C];while(F.n){if(E){if(F.f){for(B=0,D=F.f.length;B<D;B++){if(F.f[B]==E){F.f.splice(B,1);break}}!F.f.length&&delete F.f}for(I in F.n){if(F.n[s](I)&&F.n[I].f){var w=F.n[I].f;for(B=0,D=w.length;B<D;B++){if(w[B]==E){w.splice(B,1);break}}!w.length&&delete F.n[I].f}}}else{delete F.f;for(I in F.n){if(F.n[s](I)&&F.n[I].f){delete F.n[I].f}}}F=F.n}}};j.once=function(w,x){var A=function(){j.unbind(w,A);return x.apply(this,arguments)};return j.on(w,A)};j.version=m;j.toString=function(){return"You are running Eve "+m};(typeof c!="undefined"&&c.exports)?(c.exports=j):(true?(!(a=[],e=function(){return j}.apply(b,a),e!==undefined&&(c.exports=e))):(r.eve=j))})(this)},function(c,b,d){var a,e;!(a=[d(1)],e=function(x){if(x&&!x.svg){return}var l="hasOwnProperty",V=String,B=parseFloat,G=parseInt,n=Math,W=n.max,J=n.abs,q=n.pow,o=/[, ]+/,T=x.eve,H="",u=" ";var C="http://www.w3.org/1999/xlink",Q={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},L={};x.toString=function(){return"Your browser supports SVG.\nYou are running Rapha\xebl "+this.version};var I=function(E){var S=[];for(var R=0;R<E.length;R++){if(E[R]===E[R]){S.push(E[R])}}return S};var s=function(S,E){if(E){if(typeof S=="string"){S=s(S)}for(var R in E){if(E[l](R)){if(R.substring(0,6)=="xlink:"){S.setAttributeNS(C,R.substring(6),V(E[R]))}else{if(xui.isArr(E[R])){xui.each(E[R],function(Y,X){if(xui.isArr(Y)){E[R][X]=I(Y)}})}S.setAttribute(R,V(E[R]))}}}}else{S=x._g.doc.createElementNS("http://www.w3.org/2000/svg",S);S.style&&(S.style.webkitTapHighlightColor="rgba(0,0,0,0)")}return S},f=function(ad,ah){var af="linear",R=ad.id+ah,ab=0.5,Z=0.5,X=ad.node,E=ad.paper,aj=X.style,S=x._g.doc.getElementById(R);if(!S){ah=V(ah).replace(x._radial_gradient,function(am,ak,an){af="radial";if(ak&&an){ab=B(ak);Z=B(an);var al=((Z>0.5)*2-1);q(ab-0.5,2)+q(Z-0.5,2)>0.25&&(Z=n.sqrt(0.25-q(ab-0.5,2))*al+0.5)&&Z!=0.5&&(Z=Z.toFixed(5)-0.00001*al)}return H});ah=ah.split(/\s*\-\s*/);if(af=="linear"){var aa=ah.shift();aa=-B(aa);if(isNaN(aa)){return null}var Y=[0,0,n.cos(x.rad(aa)),n.sin(x.rad(aa))],ag=1/(W(J(Y[2]),J(Y[3]))||1);Y[2]*=ag;Y[3]*=ag;if(Y[2]<0){Y[0]=-Y[2];Y[2]=0}if(Y[3]<0){Y[1]=-Y[3];Y[3]=0}}var ae=x._parseDots(ah);if(!ae){return null}R=R.replace(/[\(\)\s,\xb0#]/g,"_");if(ad.gradient&&R!=ad.gradient.id){E.defs.removeChild(ad.gradient);delete ad.gradient}if(!ad.gradient){S=s(af+"Gradient",{id:R});ad.gradient=S;s(S,af=="radial"?{fx:ab,fy:Z}:{x1:Y[0],y1:Y[1],x2:Y[2],y2:Y[3],gradientTransform:ad.matrix.invert()});E.defs.appendChild(S);for(var ac=0,ai=ae.length;ac<ai;ac++){S.appendChild(s("stop",{offset:ae[ac].offset?ae[ac].offset:ac?"100%":"0%","stop-color":ae[ac].color||"#fff","stop-opacity":isFinite(ae[ac].opacity)?ae[ac].opacity:1}))}}}s(X,{fill:r(R),opacity:1,"fill-opacity":1});aj.fill=H;aj.opacity=1;aj.fillOpacity=1;return 1},D=function(){var E=document.documentMode;return E&&(E===9||E===10)},r=function(S){if(D()){return"url('#"+S+"')"}var E=document.location;var R=(E.protocol+"//"+E.host+E.pathname+E.search);return"url('"+R+"#"+S+"')"},g=function(R){var E=R.getBBox(1);s(R.pattern,{patternTransform:R.matrix.invert()+" translate("+E.x+","+E.y+")"})},j=function(af,ah,aa){if(af.type=="path"){var E=V(ah).toLowerCase().split("-"),ae=af.paper,at=aa?"end":"start",aj=af.node,ag=af.attrs,Z=ag["stroke-width"],an=E.length,X="classic",am,S,ac,ak,ai,ab=3,ao=3,ad=5;while(an--){switch(E[an]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":X=E[an];break;case"wide":ao=5;break;case"narrow":ao=2;break;case"long":ab=5;break;case"short":ab=2;break}}if(X=="open"){ab+=2;ao+=2;ad+=2;ac=1;ak=aa?4:1;ai={fill:"none",stroke:ag.stroke}}else{ak=ac=ab/2;ai={fill:ag.stroke,stroke:"none"}}if(af._.arrows){if(aa){af._.arrows.endPath&&L[af._.arrows.endPath]--;af._.arrows.endMarker&&L[af._.arrows.endMarker]--}else{af._.arrows.startPath&&L[af._.arrows.startPath]--;af._.arrows.startMarker&&L[af._.arrows.startMarker]--}}else{af._.arrows={}}if(X!="none"){var R="raphael-marker-"+X,ar="raphael-marker-"+at+X+ab+ao+"-obj"+af.id;if(!x._g.doc.getElementById(R)){ae.defs.appendChild(s(s("path"),{"stroke-linecap":"round",d:Q[X],id:R}));L[R]=1}else{L[R]++}var Y=x._g.doc.getElementById(ar),al;if(!Y){Y=s(s("marker"),{id:ar,markerHeight:ao,markerWidth:ab,orient:"auto",refX:ak,refY:ao/2});al=s(s("use"),{"xlink:href":"#"+R,transform:(aa?"rotate(180 "+ab/2+" "+ao/2+") ":H)+"scale("+ab/ad+","+ao/ad+")","stroke-width":(1/((ab/ad+ao/ad)/2)).toFixed(4)});Y.appendChild(al);ae.defs.appendChild(Y);L[ar]=1}else{L[ar]++;al=Y.getElementsByTagName("use")[0]}s(al,ai);var aq=ac*(X!="diamond"&&X!="oval");if(aa){am=af._.arrows.startdx*Z||0;S=x.getTotalLength(ag.path)-aq*Z}else{am=aq*Z;S=x.getTotalLength(ag.path)-(af._.arrows.enddx*Z||0)}ai={};ai["marker-"+at]="url(#"+ar+")";if(S||am){ai.d=x.getSubpath(ag.path,am,S)}s(aj,ai);af._.arrows[at+"Path"]=R;af._.arrows[at+"Marker"]=ar;af._.arrows[at+"dx"]=aq;af._.arrows[at+"Type"]=X;af._.arrows[at+"String"]=ah}else{if(aa){am=af._.arrows.startdx*Z||0;S=x.getTotalLength(ag.path)-am}else{am=0;S=x.getTotalLength(ag.path)-(af._.arrows.enddx*Z||0)}af._.arrows[at+"Path"]&&s(aj,{d:x.getSubpath(ag.path,am,S)});delete af._.arrows[at+"Path"];delete af._.arrows[at+"Marker"];delete af._.arrows[at+"dx"];delete af._.arrows[at+"Type"];delete af._.arrows[at+"String"]}for(ai in L){if(L[l](ai)&&!L[ai]){var ap=x._g.doc.getElementById(ai);ap&&ap.parentNode.removeChild(ap)}}}},M={"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},w=function(aa,Y,Z){Y=V(Y).replace(/\s+/,"");Y=M[Y]||(Raphael.svg&&!/[^\d,]/.test(Y)&&Y.split(/,/));if(Y){var S=aa.attrs["stroke-width"]||"1",E={round:S,square:S,butt:0}[aa.attrs["stroke-linecap"]||Z["stroke-linecap"]]||0,X=[],R=Y.length;while(R--){X[R]=Y[R]*S+((R%2)?1:-1)*E}s(aa.node,{"stroke-dasharray":X.join(",")})}else{s(aa.node,{"stroke-dasharray":"none"})}},O=function(af,an){var aj=af.node,ag=af.attrs,ad=aj.style.visibility;aj.style.visibility="hidden";for(var ai in an){if(an[l](ai)){if(!x._availableAttrs[l](ai)){continue}var ah=an[ai];ag[ai]=ah;switch(ai){case"blur":af.blur(ah);break;case"title":var ao=aj.getElementsByTagName("title");if(ao.length&&(ao=ao[0])){ao.firstChild.nodeValue=ah}else{ao=s("title");var ap=x._g.doc.createTextNode(ah);ao.appendChild(ap);aj.appendChild(ao)}break;case"href":case"target":var al=aj.parentNode;if(al.tagName.toLowerCase()!="a"){var Y=s("a");al.insertBefore(Y,aj);Y.appendChild(aj);al=Y}if(ai=="target"){al.setAttributeNS(C,"show",ah=="blank"?"new":ah)}else{al.setAttributeNS(C,ai,ah)}break;case"cursor":aj.style.cursor=ah;break;case"transform":af.transform(ah);break;case"arrow-start":j(af,ah);break;case"arrow-end":j(af,ah,1);break;case"clip-rect":var R=V(ah).split(o);if(R.length==4){af.clip&&af.clip.parentNode.parentNode.removeChild(af.clip.parentNode);var S=s("clipPath"),ak=s("rect");S.id=x.createUUID();s(ak,{x:R[0],y:R[1],width:R[2],height:R[3]});S.appendChild(ak);af.paper.defs.appendChild(S);s(aj,{"clip-path":"url(#"+S.id+")"});af.clip=ak}if(!ah){var ae=aj.getAttribute("clip-path");if(ae){var am=x._g.doc.getElementById(ae.replace(/(^url\(#|\)$)/g,H));am&&am.parentNode.removeChild(am);s(aj,{"clip-path":H});delete af.clip}}break;case"path":if(af.type=="path"){s(aj,{d:ah?ag.path=x._pathToAbsolute(ah):"M0,0"});af._.dirty=1;if(af._.arrows){"startString" in af._.arrows&&j(af,af._.arrows.startString);"endString" in af._.arrows&&j(af,af._.arrows.endString,1)}}break;case"width":aj.setAttribute(ai,ah);af._.dirty=1;if(ag.fx){ai="x";ah=ag.x}else{break}case"x":if(ag.fx){ah=-ag.x-(ag.width||0)}case"rx":if(ai=="rx"&&af.type=="rect"){break}case"cx":aj.setAttribute(ai,ah);af.pattern&&g(af);af._.dirty=1;break;case"height":aj.setAttribute(ai,ah);af._.dirty=1;if(ag.fy){ai="y";ah=ag.y}else{break}case"y":if(ag.fy){ah=-ag.y-(ag.height||0)}case"ry":if(ai=="ry"&&af.type=="rect"){break}case"cy":aj.setAttribute(ai,ah);af.pattern&&g(af);af._.dirty=1;break;case"r":if(af.type=="rect"){s(aj,{rx:ah,ry:ah})}else{aj.setAttribute(ai,ah)}af._.dirty=1;break;case"src":if(af.type=="image"){aj.setAttributeNS(C,"href",ah)}break;case"stroke-width":if(af._.sx!=1||af._.sy!=1){ah/=W(J(af._.sx),J(af._.sy))||1}aj.setAttribute(ai,ah);if(ag["stroke-dasharray"]){w(af,ag["stroke-dasharray"],an)}if(af._.arrows){"startString" in af._.arrows&&j(af,af._.arrows.startString);"endString" in af._.arrows&&j(af,af._.arrows.endString,1)}break;case"stroke-dasharray":w(af,ah,an);break;case"stroke-dashoffset":if(Raphael.svg){aj.setAttribute(ai,ah)}break;case"fill":var Z=V(ah).match(x._ISURL);if(Z){S=s("pattern");var ac=s("image");S.id=x.createUUID();s(S,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});s(ac,{x:0,y:0,"xlink:href":Z[1]});S.appendChild(ac);(function(aq){x._preload(Z[1],function(){var ar=this.offsetWidth,at=this.offsetHeight;s(aq,{width:ar,height:at});s(ac,{width:ar,height:at})})})(S);af.paper.defs.appendChild(S);s(aj,{fill:"url(#"+S.id+")"});af.pattern=S;af.pattern&&g(af);break}var X=x.getRGB(ah);if(!X.error){delete an.gradient;delete ag.gradient;!x.is(ag.opacity,"undefined")&&x.is(an.opacity,"undefined")&&s(aj,{opacity:ag.opacity});!x.is(ag["fill-opacity"],"undefined")&&x.is(an["fill-opacity"],"undefined")&&s(aj,{"fill-opacity":ag["fill-opacity"]})}else{if((af.type=="circle"||af.type=="ellipse"||V(ah).charAt()!="r")&&f(af,ah)){if("opacity" in ag||"fill-opacity" in ag){var E=x._g.doc.getElementById(aj.getAttribute("fill").replace(/^url\(#|\)$/g,H));if(E){var aa=E.getElementsByTagName("stop");s(aa[aa.length-1],{"stop-opacity":("opacity" in ag?ag.opacity:1)*("fill-opacity" in ag?ag["fill-opacity"]:1)})}}ag.gradient=ah;ag.fill="none";break}}X[l]("opacity")&&s(aj,{"fill-opacity":X.opacity>1?X.opacity/100:X.opacity});case"stroke":X=x.getRGB(ah);aj.setAttribute(ai,X.hex);ai=="stroke"&&X[l]("opacity")&&s(aj,{"stroke-opacity":X.opacity>1?X.opacity/100:X.opacity});if(ai=="stroke"&&af._.arrows){"startString" in af._.arrows&&j(af,af._.arrows.startString);"endString" in af._.arrows&&j(af,af._.arrows.endString,1)}break;case"gradient":(af.type=="circle"||af.type=="ellipse"||V(ah).charAt()!="r")&&f(af,ah);break;case"opacity":if(ag.gradient&&!ag[l]("stroke-opacity")){s(aj,{"stroke-opacity":ah>1?ah/100:ah})}case"fill-opacity":if(ag.gradient){E=x._g.doc.getElementById(aj.getAttribute("fill").replace(/^url\(#|\)$/g,H));if(E){aa=E.getElementsByTagName("stop");s(aa[aa.length-1],{"stop-opacity":ah})}break}default:ai=="font-size"&&(ah=G(ah,10)+"px");var ab=ai.replace(/(\-.)/g,function(aq){return aq.substring(1).toUpperCase()});aj.style[ab]=ah;af._.dirty=1;aj.setAttribute(ai,ah);break}}}F(af,an);aj.style.visibility=ad},U=1.2,F=function(E,Y){if(E.type!="text"||!(Y[l]("text")||Y[l]("font")||Y[l]("font-size")||Y[l]("x")||Y[l]("y"))){return}var ad=E.attrs,S=E.node,af=S.firstChild?G(x._g.doc.defaultView.getComputedStyle(S.firstChild,H).getPropertyValue("font-size"),10):10;if(Y[l]("text")){ad.text=Y.text;while(S.firstChild){S.removeChild(S.firstChild)}var X=V(Y.text).split("\n"),R=[],ab;for(var Z=0,ae=X.length;Z<ae;Z++){ab=s("tspan");Z&&s(ab,{dy:af*U,x:ad.x});ab.appendChild(x._g.doc.createTextNode(X[Z]));S.appendChild(ab);R[Z]=ab}}else{R=S.getElementsByTagName("tspan");for(Z=0,ae=R.length;Z<ae;Z++){if(Z){s(R[Z],{dy:af*U,x:ad.x})}else{s(R[0],{dy:0})}}}s(S,{x:ad.x,y:ad.y});E._.dirty=1;var aa=E._getBBox(),ac=ad.y-(aa.y+aa.height/2);ac&&x.is(ac,"finite")&&s(R[0],{dy:ac})},N=function(E){if(E.parentNode&&E.parentNode.tagName.toLowerCase()==="a"){return E.parentNode}else{return E}},K=function(S,E){var aa=0,Z=0;this[0]=this.node=S;S.raphael=true;this.id=R();S.raphaelid=this.id;function R(){return("0000"+(Math.random()*Math.pow(36,5)<<0).toString(36)).slice(-5)}this.matrix=x.matrix();this.realPath=null;this.paper=E;this.attrs=this.attrs||{};this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1};!E.bottom&&(E.bottom=this);this.prev=E.top;E.top&&(E.top.next=this);E.top=this;this.next=null},A=x.el;K.prototype=A;A.constructor=K;x._engine.path=function(E,X){var R=s("path");X.canvas&&X.canvas.appendChild(R);var S=new K(R,X);S.type="path";O(S,{fill:"none",stroke:"#000",path:E});return S};A.rotate=function(R,E,X){if(this.removed){return this}R=V(R).split(o);if(R.length-1){E=B(R[1]);X=B(R[2])}R=B(R[0]);(X==null)&&(E=X);if(E==null||X==null){var S=this.getBBox(1);E=S.x+S.width/2;X=S.y+S.height/2}this.transform(this._.transform.concat([["r",R,E,X]]));return this};A.scale=function(Y,S,E,X){if(this.removed){return this}Y=V(Y).split(o);if(Y.length-1){S=B(Y[1]);E=B(Y[2]);X=B(Y[3])}Y=B(Y[0]);(S==null)&&(S=Y);(X==null)&&(E=X);if(E==null||X==null){var R=this.getBBox(1)}E=E==null?R.x+R.width/2:E;X=X==null?R.y+R.height/2:X;this.transform(this._.transform.concat([["s",Y,S,E,X]]));return this};A.translate=function(R,E){if(this.removed){return this}R=V(R).split(o);if(R.length-1){E=B(R[1])}R=B(R[0])||0;E=+E||0;this.transform(this._.transform.concat([["t",R,E]]));return this};A.transform=function(R){var S=this._;if(R==null){return S.transform}x._extractTransform(this,R);this.clip&&s(this.clip,{transform:this.matrix.invert()});this.pattern&&g(this);this.node&&s(this.node,{transform:this.matrix});if(S.sx!=1||S.sy!=1){var E=this.attrs[l]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":E})}return this};A.hide=function(){if(!this.removed){this.node.style.display="none"}return this};A.show=function(){if(!this.removed){this.node.style.display=""}return this};A.remove=function(){var R=N(this.node);if(this.removed||!R.parentNode){return}var S=this.paper;S.__set__&&S.__set__.exclude(this);T.unbind("raphael.*.*."+this.id);if(this.gradient){S.defs.removeChild(this.gradient)}x._tear(this,S);R.parentNode.removeChild(R);this.removeData();for(var E in this){this[E]=typeof this[E]=="function"?x._removedFactory(E):null}this.removed=true};A._getBBox=function(){if(this.node.style.display=="none"){this.show();var E=true}var Y=false,R;if(this.paper.canvas.parentElement){R=this.paper.canvas.parentElement.style}else{if(this.paper.canvas.parentNode){R=this.paper.canvas.parentNode.style}}if(R&&R.display=="none"){Y=true;R.display=""}var X={};try{X=this.node.getBBox()}catch(S){X={x:this.node.clientLeft,y:this.node.clientTop,width:this.node.clientWidth,height:this.node.clientHeight}}finally{X=X||{};if(Y){R.display="none"}}E&&this.hide();return X};A.attr=function(E,ad){if(this.removed){return this}if(E==null){var aa={};for(var ac in this.attrs){if(this.attrs[l](ac)){aa[ac]=this.attrs[ac]}}aa.gradient&&aa.fill=="none"&&(aa.fill=aa.gradient)&&delete aa.gradient;aa.transform=this._.transform;return aa}if(ad==null&&x.is(E,"string")){if(E=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}if(E=="transform"){return this._.transform}var ab=E.split(o),X={};for(var Y=0,af=ab.length;Y<af;Y++){E=ab[Y];if(E in this.attrs){X[E]=this.attrs[E]}else{if(x.is(this.paper.customAttributes[E],"function")){X[E]=this.paper.customAttributes[E].def}else{X[E]=x._availableAttrs[E]}}}return af-1?X:X[ab[0]]}if(ad==null&&x.is(E,"array")){X={};for(Y=0,af=E.length;Y<af;Y++){X[E[Y]]=this.attr(E[Y])}return X}if(ad!=null){var R={};R[E]=ad}else{if(E!=null&&x.is(E,"object")){R=E}}for(var ae in R){T("raphael.attr."+ae+"."+this.id,this,R[ae])}for(ae in this.paper.customAttributes){if(this.paper.customAttributes[l](ae)&&R[l](ae)&&x.is(this.paper.customAttributes[ae],"function")){var Z=this.paper.customAttributes[ae].apply(this,[].concat(R[ae]));this.attrs[ae]=R[ae];for(var S in Z){if(Z[l](S)){R[S]=Z[S]}}}}O(this,R);return this};A.toFront=function(){if(this.removed){return this}var R=N(this.node);R.parentNode.appendChild(R);var E=this.paper;E.top!=this&&x._tofront(this,E);return this};A.toBack=function(){if(this.removed){return this}var S=N(this.node);var E=S.parentNode;E.insertBefore(S,E.firstChild);x._toback(this,this.paper);var R=this.paper;return this};A.insertAfter=function(E){if(this.removed||!E){return this}var R=N(this.node);var S=N(E.node||E[E.length-1].node);if(S.nextSibling){S.parentNode.insertBefore(R,S.nextSibling)}else{S.parentNode.appendChild(R)}x._insertafter(this,E,this.paper);return this};A.insertBefore=function(R){if(this.removed||!R){return this}var S=N(this.node);var E=N(R.node||R[0].node);E.parentNode.insertBefore(S,E);x._insertbefore(this,R,this.paper);return this};A.blur=function(R){var E=this;if(+R!==0){var S=s("filter"),X=s("feGaussianBlur");E.attrs.blur=R;S.id=x.createUUID();s(X,{stdDeviation:+R||1.5});S.appendChild(X);E.paper.defs.appendChild(S);E._blur=S;s(E.node,{filter:"url(#"+S.id+")"})}else{if(E._blur){E._blur.parentNode.removeChild(E._blur);delete E._blur;delete E.attrs.blur}E.node.removeAttribute("filter")}return E};x._engine.circle=function(R,E,Z,Y){var X=s("circle");R.canvas&&R.canvas.appendChild(X);var S=new K(X,R);S.attrs={cx:E,cy:Z,r:Y,fill:"none",stroke:"#000"};S.type="circle";s(X,S.attrs);return S};x._engine.rect=function(S,E,ab,R,Z,aa){var Y=s("rect");S.canvas&&S.canvas.appendChild(Y);var X=new K(Y,S);X.attrs={x:E,y:ab,width:R,height:Z,rx:aa||0,ry:aa||0,fill:"none",stroke:"#000"};X.type="rect";s(Y,X.attrs);return X};x._engine.ellipse=function(R,E,aa,Z,Y){var X=s("ellipse");R.canvas&&R.canvas.appendChild(X);var S=new K(X,R);S.attrs={cx:E,cy:aa,rx:Z,ry:Y,fill:"none",stroke:"#000"};S.type="ellipse";s(X,S.attrs);return S};x._engine.image=function(S,aa,E,ab,R,Z){var Y=s("image");s(Y,{x:E,y:ab,width:R,height:Z,preserveAspectRatio:"none"});Y.setAttributeNS(C,"href",aa);S.canvas&&S.canvas.appendChild(Y);var X=new K(Y,S);X.attrs={x:E,y:ab,width:R,height:Z,src:aa};X.type="image";return X};x._engine.text=function(R,E,Z,Y){var X=s("text");R.canvas&&R.canvas.appendChild(X);var S=new K(X,R);S.attrs={x:E,y:Z,"text-anchor":"middle",text:Y,"font-family":x._availableAttrs["font-family"],"font-size":x._availableAttrs["font-size"],stroke:"none",fill:"#000"};S.type="text";O(S,S.attrs);return S};x._engine.setSize=function(R,E){this.width=R||this.width;this.height=E||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);if(this._viewBox){this.setViewBox.apply(this,this._viewBox)}return this};x._engine.create=function(){var X=x._getContainer.apply(0,arguments),R=X&&X.container,ab=X.x,aa=X.y,S=X.width,ac=X.height;if(!R){throw new Error("SVG container not found.")}var E=s("svg"),Z="overflow:hidden;",Y;ab=ab||0;aa=aa||0;S=S||512;ac=ac||342;s(E,{height:ac,version:1.1,width:S,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"});if(R==1){E.style.cssText=Z+"position:absolute;left:"+ab+"px;top:"+aa+"px";x._g.doc.body.appendChild(E);Y=1}else{E.style.cssText=Z+"position:relative";if(R.firstChild){R.insertBefore(E,R.firstChild)}else{R.appendChild(E)}}R=new x._Paper;R.width=S;R.height=ac;R.canvas=E;R.clear();R._left=R._top=0;Y&&(R.renderfix=function(){});R.renderfix();return R};x._engine.setViewBox=function(aa,Y,ac,R,S){T("raphael.setViewBox",this,this._viewBox,[aa,Y,ac,R,S]);var E=this.getSize(),ae=W(ac/E.width,R/E.height),Z=this.top,ad=S?"xMidYMid meet":"xMinYMin",X,ab;if(aa==null){if(this._vbSize){ae=1}delete this._vbSize;X="0 0 "+this.width+u+this.height}else{this._vbSize=ae;X=aa+u+Y+u+ac+u+R}s(this.canvas,{viewBox:X,preserveAspectRatio:ad});while(ae&&Z){ab="stroke-width" in Z.attrs?Z.attrs["stroke-width"]:1;Z.attr({"stroke-width":ab});Z._.dirty=1;Z._.dirtyT=1;Z=Z.prev}this._viewBox=[aa,Y,ac,R,!!S];return this};x.prototype.renderfix=function(){var Z=this.canvas,E=Z.style,Y;try{Y=Z.getScreenCTM()||Z.createSVGMatrix()}catch(X){Y=Z.createSVGMatrix()}var S=-Y.e%1,R=-Y.f%1;if(S||R){if(S){this._left=(this._left+S)%1;E.left=this._left+"px"}if(R){this._top=(this._top+R)%1;E.top=this._top+"px"}}};x.prototype.clear=function(){x.eve("raphael.clear",this);var E=this.canvas;while(E.firstChild){E.removeChild(E.firstChild)}this.bottom=this.top=null;(this.desc=s("desc")).appendChild(x._g.doc.createTextNode("Created with Rapha\xebl "+x.version));E.appendChild(this.desc);E.appendChild(this.defs=s("defs"))};x.prototype.remove=function(){T("raphael.remove",this);this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var E in this){this[E]=typeof this[E]=="function"?x._removedFactory(E):null}};var P=x.st;for(var m in A){if(A[l](m)&&!P[l](m)){P[m]=(function(E){return function(){var R=arguments;return this.forEach(function(S){S[E].apply(S,R)})}})(m)}}}.apply(b,a),e!==undefined&&(c.exports=e))},function(c,b,d){var a,e;!(a=[d(1)],e=function(w){if(w&&!w.vml){return}var m="hasOwnProperty",U=String,A=parseFloat,q=Math,P=q.round,X=q.max,Q=q.min,G=q.abs,J="fill",r=/[, ]+/,O=w.eve,K=" progid:DXImageTransform.Microsoft",u=" ",D="",T={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},s=/([clmz]),?([^clmz]*)/gi,H=/ progid:\S+Blur\([^\)]+\)/g,W=/-?[^,\s-]+/g,l="position:absolute;left:0;top:0;width:1px;height:1px;behavior:url(#default#VML)",g=21600,N={path:1,rect:1,image:1},F={circle:1,ellipse:1},n=function(af){var ac=/[ahqstv]/ig,S=w._pathToAbsolute;U(af).match(ac)&&(S=w._path2curve);ac=/[clmz]/g;if(S==w._pathToAbsolute&&!U(af).match(ac)){var ab=U(af).replace(s,function(aj,al,ah){var ak=[],ag=al.toLowerCase()=="m",ai=T[al];ah.replace(W,function(am){if(ag&&ak.length==2){ai+=ak+T[al=="m"?"l":"L"];ak=[]}ak.push(P(am*g))});return ai+ak});return ab}var ad=S(af),R,E;ab=[];for(var Z=0,ae=ad.length;Z<ae;Z++){R=ad[Z];E=ad[Z][0].toLowerCase();E=="z"&&(E="x");for(var Y=1,aa=R.length;Y<aa;Y++){E+=P(R[Y]*g)+(Y!=aa-1?",":D)}ab.push(E)}return ab.join(u)},B=function(Y,S,R){var E=w.matrix();E.rotate(-Y,0.5,0.5);return{dx:E.x(S,R),dy:E.y(S,R)}},C=function(ae,ad,ac,Z,Y,aa){var am=ae._,ag=ae.matrix,E=am.fillpos,af=ae.node,ab=af.style,S=1,R="",ai,ak=g/ad,aj=g/ac;ab.visibility="hidden";if(!ad||!ac){return}af.coordsize=G(ak)+u+G(aj);ab.rotation=aa*(ad*ac<0?-1:1);if(aa){var al=B(aa,Z,Y);Z=al.dx;Y=al.dy}ad<0&&(R+="x");ac<0&&(R+=" y")&&(S=-1);ab.flip=R;af.coordorigin=(Z*-ak)+u+(Y*-aj);if(E||am.fillsize){var ah=af.getElementsByTagName(J);ah=ah&&ah[0];af.removeChild(ah);if(E){al=B(aa,ag.x(E[0],E[1]),ag.y(E[0],E[1]));ah.position=al.dx*S+u+al.dy*S}if(am.fillsize){ah.size=am.fillsize[0]*G(ad)+u+am.fillsize[1]*G(ac)}af.appendChild(ah)}ab.visibility="visible"};w.toString=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\xebl "+this.version};var j=function(E,ab,R){var ad=U(ab).toLowerCase().split("-"),Z=R?"end":"start",S=ad.length,aa="classic",ac="medium",Y="medium";while(S--){switch(ad[S]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":aa=ad[S];break;case"wide":case"narrow":Y=ad[S];break;case"long":case"short":ac=ad[S];break}}var ae=E.node.getElementsByTagName("stroke")[0];ae[Z+"arrow"]=aa;ae[Z+"arrowlength"]=ac;ae[Z+"arrowwidth"]=Y},L=function(am,ax){am.attrs=am.attrs||{};var ar=am.node,aB=am.attrs,ai=ar.style,ae,av=N[am.type]&&(ax.x!=aB.x||ax.y!=aB.y||ax.width!=aB.width||ax.height!=aB.height||ax.cx!=aB.cx||ax.cy!=aB.cy||ax.rx!=aB.rx||ax.ry!=aB.ry||ax.r!=aB.r),al=F[am.type]&&(aB.cx!=ax.cx||aB.cy!=ax.cy||aB.r!=ax.r||aB.rx!=ax.rx||aB.ry!=ax.ry),aE=am;for(var aj in ax){if(ax[m](aj)){aB[aj]=ax[aj]}}if(av){aB.path=w._getPath[am.type](am);am._.dirty=1}ax.href&&(ar.href=ax.href);ax.title&&(ar.title=ax.title);ax.target&&(ar.target=ax.target);ax.cursor&&(ai.cursor=ax.cursor);"blur" in ax&&am.blur(ax.blur);if(ax.path&&am.type=="path"||av){ar.path=n(~U(aB.path).toLowerCase().indexOf("r")?w._pathToAbsolute(aB.path):aB.path);am._.dirty=1;if(am.type=="image"){am._.fillpos=[aB.x,aB.y];am._.fillsize=[aB.width,aB.height];C(am,1,1,0,0,0)}}"transform" in ax&&am.transform(ax.transform);if(al){var Z=+aB.cx,S=+aB.cy,ad=+aB.rx||+aB.r||0,ac=+aB.ry||+aB.r||0;ar.path=w.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",P((Z-ad)*g),P((S-ac)*g),P((Z+ad)*g),P((S+ac)*g),P(Z*g));am._.dirty=1}if("clip-rect" in ax){var R=U(ax["clip-rect"]).split(r);if(R.length==4){R[2]=+R[2]+(+R[0]);R[3]=+R[3]+(+R[1]);var ak=ar.clipRect||w._g.doc.createElement("div"),aD=ak.style;aD.clip=w.format("rect({1}px {2}px {3}px {0}px)",R);if(!ar.clipRect){aD.position="absolute";aD.top=0;aD.left=0;aD.width=am.paper.width+"px";aD.height=am.paper.height+"px";ar.parentNode.insertBefore(ak,ar);ak.appendChild(ar);ar.clipRect=ak}}if(!ax["clip-rect"]){ar.clipRect&&(ar.clipRect.style.clip="auto")}}if(am.textpath){var az=am.textpath.style;ax.font&&(az.font=ax.font);ax["font-family"]&&(az.fontFamily='"'+ax["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,D)+'"');ax["font-size"]&&(az.fontSize=ax["font-size"]);ax["font-weight"]&&(az.fontWeight=ax["font-weight"]);ax["font-style"]&&(az.fontStyle=ax["font-style"])}if("arrow-start" in ax){j(aE,ax["arrow-start"])}if("arrow-end" in ax){j(aE,ax["arrow-end"],1)}if(ax.opacity!=null||ax.fill!=null||ax.src!=null||ax.stroke!=null||ax["stroke-width"]!=null||ax["stroke-opacity"]!=null||ax["fill-opacity"]!=null||ax["stroke-dasharray"]!=null||ax["stroke-miterlimit"]!=null||ax["stroke-linejoin"]!=null||ax["stroke-linecap"]!=null){var at=ar.getElementsByTagName(J),aA=false;at=at&&at[0];!at&&(aA=at=V(J));if(am.type=="image"&&ax.src){at.src=ax.src}ax.fill&&(at.on=true);if(at.on==null||ax.fill=="none"||ax.fill===null){at.on=false}if(at.on&&ax.fill){var ab=U(ax.fill).match(w._ISURL);if(ab){at.parentNode==ar&&ar.removeChild(at);at.rotate=true;at.src=ab[1];at.type="tile";var E=am.getBBox(1);at.position=E.x+u+E.y;am._.fillpos=[E.x,E.y];w._preload(ab[1],function(){am._.fillsize=[this.offsetWidth,this.offsetHeight]})}else{at.color=w.getRGB(ax.fill).hex;at.src=D;at.type="solid";if(w.getRGB(ax.fill).error&&(aE.type in {circle:1,ellipse:1}||U(ax.fill).charAt()!="r")&&f(aE,ax.fill,at)){aB.fill="none";aB.gradient=ax.fill;at.rotate=false}}}if("fill-opacity" in ax||"opacity" in ax){var aa=((+aB["fill-opacity"]+1||2)-1)*((+aB.opacity+1||2)-1)*((+w.getRGB(ax.fill).o+1||2)-1);aa=Q(X(aa,0),1);at.opacity=aa;if(at.src){at.color="none"}}ar.appendChild(at);var af=(ar.getElementsByTagName("stroke")&&ar.getElementsByTagName("stroke")[0]),aC=false;!af&&(aC=af=V("stroke"));if((ax.stroke&&ax.stroke!="none")||ax["stroke-width"]||ax["stroke-opacity"]!=null||ax["stroke-dasharray"]||ax["stroke-miterlimit"]||ax["stroke-linejoin"]||ax["stroke-linecap"]){af.on=true}(ax.stroke=="none"||ax.stroke===null||af.on==null||ax.stroke==0||ax["stroke-width"]==0)&&(af.on=false);var aq=w.getRGB(ax.stroke);af.on&&ax.stroke&&(af.color=aq.hex);aa=((+aB["stroke-opacity"]+1||2)-1)*((+aB.opacity+1||2)-1)*((+aq.o+1||2)-1);var an=(A(ax["stroke-width"])||1)*0.75;aa=Q(X(aa,0),1);ax["stroke-width"]==null&&(an=aB["stroke-width"]);ax["stroke-width"]&&(af.weight=an);an&&an<1&&(aa*=an)&&(af.weight=1);af.opacity=aa;ax["stroke-linejoin"]&&(af.joinstyle=ax["stroke-linejoin"]||"miter");af.miterlimit=ax["stroke-miterlimit"]||8;ax["stroke-linecap"]&&(af.endcap=ax["stroke-linecap"]=="butt"?"flat":ax["stroke-linecap"]=="square"?"square":"round");if("stroke-dasharray" in ax){var ap={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};af.dashstyle=ap[m](ax["stroke-dasharray"])?ap[ax["stroke-dasharray"]]:D}aC&&ar.appendChild(af)}if(aE.type=="text"){aE.paper.canvas.style.display=D;var au=aE.paper.span,ao=100,Y=aB.font&&aB.font.match(/\d+(?:\.\d*)?(?=px)/);ai=au.style;aB.font&&(ai.font=aB.font);aB["font-family"]&&(ai.fontFamily=aB["font-family"]);aB["font-weight"]&&(ai.fontWeight=aB["font-weight"]);aB["font-style"]&&(ai.fontStyle=aB["font-style"]);Y=A(aB["font-size"]||Y&&Y[0])||10;ai.fontSize=Y*ao+"px";aE.textpath.string&&(au.innerHTML=U(aE.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var ah=au.getBoundingClientRect();aE.W=aB.w=(ah.right-ah.left)/ao;aE.H=aB.h=(ah.bottom-ah.top)/ao;aE.X=aB.x;aE.Y=aB.y+aE.H/2;("x" in ax||"y" in ax)&&(aE.path.v=w.format("m{0},{1}l{2},{1}",P(aB.x*g),P(aB.y*g),P(aB.x*g)+1));var ag=["x","y","text","font","font-family","font-weight","font-style","font-size"];for(var aw=0,ay=ag.length;aw<ay;aw++){if(ag[aw] in ax){aE._.dirty=1;break}}switch(aB["text-anchor"]){case"start":aE.textpath.style["v-text-align"]="left";aE.bbx=aE.W/2;break;case"end":aE.textpath.style["v-text-align"]="right";aE.bbx=-aE.W/2;break;default:aE.textpath.style["v-text-align"]="center";aE.bbx=0;break}aE.textpath.style["v-text-kern"]=true}},f=function(E,ae,ah){E.attrs=E.attrs||{};var af=E.attrs,Y=Math.pow,Z,aa,ac="linear",ad=".5 .5";E.attrs.gradient=ae;ae=U(ae).replace(w._radial_gradient,function(ak,al,aj){ac="radial";if(al&&aj){al=A(al);aj=A(aj);Y(al-0.5,2)+Y(aj-0.5,2)>0.25&&(aj=q.sqrt(0.25-Y(al-0.5,2))*((aj>0.5)*2-1)+0.5);ad=al+u+aj}return D});ae=ae.split(/\s*\-\s*/);if(ac=="linear"){var R=ae.shift();R=-A(R);if(isNaN(R)){return null}}var ab=w._parseDots(ae);if(!ab){return null}E=E.shape||E.node;if(ab.length){E.removeChild(ah);ah.on=true;ah.method="none";ah.color=ab[0].color;ah.color2=ab[ab.length-1].color;var ai=[];for(var S=0,ag=ab.length;S<ag;S++){ab[S].offset&&ai.push(ab[S].offset+u+ab[S].color)}ah.colors=ai.length?ai.join():"0% "+ah.color;if(ac=="radial"){ah.type="gradientTitle";ah.focus="100%";ah.focussize="0 0";ah.focusposition=ad;ah.angle=0}else{ah.type="gradient";ah.angle=(270-R)%360}E.appendChild(ah)}return 1},I=function(R,E){this[0]=this.node=R;R.raphael=true;this.id=w._oid++;R.raphaelid=this.id;this.X=0;this.Y=0;this.attrs={};this.paper=E;this.matrix=w.matrix();this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1};!E.bottom&&(E.bottom=this);this.prev=E.top;E.top&&(E.top.next=this);E.top=this;this.next=null};var x=w.el;I.prototype=x;x.constructor=I;x.transform=function(Z){if(Z==null){return this._.transform}var ab=this.paper._viewBoxShift,aa=ab?"s"+[ab.scale,ab.scale]+"-1-1t"+[ab.dx,ab.dy]:D,ae;if(ab){ae=Z=U(Z).replace(/\.{3}|\u2026/g,this._.transform||D)}w._extractTransform(this,aa+Z);var af=this.matrix.clone(),ah=this.skew,S=this.node,ad,Y=~U(this.attrs.fill).indexOf("-"),E=!U(this.attrs.fill).indexOf("url(");af.translate(1,1);if(E||Y||this.type=="image"){ah.matrix="1 0 0 1";ah.offset="0 0";ad=af.split();if((Y&&ad.noRotation)||!ad.isSimple){S.style.filter=af.toFilter();var ac=this.getBBox(),R=this.getBBox(1),ai=ac.x-R.x,ag=ac.y-R.y;S.coordorigin=(ai*-g)+u+(ag*-g);C(this,1,1,ai,ag,0)}else{S.style.filter=D;C(this,ad.scalex,ad.scaley,ad.dx,ad.dy,ad.rotate)}}else{S.style.filter=D;ah.matrix=U(af);ah.offset=af.offset()}if(ae!==null){this._.transform=ae;w._extractTransform(this,ae)}return this};x.rotate=function(R,E,Y){if(this.removed){return this}if(R==null){return}R=U(R).split(r);if(R.length-1){E=A(R[1]);Y=A(R[2])}R=A(R[0]);(Y==null)&&(E=Y);if(E==null||Y==null){var S=this.getBBox(1);E=S.x+S.width/2;Y=S.y+S.height/2}this._.dirtyT=1;this.transform(this._.transform.concat([["r",R,E,Y]]));return this};x.translate=function(R,E){if(this.removed){return this}R=U(R).split(r);if(R.length-1){E=A(R[1])}R=A(R[0])||0;E=+E||0;if(this._.bbox){this._.bbox.x+=R;this._.bbox.y+=E}this.transform(this._.transform.concat([["t",R,E]]));return this};x.scale=function(Z,S,E,Y){if(this.removed){return this}Z=U(Z).split(r);if(Z.length-1){S=A(Z[1]);E=A(Z[2]);Y=A(Z[3]);isNaN(E)&&(E=null);isNaN(Y)&&(Y=null)}Z=A(Z[0]);(S==null)&&(S=Z);(Y==null)&&(E=Y);if(E==null||Y==null){var R=this.getBBox(1)}E=E==null?R.x+R.width/2:E;Y=Y==null?R.y+R.height/2:Y;this.transform(this._.transform.concat([["s",Z,S,E,Y]]));this._.dirtyT=1;return this};x.hide=function(){!this.removed&&(this.node.style.display="none");return this};x.show=function(){!this.removed&&(this.node.style.display=D);return this};x.auxGetBBox=w.el.getBBox;x.getBBox=function(){var E=this.auxGetBBox();if(this.paper&&this.paper._viewBoxShift){var S={};var R=1/this.paper._viewBoxShift.scale;S.x=E.x-this.paper._viewBoxShift.dx;S.x*=R;S.y=E.y-this.paper._viewBoxShift.dy;S.y*=R;S.width=E.width*R;S.height=E.height*R;S.x2=S.x+S.width;S.y2=S.y+S.height;return S}return E};x._getBBox=function(){if(this.removed){return{}}return{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}};x.remove=function(){if(this.removed||!this.node.parentNode){return}this.paper.__set__&&this.paper.__set__.exclude(this);w.eve.unbind("raphael.*.*."+this.id);w._tear(this,this.paper);this.node.parentNode.removeChild(this.node);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var E in this){this[E]=typeof this[E]=="function"?w._removedFactory(E):null}this.removed=true};x.attr=function(E,ae){if(this.removed){return this}if(E==null){var ab={};for(var ad in this.attrs){if(this.attrs[m](ad)){ab[ad]=this.attrs[ad]}}ab.gradient&&ab.fill=="none"&&(ab.fill=ab.gradient)&&delete ab.gradient;ab.transform=this._.transform;return ab}if(ae==null&&w.is(E,"string")){if(E==J&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}var ac=E.split(r),Y={};for(var Z=0,ag=ac.length;Z<ag;Z++){E=ac[Z];if(E in this.attrs){Y[E]=this.attrs[E]}else{if(w.is(this.paper.customAttributes[E],"function")){Y[E]=this.paper.customAttributes[E].def}else{Y[E]=w._availableAttrs[E]}}}return ag-1?Y:Y[ac[0]]}if(this.attrs&&ae==null&&w.is(E,"array")){Y={};for(Z=0,ag=E.length;Z<ag;Z++){Y[E[Z]]=this.attr(E[Z])}return Y}var R;if(ae!=null){R={};R[E]=ae}ae==null&&w.is(E,"object")&&(R=E);for(var af in R){O("raphael.attr."+af+"."+this.id,this,R[af])}if(R){for(af in this.paper.customAttributes){if(this.paper.customAttributes[m](af)&&R[m](af)&&w.is(this.paper.customAttributes[af],"function")){var aa=this.paper.customAttributes[af].apply(this,[].concat(R[af]));this.attrs[af]=R[af];for(var S in aa){if(aa[m](S)){R[S]=aa[S]}}}}if(R.text&&this.type=="text"){this.textpath.string=R.text}L(this,R)}return this};x.toFront=function(){!this.removed&&this.node.parentNode.appendChild(this.node);this.paper&&this.paper.top!=this&&w._tofront(this,this.paper);return this};x.toBack=function(){if(this.removed){return this}if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild);w._toback(this,this.paper)}return this};x.insertAfter=function(E){if(this.removed){return this}if(E.constructor==w.st.constructor){E=E[E.length-1]}if(E.node.nextSibling){E.node.parentNode.insertBefore(this.node,E.node.nextSibling)}else{E.node.parentNode.appendChild(this.node)}w._insertafter(this,E,this.paper);return this};x.insertBefore=function(E){if(this.removed){return this}if(E.constructor==w.st.constructor){E=E[0]}E.node.parentNode.insertBefore(this.node,E.node);w._insertbefore(this,E,this.paper);return this};x.blur=function(E){var R=this.node.runtimeStyle,S=R.filter;S=S.replace(H,D);if(+E!==0){this.attrs.blur=E;R.filter=S+u+K+".Blur(pixelradius="+(+E||1.5)+")";R.margin=w.format("-{0}px 0 0 -{0}px",P(+E||1.5))}else{R.filter=S;R.margin=0;delete this.attrs.blur}return this};w._engine.path=function(Y,R){var Z=V("shape");Z.style.cssText=l;Z.coordsize=g+u+g;Z.coordorigin=R.coordorigin;var aa=new I(Z,R),E={fill:"none",stroke:"#000"};Y&&(E.path=Y);aa.type="path";aa.path=[];aa.Path=D;L(aa,E);R.canvas&&R.canvas.appendChild(Z);var S=V("skew");S.on=true;Z.appendChild(S);aa.skew=S;aa.transform(D);return aa};w._engine.rect=function(R,ab,Z,ac,S,E){var ad=w._rectPath(ab,Z,ac,S,E),Y=R.path(ad),aa=Y.attrs;Y.X=aa.x=ab;Y.Y=aa.y=Z;Y.W=aa.width=ac;Y.H=aa.height=S;aa.r=E;aa.path=ad;Y.type="rect";return Y};w._engine.ellipse=function(R,E,ab,aa,Z){var Y=R.path(),S=Y.attrs;Y.X=E-aa;Y.Y=ab-Z;Y.W=aa*2;Y.H=Z*2;Y.type="ellipse";L(Y,{cx:E,cy:ab,rx:aa,ry:Z});return Y};w._engine.circle=function(R,E,aa,Z){var Y=R.path(),S=Y.attrs;Y.X=E-Z;Y.Y=aa-Z;Y.W=Y.H=Z*2;Y.type="circle";L(Y,{cx:E,cy:aa,r:Z});return Y};w._engine.image=function(R,E,ac,aa,ad,Y){var af=w._rectPath(ac,aa,ad,Y),Z=R.path(af).attr({stroke:"none"}),ab=Z.attrs,S=Z.node,ae=S.getElementsByTagName(J)[0];ab.src=E;Z.X=ab.x=ac;Z.Y=ab.y=aa;Z.W=ab.width=ad;Z.H=ab.height=Y;ab.path=af;Z.type="image";ae.parentNode==S&&S.removeChild(ae);ae.rotate=true;ae.src=E;ae.type="tile";Z._.fillpos=[ac,aa];Z._.fillsize=[ad,Y];S.appendChild(ae);C(Z,1,1,0,0,0);return Z};w._engine.text=function(E,ab,aa,ac){var Y=V("shape"),ae=V("path"),S=V("textpath");ab=ab||0;aa=aa||0;ac=ac||"";ae.v=w.format("m{0},{1}l{2},{1}",P(ab*g),P(aa*g),P(ab*g)+1);ae.textpathok=true;S.string=U(ac);S.on=true;Y.style.cssText=l;Y.coordsize=g+u+g;Y.coordorigin="0 0";var R=new I(Y,E),Z={fill:"#000",stroke:"none",font:w._availableAttrs.font,text:ac};R.shape=Y;R.path=ae;R.textpath=S;R.type="text";R.attrs.text=U(ac);R.attrs.x=ab;R.attrs.y=aa;R.attrs.w=1;R.attrs.h=1;L(R,Z);Y.appendChild(S);Y.appendChild(ae);E.canvas.appendChild(Y);var ad=V("skew");ad.on=true;Y.appendChild(ad);R.skew=ad;R.transform(D);return R};w._engine.setSize=function(S,E){var R=this.canvas.style;this.width=S;this.height=E;S==+S&&(S+="px");E==+E&&(E+="px");R.width=S;R.height=E;R.clip="rect(0 "+S+" "+E+" 0)";if(this._viewBox){w._engine.setViewBox.apply(this,this._viewBox)}return this};w._engine.setViewBox=function(ab,aa,ac,Y,Z){w.eve("raphael.setViewBox",this,this._viewBox,[ab,aa,ac,Y,Z]);var S=this.getSize(),E=S.width,ae=S.height,ad,R;if(Z){ad=ae/Y;R=E/ac;if(ac*ad<E){ab-=(E-ac*ad)/2/ad}if(Y*R<ae){aa-=(ae-Y*R)/2/R}}this._viewBox=[ab,aa,ac,Y,!!Z];this._viewBoxShift={dx:-ab,dy:-aa,scale:S};this.forEach(function(af){af.transform("...")});return this};var V;w._engine.initWin=function(S){var R=S.document;if(R.styleSheets.length<31){R.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)")}else{R.styleSheets[0].addRule(".rvml","behavior:url(#default#VML)")}try{!R.namespaces.rvml&&R.namespaces.add("rvml","urn:schemas-microsoft-com:vml");V=function(Y){return R.createElement("<rvml:"+Y+' class="rvml">')}}catch(E){V=function(Y){return R.createElement("<"+Y+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}};w._engine.initWin(w._g.win);w._engine.create=function(){var S=w._getContainer.apply(0,arguments),E=S.container,ad=S.height,ae,R=S.width,ac=S.x,ab=S.y;if(!E){throw new Error("VML container not found.")}var Z=new w._Paper,aa=Z.canvas=w._g.doc.createElement("div"),Y=aa.style;ac=ac||0;ab=ab||0;R=R||512;ad=ad||342;Z.width=R;Z.height=ad;R==+R&&(R+="px");ad==+ad&&(ad+="px");Z.coordsize=g*1000+u+g*1000;Z.coordorigin="0 0";Z.span=w._g.doc.createElement("span");Z.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;";aa.appendChild(Z.span);Y.cssText=w.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",R,ad);if(E==1){w._g.doc.body.appendChild(aa);Y.left=ac+"px";Y.top=ab+"px";Y.position="absolute"}else{if(E.firstChild){E.insertBefore(aa,E.firstChild)}else{E.appendChild(aa)}}Z.renderfix=function(){};return Z};w.prototype.clear=function(){w.eve("raphael.clear",this);this.canvas.innerHTML=D;this.span=w._g.doc.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas.appendChild(this.span);this.bottom=this.top=null};w.prototype.remove=function(){w.eve("raphael.remove",this);this.canvas.parentNode.removeChild(this.canvas);for(var E in this){this[E]=typeof this[E]=="function"?w._removedFactory(E):null}return true};var M=w.st;for(var o in x){if(x[m](o)&&!M[m](o)){M[o]=(function(E){return function(){var R=arguments;return this.forEach(function(S){S[E].apply(S,R)})}})(o)}}}.apply(b,a),e!==undefined&&(c.exports=e))}])});xui.Class("xui.svg","xui.UI",{Before:function(b,a,c){xui.absBox.$type[b.replace("xui.","")]=xui.absBox.$type[b]=b;return true},Initialize:function(){if(typeof(Raphael)=="function"){Raphael._availableAttrs.href="";Raphael._availableAttrs.title="";Raphael.el.shadow=function(){var M=this;if(M.type=="text"){return null}M._.dirty=true;var Q=M.attr("stroke-width"),A=M.attr("fill"),q=M.attr("opacity"),K=M.attr("fill-opacity"),G=M.attr("transform"),D=4,e=M.paper,u=e.set(),U=M._getBBox(false),l=!U.width?0:(U.width+Q-D-4)/U.width,j=!U.height?0:(U.height+Q-D-4)/U.height,W=M.getPath();if(A!=="none"&&K!==0){W=Raphael.transformPath(W,"t"+(Q/2)+","+(Q/2)+"s"+l+","+j+","+(U.x+U.width+Q)+","+(U.y+U.height+Q))}else{W=Raphael.transformPath(W,"t"+D/2+","+D/2)}for(var w=1,V;w<D+1;w++){V=e.path(W).attr({stroke:"#666",fill:A=="none"?"none":"#555","fill-opacity":K,"stroke-linejoin":"round","stroke-linecap":"round","stroke-width":2*w,opacity:(0.2*(1-w/D)+0.05)*q});V._decoration=1;u.push(V)}if(G&&G.length){u.transform(G)}return u.insertBefore(M)};var I=function(){var j=arguments,o=j.length,e=0,l;for(;e<o;e++){if((l=j[e])||!(l!==!1&&l!==0)){return l}}},C=function(){var j=arguments,o=j.length,e=0,l;for(;e<o;e++){if((l=j[e])||!(l!==!1&&l!==0)){if(!isNaN(l=Number(l))){return l}}}},E=function(e){return"matrix("+[e.get(0),e.get(1),e.get(2),e.get(3),e.get(4),e.get(5)].join()+")"},Y=/^matrix\(|\)$/g,m=/\,/g,Z=/\n|<br\s*?\/?>/gi,S=/[^\d\.]/gi,c=/[\(\)\s,\xb0#]/g,ac=/group/gi,x=/&/g,f=/"/g,n=/'/g,B=/</g,ab=/>/g,L=0,R=Math,H=parseFloat,J=R.max,T=R.abs,F=R.pow,O=String,g=/[, ]+/,d=[{reg:/xmlns\=\"http\:\/\/www.w3.org\/2000\/svg\"/gi,str:""},{reg:/^.*<svg /,str:'<svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" '},{reg:/\/svg>.*$/,str:"/svg>"},{reg:/\<desc[\s\>][^\<]*\<\/desc\>/,str:""},{reg:/zIndex="[^"]+"/g,str:""},{reg:/url\((\\?[\'\"])[^#]+#/g,str:"url($1#"},{reg:/ href=/g,str:" xlink:href="},{reg:/(id|class|width|height)=([^" >]+)/g,str:'$1="$2"'},{reg:/:(path|rect)/g,str:"$1"},{reg:/\<ima?ge? ([^\>]+?)[^\/]\>/gi,str:"<image $1 />"},{reg:/\<\/ima?ge?\>/g,str:""},{reg:/style="([^"]+)"/g,str:function(j){return j.toLowerCase()}}],b={blur:function(){},transform:function(){},src:function(j,l){l.attrSTR+=' xlink:href="'+l.attrs.src+'"'},path:function(l,o){var j=o.attrs.path,j=Raphael._pathToAbsolute(j||"");o.attrSTR+=' d="'+(j.toString&&j.toString()||"").replace(m," ")+'"'},gradient:function(A,D,o){var K=A.attrs.gradient,s="linear",M,q,G=0.5,l=0.5,j=q="",U="";M=K.replace(c,"_");if(!o[M]){K=O(K).replace(Raphael._radial_gradient,function(u,r,w){s="radial";r&&w&&(G=H(r),l=H(w),u=(l>0.5)*2-1,F(G-0.5,2)+F(l-0.5,2)>0.25&&(l=R.sqrt(0.25-F(G-0.5,2))*u+0.5)&&l!=0.5&&(l=l.toFixed(5)-0.00001*u));return""});K=K.split(/\s*\-\s*/);if(s==="linear"){q=K.shift();q=-H(q);if(isNaN(q)){return null}var Q=[0,0,R.cos(Raphael.rad(q)),R.sin(Raphael.rad(q))];q=1/(J(T(Q[2]),T(Q[3]))||1);Q[2]*=q;Q[3]*=q;Q[2]<0&&(Q[0]=-Q[2],Q[2]=0);Q[3]<0&&(Q[1]=-Q[3],Q[3]=0)}K=Raphael._parseDots(K);if(!K){return null}s==="radial"?(q='<radialGradient fx = "'+G+'" fy = "'+l+'" id = "'+M+'">',j="</radialGradient>"):(q='<linearGradient x1 = "'+Q[0]+'" y1 = "'+Q[1]+'" x2 = "'+Q[2]+'" y2 = "'+Q[3]+'" gradientTransform ="matrix('+A.matrix.invert()+')" id = "'+M+'">',j="</linearGradient>");A=0;for(Q=K.length;A<Q;A++){U+='<stop offset="'+(K[A].offset?K[A].offset:A?"100%":"0%")+'" stop-color="'+(K[A].color||"#fff")+'" stop-opacity="'+(K[A].opacity===void 0?1:K[A].opacity)+'" />'}o[M]=!0;o.str+=q+U+j}D.attrSTR+=" fill=\"url('#"+M+"')\""},fill:function(q,r){var l=r.attrs,j=l.fill,o;if(!q.attrs.gradient){if(j=Raphael.color(j),o=j.opacity,q.type==="text"){r.styleSTR+="fill:"+j+"; stroke-opacity:0; "}else{if(r.attrSTR+=' fill="'+j+'"',!l["fill-opacity"]&&(o||o===0)){r.attrSTR+=' fill-opacity="'+o+'"'}}}},stroke:function(q,r){var l=r.attrs,j,o;j=Raphael.color(l.stroke);o=j.opacity;if(q.type!=="text"&&(r.attrSTR+=' stroke="'+j+'"',!l["stroke-opacity"]&&(o||o===0))){r.attrSTR+=' stroke-opacity="'+o+'"'}},"clip-rect":function(q,r,l){var j=O(r.attrs["clip-rect"]),o=j.split(g),j=j.replace(c,"_")+"__"+L++;o.length===4&&(l[j]||(l[j]=!0,l.str+='<clipPath id="'+j+'"><rect x="'+o[0]+'" y="'+o[1]+'" width="'+o[2]+'" height="'+o[3]+'" transform="matrix('+E(q.matrix.invert()).replace(Y,"")+')"/></clipPath>'),r.attrSTR+=' clip-path="url(#'+j+')"')},cursor:function(l,o){var j=o.attrs.cursor;j&&(o.styleSTR+="cursor:"+j+"; ")},font:function(j,l){l.styleSTR+="font:"+l.attrs.font.replace(/\"/gi," ")+"; "},"font-size":function(l,o){var j=I(o.attrs["font-size"],"10");j&&j.replace&&(j=j.replace(S,""));o.styleSTR+="font-size:"+j+"px; "},"font-weight":function(j,l){l.styleSTR+="font-weight:"+l.attrs["font-weight"]+"; "},"font-family":function(j,l){l.styleSTR+="font-family:"+l.attrs["font-family"]+"; "},"line-height":function(){},"clip-path":function(){},visibility:function(){},"vertical-align":function(){},"text-anchor":function(l,o){var j=o.attrs["text-anchor"]||"middle";l.type==="text"&&(o.attrSTR+=' text-anchor="'+j+'"')},title:function(){},text:function(s,o){var j=o.attrs,w=j.text,r=I(j["font-size"],j.font,"10"),A=I(j["line-height"]),q;r&&r.replace&&(r=r.replace(S,""));r=C(r);A&&A.replace&&(A=A.replace(S,""));A=C(A,r&&r*1.2);q=r?r*0.85:A*0.75;for(var r=j.x,u=I(j["vertical-align"],"middle").toLowerCase(),w=O(w).split(Z),j=w.length,e=0,u=u==="top"?q:u==="bottom"?q-A*j:q-A*j*0.5;e<j;e++){o.textSTR+="<tspan ",q=(w[e]||"").replace(x,"&amp;").replace(f,"&quot;").replace(n,"&#39;").replace(B,"&lt;").replace(ab,"&gt;"),o.textSTR+=e?'dy="'+A+'" x="'+r+'" ':'dy="'+u+'"',o.textSTR+=">"+q+"</tspan>"}}},a=function(A,s){var q="",G={attrSTR:"",styleSTR:"",textSTR:"",attrs:A.attr()},w="",K="",u="",D,o,r=G.attrs;if(A.node.style.display!=="none"){for(D in r){if(D!=="gradient"&&(Raphael._availableAttrs[D]!==void 0||b[D])){if(b[D]){b[D](A,G,s)}else{G.attrSTR+=" "+D+'="'+r[D]+'"'}}}A.attrs.gradient&&b.gradient(A,G,s);A.type==="rect"&&r.r&&(G.attrSTR+=' rx="'+r.r+'" ry="'+r.r+'"');for(o in A.styles){G.styleSTR+=o+":"+A.styles[o]+"; "}A.type==="image"&&(G.attrSTR+=' preserveAspectRatio="none"');A.bottom&&(K=a(A.bottom,s));A.next&&(u=a(A.next,s));w=A.type;w.match(ac)&&(w="g");q+="<"+w+' transform="matrix('+E(A.matrix).replace(Y,"")+')" style="'+G.styleSTR+'"'+G.attrSTR+">"+G.textSTR+K+"</"+w+">"+u}else{A.next&&(q+=a(A.next,s))}return q};Raphael.fn.toSVG=function(l){var r="",o={str:""},e=0,q=d.length,j="";if(Raphael.svg){if(this.canvas&&this.canvas.parentNode){for(r=this.canvas.parentNode.innerHTML;e<q;e+=1){o=d[e],r=r.replace(o.reg,o.str)}}}else{r='<svg style="overflow: hidden; position: relative;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+this.width+'" version="1.1" height="'+this.height+'">';if(this.bottom){j=a(this.bottom,o);r+="<defs>"+o.str+"</defs>"+j+"</svg>"}}if(!l){r=r.replace(/\<image [^\>]*\>/gi,"")}return r}}var P={"arrow-start":1,"arrow-end":1,"clip-rect":1,fill:1,"fill-opacity":1,title:1,cursor:1,transform:1,opacity:1,stroke:1,"stroke-dasharray":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-dashoffset":1,"stroke-width":1};this.$attr={circle:{cx:1,cy:1,r:1},ellipse:{cx:1,cy:1,rx:1,ry:1},rect:{x:1,y:1,r:1,width:1,height:1},text:{x:1,y:1,text:1,font:1,"font-family":1,"font-style":1,"font-size":1,"font-weight":1,"text-anchor":1,"letter-spacing":1},image:{src:1,x:1,y:1,width:1,height:1},path:{x:1,y:1,cx:1,cy:1,path:1}};xui.each(this.$attr,function(e){xui.merge(e,P)});var N=this.$attr.text;delete N["arrow-start"];delete N["arrow-end"];delete N["stroke-dasharray"];delete N["stroke-linecap"];delete N["stroke-linejoin"];delete N["stroke-miterlimit"];delete N["stroke-opacity"];delete N["stroke-dashoffset"];delete N["stroke-width"];delete this.prototype.toHtml},Instance:{initialize:function(){if(typeof(Raphael)!="function"){throw"Browser doesn't suppor SVG or VML, all diagram functions were disabled!"}},getAttr:function(b){var e=this.get(0);if(e){var f=e.properties,d=Raphael._availableAttrs,a=e.box.ISCOMBO?f.attr:{KEY:f.attr},c;if(e._elset){e._elset.forEach(function(l){var m=l.type,g=e.getKey(l.node.id,true);if(!b||b===g){c=l.node;if(c&&("raphaelid" in c)){var n=e.boxing().getPaper();if(n&&(c=n.getById(c.raphaelid))){var j=c.attr();xui.filter(j,function(r,q){if(q=="transform"&&xui.isArr(r)&&r.length===0){r=""}if(q=="transform"&&r){r=c.matrix.toTransformString()}if(m=="text"){if(q=="stroke"){return r!="none"}if(q=="fill"){return r!="#000"}if(g!="KEY"&&("hAlign" in e.box.$DataModel)&&(q=="x"||q=="y")){return false}}if(g!="KEY"&&q=="transform"){return false}return r!=d[q]});if("src" in j&&"src" in a[g]){j.src=a[g].src}a[g]=j}}}})}}a=e.box._adjustAttr(a);return e.box.ISCOMBO?(b?a[b]:a):a.KEY},setAttr:function(c,a,e,b){if(xui.isHash(c)){a=c}else{var d={};d[c]=a;a=d;c=c||"KEY"}e=e!==false;return this.each(function(g){var f=g.properties,j,o=Raphael._availableAttrs,n=g.box._adjustAttr(f.attr),u=g.box._adjustAttr(a);if(e){xui.each(n,function(x,l){if(!(l in u)){u[l]={}}xui.each(x,function(B,A){if(!(A in u[l])){u[l][A]=o[A];if((g.box.$tagName[l]||l.split("_")[0].toLowerCase())=="text"){if(A=="stroke"){u[l][A]="none"}if(A=="fill"){u[l][A]="#000"}}}});if((g.box.$tagName[l]||l.split("_")[0].toLowerCase())=="text"){if(l!="KEY"&&("hAlign" in g.box.$DataModel)){delete u[l].x;delete u[l].y}}if(l!="KEY"){delete u[l].transform}})}if(g._elset){g._elset.forEach(function(A){var B=A.type,l=g.getKey(A.node.id,true);if(xui.isHash(c)||c===l){j=A.node;if(j&&("raphaelid" in j)){var C=g.boxing().getPaper();if(C&&(j=C.getById(j.raphaelid))){var x=xui.copy(u[l]);if(x){if("src" in x){x.src=xui.adjustRes(x.src)}j.attr(x)}}}}});var q=u.KEY,s=q&&("x" in q||"y" in q||"width" in q||"height" in q||"r" in q||"rx" in q||"ry" in q||"path" in q||"transform" in q||"arrow-start" in q||"arrow-end" in q);if(q){var w=g._elset;if(w[1]){if("transform" in q){for(var r=1,m=w.length;r<m;r++){w[r].attr("transform",q.transform)}}}if(b!==false){g.box._notify(g,q,s)}}}if(g.box.ISCOMBO){f.attr=xui.merge(f.attr,u,function(x,l){if(typeof x=="object"){if(l in f.attr){xui.merge(f.attr[l],x,"all")}else{f.attr[l]=xui.copy(x)}}else{return true}});xui.each(f.attr,function(x,l){xui.filter(x,function(B,A){if(A=="transform"&&xui.isArr(o[A])&&o[A].length===0){o[A]=""}if((g.box.$tagName[l]||l.split("_")[0].toLowerCase())=="text"){if(A=="stroke"){return B!="none"}if(A=="fill"){return B!="#000"}if(l!="KEY"&&("hAlign" in g.box.$DataModel)&&(A=="x"||A=="y")){return false}}if(l!="KEY"&&A=="transform"){return false}return o[A]!==B})})}else{xui.merge(f.attr,u.KEY,"all");xui.filter(f.attr,function(x,l){if(l=="transform"&&xui.isArr(o[l])&&o[l].length===0){o[l]=""}if((g.box.$tagName.KEY||r.split("_")[0].toLowerCase())=="text"){if(l=="stroke"){return x!="none"}if(l=="fill"){return x!="#000"}}return o[l]!==x})}})},toFront:function(){return this.each(function(c){if(c._shadow){c._shadow.toFront()}if(c._elset){xui.arr.each(c._elset.items,function(e){e.toFront()})}var a=xui.get(c,["parent","children"]);if(a&&a.length){var b=xui.arr.subIndexOf(a,"0",c),d;if(b!=-1){d=a[b];a.splice(b,1);a.push(d)}}})},toBack:function(){return this.each(function(c){if(c._elset){xui.arr.each(c._elset.items,function(e){e.toBack()},null,true)}if(c._shadow){c._shadow.toBack()}var a=xui.get(c,["parent","children"]);if(a&&a.length){var b=xui.arr.subIndexOf(a,"0",c),d;if(b!=-1){d=a[b];a.splice(b,1);a.unshift(d)}}})},getAllNodes:function(){var b=this.get(0),a=[];if(b&&b._elset){b._elset.forEach(function(c){a.push(c.node)});if(b._shadow){b._shadow.forEach(function(c){a.push(c.node)})}}return xui(a)},getPaper:function(){var a=this.get(0);return a&&a.parent&&a.parent._paper},elemsAnimate:function(a,b,e,d){var c=this.get(0);if(c&&c._elset){c._elset.animate(a,b,e,d)}return this},getElemSet:function(){var a=this.get(0);a&&a._elset},getLeft:function(){return this._getBBox("x")},setLeft:function(a){return this._setBBox("x",a)},getTop:function(){return this._getBBox("y")},setTop:function(a){return this._setBBox("y",a)},getWidth:function(){return this._getBBox("width")},getHeight:function(){return this._getBBox("height")},setWidth:function(a){return this._setBBox("width",parseFloat(a))},setHeight:function(a){return this._setBBox("height",parseFloat(a))},_getBBox:function(e,b){var g=this.get(0),f,j;if((f=g._elset)&&f.length){f[0]._.dirty=1;j={};xui.merge(j,f[0]._getBBox(b!==false),"all",true);for(var d=1,a=f.length,c;d<a;d++){if(!(f[d].type=="text"&&("hAlign" in g.box.$DataModel))){f[d]._.dirty=1;c=f[d]._getBBox(b!==false);j.x=Math.min(c.x,j.x);j.y=Math.min(c.y,j.y);j.x2=Math.max(("x2" in c)?c.x2:(c.x+c.width),("x2" in j)?j.x2:(j.x+j.width));j.y2=Math.max(("y2" in c)?c.y2:(c.y+c.height),("y2" in j)?j.y2:(j.y+j.height))}}if("x2" in j){j.width=j.x2-j.x}if("y2" in j){j.height=j.y2-j.y}delete j.x2;delete j.y2;return e?j[e]:j}},_setBBox:function(a,b){},_getConnectAnchors:function(){var u=this.get(0),E;if(u){if(xui.get(u._pathCached,["_connAnchors"])){return xui.get(u._pathCached,["_connAnchors"])}var w=u._elset;if(w&&w[0]){w[0]._.dirty=1;var s=Raphael.parseTransformString(w[0].transform()),D;if(s&&s.length){D=w[0].matrix}var c=w[0]._getBBox(true),G=180,F=270,A=0,x=90,J=c.x,o=c.y+c.height/2,I=c.x+c.width/2,m=c.y,H=c.x+c.width,j=c.y+c.height/2,C=c.x+c.width/2,g=c.y+c.height;if(D){var r=J,q=I,n=H,l=C,f=o,d=m,b=j,a=g;J=D.x(r,f);o=D.y(r,f);I=D.x(q,d);m=D.y(q,d);H=D.x(n,b);j=D.y(n,b);C=D.x(l,a);g=D.y(l,a);var B=(J+I+H+C)/4,e=(o+m+j+g)/4;G=Raphael.angle(J,o,B,e);F=Raphael.angle(I,m,B,e);A=Raphael.angle(H,j,B,e);x=Raphael.angle(C,g,B,e)}E={left:{x:J,y:o,alpha:G,solid:1},top:{x:I,y:m,alpha:F,solid:1},right:{x:H,y:j,alpha:A,solid:1},bottom:{x:C,y:g,alpha:x,solid:1}};if(u._pathCached){xui.set(u._pathCached,["_connAnchors"],E)}return E}}},_getConnectPath:function(){var c=this.get(0),b;if(xui.get(c._pathCached,["_connPath"])){return xui.get(c._pathCached,["_connPath"])}if(c&&(b=c._elset)&&b[0]){var e=Raphael.parseTransformString(b[0].transform()),a;if(e&&e.length){a=b[0].matrix}var d=b[0].getPath();if(a){d=Raphael.mapPath(d,a)}if(c._pathCached){xui.set(c._pathCached,["_connPath"],d)}return d}},_getConnectPoint:function(d){if(d){var a=this.get(0),j;if(xui.get(a._pathCached,["_connPoint",d])){return xui.get(a._pathCached,["_connPoint",d])}if(/^[1-9][0-9]*:((1([.][0]+)?)|(0\.[0-9]+))$/.test(d)){var f=d.split(":");f[0]=+f[0];f[1]=+f[1];if(f[0]>=1&&f[1]>=0&&f[1]<=1){var a=this.get(0),g=this._getConnectPath();if(g){var e=Raphael.path2curve(g),l,b;if((l=e[f[0]])&&(b=e[f[0]-1])){j=Raphael.findDotsAtSegment(b[b.length-2],b[b.length-1],l[1],l[2],l[3],l[4],l[5],l[6],f[1])}}}}else{var c=this._getConnectAnchors();j=c&&c[d]}if(a._pathCached){xui.set(a._pathCached,["_connPoint",d],j)}return j}},_removeHandler:function(){return this.each(function(c){var b,g,d;if(g=c._pathHandler){if(d=g.handlers){for(var f=0,l=d.length,a,m;f<l;f++){a=d[f];for(var e in a){if((m=a[e])&&typeof m.remove=="function"){m.remove()}a[f]=null}}}b=g.el;delete g.el;delete c._pathHandler}delete c._ddstartFun;delete c._ddendFun;if(b&&b._shape){b._shape.remove();delete b._shape}})},_addHandler:function(b,a){a=a||"adv";this._removeHandler();return this.each(function(u){if(!u._elset||!u._elset[0]){return}var s=u.boxing().getPaper(),d=u.box.ISCOMBO,e=u._elset[0],c,F=u.box._CONNECTOR,q=u.properties.type,E={fill:"#fff",stroke:"#000",r:5},D={fill:"#fff",stroke:"#000",r:4},C={fill:"#fff",stroke:"#000",r:3},B={fill:"#fff",stroke:"#000",r:4},A={fill:"#bf5600",stroke:"#bf5600",r:5,"fill-opacity":0.5},n={stroke:"#0000FF","stroke-dasharray":". "},K={stroke:"#0000FF","stroke-dasharray":"- "},H={stroke:"#ccc","stroke-dasharray":"- ",opacity:0.8},G={opacity:0.8},o=16,m=16,J,g,x={rect:function(M){var r=M.attr(),L={};L.dot=I(s.circle(r.x+r.width/2,r.y+r.height/2).attr(E).attr("cursor","move"),M,function(N,S,Q,P){var R=f(this,N,S,Q,P),O;r.x+=R.rx;r.y+=R.ry;O={x:r.x,y:r.y};M.attr(O);if(M._shape){M._shape.attr(O)}xui.tryF(M.onShapeChanged,[O]);f(L.dot1,N,S,Q,P);f(L.dot2,N,S,Q,P);f(L.dot3,N,S,Q,P);return{dx:R.dx,dy:R.dy}},"main");L.dot1=I(s.circle(r.x,r.y).attr(D).attr("cursor","nw-resize"),M,function(U,R,N,V){var O=M.attr("x")+M.attr("width"),T=M.attr("y")+M.attr("height"),S=f(this,U,R,N,V,null,O,null,T),Q;r.x=S.cx;r.y=S.cy;r.height=T-S.cy;r.width=O-S.cx;Q={x:r.x,y:r.y,width:r.width,height:r.height};M.attr(Q);if(M._shape){M._shape.attr(Q)}xui.tryF(M.onShapeChanged,[Q]);L.dot.attr({cx:r.x+r.width/2,cy:r.y+r.height/2});var P=Math.min(M.attr("width"),M.attr("height"));if(M.attr("r")>P){M.attr("r",r.r=P);if(M._shape){M._shape.attr("r",P)}xui.tryF(M.onShapeChanged,[{r:P}])}L.dot3.attr({cx:M.attr("x")+M.attr("width")-M.attr("r"),cy:M.attr("y")});return{dx:S.dx,dy:S.dy}},"w");L.dot2=I(s.circle(r.x+r.width,r.y+r.height).attr(D).attr("cursor","se-resize"),M,function(O,T,R,Q){var S=f(this,O,T,R,Q,r.x,null,r.y,null),P;r.width=S.cx-r.x;r.height=S.cy-r.y;P={width:r.width,height:r.height};M.attr(P);if(M._shape){M._shape.attr(P)}xui.tryF(M.onShapeChanged,[P]);L.dot.attr({cx:r.x+r.width/2,cy:r.y+r.height/2});var N=Math.min(M.attr("width"),M.attr("height"));if(M.attr("r")>N){M.attr("r",r.r=N);if(M._shape){M._shape.attr("r",N)}xui.tryF(M.onShapeChanged,[{r:N}])}L.dot3.attr({cx:M.attr("x")+M.attr("width")-M.attr("r"),cy:M.attr("y")});return{dx:S.dx,dy:S.dy}},"h");L.dot3=I(s.circle(r.x+r.width-(r.r||0),r.y).attr(C).attr("cursor","e-resize"),M,function(O,T,R,Q){var N=M.attr(),S=f(this,O,T,R,Q,(N.x+N.width-Math.max(N.width,N.height)/2),N.x+N.width,N.y,N.y),P;P={r:N.width-(S.cx-N.x)};M.attr(P);if(M._shape){M._shape.attr(P)}xui.tryF(M.onShapeChanged,[P]);return{dx:S.dx,dy:S.dy}},"r");return{el:M,handlers:[L]}},circle:function(M){var r=M.attr(),L={};L.dot=I(s.circle(r.cx,r.cy).attr(E).attr("cursor","move"),M,function(N,Q){var O=f(this,N,Q),P={cx:O.cx,cy:O.cy};r.cx=P.cx;r.cy=P.cy;M.attr(P);if(M._shape){M._shape.attr(P)}xui.tryF(M.onShapeChanged,[P]);P.cx+=M.attr("r");L.dotr.attr(P)},"main");L.dotr=I(s.circle(r.cx+r.r,r.cy).attr(D).attr("cursor","e-resize"),M,function(O,T,R,Q){var N=M.attr(),S=f(this,O,T,R,Q,N.cx,null,N.cy,N.cy),P;N.r=S.cx-N.cx;P={r:N.r};M.attr(P);if(M._shape){M._shape.attr(P)}xui.tryF(M.onShapeChanged,[P]);return{dx:S.dx,dy:S.dy}},"r");return{el:M,handlers:[L]}},ellipse:function(N){var r=N.attr(),M={},L;M.dot=I(s.circle(r.cx,r.cy).attr(E).attr("cursor","move"),N,function(O,R){var P=f(this,O,R),Q={cx:P.cx,cy:P.cy};r.cx=Q.cx;r.cy=Q.cy;N.attr(Q);if(N._shape){N._shape.attr(Q)}xui.tryF(N.onShapeChanged,[Q]);M.dotrx.attr({cx:Q.cx+N.attr("rx"),cy:Q.cy});M.dotry.attr({cy:Q.cy-N.attr("ry"),cx:Q.cx})},"main");M.dotrx=I(s.circle(r.cx+r.rx,r.cy).attr(D).attr("cursor","w-resize"),N,function(P,U,S,R){var O=N.attr(),T=f(this,P,U,S,R,O.cx,null,O.cy,O.cy),Q;O.rx=T.cx-O.cx;Q={rx:O.rx};N.attr(Q);if(N._shape){N._shape.attr(Q)}xui.tryF(N.onShapeChanged,[Q]);return{dx:T.dx,dy:T.dy}},"rx");M.dotry=I(s.circle(r.cx,r.cy-r.ry).attr(D).attr("cursor","n-resize"),N,function(P,U,S,R){var O=N.attr(),T=f(this,P,U,S,R,O.cx,O.cx,null,O.cy),Q;O.ry=O.cy-T.cy;Q={ry:O.ry};N.attr(Q);if(N._shape){N._shape.attr(Q)}xui.tryF(N.onShapeChanged,[Q]);return{dx:T.dx,dy:T.dy}},"ry");return{el:N,handlers:[M]}},path:function(M){var S,Q,O,N,T,R,ad,ac,aj,ai,Z=M.getPath(),U,W=function(ak,am,at,ar,aq,ap,an,ao){var al=ak.circle(at,ar);if(an=="from"){al.attr(B)}else{if(an=="to"){al.attr(B)}else{al.attr(E).attr("cursor","move")}}return I(al,am,function(a7,a5,aD,aA,bp,aJ,aI,aX,aW,bn,a6){var aw=am.paper,aZ=this.attr("cx"),aY=this.attr("cy"),aC=xui.isSet(aX)?aX:(aZ+a7),az=xui.isSet(aW)?aW:(aY+a5),a1,a0;if(xui.isSet(aX)){a7=aC-aZ}if(xui.isSet(aW)){a5=az-aY}if(an=="from"||an=="to"){var bi=am.node.ownerDocument||document;this.hide();ao._elset.hide();am._shape.hide();xui.arr.each(X,function(ay,ax){if(ax=ay.dot){ax.hide()}if(ax=ay.dot1){ax.hide()}if(ax=ay.dot2){ax.hide()}if(ax=ay.dot3){ax.hide()}if(ax=ay.dotPrev){ax.hide()}if(ax=ay.dotNext){ax.hide()}if(ax=ay.linePrev){ax.hide()}if(ax=ay.lineNext){ax.hide()}});var bg=bi.elementFromPoint(aJ,aI);this.show();ao._elset.show();am._shape.show();xui.arr.each(X,function(ay,ax){if(ax=ay.dot){ax.show()}if(ax=ay.dot1){ax.show()}if(ax=ay.dot2){ax.show()}if(ax=ay.dot3){ax.show()}if(ax=ay.dotPrev){ax.show()}if(ax=ay.dotNext){ax.show()}if(ax=ay.linePrev){ax.show()}if(ax=ay.lineNext){ax.show()}});if(bg._rootNode){bg=bg._rootNode}if(!bg){return}if(bg&&bg.raphael){var bc=aw.getById(bg.raphaelid);if(bc&&bc._attached){bg=bc._attached}}while(bg&&((!bg.id)||bg.id==xui.$localeDomId||bg.tagName=="tspan")&&bg!==aw.canvas.parentNode&&bg.parentNode!==bi){bg=bg.parentNode}if(!bg){return}var av,aQ,aV,aP,a9,a2,aK=aw._anchorShadow;if(bg!==aw.canvas){var a4=xui.UIProfile.getFromDom(bg.id);if(a4&&a4.parent&&a4.parent._paper==aw){if(a4.box["xui.svg"]){aV=a4.getRootNode();if(!a4.box._CONNECTOR){aP=a4.boxing()._getConnectAnchors();a9=a4.boxing()._getConnectPath();if(a9){var aB;if(aB=xui.get(a4._pathCached,["_connBBox"])){}else{aB=Raphael.pathBBox(a9);xui.set(a4._pathCached,["_connBBox"],aB)}a2={x:aB.x+aB.width/2,y:aB.y+aB.height/2}}av=a4.alias}}else{if(a4.box["xui.UI"]){}}}}if(aK&&((!aP&&!a9)||aK._attached!==aV)){aK.remove();aK.clear();aK=null;delete aw._anchorShadow;this.show()}if(aP||a9){if(!aK){aK=aw.set();aK._attached=aV;var aT=aw.circle(-100,-100);aT._attached=aV;aT.hide();aK.push(aT);for(var bf in aP){bc=aP[bf];aT=aw.circle(bc.x,bc.y);aT._attached=aV;aT._anchorKey=bf;aK.push(aT)}aK.attr(A);aw._anchorShadow=aK}var aN=null;for(var bf in aP){aU=Math.pow(Math.pow(Math.abs(aX-aP[bf].x),2)+Math.pow(Math.abs(aW-aP[bf].y),2),1/2);if(aU<=o){if(aN===null||aN>aU){aN=aU;a0=aP[bf];aQ=bf}}}if(!a0){if(a9){var a8=m,ba="M,"+aC+","+az+"m,0,-"+a8+"a,"+a8+","+a8+",0,1,1,0,"+a8*2+"a,"+a8+","+a8+",0,1,1,0,-"+a8*2+"z",aS=Raphael.getTotalLength(ba)/2,aF=Raphael.pathIntersection(a9,ba);if(aF.length>=2){var aO=(aF[0].x+aF[1].x)/2,au=(aF[0].y+aF[1].y)/2,aR=Raphael.angle(aO,au,aC,az);if((Math.abs(aO-a2.x)+Math.abs(au-a2.y))<Math.abs(aC-a2.x)+Math.abs(az-a2.y)){aR+=180}var aE=Raphael.rad(aR),aM=aC-a8*Math.cos(aE),aL=aC+a8*Math.cos(aE),bo=az-a8*Math.sin(aE),bm=az+a8*Math.sin(aE);aF=Raphael.pathIntersection(a9,"M"+aM+","+bo+",L"+aL+","+bm);if(aF.length===1){var bj=aF[0].bez1,aH="M"+bj[0]+","+bj[1]+"C"+bj[2]+","+bj[3]+","+bj[4]+","+bj[5]+","+bj[6]+","+bj[7],a3=Raphael.getPointAtLength(aH,aF[0].t1*Raphael.getTotalLength(aH));aQ=aF[0].segment1+":"+aF[0].t1;a0={x:aF[0].x,y:aF[0].y,alpha:aR,_path:true}}}}}if(a0){if(J){if(J.x==a0.x&&J.y==a0.y){a7=a5=0;aD=g.x;aA=g.y}else{a7=a0.x-J.x;a5=a0.y-J.y;aD=g.x+a7;aA=g.y+a5;J={x:a0.x,y:a0.y};g={x:aD,y:aA};if(a0._path){aK[0].attr({cx:a0.x,cy:a0.y});aK[0].show()}else{aK[0].hide()}}}else{a7+=a0.x-aX;a5+=a0.y-aW;aD+=a0.x-aX;aA+=a0.y-aW;J={x:a0.x,y:a0.y};g={x:aD,y:aA};if(a0._path){aK[0].attr({cx:a0.x,cy:a0.y});aK[0].show()}else{aK[0].hide()}}aC=a0.x;az=a0.y;a1={dx:aD,dy:aA}}}if(!a0&&J){a7=aX-J.x;a5=aW-J.y;aD=g.x+a7;aA=g.y+a5;J=g=null;if(aK){aK[0].hide()}}ao.properties[an=="from"?"fromObj":"toObj"]=av||"";ao.properties[an=="from"?"fromPoint":"toPoint"]=aQ||""}var bl,a1={cx:aC,cy:az};if(bp||false!==xui.tryF(U,[aq,Z,aC,az,this,a1])){var bf=this._handlerIndex,be=Z[bf].length,bh=X[bf],bd,bb,bi;if(!bp){if(ap=="V"){if(X.length-1==bf+1&&X[bf+1].type=="H"){delete a1.cy;a5=aA=0}else{Z[bf][be-1]=az}if((0!==bf-1)&&(bd=X[bf-1])){if(bd.type=="H"){Z[bf-1][1]=aC;if(bi=bd.dot){bi.update(a7,0,aD,0,true,aJ,aI)}}else{if(bd.type=="V"){delete a1.cx}else{if(bd.type=="L"){Z[bf-1][Z[bf-1].length-2]=aC;if(bi=bd.dot){bi.update(a7,0,aD,0,true,aJ,aI)}}else{delete a1.cx}}}}else{delete a1.cx}}else{if(ap=="H"){if(X.length-1==bf+1&&X[bf+1].type=="V"){delete a1.cx;a7=aD=0}else{Z[bf][be-1]=aC}if((0!==bf-1)&&(bd=X[bf-1])){if(bd.type=="H"){delete a1.cy}else{if(bd.type=="V"){Z[bf-1][1]=az;if(bi=bd.dot){bi.update(0,a5,aD,aA,true,aJ,aI)}}else{if(bd.type=="L"){Z[bf-1][Z[bf-1].length-1]=az;if(bi=bd.dot){bi.update(0,a5,aD,aA,true,aJ,aI)}}else{delete a1.cy}}}}else{delete a1.cy}}else{Z[bf][be-2]=aC;Z[bf][be-1]=az}}if((bd=X[bf+1])&&(bi=bd.dot)){if(bd.type=="V"){bi.update(a7,0,aD,0,true,aJ,aI)}else{if(bd.type=="H"){bi.update(0,a5,0,aA,true,aJ,aI)}}}}this.attr(a1);if(bb=bh.linePrevPath){bb[0][1]=aC;bb[0][2]=az}if(bb=bh.lineNextPath){bb[0][1]=aC;bb[0][2]=az}if(bi=bh.dotPrev){bi.update(aC-aZ,az-aY,aD,aA,true);bl=true}if(bi=bh.dotNext){bi.update(aC-aZ,az-aY,aD,aA,true);bl=true}}if(!bl){var aG={path:Z};am.attr(aG);if(am._shape){am._shape.attr(aG)}xui.tryF(am.onShapeChanged,[aG])}if((an=="from"||an=="to")&&q=="bezier"&&a0&&(aC!==aZ||az!==aY)){var bk=an=="from"?X[0].dotNext:X[Z.length-1].dotPrev;if(bk){var aO=bk.attr("cx"),au=bk.attr("cy"),aU=Math.pow(Math.pow(Math.abs(aC-aO),2)+Math.pow(Math.abs(az-au),2),1/2),aE=Raphael.rad(a0.alpha),aM=aC+aU*Math.cos(aE),bo=az+aU*Math.sin(aE);bk.update(aM-aO,bo-au,null,null,true)}}if(a1){return a1}},"main",aq)},ah=function(an,am,ak,aq,al,ap,ao){return I(an.circle(ak,aq).attr(C),am,function(aA,az){var au=this.attr("cx")+aA,ar=this.attr("cy")+az,av;this.attr({cx:au,cy:ar});var ax=this._handlerIndex,aw=X[ax],at,ay;if(at=aw.lineNextPath){at[1][1]=au;at[1][2]=ar}if(ay=aw.lineNext){ay.attr({path:at})}Z[ax+1][1]=au;Z[ax+1][2]=ar;av={path:Z};am.attr(av);if(am._shape){am._shape.attr(av)}xui.tryF(am.onShapeChanged,[av])},"path2",al)},P=function(an,am,ak,aq,al,ap,ao){return I(an.circle(ak,aq).attr(C),am,function(aA,az){var au=this.attr("cx")+aA,ar=this.attr("cy")+az,av;this.attr({cx:au,cy:ar});var ax=this._handlerIndex,aw=X[ax],at,ay;if(at=aw.linePrevPath){at[1][1]=au;at[1][2]=ar}if(ay=aw.linePrev){ay.attr({path:at})}Z[ax][Z[ax].length-4]=au;Z[ax][Z[ax].length-3]=ar;av={path:Z};am.attr(av);if(am._shape){am._shape.attr(av)}xui.tryF(am.onShapeChanged,[av])},"path1",al)},ag=1,af=1,ae=0,Y=1,X=[];if(xui.isStr(Z)){Z=Raphael.parsePathString(Z)}if(F&&q=="flowchart"){u._ddstartFun=function(am,al,ak){if(al===0||al===am._pathHandler.handlers.length-1){xui.arr.each(am._pathHandler.handlers,function(ao,an){if(an!==0&&an!==am._pathHandler.handlers.length-1){ao.dot.attr({opacity:0,r:0})}})}};u._ddendFun=function(am,al,ak){if(al===0||al===am._pathHandler.handlers.length-1){am.boxing()._addHandler(b)}};U=function(al,ao,aq,an,ak,ap){if(al===0||al===u._pathHandler.handlers.length-1){ak.attr(ap);var am=u.box._redrawBrokenLine(u,al===0?"start":"end",aq,an);ao.length=0;xui.arr.each(am,function(ar){ao.push(ar)});return false}}}for(var ab=0,V=Z.length,aa,L;ab<V;ab++){var r;if(F){r=(ab===0)?"from":(ab===(V-1))?"to":null}X.push(L={dot:0,dotPrev:0,dotNext:0,linePrev:0,lineNext:0,linePrevPath:0,lineNextPath:0,type:Z[ab][0]});aa=Z[ab].length;ae=0;switch(Z[ab][0]){case"M":S=aj=O=Z[ab][aa-2];Q=ai=N=Z[ab][aa-1];ag=0;af=1;break;case"L":ag=af=1;aj=O=Z[ab][aa-2];ai=N=Z[ab][aa-1];break;case"H":ag=af=1;ai=N=Q;aj=O=Z[ab][1];ae="H";break;case"V":ag=af=1;aj=O=S;ai=N=Z[ab][1];ae="V";break;case"C":ag=af=2;T=Z[ab][aa-6];R=Z[ab][aa-5];ad=Z[ab][aa-4];ac=Z[ab][aa-3];O=aj=Z[ab][aa-2];N=ai=Z[ab][aa-1];break;case"Q":ag=2;af=1;T=Z[ab][aa-4];R=Z[ab][aa-3];O=aj=Z[ab][aa-2];N=ai=Z[ab][aa-1];break;case"S":ag=1;af=2;ad=Z[ab][aa-4];ac=Z[ab][aa-3];O=aj=Z[ab][aa-2];N=ai=Z[ab][aa-1];break;case"T":ag=af=1;O=aj=Z[ab][aa-2];N=ai=Z[ab][aa-1];break;case"A":ag=af=0;O=aj=Z[ab][aa-2];N=ai=Z[ab][aa-1];continue;default:continue}switch(ag){case 0:break;case 1:break;case 2:if(a=="adv"){X[ab-1].lineNextPath=[["M",S,Q],["L",T,R]],X[ab-1].lineNext=s.path(X[ab-1].lineNextPath).attr(n);X[ab-1].dotNext=ah(s,M,T,R,ab-1,r,u)}break}switch(af){case 1:X[ab].dot=W(s,M,aj,ai,ab,ae,r,u);if(F&&q=="flowchart"&&V===3&&ab===1){X[ab].dot.attr({opacity:0,r:0})}break;case 2:X[ab].dot=W(s,M,aj,ai,ab,null,r,u);if(a=="adv"){X[ab].linePrevPath=[["M",aj,ai],["L",ad,ac]],X[ab].linePrev=s.path(X[ab].linePrevPath).attr(n);X[ab].dotPrev=P(s,M,ad,ac,ab,r,u)}break}if(O!=undefined){S=O}if(N!=undefined){Q=N}Y=af}for(var ab=0,V=Z.length,aa,L;ab<V;ab++){L=X[ab];if(L.dot){L.dot.toFront()}}return{el:M,handlers:X}}},w=function(L,r,P,O,N){var M=this.update(L-(this.dx||0),r-(this.dy||0),L,r,false,P,O,P-c.left,O-c.top,N);this.dx=(M&&M.dx)||L;this.dy=(M&&M.dy)||r;if(b){b(this,N,"drag",this._attached)}},l=function(O,M,L){if(b){b(this,L,"beforedragstart",this._attached)}this.toFront();this.dx=this.dy=0;J=g=null;c=xui(this.paper.canvas.parentNode).offset(null);var N=this.attr("cursor"),r;this._oldCursor=(r=s.canvas.style).cursor||"";r.cursor=N;if(r=this._attached){r._oldCursor=r.attr("cursor")||"";r.attr("cursor",N);r._opath=r.getPath();r._obbox=Raphael.pathBBox(r._opath);if(u._ddstartFun){xui.tryF(u._ddstartFun,[u,this._handlerIndex,this])}}if(b){b(this,L,"dragstart",this._attached)}},j=function(M){if(b){b(this,M,"beforedragend",this._attached)}c=null;J=g=null;var N=this.paper;s.canvas.style.cursor=this._oldCursor;delete this._oldCursor;var L;if(L=this._attached){L.attr("cursor",L._oldCursor);delete L._oldCursor;delete L._obbox;delete L._opath;var r=L.attr();if(d){xui.merge(u.properties.attr.KEY,r,"all");r=u.properties.attr.KEY}else{xui.merge(u.properties.attr,r,"all");r=u.properties.attr}if(r.path){r.path=L.getPath().join("")}u.box._notify(u,{path:1},true);if(u._ddendFun){xui.tryF(u._ddendFun,[u,this._handlerIndex,this])}}if(L=N._anchorShadow){L.remove();L.clear();delete N._anchorShadow}if(b){b(this,M,"dragend",this._attached)}},I=function(N,M,O,L,r){N._handlerIndex=r||0;N._attached=M;if(O){N.drag(w,l,j);N.update=O;N.dblclick(function(P){if(b){b(this,P,"dblclick",M,L,r)}});N.click(function(P){if(b){b(this,P,"click",M,L,r)}xui.Event.stopBubble(P);xui.Event.stopDefault(P)});N.contextmenu(function(P){if(b){b(this,P,"contextmenu",M,L,r)}})}N.toFront();return N},f=function(r,U,S,V,T,R,Q,ac,aa){switch(r.type){case"path":var ab=r.getPath(),Z;for(var af=0,W=ab.length,ad;af<W;af++){ad=ab[af].length;switch(ab[af][0]){case"M":case"L":ab[af][1]+=U;ab[af][2]+=S;break;case"H":ab[af][1]+=U;break;case"V":ab[af][1]+=S;break;case"C":ab[af][1]+=U;ab[af][2]+=S;ab[af][3]+=U;ab[af][4]+=S;ab[af][5]+=U;ab[af][6]+=S;break;case"Q":case"S":ab[af][1]+=U;ab[af][2]+=S;ab[af][3]+=U;ab[af][4]+=S;break;case"T":ab[af][1]+=U;ab[af][2]+=S;break;case"A":ab[af][ad-2]+=U;ab[af][ad-1]+=S;continue;default:continue}}Z={path:ab};r.attr(Z);if(r._shape){r._shape.attr(Z)}xui.tryF(r.onShapeChanged,[Z]);break;case"circle":var ag=r.attr("cx"),P=r.attr("cy"),M=ag+U,L=P+S,O=0,N=0,ae;if((R===0||R)&&M<(R+1)){O=M-(R+1);M=(R+1)}if((Q===0||Q)&&M>Q){O=M-Q;M=Q}if((ac===0||ac)&&L<(ac+1)){N=L-(ac+1);L=(ac+1)}if((aa===0||aa)&&L>aa){N=L-aa;L=aa}ae={cx:M,cy:L,rx:U,ry:S};r.attr(ae);if(r._shape){r._shape.attr(ae)}xui.tryF(r.onShapeChanged,[ae]);ae.dx=V-O;ae.dy=T-N;return ae;case"ellipse":var M=r.attr("cx")+U,L=r.attr("cy")+S,Z={cx:M,cy:L};r.attr(Z);if(r._shape){r._shape.attr(Z)}xui.tryF(r.onShapeChanged,[Z]);break;case"rect":var M=r.attr("x")+U,L=r.attr("y")+S,Z={x:M,y:L};r.attr(Z);if(r._shape){r._shape.attr(Z)}xui.tryF(r.onShapeChanged,[Z]);break;case"text":var M=r.attr("x")+U,L=r.attr("y")+S,Z={x:M,y:L};r.attr(Z);if(r._shape){r._shape.attr(Z)}xui.tryF(r.onShapeChanged,[Z]);break}};if(x[e.type]){u._pathHandler=x[e.type](e);e=e._shape=e.clone();e.attr({"arrow-start":"none","arrow-end":"none"});e.transform("").attr(e.type=="text"?G:H).toBack()}})}},Static:{$abstract:true,_objectProp:{attr:1},DataModel:{selectable:null,defaultFocus:null,renderer:null,position:null,tabindex:{hidden:true},zIndex:{hidden:true},disableClickEffect:null,disableHoverEffect:null,disableTips:null,disabled:null,left:null,top:null,right:null,bottom:null,width:null,height:null,svgTag:{ini:""},attr:{ini:{}},shadow:{ini:false,action:function(a){if(a&&!this._shadow){this._shadow=this._elset[0].shadow()}else{if(this._shadow){this._shadow.remove();this._shadow.clear();delete this._shadow}}}},animDraw:{ini:"",combobox:["2s linear","2s ease","2s ease-in","2s ease-out","2s ease-in-out"],action:function(l){if(!l||!Raphael.svg||this.box.$noShape){return}var f=this,g=f._elset[0],j=g&&g.node;if(!j){return}var d=j.getTotalLength(),a=j.style,m=function(e){a.transition=a[xui.browser.cssTag2+"Transition"]=e},c=a.strokeDasharray||"",b=a.strokeDashoffset||"";m("none");a.strokeDasharray=d+","+d;a.strokeDashoffset=d;j.getBoundingClientRect();m("stroke-dashoffset "+l);a.strokeDashoffset=0;if(f._flowthread){xui.Thread.abort(f._flowthread)}xui.setTimeout(function(e){if(!f.destroyed&&g&&j){m("none");a.strokeDasharray=c;a.strokeDashoffset=b;if(e=f.properties.offsetFlow){f.boxing().setOffsetFlow(e,true)}}},parseInt(l,10)*1000)}},offsetFlow:{ini:"",combobox:["none","2x","4x","8x","-2x","-4x","-8x"],action:function(m){if(!Raphael.svg||this.box.$noShape){return}var b=this,j=b._elset[0],f,g=0;if(b._flowthread){xui.Thread.abort(b._flowthread)}if(m){f=xui(j.node).attr("stroke-dasharray");if(!f){return}f=f.replace(/\s+/,"").split(",");for(var e=0,c=f.length;e<c;e++){g+=parseInt(f[e],10)}if(g>0){g=g*2;var d=0,a=parseInt(m,10);if(a){b._flowthread=xui.Thread.repeat(function(){if(b.destroyed||!j||!j.attr){return false}j.attr("stroke-dashoffset",d=(d+a)%g)},100).id}}}}}},Behaviors:{HotKeyAllowed:false,HoverEffected:{KEY:"KEY"},ClickEffected:{KEY:"KEY"},onClick:function(a,c,d){if(a.$inDesign){return false}var b=a.properties;if(b.disabled){return false}if(a.onClick){return a.boxing().onClick(a,c,d)}},onDblclick:function(a,c,d){if(a.$inDesign){return false}var b=a.properties;if(b.disabled){return false}if(a.onDblClick){return a.boxing().onDblClick(a,c,d)}},onContextmenu:function(a,b,c){if(a.onContextmenu){return a.boxing().onContextmenu(a,b,c,xui.Event.getPos(b))!==false}}},EventHandlers:{onClick:function(a,b,c){},onDblClick:function(a,b,c){},onContextmenu:function(a,b,c,d){},onHotKeydown:null,onHotKeypress:null,onHotKeyup:null},_beforeSerialized:function(a){var b=arguments.callee.upper.call(this,a),c=b.properties;c.attr=xui.clone(c.attr,true);xui.filter(c.attr,function(e,d){if(d=="transform"&&(!e||e.length<1)){return false}if(d=="href"||d=="target"){return false}if(d=="path"&&xui.isArr(c.attr.path)){c.attr.path=e.join("")}});return b},RenderTrigger:function(){var b=this,a;(b.$beforeDestroy=(b.$beforeDestroy||{}))["svgClear"]=function(){if(b._flowthread){xui.Thread.abort(b._flowthread)}if(b._elset){b._elset.forEach(function(c){if(c){delete c._rootNode}});b._elset.remove();b._elset.clear();delete b._elset}if(b._shadow){b._shadow.remove();b._shadow.clear();delete b._shadow}};b.box._initAttr2UI(b);xui.setTimeout(function(){if(b.destroyed){return}var f=b.properties,c=b.boxing(),e=c.getAllNodes(),d;if(d=f.animDraw){c.setAnimDraw(d,true)}else{if(d=f.offsetFlow){c.setOffsetFlow(d,true)}}if(v=f.visibility){e.css("visibility",v)}if(v=f.display){e.css("display",v)}if(v=f.className){e.addClass(v)}})},_RenderSVG:function(c){c._pathCached={};var d=c.parent;if(d&&d._paper&&d._canvas){c._elset=this._draw(d._paper,c,c.properties);for(var b=1,a=c._elset.length;b<a;b++){c._elset._rootNode=c._elset[0]}}},_adjustAttr:function(a){var d=this,c={},b=xui.svg.$attr;xui.each(a,function(f,e){if(/^[A-Z_]+(_[0-9]+)?$/.test(e)&&xui.isHash(f)&&((e.indexOf("_")!=-1)||(e in d.$tagName))){c[e]=c[e]||{};xui.each(f,function(j,g){if(b[d.$tagName[e]||e.split("_")[0].toLowerCase()][g]){c[e][g]=j}})}else{if(b[d.$tagName.KEY][e]){c.KEY=c.KEY||{};c.KEY[e]=f}}});return c},_initAttr2UI:function(b){var a=this._adjustAttr(b.properties.attr);if(b._elset){b.boxing().setAttr(a)}if(b.properties.shadow){b.boxing().setShadow(true,true)}},$adjustBB:function(a,c){var d=typeof(a)=="object"?a:{},b="left,top,right,bottom,x,y,x2,y2,width,height".split(",");if(typeof(a)=="string"){d[a]=c}xui.filter(d,function(f,e){if(xui.arr.indexOf(b,e)==-1||f==="auto"||f===""){return false}if(!xui.isNumb(f)){d[e]=parseFloat(f)||0;return false}});if("left" in d){d.x=d.left;delete d.left}if("top" in d){d.y=d.top;delete d.top}if("right" in d){d.x2=d.right;delete d.right}if("bottom" in d){d.y2=d.bottom;delete d.bottom}if("x" in d&&"width" in d){delete d.x2}if("y" in d&&"height" in d){delete d.y2}if("x2" in d){if("width" in d){d.x=d.x2-d.width}else{d.width=d.x2-d.x}delete d.x2}if("y2" in d){if("height" in d){d.y=d.y2-d.height}else{d.height=d.y2-d.y}delete d.y2}return d},$transform:function(c,f){if(!xui.isStr(c)){c=c.join("")}if(/[mlhvcsqtaz]/.test(c)){c=Raphael._pathToAbsolute(c)}else{c=Raphael.parsePathString(c)}var j=Raphael.transformPath(c,f),b=/[r]/.test(f);for(var e=0,a=j.length,g,d;e<a;e++){if(j[e][0]!=c[e][0]){g=j[e].length;switch(d=c[e][0]){case"M":break;case"L":j[e]=[d,j[e][g-2],j[e][g-1]];break;case"H":if(b){j[e]=["L",j[e][g-2],j[e][g-1]]}else{j[e]=[d,j[e][g-2]]}break;case"V":if(b){j[e]=["L",j[e][g-2],j[e][g-1]]}else{j[e]=[d,j[e][g-1]]}break;case"C":break;case"Q":j[e]=[d,j[e][g-6],j[e][g-5],j[e][g-2],j[e][g-1]];break;case"S":j[e]=[d,j[e][g-4],j[e][g-3],j[e][g-2],j[e][g-1]];break;case"T":j[e]=[d,j[e][g-2],j[e][g-1]];break;case"A":break;case"Z":j[e]=[d];break;default:continue}}}return j.join("")},$setBB:function(J,m,c,L,d,C){var Q={},N=function(x){var l={};for(var r in x){l[r]=x[r]}return l};switch(m){case"circle":if(xui.isNumb(c.width)){Q.r=c.width/2}if(xui.isNumb(c.height)){if(c.height/2>=L.r&&(xui.isSet(Q.r)?Q.r>=L.r:1)){Q.r=xui.isSet(Q.r)?Math.max(Q.r,c.height/2):(c.height/2)}else{Q.r=xui.isSet(Q.r)?Math.min(Q.r,c.height/2):(c.height/2)}}Q.cx=xui.isNumb(c.x)?(c.x+(xui.isSet(Q.r)?Q.r:L.r)):(L.cx+(xui.isSet(Q.r)?(Q.r-L.r):0));Q.cy=xui.isNumb(c.y)?(c.y+(xui.isSet(Q.r)?Q.r:L.r)):(L.cy+(xui.isSet(Q.r)?(Q.r-L.r):0));break;case"ellipse":if(xui.isNumb(c.width)){Q.rx=c.width/2}if(xui.isNumb(c.height)){Q.ry=c.height/2}Q.cx=xui.isNumb(c.x)?(c.x+(xui.isSet(Q.rx)?Q.rx:L.rx)):(L.cx+(xui.isSet(Q.rx)?(Q.rx-L.rx):0));Q.cy=xui.isNumb(c.y)?(c.y+(xui.isSet(Q.ry)?Q.ry:L.ry)):(L.cy+(xui.isSet(Q.ry)?(Q.ry-L.ry):0));break;case"rect":case"image":if(xui.isNumb(c.x)){Q.x=c.x}if(xui.isNumb(c.y)){Q.y=c.y}if(xui.isNumb(c.width)){Q.width=c.width}if(xui.isNumb(c.height)){Q.height=c.height}break;case"text":var G,P;if(d){d._.dirty=1;G=N(d._getBBox(true));P=d.attr("text-anchor")}else{var H=xui.Dom.getEmptyDiv(),I=Raphael(H.get(0).id,1,1),F=I.text(0,0,L.text);G=N(F._getBBox(true));P=F.attr("text-anchor");F.remove();I.remove();H.empty()}if(xui.isNumb(c.x)){G.x=c.x}if(xui.isNumb(c.y)){G.y=c.y}var s=L.hAlign||"center",f=L.vAlign||"middle",g=G?(P=="start"?-G.width/2:P=="middle"?0:G.width/2):0;if(xui.isNumb(c.x)){if(s=="center"){if(xui.isNumb(c.width)){Q.x=c.x+c.width/2}else{Q.x=c.x+(G?(G.width/2):0)}}else{if(s=="left"){Q.x=c.x+(G?(G.width/2):0)}else{if(s=="outterleft"){Q.x=c.x-(G?(G.width/2):0)}else{if(s=="right"){if(xui.isNumb(c.width)){Q.x=c.x+c.width-(G?(G.width/2):0)}else{}}else{if(s=="outterright"){if(xui.isNumb(c.width)){Q.x=c.x+c.width+(G?(G.width/2):0)}else{}}else{if(xui.isNumb(c.width)){Q.x=c.x+c.width*parseFloat(s)/100}else{Q.x=c.x+(G?(G.width*parseFloat(s)/100):0)}}}}}}Q.x+=g}if(xui.isNumb(c.y)){if(f=="middle"){if(xui.isNumb(c.height)){Q.y=c.y+c.height/2}else{Q.y=c.y+(G?(G.height/2):0)}}else{if(f=="top"){Q.y=c.y+(G?(G.height/2):0)}else{if(f=="outtertop"){Q.y=c.y-(G?(G.height/2):0)}else{if(f=="bottom"){if(xui.isNumb(c.height)){Q.y=c.y+c.height-(G?(G.height/2):0)}else{}}else{if(f=="outterbottom"){if(xui.isNumb(c.height)){Q.y=c.y+c.height+(G?(G.height/2):0)}else{}}else{if(xui.isNumb(c.height)){Q.y=c.y+c.height*parseFloat(f)/100}else{Q.y=c.y+(G?(G.height*parseFloat(f)/100):0)}}}}}}}break;case"path":var G;if(d){d._.dirty=1;G=N(d._getBBox(true))}else{var H=xui.Dom.getEmptyDiv(),I=Raphael(H.get(0).id,1,1),F=I.path("");F.attr(L);G=N(F._getBBox(true));F.remove();I.remove();H.empty()}var R=N(G);if(xui.isNumb(c.x)){Q.x=c.x}if(xui.isNumb(c.y)){Q.y=c.y}if(xui.isNumb(c.width)){Q.width=c.width}if(xui.isNumb(c.height)){Q.height=c.height}if(("x" in Q&&G.x!==Q.x)||("y" in Q&&G.y!==Q.y)){var A=0,w=0;if("x" in Q){A=Q.x-G.x;G.x=Q.x}if("y" in Q){w=Q.y-G.y;G.y=Q.y}var K=Raphael.parsePathString(L.path);for(var O=0,D=K.length,M;O<D;O++){M=K[O].length;switch(K[O][0]){case"M":case"L":K[O][1]+=A;K[O][2]+=w;break;case"H":K[O][1]+=A;break;case"V":K[O][1]+=w;break;case"C":K[O][1]+=A;K[O][2]+=w;K[O][3]+=A;K[O][4]+=w;K[O][5]+=A;K[O][6]+=w;break;case"Q":case"S":K[O][1]+=A;K[O][2]+=w;K[O][3]+=A;K[O][4]+=w;break;case"T":K[O][1]+=A;K[O][2]+=w;break;case"A":K[O][M-2]+=A;K[O][M-1]+=w;continue;default:continue}}Q.path=K.join("")}if(("width" in Q&&G.width!==Q.width)||("height" in Q&&G.height!==Q.height)){var S=("width" in Q)?Q.width:null,j=("height" in Q)?Q.height:null,e=Q.path||L.path,B=xui.svg.$transform(e,"s"+((xui.isSet(S)&&S!==R.width)?(R.width===0?(S>=0?1.1:0.9):S/R.width):"1")+","+((xui.isSet(j)&&j!==R.height)?(R.height===0?(j>=0?1.1:0.9):j/R.height):"1")+","+G.x+","+G.y);Q.path=B}break}var b=xui.svg.$attr[m];xui.filter(Q,function(r,l){if(xui.isSet(r)&&(l in b)){L[l]=r}else{return false}});if(d&&(!xui.isEmpty(Q))){var a=Raphael.parseTransformString(d.transform()),E;if(a&&a.length){E=1;d.transform("");var q=-1,o=-1,u;for(var O=0,M=a.length;O<M;O++){if(a[O][0]=="r"){q=O;u=a[O][1]}else{if(a[O][0]=="t"){o=O}}}if(o!=-1&&q!=-1){d.rotate(u);var n=Raphael.parseTransformString(d.transform());d.transform("");a[o][1]-=n[0][1];a[o][2]-=n[0][2];if(!a[o][1]&&!a[o][2]){xui.arr.removeFrom(a,o)}}}d.attr(Q);if(E){d.transform("r"+u)}if(C!==false){J.box._notify(J,{bBox:1},true)}}},_syncAttr:function(b,a,c){b._pathCached={}},_notify:function(b,a,c){if(b.box._syncAttr){b.box._syncAttr(b,a,c)}if(c&&!b.box._CONNECTOR&&b.box._syncConnectors){b.box._syncConnectors(b)}if(c&&b._shadow){b.boxing().setShadow(false).setShadow(true)}},_draw:function(){},_syncConnectors:function(c){if(c.parent.key!=="xui.UI.SVGPaper"){return}var b=xui.get(c,["parent","children"]),a=c.alias;if(b&&b.length){xui.arr.each(b,function(e,d){if(!e[0].destroyed&&c.renderCompleted&&e[0].renderCompleted&&e[0].key==="xui.svg.connector"){if(a===xui.get(e[0],["properties","fromObj"])){e[0].box._reconnect(e[0],c)}if(a===xui.get(e[0],["properties","toObj"])){e[0].box._reconnect(e[0],null,c)}}})}},_syncAlias:function(d,b,a){var c=xui.get(d,["parent","children"]);if(c&&c.length){xui.arr.each(c,function(f,e){if(f[0].key==="xui.svg.connector"){if(b===xui.get(f[0],["properties","fromObj"])){xui.set(f[0],["properties","fromObj"],a)}if(b===xui.get(f[0],["properties","toObj"])){xui.set(f[0],["properties","toObj"],a)}}})}}}});xui.Class("xui.svg.circle","xui.svg",{Instance:{_setBBox:function(a,b){var c=xui.svg.$adjustBB(a,b);return this.each(function(d){xui.svg.$setBB(d,"circle",c,d.properties.attr,d._elset&&d._elset[0])})}},Static:{DataModel:{attr:{ini:{cx:0,cy:0,r:20}}},Templates:{tagName:"circle"},_draw:function(c,b,d){d=d.attr;var a=c.circle(d.cx,d.cy,d.r);a.node.id=b.box.KEY+":"+b.serialId+":";return c.set().push(a)}}});xui.Class("xui.svg.ellipse","xui.svg",{Instance:{_setBBox:function(a,b){var c=xui.svg.$adjustBB(a,b);return this.each(function(d){xui.svg.$setBB(d,"ellipse",c,d.properties.attr,d._elset&&d._elset[0])})}},Static:{DataModel:{attr:{ini:{cx:0,cy:0,rx:20,ry:40}}},Templates:{tagName:"ellipse"},_draw:function(c,b,d){d=d.attr;var a=c.ellipse(d.cx,d.cy,d.rx,d.ry);a.node.id=b.box.KEY+":"+b.serialId+":";return c.set().push(a)}}});xui.Class("xui.svg.rect","xui.svg",{Instance:{_setBBox:function(a,b){var c=xui.svg.$adjustBB(a,b);return this.each(function(d){xui.svg.$setBB(d,"rect",c,d.properties.attr,d._elset&&d._elset[0])})}},Static:{DataModel:{attr:{ini:{x:0,y:0,r:0,width:40,height:40}}},Templates:{tagName:"rect"},_draw:function(c,b,d){d=d.attr;var a=c.rect(d.x,d.y,d.width,d.height,d.r);a.node.id=b.box.KEY+":"+b.serialId+":";return c.set().push(a)}}});xui.Class("xui.svg.image","xui.svg",{Instance:{_setBBox:function(a,b){var c=xui.svg.$adjustBB(a,b);return this.each(function(d){xui.svg.$setBB(d,"image",c,d.properties.attr,d._elset&&d._elset[0])})}},Static:{$noShape:1,IMGNODE:1,DataModel:{attr:{ini:{src:"",x:0,y:0,width:20,height:20}}},Templates:{tagName:"image"},_draw:function(c,b,d){d=d.attr;var a=c.image(xui.adjustRes(d.src),d.x,d.y,d.width,d.height);a.node.id=b.box.KEY+":"+b.serialId+":";return c.set().push(a)}}});xui.Class("xui.svg.text","xui.svg",{Instance:{_setBBox:function(a,b){var c=xui.svg.$adjustBB(a,b);return this.each(function(d){xui.svg.$setBB(d,"text",c,d.properties.attr,d._elset&&d._elset[0])})}},Static:{$noShape:1,DataModel:{attr:{ini:{x:0,y:0,text:"text"}},text:{ini:undefined,hidden:true,set:function(a){this.boxing().setAttr("KEY",{text:this.properties.text=a||""},false)}}},Templates:{tagName:"text"},_draw:function(c,b,d){d=d.attr;var a=c.text(d.x,d.y,d.text);if(xui.isSet(d.text)){a.attr("text",d.text)}a.node.id=b.box.KEY+":"+b.serialId+":";return c.set().push(a)}}});xui.Class("xui.svg.path","xui.svg",{Instance:{getPath:function(){var a=this.get(0),b=a.properties;if(a._elset&&a._elset[0]){b.path=a._elset[0].attr("path").join("")}return b.path},_getConnectAnchors:function(){},_setBBox:function(a,b){var c=xui.svg.$adjustBB(a,b);return this.each(function(d){xui.svg.$setBB(d,"path",c,d.properties.attr,d._elset&&d._elset[0])})}},Static:{$abstract:true,_draw:function(c,d,a){a=a.attr;var j=a.x?a.x:0;var g=a.y?a.x:0;var n=Raphael.parsePathString(a.path);for(var f=0,m=n.length,e;f<m;f++){e=n[f].length;if(e!="Z"){n[f][1]+=j;n[f][2]+=g}}var b=c.path(n);b.node.id=d.box.KEY+":"+d.serialId+":";return c.set().push(b)},DataModel:{attr:{ini:{path:"",x:0,y:0}}},Templates:{tagName:"path"}}});xui.Class("xui.svg.absComb","xui.svg",{Instance:{_setBBox:function(b,c,a){var d=xui.svg.$adjustBB(b,c);return this.each(function(g){var l=g.properties,f=g._elset;xui.svg.$setBB(g,g.box._type,d,l.attr.KEY,f&&f[0]);if(g.renderId&&f&&f[0]){if(l.attr.TEXT&&l.attr.TEXT.text){var e=xui.copy(l.attr.TEXT||{}),j=f[0]._getBBox(true);e.hAlign=l.hAlign;e.vAlign=l.vAlign;if(!("x" in d)){d.x=j.x}if(!("y" in d)){d.y=j.y}if(!("width" in d)){d.width=j.width}if(!("height" in d)){d.height=j.height}xui.svg.$setBB(g,"text",d,e,f&&f[1],a)}}})},_adjustText:function(){return this.each(function(c){var e=c.properties,b=c._elset;if(c.renderId&&b&&b[0]){if(e.attr.TEXT&&e.attr.TEXT.text){var a=xui.copy(e.attr.TEXT||{}),d=b[0]._getBBox(true);a.hAlign=e.hAlign;a.vAlign=e.vAlign;xui.svg.$setBB(c,"text",d,a,b[1],false)}}})},setAttr:function(b,e,d,a){var c;if(xui.isHash(b)){c=b}else{c={};c[b]=e}arguments.callee.upper.call(this,b,e,d,a);return this.each(function(f){if(f._elset){if((c=c.TEXT)&&c["text-anchor"]){f.boxing()._adjustText()}}})}},Static:{$abstract:true,ISCOMBO:1,_beforeSerialized:function(a){var b=arguments.callee.upper.call(this,a),c=b.properties;c.attr=xui.clone(c.attr,true);xui.filter(c.attr.KEY,function(e,d){if(d=="transform"&&(!e||e.length<1)){return false}if(d=="href"||d=="target"){return false}if(d=="path"&&xui.isArr(c.attr.KEY.path)){c.attr.KEY.path=e.join("")}});if(c.attr.TEXT){xui.filter(c.attr.TEXT,function(e,d){if(d=="transform"){return false}if(d=="x"||d=="y"){return false}if(d=="href"||d=="target"){return false}})}delete c.text;return b},DataModel:{attr:{ini:{KEY:{},TEXT:{}}},hAlign:{ini:"center",combobox:["left","25%","center","75%","right","outterleft","outterright"],action:function(){this.boxing()._adjustText()}},vAlign:{ini:"middle",combobox:["top","25%","middle","75%","bottom","outtertop","outterbottom"],action:function(){this.boxing()._adjustText()}},text:{ini:undefined,hidden:true,get:function(){var a=this.boxing().getAttr("TEXT");return a&&a.text},set:function(a){this.boxing().setAttr("TEXT",{text:a||""},false)}},shadow:true},Behaviors:{onClick:function(a,c,d){if(a.$inDesign){return false}var b=a.properties;if(b.disabled){return false}if(a.onClick){return a.boxing().onClick(a,c,d)}},onDblclick:function(a,c,d){if(a.$inDesign){return false}var b=a.properties;if(b.disabled){return false}if(a.onDblClick){return a.boxing().onDblClick(a,c,d)}},onContextmenu:function(a,b,c){if(a.onContextmenu){return a.boxing().onContextmenu(a,b,c,xui.Event.getPos(b))!==false}},TEXT:{onClick:function(a,d,f){if(a.$inDesign){return false}var c=a.properties,b;if(c.disabled){return false}if(a.onTextClick){b=a.boxing().onTextClick(a,d,f)}if(b!==false&&a.onClick){return a.boxing().onClick(a,d,f)}},onDblclick:function(a,c,d){if(a.$inDesign){return false}var b=a.properties;if(b.disabled){return false}if(a.onDblClick){return a.boxing().onDblClick(a,c,d)}},onContextmenu:function(a,b,c){if(a.onContextmenu){return a.boxing().onContextmenu(a,b,c,xui.Event.getPos(b))!==false}}}},EventHandlers:{onTextClick:function(a,b,c){}},_initAttr2UI:function(d){arguments.callee.upper.call(this,d);d.boxing()._adjustText();var c=d._elset;if(c&&c[1]){var e=c[0].attr("transform");for(var b=1,a=c.length;b<a;b++){c[b].attr("transform",e)}}},_syncAttr:function(d,b,e){var c=arguments.callee.upper,a=xui.toArr(arguments);c.apply(this,a);c=null;if(e){d.boxing()._adjustText()}},_draw:function(f,d,g){var c=f.set(),a=g.attr.KEY,e=g.attr.TEXT,b=this._drawRoot(f,a);b.node.id=d.box.KEY+":"+d.serialId+":";c.push(b);b=f.text(a.x,a.y,e.text);b.node.id=d.box.KEY+"-TEXT:"+d.serialId+":";c.push(b);return c}}});xui.Class("xui.svg.rectComb","xui.svg.absComb",{Static:{_type:"rect",Templates:{tagName:"rect",TEXT:{tagName:"text",svg:1}},_drawRoot:function(b,a){return b.rect(a.x,a.y,a.width,a.height)}}});xui.Class("xui.svg.circleComb","xui.svg.absComb",{Static:{_type:"circle",Templates:{tagName:"circle",TEXT:{tagName:"text",svg:1}},_drawRoot:function(b,a){return b.circle(a.cx,a.cy,a.r)}}});xui.Class("xui.svg.ellipseComb","xui.svg.absComb",{Static:{_type:"ellipse",Templates:{tagName:"ellipse",TEXT:{tagName:"text",svg:1}},_drawRoot:function(b,a){return b.ellipse(a.cx,a.cy,a.rx,a.ry)}}});xui.Class("xui.svg.pathComb","xui.svg.absComb",{Static:{_type:"path",DataModel:{attr:{ini:{x:0,y:0}}},Templates:{tagName:"path",TEXT:{tagName:"text",svg:1}},_drawRoot:function(a,d){var n=d.path;if((d.cx&&d.cx!=d.x)||(d.cy&&d.cy!=d.y)){var f=d.cx?d.cx-d.x:0;var e=d.cy?d.cy-d.y:0;var m=Raphael.parsePathString(d.path);for(var c=0,g=m.length,b;c<g;c++){b=m[c].length;switch(m[c][0]){case"M":case"L":m[c][1]+=f;m[c][2]+=e;break;case"H":m[c][1]+=f;break;case"V":m[c][1]+=e;break;case"C":m[c][1]+=f;m[c][2]+=e;m[c][3]+=f;m[c][4]+=e;m[c][5]+=f;m[c][6]+=e;break;case"Q":case"S":m[c][1]+=f;m[c][2]+=e;m[c][3]+=f;m[c][4]+=e;break;case"T":m[c][1]+=f;m[c][2]+=e;break;case"A":m[c][b-2]+=f;m[c][b-1]+=e;continue;default:continue}d.cx==d.x;d.cy==d.y;var j=m.join("");d.path=j}}return a.path(d.path)}}});xui.Class("xui.svg.imageComb","xui.svg.absComb",{Static:{IMGNODE:1,$noShape:1,_type:"image",Templates:{tagName:"image",TEXT:{tagName:"text",svg:1}},_drawRoot:function(b,a){return b.image(a.src,a.x,a.y,a.width,a.height)}}});xui.Class("xui.svg.connector","xui.svg.absComb",{Instance:{_getConnectAnchors:null,_getConnectPath:null,_getConnectPoint:null,toFront:function(){return this.each(function(c){if(c=c._elset){c[1].toFront();c[0].toFront()}var a=xui.get(c,["parent","children"]);if(a&&a.length){var b=xui.arr.subIndexOf(a,"0",c),d;if(b!=-1){d=a[b];a.splice(b,1);a.push(d)}}})},toBack:function(){return this.each(function(c){if(c=c._elset){c[0].toBack();c[1].toBack()}var a=xui.get(c,["parent","children"]);if(a&&a.length){var b=xui.arr.subIndexOf(a,"0",c),d;if(b!=-1){d=a[b];a.splice(b,1);a.unshift(d)}}})}},Static:{_CONNECTOR:true,_beforeSerialized:function(a){var b=arguments.callee.upper.call(this,a),c=b.properties;if(c.attr.BG){delete c.attr.BG.path;delete c.attr.BG["arrow-start"];delete c.attr.BG["arrow-end"]}return b},DataModel:{hAlign:null,vAlign:null,shadow:null,bgLine:{ini:true,action:function(a){if(this._bg){if(a){this._bg.show()}else{this._bg.hide()}}}},attr:{ini:{KEY:{path:""}}},type:{ini:"straight",listbox:["straight","bezier","flowchart"],action:function(a,b){if(this.renderId){this.properties.type=b}}},fromObj:"",fromPoint:{ini:"",combobox:["left","top","right","bottom"]},toObj:"",toPoint:{ini:"",combobox:["left","top","right","bottom"]}},_type:"path",Templates:{tagName:"path",BG:{tagName:"path",svg:1}},_draw:function(f,c,g){var b=f.set(),a=g.attr.KEY,e,d;d=f.path(a.path);d.node.id=c.box.KEY+":"+c.serialId+":";d.onShapeChanged=function(j){if(j.path){e.attr({path:j.path},null,false)}};b.push(d);e=f.path(a.path);if(!c.properties.bgLine){e.hide()}e.node.id=c.box.KEY+"-BG:"+c.serialId+":";b.push(e);e.insertBefore(d);c._bg=e;(c.$beforeDestroy=(c.$beforeDestroy||{}))["unbind"]=function(){d.onShapeChanged=null;d=null};return b},_syncAttr:function(c,o,g){var m=arguments.callee.upper,f=xui.toArr(arguments);m.apply(this,f);m=null;c._pathCached={};if(!c._bg){return}var j=this,b=c.properties,n=c._elset[0],e={},l,d;d="path";if((d in o)||("bBox" in o)){e[d]=n.attr(d)}d="arrow-start";if(d in o){l=n.attr(d);l=l.split("-");if(l[0]!="none"){e[d]=l[0]+"-narrow-short"}else{e[d]="none"}}d="arrow-end";if(d in o){l=n.attr(d);l=l.split("-");if(l[0]!="none"){e[d]=l[0]+"-narrow-short"}else{e[d]="none"}}c._bg.attr(e,null,false);if(("bBox" in o)&&c.parent){if(b.fromObj&&b.fromPoint){xui.arr.each(c.parent.children,function(a){if(a[0].alias==b.fromObj){j._reconnect(c,a[0]);return false}})}if(b.toObj&&b.toPoint){xui.arr.each(c.parent.children,function(a){if(a[0].alias==b.toObj){j._reconnect(c,null,a[0]);return false}})}}},_reconnect:function(d,j,f){if(d.destroyed){return}var a=d.properties,o=a.type,r=Raphael.parsePathString(a.attr.KEY.path),e=d.boxing(),m,n;if(j&&a.fromObj&&a.fromPoint){m=j.boxing();n=m._getConnectPoint(a.fromPoint);if(n){switch(o){case"flowchart":var q=this._redrawBrokenLine(d);if(q){r.length=0;xui.arr.each(q,function(l){r.push(l)})}break;case"straight":r[0][1]=n.x;r[0][2]=n.y;break;case"bezier":var c=n.x-r[0][1],b=n.y-r[0][2];r[0][1]=n.x;r[0][2]=n.y;r[1][1]+=c;r[1][2]+=b;break}e.setAttr("KEY",{path:r},false)}}if(f&&a.toObj&&a.toPoint){m=f.boxing();n=m._getConnectPoint(a.toPoint);if(n){var g=r.length-1;if((r[g][0]||"").toUpperCase()=="Z"){g--}switch(o){case"flowchart":var q=this._redrawBrokenLine(d);if(q){r.length=0;xui.arr.each(q,function(l){r.push(l)})}break;case"straight":r[g][1]=n.x;r[g][2]=n.y;break;case"bezier":var c=n.x-r[g][5],b=n.y-r[g][6];r[g][5]=n.x;r[g][6]=n.y;r[g][3]+=c;r[g][4]+=b;break}e.setAttr("KEY",{path:r},false)}}},_redrawBrokenLine:function(L,S,G,F){var J=30,w=30,u=30,s=L.properties,o=s.attr.KEY,B=Raphael.parsePathString(o.path),a=s.fromObj&&s.fromPoint,l=s.toObj&&s.toPoint,c,f,d=[],m=[],E=[],R=[],H,j,b,e,n,K,C,r,N,I,g,A,M;if(a){H=null;xui.arr.each(L.parent.children,function(x){if(x[0].alias==s.fromObj){H=x[0].boxing();K=H._getConnectPoint(s.fromPoint);if(K){j=H._getConnectPath();if(e=xui.get(x[0]._pathCached,["_connBBox"])){}else{e=Raphael.pathBBox(j);xui.set(x[0]._pathCached,["_connBBox"],e)}if(K.solid){r=K.alpha}else{r=K.alpha-90}N={x:e.x+e.width/2,y:e.y+e.height/2};g=(r>45&&r<=135)?"down":(r>135&&r<=225)?"left":(r>225&&r<=315)?"up":"right";if(g=="down"&&K.y<N.y){g="up"}if(g=="right"&&K.x<N.x){g="left"}}return false}})}if(l){H=null;xui.arr.each(L.parent.children,function(x){if(x[0].alias==s.toObj){H=x[0].boxing();C=H._getConnectPoint(s.toPoint);if(C){b=H._getConnectPath();if(n=xui.get(x[0]._pathCached,["_connBBox"])){}else{n=Raphael.pathBBox(b);xui.set(x[0]._pathCached,["_connBBox"],n)}if(C.solid){r=C.alpha}else{r=C.alpha-90}I={x:n.x+n.width/2,y:n.y+n.height/2};A=(r>45&&r<=135)?"down":(r>135&&r<=225)?"left":(r>225&&r<=315)?"up":"right";if(A=="down"&&C.y<I.y){A="up"}if(A=="right"&&C.x<I.x){A="left"}}return false}})}if(K&&C){if((g=="left"&&A=="right"&&C.x>=K.x)||(g=="right"&&A=="left"&&C.x<=K.x)){w=Math.min(w,Math.abs(C.x-K.x)/2)}if((g=="down"&&A=="up"&&C.y>=K.y)||(g=="up"&&A=="down"&&C.y<=K.y)){u=Math.min(u,Math.abs(C.y-K.y)/2)}}if(K){switch(g){case"down":c=[{x:K.x,y:M=K.y+u},{x:e.x-J,y:M},{x:e.x+J+e.width,y:M}];d=[[["M",K.x,K.y],["V",c[0].y]],[["M",K.x,K.y],["V",c[0].y],["H",c[1].x]],[["M",K.x,K.y],["V",c[0].y],["H",c[2].x]]];E=[u,u+Math.abs(c[1].x-c[0].x),u+Math.abs(c[2].x-c[0].x)];break;case"left":c=[{x:M=K.x-w,y:K.y},{x:M,y:e.y-J},{x:M,y:e.y+J+e.height}];d=[[["M",K.x,K.y],["H",c[0].x]],[["M",K.x,K.y],["H",c[0].x],["V",c[1].y]],[["M",K.x,K.y],["H",c[0].x],["V",c[2].y]]];E=[w,w+Math.abs(c[1].y-c[0].y),w+Math.abs(c[2].y-c[0].y)];break;case"up":c=[{x:K.x,y:M=K.y-u},{x:e.x-J,y:M},{x:e.x+J+e.width,y:M}];d=[[["M",K.x,K.y],["V",c[0].y]],[["M",K.x,K.y],["V",c[0].y],["H",c[1].x]],[["M",K.x,K.y],["V",c[0].y],["H",c[2].x]]];E=[u,u+Math.abs(c[1].x-c[0].x),u+Math.abs(c[2].x-c[0].x)];break;case"right":c=[{x:M=K.x+w,y:K.y},{x:M,y:e.y-J},{x:M,y:e.y+J+e.height}];d=[[["M",K.x,K.y],["H",c[0].x]],[["M",K.x,K.y],["H",c[0].x],["V",c[1].y]],[["M",K.x,K.y],["H",c[0].x],["V",c[2].y]]];E=[w,w+Math.abs(c[1].y-c[0].y),w+Math.abs(c[2].y-c[0].y)];break}}else{if(S=="start"){c=[{x:G,y:F}]}else{c=[{x:B[0][1],y:B[0][2]}]}d=[[["M",c[0].x,c[0].y]]];E=[0]}if(C){switch(A){case"down":f=[{x:C.x,y:M=C.y+u},{x:n.x-J,y:M},{x:n.x+J+n.width,y:M}];m=[[["V",C.y]],[["H",C.x],["V",C.y]],[["H",C.x],["V",C.y]]];R=[u,u+Math.abs(f[1].x-f[0].x),u+Math.abs(f[2].x-f[0].x)];break;case"left":f=[{x:M=C.x-w,y:C.y},{x:M,y:n.y-J},{x:M,y:n.y+J+n.height}];m=[[["H",C.x]],[["V",C.y],["H",C.x]],[["V",C.y],["H",C.x]]];R=[w,w+Math.abs(f[1].y-f[0].y),w+Math.abs(f[2].y-f[0].y)];break;case"up":f=[{x:C.x,y:M=C.y-u},{x:n.x-J,y:M},{x:n.x+J+n.width,y:M}];m=[[["V",C.y]],[["H",C.x],["V",C.y]],[["H",C.x],["V",C.y]]];R=[u,u+Math.abs(f[1].x-f[0].x),u+Math.abs(f[2].x-f[0].x)];break;case"right":f=[{x:M=C.x+w,y:C.y},{x:M,y:n.y-J},{x:M,y:n.y+J+n.height}];m=[[["H",C.x]],[["V",C.y],["H",C.x]],[["V",C.y],["H",C.x]]];R=[w,w+Math.abs(f[1].y-f[0].y),w+Math.abs(f[2].y-f[0].y)];break}}else{if(S=="end"){f=[{x:G,y:F}]}else{var P={x:B[0][1],y:B[0][2]};xui.arr.each(B,function(x){if(x[0]=="H"){P.x=x[1]}else{P.y=x[1]}});f=[P]}m=[];R=[0]}var D=[],O,Q;xui.arr.each(c,function(T,x){xui.arr.each(f,function(U,W){for(var V=0;V<=1;V++){O=xui.clone(d[x],true);if(V===0){if(U.x!==T.x){O.push(["H",U.x])}if(U.y!==T.y){O.push(["V",U.y])}}else{if(U.y!==T.y){O.push(["V",U.y])}if(U.x!==T.x){O.push(["H",U.x])}}if(m[W]&&m[W].length){xui.arr.insertAny(O,m[W])}D.push({path:O,len:O.length,len2:(E[x]||0)+(R[W]||0)+Math.abs(U.x-T.x)+Math.abs(U.y-T.y)})}})});var q=[];xui.filter(D,function(Z){var U=Z.path[0][1],T=Z.path[0][2],X,V,Y;for(var W=1,x=Z.path.length;W<x;W++){if(Y==Z.path[W][0]){if(Y=="H"){if((Z.path[W][1]>U)===X){Z.path.splice(W-1,1);Z.len--;x--;W--;continue}else{return false}}else{if((Z.path[W][1]>T)===V){Z.path.splice(W-1,1);Z.len--;x--;W--;continue}else{return false}}}if(Z.path[W][0]=="H"){X=Z.path[W][1]>U;U=Z.path[W][1]}else{V=Z.path[W][1]>T;T=Z.path[W][1]}Y=Z.path[W][0]}});xui.arr.each(D,function(T){Q=0;var x,U;if(e||n){x=T.path[0][1];U=T.path[0][2];xui.arr.each(T.path,function(W,V){if(V!==0){if(W[0]=="H"){if(e&&U>=e.y&&U<=e.y2&&Math.max(x,W[1])>Math.min(e.x,e.x2)&&Math.min(x,W[1])<Math.max(e.x,e.x2)){Q++}if(n&&U>=n.y&&U<=n.y2&&Math.max(x,W[1])>Math.min(n.x,n.x2)&&Math.min(x,W[1])<Math.max(n.x,n.x2)){Q++}x=W[1]}else{if(e&&x>=e.x&&x<=e.x2&&Math.max(U,W[1])>Math.min(e.y,e.y2)&&Math.min(U,W[1])<Math.max(e.y,e.y2)){Q++}if(n&&x>=n.x&&x<=n.x2&&Math.max(U,W[1])>Math.min(n.y,n.y2)&&Math.min(U,W[1])<Math.max(n.y,n.y2)){Q++}U=W[1]}}})}T.inter=Q});xui.arr.stableSort(D,function(T,U){return T.inter>U.inter?1:T.inter<U.inter?-1:T.len>U.len?1:T.len<U.len?-1:T.len2>U.len2?1:T.len2==U.len2?0:-1});L.boxing().setAttr("KEY",{path:D[0].path},false);return D[0].path}}});xui.Class("xui.svg.group","xui.svg.absComb",{Instance:{_adjustText:function(){return this},_setBBox:function(b,c,a){var d=xui.svg.$adjustBB(b,c);return this.each(function(j){var l=j.properties,g=j._elset,f=l.attr;if(j.renderId&&g&&g[0]){var e=j.boxing()._getBBox();g.forEach(function(o){var m=f[j.getKey(o.node.id,true)],n={};if(o.type=="text"){n={x:m.x,y:m.y};if("x" in d){n.x+=d.x-e.x}if("y" in d){n.y+=d.y-e.y}m.x=n.x;m.y=n.y;o.attr(n)}else{xui.merge(n,o._getBBox(true),"all",true);if("x" in d){n.x+=d.x-e.x}if("y" in d){n.y+=d.y-e.y}if("width" in d){n.width+=d.width-e.width}if("height" in d){n.height+=d.height-e.height}xui.svg.$setBB(j,o.type,n,m,o,a)}})}else{if(!j._init_bbox){j._init_bbox={}}xui.merge(j._init_bbox,d,"all",true)}})}},Static:{ISCOMBO:1,_beforeSerialized:function(b){var c=arguments.callee.upper.call(this,b),d=c.properties;var a=d.attr=xui.clone(d.attr,true);xui.filter(a.KEY,function(f,e){if(e=="transform"&&(!f||f.length<1)){return false}if(e=="href"||e=="target"){return false}if(e=="path"&&xui.isArr(d.attr.KEY.path)){d.attr.KEY.path=f.join("")}});xui.each(a,function(e,f){if(f=="KEY"){return}xui.filter(e,function(l,j){if(j=="transform"){return false}});var g=f.split("_")[0];if(g=="path"){xui.each(e,function(l,j){if(j=="path"&&xui.isArr(l)){e.path=l.join("")}})}});return c},_type:"path",Templates:{tagName:"path"},DataModel:{attr:{ini:{KEY:{}}},hAlign:null,vAlign:null,shadow:false},RenderTrigger:function(){var a=this,b;if(b=a._init_bbox){a.boxing()._setBBox(b);delete a._init_bbox}},_draw:function(e,d,g){var c=e.set(),a=g.attr,f=a.KEY||{path:""},b=e.path(f.path||"");b._isGroupFirst=1;b.node.id=d.box.KEY+":"+d.serialId+":";c.push(b);xui.each(a,function(j,l){if(l=="KEY"){return}var m=l.split("_")[0].toLowerCase();switch(m){case"rect":b=e.rect(j.x,j.y,j.width,j.height);break;case"circle":b=e.circle(j.cx,j.cy,j.r);break;case"ellipse":b=e.ellipse(j.cx,j.cy,j.rx,j.ry);break;case"image":b=e.image(j.src,j.x,j.y,j.width,j.height);break;case"path":b=e.path(j.path);break;case"text":b=e.text(j.x,j.y,j.text);break;default:return}var n=xui(this.node).xid();if(m=="text"){b.click(function(q){if(d.$inDesign){return false}if(d.properties.disabled){return false}var o;if(d.onTextClick){o=d.boxing().onTextClick(d,q,n)}if(o!==false&&d.onClick){return d.boxing().onClick(d,q,n)}})}else{b.click(function(o){if(d.$inDesign){return false}if(d.properties.disabled){return false}if(d.onClick){return d.boxing().onClick(d,o,n)}})}b.dblclick(function(o){if(d.$inDesign){return false}if(d.properties.disabled){return false}if(d.onDblClick){return d.boxing().onDblClick(d,o,n)}});b.contextmenu(function(o){if(d.onContextmenu){return d.boxing().onContextmenu(d,o,n)!==false}});b.node.id=d.box.KEY+"-"+l+":"+d.serialId+":";c.push(b)});return c}}});xui.Class("xui.UI.SVGPaper","xui.UI.Div",{Initialize:function(){this.addTemplateKeys(["SVG"])},Instance:{setChildren:function(d,a){var b=this;if(!a){try{b.removeChildren(true,true,true)}catch(c){}}xui.arr.each(d,function(e){b.append(xui.create(e.key).setProperties(e.properties).setAlias(e.alias))})},append:function(g,e,c){if(xui.isHash(g)||xui.isStr(g)){g=xui.create(g)}if(g["xui.UIProfile"]){g=g.boxing()}var a=this,b=arguments.callee.upper,d,j;g.each(function(f){d=!!f.box["xui.svg"];if(d&&f.renderId){f.clearCache();f.$beforeDestroy.svgClear();delete f.renderId;delete f.rendered;j=1}b.call(a,f,null,e,c,d,a.get(0)&&xui(a.get(0)._canvas));if(j){f.box._initAttr2UI(f)}});return this},getPaper:function(){return xui.get(this.get(0),["_paper"])},getSVGString:function(){var a=xui.get(this.get(0),["_paper"]);return a?a.toSVG():""}},Static:{DataModel:{expression:{ini:"",action:function(){}},iframeAutoLoad:null,html:null,width:{$spaceunit:1,ini:"32em"},height:{$spaceunit:1,ini:"25em"},scaleChildren:{ini:false},overflow:{ini:undefined},graphicZIndex:{ini:0,action:function(a){this.getSubNode("SVG").css("zIndex",a)}}},RenderTrigger:function(){var g=this,d=g.getRootNode(),j=g.properties,c=xui.CSS.$px(j.width,d,true),f=xui.CSS.$px(j.height,d,true);(g.$beforeDestroy=(g.$beforeDestroy||{}))["svgClear"]=function(){if(g._paper){g._paper.clear();g._paper.remove()}};g._paper=Raphael(g.$domId,c,f);g._canvas=g._paper.canvas;g._canvas.id=g.box.KEY+"-SVG:"+g.serialId+":";var e=g._canvas.style;e.position="absolute";e.left=0;e.top=0;e.zIndex=j.graphicZIndex;var b=[];xui.arr.each(g.children,function(a){if(a[0].box["xui.svg"]){b.push(a[0])}});if(b.length){g.boxing().append(xui.svg.pack(b));if(!Raphael.svg){xui.setTimeout(function(){if(g&&!g.destroyed){g.boxing().append(xui.svg.pack(b))}})}}if(g._paper){xui.setTimeout(function(){if(g&&!g.destroyed){if(g.$designerRoot){g._frame=g._paper.rect(0,0,1,1,0).attr({"stroke-width":"0px"})}else{if(g.$inDesign){g._frame=g._paper.rect(0,0,c,f,8).attr({"stroke-dasharray":". ",stroke:"#666"})}}if(g._frame){g._frame._decoration=1}}})}},_onresize:function(g,c,s){var d=g._paper,a=g.properties.scaleChildren,e,r,b=g,o,j=xui.$us(g),l=function(u,w){return g.$forceu(u,j>0?"em":"px",w)};c=c?g.$px(c,null,true):c;s=s?g.$px(s,null,true):s;if(a){e=g.$px(d.width,null,true);r=g.$px(d.height,null,true)}if(d){var q=g.$px(d.width,null,true),m=g.$px(d.height,null,true);if((c&&q!=c)||(s&&m!=s)){var n={},f=g.getSubNode("SVG");d.setSize(c,s);if(g.$inDesign&&g._frame){if(c||c===0){g._frame.attr("width",c)}if(s||s===0){g._frame.attr("height",s)}}if(!(c||c===0)){c=q}n.width=c;if((s||s===0)){s=m}n.height=s;if((!xui.isEmpty(n))&&xui.Dom.$hasEventHandler(f.get(0),"onsize")){f.onSize(true,n)}if(a){d.forEach(function(B){var x=c/e,A=s/r,u,w=function(F,E){var D=xui.UIProfile.getFromDom(F.node.id);if(!D){return}var C=F.attr(),G;switch(F.type){case"circle":G={cx:C.cx*x,cy:C.cy*A,r:C.r*(x+A)/2};break;case"ellipse":G={cx:C.cx*x,cy:C.cy*A,rx:C.rx*x,ry:C.ry*A};break;case"rect":case"image":G={x:C.x*x,y:C.y*A,width:C.width*x,height:C.height*A};break;case"text":G={x:C.x*x,y:C.y*A};break;case"path":G={path:Raphael.transformPath(xui.isArr(C.path)?C.path.join(""):C.path,"s"+x+","+A+",0,0")};break}if(G){D.boxing().setAttr(E||"KEY",G,false,true)}};if(g._frame!==B&&B.node.$xid&&B.node.id&&!/^[^:]+-/.test(B.node.id)){if(B._isGroupFirst){var u=xui.UIProfile.getFromDom(B.node.id);if(u){u._elset.forEach(function(C){w(C,u.getKey(C.node.id,true))})}}else{w(B)}}})}}}}}});xui.Class("xui.UI.FusionChartsXT","xui.UI",{Initialize:function(){if(!window.JSON){window.JSON={parse:function(b){return xui.unserialize(b)},stringify:function(b){return xui.stringify(b)}}}},Instance:{initialize:function(){},refreshChart:function(a){return this.each(function(c){if(!c||!c.box){return}c.boxing().busy(false,"");if(c.renderId){var b=function(){var d=c.properties,n;if(c._chartId&&(n=FusionCharts(c._chartId))){n.dispose();c.getSubNode("BOX").html("",false)}var e=new FusionCharts(d.chartType,c._chartId,c.$isEm(d.width)?c.$em2px(d.width):d.width,c.$isEm(d.height)?c.$em2px(d.height):d.height),m;switch(a){case"XMLUrl":var l=xui.getFileSync(d.XMLUrl);if(l){e.setXMLData(l)}break;case"JSONUrl":var o=xui.getFileSync(d.JSONUrl);if(o){e.setJSONData(o)}break;case"XMLData":e.setXMLData(d.XMLData);break;default:if(d.XMLUrl){var l=xui.getFileSync(d.XMLUrl);if(l){e.setXMLData(l)}}else{if(d.JSONUrl){var o=xui.getFileSync(d.JSONUrl);if(o){e.setJSONData(o)}}else{if(d.XMLData){e.setXMLData(d.XMLData)}else{if(!xui.isEmpty(d.JSONData)){m=1;e.setJSONData(c.box._prepareFCData(c,d.JSONData))}}}}}if(!m){e.setJSONData(c.box._prepareFCData(c,e.getJSONData()))}e.setTransparent(true);e.render(c.getSubNode("BOX").id());var n=FusionCharts(c._chartId),j=function(r,u){if(c.onDataClick){var s,q=r.sender.options.dataSource.data;if(q){xui.arr.each(q,function(w){if(w.id=r.data.id){s=w}})}c.boxing().onDataClick(c,u,s)}},g=function(q,r){if(c.onLabelClick){c.boxing().onLabelClick(c,r)}},f=function(q,r){if(c.onAnnotationClick){c.boxing().onAnnotationClick(c,r)}};if(c._f1){n.removeEventListener("dataplotClick",c._f1)}if(c._f2){n.removeEventListener("dataLabelClick",c._f2)}if(c._f3){n.removeEventListener("annotationClick",c._f3)}n.addEventListener("dataplotClick",c._f1=j);n.addEventListener("dataLabelClick",c._f2=j);n.addEventListener("annotationClick",c._f3=j);c.boxing().free()};xui.resetRun("xui.UI.FusionChartsXT:"+c.$xid,b,200)}})},setTransparent:function(a){return this.each(function(c){var b;xui.set(c.properties,["JSONData","chart","bgalpha"],a?"0,0":"");if(c.renderId&&c._chartId&&(b=FusionCharts(c._chartId))){b.setTransparent(a)}})},getChartAttribute:function(a){var b=this.get(0);return xui.isStr(a)?xui.get(b.properties,["JSONData","chart",a]):xui.get(b.properties,["JSONData","chart"])},setChartAttribute:function(a,c){var b={};if(xui.isStr(a)){b[a]=c}else{b=a}return this.each(function(f){var e;if(f.renderId&&f._chartId&&(e=FusionCharts(f._chartId))){e.setChartAttribute(b);xui.set(f.properties,["JSONData","chart"],e.getChartAttribute())}else{var d=xui.get(f.properties,["JSONData","chart"]);if(d){xui.merge(d,b,"all")}}})},getFCObject:function(){var a=this.get(0);return a.renderId&&a._chartId&&FusionCharts(a._chartId)},getSVGString:function(){var a=this.get(0),b=a.renderId&&a._chartId&&FusionCharts(a._chartId);return b?b.getSVGString():null},updateCategories:function(b,a){this.each(function(d){var c=d.properties.JSONData;b=xui.clone(b);c.categories=b});return this.refreshChart()},updateLine:function(b,a){this.each(function(d){var c=d.properties.JSONData;b=xui.clone(b);if(xui.isArr(b)&&xui.isArr(b[0])){c.lineset=b}else{if("lineset" in c){xui.set(c,["lineset",a||0,"data"],b)}}});return this.refreshChart()},updateData:function(b,a){this.each(function(d){var c=d.properties.JSONData;b=xui.clone(b);if(xui.isArr(b)&&xui.isArr(b[0])){if("dataset" in c){c.dataset=b}else{c.data=b[0]}}else{if("dataset" in c){xui.set(c,["dataset",a||0,"data"],b)}else{c.data=b}}});return this.refreshChart()},fillData:function(c,b,a){this.each(function(e){var d=e.properties.JSONData;c=xui.clone(c);if(xui.isArr(c)&&xui.isArr(c[0])){if(a){d.lineset=c}else{if("dataset" in d){d.dataset=c}else{d.data=c[0]}}}else{if(a){if("lineset" in d){xui.set(d,["lineset",b||0,"data"],c)}}else{if("dataset" in d){xui.set(d,["dataset",b||0,"data"],c)}else{d.data=c}}}});return this.refreshChart()},updateData:function(a,b){return this.each(function(c){if(c.renderId&&c._chartId&&(t=FusionCharts(c._chartId))){if(t.setData){t.setData(a,b)}}})},updateDataById:function(a,b){return this.each(function(c){if(c.renderId&&c._chartId&&(t=FusionCharts(c._chartId))){if(t.setDataForId){t.setDataForId(a,b)}}})},callFC:function(b,c){var a;if((a=this.getFCObject())&&xui.isFun(a[b])){return a[b].apply(a,c||[])}},configure:function(a){var c=this.get(0),b;if(c.renderId&&c._chartId&&(b=FusionCharts(c._chartId))){b.configure(a)}},setTheme:function(a){if(typeof a!="string"||!a){a=null}this.each(function(b){if(a!=b.theme){if(a===null){delete b.theme}else{b.theme=a}}});return this.setChartAttribute("theme",a)}},Static:{_objectProp:{JSONData:1,configure:1,plotData:1,feedData:1},Appearances:{KEY:{overflow:"hidden"},BOX:{position:"absolute",left:0,top:0,"z-index":1},COVER:{position:"absolute",left:"-1px",top:"-1px",width:0,height:0,"z-index":4}},Templates:{tagName:"div",className:"{_className}",style:"{_style}",BOX:{tagName:"div"},COVER:{tagName:"div",style:"background-image:url("+xui.ini.img_bg+");"}},Behaviors:{HotKeyAllowed:false},DataModel:{tabindex:null,expression:{ini:"",action:function(){}},defaultFocus:null,disableClickEffect:null,disableHoverEffect:null,disableTips:null,disabled:null,renderer:null,selectable:null,tips:null,width:{$spaceunit:1,ini:"30em"},height:{$spaceunit:1,ini:"25em"},chartCDN:"/plugins/fusioncharts/fusioncharts.js",chartType:{ini:"Column2D",listbox:["Column2D","Column3D","Line","Area2D","Bar2D","Bar3D","Pie2D","Pie3D","Doughnut2D","Doughnut3D","Pareto2D","Pareto3D","MSColumn2D","MSColumn3D","MSLine","MSBar2D","MSBar3D","MSArea","Marimekko","ZoomLine","StackedColumn3D","StackedColumn2D","StackedBar2D","StackedBar3D","StackedArea2D","MSStackedColumn2D","MSCombi3D","MSCombi2D","MSColumnLine3D","StackedColumn2DLine","StackedColumn3DLine","MSCombiDY2D","MSColumn3DLineDY","StackedColumn3DLineDY","MSStackedColumn2DLineDY","Scatter","Bubble","ScrollColumn2D","ScrollLine2D","ScrollArea2D","ScrollStackedColumn2D","ScrollCombi2D","ScrollCombiDY2D","Funnel","RealTimeLine","RealTimeArea","RealTimeColumn","RealTimeLineDY","RealTimeStackedArea","RealTimeStackedColumn","HLinearGauge","Cylinder","HLED","VLED","Thermometer","AngularGauge","Pyramid ","Radar"],action:function(){if(this.renderId){this.boxing().refreshChart()}}},JSONData:{ini:{},get:function(){var b=this,c=b.properties,a;if(!xui.isEmpty(c.JSONData)){return c.JSONData}else{if(a=b.boxing().getFCObject()){return b.box._cleanData(b,a.getJSONData())}}},set:function(b){var a=this,c=a.properties;if(xui.isStr(b)){b=xui.unserialize(b)}if(b){c.XMLData=c.XMLUrl=c.JSONUrl="";c.JSONData=xui.clone(b);if(a.renderId){a.boxing().refreshChart("JSONData")}}}},XMLUrl:{ini:"",set:function(a){var b=this,c=b.properties;c.XMLUrl=a;c.JSONUrl=c.XMLData="";c.JSONData={};if(b.renderId){b.boxing().refreshChart("XMLUrl")}}},XMLData:{ini:"",get:function(c){var b=this,d=b.properties,a;if(d.XMLData){return d.XMLData}else{if(a=b.boxing().getFCObject()){return a.getXMLData()}}},set:function(a){var b=this,c=b.properties;c.XMLData=a;c.XMLUrl=c.JSONUrl="";c.JSONData={};if(b.renderId){b.boxing().refreshChart("XMLData")}}},JSONUrl:{ini:"",set:function(a){var b=this,c=b.properties;c.JSONUrl=a;c.XMLUrl=c.XMLData="";c.JSONData={};if(b.renderId){b.boxing().refreshChart("JSONUrl")}}},plotData:{ini:{},get:function(a){var a=this.properties.JSONData;return a.dataset||a.data||{}},set:function(c){var b=this.properties.JSONData;if(("dataset" in b)||(xui.isArr(c)&&xui.isArr(c[0]))){b.dataset=xui.clone(c)}else{b.data=xui.clone(c)}var a=b.chart.animation;b.chart.animation="0";this.boxing().refreshChart();if(a){b.chart.animation=a}else{delete b.chart.animation}return this}},feedData:{ini:"",set:function(c){var b=this,a;if(b.renderId&&b._chartId&&(a=FusionCharts(b._chartId))&&a.feedData){if(xui.isFinite(c)){c="value="+c}a.feedData(c||"")}}}},_cleanData:function(c,b){var a="Javascript:void(0)";if(b.dataset){xui.arr.each(b.dataset,function(e,d){xui.arr.each(e.dataset,function(f,g){xui.arr.each(f.data,function(j,l){if(j.link==a){delete j.link}})});xui.arr.each(e.data,function(f,g){if(f.link==a){delete f.link}})})}else{if(b.data){xui.arr.each(b.data,function(e,d){if(e.link==a){delete e.link}if(e.labelLink==a){delete e.labelLink}})}}if(b.categories){xui.arr.each(b.categories,function(e,d){xui.arr.each(e.category,function(f,g){if(f.link==a){delete f.link}})})}return b},_prepareFCData:function(b,a){var c=b.$xid;a=xui.clone(a),hoder="Javascript:void(0)";if(a.dataset){xui.arr.each(a.dataset,function(e,d){xui.arr.each(e.dataset,function(f,g){xui.arr.each(f.data,function(j,l){if(!j.link){j.link=hoder}})});xui.arr.each(e.data,function(f,g){if(!f.link){f.link=hoder}})})}else{if(a.data){xui.arr.each(a.data,function(e,d){if(!e.link){e.link=hoder}if(!e.labelLink){e.labelLink=hoder}})}}if(a.categories){xui.arr.each(a.categories,function(e,d){xui.arr.each(e.category,function(f,g){if(!f.link){f.link=hoder}})})}return a},RenderTrigger:function(){var b=this,c=b.properties;var a=function(){if(!b||!b.box){return}b._chartId="FC_"+b.properties.chartType+"_"+b.$xid;if(!xui.isEmpty(b.properties.configure)){b.boxing().setConfigure(b.properties.configure,true)}if(b.theme){b.boxing().setTheme(b.theme)}b.boxing().refreshChart();(b.$beforeDestroy=(b.$beforeDestroy||{}))["unsubscribe"]=function(){var d;if(this._chartId&&(d=FusionCharts(this._chartId))){d.removeEventListener("dataplotClick",b._f1);d.removeEventListener("dataLabelClick",b._f2);d.removeEventListener("annotationClick",b._f3);b._f1=b._f2=b._f3=null;d.dispose()}}};if(window.FusionCharts){a()}else{b.boxing().busy(false,"Loading charts ...");xui.include("FusionCharts",c.chartCDN,function(){if(b&&b.box){b.boxing().free();a()}},null,false,{cache:true})}},EventHandlers:{onFusionChartsEvent:function(c,a,b){},onDataClick:function(a,c,b){},onLabelClick:function(a,b){},onAnnotationClick:function(a,b){},onShowTips:null},_onresize:function(c,b,l){var n=c.getSubNode("BOX").cssSize(),a=c.properties,e=xui.$us(c),g=function(o,q){return c.$forceu(o,e>0?"em":"px",q)},j=c.getRoot(),f=b?c.$px(b):b,d=l?c.$px(l):l,m;if((b&&!xui.compareNumber(n.width,f,6))||(l&&!xui.compareNumber(n.height,d,6))){if(b){a.width=g(f)}if(l){a.height=g(d)}n={width:b?a.width:null,height:l?a.height:null};c.getSubNode("BOX").cssSize(n,true);if(c.$inDesign||a.cover){c.getSubNode("COVER").cssSize(n,true)}if(c.renderId&&c._chartId&&(m=FusionCharts(c._chartId))){m.resizeTo(f||void 0,d||void 0)}}}}});xui.Class("xui.UI.ECharts","xui.UI",{Initialize:function(){var b={};for(var a=0;a<9;a++){b["dataValue"+(a+1)]={ini:"",dynamic:true,get:(function(c){return function(g){var n=this.boxing().getECharts();if(!n){return""}var m=n.getOption();if(!m.series){return"[x]"}var d=[],f;for(var j=0,e=m.series.length;j<e;j++){var o=m.series[j].data;if(o){if(c<o.length){o=o&&o[c];d.push(xui.isSet(o)?xui.isHash(o)?o.value:o:"");f=1}else{d.push("")}}else{return""}}return f?d.join(":"):""}})(a),set:(function(c){return function(u,e){var g=this.boxing().getECharts();if(!g){return}var n=g.getOption(),o;if(!n.series){return}var r=this.properties.optionUpdater,w,q;if(!r.series){r.series=n.series}var m=(u+"").split(":");for(var j=0,f=m.length;j<f;j++){if(j>=r.series.length){r.series[j]={type:r.series[0]&&r.series[0].type||"line",data:[]}}w=r.series[j];if(m[j]!==""){if(!w.data){w.data=[]}q=w.data;u=parseFloat(m[j])||0;if(e||u!==(xui.isHash(q[c])?q[c].value:q[c])){if(xui.isHash(q[c])){q[c].value=u}else{q[c]=u}o=1}}}if(o){this.boxing().setOptionUpdater(r,true)}}})(a)};b["realTimeData"+(a+1)]={ini:"",dynamic:true,get:(function(c){return function(e){var g=this.boxing().getECharts();if(!g){return""}var f=g.getOption();if(!f.series||!f.xAxis){return"[x]"}var d=f.series[c]&&f.series[c].data;var j=d&&d[d.length-1];return xui.isSet(j)?xui.isHash(j)?j.value:j:""}})(a),set:(function(c){return function(q){q=parseFloat(q)||0;var j=this.boxing().getECharts();if(!j){return}var l=j.getOption();if(!l.series||!l.xAxis){return}var o=this.properties.optionUpdater,r,n,e=this.properties.realTimePoints;if(!o.xAxis){o.xAxis=l.xAxis}if(!o.series){o.series=l.series}var g=xui.Date.format(new Date,this.properties.xAxisDateFormatter);if((r=o.xAxis[c])&&(n=r.data)){n.push(g);if(n.length>=e){n.shift()}while(n.length<e){n.unshift(0)}}if(c>=o.series.length){for(var f=o.series.length-1;f<=c;f++){o.series[f]={type:o.series[0]&&o.series[0].type||"line",data:[]}}}r=o.series[c];if(!r.data){r.data=[]}n=r.data;n.push(q);if(n.length>=e){n.shift()}while(n.length<e){n.unshift(0)}this.boxing().setOptionUpdater(o,true)}})(a)}}xui.UI.ECharts.setDataModel(b)},Instance:{_reBindProp:function(e,g,c){var a=e.boxing(),d,f={};if(c=="optionUpdater"&&xui.isHash(g)){for(var b in g){f[b]=xui.isFun(g[b])?g[b](e):xui.adjustVar(g[b])}if(xui.isFun(a[d="set"+xui.str.initial(c)])){a[d](f,true)}return false}},getECharts:function(){return this.get(0)&&this.get(0).$echarts},optionAdapter:function(a){return a},echarts_call:function(b,c){var a=this.getECharts();if(a&&a[b]){return a[b].apply(a,c||[])}},echarts_dispatchAction:function(a){return this.echarts_call("dispatchAction",[a])},echarts_showLoading:function(a,b){return this.echarts_call("showLoading",[a,b])},echarts_hideLoading:function(){return this.echarts_call("hideLoading")},echarts_getOption:function(){return this.echarts_call("getOption",[])},echarts_setOption:function(a){return this.echarts_call("setOption",[a,notMerge,lazyUpdate,silent])},echarts_getDataURL:function(a){return this.echarts_call("getDataURL",[a])},echarts_getConnectedDataURL:function(a){return this.echarts_call("getConnectedDataURL",[a])},echarts_appendData:function(a){return this.echarts_call("appendData",[a])},echarts_clear:function(){return this.echarts_call("clear")},echarts_isDisposed:function(){return !this.get(0)||!this.get(0).$echarts||this.echarts_call("isDisposed")}},Static:{_objectProp:{chartOption:1,optionUpdater:1,dataset:1},Appearances:{KEY:{overflow:"hidden"},BOX:{position:"absolute",left:0,top:0,"z-index":1},COVER:{position:"absolute",left:"-1px",top:"-1px",width:0,height:0,"z-index":4}},Templates:{tagName:"div",className:"{_className}",style:"{_style}",BOX:{tagName:"div"},COVER:{tagName:"div",style:"background-image:url("+xui.ini.img_bg+");"}},Behaviors:{HotKeyAllowed:false},DataModel:{tabindex:null,expression:{ini:"",action:function(){}},defaultFocus:null,disableClickEffect:null,disableHoverEffect:null,disableTips:null,disabled:null,renderer:null,selectable:null,tips:null,autoTips:null,width:{$spaceunit:1,ini:"30em"},height:{$spaceunit:1,ini:"25em"},chartCDN:"/plugins/echarts/echarts.min.js",chartCDNGL:"/plugins/echarts/echarts-gl.min.js",chartTheme:{ini:"",action:function(a){this.boxing().refresh()}},chartRenderer:{ini:"canvas",listbox:["","canvas","svg"],action:function(a){this.boxing().refresh()}},chartDevicePixelRatio:{ini:window.devicePixelRatio,action:function(a){this.boxing().refresh()}},chartResizeSilent:false,chartOption:{ini:{},action:function(q){var d=this,m=d.boxing(),b=d.properties;if(!m.echarts_isDisposed()&&d.$echarts){var j=xui.isFun(q.getOption)?q.getOption():q,r=b.optionUpdater;for(var g in r){xui.set(j,g.split("."),r[g])}if("dataset" in j&&!xui.isEmpty(j.dataset)){var s=j.dataset;var a=(s.dimensions||(s.source&&s.source[0])||[0]).length;if(j.xAxis&&xui.isHash(j.xAxis)){j.xAxis=[j.xAxis]}if(j.yAxis&&xui.isHash(j.yAxis)){j.yAxis=[j.yAxis]}for(var g=0,f=a-1;g<f;g++){var o=j.series[0]&&j.series[0].type||"line";if(!j.series[g]){j.series[g]={type:o}}else{delete j.series[g].data}}if(s=j.xAxis){for(var g=0,f=s.length;g<f;g++){delete s[g].data}}if(s=j.yAxis){for(var g=0,f=s.length;g<f;g++){delete s[g].data}}var c=d.$echarts.getOption();if(c){if(s=c.series){for(var g=0,f=s.length;g<f;g++){delete s[g].data}}if(s=c.xAxis){for(var g=0,f=s.length;g<f;g++){delete s[g].data}}if(s=c.yAxis){for(var g=0,f=s.length;g<f;g++){delete s[g].data}}try{d.$echarts.setOption(c,true,true,true)}catch(n){xui.log(n)}}}if((q=b.tagVar.optionAdapter)&&xui.isFun(q)){j=q.call(m,j,d)}if((q=m.optionAdapter)&&xui.isFun(q)){j=q.call(m,j,d)}if(!(m.beforeSetOption&&false===m.beforeSetOption(d,j))){try{d.$echarts.setOption(j)}catch(n){xui.log(n)}}}}},optionUpdater:{ini:{},action:function(a){var b=this;xui.resetRun("echart-data-setting:"+b.$xid,function(){if(b&&b.box){b.boxing().setChartOption(b.properties.chartOption,true)}})}},dataset:{ini:{},get:function(){var a=this.properties.optionUpdater.dataset;return a||{}},set:function(a,c){var e=this.properties,b=e.xAxisDateFormatter,d=e.optionUpdater;if(a===d.dataset&&!c){return}if(!a||!xui.isHash(a)){delete d.dataset}else{d.dataset=a;if(b){xui.each(d.dataset.source,function(g,f){if(xui.isNumb(g[0])){g[0]=xui.Date.format(g[0],b)}})}}return this.boxing().setOptionUpdater(d,true)}},xAxisDateFormatter:"hh:mm:ss",realTimePoints:5},RenderTrigger:function(){var b=this,d=b.properties;var a=function(){if(!b||!b.box){return}var j={width:b.$px(d.width),height:b.$px(d.height)};if(d.chartRenderer!="canvas"){j.chartRenderer=d.chartRenderer}if(d.chartDevicePixelRatio!=window.devicePixelRatio){j.chartDevicePixelRatio=d.chartDevicePixelRatio}var g=echarts.init(b.getSubNode("BOX").get(0),d.chartTheme,j);b.$echarts=g;b.boxing().setChartOption(d.chartOption,true);var f="click,dblclick,mousedown,mouseup,mouseover,mouseout,globalout,contextmenu".split(",");if(b.onMouseEvent){xui.arr.each(f,function(l){g.on(l,function(m){if(b&&b.onMouseEvent){b.onMouseEvent(b,l,m)}})})}var e="legendselectchanged,legendunselected,legendscroll,datazoom,datarangeselected,timelinechanged,timelineplaychanged,restore,dataviewchanged,magictypechanged,geoselectchanged,geoselected,geounselected,pieselectchanged,pieselected,pieunselected,mapselectchanged,mapselected,mapunselected,axisareaselected,focusnodeadjacency,unfocusnodeadjacency,brush,brushselected,rendered,finished".split(",");if(b.onChartEvent){xui.arr.each(e,function(l){g.on(l,function(m){if(b&&b.onChartEvent){b.onChartEvent(b,l,m)}})})}(b.$beforeDestroy=(b.$beforeDestroy||{}))["destroyechart"]=function(){var l=this.$echarts;if(l){xui.arr.each(f,function(m){l.off(m)});xui.arr.each(e,function(m){l.off(m)});l.dispose();delete this.$echarts}}};if(window.echarts){a()}else{b.boxing().busy(false,"Loading charts ...");var c=d.chartCDNGL;xui.include("echarts",d.chartCDN,function(){if(c){xui.include("",c,function(){if(b&&b.box){b.boxing().free();a()}},null,false,{cache:true})}},null,false,{cache:true})}},EventHandlers:{onMouseEvent:function(b,a,c){},onChartEvent:function(b,a,c){},beforeSetOption:function(b,a){},onShowTips:null},_beforeSerialized:function(b){var c=xui.UI._beforeSerialized.call(this,b),d=c.properties;for(var a=0;a<9;a++){delete d["realTimeData"+(a+1)];delete d["dataValue"+(a+1)]}delete d.optionUpdater;return c},_onresize:function(c,b,l){var n=c.getSubNode("BOX").cssSize(),a=c.properties,e=xui.$us(c),g=function(o,q){return c.$forceu(o,e>0?"em":"px",q)},j=c.getRoot(),f=b?c.$px(b):b,d=l?c.$px(l):l,m;if((b&&!xui.compareNumber(n.width,f,6))||(l&&!xui.compareNumber(n.height,d,6))){if(b){a.width=g(f)}if(l){a.height=g(d)}n={width:b?a.width:null,height:l?a.height:null};c.getSubNode("BOX").cssSize(n,true);if(c.$inDesign||a.cover){c.getSubNode("COVER").cssSize(n,true)}if(c.renderId&&(m=c.$echarts)){m.resize({width:f,height:d,silent:a.chartResizeSilent})}}}}});xui.Class("xui.UI.FormLayout",["xui.UI","xui.absList"],{Initialize:function(){this.addTemplateKeys(["ITEM","TABLE","CBORDER","CBT","CBL","HOLDER","SPREADER"])},Instance:{_isDesignMode:function(){return this.getMode()=="design"},getContainer:function(a){var b=this.get(0);if(b.ItemIdMapSubSerialId&&b.ItemIdMapSubSerialId[a]){return arguments.callee.upper.apply(this,[a])}else{return this.getSubNode("POOL")}},},Static:{HasHtmlTableNode:1,_CONTAINERKEY:"ITEM",_ITEMCONTAINER:1,_ACTIVEHANDLER:["KEY","HOLDER"],_NoProp:{conLayoutColumns:1},_objectProp:{layoutData:1},Appearances:{KEY:{overflow:"hidden"},BOX:{position:"absolute",left:0,top:0,"z-index":1},CBORDER:{position:"absolute",left:0,top:0},"CBORDER div":{position:"absolute",display:"block"},POOL:{position:"absolute",left:"-100%",top:"-100%",width:0,height:0},HOLDER:{overflow:"auto",position:"relative"},TABLE:{overflow:"hidden","border-collapse":"separate","border-spacing":"0",margin:"0","border-width":"0","table-layout":"fixed",width:"0","outline-width":"0",cursor:"default","max-width":"none","max-height":"none"},"ITEM:empty:after":{"text-align":"center",color:"#ccc",content:"attr(data-coord)",position:"absolute",top:"0",bottom:"0",left:"0",right:"0",margin:"auto",height:"1.5em","-moz-user-select":xui.browser.gek?"-moz-none":null,"-khtml-user-select":xui.browser.kde?"none":null,"-webkit-user-select":xui.browser.kde?"none":null,"-o-user-select":xui.browser.opr?"none":null,"-ms-user-select":(xui.browser.ie||xui.browser.newie)?"none":null,"user-select":"none","touch-action":"none"},"ITEM.layoutcell":{"border-right":"1px solid transparent","border-bottom":"1px solid transparent","border-left":"none","border-top":"none",$order:1},"ITEM.layoutcell.firstrow":{"border-top":"1px solid transparent",$order:2},"ITEM.layoutcell.firstcol":{"border-left":"1px solid transparent",$order:2},"BOX.solidgridline ITEM.layoutcell":{"border-right":"1px solid #444","border-bottom":"1px solid #444","border-left":"none","border-top":"none",$order:3},"BOX.solidgridline ITEM.layoutcell.firstrow":{"border-top":"1px solid #444",$order:4},"BOX.solidgridline ITEM.layoutcell.firstcol":{"border-left":"1px solid #444",$order:4},"KEY ITEM":{position:"relative",background:"transparent",height:"22px",padding:"0 4px",overflow:"hidden","outline-width":"0","white-space":"pre-line","empty-cells":"show","line-height":"1.22","text-align":"left","vertical-align":"middle","background-clip":"padding-box"},"KEY .handsontableInput":{"line-height":"1.22"},"KEY .handsontable tr":{background:"transparent"},"BOX.handsontable tr:first-child td, BOX.handsontable tr:first-child th":{"border-top":"none"},"BOX.handsontable tr:first-child > td, BOX.handsontable tr:first-child > th":{"border-top":"1px solid #ccc"},".handsontable.solidgridline td":{"border-right":"1px solid #444","border-bottom":"1px solid #444"},".handsontable.solidgridline tr:first-child > td":{"border-top":"1px solid #444"},".handsontable.solidgridline th:nth-child(2), .handsontable.solidgridline td:first-of-type, .handsontable.solidgridline .htNoFrame + th, .handsontable.solidgridline .htNoFrame + td":{"border-left":"1px solid #444"},".handsontable.nogridline td":{"border-right":"1px solid transparent","border-bottom":"1px solid transparent"},".handsontable.nogridline tr:first-child > td":{"border-top":"1px solid transparent"},".handsontable.nogridline th:nth-child(2), .handsontable.nogridline td:first-of-type, .handsontable.nogridline .htNoFrame + th, .handsontable.nogridline .htNoFrame + td":{"border-left":"1px solid transparent"}},Templates:{tagName:"div",className:"{_className}",style:"{_style}",BOX:{tagName:"div"},POOL:{tagName:"div"}},Behaviors:{DroppableKeys:["ITEM"],PanelKeys:["ITEM"],HotKeyAllowed:false,ITEM:{}},DataModel:{expression:{ini:"",action:function(){}},tabindex:null,defaultFocus:null,disableClickEffect:null,disableHoverEffect:null,disableTips:null,disabled:null,renderer:null,selectable:null,tips:null,autoTips:null,overflow:null,items:{hidden:true},listKey:null,dragSortable:null,mode:{ini:"write",listbox:["design","write","read"],get:function(){return this.$inDesign?"design":(this.properties.mode||"read")},action:function(){this.boxing().refresh()}},lineSpacing:{ini:0,action:function(a){this.boxing().refresh()}},width:{$spaceunit:1,ini:"30em"},height:{$spaceunit:1,ini:"25em"},solidGridlines:{ini:true,action:function(c){var a=c?"solidgridline":this.boxing()._isDesignMode()?"":"nogridline",b=this.getSubNode("BOX");b.removeClass("solidgridline nogridline");if(a){b.addClass(a)}}},stretchHeight:{ini:"none",listbox:["none","last","all"],action:function(){if(this.boxing()._isDesignMode()){this.box._updateSetting(this,"stretchHeight");var a=this.getRoot().cssSize();this.box._resizeTable(this,this.getSubNode("BOX").cssSize(),false,true)}else{this.box._resizeTable(this,this.getSubNode("BOX").cssSize(),false,true)}}},stretchH:{ini:"all",listbox:["all","none","last"],action:function(){if(this.boxing()._isDesignMode()){this.box._updateSetting(this,"stretchH");this.box._resizeTable(this,this.getSubNode("BOX").cssSize(),false,true)}else{this.box._resizeTable(this,this.getSubNode("BOX").cssSize(),false,true)}}},rowHeaderWidth:{ini:25,action:function(){if(this.boxing()._isDesignMode()){this.box._updateSetting(this,"rowHeaderWidth");var a=this.getRoot().cssSize();xui.UI.$tryResize(this,a.width,a.height)}}},columnHeaderHeight:{ini:25,action:function(){if(this.boxing()._isDesignMode()){this.box._updateSetting(this,"columnHeaderHeight");var a=this.getRoot().cssSize();xui.UI.$tryResize(this,a.width,a.height)}}},floatHandler:{ini:true,action:function(){if(this.boxing()._isDesignMode()){var a=this.getRoot().cssSize();xui.UI.$tryResize(this,a.width,a.height,true)}}},defaultRowSize:5,defaultColumnSize:5,defaultRowHeight:50,defaultColWidth:120,layoutData:{ini:{},action:function(){this.boxing().refresh()}},rendererCDNJS:"/plugins/formlayout/handsontable.full.min.js",rendererCDNCSS:"/plugins/formlayout/handsontable.full.min.css"},RenderTrigger:function(){var b=this,d=b.properties,a=b.box;if(b.boxing()._isDesignMode()){if(window.Handsontable){a._renderAsHandsontable(b)}else{var c="xui.UI.HTable:Handsontable";xui.CSS.includeLink(d.rendererCDNCSS,c);xui.include("Handsontable",d.rendererCDNJS,function(){if(xui(c).get(0)){a._renderAsHandsontable(b);var e=b.getRoot().cssSize();xui.UI.$tryResize(b,e.width,e.height)}else{xui.Thread.repeat(function(){if(xui(c).get(0)){a._renderAsHandsontable(b);var f=b.getRoot().cssSize();xui.UI.$tryResize(b,f.width,f.height);return false}},200)}},null,false,{cache:true})}}else{a._renderAsH5Table(b)}b.$handleCustomVars=function(e){if(!e){xui.arr.each(b.children,function(f){delete f[0]._attached2cell;delete f[0]._autoexpand})}};b.boxing().setSolidGridlines(d.solidGridlines,true)},EventHandlers:{onShowTips:null,onGetCellData:function(c,a,b){}},_getHeaderOffset:function(a){var c=a.properties,b={left:0,top:0};if(c.floatHandler&&a.boxing()._isDesignMode()){b.left=c.rowHeaderWidth;b.top=c.columnHeaderHeight+1}return b},_layoutChanged:function(b,a){if(a||b._$tableInited){xui.resetRun(b.getUid("layoutchanged"),function(){if(b.properties){var c=b.properties.layoutData;b.properties.layoutData=b.box._getLayoutData(b);if(b.$onLayoutChanged){b.$onLayoutChanged(b,c,b.properties.layoutData)}}})}},_getLayoutData:function(A){var c=A.properties,e={},f,b={},a={},J=[],F={},L,o,r,u,B,x,K;if(u=A.$htable){F.rows=u.countRows();F.cols=u.countCols();J=xui.copy(xui.get(u.getPlugin("mergeCells"),["mergedCellsCollection","mergedCells"]));if(!xui.isEmpty(J)){F.merged=J}x=u.getSettings();B=u.getPlugin("ManualRowResize");for(var H=0,E=F.rows,I;H<E;H++){var j=u.toPhysicalRow(H);if(B.manualRowHeights&&B.manualRowHeights[j]){xui.set(b,[H+1,"manualHeight"],B.manualRowHeights[j])}if(K=xui.isArr(x.rowHeights)?x.rowHeights[j]:x.rowHeights){xui.set(b,[H+1,"height"],K)}}if(!xui.isEmpty(b)){F.rowSetting=b}B=u.getPlugin("ManualColumnResize");for(var H=0,E=F.cols,q;H<E;H++){var g=u.toPhysicalColumn(H);if(B.manualColumnWidths&&B.manualColumnWidths[g]){xui.set(a,[xui.ExcelFormula.toColumnChr(H+1),"manualWidth"],B.manualColumnWidths[g])}}if(!xui.isEmpty(a)){F.colSetting=a}L=u.getData();for(var H=0,E=L.length;H<E;H++){var j=L[H];for(var D=0,C=j.length;D<C;D++){if(xui.isSet(L[H][D])&&L[H][D]!==""){xui.set(e,[xui.ExcelFormula.toCellId(D,H),"value"],L[H][D])}}}for(var H=0,E=F.rows;H<E;H++){var j=u.toPhysicalRow(H);var d=u.getCellMetaAtRow(j);if(d&&d.length){for(var D=0,C=d.length;D<C;D++){var g=u.toPhysicalColumn(D);if(!xui.isEmpty(d[g].style)){xui.set(e,[xui.ExcelFormula.toCellId(D,H),"style"],xui.copy(d[g].style))}}}}if(!xui.isEmpty(e)){F.cells=e}var G=u.getPlugin("customBorders");if((f=G.getBorders()).length){F.customBorders=xui.clone(f,function(m,l){return l!="id"&&l!="border"})}}return F},_renderAsH5Table:function(u){var C=u.getSubNode("BOX"),E=C.get(0),c=u.properties,D=c.layoutData,a=D.rows||c.defaultRowSize,d=D.cols||c.defaultColumnSize,s={},r,G={},j={},o=function(n,L){var J=u.onGetCellData&&u.boxing().onGetCellData(u,L,xui.get(D,["cells",L]),n[L]);if(!xui.isSet(J)){if(!n[L]){J=xui.get(D,["cells",L,"value"])}else{var K=n[L],l=K&&K.boxing();if(K.key=="xui.UI.RichEditor"||K.key=="xui.UI.Image"){J=""}else{if(K.key=="xui.UI.CheckBox"||K.key=="xui.UI.SCheckBox"){J='<input type="checkbox" disabled tabindex="-1"  onclick="javascript:return false;"'+(l.getUIValue()?"checked":"")+">"}else{J=l.getShowValue?l.getShowValue():l.getValue?("$UIvalue" in K.properties?l.getUIValue():l.getValue()):l.getCaption?l.getCaption():l.getHtml?l.getHtml():l.getLabel?l.getLabel():""}}}}return xui.isSet(J)?J:""},A,w,F,q,f,m,I=[];xui.arr.each(u.children,function(l){s[l[1]]=l[0]});xui.arr.each(D.merged,function(K){G[K.row+":"+K.col]=(K.rowspan>1?(" rowspan="+K.rowspan):"")+(K.colspan?(" colspan = "+K.colspan):"")+" ";for(var M=0,n=K.rowspan;M<n;M++){for(var L=0,J=K.colspan;L<J;L++){if(M===0&&L===0){continue}j[(K.row+M)+":"+(K.col+L)]=1}}});I.push("<div id='"+u.key+"-HOLDER:"+u.serialId+":' class='"+u.getClass("HOLDER")+"' style='width:"+c.width+"; height:"+c.height+"' >");I.push("<table id='"+u.key+"-TABLE:"+u.serialId+":' class='"+u.getClass("TABLE")+"'"+(c.stretchH!="none"?(" style='width:"+c.width+";'"):"")+">");var H=u.box._getColWidths(u,u.$px(c.width));I.push("<colgroup><col style='width:0;border:0;margin:0;padding:0;'></col>");for(var e=0,x=d;e<x;e++){I.push("<col rowid="+g+" style='width:"+H[e]+";'></col>")}I.push("</colgroup>");I.push("<tbody>");for(var g=0,B=a;g<B;g++){I.push("<tr rowid="+g+"><th style='width:0;border:0;margin:0;padding:0;");if(r=xui.get(D,["rowSetting",g+1,"height"])||xui.get(D,["rowSetting",g+1,"manualHeight"])||c.defaultRowHeight){I.push("height:"+(r-(g===0?1:1))+"px;")}I.push("'></th>");for(var e=0,x=d;e<x;e++){w=u.pickSubId("items");q=xui.ExcelFormula.toCellId(e,g);F={_serialId:w,col:e,row:g,id:q,value:o(s,q),style:xui.get(D,["cells",q,"style"])||{}};u.ItemIdMapSubSerialId[q]=w;u.SubSerialIdMapItem[w]=F;f=u.key+"-ITEM:"+u.serialId+":"+w;m=[];xui.each(F.style,function(n,l){m.push(l.replace(/[A-Z]/g,function(J){return"-"+J.toLowerCase()})+":"+n)});if(!j[g+":"+e]){I.push("<td rowid="+g+" id='"+f+"' class='layoutcell "+(g===0?"firstrow ":"")+(e===0?"firstcol ":"")+u.getClass("ITEM")+"' style='"+m.join(";")+"' "+(G[g+":"+e]||"")+">");I.push(F.value);I.push("</td>")}}I.push("</tr>")}I.push("</tbody></table>");I.push("<div id='"+u.key+"-CBORDER:"+u.serialId+":' class='"+u.getClass("CBORDER")+"' ></div>");I.push("</div>");E.innerHTML=I.join("");xui.UI.$addEventsHandler(u,E,false);u.box._setCustomBorders(u);var b=[];xui.each(u.children,function(l){b.push(l)});u.children=[];xui.arr.each(b,function(l){u.boxing().append(l[0],l[1])})},_renderAsHandsontable:function(o){if(!o||!o.box){return}var G=function(m,l){m.box._layoutChanged(m,l)};var w=o.getSubNode("BOX"),C=w.get(0),j,b=o.properties,x=b.layoutData,f=true,F={autoWrapRow:true,renderAllRows:true,persistentState:false,readOnly:!f,readOnlyCellClassName:"no",comments:!f,disableVisualSelection:!f,enterBeginsEditing:f,manualRowMove:f,manualColumnMove:f,contextMenu:f,copyable:f,copyPaste:f,beforeOnCellMouseDown:!f?null:function(l,m){if(m.row===-1&&m.col===-1){l.stopImmediatePropagation()}},afterOnCellMouseUp:!f?null:function(l,m){if(m.row===-1&&m.col===-1){this.deselectCell();o.getRoot().onClick(true);l.stopImmediatePropagation()}},beforeRenderer:function(L,M,l,K,J,I){var n=o.pickSubId("items"),H=xui.ExcelFormula.toCellId(l,M);I.oid=I.id;I.id=H;if(I.oid&&I.oid!=I.id){o.$cellIdChangedMap[I.oid]=I.id}I._serialId=n;o.ItemIdMapSubSerialId[H]=n;o.SubSerialIdMapItem[n]=I;if(!I.style){I.style=xui.get(b.layoutData,["cells",xui.ExcelFormula.toCellId(l,M),"style"])||{}}L.id=o.key+"-ITEM:"+o.serialId+":"+n;xui.UI.$addEventsHandler(o,L,true);for(var m in I.style){L.style[m]=I.style[m]}L.className=(L.className||"")+o.getClass("ITEM");if(f){L.setAttribute("data-coord",H)}if(I._child_autoexpandH){L.style.height=I._child_autoexpandH+"px"}else{L.style.height=""}},beforeRender:function(m){if(o._$tableInited){o.$cellIdChangedMap={};var H=o.getSubNode("POOL").get(0),l=[];xui.arr.each(o.children,function(I){if(I[0]&&I[0].rendered){H.appendChild(I[0].getRootNode());l.push(I)}});if(l.length){o._pool_children=l}o.children=[];for(var n in o.SubSerialIdMapItem){o.reclaimSubId(n,"items")}o.ItemIdMapSubSerialId={};o.SubSerialIdMapItem={}}},afterInit:function(){o._$tableInited=1},afterRender:function(m){xui.tryF(o.$onrender,[],o);var n=o.getSubNode("BOX");n=n.first();n.id(o.key+"-MASTER:"+o.serialId+":");n=n.first();n.id(o.key+"-HOLDER:"+o.serialId+":");n=n.first();n.id(o.key+"-HIDER:"+o.serialId+":");n=n.first();n.id(o.key+"-SPREADER:"+o.serialId+":");if(o._$tableInited){var H=o.$cellIdChangedMap;if(o._pool_children){xui.arr.each(o._pool_children,function(I){delete I[0].$dockParent;if(I[0].$domId){o.boxing().append(I[0],H[I[1]]||I[1])}});delete o._pool_children}}else{var l=[];xui.each(o.children,function(I){if(I[0].$domId){l.push(I)}});o.children=[];xui.arr.each(l,function(I){if(I[0].$xid){o.boxing().append(I[0],I[1])}});o.getRoot().onMouseup(function(J,I){o.$lastMousePos=xui.Event.getPos(I)})}},afterSelection:function(){if(b.floatHandler){o.getRoot().css("overflow","visible")}},outsideClickDeselects:function(m){while(((!m.id)||m.id==xui.$localeDomId||m.tagName=="tspan")&&m.parentNode!==document&&m.parentNode!==window){m=m.parentNode}var n=xui.UIProfile.getFromDom(m);if(n&&o.$popmenu){var l=o.$popmenu.get(0);if(n==l||n.$parentPopMenu==l||n.$popGrp==l.$popGrp){return false}}o.getRoot().css("overflow","");return true},afterContextMenuShow:!f?null:function(l){if(o.$onPopMenu){o.$popmenu=o.$onPopMenu(o,o.$popmenu,l.menu)}l.menu.container.style.display="none"},afterUpdateSettings:function(){G(o)},afterRedo:function(){G(o)},afterUndo:function(){G(o)},afterChange:function(m,l){if(l!="loadData"&&l!="populateFromArray"){G(o)}},beforeCellAlignment:function(){G(o)},afterMergeCells:function(m,l,n){if(!n){G(o)}},afterUnmergeCells:function(m,l,n){if(!n){G(o)}},afterRowResize:function(L,I,K){G(o);var n=this.getCellMetaAtRow(L);for(var H=0,m=n.length;H<m;H++){var J=o.boxing().getChildren(n[H].id);if(J["xui.UI.Input"]&&J.getMultiLines&&J.getMultiLines()&&J.setAutoexpand){J.get(0)._autoexpand=(I-1)+"px"}}},afterColumnResize:function(){G(o)},afterColumnSort:function(){G(o)},afterRowMove:function(l,m){G(o)},afterColumnMove:function(){G(o)},afterCreateCol:function(m,H){G(o);var J=this.getPlugin("ManualColumnResize");var l=[];for(var n=0;n<H;n++){l.push(b.defaultColWidth)}if(!J.manualColumnWidths){J.manualColumnWidths=[]}for(var n=0;n<m;n++){J.manualColumnWidths[n]=J.manualColumnWidths[n]||(void 0)}J.manualColumnWidths.splice.apply(J.manualColumnWidths,[m,0].concat(l));this.deselectCell();var I=this;xui.asyRun(function(){I.selectColumns(m)})},afterCreateRow:function(m,H){G(o);var J=this.getPlugin("ManualRowResize");var l=[];for(var n=0;n<H;n++){l.push(b.defaultRowHeight)}if(!J.manualRowHeights){J.manualRowHeights=[]}for(var n=0;n<m;n++){J.manualRowHeights[n]=J.manualRowHeights[n]||(void 0)}J.manualRowHeights.splice.apply(J.manualRowHeights,[m,0].concat(l));this.deselectCell();var I=this;xui.asyRun(function(){I.selectRows(m)})},afterRemoveCol:function(l,m){G(o);var n=this.getPlugin("ManualColumnResize");if(n.manualColumnWidths){n.manualColumnWidths.splice(l,m)}this.deselectCell()},afterRemoveRow:function(l,m){G(o);var n=this.getPlugin("ManualRowResize");if(n.manualRowHeights){n.manualRowHeights.splice(l,m)}this.deselectCell()}},B={},g;var d=o.box._getHeaderOffset(o);B.height=o.$px(b.height)+d.top;B.width=o.$px(b.width)+d.left;B.stretchHeight=(g=b.stretchHeight)=="last"?"last":g=="all"?"all":"none";B.stretchH=(g=b.stretchH)=="last"?"last":g=="all"?"all":"none";B.rowHeaderWidth=b.rowHeaderWidth;B.columnHeaderHeight=b.columnHeaderHeight;B.defaultColumnWidth=b.defaultColWidth;B.rowHeaders=f;B.colHeaders=f;if(x.merged){B.mergeCells=x.merged}else{B.mergeCells=f}if(x.cols){var c=[],D=[],a=[],q=[],E=[],e;xui.each(x.rowSetting,function(m,l){if(xui.isSet(m.manualHeight||m)){a[parseInt(l,10)-1]=parseInt(m.manualHeight||m,10)}if(xui.isSet(m.height||m)){c[parseInt(l,10)-1]=parseInt(m.height||m,10)}});xui.each(x.colSetting,function(m,l){l=xui.ExcelFormula.toColumnNum(l);if(xui.isSet(m.manualWidth||m)){q[l-1]=parseInt(m.manualWidth||m,10)}});for(var A=0,u=x.rows||b.defaultRowSize;A<u;A++){E.push(e=[]);for(var s=0,r=x.cols||b.defaultColumnSize;s<r;s++){e.push(null)}}xui.each(x.cells,function(l,n){var m=xui.ExcelFormula.toCoordinate(n);E[m.row][m.col]=xui.isSet(l.value)?l.value:null});for(var A=0;A<x.rows;A++){a[A]=a[A]||b.defaultRowHeight}B.manualRowResize=a;B.manualColumnResize=!xui.isEmpty(q)?q:f;if(!xui.isEmpty(c)){B.rowHeights=c}B.data=E;if(x.customBorders){B.customBorders=x.customBorders}}else{B.manualColumnResize=f;var a=[];for(var A=0;A<b.defaultRowSize;A++){a[A]=b.defaultRowHeight}B.manualRowResize=a}o.$htable=j=new Handsontable(C,xui.merge(B,F,"all"));if(!x.cols){o.properties.layoutData=o.box._getLayoutData(o)}(o.$beforeDestroy=(o.$beforeDestroy||{}))["destroyhtable"]=function(){var l;if(l=this.$htable){var m=this.getSubNode("BOX").get(0);if(m){xui.$purgeChildren(m)}if(!l.isDestroyed){Handsontable.hooks.destroy(l);l.destroy()}delete this.$htable}if(l=this.$popmenu){l.destroy()}}},_getRowHeights:function(q,E,A){var c=q.properties,w=c.layoutData,m,a=w.rows||c.defaultRowSize,x=[],j=[],B=[],r=0,f=0,C,D,u=0,l=0,g=c.stretchHeight||"all",b=c.defaultRowHeight;for(var e=0,s=a;e<s;e++){if(m=xui.get(w,["rowSetting",e+1,"manualHeight"])){if(e<a-1){r+=parseInt(m)}}}b=E-r;if(g=="all"){for(var e=0,s=a;e<s;e++){if(m=xui.get(w,["rowSetting",e+1,"manualHeight"])){r+=parseInt(m);j.push(m)}else{f++;j.push(null)}}C=(E-r)/f;D=C-Math.round(C)}for(var e=0,s=a;e<s;e++){var d,o=!A?"px":"";u++;m=xui.get(w,["rowSetting",e+1,"manualHeight"])||(c.defaultRowHeight);switch(g){case"all":d=j[e]===null?Math.max(c.defaultRowHeight,(Math.round(C))):j[e];l+=d;B.push((e==a-1?Math.round(E-l+d):d)+o);break;case"last":B.push(e==a-1?b+o:(m+o));break;default:B.push(m+o)}}return B},_getColWidths:function(o,x){var b=o.properties,w=b.layoutData,m,d=w.cols||b.defaultColumnSize,e=b.stretchH||"all",j=[],B=[],q=0,g=0,A,C,s=0,l=0;if(d.length<3){return d}if(e=="all"){for(var f=0,r=d;f<r;f++){var u=xui.ExcelFormula.toColumnChr(f+1);if(m=xui.get(w,["colSetting",u,"manualWidth"])){q+=parseInt(m);j.push(m)}else{g++;j.push(null)}}A=(x-q)/g;C=A-Math.round(A)}var a=0;for(var f=0,r=d;f<r;f++){var u=xui.ExcelFormula.toColumnChr(f+1),c;s++;m=xui.get(w,["colSetting",u,"manualWidth"])||(b.defaultColWidth);width=m=parseInt(m);switch(e){case"all":c=j[f]===null?Math.max(b.defaultColWidth,(Math.round(A))):j[f];if(xui.isNumb(c)){l+=c}else{l+=parseInt(c)}width=(f==d-1?Math.round(x-l+c):c);break;case"last":width=f==d-1?x-a-5:m;break;default:width=m}a=a+width;B.push(width)}return B},_setCustomBorders:function(a){xui.resetRun(a.getUid()+":cborder",function(){if(!a.renderId){return}var b=a.getSubNode("CBORDER").get(0);xui.arr.each(a.properties.layoutData.customBorders,function(g){var m=xui.ExcelFormula.toCellId(g.col,g.row),j=a.ItemIdMapSubSerialId[m],n=a.getSubNode("TABLE").get(0),f=a.getSubNode("ITEM",j),l=f.offset(null,n),e,d,c;if(g.top&&g.top.width){e=a.key+"-CBT:"+a.serialId+":"+j;d=xui.Dom.byId(e);c=d&&d.style;if(!d){d=document.createElement("div");d.id=e;b.appendChild(d)}c=d.style;c.backgroundColor=g.top.color;c.left=(l.left-1)+"px";c.top=(l.top-1)+"px";c.width=f.offsetWidth()+"px";c.height="1px"}if(g.left&&g.left.width){e=a.key+"-CBL:"+a.serialId+":"+j;d=xui.Dom.byId(e);if(!d){d=document.createElement("div");d.id=e;b.appendChild(d)}c=d.style;c.backgroundColor=g.left.color;c.left=(l.left-1)+"px";c.top=(l.top-1)+"px";c.width="1px";c.height=f.offsetHeight()+"px"}})})},_resizeTable:function(d,s,b,a){if(d.boxing()._isDesignMode()){var r;if(r=d.$htable){try{var f=d.getSubNode("HOLDER").cssSize();if(!b&&(s.width!=f.width||s.height!=f.height)||a){d.getSubNode("HOLDER").cssSize(s);s.manualRowResize=this._getRowHeights(d,s.height,true);s.manualColumnResize=this._getColWidths(d,s.width);s.mergeCells=xui.copy(xui.get(r.getPlugin("mergeCells"),["mergedCellsCollection","mergedCells"]));r.updateSettings(s)}}catch(j){}}}else{d.getSubNode("HOLDER").cssSize(s);var g=d.getSubNode("TABLE");var m=d.getSubNode("TR");if(g.get(0)){if(d.properties.stretchH&&d.properties.stretchH!="none"){var c=s.width-(g.offsetHeight()>s.height?xui.Dom.getScrollBarSize():0);g.width(c)}var q=this._getColWidths(d,c);g.first().children().each(function(w,e){if(e!==0){var u=q[e-1];if(!xui.str.endWith(u+"","px")){u=u+"px"}w.style.width=u}});var o=[],l=this._getRowHeights(d,s.height);if(d.properties.stretchHeight!="none"){var n=s.height-(g.offsetHeight()>s.height?xui.Dom.getScrollBarSize():0);g.height(n);d.getSubNodes("ITEM",true).each(function(u){if(u.parentNode.attributes.rowid){var x=parseInt(u.attributes.rowid.value);var e=l[x];var w=u.parentNode.children[0];w.style.height=e}})}d.getSubNodes("ITEM",true).each(function(e){if(xui.Dom.$hasEventHandler(e,"onsize")){o.push(e)}});if(o.length){xui(o).onSize(true)}d.box._setCustomBorders(d)}}},_updateSetting:function(d,b){var a=d.$htable;if(typeof b=="string"){var c={};c[b]=d.properties[b];b=c}b.mergeCells=xui.copy(xui.get(a.getPlugin("mergeCells"),["mergedCellsCollection","mergedCells"]));if((!b.stretchHeight&&!b.stretchH)||(b.stretchHeight=="none"||b.stretchH=="none")){a.updateSettings(b)}},$beforeAppend:function(b,c,a){if(!a){return false}},$afterAppend:function(c,g,a){if(!a){return}var f=c.properties.lineSpacing|0;if(c.renderId&&g["xui.UI"]&&g.size()==1){var m=c.getItemByItemId(a),b=g.get(0),d=b.properties;if(m){var l=c.getSubNode("ITEM",m._serialId),o=b.box._isFormField?b.box._isFormField(b):!!xui.get(b,["properties","isFormField"]),e=c.boxing().getMode(),j=e!="read"||g["xui.UI.RichEditor"]||g["RAD.expression.JavaEditor"];if(o&&(!d.name||c.ItemIdMapSubSerialId[d.name])){d.name=m.id}if(l&&l.get(0)){if(b._cellresizeP!=l){var n=function(){if(!l.get(0)){return}if(g["xui.UI.Image"]||g["xui.UI.ProgressBar"]||g["xui.UI.Button"]){return}g.setPosition("absolute").setLeft(0).setTop(f/2).setBottom(f/2);var q=l.offsetHeight(),r=l.offsetWidth();if(g.setWidth){g.setWidth(r-(m.col?1:2))}if(g.setHeight){g.setHeight(q-(m.row?1:2)-f)}};n();l.onSize(n,"cellresize");b._cellresizeP=l}}if(!b._attached2cell){b._attached2cell=1;if(o){if(j){b.locked=1;b.boxing().setDisplay("");if(g.setLabelPos){g.setLabelPos("none").setLabelSize("0")}if(g.setVAlign){g.setVAlign("middle")}if(g["xui.UI.Input"]&&g.getMultiLines&&g.getMultiLines()&&g.setAutoexpand){if(!parseFloat(b._autoexpand)){b._autoexpand=(l.offsetHeight()-1)+"px";b.getSubNode("INPUT").addClass("autoexpand");b.$beforeAutoexpand=function(r,q){q=g.getAutoexpandHeight();m._child_autoexpandH=q;if(c.boxing()._isDesignMode()){xui.resetRun(c.getUid("autoex"),function(){if(c.$htable){c.$htable.render()}})}else{l.height(q)}if(!c.boxing()._isDesignMode()){c.box._setCustomBorders(c)}return false};b.box._checkAutoexpand(b)}}if(e=="read"){if(g.setReadonly){g.setReadonly(true,true)}}}else{b.boxing().setDisplay("none")}}b.$handleCustomVars=function(r){if(r){for(var q in r){if(r[q]){this[q]=r[q]}}}else{return{_attached2cell:this._attached2cell,_autoexpand:this._autoexpand,$beforeAutoexpand:this.$beforeAutoexpand}}}}}}},_IllegalDetect:function(e,c,d){return null;var b=0,a=function(f){xui.arr.each(f,function(g){g=g[0]||g;if(g.box&&g.box.HasHtmlTableNode){b++}else{a(g.children)}})};a(c._nodes);if(b){if(d){throw new Error("Cant append control with HTML TABLE node into "+e.key)}else{return b}}},_onresize:function(c,b,n){var a=c.properties,e=xui.$us(c),j=function(q,r){return c.$forceu(q,e>0?"em":"px",r)},m=c.getRoot(),l=c.getSubNode("BOX"),f=c.box._getHeaderOffset(c),g=b?c.$px(b):b,d=n?c.$px(n):n,o;if(b||n){if(b){a.width=j(g)}if(n){a.height=j(d)}l.css({marginLeft:-f.left+"px",marginTop:-f.top+"px",width:b?(g+f.left+"px"):null,height:n?(d+f.top+"px"):null});xui.resetRun(c.getUid("resize"),function(){if(c&&c.box){c.box._resizeTable(c,c.getSubNode("BOX").cssSize(),false)}})}}}});xui.Class("xui.UI.MFormLayout",["xui.UI","xui.absList"],{Initialize:function(){this.addTemplateKeys(["ITEM","TABLE","CBORDER","CBT","CBL","HOLDER","SPREADER"])},Instance:{_isDesignMode:function(){return this.getMode()=="design"},getContainer:function(a){var b=this.get(0);if(b.ItemIdMapSubSerialId&&b.ItemIdMapSubSerialId[a]){return arguments.callee.upper.apply(this,[a])}else{return this.getSubNode("POOL")}},},Static:{HasHtmlTableNode:1,_CONTAINERKEY:"ITEM",_ITEMCONTAINER:1,_ACTIVEHANDLER:["KEY","HOLDER"],_NoProp:{conLayoutColumns:1},_objectProp:{layoutData:1},Appearances:{KEY:{overflow:"hidden"},BOX:{position:"absolute",left:0,top:0,"z-index":1},CBORDER:{position:"absolute",left:0,top:0},"CBORDER div":{position:"absolute",display:"block"},POOL:{position:"absolute",left:"-100%",top:"-100%",width:0,height:0},HOLDER:{overflow:"auto",position:"relative"},TABLE:{overflow:"hidden","border-collapse":"separate","border-spacing":"0",margin:"0","border-width":"0","table-layout":"fixed",width:"0","outline-width":"0",cursor:"default","max-width":"none","max-height":"none"},"ITEM:empty:after":{"text-align":"center",color:"#ccc",content:"attr(data-coord)",position:"absolute",top:"0",bottom:"0",left:"0",right:"0",margin:"auto",height:"1.5em","-moz-user-select":xui.browser.gek?"-moz-none":null,"-khtml-user-select":xui.browser.kde?"none":null,"-webkit-user-select":xui.browser.kde?"none":null,"-o-user-select":xui.browser.opr?"none":null,"-ms-user-select":(xui.browser.ie||xui.browser.newie)?"none":null,"user-select":"none","touch-action":"none"},"ITEM.layoutcell":{"border-right":"1px solid transparent","border-bottom":"1px solid transparent","border-left":"none","border-top":"none",$order:1},"ITEM.layoutcell.firstrow":{"border-top":"1px solid transparent",$order:2},"ITEM.layoutcell.firstcol":{"border-left":"1px solid transparent",$order:2},"BOX.solidgridline ITEM.layoutcell":{"border-right":"1px solid #444","border-bottom":"1px solid #444","border-left":"none","border-top":"none",$order:3},"BOX.solidgridline ITEM.layoutcell.firstrow":{"border-top":"1px solid #444",$order:4},"BOX.solidgridline ITEM.layoutcell.firstcol":{"border-left":"1px solid #444",$order:4},"KEY ITEM":{position:"relative",background:"transparent",height:"22px",padding:"0 4px",overflow:"hidden","outline-width":"0","white-space":"pre-line","empty-cells":"show","line-height":"1.22","text-align":"left","vertical-align":"middle","background-clip":"padding-box"},"KEY .handsontableInput":{"line-height":"1.22"},"KEY .handsontable tr":{background:"transparent"},"BOX.handsontable tr:first-child td, BOX.handsontable tr:first-child th":{"border-top":"none"},"BOX.handsontable tr:first-child > td, BOX.handsontable tr:first-child > th":{"border-top":"1px solid #ccc"},".handsontable.solidgridline td":{"border-right":"1px solid #444","border-bottom":"1px solid #444"},".handsontable.solidgridline tr:first-child > td":{"border-top":"1px solid #444"},".handsontable.solidgridline th:nth-child(2), .handsontable.solidgridline td:first-of-type, .handsontable.solidgridline .htNoFrame + th, .handsontable.solidgridline .htNoFrame + td":{"border-left":"1px solid #444"},".handsontable.nogridline td":{"border-right":"1px solid transparent","border-bottom":"1px solid transparent"},".handsontable.nogridline tr:first-child > td":{"border-top":"1px solid transparent"},".handsontable.nogridline th:nth-child(2), .handsontable.nogridline td:first-of-type, .handsontable.nogridline .htNoFrame + th, .handsontable.nogridline .htNoFrame + td":{"border-left":"1px solid transparent"}},Templates:{tagName:"div",className:"{_className}",style:"{_style}",BOX:{tagName:"div"},POOL:{tagName:"div"}},Behaviors:{DroppableKeys:["ITEM"],PanelKeys:["ITEM"],HotKeyAllowed:false,ITEM:{}},DataModel:{expression:{ini:"",action:function(){}},tabindex:null,defaultFocus:null,disableClickEffect:null,disableHoverEffect:null,disableTips:null,disabled:null,renderer:null,selectable:null,tips:null,autoTips:null,overflow:null,items:{hidden:true},listKey:null,dragSortable:null,mode:{ini:"write",listbox:["design","write","read"],get:function(){return this.$inDesign?"design":(this.properties.mode||"read")},action:function(){this.boxing().refresh()}},lineSpacing:{ini:0,action:function(a){this.boxing().refresh()}},width:{$spaceunit:1,ini:"30em"},height:{$spaceunit:1,ini:"25em"},solidGridlines:{ini:true,action:function(c){var a=c?"solidgridline":this.boxing()._isDesignMode()?"":"nogridline",b=this.getSubNode("BOX");b.removeClass("solidgridline nogridline");if(a){b.addClass(a)}}},stretchHeight:{ini:"none",listbox:["none","last","all"],action:function(){if(this.boxing()._isDesignMode()){this.box._updateSetting(this,"stretchHeight");var a=this.getRoot().cssSize();this.box._resizeTable(this,this.getSubNode("BOX").cssSize(),false,true)}else{this.box._resizeTable(this,this.getSubNode("BOX").cssSize(),false,true)}}},stretchH:{ini:"all",listbox:["all","none","last"],action:function(){if(this.boxing()._isDesignMode()){this.box._updateSetting(this,"stretchH");this.box._resizeTable(this,this.getSubNode("BOX").cssSize(),false,true)}else{this.box._resizeTable(this,this.getSubNode("BOX").cssSize(),false,true)}}},rowHeaderWidth:{ini:25,action:function(){if(this.boxing()._isDesignMode()){this.box._updateSetting(this,"rowHeaderWidth");var a=this.getRoot().cssSize();xui.UI.$tryResize(this,a.width,a.height)}}},columnHeaderHeight:{ini:25,action:function(){if(this.boxing()._isDesignMode()){this.box._updateSetting(this,"columnHeaderHeight");var a=this.getRoot().cssSize();xui.UI.$tryResize(this,a.width,a.height)}}},floatHandler:{ini:true,action:function(){if(this.boxing()._isDesignMode()){var a=this.getRoot().cssSize();xui.UI.$tryResize(this,a.width,a.height,true)}}},defaultRowSize:5,defaultColumnSize:5,defaultRowHeight:50,defaultColWidth:120,layoutData:{ini:{},action:function(){this.boxing().refresh()}},rendererCDNJS:"/plugins/formlayout/handsontable.full.min.js",rendererCDNCSS:"/plugins/formlayout/handsontable.full.min.css"},RenderTrigger:function(){var b=this,d=b.properties,a=b.box;if(b.boxing()._isDesignMode()){if(window.Handsontable){a._renderAsHandsontable(b)}else{var c="xui.UI.HTable:Handsontable";xui.CSS.includeLink(d.rendererCDNCSS,c);xui.include("Handsontable",d.rendererCDNJS,function(){if(xui(c).get(0)){a._renderAsHandsontable(b);var e=b.getRoot().cssSize();xui.UI.$tryResize(b,e.width,e.height)}else{xui.Thread.repeat(function(){if(xui(c).get(0)){a._renderAsHandsontable(b);var f=b.getRoot().cssSize();xui.UI.$tryResize(b,f.width,f.height);return false}},200)}},null,false,{cache:true})}}else{a._renderAsH5Table(b)}b.$handleCustomVars=function(e){if(!e){xui.arr.each(b.children,function(f){delete f[0]._attached2cell;delete f[0]._autoexpand})}};b.boxing().setSolidGridlines(d.solidGridlines,true)},EventHandlers:{onShowTips:null,onGetCellData:function(c,a,b){}},_getHeaderOffset:function(a){var c=a.properties,b={left:0,top:0};if(c.floatHandler&&a.boxing()._isDesignMode()){b.left=c.rowHeaderWidth;b.top=c.columnHeaderHeight+1}return b},_layoutChanged:function(b,a){if(a||b._$tableInited){xui.resetRun(b.getUid("layoutchanged"),function(){if(b.properties){var c=b.properties.layoutData;b.properties.layoutData=b.box._getLayoutData(b);if(b.$onLayoutChanged){b.$onLayoutChanged(b,c,b.properties.layoutData)}}})}},_getLayoutData:function(A){var c=A.properties,e={},f,b={},a={},J=[],F={},L,o,r,u,B,x,K;if(u=A.$htable){F.rows=u.countRows();F.cols=u.countCols();J=xui.copy(xui.get(u.getPlugin("mergeCells"),["mergedCellsCollection","mergedCells"]));if(!xui.isEmpty(J)){F.merged=J}x=u.getSettings();B=u.getPlugin("ManualRowResize");for(var H=0,E=F.rows,I;H<E;H++){var j=u.toPhysicalRow(H);if(B.manualRowHeights&&B.manualRowHeights[j]){xui.set(b,[H+1,"manualHeight"],B.manualRowHeights[j])}if(K=xui.isArr(x.rowHeights)?x.rowHeights[j]:x.rowHeights){xui.set(b,[H+1,"height"],K)}}if(!xui.isEmpty(b)){F.rowSetting=b}B=u.getPlugin("ManualColumnResize");for(var H=0,E=F.cols,q;H<E;H++){var g=u.toPhysicalColumn(H);if(B.manualColumnWidths&&B.manualColumnWidths[g]){xui.set(a,[xui.ExcelFormula.toColumnChr(H+1),"manualWidth"],B.manualColumnWidths[g])}}if(!xui.isEmpty(a)){F.colSetting=a}L=u.getData();for(var H=0,E=L.length;H<E;H++){var j=L[H];for(var D=0,C=j.length;D<C;D++){if(xui.isSet(L[H][D])&&L[H][D]!==""){xui.set(e,[xui.ExcelFormula.toCellId(D,H),"value"],L[H][D])}}}for(var H=0,E=F.rows;H<E;H++){var j=u.toPhysicalRow(H);var d=u.getCellMetaAtRow(j);if(d&&d.length){for(var D=0,C=d.length;D<C;D++){var g=u.toPhysicalColumn(D);if(!xui.isEmpty(d[g].style)){xui.set(e,[xui.ExcelFormula.toCellId(D,H),"style"],xui.copy(d[g].style))}}}}if(!xui.isEmpty(e)){F.cells=e}var G=u.getPlugin("customBorders");if((f=G.getBorders()).length){F.customBorders=xui.clone(f,function(m,l){return l!="id"&&l!="border"})}}return F},_renderAsH5Table:function(u){var C=u.getSubNode("BOX"),E=C.get(0),c=u.properties,D=c.layoutData,a=D.rows||c.defaultRowSize,d=D.cols||c.defaultColumnSize,s={},r,G={},j={},o=function(n,L){var J=u.onGetCellData&&u.boxing().onGetCellData(u,L,xui.get(D,["cells",L]),n[L]);if(!xui.isSet(J)){if(!n[L]){J=xui.get(D,["cells",L,"value"])}else{var K=n[L],l=K&&K.boxing();if(K.key=="xui.UI.RichEditor"||K.key=="xui.UI.Image"){J=""}else{if(K.key=="xui.UI.CheckBox"||K.key=="xui.UI.SCheckBox"){J='<input type="checkbox" disabled tabindex="-1"  onclick="javascript:return false;"'+(l.getUIValue()?"checked":"")+">"+l.getCaption()}else{J=l.getShowValue?l.getShowValue():l.getValue?("$UIvalue" in K.properties?l.getUIValue():l.getValue()):l.getCaption?l.getCaption():l.getHtml?l.getHtml():l.getLabel?l.getLabel():""}}}}return xui.isSet(J)?J:""},A,w,F,q,f,m,I=[];xui.arr.each(u.children,function(l){s[l[1]]=l[0]});xui.arr.each(D.merged,function(K){G[K.row+":"+K.col]=(K.rowspan>1?(" rowspan="+K.rowspan):"")+(K.colspan?(" colspan = "+K.colspan):"")+" ";for(var M=0,n=K.rowspan;M<n;M++){for(var L=0,J=K.colspan;L<J;L++){if(M===0&&L===0){continue}j[(K.row+M)+":"+(K.col+L)]=1}}});I.push("<div id='"+u.key+"-HOLDER:"+u.serialId+":' class='"+u.getClass("HOLDER")+"' style='width:"+c.width+"; height:"+c.height+"' >");I.push("<table id='"+u.key+"-TABLE:"+u.serialId+":' class='"+u.getClass("TABLE")+"'"+(c.stretchH!="none"?(" style='width:"+c.width+";'"):"")+">");var H=u.box._getColWidths(u,u.$px(c.width));I.push("<colgroup><col style='width:0;border:0;margin:0;padding:0;'></col>");for(var e=0,x=d;e<x;e++){I.push("<col rowid="+g+" style='width:"+H[e]+";'></col>")}I.push("</colgroup>");I.push("<tbody>");for(var g=0,B=a;g<B;g++){I.push("<tr rowid="+g+"><th style='width:0;border:0;margin:0;padding:0;");if(r=xui.get(D,["rowSetting",g+1,"height"])||xui.get(D,["rowSetting",g+1,"manualHeight"])||c.defaultRowHeight){I.push("height:"+(r-(g===0?1:1))+"px;")}I.push("'></th>");for(var e=0,x=d;e<x;e++){w=u.pickSubId("items");q=xui.ExcelFormula.toCellId(e,g);F={_serialId:w,col:e,row:g,id:q,value:o(s,q),style:xui.get(D,["cells",q,"style"])||{}};u.ItemIdMapSubSerialId[q]=w;u.SubSerialIdMapItem[w]=F;f=u.key+"-ITEM:"+u.serialId+":"+w;m=[];xui.each(F.style,function(n,l){m.push(l.replace(/[A-Z]/g,function(J){return"-"+J.toLowerCase()})+":"+n)});if(!j[g+":"+e]){I.push("<td rowid="+g+" id='"+f+"' class='layoutcell "+(g===0?"firstrow ":"")+(e===0?"firstcol ":"")+u.getClass("ITEM")+"' style='"+m.join(";")+"' "+(G[g+":"+e]||"")+">");I.push(F.value);I.push("</td>")}}I.push("</tr>")}I.push("</tbody></table>");I.push("<div id='"+u.key+"-CBORDER:"+u.serialId+":' class='"+u.getClass("CBORDER")+"' ></div>");I.push("</div>");E.innerHTML=I.join("");xui.UI.$addEventsHandler(u,E,false);u.box._setCustomBorders(u);var b=[];xui.each(u.children,function(l){b.push(l)});u.children=[];xui.arr.each(b,function(l){u.boxing().append(l[0],l[1])})},_renderAsHandsontable:function(o){if(!o||!o.box){return}var G=function(m,l){m.box._layoutChanged(m,l)};var w=o.getSubNode("BOX"),C=w.get(0),j,b=o.properties,x=b.layoutData,f=true,F={autoWrapRow:true,renderAllRows:true,persistentState:false,readOnly:!f,readOnlyCellClassName:"no",comments:!f,disableVisualSelection:!f,enterBeginsEditing:f,manualRowMove:f,manualColumnMove:f,contextMenu:f,copyable:f,copyPaste:f,beforeOnCellMouseDown:!f?null:function(l,m){if(m.row===-1&&m.col===-1){l.stopImmediatePropagation()}},afterOnCellMouseUp:!f?null:function(l,m){if(m.row===-1&&m.col===-1){this.deselectCell();o.getRoot().onClick(true);l.stopImmediatePropagation()}},beforeRenderer:function(L,M,l,K,J,I){var n=o.pickSubId("items"),H=xui.ExcelFormula.toCellId(l,M);I.oid=I.id;I.id=H;if(I.oid&&I.oid!=I.id){o.$cellIdChangedMap[I.oid]=I.id}I._serialId=n;o.ItemIdMapSubSerialId[H]=n;o.SubSerialIdMapItem[n]=I;if(!I.style){I.style=xui.get(b.layoutData,["cells",xui.ExcelFormula.toCellId(l,M),"style"])||{}}L.id=o.key+"-ITEM:"+o.serialId+":"+n;xui.UI.$addEventsHandler(o,L,true);for(var m in I.style){L.style[m]=I.style[m]}L.className=(L.className||"")+o.getClass("ITEM");if(f){L.setAttribute("data-coord",H)}if(I._child_autoexpandH){L.style.height=I._child_autoexpandH+"px"}else{L.style.height=""}},beforeRender:function(m){if(o._$tableInited){o.$cellIdChangedMap={};var H=o.getSubNode("POOL").get(0),l=[];xui.arr.each(o.children,function(I){if(I[0]&&I[0].rendered){H.appendChild(I[0].getRootNode());l.push(I)}});if(l.length){o._pool_children=l}o.children=[];for(var n in o.SubSerialIdMapItem){o.reclaimSubId(n,"items")}o.ItemIdMapSubSerialId={};o.SubSerialIdMapItem={}}},afterInit:function(){o._$tableInited=1},afterRender:function(m){xui.tryF(o.$onrender,[],o);var n=o.getSubNode("BOX");n=n.first();n.id(o.key+"-MASTER:"+o.serialId+":");n=n.first();n.id(o.key+"-HOLDER:"+o.serialId+":");n=n.first();n.id(o.key+"-HIDER:"+o.serialId+":");n=n.first();n.id(o.key+"-SPREADER:"+o.serialId+":");if(o._$tableInited){var H=o.$cellIdChangedMap;if(o._pool_children){xui.arr.each(o._pool_children,function(I){delete I[0].$dockParent;if(I[0].$domId){o.boxing().append(I[0],H[I[1]]||I[1])}});delete o._pool_children}}else{var l=[];xui.each(o.children,function(I){if(I[0].$domId){l.push(I)}});o.children=[];xui.arr.each(l,function(I){if(I[0].$xid){o.boxing().append(I[0],I[1])}});o.getRoot().onMouseup(function(J,I){o.$lastMousePos=xui.Event.getPos(I)})}},afterSelection:function(){if(b.floatHandler){o.getRoot().css("overflow","visible")}},outsideClickDeselects:function(m){while(((!m.id)||m.id==xui.$localeDomId||m.tagName=="tspan")&&m.parentNode!==document&&m.parentNode!==window){m=m.parentNode}var n=xui.UIProfile.getFromDom(m);if(n&&o.$popmenu){var l=o.$popmenu.get(0);if(n==l||n.$parentPopMenu==l||n.$popGrp==l.$popGrp){return false}}o.getRoot().css("overflow","");return true},afterContextMenuShow:!f?null:function(l){if(o.$onPopMenu){o.$popmenu=o.$onPopMenu(o,o.$popmenu,l.menu)}l.menu.container.style.display="none"},afterUpdateSettings:function(){G(o)},afterRedo:function(){G(o)},afterUndo:function(){G(o)},afterChange:function(m,l){if(l!="loadData"&&l!="populateFromArray"){G(o)}},beforeCellAlignment:function(){G(o)},afterMergeCells:function(m,l,n){if(!n){G(o)}},afterUnmergeCells:function(m,l,n){if(!n){G(o)}},afterRowResize:function(L,I,K){G(o);var n=this.getCellMetaAtRow(L);for(var H=0,m=n.length;H<m;H++){var J=o.boxing().getChildren(n[H].id);if(J["xui.UI.Input"]&&J.getMultiLines&&J.getMultiLines()&&J.setAutoexpand){J.get(0)._autoexpand=(I-1)+"px"}}},afterColumnResize:function(){G(o)},afterColumnSort:function(){G(o)},afterRowMove:function(l,m){G(o)},afterColumnMove:function(){G(o)},afterCreateCol:function(m,H){G(o);var J=this.getPlugin("ManualColumnResize");var l=[];for(var n=0;n<H;n++){l.push(b.defaultColWidth)}if(!J.manualColumnWidths){J.manualColumnWidths=[]}for(var n=0;n<m;n++){J.manualColumnWidths[n]=J.manualColumnWidths[n]||(void 0)}J.manualColumnWidths.splice.apply(J.manualColumnWidths,[m,0].concat(l));this.deselectCell();var I=this;xui.asyRun(function(){I.selectColumns(m)})},afterCreateRow:function(m,H){G(o);var J=this.getPlugin("ManualRowResize");var l=[];for(var n=0;n<H;n++){l.push(b.defaultRowHeight)}if(!J.manualRowHeights){J.manualRowHeights=[]}for(var n=0;n<m;n++){J.manualRowHeights[n]=J.manualRowHeights[n]||(void 0)}J.manualRowHeights.splice.apply(J.manualRowHeights,[m,0].concat(l));this.deselectCell();var I=this;xui.asyRun(function(){I.selectRows(m)})},afterRemoveCol:function(l,m){G(o);var n=this.getPlugin("ManualColumnResize");if(n.manualColumnWidths){n.manualColumnWidths.splice(l,m)}this.deselectCell()},afterRemoveRow:function(l,m){G(o);var n=this.getPlugin("ManualRowResize");if(n.manualRowHeights){n.manualRowHeights.splice(l,m)}this.deselectCell()}},B={},g;var d=o.box._getHeaderOffset(o);B.height=o.$px(b.height)+d.top;B.width=o.$px(b.width)+d.left;B.stretchHeight=(g=b.stretchHeight)=="last"?"last":g=="all"?"all":"none";B.stretchH=(g=b.stretchH)=="last"?"last":g=="all"?"all":"none";B.rowHeaderWidth=b.rowHeaderWidth;B.columnHeaderHeight=b.columnHeaderHeight;B.defaultColumnWidth=b.defaultColWidth;B.rowHeaders=f;B.colHeaders=f;if(x.merged){B.mergeCells=x.merged}else{B.mergeCells=f}if(x.cols){var c=[],D=[],a=[],q=[],E=[],e;xui.each(x.rowSetting,function(m,l){if(xui.isSet(m.manualHeight||m)){a[parseInt(l,10)-1]=parseInt(m.manualHeight||m,10)}if(xui.isSet(m.height||m)){c[parseInt(l,10)-1]=parseInt(m.height||m,10)}});xui.each(x.colSetting,function(m,l){l=xui.ExcelFormula.toColumnNum(l);if(xui.isSet(m.manualWidth||m)){q[l-1]=parseInt(m.manualWidth||m,10)}});for(var A=0,u=x.rows||b.defaultRowSize;A<u;A++){E.push(e=[]);for(var s=0,r=x.cols||b.defaultColumnSize;s<r;s++){e.push(null)}}xui.each(x.cells,function(l,n){var m=xui.ExcelFormula.toCoordinate(n);E[m.row][m.col]=xui.isSet(l.value)?l.value:null});for(var A=0;A<x.rows;A++){a[A]=a[A]||b.defaultRowHeight}B.manualRowResize=a;B.manualColumnResize=!xui.isEmpty(q)?q:f;if(!xui.isEmpty(c)){B.rowHeights=c}B.data=E;if(x.customBorders){B.customBorders=x.customBorders}}else{B.manualColumnResize=f;var a=[];for(var A=0;A<b.defaultRowSize;A++){a[A]=b.defaultRowHeight}B.manualRowResize=a}o.$htable=j=new Handsontable(C,xui.merge(B,F,"all"));if(!x.cols){o.properties.layoutData=o.box._getLayoutData(o)}(o.$beforeDestroy=(o.$beforeDestroy||{}))["destroyhtable"]=function(){var l;if(l=this.$htable){var m=this.getSubNode("BOX").get(0);if(m){xui.$purgeChildren(m)}if(!l.isDestroyed){Handsontable.hooks.destroy(l);l.destroy()}delete this.$htable}if(l=this.$popmenu){l.destroy()}}},_getRowHeights:function(q,E,A){var c=q.properties,w=c.layoutData,m,a=w.rows||c.defaultRowSize,x=[],j=[],B=[],r=0,f=0,C,D,u=0,l=0,g=c.stretchHeight||"all",b=c.defaultRowHeight;for(var e=0,s=a;e<s;e++){if(m=xui.get(w,["rowSetting",e+1,"manualHeight"])){if(e<a-1){r+=parseInt(m)}}}b=E-r;if(g=="all"){for(var e=0,s=a;e<s;e++){if(m=xui.get(w,["rowSetting",e+1,"manualHeight"])){r+=parseInt(m);j.push(m)}else{f++;j.push(null)}}C=(E-r)/f;D=C-Math.round(C)}for(var e=0,s=a;e<s;e++){var d,o=!A?"px":"";u++;m=xui.get(w,["rowSetting",e+1,"manualHeight"])||(c.defaultRowHeight);switch(g){case"all":d=j[e]===null?Math.max(c.defaultRowHeight,(Math.round(C))):j[e];l+=d;B.push((e==a-1?Math.round(E-l+d):d)+o);break;case"last":B.push(e==a-1?b+o:(m+o));break;default:B.push(m+o)}}return B},_getColWidths:function(o,x){var b=o.properties,w=b.layoutData,m,d=w.cols||b.defaultColumnSize,e=b.stretchH||"all",j=[],B=[],q=0,g=0,A,C,s=0,l=0;if(d.length<3){return d}if(e=="all"){for(var f=0,r=d;f<r;f++){var u=xui.ExcelFormula.toColumnChr(f+1);if(m=xui.get(w,["colSetting",u,"manualWidth"])){q+=parseInt(m);j.push(m)}else{g++;j.push(null)}}A=(x-q)/g;C=A-Math.round(A)}var a=0;for(var f=0,r=d;f<r;f++){var u=xui.ExcelFormula.toColumnChr(f+1),c;s++;m=xui.get(w,["colSetting",u,"manualWidth"])||(b.defaultColWidth);width=m=parseInt(m);a=a+width;switch(e){case"all":c=j[f]===null?Math.max(b.defaultColWidth,(Math.round(A))):j[f];if(xui.isNumb(c)){l+=c}else{l+=parseInt(c)}width=(f==d-1?Math.round(x-l+c):c);break;case"last":width=f==d-1?x-a:m;break;default:width=m}B.push(width)}return B},_setCustomBorders:function(a){xui.resetRun(a.getUid()+":cborder",function(){if(!a.renderId){return}var b=a.getSubNode("CBORDER").get(0);xui.arr.each(a.properties.layoutData.customBorders,function(g){var m=xui.ExcelFormula.toCellId(g.col,g.row),j=a.ItemIdMapSubSerialId[m],n=a.getSubNode("TABLE").get(0),f=a.getSubNode("ITEM",j),l=f.offset(null,n),e,d,c;if(g.top&&g.top.width){e=a.key+"-CBT:"+a.serialId+":"+j;d=xui.Dom.byId(e);c=d&&d.style;if(!d){d=document.createElement("div");d.id=e;b.appendChild(d)}c=d.style;c.backgroundColor=g.top.color;c.left=(l.left-1)+"px";c.top=(l.top-1)+"px";c.width=f.offsetWidth()+"px";c.height="1px"}if(g.left&&g.left.width){e=a.key+"-CBL:"+a.serialId+":"+j;d=xui.Dom.byId(e);if(!d){d=document.createElement("div");d.id=e;b.appendChild(d)}c=d.style;c.backgroundColor=g.left.color;c.left=(l.left-1)+"px";c.top=(l.top-1)+"px";c.width="1px";c.height=f.offsetHeight()+"px"}})})},_resizeTable:function(d,s,b,a){if(d.boxing()._isDesignMode()){var r;if(r=d.$htable){try{var f=d.getSubNode("HOLDER").cssSize();if(!b&&(s.width!=f.width||s.height!=f.height)||a){d.getSubNode("HOLDER").cssSize(s);s.manualRowResize=this._getRowHeights(d,s.height,true);s.manualColumnResize=this._getColWidths(d,s.width);s.mergeCells=xui.copy(xui.get(r.getPlugin("mergeCells"),["mergedCellsCollection","mergedCells"]));r.updateSettings(s)}}catch(j){}}}else{d.getSubNode("HOLDER").cssSize(s);var g=d.getSubNode("TABLE");var m=d.getSubNode("TR");if(g.get(0)){if(d.properties.stretchH&&d.properties.stretchH!="none"){var c=s.width-(g.offsetHeight()>s.height?xui.Dom.getScrollBarSize():0);g.width(c)}var q=this._getColWidths(d,c);g.first().children().each(function(w,e){if(e!==0){var u=q[e-1];if(!xui.str.endWith(u+"","px")){u=u+"px"}w.style.width=u}});var o=[],l=this._getRowHeights(d,s.height);if(d.properties.stretchHeight!="none"){var n=s.height-(g.offsetHeight()>s.height?xui.Dom.getScrollBarSize():0);g.height(n);d.getSubNodes("ITEM",true).each(function(u){if(u.parentNode.attributes.rowid){var x=parseInt(u.attributes.rowid.value);var e=l[x];var w=u.parentNode.children[0];w.style.height=e}})}d.getSubNodes("ITEM",true).each(function(e){if(xui.Dom.$hasEventHandler(e,"onsize")){o.push(e)}});if(o.length){xui(o).onSize(true)}d.box._setCustomBorders(d)}}},_updateSetting:function(d,b){var a=d.$htable;if(typeof b=="string"){var c={};c[b]=d.properties[b];b=c}b.mergeCells=xui.copy(xui.get(a.getPlugin("mergeCells"),["mergedCellsCollection","mergedCells"]));if((!b.stretchHeight&&!b.stretchH)||(b.stretchHeight=="none"||b.stretchH=="none")){a.updateSettings(b)}},$beforeAppend:function(b,c,a){if(!a){return false}},$afterAppend:function(c,g,a){if(!a){return}var f=c.properties.lineSpacing|0;if(c.renderId&&g["xui.UI"]&&g.size()==1){var m=c.getItemByItemId(a),b=g.get(0),d=b.properties;if(m){var l=c.getSubNode("ITEM",m._serialId),o=b.box._isFormField?b.box._isFormField(b):!!xui.get(b,["properties","isFormField"]),e=c.boxing().getMode(),j=e!="read"||g["xui.UI.RichEditor"];if(o&&(!d.name||c.ItemIdMapSubSerialId[d.name])){d.name=m.id}if(l&&l.get(0)){if(b._cellresizeP!=l){var n=function(){if(!l.get(0)){return}if(g["xui.UI.Image"]||g["xui.UI.ProgressBar"]||g["xui.UI.Button"]){return}g.setPosition("absolute").setLeft(0).setTop(f/2).setBottom(f/2);var q=l.offsetHeight(),r=l.offsetWidth();if(g.setWidth){g.setWidth(r-(m.col?1:2))}if(g.setHeight){g.setHeight(q-(m.row?1:2)-f)}};n();l.onSize(n,"cellresize");b._cellresizeP=l}}if(!b._attached2cell){b._attached2cell=1;if(o){if(j){b.locked=1;b.boxing().setDisplay("");if(g.setLabelPos){g.setLabelPos("none").setLabelCaption("").setLabelSize("0")}if(g.setVAlign){g.setVAlign("middle")}if(g["xui.UI.Input"]&&g.getMultiLines&&g.getMultiLines()&&g.setAutoexpand){if(!parseFloat(b._autoexpand)){b._autoexpand=(l.offsetHeight()-1)+"px";b.getSubNode("INPUT").addClass("autoexpand");b.$beforeAutoexpand=function(r,q){q=g.getAutoexpandHeight();m._child_autoexpandH=q;if(c.boxing()._isDesignMode()){xui.resetRun(c.getUid("autoex"),function(){if(c.$htable){c.$htable.render()}})}else{l.height(q)}if(!c.boxing()._isDesignMode()){c.box._setCustomBorders(c)}return false};b.box._checkAutoexpand(b)}}if(e=="read"){if(g.setReadonly){g.setReadonly(true,true)}}}else{b.boxing().setDisplay("none")}}b.$handleCustomVars=function(r){if(r){for(var q in r){if(r[q]){this[q]=r[q]}}}else{return{_attached2cell:this._attached2cell,_autoexpand:this._autoexpand,$beforeAutoexpand:this.$beforeAutoexpand}}}}}}},_IllegalDetect:function(e,c,d){return null;var b=0,a=function(f){xui.arr.each(f,function(g){g=g[0]||g;if(g.box&&g.box.HasHtmlTableNode){b++}else{a(g.children)}})};a(c._nodes);if(b){if(d){throw new Error("Cant append control with HTML TABLE node into "+e.key)}else{return b}}},_onresize:function(c,b,n){var a=c.properties,e=xui.$us(c),j=function(q,r){return c.$forceu(q,e>0?"em":"px",r)},m=c.getRoot(),l=c.getSubNode("BOX"),f=c.box._getHeaderOffset(c),g=b?c.$px(b):b,d=n?c.$px(n):n,o;if(b||n){if(b){a.width=j(g)}if(n){a.height=j(d)}l.css({marginLeft:-f.left+"px",marginTop:-f.top+"px",width:b?(g+f.left+"px"):null,height:n?(d+f.top+"px"):null});xui.resetRun(c.getUid("resize"),function(){if(c&&c.box){c.box._resizeTable(c,c.getSubNode("BOX").cssSize(),false)}})}}}});xui.Class("xui.UI.FileUpload","xui.UI",{Instance:{setQueryData:function(a,b){this.each(function(c){if(b){xui.set(c.properties.params,(b||"").split("."),a)}else{c.properties.params=a||{}}})},reload:function(c){var a=this.getSrc(),l=this.getUploadUrl(),n=c.host,b=this.getPrepareFormData(),f=this.getParams(),g={};if(!c.$inDesign){if(a&&l){if(n&&b){if(n.pagectx){xui.merge(g,n.pagectx.getFormValues(),"all")}else{xui.merge(g,n.getData())}}g.uploadUrl=f.uploadUrl||l;for(key in f){if(key!="uploadUrl"){try{var m=xui.adjustRes(f[key],true,1,1,null,{page:c.module},c.module);if(m){g[key]=xui.adjustRes(f[key],true,1,1,null,{page:c.module},c.module)}}catch(j){}}}var d=xui.urlEncode(g);if(a.indexOf("?")>-1){a=a+"&"+d}else{a=a+"?"+d}c.getSubNode("H5").attr("src",a)}}return a}},Static:{Appearances:{KEY:{overflow:"hidden"},H5:{position:"absolute",left:"-1px",top:"-1px","z-index":1},COVER:{position:"absolute",left:"-1px",top:"-1px",width:0,height:0,"z-index":4}},Templates:{tagName:"div",className:"{_className}",style:"{_style}",H5:{tagName:"iframe",src:"{src}",text:"Your browser does not support the audio element."},COVER:{tagName:"div",style:"background-image:url("+xui.ini.img_bg+");"}},Behaviors:{HotKeyAllowed:false},DataModel:{selectable:true,width:{$spaceunit:1,ini:"40em"},height:{$spaceunit:1,ini:"30em"},src:{ini:"/plugins/fileupload/uploadgrid.html",action:function(a){this.getSubNode("H5").attr("src",xui.adjustRes(a))}},prepareFormData:{ini:true},uploadUrl:{ini:"upload/",action:function(a){}},params:{ini:{},action:function(a){this.getSubNode("H5").attr("params",a)}}},RenderTrigger:function(){var b=this,a=b.getSubNode("H5"),c=b.properties;if(window.postMessage){self._msgcb=function(d){var f=xui.unserialize(d);if(f.data){f=f.data}if(b[f.eventType]){switch(f.eventType){case"uploadfile":b.boxing().uploadfile(b,f.eventType,f.item,f.response);break;case"uploadfail":b.boxing().uploadfail(b,f.eventType,f.item,f.response);break;case"uploadcomplete":b.boxing().uploadcomplete(b,f.eventType,f.item,f.response);break;case"uploadprogress":b.boxing().uploadprogress(b,f.eventType,f.item,f.response);break}}};if(window.addEventListener){window.addEventListener("message",self._msgcb,false)}else{window.attachEvent("onmessage",self._msgcb)}}},_prepareData:function(c){var f=arguments.callee.upper.call(this,c),g={},e=c.host,b=this,j;if(!c.$inDesign){if(f.prepareFormData){var d=function(l){c.boxing().reload(c)};if(c.getModule()){c.getModule().setEvents("afterShow",d,false)}else{j=c.boxing().reload(c)}}}if(j){f.src=j}else{if(f.src&&f.uploadUrl){g.uploadUrl=f.params.uploadUrl||f.uploadUrl;var a=xui.urlEncode(g);f.src=f.src+"?"+a}}return f},EventHandlers:{uploadfile:function(c,b,d,a){},uploadfail:function(c,b,d,a){},uploadcomplete:function(c,b,d,a){},uploadprogress:function(c,b,d,a){}},_onresize:function(c,b,l){var j=c.getSubNode("H5"),m=j.cssSize(),a=c.properties,e=xui.$us(c),g=function(n,o){return c.$forceu(n,e>0?"em":"px",o)},f=b?c.$px(b):b,d=l?c.$px(l):l;if((b&&!xui.compareNumber(m.width,f,6))||(l&&!xui.compareNumber(m.height,d,6))){if(b){j.attr("width",f).width(a.width=g(f))}if(l){j.attr("height",d).height(a.height=g(d))}if(c.$inDesign||a.cover){c.getSubNode("COVER").cssSize({width:b?a.width:null,height:l?a.height:null},true)}}}}});xui.Class("xui.Module.JSONEditor","xui.Module",{Instance:{activate:function(){},setValue:function(d){var a=this,c=xui.isStr(d)?d?xui.unserialize(d):false:d,b=a._json2rows(c,a._rootArr=xui.isArr(c));a.tg.setRows(b).free()},getValue:function(a){var b=this.tg.getRows();var c=this._rows2json(b,this._rootArr);return a?xui.unserialize(c):c},getEditor:function(){return this.tg},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.TreeGrid").setHost(c,"tg").setTogglePlaceholder(true).setEditable(true).setIniFold(false).setRowHandler(false).setColSortable(false).setHeader([{id:"key",width:100,type:"input",caption:"key",editorCacheKey:"input",colResizer:true,flexSize:true},{id:"value",width:200,type:"textarea",caption:"value",editorCacheKey:"textarea",flexSize:true}]).setTagCmds([{id:"add",type:"text",caption:"",location:"right",itemClass:"xuicon xui-uicmd-getter",pos:"header row",tips:"Append a child"},{id:"up",type:"text",location:"right",itemClass:"xuicon xui-icon-arrowtop",pos:"row",tips:"Add a node to the front of the node"},{id:"down",type:"text",location:"right",itemClass:"xuicon xui-icon-arrowbottom",pos:"row",tips:"Add a node at the back of this node"},{id:"del",type:"text",location:"right",itemClass:"xuicon xui-uicmd-close",pos:"row",tips:"Delete this node"}]).setTreeMode("infirstcell").onCmd("_tg_oncmd").beforeRowActive("_tg_beforerowactive").beforeCellUpdated("_tg_beforecellupdated").beforeIniEditor("_tg_beforeIniEditor").onBeginEdit("_tg_onEdit").beforeEditApply("_tg_beforecellapply"));return b},_getCellValue:function(d){var b=this,a;try{a=xui.str.trim(d);if(/^'/.test(a)&&!b._isString(a.slice(1))){a=["string",a.slice(1)]}else{a=a.replace(/^\s*/,"").replace(/\s*$/,"");a=a=="null"?["null","null"]:xui.isFinite(a)?["number",a]:/^\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*$/.test(a)?["regexp",a]:/^(true|false)$/.test(a)?["boolean",a.toLowerCase()]:/^new Date\([0-9 \,]*\)$/i.test(a)?["date",xui.serialize(xui.unserialize(a))]:/^((\s*function\s*([\w$]+\s*)?\(\s*([\w$\s,]*)\s*\)\s*)(\{([^\{\}]*)\}))\s*$/i.test(a)&&xui.isFun(xui.unserialize(a))?["function",a]:/^\{[\s\S]*\}$/.test(a)&&xui.isHash(xui.unserialize(a))?["hash",xui.stringify(xui.unserialize(a))]:/^\[[\s\S]*\]$/.test(a)&&xui.isArr(xui.unserialize(a))?["array",xui.stringify(xui.unserialize(a))]:["string",d]}}catch(c){a=null}if(a[0]=="string"){if(a[1]===false){return null}a[1]=xui.stringify(a[1])}if(a[1]==="false"&&a[0]!="string"){a[0]="boolean"}return a},_json2rows:function(d,e,c){var a=this,b=arguments.callee;if(!c){c=[]}if(d){xui.each(d,function(l,f){if(!d.hasOwnProperty(f)){return}var j={},g=a._getType(l);f={value:e?"["+f+"]":f,readonly:e};if(g=="hash"){j.sub=[];j.cells=[f,{value:"{...}"},""];b.call(a,l,false,j.sub)}else{if(g=="array"){j.sub=[];j.cells=[f,{value:"[...]"},""];b.call(a,l,true,j.sub)}else{j.cells=[f,xui.stringify(l),""]}}j._type=g;j.caption="";c.push(j)})}return c},_getType:function(a){return a===null?null:xui.isStr(a)?"string":xui.isNumb(a)?"number":xui.isHash(a)?"hash":xui.isArr(a)?"array":xui.isBool(a)?"boolean":xui.isDate(a)?"date":xui.isReg(a)?"regexp":xui.isFun(a)?"function":"undefined"},_rows2json:function(b,g){var e=arguments.callee,c=[],d,f;xui.arr.each(b,function(a){d=((typeof a.cells[0]=="object")?a.cells[0].value:a.cells[0]);if(a._type=="hash"){f=e(a.sub)}else{if(a._type=="array"){f=e(a.sub,true)}else{f=(typeof a.cells[1]=="object")?a.cells[1].value:a.cells[1]}}if(g){c.push(f)}else{c.push('"'+d+'":'+f)}});return g?"["+c.join(",")+"]":"{"+c.join(",")+"}"},_tg_onEdit:function(c,d,b,a){if(c.properties.multiLineValue){b.getSubNode("INPUT").scrollTop(0)}this.fireEvent("onEdit",[d._col.id,b])},_tg_beforeIniEditor:function(f,g,a,c,e){var d=this;if(e!="cell"){return}if(g._col.id!="value"){return}var e=g._row._type;if(e=="hash"||e=="array"){var j=this._rows2json(g._row.sub,e=="array");if(xui.Coder){j=xui.Coder.formatText(j)}g.$editorValue=j}else{if(e=="string"){var b=xui.unserialize(g.value);if(!d._isString(b)){g.$editorValue="'"+b}else{g.$editorValue=b}}}},_isString:function(a){return !(a=="undifined"||a=="null"||a=="NaN"||xui.isFinite(a)||/^\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*$/.test(a)||/^(true|false)$/.test(a)||/^new Date\([0-9 \,]*\)$/i.test(a)||(/^((function\s*([\w$]+\s*)?\(\s*([\w$\s,]*)\s*\)\s*)(\{([^\{\}]*)\}))$/i.test(a)&&xui.isFun(xui.unserialize(a)))||(/^\{[\s\S]*\}$/.test(a)&&xui.isHash(xui.unserialize(a)))||(/^\[[\s\S]*\]$/.test(a))&&xui.isArr(xui.unserialize(a)))},_tg_beforecellapply:function(d,e,b,c,a){if(a!=="onchange"){return false}},_tg_beforecellupdated:function(e,j,m){var g=this,a={hash:1,array:2},l=j._row,d=l.id,c=e.boxing();if(j._col.id=="value"){var f=this._getCellValue(m.value);if(!f){alert("Text format is not valid!");return false}else{var b={};m.value=f[1];if(a[f[0]]){b.sub=this._json2rows(xui.unserialize(f[1]),f[0]=="array");m.caption=f[0]=="hash"?"{...}":"[...]"}else{if(l.sub){b.sub=null}}xui.asyRun(function(){if(c.isDestroyed()){return}c.updateRow(d,b);l=c.getRowbyRowId(d);if(l){l._type=f[0]}g.fireEvent("onchange",[g])},100)}}else{if(!/^"(\\.|[^"\\])*"$/.test('"'+m.value+'"')){alert("Text format is not valid!");return false}xui.asyRun(function(){g.fireEvent("onchange",[g])},100)}},_tg_beforerowactive:function(){return false},_tg_oncmd:function(f,q,j,g,b){var m=this,d=f.boxing(),l=q?q._type:m._rootArr?"array":"hash",o,n,a;if(q&&q._pid){n=f.rowMap[q._pid];o=n&&n._type}else{n={sub:f.properties.rows};o=m._rootArr?"array":"hash"}switch(j){case"add":a=xui.stamp();if(q){if(l=="array"||l=="hash"){d.insertRows([{id:a,cells:[{value:l=="array"?"[index]":xui.rand(),readonly:l=="array"},"null",""]}],q.id)}else{var c=q.id;xui.confirm("Hash or Array","Modify this node as an Hash or Array?",function(){d.updateCellByRowCol(c,"value","{"+xui.rand()+":"+q.cells[1].value+"}",false,true);xui.asyRun(function(){d.editCellbyRowCol(c,"value")},200)},function(e){if(e=="close"){return}var r=q.id;d.updateCellByRowCol(r,"value","["+q.cells[1].value+"]",false,true);xui.asyRun(function(){d.editCellbyRowCol(r,"value")},200)},"As a Hash","As an Array");return}}else{d.insertRows([{id:a,cells:[{value:l=="array"?"[index]":xui.rand(),readonly:l=="array"},"null",""]}])}break;case"up":a=xui.stamp();d.insertRows([{id:a,cells:[{value:o=="array"?"[index]":xui.rand(),readonly:o=="array"},"null",""]}],null,q.id,true);break;case"down":a=xui.stamp();d.insertRows([{id:a,cells:[{value:o=="array"?"[index]":xui.rand(),readonly:o=="array"},"null",""]}],null,q.id,false);break;case"del":d.removeRows([q.id]);break}if(q&&l=="array"){xui.arr.each(q.sub,function(s,r){var e=s.cells[0];f.boxing().updateCell(e,{caption:"["+r+"]"})})}else{if(n&&o=="array"){xui.arr.each(n.sub,function(s,r){var e=s.cells[0];f.boxing().updateCell(e,{caption:"["+r+"]"})})}}if(a){xui.asyRun(function(){d.editCellbyRowCol(a+"",o=="array"?"value":"key")})}xui.asyRun(function(){m.fireEvent("onchange",[m])},100)},events:{afterIniComponents:function(b){var c=b.properties;b.tg.updateHeader("key",xui.adjustRes(c.keyCaption)||"key");b.tg.updateHeader("value",xui.adjustRes(c.valueCaption)||"value");b.tg.updateHeader("value",{type:c.multiLineValue?"textarea":"input"});if("value" in c){b.setValue(c.value)}if(("tg" in b)&&("notree" in c)&&c.notree){b.tg.setTreeMode("none");var a=b.tg.getTagCmds();a[0].tag="header"}}},propSetAction:function(b){var a=this;if(a._innerModulesCreated&&a.tg){if("keyCaption" in b){a.tg.updateHeader("key",xui.adjustRes(b.keyCaption)||"")}if("valueCaption" in b){a.tg.updateHeader("value",xui.adjustRes(b.valueCaption)||"")}if("multiLineValue" in b){a.tg.updateHeader("value",{type:b.multiLineValue?"textarea":"input"})}if("value" in b){a.setValue(b.value)}}}},Static:{$DataModel:{keyCaption:"key",valueCaption:"value",multiLineValue:true,notree:false},$EventHandlers:{onchange:function(a){},onEdit:function(b,a){}}}});xui.Class("xui.UI.AdvResizer","xui.UI.Resizer",{Instance:{cssRegion:function(){var d=this.get(0),o=d._target,j=d.getRoot().contentBox(),g,w,u,a,s,n,m,f,q=[];if(o){var e=xui.$cache.domPurgeData;xui.arr.stableSort(o._nodes,function(b,c){b=e[c].element.style.zIndex;c=e[c].element.style.zIndex;return b>c?1:b==c?0:-1});o.each(function(A,l){var x,c,r=A.raphael,B=A.id;if(r){var b=xui.svg.getFromDom(A.id);x=b._getBBox();c=b.getRotate()}else{A=xui([A]);x={x:A.offsetLeft(),y:A.offsetTop(),width:A.offsetWidth(),height:A.offsetHeight()};c=A.rotate()}if(l===0){g=x.x;w=x.y;a=g+(m=x.width);u=w+(f=x.height);q.push([{left:g,top:w},{width:m,height:f},B,c])}else{g=Math.min(g,s=x.x);w=Math.min(w,n=x.y);a=Math.max(a,s+(m=x.width));u=Math.max(u,n+(f=x.height));q.push([{left:s,top:n},{width:m,height:f},B,c])}})}d.regionBlocks=q;xui.arr.each(q,function(b){b[0].left-=g;b[0].top-=w;if(j){b[1].width-=2;b[1].height-=2}});return{l:g,t:w,b:u,r:a}},setOffsetParent:function(a){var b=this.get(0);if(b){b._offsetparent=a}},rePosSize:function(){var a=this;a.each(function(c){var n,g=c.getRoot(),m=c.$domId,b=c.properties.rotatable&&!(xui.browser.ie&&xui.browser.ver<=8),f=c._target,d=f.contentBox();if(!f||f.isEmpty()){return}if(!c.properties._attached){n=c.region=c.boxing().cssRegion();var e;if(c._offsetparent){f=f.parent();if(!f.get(0)){return false}e=f.offset(null,c._offsetparent);e.left+=(d?f._borderW("left"):0)-f.get(0).scrollLeft;e.top+=(d?f._borderH("top"):0)-f.get(0).scrollTop}g.cssPos({left:n.l+(e?e.left:0),top:n.t+(e?e.top:0)});g.offsetWidth(n.r-n.l).offsetHeight(n.b-n.t);if(b){if(c._target.size()==1){c.getSubNode("ROTATE").css("display","");g.rotate(c._target.rotate())}else{c.getSubNode("ROTATE").css("display","none");g.rotate(0)}}}if(!c.regPool){c.regPool=xui()}if(n=c.regions){c.regPool.merge(n);n.css("display","none")}c.regions=xui();if(c.regionBlocks){var n,j=c.regionBlocks.length,l=function(w,u,x){var o=c.boxing(),r=o.getTarget(),q=xui.Event.$keyboard;if(c.onRegionClick&&false!==o.onRegionClick(c,u)){if(r._nodes.length>1){var s=xui.getNodeData(x,"_tid");if(q&&q.shiftKey){xui.arr.removeValue(r._nodes,s);o.resetTarget(r)}else{o.focus(s)}}}};xui.arr.each(c.regionBlocks,function(o){if(!c.regPool.isEmpty()){n=c.regPool._nodes.pop();xui(n).cssPos(o[0]).cssSize(o[1]);if(b){xui(n).rotate(j>1?o[3]:0)}}else{n=xui.str.toDom('<div style="position:absolute;cursor:default;border:dashed 1px blue;left:{l}px;top:{t}px;width:{w}px;height:{h}px;"></div>'.replace("{l}",o[0].left).replace("{t}",o[0].top).replace("{w}",o[1].width).replace("{h}",o[1].height));n.id(m+c.regPool._nodes.length);if(b){n.rotate(j>1?o[3]:0)}n.onClick(l);n=n.get(0).$xid}c.regions._nodes.push(n);xui.setNodeData(n,"_tid",o[2])});c.getRoot().append(c.regions.css("display",""))}});a.focus();return a},getTarget:function(){return this.get(0)._target},resetTarget:function(f,a){var b=this,d=b.get(0),e=b.reBoxing(),c;if(d.properties._attached){return}delete d.$focus;if(f&&!f.isEmpty()){d._target=f;b.rePosSize();e.css({zIndex:xui.Dom.TOP_ZINDEX,display:""})}else{d._target=xui();e.css({zIndex:0,display:"none"})}if(f&&!f.isEmpty()){c=[];f.reBoxing("UI").each(function(j,g){c.push(j.$xid)})}else{c=null}if(a!==false&&d.onItemsSelected){d.boxing().onItemsSelected(d,c,d.$xid)}if(d.onResetTarget){d.boxing().onResetTarget(d,c,d.$xid)}return b},focus:function(d){var c=this.get(0),b=-1;if(!c.regions){return}c.regions.css("border","dashed 1px blue");var a=c._target.get();if(d){b=xui.arr.subIndexOf(a,"id",d)}if(b==-1&&c.$focus!==undefined){b=c.$focus}if(b==-1&&a.length>1){b=a.length-1}if(b!=-1){c.regions.css("border","dashed 1px blue");xui([c.regions.get(b)]).css("border","solid 1px red");c.$focus=b;if(c.onFocusChange){c.boxing().onFocusChange(c,b)}}return this},getFocus:function(){return this.get(0).$focus},active:function(a){return this.each(function(b){b.getRoot().addClass("active");b.getSubNode("MOVE").css("backgroundPosition","-17px -244px");b.getSubNodes(["LT","T","RT","R","RB","B","LB","L"]).css("background",xui.browser.ie?"url("+xui.ini.path+"bg.gif)":"#fff");if(a!==false){b.boxing().onActive(b)}})},inActive:function(){return this.each(function(a){if(a.$onDrag){return}a.getRoot().removeClass("active");a.getSubNode("MOVE").css("backgroundPosition","-34px -244px");a.getSubNodes(["LT","T","RT","R","RB","B","LB","L"]).css("background","#808080")})}},Static:{DataModel:{dragArgs:null,leftOffset:0,topOffset:0},EventHandlers:{onActive:function(a){},onFocusChange:function(b,a){},onItemsSelected:function(b,a){},onResetTarget:function(b,a){},onRegionClick:function(a,b){},onDblclick:function(a,b,c){}},_onMousedown:function(g,q,b,s){g.boxing().active();if(xui.Event.getBtn(q)!="left"){return}var u=xui.Event.$keyboard,c=g.properties;if(g.properties.disabled&&!(u&&u.ctrlKey)){return false}if(u&&u.ctrlKey){g.boxing().resetTarget(null);var r=xui.Event.getPos(q);var j={dragDefer:2,dragType:"icon",targetLeft:r.left+12,targetTop:r.top+12,dragCursor:"pointer"};xui.merge(j,c.dragArgs,"all");j.widthIncrement=j.heightIncrement=0;j.dragData.pos=g.getRoot().cssPos();xui().startDrag(q,j)}else{var j,d,a,r,n,w;if(c._attached){r=xui.Event.getPos(q);xui.use(b).startDrag(q,{dragDefer:2,targetReposition:false,dragType:"blank",dragCursor:true,targetLeft:r.left,targetTop:r.top})}else{d=g.getRoot();a=d.offset();r=d.cssPos();n=xui.copy(r);if(s.move){a=xui.Event.getPos(q);if(c.dragArgs.widthIncrement){var f=c.leftOffset&&c.leftOffset%c.dragArgs.widthIncrement;r.left-=f;n.left-=f}if(c.dragArgs.heightIncrement){var f=c.topOffset&&c.topOffset%c.dragArgs.heightIncrement;r.top-=f;n.top-=f}}else{w=d.cssSize();if(s.left){if(s.top){}else{if(s.bottom){r.top=r.top+w.height}else{r.top=r.top+w.height/2}}}if(s.right){r.left=r.left+w.width;if(s.top){}else{if(s.bottom){r.top=r.top+w.height}else{r.top=r.top+w.height/2}}}if(s.top&&!s.left&&!s.right){r.left=r.left+w.width/2}if(s.bottom&&!s.left&&!s.right){r.left=r.left+w.width/2;r.top=r.top+w.height}}if((t=c.dragArgs)&&(t=t.widthIncrement)){var m=xui.DragDrop.$proxySize%t;if(s.left){r.left+=m}else{if(s.right){r.left+=m}else{if(s.move){r.left+=m}}}r.left+=parseInt((a.left-n.left)/t)*t}if((t=c.dragArgs)&&(t=t.heightIncrement)){var l=xui.DragDrop.$proxySize%t;if(s.top){r.top+=l}else{if(s.bottom){r.top+=l}else{if(s.move){r.top+=l}}}r.top+=parseInt((a.top-n.top)/t)*t}var j={dragDefer:2,targetReposition:false,dragType:"blank",dragCursor:true,targetLeft:r.left,targetTop:r.top};xui.merge(j,c.dragArgs,"all");j.targetOffsetParent=g._parent;j.dragKey=null;xui.use(b).startDrag(q,j)}}},LayoutTrigger:function(){this.boxing().rePosSize()}}});xui.Class("RAD","xui.Module",{Constructor:function(){var a=this,b=xui.message;arguments.callee.upper.apply(a,arguments);SPA=a;a.spath=null;a.tpath=null;a.curProjectPath=null;a.currentPage=null;a.currentClassName=null;a.currentRootCls=null;a.curProjectConfig=null;a.ViewMenuBar={};a.topMenuItems=xui.clone(CONF.SPATomMenu());a.componentMenuItems=[];a.toolbarItems=xui.clone(CONF.toolbarItems);a.Message=[];xui.message=function(c){if(!a.Message){return}if(a.Message.length>20){a.Message.pop()}c=xui.stringify(c);if(/</.test(c)){while(c!=(c=c.replace(/<[^<>]*>/g,""))){}}a.Message.unshift({id:xui.id(),caption:c.length>50?c.substr(0,50)+"...":c,tips:c,imageClass:"xuicon xui-uicmd-info"});a.toolbar.updateItem("info",{label:c.length>50?c.substr(0,50)+"...":c});b.apply(null,xui.toArr(arguments))};xui("body").css({height:"100%",overflow:"hidden"})},Instance:{fe:function(b,a){if(this.events[b]){return this.fireEvent(b,a)}},events:{beforeCreated:function(){xui.Dom.setCover('<img src="/RAD/img/loading.gif" border="0"/><div>Created</div>');var a=this},onLoadBaseClass:function(b,c,a){xui.Dom.setCover('<img src="/RAD/img/loading.gif" border="0"/><div>Load Base Class: '+a+"</div>")},onReady:function(b){var a=this;a.menubar.setItems(a.topMenuItems);a.menubar.selectItem(a.topMenuItems[0].id);this.toolbar.setItems(this.toolbarItems);a.prjtabs.append((new xui.UI.ToolBar()).setHost(a,"projecttool").setDisplay("none").setAutoIconColor(false).setHandler(false).onClick("_projecttool_onclick").setCustomStyle({ITEMS:{"border-width":"0 0 1px 0"},}),"prj");a.prjtabs.append((new xui.UI.TreeView()).setHost(a,"treebarPrj").setDynDestory(true).setOptBtn("xui-uicmd-opt").setDropKeys("xui.builder.pfjm").setDragKey("xui.builder.pfjm").onContextmenu("_treebarprj_oncontextmenu").onDblclick("_treebarprj_ondblclick").onGetContent("_treebarprj_onGetContent").onShowOptions("_treebarprj_onshowopt").onClick("_treebarprj_onclick").onItemSelected("_treebarprj_onitemselected").afterFold("_treebarprj_fold").onDropTest("__ondroptest").onDrop("__ondrop").beforeDrop("__beforedrop").setCustomStyle({RULER:{"font-size":"1.5em"}}),"prj");xui.ModuleFactory.setProfile(CONF.ModuleFactoryProfile);if(this.projecttool){this.projecttool.setItems(CONF.projecttool)}if(CONF.customUI){CONF.customUI(this)}},onRender:function(b){var a=this;b.$infoList=new xui.UI.List({width:400}).setCustomStyle("ITEM","border-bottom:dashed 1px gray");a.openProject();xui.win.onKeypress(function(g,f){var c=xui.Event.getKey(f),d=c.ctrlKey;if(d&&k=="s"){a._menubar_onclick(a.menubar.get(0),null,{id:"save"});return false}})}},openProject:function(){var a=this;if(currProjectName){CONF.openProject(currProjectName,a._openproject,a._openclsfolder,function(){},a)}else{xui.ModuleFactory.getModule("prjSel",function(){this.setProperties({onOK1:a._openproject,onOK2:a._openclsfolder,namespace:a});this.show(xui("body"))})}},showFirstPage:function(){var a=this;xui.showModule("RAD.ProjectPro",function(){this.setProperties({onOK1:a._openproject,onOK2:a._openclsfolder,namespace:a})},null,null,true)},_getpagename:function(a){return a=="index.cls"?xui.adjustRes("$(RAD.pm.Start Page)",true):xui.str.endWith(a,".cls")?(a.replace(".cls","")+" "+xui.adjustRes("$RAD.pm.Page",true)):a},_addfile:function(e,c,b,g,d){var j=this,o=j.treebarPrj,l=b.split("."),m=l[1]?CONF.getImageTag(l[1]):null,n={id:c,name:b,caption:b,imageClass:m,value:c,sub:g=="/"?[]:null},f=[n];if(g!=="/"&&d!==false){j._openfile(n)}if(o&&o.getItemByItemId(e)){o.insertItems(f,e)}o.selectItem(n.id)},_delfile:function(g){var f=this,d=this.treebarPrj,e=this.tabsMain,b=g.split(";"),c=[];xui.arr.each(b,function(j,a){c[a]=j});xui.Ajax(CONF.delFile,{paths:g,projectName:SPA.curProjectName},function(j){var m=j;if(m&&!m.error&&m.requestStatus!=-1){if(d){d.removeItems(b)}var l=e.getItems(),a=[];xui.arr.each(l,function(n){if(xui.str.startWith(n.id,g)){a.push(n.id)}},null,true);e.removeItems(a);if(g==f.curProjectPath){f._closeproject(null,true)}if(d&&!d.getUIValue()){f._updateFileToolbar(null,"prj")}}else{xui.message(xui.get(m,["error","errdes"])||m||"no response!")}},null,null,{method:"POST"}).start()},_projecttool_onclick:function(a,f,c,b,d){this._fileaction(null,f.id,d,"prj")},_fileaction:function(f,e,b,s){var u=this,j=u.treebarPrj,l=j;if(!this.curProjectPath){xui.message(xui.getRes("RAD.ps.noprj"));return}if(!f){var x=l.getUIValue();if(x){f=l.getItemByItemId(x)}}if(!f){if(e!="del2"&&e!="new2"){var q=l.getItems();if(q[0]){f=q[0]}if(!f){return}}}switch(e){case"editastext":u._openfile(f,b,false,true,true);break;case"explore":CONF.showInExplore(f?f.id:u.curProjectPath);break;case"newFolder":xui.showModule("RAD.AddFile",function(){this.setProperties({fileName:c,parentPath:f.id,typeCaption:"$RAD.esdmenu.newFolder",type:"/",forcedir:true,tailTag:""});this.setEvents({onOK:function(A){try{u.dialog.hide()}catch(B){}A.sub=true;A.id=A.location;A.value=A.location;var a=j;if(a&&(f=a.getItemByItemId(f.id))){a.insertItems([A],f.id,true)}}})},null,null,true);break;case"newClass":xui.showModule("RAD.AddFile",function(){this.setProperties({fileName:"Page",parentPath:f.id,typeCaption:".cls",type:"class",forcedir:true,tailTag:".cls"});this.setEvents({onOK:function(A){try{u.dialog.hide()}catch(B){}var a=j;if(a&&(f=a.getItemByItemId(f.id))){A.caption=A.name?A.name:A.caption;a.insertItems([A],f.id,true)}A.value=A.id;u._openfile(A,A.path,false,true,true)}})},null,null,true);break;case"upload":var n=f.id;var o=CONF.uploadPath;var d={uploadUrl:CONF.upload,projectName:SPA.curProjectName,uploadpath:n};var g=xui.create("xui.UI.Dialog").setLeft("8.333333333333334em").setTop("5.833333333333333em").setWidth("40.833333333333336em").setHeight("30em").setIframeAutoLoad(o+"?uploadUrl="+CONF.upload+"&projectName="+SPA.curProjectName+"&uploadpath="+n).setCaption("$RAD.addfile.iUpload").setMaxBtn(false).beforeClose(function(){}).setMaxBtn(false);if(window.postMessage){self._msgcb=function(D){try{D=D.data;D=xui.unserialize(D);if(D.data){var C=D.data;var A=j;if(A&&(f=A.getItemByItemId(f.id))){var B=C.name.split(".");B=B.length==1?"":(B[B.length-1].toLowerCase());C.imageClass=CONF.getImageTag(B);C.value=C.location;A.insertItems([C],f.id,true)}}}catch(D){}};if(window.addEventListener){window.addEventListener("message",self._msgcb,false)}else{window.attachEvent("onmessage",self._msgcb)}}g.show();break;case"import":xui.showModule("RAD.ProjectTree",function(){this.setData({tpath:f.id});this.setEvents({onOK:function(A){var a=j;xui.each(A,function(B){if(a&&(f=a.getItemByItemId(f.id))){a.insertItems([B],f.id,false)}})}});this.initData();this._fireEvent("afterShow")},null,null,true);break;case"importModule":xui.showModule("RAD.ProjectModuleTree",function(){this.setData({tpath:f.id});this.setEvents({onOK:function(A){var a=j;xui.each(A,function(B){if(a&&(f=a.getItemByItemId(f.id))){a.insertItems([B],f.id,false)}})}});this.initData();this._fireEvent("afterShow")},null,null,true);break;case"paste2":xui.showModule("RAD.AddFile",function(){this.setProperties({fileName:"Page",parentPath:f.id,typeCaption:".cls",type:"class",forcedir:true,tailTag:".cls"});this.setEvents({onOK:function(A){try{u.dialog.hide()}catch(B){}var a=j;if(a&&(f=a.getItemByItemId(f.id))){A.caption=A.name?A.name:A.caption;a.insertItems([A],f.id,true)}A.value=A.id;u._openfile(A,A.path,false,true,true)}})},null,null,true);break;case"paste":xui.Ajax(CONF.copy,{spath:u.spath,forcedir:true,tpath:f.id,projectName:SPA.curProjectName},function(A){var C=A;if(C&&!C.error&&C.requestStatus!=-1){var B=C.data;item={id:B.location,name:B.name,caption:B.name,className:B.className,imageClass:B.imageClass,value:B.location};if(xui.str.endWith(B.id,".cls")){var a=j;if(a&&(f=a.getItemByItemId(f.id))){a.insertItems([item],f.id)}u._openfile(item,item.path,false,true,true)}else{if(xui.str.endWith(B.id,"/")){item.sub=true;var a=j;if(a&&(f=a.getItemByItemId(f.id))){a.insertItems([item],f.id)}}else{var a=j;if(a&&(f=a.getItemByItemId(f.id))){a.insertItems([item],f.id)}}}u.spath=null}else{xui.message(xui.get(C,["error","errdes"])||C||"no response!")}},function(a){xui.message(xui.get(a,["error","errdes"])||a||"no response!")},null,{method:"POST"}).start();break;case"copy2":u.spath=f.id;break;case"rename":var c=f.name,m="";if(!f.sub){var w=c.split("."),m="."+w.pop();c=w.join(".")}var r=xui.prompt(xui.getRes("RAD.designer.Rename"),xui.getRes("RAD.Specify the new name")+(m?("("+m+")"):""),c,function(D){if(D){D=xui.str.trim(D)}D+=m;if(!CONF.fileNames.test(D)){xui.message(xui.getRes("RAD.addfile.filenameformat"));return false}else{var C=f._pid;if(!xui.str.endWith(C,"/")){C=C+"/"}var B=f.id,C=C+D,a=D,A;xui.Ajax(CONF.reName,{path:B,projectName:SPA.curProjectName,newName:a},function(H){var E=H;if(E&&!E.error&&E.requestStatus!=-1){var F=E.data;var O={id:F.location,name:F.name,caption:F.name,className:F.className,imageClass:F.imageClass,path:F.location,value:F.location};if(f.sub){if(SPA.curProjectPath==f.id){SPA.curProjectPath=C;SPA.curProjectName=a}var I=[],M=function(P){var Q=M;if(xui.isArr(P)){xui.arr.each(P,function(S,R){I.push(S.id);if(S.sub){Q(S.sub)}})}Q=null};M(f.sub);l.removeItems(I);I=[];var K=s=="prj"?ins2:j;var G=K.getItemByItemId(f.id);if(G&&G.sub&&G.sub.length){M(G.sub);K.removeItems(I)}if(j){j.updateItem(B,{id:C,value:C,loacation:C,name:a,caption:a,_inited:false,sub:true})}ins2.updateItem(B,{id:C,value:C,loacation:C,name:a,caption:u._getpagename(a),_inited:false,sub:true});var L=u.tabsMain.getItems(),N=[];xui.arr.each(L,function(P){if(!l.getSubIdByItemId(P.id)){N.push(P.id)}},null,true);if(N&&N.length){u.tabsMain.removeItems(N)}}else{O.imageClass=CONF.getImageTag(C);if(j){j.updateItem(B,xui.clone(O))}ins2.updateItem(B,xui.clone(O));var J=u.tabsMain.getItemByItemId(B);if(J){u.closeFile(B);u._openfile(O,O.path,false,true,true)}}xui.message(xui.getRes("$RAD.designer.msg.renamefileok"))}else{xui.message(xui.get(E,["error","errdes"])||E||"no response!")}},null,null,{method:"POST"}).start()}});r._$input.setMultiLines(false);r=null;break;case"del2":if(f){xui.confirm(xui.getRes("RAD.delfile.confirmdel"),xui.getRes("RAD.delfile.confirmdel2","1"),function(){u._delfile(f.id)})}else{xui.ModuleFactory.getModule("delFile",function(){this.host=u;this.setProperties({fromRegion:xui(b).cssRegion(true),parent:u,onOK:u._delfile});this.show(xui("body"))})}break;case"refresh":CONF.openProject(u.curProjectName,u._openproject,null,function(){xui.message(xui.getRes("RAD.tool2.refreshOK"))},u,true);break}},_dirtyWarn:function(e){var d=this,c,a=this.tabsMain,b=a.getItems();xui.arr.each(b,function(f){if(f._dirty){return !(c=true)}});if(c){xui.UI.Dialog.confirm(xui.getRes("RAD.notsave"),xui.getRes("RAD.notsave3"),e)}else{e()}},_setproject:function(){xui.getModule("RAD.project.ProjectInfo",function(){this.setData({projectName:SPA.curProjectName});this.show();this.initData();this._fireEvent("afterShow")})},_closeproject:function(j,a){var g=this,f,c=this.tabsMain,d=c.getItems(),e=this.treebarPrj;xui.arr.each(d,function(l){if(l&&l._dirty){return !(f=true)}});var b=function(){g._resetPrjEnv();var n=CONF.getStatus(),m=n.projects||(n.projects=[]),l=xui.arr.subIndexOf(m,"id",g.curProjectPath);if(l!=-1){xui.arr.removeFrom(m,l)}if(!a){m.push({caption:g.curProjectName,id:g.curProjectPath,file:c.getUIValue(),files:c.getItems("min")});if(m.length>=10){m.shift()}}CONF.saveStatus(n);c.clearItems();if(e){e.clearItems()}xui.Class.__gc("Module");xui.$cache.clsByURI={};xui.$cache.fetching={};g.curProjectPath=g.curProjectName=g.currentPage=g.currentRootCls=g.curProjectConfig=null;if(typeof j=="function"){j()}if(g.projecttool){g.projecttool.setDock("none").setDisplay("none")}if(e){e.adjustDock(true)}if(g._toolbox){g._toolbox.clearContent()}if(g._servicebox){g._servicebox.clearContent()}window["/"]=undefined;document.title=document.title.replace(/\s*\[.*\]\s*$/,"")};if(f){xui.UI.Dialog.confirm(xui.getRes("RAD.notsave"),xui.getRes("RAD.notsave2"),b)}else{b()}},_tabsmain_beforepageclose:function(a,b,c){if(b._dirty){xui.UI.Dialog.confirm(xui.getRes("RAD.notsave"),xui.getRes("RAD.notsave2"),function(){a.boxing().removeItems(b.id)});return false}},_tabsmain_afterpageclose:function(a,b,c){if(b.$obj){b.$obj.destroy()}SPA.currentPage="";SPA.currentClassName=""},_tabsmain_beforeValueUpdated:function(d,c,a){var e=this.tabsMain.getItemByItemId(c),b;if(!e){return}if(b=e.$obj){if(b.checkEditorCode&&b.checkEditorCode()===false){return false}}},_tabmain_onitemselected:function(a,b,c,d){if(b._inn){a.boxing().setDisabled(true);a.boxing().append(b._inn,b.id);delete b._inn}xui.tryF(function(){if(b.$obj){b.$obj.activate()}});SPA.currentPage=b.id;SPA.currentClassName=b.className},_treebarprj_oncontextmenu:function(a,c,d,b){if(b){this._treebarprj_onshowopt(a,b,c,d);return false}},_treebarprj_onshowopt:function(f,g,j,l){var d=this,c=f.boxing(),b;if(g){b=[{id:"del2",imageClass:"xuicon xui-icon-minus",caption:"$RAD.tool2.del2"},{id:"split",type:"split"}];if(g&&!g.sub){b.push({id:"editastext",imageClass:"spafont spa-icon-astext",caption:"$RAD.tool2.editastext"})}b.push({id:"refresh",imageClass:"xuicon xui-refresh",caption:"$RAD.tool2.refresh"});b.unshift({id:"rename",imageClass:"spafont spa-icon-rename",caption:"$RAD.tool2.modify"});if(g.sub){b.unshift({id:"upload",imageClass:"fa fa-file-o",caption:"$RAD.esdmenu.upload"});if(xui.str.startWith(g.id,"Module")){b.unshift({id:"importModule",imageClass:"fa fa-file-o",caption:"$RAD.esdmenu.importModule"})}else{b.unshift({id:"import",imageClass:"fa fa-file-o",caption:"$RAD.esdmenu.import"})}b.unshift({id:"newFolder",imageClass:"fa fa-folder-o",caption:"$RAD.esdmenu.newFolder"});b.unshift({id:"newClass",imageClass:"xuicon xui-uicmd-add",caption:"$RAD.esdmenu.newClass"});b.unshift({id:"copy2",imageClass:"spafont spa-icon-copy",caption:"",caption:"$RAD.tool2.copy2"});if(d.spath){b.unshift({id:"paste",imageClass:"spafont spa-icon-paste",caption:"$RAD.esdment.paste",tip:"$RAD.esdment.paste"})}}else{b.unshift({id:"copy2",imageClass:"spafont spa-icon-copy",caption:"",caption:"$RAD.tool2.copy2"})}}else{b=[{id:"refresh",imageClass:"xuicon xui-refresh",caption:"$RAD.tool2.refresh"},{id:"new",imageClass:"xuicon xui-uicmd-add",caption:"$RAD.tool2.new2"},{id:"del",imageClass:"xuicon xui-icon-minus",caption:"$RAD.tool2.del2"}]}var a=new xui.UI.PopMenu({items:b});a.onMenuSelected(function(m,e,n){d._fileaction(g,e.id,g?c.getSubNodeByItemId("BAR",g.id):null,"prj");a.destroy()});a.pop(xui.Event.getPos(j));return false},_treebarprj_onGetContent:function(b,c,d){var a=this;xui.Ajax(CONF.openFolderService,{path:c.id,projectName:SPA.curProjectName},function(e){var g=e;if(g&&!g.error){isxuipage=false;var f=a.buildFileItems(c.id,g.data.files||g.data,isxuipage?function(j){return !(j.type&&!xui.str.endWith(j.name,".js")&&!xui.str.endWith(j.name,".cls")&&!xui.str.endWith(j.name,".html")&&!xui.str.endWith(j.name,".vv"))}:null,isxuipage);d(f.sub)}else{xui.message(xui.get(g,["error","errdes"])||g||"no response!")}},null,null,{method:"POST"}).start()},_treebarprj_ondblclick:function(a,b,c,d){if(!b.sub){this._openfile(b,d)}},openFile:function(a){this._openfile({id:a,value:a,name:a.split("/").pop()})},closeFile:function(c){var b=this,a=b.tabsMain;if(a.getItemByItemId(c)){a.removeItems([c])}},getSelected:function(){return this._getSelected()},_openfile:function(u,e,r,o,q){if(!u.id||u.sub){return}var x=this,j=x.treebarPrj,b=u.className;if(b&&xui.str.endWith(b,".cls")){b=b.replace(".cls","")}a=u.name.split("."),type=a[a.length-1],isText=false;if(!q){if(!isText){if(!CONF.getRenderMode(type)&&type.indexOf("VVVERSION")==-1){CONF.openFile(u.id);return}}}var m=u.value;if(!m){m=u._pid+"/"+u.name}var a=m.split("/"),n=a[a.length-1],s=xui.str.startWith(m,SPA.curProjectPath+"/"+x.currentRootCls+"/js/")?x._getpagename(n):n,A=n.split("."),w=A[A.length-1],d=CONF.getImageTag(w);var g=x.tabsMain,f=g.reBoxing().cssRegion(true);if(g.getItemByItemId(m)&&!g._dirty){g.fireItemClickEvent(m)}else{var l=function(B){if(B.error){return}if(!B.data||!B.data.content){return}var D=B.data.content;if(xui.isSet(D)){var E={id:m,tips:m,caption:s,closeBtn:true,className:b,imageClass:d,panelBgImg:"/RAD/img/loading.gif",panelBgImgPos:"center center",panelBgImgRepeat:"no-repeat"},C=g.getItems(),F=E.id,G=function(I,H){g.markItemCaption(I.properties.keyId,H)};if(!g.getItemByItemId(m)){g.insertItems([E],C.length?C[C.length-1].id:null)}if(w!="js"&&w!="cls"){xui.ModuleFactory.newModule("RAD.PageEditor",function(){var I=this;I.host=x;I.setType(w);I.setProperties({keyId:F});I.setEvents("onValueChanged",G);I.setEvents("onCommandSave",function(J){x._menubar_onclick(x.menubar.get(0),null,{id:"save"})});I.setEvents("afterRendered",function(){g.setDisabled(false)});I.setValue(D);var H=g.getItemByItemId(F);H.$obj=I;H._inn=I;if(!r){g.fireItemClickEvent(m)}})}else{xui.ModuleFactory.newModule("RAD.JSEditor",function(){var K=this;K.buttonview.setNoHandler(true);var I=x.tabsMain;K.host=x;K.setProperties({keyId:F});K.setEvents("onValueChanged",G);K.setEvents("onCommandSave",function(M){x._menubar_onclick(x.menubar.get(0),null,{id:"save"})});K.setEvents("afterRendered",function(){I.setDisabled(true);var M=K._designer;var N=I.getItemByItemId(F);N.$obj=K;xui.setTimeout(function(){try{if(M.getWidgets()&&M.getWidgets().length>0){var P=M.getJSCode(M.getWidgets(true));M.markDirty(true);M.resetCodeFromDesigner(true);M.refreshView(P,true);M.markDirty(false);I.markItemCaption(F,false,true)}}catch(O){console.warn(O)}I.setDisabled(false)},500)});var L=RAD.ClassTool.getClassName(D),H=RAD.ClassTool.getClassName(D,true);if(L&&H&&!q){K.setDftPage("design")}else{K.setDftPage("code")}K.setValue(D);var J=I.getItemByItemId(F);J.$obj=K;J._inn=K;if(!r){I.fireItemClickEvent(m)}})}if(j){j.setUIValue(m)}}},c=function(B){if(!o){xui.message(B)}};xui.Ajax(CONF.getFileContent,{path:m,className:b,projectName:SPA.curProjectName},l,c,{method:"POST"}).start()}},iniComponents:function(){var d=this,c=this,b=[],a=function(e){b.push(e.get(0))};a((new xui.UI.MenuBar()).setHost(d,"menubar").setDockOrder("1").setAutoShowTime(0).setHandler(false).setValue("file").onMenuBtnClick("_menubar_onMenuBtnClick").onMenuSelected("_menubar_onclick").setCustomStyle({BORDER:{"background-color":"#3498DB",border:"0px"},LIST:{padding:"0px"},ITEM:{margin:"0 1em -0.125em 1em","padding-left":"1em","padding-right":"1em"},ITEMS:{color:"#f6f6f6","background-color":"#3498DB"}}));a(xui.create("xui.UI.Div").setHost(d,"topbar").setDock("top").setHeight("4em").setZIndex(10).setCustomStyle({KEY:{"background-color":"#3498DB"}}));d.topbar.append(xui.create("xui.UI.Div").setHost(d,"xui_ui_div22").setHoverPop("xui_ui_svgpaper1").setLeft("12.878787878787879em").setTop("0.9375em").setWidth("8.75em").setHeight("2.5em"));d.xui_ui_div22.append(xui.create("xui.UI.Span").setHost(d,"xui_ui_space").setWidth("1em").setTabindex(2).setPosition("static"));d.xui_ui_div22.append(xui.create("xui.UI.Label").setHost(d,"xui_ui_label3").setTabindex(3).setPosition("static").setCaption("管理员").setCustomStyle({KEY:{color:"#FFFFFF"}}));a(xui.create("xui.UI.SVGPaper").setHost(d,"xui_ui_svgpaper1").setLeft("4.375em").setTop("3.75em").setWidth("11.25em").setHeight("1.375em").setZIndex(1002).setOverflow("visible").setGraphicZIndex(2));d.xui_ui_svgpaper1.append(xui.create("xui.UI.List").setHost(d,"xui_ui_list8").setDirtyMark(false).setItems(CONF.teamBar).onItemSelected("_topmenu_onitemselected").setLeft("0.625em").setTop("1.25em").setWidth("9.84848484848485em").setHeight("auto").setSelMode("none").setValue(""));d.xui_ui_svgpaper1.append(xui.create("xui.svg.path").setHost(d,"xui_svg_path1").setSvgTag("Shapes:Triangle").setAttr({path:"M,21,21L,28,1L,51,21",fill:"#ffffff",stroke:"#B6B6B6"}));d.xui_ui_div22.append(xui.create("xui.UI.Label").setHost(d,"xui_ui_label4").setLeft("0em").setTabindex(4).setPosition("static").setCaption("").setImageClass("xui-icon-sort-checked").setCustomStyle({KEY:{color:"#FFFFFF"}}));d.topbar.append(xui.create("xui.UI.Icon").setHost(d,"xui_ui_icon9").setLeft("10.606060606060607em").setTop("0.7575757575757576em").setWidth("3.0303030303030303em").setHeight("2.272727272727273em").setImageClass("spafont spa-icon-login").setIconFontSize("2em"));d.topbar.append(xui.create("xui.UI.Gallery").setHost(d,"xui_ui_gallery3").setItems(CONF.navBar).setTop("0.6875em").setWidth("16em").setHeight("5em").setRight("0em").setSelMode("none").setBorderType("none").setIconOnly(true).setValue("").onClick({actions:[{args:["{page.xui_ui_svgpaper10.popUp()}"],conditions:[{symbol:"=",right:"a",conditionId:"a_equal_{args[1].id}",left:"{args[1].id}"}],desc:"Action1",method:"popUp",redirection:"other:callback:call",target:"xui_ui_svgpaper10",type:"control"}]}).setCustomStyle({FLAG:{margin:"-12px -48px 0px 0px","font-size":"8px"},ICON:{"font-size":"3em"},ITEM:{"background-color":"transparent"},ITEMS:{"background-color":"transparent",overflow:"hidden"}}));d.topbar.append(xui.create("xui.UI.Label").setHost(d,"xui_ui_label28").setLeft("4.545454545454546em").setWidth("3.8636363636363638em").setHeight("1.2121212121212122em").setCaption("CodeBee").setHAlign("center").setFontColor("#FFFFFF").setFontSize("1.5em"));d.topbar.append(xui.create("xui.UI.Image").setHost(d,"xui_ui_image4").setLeft("0.7575757575757576em").setTop("0.5em").setWidth("2.621212121212121em").setHeight("2.636363636363638em").setSrc("/RAD/img/staticjds.gif").setTips("保存").onClick("jdsicon_onclick").setCustomStyle({KEY:{opacity:0.75}}));a((new xui.UI.ButtonViews()).setHost(d,"mainLayout").setBarLocation("right").setBarSize("7em").setSideBarStatus("fold").setItems([{id:"xuimain",caption:"页面编辑",imageClass:"spafont spa-icon-page"},{id:"java",caption:"JAVA编辑",imageClass:"spafont spa-icon-hash"},{id:"dsmDesigner",caption:"领域设计",imageClass:"iconfont iconchangjingguanli"},{id:"dsmConfig",caption:"领域配置",imageClass:"bpmfont bpmgongzuoliuxitongpeizhi"}]).onItemSelected(function(f,g){if(g.id=="java"&&!g.className){var e="Debug.dsmconfig.BuildTree";xui.showModule2("Debug.dsmconfig.BuildTree","mainLayout","java",{projectVersionName:currProjectName,projectName:currProjectName});g.className=e}else{if(g.id=="dsmDesigner"&&!g.className){var e="Debug.dsmconfig.DSMInstNavTree";xui.showModule2(e,"mainLayout","dsmDesigner",{projectVersionName:currProjectName,projectName:currProjectName});g.className=e}else{if(g.id=="dsmConfig"&&!g.className){var e="Debug.dsmconfig.ModuleTree";xui.showModule2(e,"mainLayout","dsmConfig",{projectVersionName:currProjectName,projectName:currProjectName});g.className=e}}}}).setOverflow("none").setValue("xuimain"),"main");d.mainLayout.append((new xui.UI.Block()).setHost(d,"mainPanel").setDock("fill"),"xuimain");d.mainPanel.append((new xui.UI.Layout()).setHost(d,"layout").setItems([{id:"before",pos:"main",locked:false,size:260,min:50,max:800,cmd:true,hide:false,folded:false,hidden:false},{id:"main",min:10}]).setCustomStyle({MOVE:{"background-color":"transparent"}}).setType("horizontal"));d.layout.append((new xui.UI.ButtonViews()).setHost(d,"prjtabs").setNoHandler(true).setItems([{id:"prj",caption:"$RAD.toolbox.prj",imageClass:"spafont spa-icon-project"}]).setOverflow("none").setValue("prj"),"before");d.layout.append((new xui.UI.Tabs()).setHost(d,"tabsMain").beforeUIValueSet("_tabsmain_beforeValueUpdated").beforePageClose("_tabsmain_beforepageclose").afterPageClose("_tabsmain_afterpageclose").onItemSelected("_tabmain_onitemselected").setCustomStyle({PANEL:"overflow:hidden;"}),"main");xui.newModule("RAD.ToolBox",function(){this.dlg.show(d.mainPanel,null,0,30);c._toolbox=this});d.mainLayout.append((new xui.UI.ToolBar()).setHost(d,"toolbar").setDockOrder("2").setAutoIconColor(false).onClick("_toolbar_onclick").setHandler(false).setIconFontSize("2em").setCustomStyle({GROUP:{height:"90px"},BOXWRAP:{display:"block",},ITEMS:{"background-color":"#f6f6f6"}}));return b},_topmenu_onitemselected:function(d,f,g,j,c){var b=this,a=d.boxing();this._menubar_onclick(null,null,f,j,false)},_treebarprj_fold:function(b){var a=b.boxing();if(!a.getUIValue()){this._updateFileToolbar(null,"prj")}},_treebarprj_onitemselected:function(b,c,d,f,a){this._updateFileToolbar(c,"prj")},_treebarprj_onclick:function(a,b){if(b.sub){a.boxing().toggleNode(b.id,true)}},_ontvcmd:function(c,d,e){var a=xui.get(SPA.curProjectConfig,["$DevEnv","designViewConf","width"])||1280,b=xui.get(SPA.curProjectConfig,["$DevEnv","designViewConf","height"])||1024,f=xui.get(SPA.curProjectConfig,["$DevEnv","designViewConf","touchDevice"])||0;CONF.debugApp("/debug/"+SPA.curProjectName+"/",xui.getClassName(d.id),{rand:xui.rand(),touch:f,width:a,height:b,cls:xui.getClassName(d.id),theme:xui.getTheme(),lang:xui.getLang()},true)},_treebarprj_onitemselected2:function(b,c,d,f,a){this._updateFileToolbar(c,"cls")},_updateFileToolbar:function(e,d){var c=this,b={hidden:!e||!!e.sub},a=c.projecttool;a.updateItem("rename",b);a.updateItem("copy2",b);a.updateItem("editastext",b)},_toolbar_onclick:function(c,j,f,d,g){var b=this;if(j.sub&&j.sub.length>0){var a=new xui.UI.PopMenu({items:j.sub},{onMenuSelected:function(l,e){b._toolbar_onclick(l,e,f,g)}});a.setCustomStyle({ICON:"font-size:1.2em;",ITEM:"background-color:#F6F6F6;"});a.pop(g)}else{if(xui.str.startWith(j.id,"xui.")&&j.draggable){this._addComponent(j);return}else{this._menubar_onclick(null,null,j,g,false)}}},buildFileItems:function(m,d,b,c){d=d.files||d;var j=this,g=m.split("/"),a=g[g.length-1],e,l,f;hash={"*":{id:m,name:a,caption:a,iconColor:"#1f8d9b",imageClass:"fa fa-bank",value:m,sub:[],iniFold:false}};d.sort(function(n,o){return n.layer<o.layer?1:n.layer==o.layer?(n.type>o.type?1:n.type==o.type?(n.name=="index.cls"?-1:o.name=="index.cls"?1:n.location>o.location?1:-1):-1):-1});xui.arr.each(d,function(q){if(b&&b(q)===false){return}if(!q.type){e=undefined}else{var n=q.name.split(".");n=n.length==1?"":(n[n.length-1].toLowerCase());l=CONF.getImageTag(n,c)}hash[q.id]={id:q.location,name:q.name,autoItemColor:q.autoItemColor,autoFontColor:q.autoFontColor,autoIconColor:q.autoIconColor,iconColor:q.iconColor,fontColor:q.fontColor,itemColor:q.itemColor,caption:c?j._getpagename(q.name):q.name,imageClass:q.imageClass,className:q.className,value:q.location,iniFold:q.iniFold,sub:q.sub};if(!q.type){hash[q.id].sub=true;hash[q.id].tips="$(RAD.designer.Click to expand) "+q.name}else{hash[q.id].tips="$(RAD.designer.Double click to open) "+q.name}if(c&&q.type){hash[q.id].tagCmds=[{id:"preview",tips:"$RAD.JSEditor.Preview",type:"text",sub:true,caption:"",itemClass:"spafont spa-icon-preview"}]}if(!q.pid){q.pid="*"}hash[q.pid].sub.push(hash[q.id])});return hash["*"]},_resetPrjEnv:function(){var b=this,a={"background-image":"url("+xui.getPath("/RAD/img/designer/","bg.gif")+")","background-position":"left top","background-repeat":"repeat","background-color":"","background-attachment":""};b.tabsMain.setSandboxTheme("");xui.CSS.addStyleSheet(xui.UI.buildCSSText({".xui-designer-root .xui-designer-canvas":a}),"xui.UI.design",null,true);xui("head").querySelectorAll('link[id^="xui_app_fscdn-"]').remove(true);xui.CSS.setStyleRules(".xui-desinger-canvas .xui-custom",null,true);try{xui.each(RAD.Designer.getAllInstance(),function(d){if(d.canvas){d.setMobileFrame(false)}})}catch(c){}xui.UI.__resetDftProp_in_Desinger=null;xui.arr.each(xui.Class._all,function(d){if(/^xui\.UI\./.test(d)){if(d=xui.get(window,d.split("."))){d.__resetDftProp_in_Desinger=null}}})},refreshProjectConfig:function(m,f){var e=this,l="xuiconf.js",c,g,d,b,a={"background-image":"url("+xui.getPath("/RAD/img/designer/","bg.gif")+")","background-position":"left top","background-repeat":"repeat","background-color":"","background-attachment":""},j=function(x){x=xui.replace(x,[[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"$0"],[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[/\/\*[^*]*\*+([^\/][^*]*\*+)*\//,""]]);d=x.split(/\s*\/\/ \[\[Page Appearance\s*\n|\n\s*\/\/ \]\]Page Appearance\s*/);if(d.length==3){c=d[1];g=null;try{b=/^\s*xui\.ini\.\$PageAppearance\s*\=\s*/;if(b.test(c)){c=xui.replace(c,[[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"$0"],[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[b,""],[/;\s*$/,""],[/\/\/[^\n]*/,""]]);g=xui.unserialize(c)}}catch(w){xui.alert(w+"<br><br>File => "+l+"<br><br>at : xui.ini.$PageAppearance = ...");return}if(typeof g==="object"&&g!==null){e.curProjectConfig.$PageAppearance=g;if(g.theme){e.tabsMain.setSandboxTheme(g.theme,true,'[class~="xui-designer-inner-control"]')}if(g.background&&xui.isHash(g.background)){var u=xui.clone(a);xui.each(g.background,function(B,A){u[A]=xui.adjustRes(B)});xui.CSS.addStyleSheet(xui.UI.buildCSSText({".xui-designer-root .xui-designer-canvas":u}),"xui.UI.design",null,true)}}}d=x.split(/\s*\/\/ \[\[Font Icons CDN\s*\n|\n\s*\/\/ \]\]Font Icons CDN\s*/);if(d.length==3){c=d[1];g=null;try{b=/^\s*xui\.ini\.\$FontIconsCDN\s*\=\s*/;if(b.test(c)){c=xui.replace(c,[[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"$0"],[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[b,""],[/;\s*$/,""],[/\/\/[^\n]*/,""]]);g=xui.unserialize(c)}}catch(w){xui.alert(w+"<br><br>File => "+l+"<br><br>at : xui.ini.$FontIconsCDN = ...");return}if(typeof g==="object"&&g!==null){e.curProjectConfig.$FontIconsCDN=g;xui.each(g,function(C,B){if(C.href){var A={crossorigin:"anonymous"};xui.merge(A,C,function(D,E){return E!=="href"});xui.CSS.includeLink(xui.adjustRes(C.href),"xui_app_fscdn-"+B,false,A)}})}}d=x.split(/\s*\/\/ \[\[Element Style\s*\n|\n\s*\/\/ \]\]Element Style\s*/);if(d.length==3){c=d[1];g=null;try{b=/^\s*xui\.ini\.\$ElementStyle\s*\=\s*/;if(b.test(c)){c=xui.replace(c,[[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"$0"],[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[b,""],[/;\s*$/,""],[/\/\/[^\n]*/,""]]);g=xui.unserialize(c)}}catch(w){xui.alert(w+"<br><br>File => "+l+"<br><br>at : xui.ini.$ElementStyle = ...");return}if(typeof g==="object"&&g!==null){e.curProjectConfig.$ElementStyle=g;xui.CSS.setStyleRules(".xui-desinger-canvas .xui-custom",g,true)}}d=x.split(/\s*\/\/ \[\[Default Prop\s*\n|\n\s*\/\/ \]\]Default Prop\s*/);if(d.length==3){c=d[1];g=null;try{b=/^\s*xui\.ini\.\$DefaultProp\s*\=\s*/;if(b.test(c)){c=xui.replace(c,[[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"$0"],[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[b,""],[/;\s*$/,""],[/\/\/[^\n]*/,""]]);g=xui.unserialize(c)}}catch(w){xui.alert(w+"<br><br>File => "+l+"<br><br>at : xui.ini.$DefaultProp = ...");return}if(typeof g==="object"&&g!==null){e.curProjectConfig.$DefaultProp=g;var s={},o;xui.each(g,function(B,A){if(/^xui\.UI\./.test(A)&&xui.isHash(B)&&(o=xui.get(window,A.split(".")))){o.__resetDftProp_in_Desinger=B}else{s[A]=B}});if(!xui.isEmpty(s)){xui.UI.__resetDftProp_in_Desinger=s}}}d=x.split(/\s*\/\/ \[\[Develop Env Setting\s*\n|\n\s*\/\/ \]\]Develop Env Setting\s*/);if(d.length==3){c=d[1];g=null;try{b=/^\s*xui\.ini\.\$DevEnv\s*\=\s*/;if(b.test(c)){c=xui.replace(c,[[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"$0"],[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[b,""],[/;\s*$/,""],[/\/\/[^\n]*/,""]]);g=xui.unserialize(c)}}catch(w){xui.alert(w+"<br><br>File => "+l+"<br><br>at : xui.ini.$DevEnv = ...");return}if(typeof g==="object"&&g!==null){e.curProjectConfig.$DevEnv=g;var q={},r,n;if((q.width=xui.get(g,["designViewConf","width"]))&&(q.height=xui.get(g,["designViewConf","height"]))){xui.each(RAD.Designer.getAllInstance(),function(A){if(A.canvas){A.setViewSize(q);if(A._cls){xui.asyRun(function(){if(A._cls){A.refreshView(A._cls)}},100)}}})}if(r=xui.get(g,["designViewConf","touchDevice"])){xui.each(RAD.Designer.getAllInstance(),function(A){if(A.canvas){A.setMobileFrame(r)}})}if(n=xui.get(g,["SpaceUnit"])){xui.each(RAD.Designer.getAllInstance(),function(A){if(A.canvas){if(A._cls){xui.asyRun(function(){if(A._cls){A.refreshView(A._cls)}},100)}}})}}}d=x.split(/\s*\/\/ \[\[Global Functions\s*\n|\n\s*\/\/ \]\]Global Functions\s*/);if(d.length==3){c=d[1];g=null;try{b=/^\s*xui\.\$cache\.functions\s*\=\s*/;if(b.test(c)){c=xui.replace(c,[[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"$0"],[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[b,""],[/;\s*$/,""],[/\/\/[^\n]*/,""]]);g=xui.unserialize(c)}}catch(w){xui.alert(w+"<br><br>File => "+l+"<br><br>at : xui.$cache.functions = ...");return}if(typeof g==="object"&&g!==null){e.curProjectConfig.$GlobalFunctions=g}}d=x.split(/\s*\/\/ \[\[Global Data\s*\n|\n\s*\/\/ \]\]Global Data\s*/);if(d.length==3){c=d[1];g=null;try{b=/^\s*xui\.\$cache\.data\s*\=\s*/;if(b.test(c)){c=xui.replace(c,[[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"$0"],[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[b,""],[/;\s*$/,""],[/\/\/[^\n]*/,""]]);g=xui.unserialize(c)}}catch(w){xui.alert(w+"<br><br>File => "+l+"<br><br>at : xui.$cache.data = ...");return}if(typeof g==="object"&&g!==null){e.curProjectConfig.$GlobalData=g}}d=x.split(/\s*\/\/ \[\[Constant Data\s*\n|\n\s*\/\/ \]\]Constant Data\s*/);if(d.length==3){c=d[1];g=null;try{b=/^\s*xui\.constant\s*\=\s*/;if(b.test(c)){c=xui.replace(c,[[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"$0"],[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[b,""],[/;\s*$/,""],[/\/\/[^\n]*/,""]]);g=xui.unserialize(c)}}catch(w){xui.alert(w+"<br><br>File => "+l+"<br><br>at : xui.constant = ...");return}if(typeof g==="object"&&g!==null){e.curProjectConfig.$ConstantData=g}}};e.curProjectConfig={};if(xui.isSet(m)){e._resetPrjEnv();j(m||"");xui.tryF(f)}else{xui.Ajax(CONF.getProjectConfigService,{projectName:SPA.curProjectName},function(n){e._resetPrjEnv();j(n||"");xui.tryF(f)},function(n){e._resetPrjEnv();xui.tryF(f);xui.alert("Missing file : '"+l+"'.")},null,{rspType:"text",method:"POST"}).start()}return e.curProjectConfig},_openproject:function(e,j,c,a){var o=this,r=j.files;e=e.replace(/\\/g,"/");window["/"]=CONF.getPrjPath(e,true)+"/";window["/"]=CONF.adjustProtocol(window["/"]);o.currentRootCls=a||"App";o.curProjectPath=e;if(xui.str.endWith(e,"/")){e=e.substr(0,e.length-1)}o.curProjectName=e.substr(e.lastIndexOf("/")+1,e.length);var s=e;if(s.indexOf("VVVERSION")>-1){s=s.replace("VVVERSION","(V")+")"}var q=o.buildFileItems(s,r),f=o.treebarPrj,n=o.tabsMain;if(f){f.clearItems()}if(f){f.insertItems([q])}o.tabsMain.setDisabled(false);var g=CONF.getStatus(),m=g.projects,l=xui.arr.subIndexOf(m||[],"id",o.curProjectPath),b=l!=-1?m[l].files:[],d=l!=-1?m[l].file:null;if(!b){b=[]}if(!d&&b[0]){d=b[0]}if(!d&&!c){d=j.index?j.index+".cls":o.currentRootCls+"/index.cls";if(xui.arr.subIndexOf(b,d)==-1){b.push(d)}}o.refreshProjectConfig(null,function(){if(b&&b.length){xui.arr.each(b,function(x,u){u=x.substr(x.lastIndexOf("/")+1,x.length);var w={id:x,value:x,name:u,className:x.replaceAll("/","."),caption:o._getpagename(u)};if(w.caption.indexOf("VVVERSION")==-1){o._openfile(w,null,x!=d,true)}})}if(d&&f){f.setUIValue(null);f.setUIValue(d,true)}});if(o.projecttool){o.projecttool.setDock("none").setDisplay("").setDock("top")}if(!c&&o._toolbox){o._toolbox.fillContent()}document.title=document.title.replace(/\s*\[.*\]\s*$/,"")+" ["+e+"]"},_checkEvent:function(a){var c=this;var b={};xui.each(a,function(g,e,d){var j=d[e];if(j){if(xui.isArr(j)){aAction=[];xui.each(j,function(n){if(typeof(n)=="string"){aAction.push({script:n,desc:"函数"})}else{if(xui.isHash(n)){aAction.push(n)}}});b[e]={actions:aAction}}else{if(typeof(j)=="string"){b[e]={actions:[{script:j,desc:"函数"}]}}else{if(!j.actions){delete d[e];var m={actions:j};b[e]=m}else{var f=[];var l=d[e].actions;if(typeof(l)=="string"){f.push({script:l.toString(),desc:"函数"})}else{xui.each(l,function(q,n){if(!xui.isHash(q)){f.push({script:q.toString(),desc:"函数"})}else{var o=[];xui.each(q.args,function(r,s){if(typeof(r)=="function"){o.push({script:r.toString(),desc:"函数"})}else{o.push(r)}});if(!q.type){q.type="page"}q.args=o;f.push(q)}});b[e]=d[e];b[e].actions=f}}}}}});return b},_getDesigner:function(){var a=this.tabsMain,c=a.getUIValue(),b=a.getItemByItemId(c);return b.$obj._designer},_saveFile:function(x,u){var G=this,m=this.tabsMain;if(x._dirty){var E=x.$obj.getValue(),s,e,A;if(false===E){return false}if(xui.str.startWith(x.id,SPA.curProjectPath+"/"+G.currentRootCls+"/")||(s=xui.str.startWith(x.id,SPA.curProjectPath+"/Module/js/"))){e=RAD.ClassTool.getClassName(E);var C=x.id;if(C.indexOf(SPA.curProjectPath)>-1){C=C.replace(SPA.curProjectPath+"/","")}A=xui.getClassName(C);if(e!=A){xui.pop(xui.getRes("RAD.designer.The class name in '$0' should be '$1', but it's '$2'",x.id,A,e));A=e=null}}var f={projectName:SPA.curProjectName,hashCode:xui.id(),curProjectPath:SPA.curProjectPath,path:x.id,fileType:"EUFile",content:E,jscontent:E};var F=x.$obj._designer;if(F&&F.getWidgets()&&F.getWidgets().length>0){var b=F.getJSCode(F.getWidgets());var j=new xui.Module();j.iniComponents=new Function([],b);var d={},r;xui.each(F.getNames(),function(I){var J=I.parent?I.parent.alias:"this";if(!I.moduleClass){r=d[I.alias]=I.serialize(false,false,false);if(d[I.alias].events){d[I.alias].events=G._checkEvent(d[I.alias].events)}d[I.alias].host=J;if(I.childrenId){d[I.alias].target=I.childrenId}}else{var o=I.host;o.properties.className=I.moduleClass;if(!d[o.alias]){r=d[o.alias]=o.serialize(false,false,false);if(d[o.alias].events){d[o.alias].events=G._checkEvent(d[o.alias].events)}d[o.alias].host=J;if(I.childrenId){d[o.alias].target=I.childrenId}d[o.alias].className=I.moduleClass;d[o.alias].key="xui.Module"}}});if(F._cls.Instance.functions){xui.each(F._cls.Instance.functions,function(I){if(I.actions){var o=[];xui.each(I.actions,function(J){if(xui.isFun(J)){o.push({script:J.toString(),desc:"函数"})}else{if(J&&xui.isObj(J)){if(!J.type){delete J.type}o.push(J)}}});I.actions=o}})}F._cls.Instance.events=G._checkEvent(F._cls.Instance.events);var H={};xui.each(F._cls.Instance,function(J,I){var o=["iniComponents","initialize","customAppend"];if(typeof(J)=="function"){if(xui.arr.indexOf(o,I)==-1){H[I]=J.toString()}}});var w={};xui.each(F._cls.Instance,function(J,I){var o=["Dependencies","Required","properties","events","functions"];if(typeof(J)!="function"){if(xui.arr.indexOf(o,I)==-1){w[I]=xui.serialize(J)}}});var D=F._cls.Instance.customAppend,g;if(D&&typeof(D)=="function"){g=D.toString()}var q={};if(!F._cls.Instance.functions&&xui.isHash(F._cls.Instance.functions)){q=F._cls.Instance.functions}var n={components:d,Static:F._cls.Static||{},events:G._checkEvent(F._cls.Instance.events),customFunctions:H,moduleVar:w,customAppend:g,dependencies:F._cls.Instance.dependencies||[],properties:F._cls.Instance.properties||{},required:F._cls.Instance.Required||[]};var b=xui.Coder.formatText(xui.stringify(n),"js");f.className=F._className;f.content=b;f.fileType="EUClass";j.destroy()}if(CONF.grid_showPropBinder){var B=xui.get(RAD.ClassTool.getClassStruct(E),["sub","Instance","sub","iniComponents"]);if(B){var c=new xui.Module();c.iniComponents=xui.unserialize(B.code);f.propKeys=c.getPropBinderKeys()}}var l=function(I){var K=I;if(K&&!K.error&&K.data&&K.requestStatus!=-1){x.$obj.setValue(E);m.markItemCaption(x.id,false,true);if(s&&A){var o=xui.SC(A);if(o){o.refresh(E);var J=o.getAllInstance();if(!xui.isEmpty(J)){xui.each(J,function(L){L.refresh()})}}}if(x.id==SPA.curProjectPath+"/xuiconf.js"){G.refreshProjectConfig(E)}xui.message("  save success!   ")}else{xui.message(xui.get(K,["error","errdes"])||K||"no response!")}};var a=function(o){xui.message(o)};u.push({id:x.id,paras:f,onSuccess:l,onFail:a})}return u},_ann_onclick:function(){xui.ModuleFactory.getModule("about",function(){this.dialog.show(null,true)})},_getSelected:function(){var b=this._getDesigner().tempSelected,a;if(b&&b.length){a=[];xui.arr.each(b,function(c){a.push(xui.getObject(c))})}return a},_updateComponent:function(e){var b=this._getDesigner(),a=b.getByAlias(e.alias,true),d=this;a=a||b.canvas;if(!a.removeChildren){a.boxing().removeChildren(true,true,true)}else{a.removeChildren(true,true,true)}if(e.children){xui.each(e.children,function(f){d._addComponent(f)})}var c=b._dirty;b.refreshView(b.getJSCode(b.getWidgets(true)),true);if(c){b.markDirty()}},_addComponent:function(q,g){var r=this._getDesigner();var c=r.getByCacheId(this.tempSelected);var o;if(c){c=xui.getObject(r.tempSelected[0]);if(c){c=c.boxing()}else{if(g){selectNodes=xui.getObjectByAlias(g);if(selectNodes&&selectNodes.length>1){c=selectNodes[0].boxing()}}}}else{c=c.boxing()}o=c||r.canvas;var f=q,a=q.children||q.sub;if(!a||a.length==0){f={children:[q]}}if(xui.str.startWith(q.key,"xui.svg.")){var j=xui.addChild(f,o,r.$host,r.$host);var m=function(){var u=xui.addChild(f,o,r.$host,r.$host);var s=u[0].get(0);r._designable(s);r.selectWidget([s.$xid])},n=function(){var s=r.getByAlias(q.alias);s.destroy(true,true)};r.markDirty(n,m,"add commponents")}else{if(xui.str.startWith(q.key,"xui.UI.")){var j=xui.addChild(f,o,r.$host,r.$host);var e=j[0].get(0),b=e.$xid;r._designable(e);r.selectWidget([b]);var m=function(){var u=xui.addChild(f,o,r.$host,r.$host);var s=u[0].get(0);r._designable(s);r.selectWidget([s.$xid])},n=function(){var s=r.getByAlias(q.alias);s.destroy(true,true)};r.markDirty(n,m,"add commponents")}else{var d=q;var l=xui.create(d.key).setHost(r.$host,d.alias).setAlias(d.alias).setEvents(d.events).setProperties(d.properties);if(r.$host){r.$host[d.alias]=l}r.iconlist.insertItems([{id:l.get(0).$xid,imgWidth:"16",imgHeight:"16",tips:r._bldTips(l,r.$moduleInnerMode?"":CONF.enable_codeEdtor?("$(RAD.designer.Dblclick to edit the code)"):""),imgStyle:q.imgStyle,imageClass:q.imageClass}]);r.iconlist.setUIValue(l.get(0).$xid);if(!a||a.length==0){f={children:[q]}}var e=l.get(0),b=e.$xid;r._designable(e);r.selectWidget([e.$xid]);xui.addChild(f,o,r.$host,r.$host);var m=function(){var s=xui.create(d.key).setHost(r.$host,d.alias).setAlias(d.alias).setEvents(d.events).setProperties(d.properties);if(r.$host){r.$host[d.alias]=s}r.iconlist.insertItems([{id:b,imgWidth:"16",imgHeight:"16",tips:r._bldTips(s,r.$moduleInnerMode?"":CONF.enable_codeEdtor?("$(RAD.designer.Dblclick to edit the code)"):""),imgStyle:q.imgStyle,imageClass:q.imageClass}]);r.iconlist.setUIValue(b);if(!a||a.length==0){f={children:[q]}}r._designable(e);r.selectWidget([b])},n=function(){r.iconlist.removeItems([b]);var s=r.getByAlias(d.alias);s.destroy(true,true)};r.markDirty(n,m,"add commponents")}}},_loadPluginsMenu:function(b){var a=this;var d=function(j){var g=[];var f=[];if(j&&j.apis){xui.each(j.apis,function(l){xui.create(l.key).setAlias(l.alias).setHost(a,l.alias).setEvents(xui.checkEvents(l.events)).setProperties(l.properties)})}var e=a._checkEvent(SPA.toolbar.getEvents());xui.each(j.events,function(n,l){var m=e[l].actions;xui.each(n.actions,function(o){m.push(o)})});SPA.toolbar.setEvents(xui.checkEvents(e));if(j.properties&&j.properties.items&&j.properties.items.length>0){g.push(j.properties.items[0])}SPA.toolbar.setItems(CONF.chaneWidget(j.properties.items))};var c=b.params;xui.Ajax(b.baseUrl,c,function(e){var f=e;if(f&&!f.error){d(f.data)}},null,null,null,{method:"POST",asy:true}).start()},_loadBarMenu:function(b){var a=this;var d=function(g){var f=[];if(g&&g.apis){xui.each(g.apis,function(j){xui.create(j.key).setAlias(j.alias).setHost(a,j.alias).setEvents(xui.checkEvents(j.events)).setProperties(j.properties)})}var e=g[0].sub||g.sub||g;SPA.toolbar.setItems(CONF.chaneWidget(e))};var c=b.params;xui.Ajax(b.baseUrl,c,function(e){var f=e;if(f&&!f.error){d(f.data)}},null,null,null,{method:"POST",asy:true}).start()},_menubar_onMenuBtnClick:function(b,c,d){var a=this;a.currSrc=d;if(c.toolbar&&c.toolbar.length>0){this.toolbar.setItems(c.toolbar)}if(c.server&&c.server.baseUrl){this._loadBarMenu(c.server,d)}else{if(c.plugins&&c.plugins.baseUrl){this._loadPluginsMenu(c.plugins,d)}}var c=a.mainLayout.getSelectedItem();if(c.id!="xuimain"){a.mainLayout.selectItem("xuimain")}},_menubar_onclick:function(d,u,F,n,a){var H=this;if(!H._prjserial){H._prjserial=1}if(xui.str.startWith(F.id,"xui.")&&F.draggable){this._addComponent(F);return}if(F.root){if(!H.ViewMenuBar[F.id]){xui.Ajax("/radplugins/getActions",{viewBarId:F.id},function(f){var m=f;if(F.apis){xui.each(F.apis,function(o){xui.create(o.key).setAlias(o.alias).setHost(H,o.alias).setEvents(xui.checkEvents(o.events)).setProperties(o.properties)})}H.ViewMenuBar[F.id]=xui.create(F.key).setAlias(F.alias).setHost(H,F.alias).setEvents(xui.checkEvents(F.events)).setProperties(F.properties);H.ViewMenuBar[F.id].pop(n)},function(f){xui.message(xui.get(f,["error","errdes"])||f||"no response!")},null,null,{method:"post"}).start()}else{H.ViewMenuBar[F.id].pop(n)}}if(F.menuType||F.root||F.euClassName){xui.ModuleFactory.getModule(F.euClassName,function(){var f=F.tagVar;f.className=SPA.currentClassName;f.currentClassName=SPA.currentClassName;this.setData(f);this.show(xui("body"));this.initData();this._fireEvent("afterShow")});return}switch(F.id){case"setproject":if(!this.curProjectPath){xui.message(xui.getRes("RAD.ps.noprj"));return}this._setproject();break;case"about":xui.ModuleFactory.getModule("about",function(){this.show(null,null,null,null)});break;case"version":var q=H.tabsMain,w=q.getUIValue(),x=q.getItemByItemId(w),b={path:x.id};xui.ModuleFactory.getModule("RAD.VersionManager",function(){this.show(null,null,null,null,b)});break;case"remoteServer":$ESD.exportRemoteServer();break;case"localServer":$ESD.exportLocalServer();break;case"buildServer":$ESD.download();break;case"startServer":$ESD.startDebugServer();break;case"stopServer":$ESD.stopDebugServer();break;case"exit":$ESD.quit();break;case"pullCode":$ESD.pull();break;case"pushCode":$ESD.push();break;case"clearAll":$ESD.clearAll();break;case"openBPD":$BPD.open();break;case"customDebug":$ESD.customDebug();break;case"activeBranch":break;case"openBranch":xui.ModuleFactory.getModule("prjVersionSel",function(){this.setProperties({fromRegion:xui(n).cssRegion(true),onOK1:H._openproject,onOK2:H._openclsfolder,projectName:SPA.curProjectName,namespace:H});this.show(xui("body"))});break;case"newProject":xui.ModuleFactory.getModule("prjPro",function(){this.setProperties({fromRegion:xui(n).cssRegion(true),onOK1:H._openproject,onOK2:H._openclsfolder,namespace:H});this.show(xui("body"))});break;case"openProject":xui.ModuleFactory.getModule("prjSel",function(){this.setProperties({fromRegion:xui(n).cssRegion(true),onOK1:H._openproject,onOK2:H._openclsfolder,namespace:H});this.show(xui("body"))});break;case"newfile":if(!this.curProjectPath){xui.message(xui.getRes("RAD.ps.noprj"));return}var c=this.tabsMain,e=c.getUIValue();this._fileaction(null,"new2",n,this.tabsMain.getUIValue());break;case"upload":if(!this.curProjectPath){xui.message(xui.getRes("RAD.ps.noprj"));return}var c=this.tabsMain,e=c.getUIValue();this._fileaction(null,"upload",n,this.tabsMain.getUIValue());break;case"newFolder":if(!this.curProjectPath){xui.message(xui.getRes("RAD.ps.noprj"));return}var c=this.tabsMain,e=c.getUIValue();this._fileaction(null,"newFolder",n,this.tabsMain.getUIValue());break;case"newClass":if(!this.curProjectPath){xui.message(xui.getRes("RAD.ps.noprj"));return}var c=this.tabsMain,e=c.getUIValue();this._fileaction(null,"newClass",n,this.tabsMain.getUIValue());break;case"closeall":if(!this.curProjectPath){xui.message(xui.getRes("RAD.ps.noprj"));return}var q=this.tabsMain,l=0,r=q.getItems(),b={},s=[],j;q.clearItems();break;case"save":if(!this.curProjectPath){xui.message(xui.getRes("RAD.ps.noprj"));return}var q=this.tabsMain,w=q.getUIValue(),H=this,x=q.getItemByItemId(w),b={},s=[];this._saveFile(x,s);xui.resetRun("$RAD-save-last",function(){CONF.saveFiles(s)});break;case"saveall":if(!this.curProjectPath){xui.message(xui.getRes("RAD.ps.noprj"));return}var q=this.tabsMain,l=0,r=q.getItems(),b={},H=this,s=[],j;xui.arr.each(r,function(f){H._saveFile(f,s)});CONF.saveFiles(s);break;case"ec":if(!this.$dropmenulang||this.$dropmenulang.isDestroyed()){this.$dropmenulang=new xui.UI.PopMenu({items:[{id:"en",caption:xui.wrapRes("RAD.en")},{id:"cn",caption:xui.wrapRes("RAD.cn")}]},{onMenuSelected:function(o,m){var I=m.id;if(xui.getLang()!=I){var f=function(){xui.setLang(I,null,function(M,K){if(M==0){xui.include("xui.Locale.en.doc",CONF.getAPIPath()+"Locale/en.js",function(){if(!xui.Locale[I].doc){xui.Locale[I].doc=xui.Locale.en.doc}})}try{xui.UI.MenuBar.getAll().clearPopCache();xui.UI.PopMenu.getAll().adjustSize()}catch(L){}});var J=CONF.getStatus();xui.merge(J,{lang:xui.getLang()},"all");CONF.saveStatus(J)};xui.include("xui.Locale."+I+".doc",CONF.getAPIPath()+"Locale/"+I+".js",f,f)}}})}this.$dropmenulang.pop(n);break;case"theme":var B;if(!(B=this.$dropmenutheme)||B.isDestroyed()){B=this.$dropmenutheme=new xui.UI.PopMenu();B.onMenuSelected(function(m,f){if(xui.getTheme()!=f.id){xui.setTheme(f.id,true,function(){xui.UI.MenuBar.getAll().clearPopCache();xui.UI.PopMenu.getAll().adjustSize();var o=CONF.getStatus();xui.merge(o,{theme:xui.getTheme()},"all");CONF.saveStatus(o)},null,":not(.xui-designer-inner-control)")}})}var g=function(){B.pop(n)};if(B.getTag()){g()}else{var r=[];xui.arr.each(CONF.designer_themes,function(f){if(f){r.push({id:f,caption:"$RAD.builder.themes."+f})}});B.setItems(r);B.setTag("Loaded");g(r)}break;case"info":if(!this.Message.length){return}var E=this.$infoList,A=E.reBoxing();E.setItems(xui.copy(this.Message));A.popToTop(n,4);var C=function(){A.hide();xui.Event.keyboardHook("esc")};A.setBlurTrigger(E.get(0).$xid,C);xui.Event.keyboardHook("esc",0,0,0,C);break;case"debug":if(!H.curProjectPath){xui.message(xui.getRes("RAD.ps.noprj"));return}H._dirtyWarn(function(){var f=xui.get(SPA.curProjectConfig,["$DevEnv","designViewConf","width"])||800,m=xui.get(SPA.curProjectConfig,["$DevEnv","designViewConf","height"])||600,o=xui.get(SPA.curProjectConfig,["$DevEnv","designViewConf","touchDevice"])||0;CONF.debugApp("/debug/"+SPA.curProjectName+"/",xui.getClassName(SPA.currentPage.replace(SPA.curProjectPath+"/",""))+".cls",{rand:xui.rand(),width:f,height:m,theme:xui.get(SPA,["curProjectConfig","$PageAppearance","theme"])||"",ficdn:xui.get(SPA,["curProjectConfig","$FontIconsCDN"])||"",lang:xui.getLang()},a!==false)});break;case"release":if(!this.$deploymenu){this.$deploymenu=new xui.UI.PopMenu({items:[{id:"remoteServer",caption:"$(RAD.esdmenu.remoteServer)"},{id:"localServer",caption:"$(RAD.esdmenu.localServer)"},]},{onMenuSelected:function(m,f){H._menubar_onclick(H.menubar.get(0),null,f,n)}})}this.$deploymenu.pop(n);break;case"saveasweb":if(!H.curProjectPath){xui.message(xui.getRes("RAD.ps.noprj"));return}xui.showModule("RAD.CustomPackage",function(){this.initData();this._fireEvent("afterShow");this.setEvents("onOK",function(I,m,f){var o={key:CONF.requestKey,curProjectPath:SPA.curProjectPath,paras:{action:"saveasweb",ver:"advanced",path:H.curProjectPath,theme:xui.getTheme(),lang:xui.getLang(),files_lib:I,files_appearance:m,files_locale:f}};CONF.saveAS(o)})});break;case"servicetester":xui.getModule("RAD.ServiceTester",function(){this.init();this.show();this.initData();this._fireEvent("afterShow")});break;case"command":xui.Debugger.log("Ready");break;case"localicon":xui.getModule("RAD.SelFontAwesome",function(){this.show();this.initData();this._fireEvent("afterShow")});break;case"orgManager":xui.getModule("RAD.org.Main",function(){this.show();this.initData();this._fireEvent("afterShow")});break;case"formulatool":xui.ModuleFactory.getModule("esd.right.TabIndex",function(){this.setData({baseType:"RIGHT"});this.show(xui("body"));this.initData();this._fireEvent("afterShow")});break;case"ComRight":xui.ModuleFactory.getModule("esd.right.ComRight",function(){this.setData({baseType:"RIGHT"});this.show(xui("body"));this.initData();this._fireEvent("afterShow")});break;case"imgmanager":xui.getModule("RAD.ImageSelector",function(){this.show();this.initData();this._fireEvent("afterShow")});break;case"imgimport":xui.getModule("RAD.resource.ImageTree",function(){this.setEvents("onDestroy",function(o,m,f){xui.alert("添加成功，请刷新浏览器后查看！")});this.setData({projectName:SPA.curProjectName});this.show();this.initData();this._fireEvent("afterShow")});break;case"serviceManager":var G=this._getDesigner();xui.getModule("RAD.api.WebAPIManager",function(){this.setData({projectName:SPA.curProjectName,className:SPA.currentClassName});this.show();this.initData();this._fireEvent("afterShow");this.setDataToEditor(G.$host,G._cls,G)});break;case"expressionEditor":var G=this._getDesigner();xui.getModule("RAD.expression.ExpressionTemp",function(){this.setData({projectName:SPA.curProjectName,className:SPA.currentClassName});this.setDataToEditor(G.$host,G._cls,{url:"",queryArgs:{expression:""}});this.show();this.initData();this._fireEvent("afterShow")});break;case"serviceImport":xui.getModule("RAD.api.APITree",function(){this.setData({projectName:SPA.curProjectName});this.show();this.initData();this._fireEvent("afterShow")});break;case"OneCodeDsmConfig":window.open("http://custom.raddev.cn/RAD/DSMdsm/Debug.Index.view?domainId=DSMdsm&projectVersionName=DSMdsm");break;case"OneCodeConfig":if(SPA.curProjectName.indexOf("VVVERSION")>-1){SPA.curProjectName=SPA.curProjectName.substring(0,SPA.curProjectName.indexOf("VVVERSION"))}window.open("/RAD/"+SPA.curProjectName+"/Debug.Index.view?domainId="+SPA.curProjectName+"&projectVersionName="+SPA.curProjectName);break;case"dsmDesigner":window.open("/RAD/DSMdsm/projectManager");break;case"bpmtest":window.open("/RAD/"+SPA.curProjectName+"/admin.Index.view?projectName="+SPA.curProjectName);break;case"ESDServerList":xui.getModule("RAD.server.ESDServerList",function(){this.setData({projectName:SPA.curProjectName});this.show();this.initData();this._fireEvent("afterShow")});break;case"RemoteServerList":xui.getModule("RAD.server.RemoteServerList",function(){this.setData({projectName:SPA.curProjectName});this.show();this.initData();this._fireEvent("afterShow")});break;case"ProxyHostList":xui.getModule("RAD.server.ProxyHostList",function(){this.setData({projectName:SPA.curProjectName});this.show();this.initData();this._fireEvent("afterShow")});break;case"DBProviderList":xui.getModule("RAD.db.DBProviderList",function(){this.setData({projectName:SPA.curProjectName});this.show();this.initData();this._fireEvent("afterShow")});break;case"importTable":xui.getModule("RAD.db.project.DataBaseConfigList",function(){this.setData({projectName:SPA.curProjectName});this.show();this.initData();this._fireEvent("afterShow")});break;case"SqlConsole":xui.getModule("RAD.db.console.SqlConsole",function(){this.setData({projectName:SPA.curProjectName});this.show();this.initData();this._fireEvent("afterShow")});break;case"dbmodule":$ESD.createDBModule();break;case"configLocalServer":xui.getModule("RAD.server.ESDServerList",function(){this.setData({projectName:SPA.curProjectName});this.show();this.initData();this._fireEvent("afterShow")});break;case"configRemoteServer":xui.getModule("RAD.server.RemoteServerList",function(){this.setData({projectName:SPA.curProjectName});this.show();this.initData();this._fireEvent("afterShow")});break;case"configProxy":xui.getModule("RAD.server.ProxyHostList",function(){this.setData({projectName:SPA.curProjectName});this.show();this.initData();this._fireEvent("afterShow")});break;case"teamRight":xui.getModule("RAD.org.PersonList",function(){this.setData({projectName:SPA.curProjectName});this.show();this.initData();this._fireEvent("afterShow")});break;case"iconfont.cn":xui.openOtherWin("http://www.iconfont.cn");break;case"editorTheme":xui.ModuleFactory.newModule("RAD.EditorTheme",function(){this.show();this.initData();this.setEvents("onOK",function(K,f,I){var J=CONF.getStatus();J.editorTheme=K;J.editorFontSize=f;J.lineWrapping=I;CONF.saveStatus(J);if(H.curProjectPath){var m=H.tabsMain,o=m.getItems();xui.arr.each(o,function(L){if(L=L.$obj){L.resetEditorStyle(K,f,I)}})}})});break;case"editxml":if(!H.curProjectPath){xui.message(xui.getRes("RAD.ps.noprj"));return}break;case"editcfg":if(!H.curProjectPath){xui.message(xui.getRes("RAD.ps.noprj"));return}break;case"movews":var D=function(){xui.ModuleFactory.getModule("RAD.SwitchWorkspace",function(){this.init();this.show();this.initData();this._fireEvent("afterShow")})};if(this.curProjectPath){this._closeproject(D)}else{D()}break;case"download":CONF.openURL(CONF.path_download);break;case"viewbtn":xui.showModule2("action.action.CodeTemps",null,null,{projectVersionName:currProjectName,projectName:currProjectName});break}},__ondroptest:function(c,j,a,l,f,m){var b=xui(a).id(),g=c.getRootNode(),d=c.getItemByDom(f.domId);if(m){if(!m.sub||c.getKey(a)!=c.keys.TOGGLE){return false}}else{return false}},__ondroptest2:function(c,j,a,l,f,m){var b=xui(a).id(),g=c.getRootNode(),d=c.getItemByDom(f.domId);if(m){if(!m.sub||c.getKey(a)!=c.keys.TOGGLE){return false}}else{}},jdsicon_onclick:function(d,l,a){var m=this,n=d.boxing();if(!this.curProjectPath){xui.message(xui.getRes("RAD.ps.noprj"));return}var f=this.tabsMain,b=f.getUIValue(),m=this,c=f.getItemByItemId(b),g={},j=[];this._saveFile(c,j);xui.resetRun("$RAD-save-last",function(){CONF.saveFiles(j)})},__beforedrop:function(d,l,b,n,g,q){var m=this,j=d.boxing(),f=d.getItemByDom(g.domId);if(!f){return}var c=f.id,o=f.name,a=(q?q.id:(m.curProjectPath+"/"+m.currentRootCls+"/js"));xui.Ajax(CONF.copy,{spath:c,tpath:a,packageName:m.packageName},function(r){var w=r;if(w&&!w.error&&w.requestStatus!=-1&&w.data.path){var u=w.data.path,s=u.substr(u.lastIndexOf("/")+1);q={id:u,name:s,caption:s,value:u};q=xui.clone(q);if(type=="cls"){q.caption=m._getpagename(s)}if(type=="prj"){q.caption=m._getpagename(s)}var e=type=="prj"?ins1:ins2;if(e&&(tbItem=e.getItemByItemId(tbItem.id))){e.insertItems([q],tbItem.id)}m.spath=null}else{xui.message(xui.get(w,["error","errdes"])||w||"no response!")}},function(e){xui.message(xui.get(e,["error","errdes"])||e||"no response!")},null,null,{method:"POST"}).start();return false}}});new function(){if(!window.CONF){window.CONF={}}xui.setLang("cn");formartText=function(a){a=xui.adjustRes(a);if(a.length>=4){a=a.length>4?a.substring(0,4):a}else{for(var b=a.length;b<4;b++){a=a+"&nbsp;&nbsp;"}}return a};getWidgetItem=function(b){var a={};xui.each(CONF.widgets,function(c){if(c.id==b){a=xui.clone(c)}});return a};getWidgets=function(b,c){var a=[];xui.arr.each(b,function(e){var d=chaneWidgetConfig(getWidgetItem(e),c);xui.arr.each(d,function(f){a.push(f)})});return a};chaneAllWidgetConfigs=function(e,g){var a=[],f=[],d=[];xui.arr.each(e.sub,function(j){if(!j.sub||j.sub.length==0){f.push(j)}else{d.push(j)}});if(f.length>0){var b=xui.clone(e);b.sub=f;var c=chaneWidgetConfig(b,g);xui.arr.each(c,function(j){a.push(j)})}xui.arr.each(d,function(l){var j=chaneWidgetConfig(l,g);xui.arr.each(j,function(m){a.push(m)})});return a};chaneWidgetConfigs=function(b,c){var a=[];xui.arr.each(b,function(e){var d=chaneWidgetConfig(e,c);xui.arr.each(d,function(f){a.push(f)})});return a};chaneWidgetConfig=function(f,j){var a=[];var g=f.comment?f.comment:f.caption;if(!g){g=f.id}var e={id:f.id+"grop",color:"#777777",groupStyle:"width:80px;  padding 0 0",sub:[{id:f.id+"btn",iconFontSize:"3em",caption:formartText(g),imageClass:f.imageClass}]};var c=[],d=0;xui.arr.each(f.sub,function(n){var m=xui.clone(n);m.iconFontSize="1.5em";m.fontSize="1em";m.boxStyle="width:110px,text-align:left";var q=n.comment?n.comment:n.caption;if(!q){q=n.id}m.caption=formartText(q);if(!m.tips){if(xui.str.startWith(m.id,"xui.UI")){m.tips="在当前位置插入"+m.caption}else{m.tips=m.caption}}if(n.sub&&n.sub.length>0){m.iconFontSize="1.5em";m.dropButton=true;var l=[];xui.arr.each(n.sub,function(o){var r=xui.clone(o);r.caption=o.comment?o.comment:o.caption;l.push(r)});m.sub=l;m.fontSize="1em";m.boxStyle="width:110px,text-align:left";d=d+35}else{d=d+35}c.push(m)});if(f.length%2!=0){d=d+35}d=d+35;var b={id:f.id+"itemgrop",groupStyle:"width:"+(d)+"px; border-style: dashed;border-width: 0 1px 0 0;border-color: rgb(171, 171, 171);padding 0 0",sub:c};a.push(e);a.push(b);return a};xui.merge(window.CONF,{toolbarItems:[{id:"save",groupStyle:"width:80px;  padding 0 0",sub:[{id:"save",iconFontSize:"3em",caption:"保存",iconColor:"#777777",imageClass:"spafont spa-icon-save",tips:"$RAD.tool.save"}]},{id:"saveall",groupStyle:"width:130px; border-style: dashed;border-width: 0 1px 0 0;border-color: rgb(171, 171, 171);padding 0 0",sub:[{id:"saveall",itemStyle:"width:120px",caption:"保存所有",imageClass:"spafont spa-icon-saveall",tips:"$RAD.tool.saveall"},{id:"closeall",itemStyle:"width:120px",caption:"关闭所有",imageClass:"xui-uicmd-close",tips:"$RAD.tool.closeall"}]},{id:"setprojectgroup",groupStyle:"width:80px; padding 0 0",sub:[{id:"setproject",caption:"工程配置",iconColor:"#777777",iconFontSize:"3em",imageClass:"spafont spa-icon-settingprj",tips:"$(RAD.menu.Project Setting)"},]},{id:"project",color:"#777777",groupStyle:"width:130px; border-style: dashed;border-width: 0 1px 0 0;border-color: rgb(171, 171, 171);margin: 1px",sub:[{id:"newProject",itemStyle:"width:120px",caption:"$(RAD.esdmenu.newProject)",add:""},{id:"openProject",itemStyle:"width:120px",caption:"$(RAD.esdmenu.openProject)",add:""}]},{id:"releasebutton",color:"#777777",groupStyle:"width:80px; padding 0 0",sub:[{id:"release",dropButton:true,iconColor:"#777777",iconFontSize:"3em",caption:"发布",imageClass:"spafont spa-icon-package",tips:"$RAD.menu.release"},]},{id:"other",color:"#777777",groupStyle:"width:300px; padding 0 0",value:"version",sub:[{id:"version",caption:"文件版本",imageClass:"xui-icon-bullet",tips:"$RAD.esdmenu.version"},{id:"theme",caption:"皮肤样式",dropButton:true,imageClass:"spafont spa-icon-theme",tips:"$RAD.builder.dftThemeTips"},{id:"ec",dropButton:true,imageClass:"spafont spa-icon-language",tips:"$RAD.tool.ec"},{id:"openBPD",imageClass:"spafont spa-icon-alignc",tips:"$(RAD.esdmenu.openBPD)"},{id:"expressionEditor",imageClass:" spafont spa-icon-function",tips:"$(RAD.esdmenu.expressionEditor)"},{id:"serviceManager",imageClass:"spafont spa-icon-options",tips:"$RAD.esdmenu.serviceManager"}]}],tools:[{id:"editorTheme",iconColor:"#777777",caption:"资源管理",imageClass:"spafont spa-icon-config"},{id:"csstool",caption:"图标字体",color:"#777777",imageClass:"spafont spa-icon-c-label",sub:[{id:"localicon",caption:"导入图标",imageClass:"spafont spa-icon-html"},{id:"iconfont.cn",caption:"阿里站点",imageClass:"spafont spa-icon-c-video"}]},{id:"imgtool",iconColor:"#777777",caption:"图片库",image:"spafont spa-icon-c-image",sub:[{id:"imgmanager",caption:"图片维护",imageClass:"spafont spa-icon-rendermode"},{id:"imgimport",caption:"导入图片",imageClass:"spafont spa-icon-html"}]},{id:"apiManager",iconColor:"#777777",add:"",caption:"后端服务",imageClass:"spafont spa-icon-options",sub:[{id:"serviceImport",caption:"服务导入",imageClass:"spafont spa-icon-c-webapi"},{id:"serviceManager",caption:"服务维护",imageClass:"spafont spa-icon-icon-bigup"},],},],oneStart:[{id:"mangager",add:"",iconColor:"#777777",caption:"数据库",imageClass:"fa fa-database",sub:[{id:"DBProviderList",caption:"数据源",imageClass:"spafont spa-icon-class"},{id:"importTable",caption:"导入库表",imageClass:"spafont spa-icon-options"},{id:"SqlConsole",caption:"数据库监控",imageClass:"spafont spa-icon-c-video"},]},{id:"bpm",add:"",caption:"流程仿真",iconColor:"#777777",imageClass:"spafont spa-icon-options",sub:[{id:"openBPD",caption:"流程定义",imageClass:"spafont spa-icon-designview"},{id:"bpmtest",caption:"仿真测试",imageClass:"spafont spa-icon-action"},{id:"OneCodeConfig",caption:"运行配置",imageClass:"bpmfont bpmgongzuoliuxitongpeizhi"},]}],serverConfig:[{id:"server",add:"",caption:"服务器",iconColor:"#777777",imageClass:"spafont spa-icon-alignw",sub:[{id:"RemoteServerList",caption:"远程配置",imageClass:"spafont spa-icon-c-slider"},{id:"ProxyHostList",caption:"代理配置",imageClass:"spafont spa-icon-alignw"}]},{id:"releasegroup",add:"",caption:"服务器",iconColor:"#777777",imageClass:"spafont spa-icon-debug",sub:[{id:"startServer",caption:"启动服务",type:"statusButton",imageClass:"spafont spa-icon-debug",tips:"$(RAD.esdmenu.startSrver)"},{id:"stopServer",caption:"关闭服务",type:"statusButton",imageClass:"xuicon xui-uicmd-location",tips:"$(RAD.esdmenu.stopServer)"},{id:"ESDServerList",caption:"服务配置",imageClass:"spafont spa-icon-coms"}]},{id:"dsm",add:"",caption:"领域后台",color:"#777777",imageClass:"spafont spa-icon-conf",sub:[{id:"OneCodeDsmConfig",caption:"领域配置",imageClass:"spafont spa-icon-c-cssbox"},{id:"dsmDesigner",caption:"编辑器",imageClass:"xui-icon-dialog"}]}]});xui.merge(window.CONF,{chaneWidget:function(a){return chaneWidgetConfigs(a)},SPATomMenu:function(){var a=[{id:"file",add:"",caption:"$RAD.menu.file",toolbar:CONF.toolbarItems},{id:"inster",add:"",caption:"$RAD.esdmenu.inster",toolbar:getWidgets(["xui.UI.absForm","xui.UI.advForm","xui.oa"])},{id:"tools",caption:"$RAD.menu.tools",toolbar:chaneWidgetConfigs(CONF.tools)},{id:"expression",add:"",caption:"切面公式",server:{baseUrl:"/action/spatoolbar/Formula",params:{engineType:"CUSTOM",currentClassName:SPA.currentClassName},}},{id:"oneStart",caption:"快速开始",toolbar:chaneWidgetConfigs(CONF.oneStart)},{id:"serverConfig",caption:"服务配置",toolbar:chaneWidgetConfigs(CONF.serverConfig)},{id:"plugins",add:"",caption:"插件",plugins:{baseUrl:"/action/spatoolbar/getPluginBar",params:{menuType:"top"},}}];return a}});xui.merge(window.CONF,{navBar:[{caption:"消息",flagText:"2",id:"msg",imageClass:"xui-uicmd-info"}]});xui.merge(window.CONF,{teamBar:[{caption:"配置",id:"setproject",imageClass:"xui-uicmd-opt"},{id:"openProject",caption:"切换工程",imageClass:"spafont spa-icon-alignw"},{caption:"退出",id:"logout",imageClass:"xui-icon-smill"}]});xui.merge(window.CONF,{projecttool:[{id:"any",sub:[{id:"refresh",imageClass:"xuicon xui-refresh",caption:"",tips:"$RAD.tool2.refresh"},{id:"del2",imageClass:"xuicon xui-icon-minus",caption:"",tips:"$RAD.tool2.del2"},{id:"copy2",hidden:true,imageClass:"spafont spa-icon-copy",caption:"",tips:"$RAD.tool2.copy2"},{id:"paste",hidden:true,imageClass:"spafont spa-icon-paste",caption:"$RAD.esdmenu.paste",tips:"$RAD.esdmenu.paste"},{id:"newClass",imageClass:"xuicon xui-uicmd-add",caption:"",tips:"$RAD.esdmenu.newClass"},{id:"newFolder",imageClass:"fa fa-folder-o",caption:"",tips:"$RAD.esdmenu.newFolder"},{id:"upload",imageClass:"fa fa-file-o",caption:"",tips:"$RAD.esdmenu.upload"},{id:"rename",hidden:true,imageClass:"spafont spa-icon-rename",caption:"",tips:"$RAD.tool2.modify"}]},{id:"editastext",hidden:true,imageClass:"spafont spa-icon-astext",caption:"",tips:"$RAD.tool2.editastext"}]})};xui.Class("RAD.CodeEditor",["xui.UI.Widget","xui.absValue"],{Instance:{activate:function(){var a=this.get(0);if(a.$cm){a.$cm.focus()}if(a.$cm){a.$cm.doc.setCursor(a.readonly_head||0+1,0)}return this},getCM:function(){return this.get(0).$cm},resetEditorStyle:function(e,b,d,a){this.addCMTheme(e);var c=this.get(0);if(!a){a=c.$cm}if(a){a.setOption("theme",e);a.setOption("lineWrapping",!!d);var f=a.getWrapperElement();if(f){f.style.fontSize=b+"px"}}},showModeSelDlg:function(d){var c=this,a=c.getCM(),b=c.get(0),e=function(f){if(!f||f.mode==="none"){if(!b.$initialized){b.$initialized=true}if(b.onRendered){b.boxing().onRendered(b,true)}}else{a.setOption("mode",f.mime||f.mode);CodeMirror.autoLoadMode(a,f.mode);if(b.onCodeModeSet){b.boxing().onCodeModeSet(b,f)}}b=a=null};xui.ModuleFactory.newCom("RAD.SelRenderMode",function(){this.setEvents("onSel",e);this.mainDlg.showModal();this.modeList.setValue(d.mime+":"+d.mode)})},addCMTheme:function(b){var a=this.get(0);var c="cm-theme-"+b;if(b!="default"&&!xui.CSS.get("id",c)){xui.CSS.includeLink("codemirror5/theme/"+b+".css",false,c)}},clearHistory:function(){var a=this.get(0).$cm;if(a){a.clearHistory()}},reindent:function(){var a=this.get(0).$cm,e=a.doc;if(e.somethingSelected()){var f=e.getCursor("start"),d=e.getCursor("end");for(var c=f.line,b=d.line;c<=b;c++){a.indentLine(c)}}else{var f=e.firstLine(),d=e.lastLine();for(var c=f,b=d;c<=b;c++){a.indentLine(c)}}},callEditor:function(c,b,a){var d=this.get(0).$cm;if(a){d=d.doc}return d[c].apply(d,b||[])},searchCode:function(c){var b=this.get(0),a=b.$cm;if(a){var d=a.getSearchCursor(c,a.hasFocus()?a.doc.getCursor():{pos:0,line:0},true);if(d.findNext()){a.focus();a.doc.setSelection(d.from(),d.to())}}},locateTo:function(m,l,f){var j=this,c=this.get(0),n=c.$cm,d,b,a,e;if(n){d=RAD.ClassTool.getClassStruct2(n.doc.getValue());if(m){if(l&&(m=="Static"||m=="Instance")){b=xui.get(d,["sub",m,"sub",l])}else{b=xui.get(d,["sub",m])}}if(b){if(f){n.doc.setSelection(n.doc.posFromIndex(b.from),n.doc.posFromIndex(b.to))}else{var g=n.doc.posFromIndex(b.from);n.focus();n.doc.setCursor(g);n.scrollIntoView(g)}return true}}return false},focusLine:function(b){var d=this,c=this.get(0),a=c.$cm,e={line:b,ch:0};if(a){a.focus();a.doc.setCursor(e);a.scrollIntoView(e)}},getLine:function(l,j,f){var g=this,c=this.get(0),m=c.$cm,d,b,a,e;if(m){d=RAD.ClassTool.getClassStruct2(m.doc.getValue());if(l){if(j&&(l=="Static"||l=="Instance")){b=xui.get(d,["sub",l,"sub",j])}else{b=xui.get(d,["sub",l])}}if(b){return m.doc.posFromIndex(b.from)}}return null},addCodeInto:function(n,m,a,f,e){e=e||"";var l=this,b=this.get(0),o=b.$cm;if(o){var d=RAD.ClassTool.getClassStructWithScope(o.getValue()),g=xui.get(d,["sub",n,"sub",m]),c;if(g){o.doc.replaceRange(a,o.doc.posFromIndex(g.from),o.doc.posFromIndex(g.to))}else{if(e){e+="\n"}g=xui.get(d,["sub",n]);if(!g){c=xui.get(d,["sub",d.arr[d.arr.length-1]]);if(c){a=",\n"+e+n+":{\n"+m+":"+(f?"function()":"")+a+"\n}"}else{a=n+":{\n"+e+m+":"+(f?"function()":"")+a+"\n}\n";c=d;c.to--}}else{c=xui.get(g,["sub",g.arr[g.arr.length-1]]);if(c){a=",\n"+e+m+":"+(f?"function()":"")+a}else{a=e+m+":"+(f?"function()":"")+a+"\n";c=g;c.to--}}var j=o.doc.posFromIndex(c.to);o.doc.replaceRange(a,j,j);o.doc.setSelection(j,o.doc.posFromIndex(c.to+a.length));l.reindent()}}},getBlockInfo:function(e,d){var c=this,b=this.get(0),a=b.$cm;return a&&xui.get(RAD.ClassTool.getClassStructWithScope(a.getValue()),["sub",e,"sub",d])},_refreshCM:function(){if(this.get(0).$cm){this.get(0).$cm.refresh()}},_setCtrlValue:function(a){if(!xui.isSet(a)){a=""}return this.each(function(b){if(b.$cm&&b.$cm.getValue()!=a){b.$cm.doc.setValue(a);if(b.$tm1){b.$tm1.clear()}if(b.$tm2){b.$tm2.clear()}delete b.$tm1;delete b.$tm2;delete b.readonly_head;delete b.readonly_tail}})},_getCtrlValue:function(){var a=this.get(0);if(a.$cm){return a.$cm.doc.getValue()}else{return a.properties.$UIvalue}},setReadonlyLines:function(b,a){var c=this.get(0),e=c.$cm.doc;if(c.$tm1){c.$tm1.clear()}if(c.$tm2){c.$tm2.clear()}if(b){c.$tm1=e.markText({line:0,ch:0},{line:b,ch:0},{atomic:true,readOnly:true,css:"background-color:#ccc;"})}if(a){var d=e.lastLine();c.$tm2=e.markText({line:d-a},{line:d},{atomic:true,readOnly:true,css:"background-color:#ccc;"})}c.readonly_head=b;c.readonly_tail=a}},Initialize:function(){var a=this.getTemplate();xui.merge(a.FRAME.BORDER,{BOX:{tagName:"div"}},"all");this.setTemplate(a);this.__trim=function(b){if(/[^\s\uFEFF\xA0]/.test(b)){return xui.str.trim(b)}else{return b}}},Static:{$tempsandbox:"_$temp_for_xui_sandbox",$tempsandbox2:"_$temp_for_xui_sandbox2",$temppool:"_$temp_for_xui_pool",Appearances:{BOX:{width:"100%",height:"100%",left:0,top:0,position:"absolute",background:"#fff"}},Behaviors:{},DataModel:{left:0,top:0,width:200,height:200,position:"absolute",codeType:{ini:"js",action:function(a){if(this.$cm){var b=CONF.getRenderMode(a);if(!b){b=CONF.getRenderMode("txt")}this.$cm.setOption("mode",b.mime||b.mode);if(this.onCodeModeSet){this.boxing().onCodeModeSet(this,b)}}}},readonly:{ini:false,action:function(a){if(this.$cm){this.$cm.setOption("readOnly",!!a)}}}},EventHandlers:{onValueChanged:function(b,a){},onRendered:function(a){},onGetHelpInfo:function(b,a){},onCodeModeSet:function(a,b){},onSaveCommand:function(){}},RenderTrigger:function(){var b=this.box.$temppool,a=this.$xid;this.box._loadEditor(this);this.destroyTrigger=function(){this.$cm.clearGutter();this.$cm.clearHistory();delete this.$cm;delete this.$tm1;delete this.$tm2;delete this.$editor;if(this.$popList){this.$popList.destroy()}if(this.$popHelp){this.$popHelp.destroy()}if(this.$popCustom){this.$popCustom.destroy()}if(window[b]){delete window[b][a]}}},clearSandbox:function(a){for(var b=1,d;b<9;b++){d=a+b;if(d&&document.getElementById(d)){document.body.removeChild(document.getElementById(d));try{delete frames[d]}catch(c){}}}},purge:function(){var a=this,b;if((b=window[a.$temppool])&&b.Instance&&b.Instance._ctrlpool){xui.each(b.Instance._ctrlpool,function(d,c){if(d&&!d.destroyed){if(d.destroy){d.destroy()}if(d.boxing&&d.boxing()){d.boxing().destroy()}}});xui.breakO(b.Instance)}},_alias:1,evalInSandbox:function(code,funScope,name,subCacheKey,purge,beforeCode,afterCode,cleanFun){if(name&&document.getElementById(name)){document.body.removeChild(document.getElementById(name));try{delete frames[name]}catch(e){}}var ns=this,iframe=document.createElement("iframe"),result,wnd,line,errmsg,type;ns.purge();if(name){iframe.name=name;iframe.id=name}iframe.src="about:blank";iframe.style.display="none";document.body.appendChild(iframe);wnd=frames[frames.length-1];wnd.document.open();wnd.document.write('<meta http-equiv="content-type" content="text/html; charset=utf-8" />');wnd.document.write("<script>\n");if(beforeCode){wnd.document.write(beforeCode)}wnd.document.write("global=process=Buffer=require=module=exports=root=null;\nwindow.xui=parent.xui;\nwindow.Class=function(){return xui.Class.apply(xui,arguments);};\nwindow.CONF={mixed_prop: xui.clone(parent.CONF.mixed_prop) };\n"+(CONF.SandBoxExtCode||"")+"window.__cache={};window.__getThis=function(pname,type){\n      if(__cache[pname+':'+type])return __cache[pname+':'+type];\n      var obj=type==1?function(){}:{};\n      if(pname){\n          if(xui.isArr(pname)){\n              xui.each(pname,function(cls){\n                  cls=xui.SC(cls);\n                  obj=xui.merge(obj, type==1?(cls||xui.Module):(cls?(new cls):(new xui.Module)),'all',true)\n              });\n          }else{\n              pname=xui.SC(pname);\n              obj=xui.merge(obj, type==1?(pname||xui.Module):(pname?(new pname):(new xui.Module)),'all',true)\n          }\n      }\n      if(window['"+ns.$temppool+"'] && window['"+ns.$temppool+"']['"+subCacheKey+"']){\n          obj=xui.merge(obj, window['"+ns.$temppool+"']['"+subCacheKey+"'][type==1?'Static':'Instance'],'all')\n      }\n      return __cache[pname+':'+type]=obj;\n  };\nwindow['"+ns.$temppool+"']=parent['"+ns.$temppool+"'];\nparent['"+ns.$tempsandbox+"']=/*@cc_on !@*/0?this:{eval:function(s){return (function(){var b=arguments.callee;return window.eval.call(window,s)})()}};\nparent['"+ns.$tempsandbox2+"']={getErrLine:function(s,cb){window.onerror=function(){cb.apply(null,arguments);return true;};var n=document.createElement('script');n.type='text/javascript';if(/*@cc_on !@*/0){n.text=s;}else{n.appendChild(document.createTextNode(s));};document.body.appendChild(n);window.onerror=null;}};\ntry{top=parent=null;}catch(e){}");if(afterCode){wnd.document.write(afterCode)}wnd.document.write("<\/script><body><span id='abc'></span></body>");wnd.document.close();var bak=xui.Dom.pack,bak1=xui.absProfile.prototype.$link,bak11=xui.absObj.$pickAlias,bak12=xui.UIProfile.prototype.setDomId,bak2=xui.require,bak3=xui.$cache,bak4=xui.asyRun,bak5=xui.resetRun,bak6=xui.exec,bak7=xui.pseudocode._callFunctions;try{xui.Dom.pack=function(){var o=new xui.Dom(false),d=document.getElementById("abc");o._nodes=[d];return o};xui.absProfile.prototype.$link=function(){return this};xui.Class.$instanceCreated=function(instance){instance.$inDesign=1};xui.absObj.$pickAlias=function(){return ns._alias++};xui.UIProfile.prototype.setDomId=function(){return this};xui.require=function(){};xui.$cache={};xui.each(bak3,function(o,i){xui.$cache[i]=xui.isArr(o)?[]:{}});xui.asyRun=xui.resetRun=xui.exec=xui.pseudocode._callFunctions=function(){};result=window[ns.$tempsandbox].eval(code);if(funScope){if(typeof(result)=="function"){result.call(funScope)}}type=(result===wnd||result===wnd.content)?"window":result===wnd.console?"console":result===wnd.history?"history":result===wnd.screen?"screen":result===wnd.location?"location":result===wnd.navigator?"navigator":result===wnd.document?"document":null;if(xui.browser.newie||(xui.browser.ie&&xui.browser.ver>=9)){var fun=function(hash){for(var i in hash){if(xui.isFun(hash[i])){hash[i]._____string=hash[i]+""}else{if(xui.isHash(hash[i])){fun(hash[i])}else{if(xui.isArr(hash[i])){fun(hash[i])}}}}};if(type===null&&(xui.isHash(result)||xui.isArr(result))){fun(result)}}}catch(e){if(xui.isSet(e.line||e.lineNumber)){line=e.line||e.lineNumber}else{var base=0;if(xui.browser.ie){window[ns.$tempsandbox2].getErrLine("var _a={;",function(a,b,c){base=c-1;return true})}window[ns.$tempsandbox2].getErrLine(code,function(a,b,c){line=c-base;return true})}errmsg=((e.name?e.name+" : ":"")+(e.description||e.message||"")+(line?"\n line : "+line:""));if(!xui.isSet(line)&&/.*at line ([\d]+).*/.test(errmsg)){line=errmsg.replace(/.*at line ([\d]+).*/,"$1")}}finally{if(purge){ns.purge()}delete xui.Class.$instanceCreated;xui.Dom.pack=bak;xui.absProfile.prototype.$link=bak1;xui.absObj.$pickAlias=bak11;xui.UIProfile.prototype.setDomId=bak12;xui.require=bak2;xui.$cache=bak3;xui.asyRun=bak4;xui.resetRun=bak5;xui.exec=bak6;xui.pseudocode._callFunctions=bak7;if(cleanFun){cleanFun(wnd,iframe)}wnd.CONF=wnd.Class=wnd.xui=wnd[ns.$temppool]=wnd.__getThis=wnd.__cache=null;if(CONF.ClearSandBoxExtCode){CONF.ClearSandBoxExtCode(wnd)}window[ns.$tempsandbox]=null;window[ns.$tempsandbox2]=null;var rsl={ok:result,type:type,ko:errmsg,line:line};ns=bak=result=line=errmsg=type=null;if(!name){document.body.removeChild(iframe)}iframe=null;return rsl}},_buildItem:function(j,d,c,g,b,f,a,e){return{id:j,caption:b||j,value:f||j,tag:(a||(d=="property"?"b":d=="function"?"c":d=="class"?"d":d=="event"?"e":"a"))+":"+j.toLowerCase(),path:(c?(c+"."):"")+j,itemStyle:e,imageClass:!d?null:(d=="property"?(xui.isSet(g)&&xui.isHash(g))?"spafont spa-icon-hash":(xui.isSet(g)&&xui.isArr(g))?"spafont spa-icon-array":"spafont spa-icon-var":d=="var"?"spafont spa-icon-var":d=="event"?"spafont spa-icon-action":d=="function"?"spafont spa-icon-function":d=="class"?"spafont spa-icon-class":"spafont spa-icon-prop")}},_intellcache:{},_enumKeys:function(r,x,A,s){if(!xui.isObj(r)||xui.isArr(r)){return[]}A=A!==false;var u=this,b=r.$xui$,a,m,q=[];for(var g in r){if("prototype"==g||"constructor"==g){continue}if(b){if("upper"==g||"After"==g||"Before"==g||"Instance"==g||"Static"==g||"Constructor"==g){continue}}try{if(g.charAt(0)!="_"&&g.charAt(0)!="$"&&/^[\w_]+$/.test(g)){a=r[g];if(A&&(a&&a.$abstract)){continue}m=typeof a=="function"&&(!(a&&a.$xui$)||a.$asFunction);if(s&&(!r.hasOwnProperty(g)||!r.propertyIsEnumerable(g))){continue}var w=g;if(m){if(A){var j=xui.fun.args(a);var f=false;if(xui.str.endWith(x,".prototype")){f=true}var B=RAD.ClassTool.getArgsFromAPI(x.replace(".prototype",""),g,f);if(B){j=[];for(var d=0,c=B.length;d<c;d++){j[d]=B[d]&&B[d].name}}w=g+"("+j.join(", ")+")"}else{w=g+"( )"}}q.push(u._buildItem(g,(typeof a=="function")?(a&&a.$xui$&&!a.$asFunction)?"class":(a&&a.$event$)?"event":"function":"property",x,a,w,w))}}catch(n){console.log(n)}}return q},_getIntellisenseList:function(key,cachedata){if(!key){return null}cachedata=cachedata!==false;var ns=this,cache=ns._intellcache,buildItem=ns._buildItem;if(cachedata&&cache[key]){return cache[key]}var list=[];if(key==ns.$temppool){return[]}switch(key){case" variables ":list=[buildItem("PK",0,0,0,0,0,4,"font-weight:bold;"),buildItem("xui",0,0,0,0,0,2,"font-weight:bold;color:#ff0000;"),buildItem("xui()",0,0,0,"xui()","xui()",2,"font-weight:bold;color:#ff0000;"),buildItem("top",0,0,0,0,0,3,"font-weight:bold;"),buildItem("parent",0,0,0,0,0,3,"font-weight:bold;"),buildItem("window",0,0,0,0,0,3,"font-weight:bold;"),buildItem("document",0,0,0,0,0,3,"font-weight:bold;"),buildItem("navigator",0,0,0,0,0,3,"font-weight:bold;"),buildItem("history",0,0,0,0,0,3,"font-weight:bold;"),buildItem("location",0,0,0,0,0,3,"font-weight:bold;"),buildItem("screen",0,0,0,0,0,3,"font-weight:bold;"),buildItem("Math",0,0,0,0,0,3,"font-weight:bold;"),buildItem("Number",0,0,0,0,0,3,"font-weight:bold;"),buildItem("console",0,0,0,0,0,3,"font-weight:bold;"),buildItem("if  ",0,0,0,"if...","if(){\n\n}",5),buildItem("ifelse",0,0,0,"if...else...","if(){\n\n}else{\n\n}",5),buildItem("while",0,0,0,"while...","while(){\n\n};",5),buildItem("do  ",0,0,0,"do...while","do{\n\n}while();",5),buildItem("try  ",0,0,0,"try...catch...finally","try{\n\n}catch(e){\n\n}finally{\n\n}",5),buildItem("for  ",0,0,0,"for...","for(;;;){\n\n}",5),buildItem("forin  ",0,0,0,"for...in","for( in ){\n\n}",5),buildItem("function",0,0,0,"function...","function(){\n\n}",5),buildItem("switch",0,0,0,"switch...","switch(){\n  case : \n\n  break;\n  case : \n\n  break;\ndefault: \n\n}",5),buildItem("with",0,0,0,"with...","with(){\n\n}",5),buildItem("return",0,0,0,"return","return ",4),buildItem("break",0,0,0,"break","break;",4),buildItem("continue",0,0,0,"continue","continue;",4),buildItem("throw",0,0,0,"throw","throw ",4),buildItem("new ",0,0,0,"new","new ",4),buildItem("delete",0,0,0,"delete","delete ",4),buildItem("arguments",0,0,0,"arguments","arguments",4),buildItem("var",0,0,0,"var","var ",4),buildItem("case",0,0,0,"case","case :",4),buildItem("default",0,0,0,"default","default :",4),buildItem("typeof",0,0,0,"typeof","typeof ",4),buildItem("instanceof",0,0,0,"instanceof","instanceof ",4),buildItem("void",0,0,0,"void","void",4),buildItem("true",0,0,0,"true","true",4),buildItem("false",0,0,0,"false","false",4),buildItem("null",0,0,0,"null","null",4),buildItem("NaN",0,0,0,"NaN","NaN",4),buildItem("undefined",0,0,0,"undefined","undefined",4),buildItem("Infinity",0,0,0,"Infinity","Infinity",4),buildItem("decodeURI()","function"),buildItem("decodeURIComponent()","function"),buildItem("encodeURI()","function"),buildItem("encodeURIComponent()","function"),buildItem("escape()","function"),buildItem("eval()","function"),buildItem("isFinite()","function"),buildItem("parseFloat()","function"),buildItem("parseInt()","function"),buildItem("unescape()","function"),buildItem("Number()","function"),buildItem("String()","function"),buildItem("keySet[",0,0,0,"PK[0]","PK[0]",5),buildItem("absField",0,0,0,"absField()","absField(filed1,filed2,value,units)",5)];break;case"new":list=[buildItem("String","class",0,0,0,"String();",1),buildItem("Object","class",0,0,0,"Object();",1),buildItem("Array","class",0,0,0,"Array();",1),buildItem("RegExp","class",0,0,0,"RegExp();",1),buildItem("Boolean","class",0,0,0,"Boolean();",1),buildItem("Number","class",0,0,0,"Number();",1),buildItem("Date","class",0,0,0,"Date();",1),buildItem("xui.Dom","class",0,0,0,"xui.Dom();",2),buildItem("xui.UIProfile","class",0,0,0,"xui.UIProfile();",2),buildItem("xui.Module","class",0,0,0,"xui.Module();",2),buildItem("xui.Template","class",0,0,0,"xui.Template();",2),buildItem("xui.UI","class",0,0,0,"xui.UI();",2),buildItem("xui.DataBinder","class",0,0,0,"xui.DataBinder();",2)];for(var i in xui.UI){if(i!="upper"&&xui.UI[i].$xui$){list.push(buildItem("xui.UI."+i,"class",0,0,0," xui.UI."+i+"();",2))}}break;case"history":case"screen":break;case"PK[":buildItem("PK['0']",0,0,0,"PK['0']","PK[0]",5);break;case"console":list=[buildItem("log()","function",key)];break;case"arguments":list=[buildItem("callee","property",key),buildItem("length","property",key)];break;case"arguments.callee":list=[buildItem("caller","property",key),buildItem("length","property",key),buildItem("call()","function",key),buildItem("apply()","function",key)];break;case"top":case"parent":case"window":var iframe=document.createElement("iframe");iframe.style.display="none";document.body.appendChild(iframe);var target=frames[frames.length-1];list=ns._enumKeys(target,key,false);document.body.removeChild(iframe);break;case"document":var iframe=document.createElement("iframe");iframe.style.display="none";document.body.appendChild(iframe);var target=frames[frames.length-1];list=ns._enumKeys(target.document,key,false);document.body.removeChild(iframe);break;case"Element.prototype":var iframe=document.createElement("iframe");iframe.style.display="none";document.body.appendChild(iframe);var target=frames[frames.length-1];target.document.write("<span>a</span>");list=ns._enumKeys(target.document.body.firstChild,key,false);document.body.removeChild(iframe);break;case"Math":list=[buildItem("E","property",key),buildItem("LN2","property",key),buildItem("LN10","property",key),buildItem("LOG2E","property",key),buildItem("LOG10E","property",key),buildItem("PI","property",key),buildItem("SQRT1_2","property",key),buildItem("SQRT2","property",key),buildItem("abs(x)","function",key),buildItem("acos(x)","function",key),buildItem("asin(x)","function",key),buildItem("atan(x)","function",key),buildItem("atan2(y,x)","function",key),buildItem("ceil(x)","function",key),buildItem("cos(x)","function",key),buildItem("exp(x)","function",key),buildItem("floor(x)","function",key),buildItem("log(x)","function",key),buildItem("max(x,y,z,...,n)","function",key),buildItem("min(x,y,z,...,n)","function",key),buildItem("pow(x,y)","function",key),buildItem("random()","function",key),buildItem("round(x)","function",key),buildItem("sin(x)","function",key),buildItem("sqrt(x)","function",key),buildItem("tan(x)","function",key)];break;case"Number":list=[buildItem("MAX_VALUE","property",key),buildItem("MIN_VALUE","property",key),buildItem("NEGATIVE_INFINITY","property",key),buildItem("POSITIVE_INFINITY","property",key)];break;case"Array.prototype":list=[buildItem("length","property",key),buildItem("concat()","function",key),buildItem("join()","function",key),buildItem("pop()","function",key),buildItem("push()","function",key),buildItem("reverse()","function",key),buildItem("shift()","function",key),buildItem("sort()","function",key),buildItem("concat()","function",key),buildItem("splice()","function",key),buildItem("toString()","function",key),buildItem("unshift()","function",key)];break;case"Date.prototype":list=[buildItem("getDate()","function",key),buildItem("getDay()","function",key),buildItem("getFullYear()","function",key),buildItem("getHours()","function",key),buildItem("getMilliseconds()","function",key),buildItem("getMinutes()","function",key),buildItem("getMonth()","function",key),buildItem("getTime()","function",key),buildItem("getSeconds()","function",key),buildItem("getTimezoneOffset()","function",key),buildItem("getUTCDate()","function",key),buildItem("getUTCDay()","function",key),buildItem("getUTCFullYear()","function",key),buildItem("getUTCHours()","function",key),buildItem("getUTCMilliseconds()","function",key),buildItem("getUTCMinutes()","function",key),buildItem("getUTCMonth()","function",key),buildItem("getUTCSeconds()","function",key),buildItem("getYear()","function",key),buildItem("parse()","function",key),buildItem("setDate()","function",key),buildItem("setFullYear()","function",key),buildItem("setHours()","function",key),buildItem("setMilliseconds()","function",key),buildItem("setMinutes()","function",key),buildItem("setMonth()","function",key),buildItem("setSeconds()","function",key),buildItem("setTime()","function",key),buildItem("setUTCDate()","function",key),buildItem("setUTCFullYear()","function",key),buildItem("setUTCHours()","function",key),buildItem("setUTCMilliseconds()","function",key),buildItem("setUTCMinutes()","function",key),buildItem("setUTCSeconds()","function",key),buildItem("setUTCMonth()","function",key),buildItem("setYear()","function",key),buildItem("toDateString()","function",key),buildItem("toGMTString()","function",key),buildItem("toLocaleDateString()","function",key),buildItem("toLocaleTimeString()","function",key),buildItem("toLocaleString()","function",key),buildItem("toString()","function",key),buildItem("toUTCString()","function",key),buildItem("toTimeString()","function",key),buildItem("UTC()","function",key)];break;case"Number.prototype":list=[buildItem("toExponential()","function",key),buildItem("toFixed()","function",key),buildItem("toPrecision()","function",key),buildItem("toString()","function",key)];break;case"Boolean.prototype":list=[buildItem("toString()","function",key)];break;case"Function.prototype":list=[buildItem("toString()","function",key),buildItem("call()","function",key),buildItem("apply()","function",key)];break;case"RegExp.prototype":list=[buildItem("global","property",key),buildItem("ignoreCase","property",key),buildItem("multiline","property",key),buildItem("lastIndex","property",key),buildItem("source","property",key),buildItem("compile()","function",key),buildItem("exec()","function",key),buildItem("test()","function",key)];break;case"String.prototype":list=[buildItem("length","property",key),buildItem("charAt()","function",key),buildItem("charCodeAt()","function",key),buildItem("concat()","function",key),buildItem("fromCharCode()","function",key),buildItem("indexOf()","function",key),buildItem("lastIndexOf()","function",key),buildItem("match()","function",key),buildItem("replace()","function",key),buildItem("search()","function",key),buildItem("slice()","function",key),buildItem("split()","function",key),buildItem("substr()","function",key),buildItem("substring()","function",key),buildItem("toLowerCase()","function",key),buildItem("toUpperCase()","function",key)];break;case"Object.prototype":list=[buildItem("toString()","function",key,0,0,0,"z"),buildItem("toLocaleString()","function",key,0,0,0,"z"),buildItem("hasOwnProperty(key)","function",key,0,0,0,"z"),buildItem("propertyIsEnumerable(key)","function",key,0,0,0,"z"),buildItem("isPrototypeOf(obj)","function",key,0,0,0,"z")];break;default:if(/\.prototype$/.test(key)){var bak=xui.Dom.pack,bak1=xui.absProfile.prototype.$link,bak11=xui.absObj.$pickAlias;xui.Dom.pack=function(){var o=new xui.Dom(false),d=document.getElementById("abc");o._nodes=[d];return o};xui.absProfile.prototype.$link=function(){return this};xui.absObj.$pickAlias=function(){return ns._alias++};try{var target=eval("new "+key.replace(/\.prototype$/,""));list=ns._enumKeys(target,key)}catch(e){}finally{xui.Dom.pack=bak;xui.absProfile.prototype.$link=bak1;xui.absObj.$pickAlias=bak11}}if(!list.length){var target=xui.get(window,key.split("."));list=ns._enumKeys(target,key);cachedata=false}}if(cachedata){cache[key]=list}return list},_getFromFunctionExp:function(b){var a;if(/toString\([^)]*\)$/.test(b)){a="String.prototype"}else{if(/^\s*\(?\s*new\s+([\wxui.]+)\s*\(?\s*[^)]*\)?\s*\)?(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/.test(b)){b=b.replace(/^\s*\(?\s*new\s+([\wxui.]+)\s*\(?\s*[^)]*\)?\s*\)?(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/,"$1");a=b+".prototype"}else{if(/.*\.reBoxing\(([^)]*)\)(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/.test(b)){b=b.replace(/.*\.reBoxing\(([^)]*)\)(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/,"$1");if(b){a=b.replace(/[\'\"]/g,"")+".prototype"}else{a="xui.Dom.prototype"}}else{if(b.indexOf("xui.alert(")==0||b.indexOf("xui.prompt(")==0||b.indexOf("xui.pop(")==0||b.indexOf("xui.confirm(")==0){a="xui.UI.Dialog.prototype"}else{if(b.indexOf("xui(")==0||b.indexOf("xui.use(")==0){a="xui.Dom.prototype"}else{if(b.indexOf("xui.Thread(")==0||b.indexOf("xui.Ajax(")==0||b.indexOf("xui.SAjax(")==0||b.indexOf("xui.IAjax(")==0||b.indexOf("xui.JSONP(")==0||b.indexOf("xui.XDMI(")==0){a="xui.Thread.prototype"}else{if(/.*\.(getRoot|getSubNode|getSubNodes)\s*\(\s*[^\)]*\)\s*$/.test(b)){a="xui.Dom.prototype"}else{if(/.*\.getElementById\s*\(\s*[^\)]*\)\s*$/.test(b)){a="Element.prototype"}}}}}}}}return a},_getFromObject:function(a){if(!xui.isSet(a)){return null}else{if(a===xui.str){return"xui.str"}else{if(a===xui.arr){return"xui.arr"}else{if(a===xui){return"xui"}else{if(a.$xui$){if(typeof a=="function"){return a.KEY}else{return a.KEY+".prototype"}}else{if(xui.isArr(a)){return"Array.prototype"}else{if(xui.isDate(a)){return"Date.prototype"}else{if(xui.isReg(a)){return"RegExp.prototype"}else{if(xui.isNumb(a)){return"Number.prototype"}else{if(xui.isStr(a)){return"String.prototype"}else{if(xui.isBool(a)){return"Boolean.prototype"}else{if(xui.isFun(a)){return"Function.prototype"}else{if(xui.isObj(a)){return"Object.prototype"}}}}}}}}}}}}}},_findVars:function(d,a,b){var j=this,m=d.$editor,f=[];if(m&&a){var l=m.win.document,g=function(u){return u.tagName=="BR"||u.tagName=="br"},s=function(u){return u.tagName=="B"||u.tagName=="b"},c=l.body.firstChild,r="",q,e,o=[],n;n=f;n.push(["this",""]);while((c=c.nextSibling)&&c!=a){if(s(c)&&c._uid&&c.id.charAt(0)=="b"){if(!b||b.indexOf(c.id)!==0){c=l.getElementById("e"+c.id.slice(1))}else{r=c._uid;xui.arr.each(o,function(u){u[1]=r});f=f.concat(o)}o=[];n=f}q=j.__trim(c.className);e=j.__trim(c.currentText);if(q=="js-keyword"&&e=="function"){while((c=c.nextSibling)&&c!=a&&(g(c)||j.__trim(c.className)=="whitespace"||j.__trim(c.className)=="js-comment")){}q=j.__trim(c.className);e=j.__trim(c.currentText);if(q=="js-variabledef"){n.push([e,r])}n=o;n.push(["this",r])}if(q=="js-variabledef"){n.push([e,r])}}}return f},_getIntellisense:function(d,D,g,A){var E=this,s=RAD.ClassTool._this;if(D.indexOf("new ")==0){type="new"}else{if(D.charAt(D.length-1)=="."){type="properties";D=D.slice(0,-1)}else{if(D.indexOf(".")!=-1){type="properties";D=D.slice(0,D.lastIndexOf("."))}else{type="var"}}}if(type=="properties"){if(D.indexOf("(")!=-1){type="function"}}var C,a,B=[],r,j,u=[];switch(type){case"new":r=type;break;case"function":type=E._getFromFunctionExp(D);if(type){r=type;break}case"properties":if(D=="arguments"||D=="arguments.callee"){r=D;break}else{var c=[],l=[],a=d.$cm.getValue(),q=RAD.ClassTool.getContextAssignments(a,g),n=RAD.ClassTool.getClassStructWithScope(a,g,E.$temppool,d.$xid);c.push("(function(){try{\n");c.push("var "+s+"=window;\n");l.push(s);var f=false,e=false,x=q.vars.length;for(var w=0;w<x;w++){c.push("var "+q.vars[w]+"=undefined;\n");l.push(q.vars[w])}for(var w=-1;w<x;w++){if(q.scopeS==-1||w>=q.scopeS){if(!f){f=true;var m;if(q.secondKey&&q.secondType=="function"){m=xui.get(n,["sub",q.firstKey,"sub",q.secondKey])}else{if(q.firstKey&&q.firstType=="function"){m=xui.get(n,["sub",q.firstKey])}}if(m){c.push("try{"+s+"="+m._this+"}catch(e){};\n");xui.arr.each(m.argsv,function(o,F){if(!m.args||!m.args[F]){return false}if(o.code){c.push("try{"+m.args[F]+"="+o.code+"}catch(e){};\n");l.push(m.args[F])}else{if(/\.prototype$/.test(o.type)){c.push("try{"+m.args[F]+"="+o.type.replace(/(.+)(\.prototype)$/,"new $1();")+"}catch(e){};\n");l.push(m.args[F])}else{c.push("try{"+m.args[F]+"="+o.type+"}catch(e){};\n");l.push(m.args[F])}}})}}}if(q.scopeS!=-1&&w>=q.scopeE){if(!e){e=true;c.push("try{"+s+"=window;}catch(e){};\n")}}if(w>=0){c.push("try{"+q.vars[w]+"="+q.code[w]+";}catch(e){};\n");l.push(q.vars[w])}}if(q.scopeS!=-1&&q.outscope){if(!e){c.push("try{"+s+"={};}catch(e){};\n")}}c.push("return ("+D+");\n}catch(e){}finally{\n");xui.arr.removeValue(l,D);c.push(l.join("=")+"=null;\n");c.push("}\n}).call({});\n");j=c.join("").replace(/\bthis\b/g,s)}break;case"var":r=" variables ";var b=RAD.ClassTool.getContextVars_fast(d.$cm,g);if(b["this"]){u.push(E._buildItem("this",0,0,0,0,0,1,"color:#ff0000;"));delete b["this"]}if(b["arguments"]){u.push(E._buildItem("arguments",0,0,0,0,0,1,"color:#ff0000;"));delete b["arguments"]}xui.each(b,function(G,F){u.push(E._buildItem(F,"var",0,0,0,0,1,"color:#666;"))});break}if(u&&u.length){if(!A){Array.prototype.push.apply(B,u)}}if(j){result=E.evalInSandbox(j,false,null,d.$xid);if(xui.isSet(result.ok)){if(result.type){r=result.type}else{r=E._getFromObject(result.ok);if(!A){Array.prototype.push.apply(B,E._enumKeys(result.ok,r,true,true))}}}}if(r){if(!A){Array.prototype.push.apply(B,E._getIntellisenseList(r))}}if(B.length){B=xui.arr.removeDuplicate(B,"id");xui.arr.stableSort(B,function(o,F){return o.tag>F.tag?1:o.tag==F.tag?0:-1})}return[r,B,D]},_loadEditor:function(l){var O=this,F=RAD.ClassTool._this;var B=false,u=null,g=null,n="CodeEditor.showSuggetion.resetRun",o="CodeEditor.adjustSuggetion.resetRun",b="",N=false,L;var P=function(V){var Q=/\s+/g,U=[],T="",Y=l.$cm,W=Y.doc.posFromIndex(V),aa=W.line,R=Y.getTokenAt(W),S=function(ac){if(ac.start===0){W.line--;if(W.line===0){return null}var ab=Y.doc.getLine(W.line);if(ab){W.ch=ab.length}else{return null}}else{W.ch=ac.start}return Y.getTokenAt(W)};if(!(R.type===null&&R.string==".")){T=O.__trim(R.string);R=S(R)}if(R&&(R.type===null&&R.string==".")){do{if(R.type===null&&R.string=="."){while(R=S(R)){if(!(!R||R.type=="comment"||R.type=="tab"||(R.type===null&&/^\s+$/.test(R.string)))){break}}if(R){var Z="";if(R.type===null&&R.string===")"){var X=0;do{if(R.type===null&&R.string===")"){X++}if(R.type===null&&R.string==="("){X--}if(R.string){Z=R.string+Z}}while((R=S(R))&&X!==0)}if(R){if(R.type=="property"||R.type=="variable"||R.type=="variable-2"||R.type=="xuiglobal"||(R.type=="keyword"&&R.string=="this")){U.push(R.string.replace(Q,"")+Z)}else{if(Z){U.push(Z)}else{break}}}}}else{break}}while(R=S(R))}else{if(R&&(R.type==null&&R.string===" ")){while(R=S(R)){if(!(!R||R.type=="comment"||(R.type==null&&R.string===" "))){break}}if(R.type=="keyword"&&R.string=="new"){T="new "+T}}}return(U.length?(U.reverse().join(".")+"."):"")+T};var e=function(){var S=this,R=[],Q=function(T){R.push(T.get(0))};Q((new xui.UI.Pane).setHost(S,"$popList").setLeft(10).setTop(10).setWidth(300).setHeight(180));S.$popList.append((new xui.UI.List).setHost(S,"$lstsug").setTheme("codemirror").setDirtyMark(false).setTop(18).setWidth(300).setHeight(162).setItemRow(true).setDisableHoverEffect(true));S.$popList.append((new xui.UI.Block).setHost(S,"block1").setLeft(0).setTop(0).setWidth(300).setHeight(24).setBorderType("flat"));S.block1.append((new xui.UI.Label).setHost(S,"$objType").setLeft(6).setTop(2).setWidth(252).setCaption("").setHAlign("left").setCustomStyle({KEY:"font-weight:bold;"}));Q((new xui.UI.Block).setHost(S,"$popHelp").setLeft(410).setTop(10).setWidth(300).setHeight(180).setBorderType("flat").setOverflow("hidden").setBackground("#FFF8DC"));S.$popHelp.append((new xui.UI.Div).setHost(S,"$divhelp").setTheme("codemirror").setLeft(-1).setTop(19).setWidth(300).setHeight(160).setCustomStyle({KEY:"overflow:auto; padding:4px;"}));S.$popHelp.append((new xui.UI.Block).setHost(S,"block3").setLeft(-1).setTop(-1).setWidth(300).setHeight(20).setBorderType("flat"));S.block3.append((new xui.UI.Link).setHost(S,"$linkAPI").setLeft("auto").setRight(2).setTop(1).setCaption("$RAD.JSEditor.clickapi"));S.block3.append((new xui.UI.Label).setHost(S,"$lblTips").setLeft(6).setTop(2).setWidth(133).setCaption("").setHAlign("left"));return R};var K={moveFocus:function(T){var V=l.$lstsug,Q=V.get(0).properties.items,S=Q.length,U=V.getUIValue(),R=xui.arr.subIndexOf(Q,"id",U);if(T===true){R=0}else{if(T===false){R=S-1}else{R+=T;if(R<0){R=0}if(R>S-1){R=S-1}}}if(Q[R]){V.setUIValue(Q[R].id,true)}},close:function(){f()},pick:function(){var U=l.$lstsug,Q=U.get(0).properties.items,S=Q.length,T=U.getUIValue(),R=xui.arr.subIndexOf(Q,"id",T);if(Q[R]){a(Q[R].value||Q[R].caption)}f()}};var C={Up:function(){K.moveFocus(-1)},Down:function(){K.moveFocus(1)},PageUp:function(){K.moveFocus(-8,true)},PageDown:function(){K.moveFocus(8,true)},Home:function(){K.moveFocus(true)},End:function(){K.moveFocus(false)},Enter:function(){K.pick()},Tab:function(){K.pick()},Esc:function(){K.close()}};var c=function(ae,V,S,Q){var X=l.box._getIntellisense(l,ae,V),W=X[0],Y=X[1];Q=Q||ae||"";if(!W&&!(Y&&Y.length)){f();return}if(!S){var af=false,aa=Q.toLowerCase();xui.arr.each(Y,function(ag){if(xui.str.startWith(ag.id.toLowerCase(),aa)){af=true;return false}});if(!af){return}}var ac=r.cursorCoords(true,"page"),R=ac.left,ab=ac.top;if(!l.$popList){e.call(l);xui("body").append(l.$popList.setDisplay("none"));xui("body").append(l.$popHelp.setDisplay("none"));l.$divhelp.getRoot().setSelectable(true);l.$linkAPI.onClick(function(ag){CONF.openAPI(ag.properties.tag)});var T=true,U=function(){xui.resetRun("codemirror:aaa",function(){if(T&&l.$popCustom){l.$popCustom.setDisplay("none")}})};l.$lstsug.afterUIValueSet(function(ai,ah,ag){D(ai.getItemByItemId(ag))}).onClick(function(ag,ah){a(ah.value||ah.caption);f()})}if((Y&&Y.length)||S){B=S?1:true;if(Y&&Y.length){l.$lstsug.setItems(Y)}var Z=function(){f()},ad=xui([l.$popList.getRootNode(),l.$popHelp.getRootNode(),l.getSubNode("BOX").get(0)]);l.$popList.getRoot().popToTop({region:{left:R,top:ab,width:2,height:16}},1).setBlurTrigger(n,Z,ad);xui.Event.keyboardHook("esc",0,0,0,Z);l.$popList.setDisplay("");L=X[2]||null;if(Y&&Y.length){d(R,ab,Q,"",true,true)}}l.$objType.setCaption(W||"none");l.$cm.removeKeyMap(C);l.$cm.addKeyMap(C)};var f=function(){xui.Event.keyboardHook("esc",0,0,0);l.$cm.removeKeyMap(C);xui.resetRun(n);xui.resetRun(o);u=null;g=null;B=false;N=false;if(l.$popList){l.$objType.setCaption("");l.$lstsug.setItems([]).setUIValue(null);l.$popList.setDisplay("none");l.$lblTips.setCaption("");l.$divhelp.setHtml("");l.$popHelp.setDisplay("none");if(l.$popCustom){l.$popCustom.setDisplay("none")}b=null}};var d=function(S,Y,V,U,R,Q){if(!l.$lstsug){return}var T=l.$lstsug.get(0),X=T.properties.items,W=function(){if(R&&!B){return}var Z;if(U){V+=U}if(!xui.isSet(b)||V!==b){b=V;xui.arr.each(X,function(aa){if(xui.str.startWith(aa.id.toLowerCase(),b.toLowerCase())){Z=aa.id;return false}});while(!Z&&V.length){V=V.substring(0,V.length-1);if(!V){break}xui.arr.each(X,function(aa){if(xui.str.startWith(aa.id.toLowerCase(),V.toLowerCase())){Z=aa.id;return false}})}if(!Z){Z=X[0].id}}if(!T.properties.$UIvalue&&!Z&&T.properties.items&&T.properties.items.length){Z=T.properties.items[0].id}if(Z){T.boxing().setUIValue(Z)}else{f();return}l.$popList.getRoot().popToTop({region:{left:S,top:Y,width:2,height:16}},1);if(l.$popHelp&&l.$popHelp.getDisplay()!="none"){l.$popHelp.getRoot().popToTop(l.$popList.getRoot(),2)}};if(!Q){W()}else{xui.resetRun(o,W,100)}};var A=function(Q,R){if(!l.$popHelp){return}if(l.$popList.getDisplay()!="none"){l.$linkAPI.setTag(Q);l.$lblTips.setCaption(Q);l.$divhelp.setHtml(R);l.$popHelp.getRoot().popToTop(l.$popList.getRoot(),2);l.$popHelp.setDisplay("")}};var M=function(Q,R){if(!l.$popHelp){return}l.$linkAPI.setTag(null);l.$lblTips.setCaption("");l.$divhelp.setHtml("");l.$popHelp.setDisplay("none")};var E=function(R){if(!l.$popHelp){return}var Q=P(R);var S=l.onGetHelpInfo&&l.boxing().onGetHelpInfo(l,Q.key);if(S){A(Q.key,S)}else{M()}};var D=function(Q){if(!l.$popHelp){return}if(!Q){return}var R=l.onGetHelpInfo&&l.boxing().onGetHelpInfo(l,Q.path);if(R){A(Q.path,R)}else{M()}};var s=function(R,S,T,Q){u=g=null;N=true;xui.resetRun(n,function(){var U=P(R);if(!U){f()}else{N=false;if(U!=T){c(U,R,true,T)}}},100);u=S;g=Q};var H=function(R,Q,S){xui.resetRun(n,function(){c(R,Q)});u=S};var q=function(R,Q,S){var W=g||u;if(W&&W.line==S.line&&W.start==S.start){var V=r.cursorCoords(true,"page"),U=V.left,T=V.top;d(U,T,R,"",true)}u=S};var a=function(S){var R=l.$cm,T=u;R.replaceRange(S,{line:T.line,ch:T.start},{line:T.line,ch:T.end});var Q=T.line,U;S.replace(/\n/g,function(){R.indentLine(++Q);U=1});R.setCursor({line:T.line+(U?1:0),ch:T.start+S.length});R.execCommand("indentAuto")};var G=l.properties.codeType,x=CONF.getRenderMode(l.properties.codeType);if(!x){x=CONF.getRenderMode("txt")}var m={value:l.properties.value||"",smartIndent:true,indentUnit:4,tabSize:4,indentWithTabs:false,mode:x.mime,keyMap:"sublime",matchBrackets:true,continueComments:"Enter",autoCloseBrackets:true,lineNumbers:true,lint:(G=="js"||G=="json"||G=="css"||G=="html")?true:false,readOnly:l.properties.readonly,styleActiveLine:true,lineWrapping:false,flattenSpans:false,highlightSelectionMatches:{showToken:/^[$\w]\w*/},foldGutter:true,gutters:["CodeMirror-lint-markers","CodeMirror-linenumbers","CodeMirror-foldgutter"],extraKeys:{Ctrl:function(){f()},"Ctrl-Q":function(Q){Q.foldCode(Q.getCursor())},"Ctrl-S":function(){f();if(l.onSaveCommand){l.boxing().onSaveCommand(l)}},"Ctrl-F":function(Q){f();RAD.EditorTool.showFindWnd(l.boxing(),{left:0,top:0},Q.getSelection())},Tab:function(Q){if(Q.doc.somethingSelected()){return CodeMirror.Pass}var R=Array(Q.getOption("indentUnit")+1).join(" ");Q.replaceSelection(R,"end","+input")},"Ctrl-D":function(Q){Q.execCommand("deleteLine")}}};var w=CONF.getStatus(),I=w.editorTheme,j=w.editorFontSize,J=w.lineWrapping;if(I){l.boxing().addCMTheme(I);m.theme=I}if(xui.isSet(J)){m.lineWrapping=!!J}var r=l.$cm=new CodeMirror(function(Q){l.getSubNode("BOX").append(Q);if(j){Q.style.fontSize=j+"px"}},m);CodeMirror.modeURL="/plugins/codemirror5/mode/%N/%N.js";CodeMirror.autoLoadMode(r,x.mode);if(l.onCodeModeSet){xui.asyRun(function(){if(!l.box){return}l.boxing().onCodeModeSet(l,x)})}if(x.mode=="null"){if(!l.$initialized){l.$initialized=true}if(l.onRendered){l.boxing().onRendered(l,true)}}else{r.on("rendered",function(Q,R){if(!l.$initialized){l.$initialized=true}if(l.onRendered){l.boxing().onRendered(l,R)}})}r.on("change",function(Q,V){if(l.$initialized&&l.onValueChanged){l.boxing().onValueChanged(l,Q.doc.getValue()!=l.properties.value)}if(G!="js"&&G!="html"){return}var U;if(V.origin=="+input"){if(V.text[0]){if(V.text[0]=="."){if(G!="js"){return}V.to.ch++;var R=Q.getTokenAt(V.to),T=R.type;if(T!==null){return}var X=Q.getCursor();s(Q.doc.indexFromPos(X),{start:++R.start,end:++R.end,line:X.line});U=true}else{if(V.text[0]!==" "){V.to.ch++;var R=Q.getTokenAt(V.to),T=R.type;if(T=="variable"||T=="variable-2"||T=="keyword"||T=="property"){var X=Q.getCursor();if(X.line==V.to.line&&X.ch>=R.start&&X.ch<=R.end){if(B){q(R.string,Q.doc.indexFromPos(X),{start:R.start,end:R.end,line:X.line})}else{if(T=="property"){if(G!="js"){return}var S=Q.getTokenAt({line:V.to.line,ch:V.to.ch-R.string.length});if(S.type!==null||S.string!=="."){return}s(Q.doc.indexFromPos(X)-V.text.length-1,null,R.string,{start:++S.start,end:++S.end,line:X.line})}else{H(R.string,Q.doc.indexFromPos(X),{start:R.start,end:R.end,line:X.line})}}U=true}}}}}}else{if(V.origin=="+delete"){if(B){var R=Q.getTokenAt(V.to),T=R.type,W=R.string;if(B===true){if(T=="variable"||T=="variable-2"||T=="keyword"){var X=Q.getCursor();if(X.line==V.to.line&&X.ch>=R.start&&X.ch<=R.end){q(R.string,Q.doc.indexFromPos(X),{start:R.start,end:R.end,line:X.line});U=true}}}else{if(B===1){if(T=="property"){var X=Q.getCursor();q(R.string,Q.doc.indexFromPos(X),{start:R.start,end:R.end,line:X.line});U=true}else{if(T===null&&W=="."){var X=Q.getCursor();s(Q.doc.indexFromPos(X),{start:++R.start,end:++R.end,line:X.line});U=true}}}}}}}if(!U){f()}});r.on("blur",function(){});r.on("keypress",function(Q,R){if(G!="js"&&G!="html"){return}if(N&&xui.Event.getKey(R)[0]!="."){f()}});r.on("keydown",function(Q,R){if(G!="js"&&G!="html"){return}if(N&&xui.Event.getKey(R)[0]!="."){f()}});r.on("cursorActivity",function(Q){if(!Q.hasFocus()){return}if(G!="js"&&G!="html"){return}if(u){var S=Q.getCursor(),R=u;if(S.line!==R.line||S.ch<R.start||S.ch>R.end){f()}}xui.resetRun("cm_showtips",function(){var V=Q.state.matchHighlighter;if(V){if(V.overlay&&V.style=="matchhighlight"&&Q.doc.somethingSelected()){var W=Q.getCursor(),U=Q.doc.getSelection(),T=Q.getTokenAt(W);if(U===T.string){s(Q.doc.indexFromPos(W),{start:T.start,end:T.end,line:W.line},T.string)}}}},200)})},_onresize:function(d,c,a){var b=arguments.callee.upper.apply(this,arguments);d.getSubNode("BOX").cssSize(b);if(d.$cm){d.$cm.setSize(d.$px(b.width),d.$px(b.height))}}}});xui.Class("RAD.expression.CodeEditor",["xui.UI.Widget","xui.absValue"],{Instance:{activate:function(){var a=this.get(0);if(a.$cm){a.$cm.focus()}if(a.$cm){a.$cm.doc.setCursor(a.readonly_head||0+1,0)}return this},getCM:function(){return this.get(0).$cm},resetEditorStyle:function(e,b,d,a){this.addCMTheme(e);var c=this.get(0);if(!a){a=c.$cm}if(a){a.setOption("theme",e);a.setOption("lineWrapping",!!d);var f=a.getWrapperElement();if(f){f.style.fontSize=b+"px"}}},showModeSelDlg:function(d){var c=this,a=c.getCM(),b=c.get(0),e=function(f){if(!f||f.mode==="none"){if(!b.$initialized){b.$initialized=true}if(b.onRendered){b.boxing().onRendered(b,true)}}else{a.setOption("mode",f.mime||f.mode);CodeMirror.autoLoadMode(a,f.mode);if(b.onCodeModeSet){b.boxing().onCodeModeSet(b,f)}}b=a=null};xui.ModuleFactory.newCom("RAD.expression.SelRenderMode",function(){this.setEvents("onSel",e);this.mainDlg.showModal();this.modeList.setValue(d.mime+":"+d.mode)})},addCMTheme:function(b){var a=this.get(0);var c="cm-theme-"+b;if(b!="default"&&!xui.CSS.get("id",c)){xui.CSS.includeLink("codemirror5/theme/"+b+".css",false,c)}},clearHistory:function(){var a=this.get(0).$cm;if(a){a.clearHistory()}},reindent:function(){var a=this.get(0).$cm,e=a.doc;if(e.somethingSelected()){var f=e.getCursor("start"),d=e.getCursor("end");for(var c=f.line,b=d.line;c<=b;c++){a.indentLine(c)}}else{var f=e.firstLine(),d=e.lastLine();for(var c=f,b=d;c<=b;c++){a.indentLine(c)}}},callEditor:function(c,b,a){var d=this.get(0).$cm;if(a){d=d.doc}return d[c].apply(d,b||[])},searchCode:function(c){var b=this.get(0),a=b.$cm;if(a){var d=a.getSearchCursor(c,a.hasFocus()?a.doc.getCursor():{pos:0,line:0},true);if(d.findNext()){a.focus();a.doc.setSelection(d.from(),d.to())}}},locateTo:function(m,l,f){var j=this,c=this.get(0),n=c.$cm,d,b,a,e;if(n){d=RAD.ClassTool.getClassStruct2(n.doc.getValue());if(m){if(l&&(m=="Static"||m=="Instance")){b=xui.get(d,["sub",m,"sub",l])}else{b=xui.get(d,["sub",m])}}if(b){if(f){n.doc.setSelection(n.doc.posFromIndex(b.from),n.doc.posFromIndex(b.to))}else{var g=n.doc.posFromIndex(b.from);n.focus();n.doc.setCursor(g);n.scrollIntoView(g)}return true}}return false},focusLine:function(b){var d=this,c=this.get(0),a=c.$cm,e={line:b,ch:0};if(a){a.focus();a.doc.setCursor(e);a.scrollIntoView(e)}},getLine:function(l,j,f){var g=this,c=this.get(0),m=c.$cm,d,b,a,e;if(m){d=RAD.ClassTool.getClassStruct2(m.doc.getValue());if(l){if(j&&(l=="Static"||l=="Instance")){b=xui.get(d,["sub",l,"sub",j])}else{b=xui.get(d,["sub",l])}}if(b){return m.doc.posFromIndex(b.from)}}return null},addCodeInto:function(n,m,a,f,e){e=e||"";var l=this,b=this.get(0),o=b.$cm;if(o){var d=RAD.ClassTool.getClassStructWithScope(o.getValue()),g=xui.get(d,["sub",n,"sub",m]),c;if(g){o.doc.replaceRange(a,o.doc.posFromIndex(g.from),o.doc.posFromIndex(g.to))}else{if(e){e+="\n"}g=xui.get(d,["sub",n]);if(!g){c=xui.get(d,["sub",d.arr[d.arr.length-1]]);if(c){a=",\n"+e+n+":{\n"+m+":"+(f?"function()":"")+a+"\n}"}else{a=n+":{\n"+e+m+":"+(f?"function()":"")+a+"\n}\n";c=d;c.to--}}else{c=xui.get(g,["sub",g.arr[g.arr.length-1]]);if(c){a=",\n"+e+m+":"+(f?"function()":"")+a}else{a=e+m+":"+(f?"function()":"")+a+"\n";c=g;c.to--}}var j=o.doc.posFromIndex(c.to);o.doc.replaceRange(a,j,j);o.doc.setSelection(j,o.doc.posFromIndex(c.to+a.length));l.reindent()}}},getBlockInfo:function(e,d){var c=this,b=this.get(0),a=b.$cm;return a&&xui.get(RAD.ClassTool.getClassStructWithScope(a.getValue()),["sub",e,"sub",d])},_refreshCM:function(){if(this.get(0).$cm){this.get(0).$cm.refresh()}},_setCtrlValue:function(a){if(!xui.isSet(a)){a=""}return this.each(function(b){if(b.$cm&&b.$cm.getValue()!=a){b.$cm.doc.setValue(a);if(b.$tm1){b.$tm1.clear()}if(b.$tm2){b.$tm2.clear()}delete b.$tm1;delete b.$tm2;delete b.readonly_head;delete b.readonly_tail}})},_getCtrlValue:function(){var a=this.get(0);if(a.$cm){return a.$cm.doc.getValue()}else{return a.properties.$UIvalue}},setReadonlyLines:function(b,a){var c=this.get(0),e=c.$cm.doc;if(c.$tm1){c.$tm1.clear()}if(c.$tm2){c.$tm2.clear()}if(b){c.$tm1=e.markText({line:0,ch:0},{line:b,ch:0},{atomic:true,readOnly:true,css:"background-color:#ccc;"})}if(a){var d=e.lastLine();c.$tm2=e.markText({line:d-a},{line:d},{atomic:true,readOnly:true,css:"background-color:#ccc;"})}c.readonly_head=b;c.readonly_tail=a}},Initialize:function(){var a=this.getTemplate();xui.merge(a.FRAME.BORDER,{BOX:{tagName:"div"}},"all");this.setTemplate(a);this.__trim=function(b){if(/[^\s\uFEFF\xA0]/.test(b)){return xui.str.trim(b)}else{return b}}},Static:{$tempsandbox:"_$temp_for_xui_sandbox",$tempsandbox2:"_$temp_for_xui_sandbox2",$temppool:"_$temp_for_xui_pool",Appearances:{BOX:{width:"100%",height:"100%",left:0,top:0,position:"absolute",background:"#fff"}},Behaviors:{},DataModel:{left:0,top:0,width:200,height:200,position:"absolute",codeType:{ini:"js",action:function(a){if(this.$cm){var b=CONF.getRenderMode(a);if(!b){b=CONF.getRenderMode("txt")}this.$cm.setOption("mode",b.mime||b.mode);if(this.onCodeModeSet){this.boxing().onCodeModeSet(this,b)}}}},readonly:{ini:false,action:function(a){if(this.$cm){this.$cm.setOption("readOnly",!!a)}}}},EventHandlers:{onValueChanged:function(b,a){},onRendered:function(a){},onGetHelpInfo:function(b,a){},onCodeModeSet:function(a,b){},onSaveCommand:function(){}},RenderTrigger:function(){var b=this.box.$temppool,a=this.$xid;this.box._loadEditor(this);this.destroyTrigger=function(){this.$cm.clearGutter();this.$cm.clearHistory();delete this.$cm;delete this.$tm1;delete this.$tm2;delete this.$editor;if(this.$popList){this.$popList.destroy()}if(this.$popHelp){this.$popHelp.destroy()}if(this.$popCustom){this.$popCustom.destroy()}if(window[b]){delete window[b][a]}}},clearSandbox:function(a){for(var b=1,d;b<9;b++){d=a+b;if(d&&document.getElementById(d)){document.body.removeChild(document.getElementById(d));try{delete frames[d]}catch(c){}}}},purge:function(){var a=this,b;if((b=window[a.$temppool])&&b.Instance&&b.Instance._ctrlpool){xui.each(b.Instance._ctrlpool,function(d,c){if(d&&!d.destroyed){if(d.destroy){d.destroy()}if(d.boxing&&d.boxing()){d.boxing().destroy()}}});xui.breakO(b.Instance)}},_alias:1,evalInSandbox:function(code,funScope,name,subCacheKey,purge,beforeCode,afterCode,cleanFun){if(name&&document.getElementById(name)){document.body.removeChild(document.getElementById(name));try{delete frames[name]}catch(e){}}var ns=this,iframe=document.createElement("iframe"),result,wnd,line,errmsg,type;ns.purge();if(name){iframe.name=name;iframe.id=name}iframe.src="about:blank";iframe.style.display="none";document.body.appendChild(iframe);wnd=frames[frames.length-1];wnd.document.open();wnd.document.write('<meta http-equiv="content-type" content="text/html; charset=utf-8" />');wnd.document.write("<script>\n");if(beforeCode){wnd.document.write(beforeCode)}wnd.document.write("global=process=Buffer=require=module=exports=root=null;\nwindow.xui=parent.xui;\nwindow.Class=function(){return xui.Class.apply(xui,arguments);};\nwindow.CONF={mixed_prop: xui.clone(parent.CONF.mixed_prop) };\n"+(CONF.SandBoxExtCode||"")+"window.__cache={};window.__getThis=function(pname,type){\n      if(__cache[pname+':'+type])return __cache[pname+':'+type];\n      var obj=type==1?function(){}:{};\n      if(pname){\n          if(xui.isArr(pname)){\n              xui.each(pname,function(cls){\n                  cls=xui.SC(cls);\n                  obj=xui.merge(obj, type==1?(cls||xui.Module):(cls?(new cls):(new xui.Module)),'all',true)\n              });\n          }else{\n              pname=xui.SC(pname);\n              obj=xui.merge(obj, type==1?(pname||xui.Module):(pname?(new pname):(new xui.Module)),'all',true)\n          }\n      }\n      if(window['"+ns.$temppool+"'] && window['"+ns.$temppool+"']['"+subCacheKey+"']){\n          obj=xui.merge(obj, window['"+ns.$temppool+"']['"+subCacheKey+"'][type==1?'Static':'Instance'],'all')\n      }\n      return __cache[pname+':'+type]=obj;\n  };\nwindow['"+ns.$temppool+"']=parent['"+ns.$temppool+"'];\nparent['"+ns.$tempsandbox+"']=/*@cc_on !@*/0?this:{eval:function(s){return (function(){var b=arguments.callee;return window.eval.call(window,s)})()}};\nparent['"+ns.$tempsandbox2+"']={getErrLine:function(s,cb){window.onerror=function(){cb.apply(null,arguments);return true;};var n=document.createElement('script');n.type='text/javascript';if(/*@cc_on !@*/0){n.text=s;}else{n.appendChild(document.createTextNode(s));};document.body.appendChild(n);window.onerror=null;}};\ntry{top=parent=null;}catch(e){}");if(afterCode){wnd.document.write(afterCode)}wnd.document.write("<\/script><body><span id='abc'></span></body>");wnd.document.close();var bak=xui.Dom.pack,bak1=xui.absProfile.prototype.$link,bak11=xui.absObj.$pickAlias,bak12=xui.UIProfile.prototype.setDomId,bak2=xui.require,bak3=xui.$cache,bak4=xui.asyRun,bak5=xui.resetRun,bak6=xui.exec,bak7=xui.pseudocode._callFunctions;try{xui.Dom.pack=function(){var o=new xui.Dom(false),d=document.getElementById("abc");o._nodes=[d];return o};xui.absProfile.prototype.$link=function(){return this};xui.Class.$instanceCreated=function(instance){instance.$inDesign=1};xui.absObj.$pickAlias=function(){return ns._alias++};xui.UIProfile.prototype.setDomId=function(){return this};xui.require=function(){};xui.$cache={};xui.each(bak3,function(o,i){xui.$cache[i]=xui.isArr(o)?[]:{}});xui.asyRun=xui.resetRun=xui.exec=xui.pseudocode._callFunctions=function(){};result=window[ns.$tempsandbox].eval(code);if(funScope){if(typeof(result)=="function"){result.call(funScope)}}type=(result===wnd||result===wnd.content)?"window":result===wnd.console?"console":result===wnd.history?"history":result===wnd.screen?"screen":result===wnd.location?"location":result===wnd.navigator?"navigator":result===wnd.document?"document":null;if(xui.browser.newie||(xui.browser.ie&&xui.browser.ver>=9)){var fun=function(hash){for(var i in hash){if(xui.isFun(hash[i])){hash[i]._____string=hash[i]+""}else{if(xui.isHash(hash[i])){fun(hash[i])}else{if(xui.isArr(hash[i])){fun(hash[i])}}}}};if(type===null&&(xui.isHash(result)||xui.isArr(result))){fun(result)}}}catch(e){if(xui.isSet(e.line||e.lineNumber)){line=e.line||e.lineNumber}else{var base=0;if(xui.browser.ie){window[ns.$tempsandbox2].getErrLine("var _a={;",function(a,b,c){base=c-1;return true})}window[ns.$tempsandbox2].getErrLine(code,function(a,b,c){line=c-base;return true})}errmsg=((e.name?e.name+" : ":"")+(e.description||e.message||"")+(line?"\n line : "+line:""));if(!xui.isSet(line)&&/.*at line ([\d]+).*/.test(errmsg)){line=errmsg.replace(/.*at line ([\d]+).*/,"$1")}}finally{if(purge){ns.purge()}delete xui.Class.$instanceCreated;xui.Dom.pack=bak;xui.absProfile.prototype.$link=bak1;xui.absObj.$pickAlias=bak11;xui.UIProfile.prototype.setDomId=bak12;xui.require=bak2;xui.$cache=bak3;xui.asyRun=bak4;xui.resetRun=bak5;xui.exec=bak6;xui.pseudocode._callFunctions=bak7;if(cleanFun){cleanFun(wnd,iframe)}wnd.CONF=wnd.Class=wnd.xui=wnd[ns.$temppool]=wnd.__getThis=wnd.__cache=null;if(CONF.ClearSandBoxExtCode){CONF.ClearSandBoxExtCode(wnd)}window[ns.$tempsandbox]=null;window[ns.$tempsandbox2]=null;var rsl={ok:result,type:type,ko:errmsg,line:line};ns=bak=result=line=errmsg=type=null;if(!name){document.body.removeChild(iframe)}iframe=null;return rsl}},_buildItem:function(j,d,c,g,b,f,a,e){return{id:j,caption:b||j,value:f||j,tag:(a||(d=="property"?"b":d=="function"?"c":d=="class"?"d":d=="event"?"e":"a"))+":"+j.toLowerCase(),path:(c?(c+"."):"")+j,itemStyle:e,imageClass:!d?null:(d=="property"?(xui.isSet(g)&&xui.isHash(g))?"spafont spa-icon-hash":(xui.isSet(g)&&xui.isArr(g))?"spafont spa-icon-array":"spafont spa-icon-var":d=="var"?"spafont spa-icon-var":d=="event"?"spafont spa-icon-action":d=="function"?"spafont spa-icon-function":d=="class"?"spafont spa-icon-class":"spafont spa-icon-prop")}},_intellcache:{},_enumKeys:function(r,x,A,s){if(!xui.isObj(r)||xui.isArr(r)){return[]}A=A!==false;var u=this,b=r.$xui$,a,m,q=[];for(var g in r){if("prototype"==g||"constructor"==g){continue}if(b){if("upper"==g||"After"==g||"Before"==g||"Instance"==g||"Static"==g||"Constructor"==g){continue}}try{if(g.charAt(0)!="_"&&g.charAt(0)!="$"&&/^[\w_]+$/.test(g)){a=r[g];if(A&&(a&&a.$abstract)){continue}m=typeof a=="function"&&(!(a&&a.$xui$)||a.$asFunction);if(s&&(!r.hasOwnProperty(g)||!r.propertyIsEnumerable(g))){continue}var w=g;if(m){if(A){var j=xui.fun.args(a);var f=false;if(xui.str.endWith(x,".prototype")){f=true}var B=RAD.ClassTool.getArgsFromAPI(x.replace(".prototype",""),g,f);if(B){j=[];for(var d=0,c=B.length;d<c;d++){j[d]=B[d]&&B[d].name}}w=g+"("+j.join(", ")+")"}else{w=g+"( )"}}q.push(u._buildItem(g,(typeof a=="function")?(a&&a.$xui$&&!a.$asFunction)?"class":(a&&a.$event$)?"event":"function":"property",x,a,w,w))}}catch(n){console.log(n)}}return q},_getIntellisenseList:function(key,cachedata){if(!key){return null}cachedata=cachedata!==false;var ns=this,cache=ns._intellcache,buildItem=ns._buildItem;if(cachedata&&cache[key]){return cache[key]}var list=[];if(key==ns.$temppool){return[]}switch(key){case" variables ":list=[buildItem("xui",0,0,0,0,0,2,"font-weight:bold;color:#ff0000;"),buildItem("xui()",0,0,0,"xui()","xui()",2,"font-weight:bold;color:#ff0000;"),buildItem("top",0,0,0,0,0,3,"font-weight:bold;"),buildItem("parent",0,0,0,0,0,3,"font-weight:bold;"),buildItem("window",0,0,0,0,0,3,"font-weight:bold;"),buildItem("document",0,0,0,0,0,3,"font-weight:bold;"),buildItem("navigator",0,0,0,0,0,3,"font-weight:bold;"),buildItem("history",0,0,0,0,0,3,"font-weight:bold;"),buildItem("location",0,0,0,0,0,3,"font-weight:bold;"),buildItem("screen",0,0,0,0,0,3,"font-weight:bold;"),buildItem("Math",0,0,0,0,0,3,"font-weight:bold;"),buildItem("Number",0,0,0,0,0,3,"font-weight:bold;"),buildItem("console",0,0,0,0,0,3,"font-weight:bold;"),buildItem("if  ",0,0,0,"if...","if(){\n\n}",5),buildItem("ifelse",0,0,0,"if...else...","if(){\n\n}else{\n\n}",5),buildItem("while",0,0,0,"while...","while(){\n\n};",5),buildItem("do  ",0,0,0,"do...while","do{\n\n}while();",5),buildItem("try  ",0,0,0,"try...catch...finally","try{\n\n}catch(e){\n\n}finally{\n\n}",5),buildItem("for  ",0,0,0,"for...","for(;;;){\n\n}",5),buildItem("forin  ",0,0,0,"for...in","for( in ){\n\n}",5),buildItem("function",0,0,0,"function...","function(){\n\n}",5),buildItem("switch",0,0,0,"switch...","switch(){\n  case : \n\n  break;\n  case : \n\n  break;\ndefault: \n\n}",5),buildItem("with",0,0,0,"with...","with(){\n\n}",5),buildItem("return",0,0,0,"return","return ",4),buildItem("break",0,0,0,"break","break;",4),buildItem("continue",0,0,0,"continue","continue;",4),buildItem("throw",0,0,0,"throw","throw ",4),buildItem("new ",0,0,0,"new","new ",4),buildItem("delete",0,0,0,"delete","delete ",4),buildItem("arguments",0,0,0,"arguments","arguments",4),buildItem("var",0,0,0,"var","var ",4),buildItem("case",0,0,0,"case","case :",4),buildItem("default",0,0,0,"default","default :",4),buildItem("typeof",0,0,0,"typeof","typeof ",4),buildItem("instanceof",0,0,0,"instanceof","instanceof ",4),buildItem("void",0,0,0,"void","void",4),buildItem("true",0,0,0,"true","true",4),buildItem("false",0,0,0,"false","false",4),buildItem("null",0,0,0,"null","null",4),buildItem("NaN",0,0,0,"NaN","NaN",4),buildItem("undefined",0,0,0,"undefined","undefined",4),buildItem("Infinity",0,0,0,"Infinity","Infinity",4),buildItem("decodeURI()","function"),buildItem("decodeURIComponent()","function"),buildItem("encodeURI()","function"),buildItem("encodeURIComponent()","function"),buildItem("escape()","function"),buildItem("eval()","function"),buildItem("isFinite()","function"),buildItem("parseFloat()","function"),buildItem("parseInt()","function"),buildItem("unescape()","function"),buildItem("Number()","function"),buildItem("String()","function"),buildItem("keySet[",0,0,0,"PK[0]","PK[0]",5),buildItem("PK",0,0,0,"PK['0']","PK['0']",4,"font-weight:bold;"),buildItem("absField",0,0,0,"absField()","absField(filed1,filed2,value,units)",5)];break;case"new":list=[buildItem("String","class",0,0,0,"String();",1),buildItem("Object","class",0,0,0,"Object();",1),buildItem("Array","class",0,0,0,"Array();",1),buildItem("RegExp","class",0,0,0,"RegExp();",1),buildItem("Boolean","class",0,0,0,"Boolean();",1),buildItem("Number","class",0,0,0,"Number();",1),buildItem("Date","class",0,0,0,"Date();",1),buildItem("xui.Dom","class",0,0,0,"xui.Dom();",2),buildItem("xui.UIProfile","class",0,0,0,"xui.UIProfile();",2),buildItem("xui.Module","class",0,0,0,"xui.Module();",2),buildItem("xui.Template","class",0,0,0,"xui.Template();",2),buildItem("xui.UI","class",0,0,0,"xui.UI();",2),buildItem("xui.DataBinder","class",0,0,0,"xui.DataBinder();",2)];for(var i in xui.UI){if(i!="upper"&&xui.UI[i].$xui$){list.push(buildItem("xui.UI."+i,"class",0,0,0," xui.UI."+i+"();",2))}}break;case"history":case"screen":break;case"PK[":buildItem("PK['0']",0,0,0,"PK['0']","PK[0]",5);break;case"console":list=[buildItem("log()","function",key)];break;case"arguments":list=[buildItem("callee","property",key),buildItem("length","property",key)];break;case"arguments.callee":list=[buildItem("caller","property",key),buildItem("length","property",key),buildItem("call()","function",key),buildItem("apply()","function",key)];break;case"top":case"parent":case"window":var iframe=document.createElement("iframe");iframe.style.display="none";document.body.appendChild(iframe);var target=frames[frames.length-1];list=ns._enumKeys(target,key,false);document.body.removeChild(iframe);break;case"document":var iframe=document.createElement("iframe");iframe.style.display="none";document.body.appendChild(iframe);var target=frames[frames.length-1];list=ns._enumKeys(target.document,key,false);document.body.removeChild(iframe);break;case"Element.prototype":var iframe=document.createElement("iframe");iframe.style.display="none";document.body.appendChild(iframe);var target=frames[frames.length-1];target.document.write("<span>a</span>");list=ns._enumKeys(target.document.body.firstChild,key,false);document.body.removeChild(iframe);break;case"Math":list=[buildItem("E","property",key),buildItem("LN2","property",key),buildItem("LN10","property",key),buildItem("LOG2E","property",key),buildItem("LOG10E","property",key),buildItem("PI","property",key),buildItem("SQRT1_2","property",key),buildItem("SQRT2","property",key),buildItem("abs(x)","function",key),buildItem("acos(x)","function",key),buildItem("asin(x)","function",key),buildItem("atan(x)","function",key),buildItem("atan2(y,x)","function",key),buildItem("ceil(x)","function",key),buildItem("cos(x)","function",key),buildItem("exp(x)","function",key),buildItem("floor(x)","function",key),buildItem("log(x)","function",key),buildItem("max(x,y,z,...,n)","function",key),buildItem("min(x,y,z,...,n)","function",key),buildItem("pow(x,y)","function",key),buildItem("random()","function",key),buildItem("round(x)","function",key),buildItem("sin(x)","function",key),buildItem("sqrt(x)","function",key),buildItem("tan(x)","function",key)];break;case"Number":list=[buildItem("MAX_VALUE","property",key),buildItem("MIN_VALUE","property",key),buildItem("NEGATIVE_INFINITY","property",key),buildItem("POSITIVE_INFINITY","property",key)];break;case"Array.prototype":list=[buildItem("length","property",key),buildItem("concat()","function",key),buildItem("join()","function",key),buildItem("pop()","function",key),buildItem("push()","function",key),buildItem("reverse()","function",key),buildItem("shift()","function",key),buildItem("sort()","function",key),buildItem("concat()","function",key),buildItem("splice()","function",key),buildItem("toString()","function",key),buildItem("unshift()","function",key)];break;case"Date.prototype":list=[buildItem("getDate()","function",key),buildItem("getDay()","function",key),buildItem("getFullYear()","function",key),buildItem("getHours()","function",key),buildItem("getMilliseconds()","function",key),buildItem("getMinutes()","function",key),buildItem("getMonth()","function",key),buildItem("getTime()","function",key),buildItem("getSeconds()","function",key),buildItem("getTimezoneOffset()","function",key),buildItem("getUTCDate()","function",key),buildItem("getUTCDay()","function",key),buildItem("getUTCFullYear()","function",key),buildItem("getUTCHours()","function",key),buildItem("getUTCMilliseconds()","function",key),buildItem("getUTCMinutes()","function",key),buildItem("getUTCMonth()","function",key),buildItem("getUTCSeconds()","function",key),buildItem("getYear()","function",key),buildItem("parse()","function",key),buildItem("setDate()","function",key),buildItem("setFullYear()","function",key),buildItem("setHours()","function",key),buildItem("setMilliseconds()","function",key),buildItem("setMinutes()","function",key),buildItem("setMonth()","function",key),buildItem("setSeconds()","function",key),buildItem("setTime()","function",key),buildItem("setUTCDate()","function",key),buildItem("setUTCFullYear()","function",key),buildItem("setUTCHours()","function",key),buildItem("setUTCMilliseconds()","function",key),buildItem("setUTCMinutes()","function",key),buildItem("setUTCSeconds()","function",key),buildItem("setUTCMonth()","function",key),buildItem("setYear()","function",key),buildItem("toDateString()","function",key),buildItem("toGMTString()","function",key),buildItem("toLocaleDateString()","function",key),buildItem("toLocaleTimeString()","function",key),buildItem("toLocaleString()","function",key),buildItem("toString()","function",key),buildItem("toUTCString()","function",key),buildItem("toTimeString()","function",key),buildItem("UTC()","function",key)];break;case"Number.prototype":list=[buildItem("toExponential()","function",key),buildItem("toFixed()","function",key),buildItem("toPrecision()","function",key),buildItem("toString()","function",key)];break;case"Boolean.prototype":list=[buildItem("toString()","function",key)];break;case"Function.prototype":list=[buildItem("toString()","function",key),buildItem("call()","function",key),buildItem("apply()","function",key)];break;case"RegExp.prototype":list=[buildItem("global","property",key),buildItem("ignoreCase","property",key),buildItem("multiline","property",key),buildItem("lastIndex","property",key),buildItem("source","property",key),buildItem("compile()","function",key),buildItem("exec()","function",key),buildItem("test()","function",key)];break;case"String.prototype":list=[buildItem("length","property",key),buildItem("charAt()","function",key),buildItem("charCodeAt()","function",key),buildItem("concat()","function",key),buildItem("fromCharCode()","function",key),buildItem("indexOf()","function",key),buildItem("lastIndexOf()","function",key),buildItem("match()","function",key),buildItem("replace()","function",key),buildItem("search()","function",key),buildItem("slice()","function",key),buildItem("split()","function",key),buildItem("substr()","function",key),buildItem("substring()","function",key),buildItem("toLowerCase()","function",key),buildItem("toUpperCase()","function",key)];break;case"Object.prototype":list=[buildItem("toString()","function",key,0,0,0,"z"),buildItem("toLocaleString()","function",key,0,0,0,"z"),buildItem("hasOwnProperty(key)","function",key,0,0,0,"z"),buildItem("propertyIsEnumerable(key)","function",key,0,0,0,"z"),buildItem("isPrototypeOf(obj)","function",key,0,0,0,"z")];break;default:if(/\.prototype$/.test(key)){var bak=xui.Dom.pack,bak1=xui.absProfile.prototype.$link,bak11=xui.absObj.$pickAlias;xui.Dom.pack=function(){var o=new xui.Dom(false),d=document.getElementById("abc");o._nodes=[d];return o};xui.absProfile.prototype.$link=function(){return this};xui.absObj.$pickAlias=function(){return ns._alias++};try{var target=eval("new "+key.replace(/\.prototype$/,""));list=ns._enumKeys(target,key)}catch(e){}finally{xui.Dom.pack=bak;xui.absProfile.prototype.$link=bak1;xui.absObj.$pickAlias=bak11}}if(!list.length){var target=xui.get(window,key.split("."));list=ns._enumKeys(target,key);cachedata=false}}if(cachedata){cache[key]=list}return list},_getFromFunctionExp:function(b){var a;if(/toString\([^)]*\)$/.test(b)){a="String.prototype"}else{if(/^\s*\(?\s*new\s+([\wxui.]+)\s*\(?\s*[^)]*\)?\s*\)?(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/.test(b)){b=b.replace(/^\s*\(?\s*new\s+([\wxui.]+)\s*\(?\s*[^)]*\)?\s*\)?(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/,"$1");a=b+".prototype"}else{if(/.*\.reBoxing\(([^)]*)\)(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/.test(b)){b=b.replace(/.*\.reBoxing\(([^)]*)\)(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/,"$1");if(b){a=b.replace(/[\'\"]/g,"")+".prototype"}else{a="xui.Dom.prototype"}}else{if(b.indexOf("xui.alert(")==0||b.indexOf("xui.prompt(")==0||b.indexOf("xui.pop(")==0||b.indexOf("xui.confirm(")==0){a="xui.UI.Dialog.prototype"}else{if(b.indexOf("xui(")==0||b.indexOf("xui.use(")==0){a="xui.Dom.prototype"}else{if(b.indexOf("xui.Thread(")==0||b.indexOf("xui.Ajax(")==0||b.indexOf("xui.SAjax(")==0||b.indexOf("xui.IAjax(")==0||b.indexOf("xui.JSONP(")==0||b.indexOf("xui.XDMI(")==0){a="xui.Thread.prototype"}else{if(/.*\.(getRoot|getSubNode|getSubNodes)\s*\(\s*[^\)]*\)\s*$/.test(b)){a="xui.Dom.prototype"}else{if(/.*\.getElementById\s*\(\s*[^\)]*\)\s*$/.test(b)){a="Element.prototype"}}}}}}}}return a},_getFromObject:function(a){if(!xui.isSet(a)){return null}else{if(a===xui.str){return"xui.str"}else{if(a===xui.arr){return"xui.arr"}else{if(a===xui){return"xui"}else{if(a.$xui$){if(typeof a=="function"){return a.KEY}else{return a.KEY+".prototype"}}else{if(xui.isArr(a)){return"Array.prototype"}else{if(xui.isDate(a)){return"Date.prototype"}else{if(xui.isReg(a)){return"RegExp.prototype"}else{if(xui.isNumb(a)){return"Number.prototype"}else{if(xui.isStr(a)){return"String.prototype"}else{if(xui.isBool(a)){return"Boolean.prototype"}else{if(xui.isFun(a)){return"Function.prototype"}else{if(xui.isObj(a)){return"Object.prototype"}}}}}}}}}}}}}},_findVars:function(d,a,b){var j=this,m=d.$editor,f=[];if(m&&a){var l=m.win.document,g=function(u){return u.tagName=="BR"||u.tagName=="br"},s=function(u){return u.tagName=="B"||u.tagName=="b"},c=l.body.firstChild,r="",q,e,o=[],n;n=f;n.push(["this",""]);while((c=c.nextSibling)&&c!=a){if(s(c)&&c._uid&&c.id.charAt(0)=="b"){if(!b||b.indexOf(c.id)!==0){c=l.getElementById("e"+c.id.slice(1))}else{r=c._uid;xui.arr.each(o,function(u){u[1]=r});f=f.concat(o)}o=[];n=f}q=j.__trim(c.className);e=j.__trim(c.currentText);if(q=="js-keyword"&&e=="function"){while((c=c.nextSibling)&&c!=a&&(g(c)||j.__trim(c.className)=="whitespace"||j.__trim(c.className)=="js-comment")){}q=j.__trim(c.className);e=j.__trim(c.currentText);if(q=="js-variabledef"){n.push([e,r])}n=o;n.push(["this",r])}if(q=="js-variabledef"){n.push([e,r])}}}return f},_$key:function(a){ns=this;list=[ns._buildItem("$currPerson",0,0,0,"$currPerson","$currPerson",5),ns._buildItem("$currPerson.name",0,0,0,"name","name",5)];if(a=="$"){xui.Ajax("/admin/el/searchKey",{projectName:SPA.curProjectName},function(b){var c=b;if(!c||c.error){xui.message("No module in this project!")}else{xui.arr.each(c.data,function(e){var d=ns._buildItem(e.id,0,0,0,e.desc,e.expression,5);list.push(d)})}},null,null,{method:"post",asy:false}).start()}if(xui.str.startWith(a,"$")&&xui.str.endWith(a,".")){xui.Ajax("/admin/el/searchMethod",{projectName:SPA.curProjectName,key:a},function(b){var c=b;if(!c||c.error){xui.message("No module in this project!")}else{xui.arr.each(c.data,function(e){var d=ns._buildItem(e.id,0,0,0,e.desc,e.lastStr,5);list.push(d)})}},null,null,{method:"post",asy:false}).start()}return list},_getIntellisense:function(d,D,g,A){var E=this,s=RAD.ClassTool._this;if(xui.str.startWith(D,"$")){type="$"}else{if(D.indexOf("new ")==0){type="new"}else{if(D.charAt(D.length-1)=="."){type="properties";D=D.slice(0,-1)}else{if(D.indexOf(".")!=-1){type="properties";D=D.slice(0,D.lastIndexOf("."))}else{type="var"}}}if(type=="properties"){if(D.indexOf("(")!=-1){type="function"}}}var C,a,B=[],r,j,u=[];switch(type){case"new":r=type;break;case"$":B=this._$key(D);break;case"function":type=E._getFromFunctionExp(D);if(type){r=type;break}case"properties":if(D=="arguments"||D=="arguments.callee"){r=D;break}else{var c=[],l=[],a=d.$cm.getValue(),q=RAD.ClassTool.getContextAssignments(a,g),n=RAD.ClassTool.getClassStructWithScope(a,g,E.$temppool,d.$xid);c.push("(function(){try{\n");c.push("var "+s+"=window;\n");l.push(s);var f=false,e=false,x=q.vars.length;for(var w=0;w<x;w++){c.push("var "+q.vars[w]+"=undefined;\n");l.push(q.vars[w])}for(var w=-1;w<x;w++){if(q.scopeS==-1||w>=q.scopeS){if(!f){f=true;var m;if(q.secondKey&&q.secondType=="function"){m=xui.get(n,["sub",q.firstKey,"sub",q.secondKey])}else{if(q.firstKey&&q.firstType=="function"){m=xui.get(n,["sub",q.firstKey])}}if(m){c.push("try{"+s+"="+m._this+"}catch(e){};\n");xui.arr.each(m.argsv,function(o,F){if(!m.args||!m.args[F]){return false}if(o.code){c.push("try{"+m.args[F]+"="+o.code+"}catch(e){};\n");l.push(m.args[F])}else{if(/\.prototype$/.test(o.type)){c.push("try{"+m.args[F]+"="+o.type.replace(/(.+)(\.prototype)$/,"new $1();")+"}catch(e){};\n");l.push(m.args[F])}else{c.push("try{"+m.args[F]+"="+o.type+"}catch(e){};\n");l.push(m.args[F])}}})}}}if(q.scopeS!=-1&&w>=q.scopeE){if(!e){e=true;c.push("try{"+s+"=window;}catch(e){};\n")}}if(w>=0){c.push("try{"+q.vars[w]+"="+q.code[w]+";}catch(e){};\n");l.push(q.vars[w])}}if(q.scopeS!=-1&&q.outscope){if(!e){c.push("try{"+s+"={};}catch(e){};\n")}}c.push("return ("+D+");\n}catch(e){}finally{\n");xui.arr.removeValue(l,D);c.push(l.join("=")+"=null;\n");c.push("}\n}).call({});\n");j=c.join("").replace(/\bthis\b/g,s)}break;case"var":r=" variables ";var b=RAD.ClassTool.getContextVars_fast(d.$cm,g);if(b["this"]){u.push(E._buildItem("this",0,0,0,0,0,1,"color:#ff0000;"));delete b["this"]}if(b["arguments"]){u.push(E._buildItem("arguments",0,0,0,0,0,1,"color:#ff0000;"));delete b["arguments"]}xui.each(b,function(G,F){u.push(E._buildItem(F,"var",0,0,0,0,1,"color:#666;"))});break}if(u&&u.length){if(!A){Array.prototype.push.apply(B,u)}}if(j){result=E.evalInSandbox(j,false,null,d.$xid);if(xui.isSet(result.ok)){if(result.type){r=result.type}else{r=E._getFromObject(result.ok);if(!A){Array.prototype.push.apply(B,E._enumKeys(result.ok,r,true,true))}}}}if(r){if(!A){Array.prototype.push.apply(B,E._getIntellisenseList(r))}}if(B.length){B=xui.arr.removeDuplicate(B,"id");xui.arr.stableSort(B,function(o,F){return o.tag>F.tag?1:o.tag==F.tag?0:-1})}return[r,B,D]},_loadEditor:function(l){var O=this,F=RAD.ClassTool._this;var B=false,u=null,g=null,n="CodeEditor.showSuggetion.resetRun",o="CodeEditor.adjustSuggetion.resetRun",b="",N=false,L;var P=function(V){var Q=/\s+/g,U=[],T="",Y=l.$cm,W=Y.doc.posFromIndex(V),aa=W.line,R=Y.getTokenAt(W),S=function(ac){if(ac.start===0){W.line--;if(W.line===0){return null}var ab=Y.doc.getLine(W.line);if(ab){W.ch=ab.length}else{return null}}else{W.ch=ac.start}return Y.getTokenAt(W)};if(!(R.type===null&&R.string==".")){T=O.__trim(R.string);R=S(R)}if(R&&(R.type===null&&R.string==".")){do{if(R.type===null&&R.string=="."){while(R=S(R)){if(!(!R||R.type=="comment"||R.type=="tab"||(R.type===null&&/^\s+$/.test(R.string)))){break}}if(R){var Z="";if(R.type===null&&R.string===")"){var X=0;do{if(R.type===null&&R.string===")"){X++}if(R.type===null&&R.string==="("){X--}if(R.string){Z=R.string+Z}}while((R=S(R))&&X!==0)}if(R){if(R.type=="property"||R.type=="variable"||R.type=="variable-2"||R.type=="xuiglobal"||(R.type=="keyword"&&R.string=="this")){U.push(R.string.replace(Q,"")+Z)}else{if(Z){U.push(Z)}else{break}}}}}else{break}}while(R=S(R))}else{if(R&&(R.type==null&&R.string===" ")){while(R=S(R)){if(!(!R||R.type=="comment"||(R.type==null&&R.string===" "))){break}}if(R.type=="keyword"&&R.string=="new"){T="new "+T}}}return(U.length?(U.reverse().join(".")+"."):"")+T};var e=function(){var S=this,R=[],Q=function(T){R.push(T.get(0))};Q((new xui.UI.Pane).setHost(S,"$popList").setLeft(10).setTop(10).setWidth(300).setHeight(180));S.$popList.append((new xui.UI.List).setHost(S,"$lstsug").setTheme("codemirror").setDirtyMark(false).setTop(18).setWidth(300).setHeight(162).setItemRow(true).setDisableHoverEffect(true));S.$popList.append((new xui.UI.Block).setHost(S,"block1").setLeft(0).setTop(0).setWidth(300).setHeight(24).setBorderType("flat"));S.block1.append((new xui.UI.Label).setHost(S,"$objType").setLeft(6).setTop(2).setWidth(252).setCaption("").setHAlign("left").setCustomStyle({KEY:"font-weight:bold;"}));Q((new xui.UI.Block).setHost(S,"$popHelp").setLeft(410).setTop(10).setWidth(300).setHeight(180).setBorderType("flat").setOverflow("hidden").setBackground("#FFF8DC"));S.$popHelp.append((new xui.UI.Div).setHost(S,"$divhelp").setTheme("codemirror").setLeft(-1).setTop(19).setWidth(300).setHeight(160).setCustomStyle({KEY:"overflow:auto; padding:4px;"}));S.$popHelp.append((new xui.UI.Block).setHost(S,"block3").setLeft(-1).setTop(-1).setWidth(300).setHeight(20).setBorderType("flat"));S.block3.append((new xui.UI.Link).setHost(S,"$linkAPI").setLeft("auto").setRight(2).setTop(1).setCaption("$RAD.JSEditor.clickapi"));S.block3.append((new xui.UI.Label).setHost(S,"$lblTips").setLeft(6).setTop(2).setWidth(133).setCaption("").setHAlign("left"));return R};var K={moveFocus:function(T){var V=l.$lstsug,Q=V.get(0).properties.items,S=Q.length,U=V.getUIValue(),R=xui.arr.subIndexOf(Q,"id",U);if(T===true){R=0}else{if(T===false){R=S-1}else{R+=T;if(R<0){R=0}if(R>S-1){R=S-1}}}if(Q[R]){V.setUIValue(Q[R].id,true)}},close:function(){f()},pick:function(){var U=l.$lstsug,Q=U.get(0).properties.items,S=Q.length,T=U.getUIValue(),R=xui.arr.subIndexOf(Q,"id",T);if(Q[R]){a(Q[R].value||Q[R].caption)}f()}};var C={Up:function(){K.moveFocus(-1)},Down:function(){K.moveFocus(1)},PageUp:function(){K.moveFocus(-8,true)},PageDown:function(){K.moveFocus(8,true)},Home:function(){K.moveFocus(true)},End:function(){K.moveFocus(false)},Enter:function(){K.pick()},Tab:function(){K.pick()},Esc:function(){K.close()}};var c=function(af,V,S,Q){var X=l.box._getIntellisense(l,af,V),W=X[0],ac=this,Y=X[1];Q=Q||af||"";if(!W&&!(Y&&Y.length)){f();return}if(!S){var ag=false,aa=Q.toLowerCase();xui.arr.each(Y,function(ah){if(xui.str.startWith(ah.id.toLowerCase(),aa)){ag=true;return false}});if(!ag){return}}var ad=r.cursorCoords(true,"page"),R=ad.left,ab=ad.top;if(!l.$popList){e.call(l);xui("body").append(l.$popList.setDisplay("none"));xui("body").append(l.$popHelp.setDisplay("none"));l.$divhelp.getRoot().setSelectable(true);l.$linkAPI.onClick(function(ah){CONF.openAPI(ah.properties.tag)});var T=true,U=function(){xui.resetRun("codemirror:aaa",function(){if(T&&l.$popCustom){l.$popCustom.setDisplay("none")}})};l.$lstsug.afterUIValueSet(function(aj,ai,ah){D(aj.getItemByItemId(ah))}).onClick(function(ah,ai){a(ai.value||ai.caption);f()})}if((Y&&Y.length)||S){B=S?1:true;if(Y&&Y.length){l.$lstsug.setItems(Y)}var Z=function(){f()},ae=xui([l.$popList.getRootNode(),l.$popHelp.getRootNode(),l.getSubNode("BOX").get(0)]);l.$popList.getRoot().popToTop({region:{left:R,top:ab,width:2,height:16}},1).setBlurTrigger(n,Z,ae);xui.Event.keyboardHook("esc",0,0,0,Z);l.$popList.setDisplay("");L=X[2]||null;if(Y&&Y.length){d(R,ab,Q,"",true,true)}}l.$objType.setCaption(W||"none");l.$cm.removeKeyMap(C);l.$cm.addKeyMap(C)};var f=function(){xui.Event.keyboardHook("esc",0,0,0);l.$cm.removeKeyMap(C);xui.resetRun(n);xui.resetRun(o);u=null;g=null;B=false;N=false;if(l.$popList){l.$objType.setCaption("");l.$lstsug.setItems([]).setUIValue(null);l.$popList.setDisplay("none");l.$lblTips.setCaption("");l.$divhelp.setHtml("");l.$popHelp.setDisplay("none");if(l.$popCustom){l.$popCustom.setDisplay("none")}b=null}};var d=function(S,Y,V,U,R,Q){if(!l.$lstsug){return}var T=l.$lstsug.get(0),X=T.properties.items,W=function(){if(R&&!B){return}var Z;if(U){V+=U}if(!xui.isSet(b)||V!==b){b=V;xui.arr.each(X,function(aa){if(xui.str.startWith(aa.id.toLowerCase(),b.toLowerCase())){Z=aa.id;return false}});while(!Z&&V.length){V=V.substring(0,V.length-1);if(!V){break}xui.arr.each(X,function(aa){if(xui.str.startWith(aa.id.toLowerCase(),V.toLowerCase())){Z=aa.id;return false}})}if(!Z){Z=X[0].id}}if(!T.properties.$UIvalue&&!Z&&T.properties.items&&T.properties.items.length){Z=T.properties.items[0].id}if(Z){T.boxing().setUIValue(Z)}else{f();return}l.$popList.getRoot().popToTop({region:{left:S,top:Y,width:2,height:16}},1);if(l.$popHelp&&l.$popHelp.getDisplay()!="none"){l.$popHelp.getRoot().popToTop(l.$popList.getRoot(),2)}};if(!Q){W()}else{xui.resetRun(o,W,100)}};var A=function(Q,R){if(!l.$popHelp){return}if(l.$popList.getDisplay()!="none"){l.$linkAPI.setTag(Q);l.$lblTips.setCaption(Q);l.$divhelp.setHtml(R);l.$popHelp.getRoot().popToTop(l.$popList.getRoot(),2);l.$popHelp.setDisplay("")}};var M=function(Q,R){if(!l.$popHelp){return}l.$linkAPI.setTag(null);l.$lblTips.setCaption("");l.$divhelp.setHtml("");l.$popHelp.setDisplay("none")};var E=function(R){if(!l.$popHelp){return}var Q=P(R);var S=l.onGetHelpInfo&&l.boxing().onGetHelpInfo(l,Q.key);if(S){A(Q.key,S)}else{M()}};var D=function(Q){if(!l.$popHelp){return}if(!Q){return}var R=l.onGetHelpInfo&&l.boxing().onGetHelpInfo(l,Q.path);if(R){A(Q.path,R)}else{M()}};var s=function(R,S,T,Q){u=g=null;N=true;xui.resetRun(n,function(){var U=P(R);if(!U){f()}else{N=false;if(U!=T){c(U,R,true,T)}}},100);u=S;g=Q};var H=function(R,Q,S){xui.resetRun(n,function(){c(R,Q)});u=S};var q=function(R,Q,S){var W=g||u;if(W&&W.line==S.line&&W.start==S.start){var V=r.cursorCoords(true,"page"),U=V.left,T=V.top;d(U,T,R,"",true)}u=S};var a=function(S){var R=l.$cm,T=u;R.replaceRange(S,{line:T.line,ch:T.start},{line:T.line,ch:T.end});var Q=T.line,U;S.replace(/\n/g,function(){R.indentLine(++Q);U=1});R.setCursor({line:T.line+(U?1:0),ch:T.start+S.length});R.execCommand("indentAuto")};var G=l.properties.codeType,x=CONF.getRenderMode(l.properties.codeType);if(!x){x=CONF.getRenderMode("txt")}var m={value:l.properties.value||"",smartIndent:true,indentUnit:4,tabSize:4,indentWithTabs:false,mode:x.mime,keyMap:"sublime",matchBrackets:true,continueComments:"Enter",autoCloseBrackets:true,lineNumbers:true,lint:(G=="js"||G=="json"||G=="css"||G=="html")?true:false,readOnly:l.properties.readonly,styleActiveLine:true,lineWrapping:false,flattenSpans:false,highlightSelectionMatches:{showToken:/^[$\w]\w*/},foldGutter:true,gutters:["CodeMirror-lint-markers","CodeMirror-linenumbers","CodeMirror-foldgutter"],extraKeys:{Ctrl:function(){f()},"Ctrl-Q":function(Q){Q.foldCode(Q.getCursor())},"Ctrl-S":function(){f();if(l.onSaveCommand){l.boxing().onSaveCommand(l)}},"Ctrl-F":function(Q){f();RAD.EditorTool.showFindWnd(l.boxing(),{left:0,top:0},Q.getSelection())},Tab:function(Q){if(Q.doc.somethingSelected()){return CodeMirror.Pass}var R=Array(Q.getOption("indentUnit")+1).join(" ");Q.replaceSelection(R,"end","+input")},"Ctrl-D":function(Q){Q.execCommand("deleteLine")}}};var w=CONF.getStatus(),I=w.editorTheme,j=w.editorFontSize,J=w.lineWrapping;if(I){l.boxing().addCMTheme(I);m.theme=I}if(xui.isSet(J)){m.lineWrapping=!!J}var r=l.$cm=new CodeMirror(function(Q){l.getSubNode("BOX").append(Q);if(j){Q.style.fontSize=j+"px"}},m);CodeMirror.modeURL="/plugins/codemirror5/mode/%N/%N.js";CodeMirror.autoLoadMode(r,x.mode);if(l.onCodeModeSet){xui.asyRun(function(){if(!l.box){return}l.boxing().onCodeModeSet(l,x)})}if(x.mode=="null"){if(!l.$initialized){l.$initialized=true}if(l.onRendered){l.boxing().onRendered(l,true)}}else{r.on("rendered",function(Q,R){if(!l.$initialized){l.$initialized=true}if(l.onRendered){l.boxing().onRendered(l,R)}})}r.on("change",function(Q,V){if(l.$initialized&&l.onValueChanged){l.boxing().onValueChanged(l,Q.doc.getValue()!=l.properties.value)}if(G!="js"&&G!="html"){return}var U;if(V.origin=="+input"){if(V.text[0]){if(V.text[0]=="."){if(G!="js"){return}V.to.ch++;var R=Q.getTokenAt(V.to),T=R.type;if(T!==null){return}var X=Q.getCursor();s(Q.doc.indexFromPos(X),{start:++R.start,end:++R.end,line:X.line});U=true}else{if(V.text[0]!==" "){V.to.ch++;var R=Q.getTokenAt(V.to),T=R.type;if(T=="variable"||T=="variable-2"||T=="keyword"||T=="property"){var X=Q.getCursor();if(X.line==V.to.line&&X.ch>=R.start&&X.ch<=R.end){if(B){q(R.string,Q.doc.indexFromPos(X),{start:R.start,end:R.end,line:X.line})}else{if(T=="property"){if(G!="js"){return}var S=Q.getTokenAt({line:V.to.line,ch:V.to.ch-R.string.length});if(S.type!==null||S.string!=="."){return}s(Q.doc.indexFromPos(X)-V.text.length-1,null,R.string,{start:++S.start,end:++S.end,line:X.line})}else{H(R.string,Q.doc.indexFromPos(X),{start:R.start,end:R.end,line:X.line})}}U=true}}}}}}else{if(V.origin=="+delete"){if(B){var R=Q.getTokenAt(V.to),T=R.type,W=R.string;if(B===true){if(T=="variable"||T=="variable-2"||T=="keyword"){var X=Q.getCursor();if(X.line==V.to.line&&X.ch>=R.start&&X.ch<=R.end){q(R.string,Q.doc.indexFromPos(X),{start:R.start,end:R.end,line:X.line});U=true}}}else{if(B===1){if(T=="property"){var X=Q.getCursor();q(R.string,Q.doc.indexFromPos(X),{start:R.start,end:R.end,line:X.line});U=true}else{if(T===null&&W=="."){var X=Q.getCursor();s(Q.doc.indexFromPos(X),{start:++R.start,end:++R.end,line:X.line});U=true}}}}}}}if(!U){f()}});r.on("blur",function(){});r.on("keypress",function(Q,R){if(G!="js"&&G!="html"){return}if(N&&xui.Event.getKey(R)[0]!="."){f()}});r.on("keydown",function(Q,R){if(G!="js"&&G!="html"){return}if(N&&xui.Event.getKey(R)[0]!="."){f()}});r.on("cursorActivity",function(Q){if(!Q.hasFocus()){return}if(G!="js"&&G!="html"){return}if(u){var S=Q.getCursor(),R=u;if(S.line!==R.line||S.ch<R.start||S.ch>R.end){f()}}xui.resetRun("cm_showtips",function(){var V=Q.state.matchHighlighter;if(V){if(V.overlay&&V.style=="matchhighlight"&&Q.doc.somethingSelected()){var W=Q.getCursor(),U=Q.doc.getSelection(),T=Q.getTokenAt(W);if(U===T.string){s(Q.doc.indexFromPos(W),{start:T.start,end:T.end,line:W.line},T.string)}}}},200)})},_onresize:function(d,c,a){var b=arguments.callee.upper.apply(this,arguments);d.getSubNode("BOX").cssSize(b);if(d.$cm){d.$cm.setSize(d.$px(b.width),d.$px(b.height))}}}});xui.Class("RAD.PageEditor","xui.Module",{Instance:{Initialize:function(){var a=this;a._ovalue="";a._dirty=false},resetEditorStyle:function(c,a,b){this.codeeditor.resetEditorStyle(c,a,b)},setType:function(a){if(this.codeeditor){this.codeeditor.setCodeType(a,true)}this._codetype=a&&a.split(".")[0];if(this.toolbar4){this.toolbar4.updateItem("jsoneditor",{hidden:a!="json"})}},activate:function(){this.codeeditor.activate()},getValue:function(){var a=this;return a._dirty?a.codeeditor.getUIValue():a._ovalue},_refreshCM:function(){if(this.codeeditor){this.codeeditor._refreshCM()}},setValue:function(b){b=(b||"").replace(/\t/g,"    ").replace(/\u00A0/g," ").replace(/\r\n?/g,"\n");var a=this;if(a._ovalue!=b){a._ovalue=b;a._dirty=false;if(a.codeeditor){a.codeeditor.setValue(a._ovalue)}}return a},reindent:function(){this.codeeditor.reindent()},setReadonlyLines:function(b,a){this.codeeditor.setReadonlyLines(b,a)},iniComponents:function(b,e){var d=this,c=[],a=function(f){c.push(f.get(0))};a((new xui.UI.ToolBar).setHost(d,"toolbar4").setItems([{id:"fun",sub:[{id:"searchreplace",caption:"$RAD.pageEditor.searchreplace",imageClass:"spafont spa-icon-searchreplace",type:"button",tips:"$RAD.pageEditor.replacetips"},{id:"jumpto",caption:"$RAD.pageEditor.jumpto",imageClass:"spafont spa-icon-jumpto",type:"button",tips:"$RAD.pageEditor.jumptotips"},{id:"indentall",caption:"$RAD.pageEditor.indentall",imageClass:"spafont spa-icon-indent",type:"button",tips:"$RAD.pageEditor.indentalltips"},{id:"rendermode",caption:"mode",imageClass:"spafont spa-icon-rendermode"},{id:"jsoneditor",hidden:false,caption:"$RAD.spabuilder.menubar.jsoneditor",imageClass:"spafont spa-icon-hash",type:"button",tips:"$(RAD.pageEditor.Edit in JSON Editor)"},{id:"progress",object:(new xui.UI.Image({src:CONF.img_progress})).setHost(d,"imgProgress")}]}]).onClick("_toolbar_onclick"));a((new RAD.CodeEditor).setHost(d,"codeeditor").setDock("fill").setValue(d._ovalue||"").onValueChanged("_codeeditor_onChange").onSaveCommand("_codeeditor_onsave").onGetHelpInfo("_codeeditor_ongett").onRendered("_codeeditor_onrender").onCodeModeSet("_codeeditor_oncodemodeset"));return c},events:{onReady:"_onready"},_onready:function(a){if(a._codetype){a.codeeditor.setCodeType(a._codetype,true)}},_codeeditor_onrender:function(b,d){var a=this;if(!a.codeeditor){return}var c=a.KEY+":"+a.$xid+":progress";if(d){xui.resetRun(c);a.toolbar4.setDisabled(false);a.codeeditor.setReadonly(false);a.imgProgress.setDisplay("none");if(!a.$initializd){a.$initializd=true;a.fireEvent("afterRendered")}}else{xui.resetRun(c,function(){if(!a.destroyed){a.toolbar4.setDisabled(true);a.codeeditor.setReadonly(true);a.imgProgress.setDisplay("")}})}},_codeeditor_ongett:function(b,a){xui.asyRun(function(){xui.Coder.applyById("doc:code",true)});return RAD.EditorTool.getDoc(a)},_codeeditor_oncodemodeset:function(a,b){if(b){this.toolbar4.updateItem("rendermode",{caption:"&nbsp;"+b.name,mime:b.mime,mode:b.mode,tips:"Code was rendered as ["+b.name+"]"})}},_codeeditor_onChange:function(b,a){this._dirty=true;this.fireEvent("onValueChanged",[this,a])},_codeeditor_onsave:function(b){var a=this;a.fireEvent("onCommandSave",[a])},_toolbar_onclick:function(b,m,j,d,a){var g=this,c=this.codeeditor,f=xui.use(a).offset();switch(m.id){case"indentall":c.reindent();break;case"searchreplace":RAD.EditorTool.showFindWnd(c,f,c.getCM().getSelection());break;case"jumpto":RAD.EditorTool.showJumpToWnd(c,f);break;case"rendermode":c.showModeSelDlg(m);break;case"jsoneditor":var l=g.getValue();try{xui.unserialize(l)}catch(d){xui.alert(d);return}if(window.SPA&&false===SPA.fe("beforeObjectEditorPop",["jsonEditor",null,l,function(e){g.setValue(typeof(e)=="string"?e:xui.stringify(e))},"RAD.PageEditor",g,xui(a).get(0),null,c])){return}xui.ModuleFactory.getCom("jsonEditor",function(){this.setProperties({caption:"$RAD.spabuilder.menubar.jsoneditor",imageClass:"spafont spa-icon-hash",text:l,onOK:function(n,e){g.setValue(e)}});this.show()});break}}}});xui.Class("RAD.expression.PageEditor","xui.Module",{Instance:{Initialize:function(){var a=this;a._ovalue="";a._dirty=false},resetEditorStyle:function(c,a,b){this.codeeditor.resetEditorStyle(c,a,b)},setType:function(a){if(this.codeeditor){this.codeeditor.setCodeType(a,true)}this._codetype=a&&a.split(".")[0];if(this.toolbar4){this.toolbar4.updateItem("jsoneditor",{hidden:a!="json"})}},activate:function(){this.codeeditor.activate()},getValue:function(){var a=this;return a._dirty?a.codeeditor.getUIValue():a._ovalue},_refreshCM:function(){if(this.codeeditor){this.codeeditor._refreshCM()}},setValue:function(b){b=(b||"").replace(/\t/g,"    ").replace(/\u00A0/g," ").replace(/\r\n?/g,"\n");var a=this;if(a._ovalue!=b){a._ovalue=b;a._dirty=false;if(a.codeeditor){a.codeeditor.setValue(a._ovalue)}}return a},reindent:function(){this.codeeditor.reindent()},setReadonlyLines:function(b,a){this.codeeditor.setReadonlyLines(b,a)},iniComponents:function(b,e){var d=this,c=[],a=function(f){c.push(f.get(0))};a((new xui.UI.ToolBar).setHost(d,"toolbar4").setItems([{id:"fun",sub:[{id:"searchreplace",caption:"$RAD.pageEditor.searchreplace",imageClass:"spafont spa-icon-searchreplace",type:"button",tips:"$RAD.pageEditor.replacetips"},{id:"jumpto",caption:"$RAD.pageEditor.jumpto",imageClass:"spafont spa-icon-jumpto",type:"button",tips:"$RAD.pageEditor.jumptotips"},{id:"indentall",caption:"$RAD.pageEditor.indentall",imageClass:"spafont spa-icon-indent",type:"button",tips:"$RAD.pageEditor.indentalltips"},{id:"rendermode",caption:"mode",imageClass:"spafont spa-icon-rendermode"},{id:"debug",caption:"调试",imageClass:"spafont spa-icon-debug"},{id:"jsoneditor",hidden:false,caption:"$RAD.spabuilder.menubar.jsoneditor",imageClass:"spafont spa-icon-hash",type:"button",tips:"$(RAD.pageEditor.Edit in JSON Editor)"},{id:"progress",object:(new xui.UI.Image({src:CONF.img_progress})).setHost(d,"imgProgress")}]}]).onClick("_toolbar_onclick"));a((new RAD.expression.CodeEditor).setHost(d,"codeeditor").setDock("fill").setValue(d._ovalue||"").onValueChanged("_codeeditor_onChange").onSaveCommand("_codeeditor_onsave").onGetHelpInfo("_codeeditor_ongett").onRendered("_codeeditor_onrender").onCodeModeSet("_codeeditor_oncodemodeset"));return c},events:{onReady:"_onready"},_onready:function(a){if(a._codetype){a.codeeditor.setCodeType(a._codetype,true)}},setDataToEditor:function(d,a,c){var b=this;this.$cls=a;this.$host=d;this.$api=c;if(xui.isStr(c)){b.boxing().setValue(c)}else{if(c.queryArgs&&c.queryArgs.expression){b.boxing().setValue(c.queryArgs.expression)}}},_codeeditor_onrender:function(b,d){var a=this;if(!a.codeeditor){return}var c=a.KEY+":"+a.$xid+":progress";if(d){xui.resetRun(c);a.toolbar4.setDisabled(false);a.codeeditor.setReadonly(false);a.imgProgress.setDisplay("none");if(!a.$initializd){a.$initializd=true;a.fireEvent("afterRendered")}}else{xui.resetRun(c,function(){if(!a.destroyed){a.toolbar4.setDisabled(true);a.codeeditor.setReadonly(true);a.imgProgress.setDisplay("")}})}},_codeeditor_ongett:function(b,a){xui.asyRun(function(){xui.Coder.applyById("doc:code",true)});return RAD.EditorTool.getDoc(a)},_codeeditor_oncodemodeset:function(a,b){if(b){this.toolbar4.updateItem("rendermode",{caption:"&nbsp;"+b.name,mime:b.mime,mode:b.mode,tips:"Code was rendered as ["+b.name+"]"})}},_codeeditor_onChange:function(b,a){this._dirty=true;this.fireEvent("onValueChanged",[this,this.getValue()])},_codeeditor_onsave:function(b){var a=this;a.fireEvent("onCommandSave",[a])},_toolbar_onclick:function(b,m,j,d,a){var g=this,c=this.codeeditor,f=xui.use(a).offset();switch(m.id){case"indentall":c.reindent();break;case"debug":this.fireEvent("onRunExpression",[this,this.getValue()]);break;case"searchreplace":RAD.EditorTool.showFindWnd(c,f,c.getCM().getSelection());break;case"jumpto":RAD.EditorTool.showJumpToWnd(c,f);break;case"rendermode":c.showModeSelDlg(m);break;case"jsoneditor":var l=g.getValue();try{xui.unserialize(l)}catch(d){xui.alert(d);return}if(window.SPA&&false===SPA.fe("beforeObjectEditorPop",["jsonEditor",null,l,function(e){g.setValue(typeof(e)=="string"?e:xui.stringify(e))},"RAD.PageEditor",g,xui(a).get(0),null,c])){return}xui.ModuleFactory.getCom("jsonEditor",function(){this.setProperties({caption:"$RAD.spabuilder.menubar.jsoneditor",imageClass:"spafont spa-icon-hash",text:l,onOK:function(n,e){g.setValue(e)}});this.show()});break}}}});xui.Class("RAD.ClassTool",null,{Static:{_this:"____this____",getClassName:function(j,l){var f=/^(\s*\/\*[^*@]*\*+([^\/][^*]*\*+)*\/\s*)|^(\s*\/\/[^\n]*\s*)/,m=/(\s*\/\*[^*@]*\*+([^\/][^*]*\*+)*\/\s*)$|(\s*\/\/[^\n]*\s*)$/,e=/(\{([^\{\}]*)\})|(\[([^\[\]]*)\])/,d=/\s*(((function\s*([\w$]+\s*)?\(\s*([\w$\s,]*)\s*\)\s*)?(\{([^\{\}]*)\}))|(\[([^\[\]]*)\]))/g,c=/^[\xEF\xBB\xBF\uFEFF\s]*(xui\.)?Class\s*\(\s*(([\']([^\']+)[\'])|([\"]([^\"]+)[\"]))\s*\,\s*(([\']([^\']*)[\'])|([\"]([^\"]*)[\"])|(null)|(undefined))\s*\,1\s*\)\s*;?\s*$/,b=/^[\xEF\xBB\xBF\uFEFF\s]*(xui\.)?Class\s*\(/,a=/^[a-zA-Z]+[\w\.]*[\w]+$/,o=/^\"[a-zA-Z]+[\w\.]*[\w]*\"$/,n=/^\'[a-zA-Z]+[\w\.]*[\w]*\'$/;while(f.test(j)){j=j.replace(f,"")}while(m.test(j)){j=j.replace(m,"")}var g=[[/"(\\.|[^"\\\n])*"/,function(q){return o.test(q[0])?q[0]:'""'}],[/'(\\.|[^'\\\n])*'/,function(q){return n.test(q[0])?q[0]:"''"}],[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"null"],[/\/\*[^*]*\*+([^\/][^*]*\*+)*\//,""],[/\/\/[^\n]*/,""]];j=xui.replace(j,g);if(!b.test(j)){return false}while(e.test(j)){j=j.replace(d,"1")}if(c.test(j)){j=j.replace(c,l?"$7":"$2").replace(/[\'\"]/g,"")}else{return false}if(a.test(j)){return j}else{return false}},isJson:function(a){var b=new RegExp("^(\\s*\\/\\*[^*@]*\\*+([^\\/][^*]*\\*+)*\\/\\s*)|^(\\s*\\/\\/[^\\n]*\\s*)");while(b.test(a)){a=a.replace(b,"")}return/^\s*(\{|\[|function)/.test(a)},getClassObject:function(str){str=str.slice(str.indexOf("{")+1,str.lastIndexOf("}"));var obj=eval("({"+str+"})");str=null;return obj},getCodeFromStruct:function(f,d){try{var b=arguments.callee,a=[];if(f){if(f.sub){if(f.frame){xui.each(f.sub,function(g,e){if(!xui.isNull(g.comments)){a.push((g.comments||"")+e+":"+(g.code?g.code:g.sub?b.call(this,g,true):""))}},this);return(d?"":(f.comments||""))+f.frame.replace("*1",f.name||"").replace("*2",f.pname||"").replace("*3",a.join(", ").replace(/\$/g,"\x01")).replace(/\x01/g,"$")}else{return""}}else{return(f.code||"").replace(/^[\r\n]*/,"")}}else{return""}}catch(c){xui.message(xui.getRes("RAD.classtool.err2"))+":"+String(c);return false}},parseSingleBlock:function(a){try{var c=new RegExp("^(\\s*\\/\\*[^*@]*\\*+([^\\/][^*]*\\*+)*\\/\\s*)|^(\\s*\\/\\/[^\\n]*\\s*)"),b=new RegExp("(\\s*\\/\\*[^*@]*\\*+([^\\/][^*]*\\*+)*\\/\\s*)|^(\\s*\\/\\/[^\\n]*\\s*)$"),j,g,d;while(b.test(a)){a=a.replace(b,"")}j=a;while(c.test(j)){j=j.replace(c,"")}j=j.replace(/\s*/,"");if(!j){return{comments:null,code:null}}g="\n"+a.replace(j,"");d=j.replace(/\s*$/,"");j=xui.replace(j,[["(^|\\n)\\s*\\/\\*[^*@]*\\*+([^\\/][^*]*\\*+)*\\/\\s*",""],["\\n\\s*\\/\\/[^\\n]*\\s*",""],[/([^\w\x24\/\'\"*)\]\?:]\s*)(\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*)\s*([\)\}\]:,;\r\n])/.source,function(e,l){return j[l+1]+j[l+5]}]]);d=d.replace(/([}\]])[^}\]]*$/,"$1");j=xui.replace(d,[["null|undefined|NaN",""],[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,""],[/-?(\d*\.?\d+|\d+\.?\d*)([eE][+-]?\d+|%)?\b/,""],["'(\\\\.|[^'\\\\])*'",""],['"(\\\\.|[^"\\\\])*"',""]]);while(/(\{([^\{\}]*)\})|(\[([^\[\]]*)\])/.test(j)){j=j.replace(/\s*(((function\s*([\w$]+\s*)?\(\s*([\w$\s,]*)\s*\)\s*)?(\{([^\{\}]*)\}))|(\[([^\[\]]*)\]))/g,"")}if(xui.str.trim(j)!=""){return false}return{comments:g,code:d}}catch(f){xui.message(xui.getRes("RAD.classtool.err3")+":"+String(f));return false}},getClassStruct:function(str){try{str=xui.replace(str,[[/(\r\n|\r)/g,"\n"],[/( +)(\n)/g,"$2"],[/\t/g,"    "]]);var t,index=1,index1=1,cache={},cache1={},result,result2,code=function(str,i){var ret="#"+(index++)+"#";cache[ret]=str[0];return ret},_code=function(str,i){var ret="#"+(index++)+"#";cache[ret]=str[i+2];return str[i+1]+ret+str[i+5]},code1=function(str){var ret="`"+(index1++);cache1[ret]=str[0];return ret},restore=function(str){return str.replace(/#(\d+)#/g,function(m){return cache[m]})},restore1=function(str){return str.replace(/`(\d+)/g,function(m){return cache1[m]})};str=xui.replace(str,[["(^|\\n)\\s*\\/\\*[^*@]*\\*+([^\\/][^*]*\\*+)*\\/[^\\n]*",code],["(^|\\n)\\s*\\/\\/[^\\n]*",code],[/([^\w\x24\/\'\"*)\]\?:]\s*)(\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*)\s*([\)\}\]:,;\r\n])/g.source,_code]]);str=xui.replace(str,[["'(\\\\.|[^'\\\\])*'",code1],['"(\\\\.|[^"\\\\])*"',code1]]);var frame=str.replace(/(^[^{]*\{)\s*((.|[\r\n])*)([^\s])(\s*}[^}]*$)/,"$1*3$5").replace(/(#\d+#)+/g,""),o={sub:{}};if(t=str.match(/^((#\d+#)+)/)){o.comments=restore(t[0])}else{o.comments=""}o.name=restore1(cache1["`1"].replace(/[\'\" ]*/g,""));var i2=str.indexOf(",",1),i21=str.indexOf("[",i2+1),i22=str.indexOf("]",i2+1),i3=str.indexOf(",",i2+1);if(i21<i3){var str=restore(restore1(str.substring(i21,i22+1)));o.pname=eval(str);str=null}else{o.pname=str.substring(i2+1,i3);o.pname=/[\'\"]/.test(o.pname)?o.pname.replace(/[\'\" ]*/g,""):null}o.frame=restore1(frame.replace(o.name,"*1").replace(o.pname,"*2"));str=str.slice(str.indexOf("{")+1,str.lastIndexOf("}"));result=o.sub;var index2=1,cache2={},code2=function(str){var ret="'~"+index2+++"'";cache2[ret]=str;return ret},code3=function(a,b,str){if(a.indexOf("~")!=-1){return a}var ret="'~"+index2+++"'";cache2[ret]=str;return b+ret},restore2=function(str){if(str.indexOf("~")==-1){return str}str=cache2["'"+str+"'"];while(/'~\d+'/.test(str)){str=str.replace(/'~\d+'/g,function(m){return cache2[m]})}return str};while(/(\{([^\{\}\[\]]*)\})|(\[([^\[\]\{\}]*)\])/.test(str)){str=str.replace(/\s*(((function\s*([\w$]+\s*)?\(\s*([\w$\s,]*)\s*\)\s*)?(\{([^\{\}\[\]]*)\}))|(\[([^\[\]\{\}]*)\]))/g,code2)}if(/[\{\}\[\]]/.test(str)){return false}str=xui.replace(str,["\\s+",code]);str=str.replace(/((#\d+#)+)([\w]+)((#\d+#)*):/g,function(z,a,b,c){result[c]={comments:restore(a)};return c+":"});str=str.replace(/(#\d+#)/g,"");var obj;try{obj=eval("({"+str+"})");str=null}catch(e){return false}xui.arr.each(["Constructor","Dependency","Initialize","Before","After","$End"],function(i){if(obj[i]){result[i]=result[i]||{};result[i].code=restore(restore1(restore2(obj[i])))}else{result[i]={}}xui.arr.each(xui.toArr("code,comments"),function(j){result[i][j]=xui.isDefined(result[i][j])?result[i][j]:null})});var obj2;xui.arr.each(["Instance","Static"],function(i){if(obj[i]){var temp=cache2["'"+obj[i]+"'"];var frame=temp.replace(/(^[^{]*\{)\s*((.|[\r\n])*)([^\s])(\s*}[^}]*$)/,"$1*3$5");temp=temp.replace(/(#\d+#)*\s*(\})$/g,"$2");temp="("+temp+")";temp=xui.replace(temp,["\\s+",code]);result[i]=result[i]||{};result2=result[i].sub={};result[i].frame=frame;temp=temp.replace(/(:)([^,\}]+)/g,code3);temp=restore1(temp);temp=temp.replace(/((#\d+#)+)([\w]+)((#\d+#)*):/g,function(z,a,b,c){result2[c]={comments:restore(a)};return c+":"});temp=temp.replace(/(#\d+#)/g,"");obj2=eval(temp);temp=null;xui.each(obj2,function(o,j){result2[j]=result2[j]||{};result2[j].code=restore(restore1(restore2(o)))})}else{result[i]={}}xui.arr.each(xui.toArr("code,comments,sub,frame"),function(j){result[i][j]=xui.isDefined(result[i][j])?result[i][j]:null})});return o}catch(e){return false}},getClassStruct2:function(code,index){if((!xui.isSet(index))||index<0||index>=code.length){index=code.length}var ns=this,cache=ns._Cache2||(ns._Cache2={});if(cache[code+"^**^"+index]){return cache[code+"^**^"+index]}var rf=function(a){return xui.str.repeat(" ",a[0].length)};var ocode=code;code=xui.replace(code,[[/\r\n?|\n/,"\n"],[/(\uFEFF|\xA0|[\t\x0B\f])/,rf],[/"([\w\$])?[\w\.]*"/,"$0"],[/'([\w\$])?[\w\.]*'/,"$0"],[/"(\\.|[^"\\\n])*"/,rf],[/'(\\.|[^'\\\n])*'/,rf],[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,rf],[/\/\*[^*]*\*+([^\/][^*]*\*+)*\//,rf],[/\/\/[^\n]*/,rf]]);var regxuiCls=/\b(xui\.)?Class\s*\(\s*["'\w\$\.]+\s*\,\s*["'\w\$\.]+\s*\,\s*\{/g,found,clsStartPos=-1,clsEnd,j=-1,codeStart;if((found=regxuiCls.exec(code))!=null){j=regxuiCls.lastIndex;if(j>=index){if(clsStartPos==-1){return null}}clsStartPos=j-found[0].length}var len=code.length,pos=code.indexOf("{",clsStartPos)+1,clsCodeStart=pos,layer=1,i1=code.indexOf("(",clsStartPos+1),i2=code.indexOf(",",i1+1),i21=code.indexOf("[",i2+1),i22=code.indexOf("]",i2+1),i3=code.indexOf(",",i2+1),hash={},prevColonPos=-1,qMark=false,keyPattern=/((\b[\w\$][\w]*\b)|(\'[^']*\')|(\"[^"]*\"))\s*$/,lastOKPos=pos,c,tmpstr,tmpstr2,tmpResult,key,type,args,subcode,codefrom,codeto,layer1Key,spaceCount=0;hash.name=code.substring(i1+1,i2).replace(/[\'\" ]*/g,"");if(i21<i3){hash.pname=code.substring(i21,i22+1);try{hash.pname=eval(hash.pname)}catch(e){return null}xui.arr.each(hash.pname,function(o){if(o=="xui.Module"){hash.isModule=true}else{var t=xui.SC(o);hash.isModule=t&&t["xui.Module"]}})}else{hash.pname=code.substring(i2+1,i3);hash.pname=/[\'\"]/.test(hash.pname)?hash.pname.replace(/[\'\" ]*/g,""):null;if(!/^[\w\$][\w\.]*$/.test(hash.name)||!/^[\w\$]?[\w\.]*$/.test(hash.pname)){return null}if(hash.pname=="xui.Module"){hash.isModule=true}else{if(hash.pname){var t=xui.SC(hash.pname);hash.isModule=t&&t["xui.Module"]}}}hash.arr=[];do{c=code[pos++];if(/\s/.test(c)){spaceCount++}else{if(c=="?"){if(layer<=2){qMark=true}}else{if(c==":"){if(layer<=2){if(qMark){qMark=false;continue}else{if(prevColonPos!=-1){continue}else{prevColonPos=pos}}}}else{if(c=="("){if(prevColonPos!=-1){var nn=code.indexOf(")",pos);if(nn!=-1){pos=nn+1;continue}}}else{if(c==","){if(prevColonPos!=-1){if(layer<=3){type="other";subcode=ocode.substring(codefrom=prevColonPos,codeto=pos-spaceCount-1)}tmpstr2=code.substring(lastOKPos,prevColonPos-1);tmpResult=keyPattern.exec(tmpstr2);if(tmpResult!=null){key=tmpResult[0].replace(/[\'\"\s]/g,"")}prevColonPos=-1;lastOKPos=pos}}else{if(c=="{"){layer++;if(prevColonPos!=-1){if(layer<=3){tmpstr=code.substring(prevColonPos,pos).replace(/\s*/,"");if(tmpstr[0]=="f"){args=tmpstr.substring(tmpstr.indexOf("(")+1,tmpstr.indexOf(")")).split(",");if(args[0]===""){args=null}type="function"}else{if(tmpstr[0]=="{"){type="object"}}tmpstr2=code.substring(lastOKPos,prevColonPos-1);tmpResult=keyPattern.exec(tmpstr2);if(tmpResult!=null){key=tmpResult[0].replace(/[\'\"\s]/g,"");if(layer==2&&(type=="object"||type=="function")){layer1Key=key;codefrom=pos-1}}}prevColonPos=-1;lastOKPos=pos}}else{if(c=="}"){if(prevColonPos!=-1){if(layer<=3){type="other";subcode=ocode.substring(codefrom=prevColonPos,codeto=pos-spaceCount-1)}tmpstr2=code.substring(lastOKPos,prevColonPos-1);tmpResult=keyPattern.exec(tmpstr2);if(tmpResult!=null){key=tmpResult[0].replace(/[\'\"\s]/g,"")}prevColonPos=-1;lastOKPos=pos}layer--;if(layer===0){subcode=ocode.substring(codefrom=clsCodeStart-1,codeto=pos);hash.code=subcode;hash.from=codefrom;hash.to=codeto}else{if(layer===1){if(layer1Key){xui.set(hash.sub,[layer1Key,"to"],pos);hash.arr.push(layer1Key)}}else{if(layer===2){subcode=ocode.substring(codefrom=codeStart-1,codeto=pos);xui.set(hash.sub,[layer1Key,"sub",key,"code"],subcode);xui.set(hash.sub,[layer1Key,"sub",key,"from"],codefrom);xui.set(hash.sub,[layer1Key,"sub",key,"to"],codeto)}}}prevColonPos=-1;lastOKPos=pos}}}}}}spaceCount=0}if(type){if(!hash.sub){hash.sub={}}if(layer1Key){if(layer1Key!=key){if(!xui.get(hash.sub,[layer1Key,"sub"])){xui.set(hash.sub,[layer1Key,"sub"],{})}xui.set(hash.sub,[layer1Key,"sub",key],{type:type,args:args,code:subcode,from:codefrom,to:codeto});hash.sub[layer1Key].arr.push(key)}else{xui.set(hash.sub,[layer1Key],{type:"object",from:codefrom,arr:[]})}}else{hash.sub[key]={type:type,args:args,code:subcode,from:codefrom,to:codeto}}codeStart=pos}if(layer===1&&c=="}"&&layer1Key){layer1Key=null}type=args=null}while(pos<=len&&layer>0);xui.breakO(cache);cache={};return cache[code+"^**^"+index]=hash},getArgsFromAPI:function(o,n,b,a){var l=xui.getRes("doc."+o+(b?".prototype":"")+"."+n);if(xui.isStr(l)&&l===n){var f=xui.get(window,(o+(b?".prototype":"")+"."+n).split("."));if(f&&f.$original$){l=xui.getRes("doc."+f.$original$+".prototype."+n)}}if(xui.isStr(l)&&l===n){return null}if(l){var j,m=xui.SC.get(o);if(m&&m.$EventHandlers){j=xui.fun.args(m.$EventHandlers[n])}var q=l.$paras,g=[],e,c;if(q&&q.length){if(a){g=[{code:a}]}for(var d=a?1:0;d<q.length;d++){if(m&&j&&m.$DataModel&&m.$DataModel.items&&j[d]=="item"){g.push({code:"CONF.mixed_prop."+o.replace(/\./g,"_")+"_item"})}else{if(m&&j&&o=="xui.UI.TreeGrid"&&j[d]=="col"){g.push({code:"CONF.mixed_prop."+o.replace(/\./g,"_")+"_col"})}else{if(m&&j&&o=="xui.UI.TreeGrid"&&j[d]=="row"){g.push({code:"CONF.mixed_prop."+o.replace(/\./g,"_")+"_row"})}else{if(m&&j&&o=="xui.UI.TreeGrid"&&j[d]=="cell"){g.push({code:"CONF.mixed_prop."+o.replace(/\./g,"_")+"_cell"})}else{e=q[d].replace(/(\w+).*/,"$1");c=q[d].replace(/.*\:\s*(([\w]+\.)*[\w]+).*/,"$1");g.push({name:e,type:((c=="Event"||c=="Element"||c=="Document")?"Object":c)+".prototype",ori:c})}}}}}return g}}return null},_alias:1,getClassStructWithScope:function(code,index,cacheKey1,cacheKey2){var ns=this,cache=ns._Cache1||(ns._Cache1={});if(cache[code+"^**^"+index]){return cache[code+"^**^"+index]}var hash=ns.getClassStruct2(code,index),_this=ns._this,t,t1;if(!hash){return null}xui.arr.each(["Constructor","Dependency","Initialize","Before","After","$End"],function(i){if((t=xui.get(hash,["sub",i]))&&t.type=="function"){xui.set(hash,["sub",i],{argsv:[_this,"''"],_this:hash.pname?("__getThis('"+hash.pname+"',1)"):"{}"})}});if(t=xui.get(hash,["sub","Instance","sub","initialize"])){t._this=hash.pname?("__getThis('"+hash.pname+"',1)"):"{}"}if(hash.pname){if(t=xui.get(hash,["sub","Static","sub"])){xui.each(t,function(o,key){if(key==="sub"){return}o._this=hash.pname?("__getThis('"+hash.pname+"',1)"):"{}";if(typeof(hash.pname)=="string"){var arr=ns.getArgsFromAPI(hash.pname,key,false);if(arr){o.argsv=arr}}else{xui.arr.each(hash.pname,function(cls){var arr=ns.getArgsFromAPI(cls,key,false);if(arr){o.argsv=arr}})}})}if(t=xui.get(hash,["sub","Instance","sub"])){xui.each(t,function(o,key){o._this=hash.pname?("__getThis('"+hash.pname+"',0)"):"{}";if(typeof(hash.pname)=="string"){var arr=ns.getArgsFromAPI(hash.pname,key,true);if(arr){o.argsv=arr}}else{xui.arr.each(hash.pname,function(cls){var arr=ns.getArgsFromAPI(cls,key,true);if(arr){o.argsv=arr}})}})}}var bak=xui.Dom.pack,bak1=xui.absProfile.prototype.$link,bak11=xui.absObj.$pickAlias;xui.Dom.pack=function(){var o=new xui.Dom(false),d=document.getElementById("abc");o._nodes=[d];return o};xui.absProfile.prototype.$link=function(){return this};xui.absObj.$pickAlias=function(){return ns._alias++};try{var globalCache;if(cacheKey1&&cacheKey2){globalCache=window[cacheKey1]||(window[cacheKey1]={});if(globalCache[cacheKey2]){if(xui.get(globalCache[cacheKey2],["Instance","_ctrlpool"])){xui.each(globalCache[cacheKey2].Instance._ctrlpool,function(o,i){if(o&&!o.destroyed){if(o.destroy){o.destroy()}if(o.boxing&&o.boxing()){o.boxing().destroy()}}});globalCache[cacheKey2].Instance._ctrlpool=null}xui.breakO(globalCache[cacheKey2]);globalCache[cacheKey2]={}}else{globalCache[cacheKey2]={}}globalCache=globalCache[cacheKey2]}else{globalCache={}}globalCache.Instance={_ctrlpool:{},properties:{},events:{}};globalCache.Static={};if(t1=xui.get(hash,["sub","Instance","sub"])){xui.each(t1,function(o,i){try{var ecode=o.type=="function"?("(function("+(o.args?o.args.join(","):"")+"){})"):("("+o.code+")");globalCache.Instance[i]=eval(ecode);ecode=null}catch(e){globalCache.Instance[i]=null}})}if(t1=xui.get(hash,["sub","Static","sub"])){xui.each(t1,function(o,i){try{var ecode=o.type=="function"?("(function("+(o.args?o.args.join(","):"")+"){})"):("("+o.code+")");globalCache.Static[i]=eval(ecode);ecode=null}catch(e){globalCache.Static[i]=null}})}if(t=xui.get(hash,["sub","Instance","sub","events"])){if(t=t.code){try{var ecode="("+t+")";t=eval(ecode);ecode=null}catch(e){t=null}if(t&&xui.isHash(t)){xui.each(t,function(evt,name){if(xui.isArr(evt)){for(var i=0,l=evt.length;i<l;i++){if(typeof(evt[i])=="string"){evt=evt[i];break}}}if(typeof(evt)=="string"){if(t1=xui.get(hash,["sub","Instance","sub",evt])){t1.argsv=ns.getArgsFromAPI("xui.Module",name,true,"this")}}})}}}if(t=xui.get(hash,["sub","Instance","sub","initialize"])){if(t=t.code){try{var ecode="(function()"+t+")";t=eval(ecode);ecode=null}catch(e){t=null}if(typeof(t)=="function"){try{globalCache.Instance.$inDesign="xxx";t.call(globalCache.Instance)}catch(e){}}}}if(t=xui.get(hash,["sub","Instance","sub","iniComponents"])){if(t=t.code){try{var ecode="(function()"+t+")";t=eval(ecode);ecode=null}catch(e){t=null}if(typeof(t)=="function"){try{globalCache.Instance.$inDesign="xxx";t.call(globalCache.Instance)}catch(e){}xui.each(globalCache.Instance._ctrlpool,function(o,i){var cls=o.key;xui.each(o.getEvents(),function(evt,key){if(xui.isArr(evt)){for(var i=0,l=evt.length;i<l;i++){if(typeof(evt[i])=="string"){evt=evt[i];break}}}if(typeof(evt)=="string"){if(t1=xui.get(hash,["sub","Instance","sub",evt])){t1.argsv=ns.getArgsFromAPI(cls,key,true,"(new "+cls+").get(0)")}}})});xui.asyRun(function(){xui.each(globalCache.Instance._ctrlpool,function(o,i){if(o&&!o.destroyed){if(o.destroy){o.destroy()}if(o.boxing&&o.boxing()){o.boxing().destroy()}}});xui.breakO(globalCache.Instance)})}}}}finally{xui.Dom.pack=bak;xui.absProfile.prototype.$link=bak1;xui.absObj.$pickAlias=bak11}xui.breakO(cache);cache={};return cache[code+"^**^"+index]=hash},getMinCode:function(a,g){if(g<0||g>=a.length){return""}var o=new Date;var x=/(\{(((\{\})|[^\{\}\x01])+)\})|(\[([^\[\]0\x01]+)\])/,w=/(((\s*function\s*([\w$][\w]*\s*)?\(\s*([\w$\s,]*)\s*\)\s*)?(\{(((\{\})|[^\{\}\x01])*)\}))|(\[([^\[\]0\x01]+)\]))/g;a=a.replace(/\x01/g,"0");a=a.substring(0,g)+"\x01"+a.substring(g+1,a.length);a=xui.replace(a,[[/\r\n?|\n/,"\n"],[/(\uFEFF|\xA0|[\t\x0B\f])/," "],[/"[\w\$][\w\.]*"\s*\:/,"$0"],[/'[\w\$][\w\.]*'\s*\:/,"$0"],[/"(\\.|[^"\\\n])*"/,'"a"'],[/'(\\.|[^'\\\n])*'/,"'a'"],[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"(new RegExp())"],[/\/\*[^*]*\*+([^\/][^*]*\*+)*\//,""],[/\/\/[^\n]*/,""]]);var n=new Date;while(x.test(a)){a=a.replace(w,function(c){return c[0]=="{"?"{}":c[0]=="["?"[0]":"(new Function())"})}var m=new Date;var u=0,s=a.indexOf("\x01"),r=a.length,j=true,E=[],D=[],C=[],e=[],d=[],B,A=0,q,b=true;var f=a.substring(0,s);if(!/\bfunction\b/.test(f)){return f}do{B=a[u++];if(u<s){if(B=="{"&&a[u]!="}"){q=a.substring(A,u+1);e.push(q+"\n");if(/\:\s*function\b/.test(q)){e.push(a.substring(u+1,s)+"\n");u=s;continue}j=false}if((B=="{"&&a[u]!="}")||((!j)&&B==",")){A=u}if(B=="("){if(a.substring(u-1,u+13)=="(new RegExp())"){u+=13}else{if(a.substring(u-1,u+15)=="(new Function())"){u+=15}else{j=true}}}}else{if(b){e.push("{}");b=false}if(B=="{"){E.push(B)}else{if(B=="}"){if(E.length===0){d.push(B)}else{E.pop()}}else{if(B=="["){D.push(B)}else{if(B=="]"){if(D.length===0){d.push(B)}else{D.pop()}}else{if(B=="("){C.push(B)}else{if(B==")"){if(C.length===0){d.push(B)}else{C.pop()}}}}}}}}}while(u<r);return e.join("\n").replace(/\s*\n\s*/g,"\n")+d.join("")},getContextVars:function(e,d){e=e.substring(0,d);var a=new CodeMirror(new Function);a.setValue(e);var j={},c,b=function(m,l){g=m&&m.vars;if(g){do{l[g.name]=1}while(g=g.next)}if(m&&m.prev){b(m.prev,l)}};var f=a.getStateAfter(a.doc.posFromIndex(d).line,true),g;g=f.localVars;if(g){do{j[g.name]=1}while(g=g.next)}g=f.globalVars;if(g){do{j[g.name]=1}while(g=g.next)}b(f.context,j);return j},getContextVars_fast:function(a,d){var g={},c,b=function(l,j){f=l&&l.vars;if(f){do{j[f.name]=1}while(f=f.next)}if(l&&l.prev){b(l.prev,j)}};var e=a.getStateAfter(a.doc.posFromIndex(d).line,false),f;f=e.localVars;if(f){do{g[f.name]=1}while(f=f.next)}f=e.globalVars;if(f){do{g[f.name]=1}while(f=f.next)}b(e.context,g);return g},getContextAssignments:function(d,w){d=this.getMinCode(d,w);w=d.lastIndexOf("\n");d=d.replace(/[ ]+/g," ");d=d.replace(/\b(xui\.)?Class\s*\(\s*["'\w\$\.]+\s*\,\s*["'\w\$\.]+\s*\,\s*\{\}\s*\)\s*(;)?/g,"");var K=d.length,e=/\s*function\s*([\w$]+\s*)?\(\s*[\w$\s,]*\s*\)\s*\{/g;var B=/\b(xui\.)?Class\s*\(\s*["'\w\$\.]+\s*\,\s*["'\w\$\.]+\s*\,\s*\{/,J=B.exec(d);if(J!=null){var I=B.lastIndex+J[0].length,l=null,G=null,R=null,b=null,M=-1,g=K,E=[],O=I,L,P;while(I<K){P=d[I++];if(P==" "||P=="\n"){continue}if(L){if(P=="{"){l="hash";G=d.substring(O+1,I-1).replace(/[\'\" \n:]/g,"");O=I;L=false;while(I<K){P=d[I++];if(P==" "||P=="\n"){continue}if(L){if(e.test(d.substring(I-1,K))){R="function";b=d.substring(O+1,I-1).replace(/[\'\" \n:]/g,"");M=I-1;if(e.test(d.substring(I-1,K))){g=e.lastIndex+I-1}var a="",q;while(I<K){P=d[I++];if(P==" "||P=="\n"){continue}if(P=="("){q=1;continue}else{if(P==")"){break}}if(q){a+=P}}E=a.split(",")}else{}break}L=P==":"}}else{if(P=="f"){l="function";G=d.substring(O+1,I-1).replace(/[\'\" \n:]/g,"");M=I-1;if(e.test(d.substring(I-1,K))){g=e.lastIndex+I-1}var a="",q;while(I<K){P=d[I++];if(P==" "||P=="\n"){continue}if(P=="("){q=1;continue}else{if(P==")"){break}}if(q){a+=P}}E=a.split(",")}else{}}break}L=P==":"}}var o=[],n=[],u=-1,D=-1,A,s=false,x=/([\w$][\w]*)\s*\=\s*([^\s]{1})/g,F=d.length,m=false;outerloop:while((A=x.exec(d))!=null){if(M!=-1){if(x.lastIndex>=M){if(x.lastIndex<g){m=true;if(!s){u=o.length;s=true}}else{m=false;D=o.length}}else{m=false}}var f=A[2];if("="==f[0]){continue outerloop}else{if("{"==f[0]){f="{}"}else{if("["==f[0]){f="[]"}else{var H=x.lastIndex-1,C,r=0,Q=false,N=false;while(H<=F){C=d[H++];if(C==" "){continue}if(Q){Q=false}if(N){N=false;if(!(C=="+"||C=="-"||C=="*"||C=="/"||C==".")){break}}if(C=="("){r++}else{if(C==")"){if(r>0){r--}else{break}}else{if(C=="+"||C=="-"||C=="*"||C=="/"||C=="."){Q=true;continue}}}if(r>0){continue}else{if(C==","||C==";"){break}else{if(C=="\n"){if(Q){continue}else{break}}}}}f=d.substring(x.lastIndex-1,H-1);if(/\bfunction\s*\(/.test(f)){f="(new Function())"}if(/\.$/.test(f)){f=f.replace(/[\.]+$/,"")}}}}o.push(A[1]);n.push(f)}return{vars:o,code:n,firstType:l,firstKey:G,secondType:R,secondKey:b,scopeS:u,scopeE:u==-1?-1:(D==-1?o.length:D),outscope:u==-1?false:w>=g}}}});xui.Class("RAD.JSEditor","xui.Module",{Instance:{events:{onReady:"_onready",onRender:"_onRender",onDestroy:"_ondestroy"},_onready:function(){var a=[{id:"fun",sub:[{id:"searchreplace",caption:"$RAD.pageEditor.searchreplace",imageClass:"spafont spa-icon-searchreplace",type:"button",tips:"$RAD.pageEditor.replacetips"},{id:"jumpto",caption:"$RAD.pageEditor.jumpto",imageClass:"spafont spa-icon-jumpto",type:"button",tips:"$RAD.pageEditor.jumptotips"},{id:"indentall",caption:"$RAD.pageEditor.indentall",imageClass:"spafont spa-icon-indent",type:"button",tips:"$RAD.pageEditor.indentalltips"}]},{id:"g3",sub:[{id:"rendermode",caption:"mode",imageClass:"spafont spa-icon-rendermode"}]}];if(CONF.enable_codeEdtor){a.unshift({id:"todesign",sub:[{id:"design",caption:"$RAD.JSEditor.to$RAD.JSEditor.dv",imageClass:"spafont spa-icon-designview",tips:"$RAD.JSEditor.dvtips"}]})}this.toolbar4.setItems(a)},_onRender:function(a){},_ondestroy:function(a){var b=this;RAD.CodeEditor.clearSandbox("com:JSEditor:"+a.$xid+":");b.___buildNSCode=b.___treeHash=null;if(a._designer){a._designer.destroy()}},resetEditorStyle:function(c,a,b){this.codeeditor.resetEditorStyle(c,a,b)},initialize:function(){var a=this;a.$transTaskList=[];a.$transTaskListCached={};a._ovalue="";a._dirty=false;a._uicode=null;a._evalcache={};a.properties={$pageviewType:"xui.UI.ButtonViews"}},_regClass:/\b(xui\.)?Class\s*\(\s*["'\w\$\.]+\s*\,\s*["'\w\$\.]+\s*\,\s*\{/,_rebuildNameSpace:function(l,a){var g=this,l=l||g.getValue();if(l===g.___buildNSCode){return}var e=g.codeeditor,j=g.buttonview,f=g.layoutFill,d=g.toolbar4;if(!g._regClass.test(l)){if(j&&!j.getItemByItemId("design").disabled){f.updateItem("after",{hidden:true});j.updateItem("design",{disabled:true});j.reLayout(true);d.updateItem("outline",{value:true});d.showGroup("g1",false)}return}else{if(j&&j.getItemByItemId("design").disabled){f.updateItem("after",{hidden:false});j.updateItem("design",{disabled:false});j.reLayout(true);d.updateItem("outline",{value:true});d.showGroup("g1",true)}}if(a!==false){g.___buildNSCode=l}var c={},b=RAD.ClassTool.getClassStructWithScope(l);g._rebuildTree(b)},_rebuildTree:function(f){var c=this,a=[],d,b=[];xui.each(xui.get(f,["sub"]),function(j,g){a.push(g);d={id:g,caption:g,tips:g};switch(g){case"Static":d.imageClass="spafont spa-icon-hash";d.sub=[];a.push("[");xui.each(j.sub,function(n,m){a.push(m);var l=n.type=="function"?"spafont spa-icon-function":n.type=="object"?"spafont spa-icon-hash":n.type=="array"?"spafont spa-icon-array":"spafont spa-icon-var";d.sub.push({id:"Static."+m,tips:m,caption:m,imageClass:l})});a.push("]");break;case"Instance":d.imageClass="spafont spa-icon-hash";d.sub=[];a.push("[");xui.each(j.sub,function(n,m){a.push(m);var l=n.type=="function"?"spafont spa-icon-function":n.type=="object"?"spafont spa-icon-hash":n.type=="array"?"spafont spa-icon-array":"spafont spa-icon-var";d.sub.push({id:"Instance."+m,tips:m,caption:m,imageClass:l})});a.push("]");break;case"Dependency":d.imageClass="spafont spa-icon-var";break;case"Constructor":case"Initialize":case"Before":case"After":d.imageClass="spafont spa-icon-function";break;default:d.imageClass=d.type=="function"?"spafont spa-icon-function":d.type=="object"?"spafont spa-icon-hash":d.array=="object"?"spafont spa-icon-array":"spafont spa-icon-var"}b.push(d)});var e=a.join("#");if(e!==c.___treeHash){c.___treeHash=e;c.treebarClass.setItems(b)}},_getEval:function(d){var b=this,c=(d||b.getValue()),a;if(b._evalcache[c]){a=b._evalcache[c]}else{a=RAD.CodeEditor.evalInSandbox(c,false,"com:JSEditor:"+b.$xid+":2",false,false,"","window.___Class=xui.Class; xui.Class=function(a,b,c){return c;}; ",function(e){e.xui.Class=e.___Class;e.___Class=null});if(a.ok){xui.breakO(b._evalcache);b._evalcache[c]=a;b._designer.setLinkObj(a.ok)}}return a},activate:function(){var b=this,a=b.buttonview.getUIValue();if(a=="code"){b.codeeditor.activate()}},checkEditorCode:function(){var a=this;if(a._dirty&&a.buttonview.getUIValue()=="code"){return !!a.codeeditor.getUIValue()}else{return true}},getValue:function(){var a=this;if(a._dirty){if(a.buttonview.getUIValue()=="design"){a._designer.resetCodeFromDesigner(true)}return a.codeeditor.getUIValue()}else{return a._ovalue}},setValue:function(e,a,d){e=(e||"").replace(/\t/g,"    ").replace(/\u00A0/g," ").replace(/\r\n?/g,"\n");var b=this;if(d||b._ovalue!=e){b._ovalue=e;b._dirty=false;b.codeeditor.setValue(e,d);b._uicode=null;if(b.buttonview.getUIValue()=="design"){b._beforeValueUpdated(null,null,"design")}}if(!a){var c=b._regClass.test(e);b.layoutFill.updateItem("after",{hidden:!c});b.buttonview.updateItem("design",{disabled:!c});b.toolbar4.showGroup("g1",c)}return b},customAppend:function(c,a,e,d){var b=this;c.append(b.paneMain,a);b.buttonview.getSubNode("ITEMS").append((new xui.UI.Image({src:CONF.img_progress,position:"relative",left:4,top:6})).setHost(b,"imgProgress"));b._disableUI()},iniExComs:function(){var c=this;var a=(new (xui.SC.get(c.properties.$pageviewType))).setHost(c,"buttonview").setNoPanel(true).setDock("top").setHeight("auto").setItems([{id:"code",caption:"$RAD.JSEditor.sv",imageClass:"spafont spa-icon-codeview",tips:"$RAD.JSEditor.svtips"},{id:"design",caption:"$RAD.JSEditor.dv",imageClass:"spafont spa-icon-designview",tips:"$RAD.JSEditor.dvtips"}]).beforeUIValueSet("_beforeValueUpdated");if(c.properties.$pageviewType=="xui.UI.ButtonViews"){a.setDock("bottom")}if(c.properties.$pageviewType=="xui.UI.ButtonViews"){a.setBarSize(28);a.setCustomStyle({ITEMS:"position:relative",LIST:"position:relative"})}c.paneMain.append(a);var b=new RAD.Designer();b.setHost(c,"_designer");b.setEvents("onValueChanged",function(f,d,e){c._dirty=e?d:c._dirty||d;c.fireEvent("onValueChanged",[c,c._dirty])});b.resetTaskList=function(){c._disableUI();c.$transTaskList=[];c.$transTaskListCached={}};b.addTask=function(d){c.$transTaskList.push(d)};b.hasTask=function(d){return !!c.$transTaskList.length};b.startTaskList=function(){c.checkRenderStatus(c)};b.resetCode=function(m,f,g,e,j,l){var d=function(){if(c.$transTaskListCached[m+":"+f]===g){return}c.addCodeToEditor(m,f,g,j,l);c.$transTaskListCached[m+":"+f]=g};if(e){d()}else{c.$transTaskList.push(d)}};b.addCode=function(m,f,g,e,j,l){var d=function(){if(c.$transTaskListCached[m+":"+f]===g){return}c.addCodeToEditor("Instance",f,g,j,l);c.$transTaskListCached[m+":"+f]=g};if(e){d()}else{c.$transTaskList.push(d)}};b.focusEditor=function(e,d){c.showPage("code");c._enable();c.tryToLocale([e,d])};b.searchInEditor=function(d){c.showPage("code");c._enable();var e=c.codeeditor.searchCode(d)};b.refreshFromCode=function(e){var d=c._getEval(c._ovalue=c.codeeditor.getUIValue());if(d.ok){if(CONF.getClientMode()!="project"||true){c.$transTaskListCached["Static:viewSize"]=this.refreshViewSize(d.ok,false)}c.$transTaskListCached["Instance:iniComponents"]=this.refreshView(d.ok,false,RAD.ClassTool.getClassName(c._ovalue));if(!e){xui.message(xui.getRes("RAD.designer.refreshOK"))}}};b.toCodeView=function(){c.buttonview.fireItemClickEvent("code")};b.saveDesign=function(){c.fireEvent("onCommandSave",[c])};c.paneDesign.append(b)},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a((new xui.UI.Pane).setHost(c,"paneMain").setDock("fill"));c.paneMain.append((new xui.UI.Pane).setHost(c,"paneCode").setVisibility("hidden").setDock("fill").setDockIgnore(true).setLeft(-1000));c.paneMain.append((new xui.UI.Pane).setVisibility("hidden").setHost(c,"paneDesign").setDock("fill"));c.paneCode.append((new xui.UI.Layout).setHost(c,"layoutFill").setItems([{id:"after",pos:"after",locked:false,size:150,min:50,max:200,cmd:true,folded:false,hidden:false},{id:"main",min:10}]).setType("horizontal"));c.layoutFill.append((new xui.UI.TreeBar).setHost(c,"treebarClass").setIniFold(false).setSelMode("none").setAnimCollapse(false).onItemSelected("_treebarclass_onitemselected"),"after");c.paneCode.append((new xui.UI.ToolBar).setHost(c,"toolbar4").onClick("_toolbar_onclick"));c.layoutFill.append((new RAD.CodeEditor).setHost(c,"codeeditor").setDock("fill").onValueChanged("_codeeditor_onChange").onRendered("_codeeditor_onrender").onSaveCommand("_codeeditor_onsave").onGetHelpInfo("_codeeditor_ongett").onCodeModeSet("_codeeditor_oncodemodeset"),"main");return b},setDftPage:function(a){var b=this;b.$dftpage=a},showPage:function(a){var b=this;if(b._once){return}b.buttonview.setUIValue(a,true)},_codeeditor_ongett:function(b,a){xui.asyRun(function(){xui.Coder.applyById("doc:code",true)});return RAD.EditorTool.getDoc(a)},_codeeditor_oncodemodeset:function(a,b){if(b){this.toolbar4.updateItem("rendermode",{caption:"&nbsp;"+b.name,mime:b.mime,mode:b.mode,tips:"Code was rendered as ["+b.name+"]"})}},_beforeValueUpdated:function(d,e,m){var q=this;if(e===m){return}q._once=true;if(m=="code"){var b;if(q._designer.isDirty()){b=q._designer.resetCodeFromDesigner();q._designer.clearDirty()}if(b){q._uicode=b.substr(1,b.length-2)}q.paneDesign.setDisplay("none").setZIndex(1);q.paneCode.setDockIgnore(false).setVisibility("visible").setZIndex(100).reLayout();q._rebuildNameSpace(null,false)}else{if(m=="design"){var x=q._getEval(),n;if(!x.ok){xui.message(xui.getRes("RAD.JSEditor.codeerr"));q._beforeValueUpdated(null,null,"code");q.codeeditor.focusLine(x.line-1);return false}if(!(n=RAD.ClassTool.getClassName(q.codeeditor.getUIValue()||""))){xui.message(xui.getRes("RAD.classtool.noClass"));return false}var s=false;if(CONF.getClientMode()!="project"||true){var j=false}var l=xui.get(x.ok,["Instance","iniComponents"]);if(!l){if(q._uicode){s=true;q._uicode=null}}else{var b=l._____string||(l+"");b=b.slice(b.indexOf("{")+1,b.lastIndexOf("}"));if(b!=q._uicode){var o=q.codeeditor.getLine("Instance","iniComponents"),u=o?(o.line):0,a=xui.str.repeat("\n",u);var c=RAD.CodeEditor.evalInSandbox(a+"(function(){"+b+"}());",false,"com:JSEditor:"+q.$xid+":1",null,true);if(!xui.isSet(c.ok)){xui.alert(xui.getRes("RAD.designer.comCodeErr")+"<br/><br/>"+c.ko);q.buttonview.setUIValue("code");q.codeeditor.focusLine(c.line-1);return false}q._uicode=b;s=true}}if(CONF.getClientMode()!="project"||true){if(!q._uiviewsize){j=true}else{var r=parseInt(xui.get(x.ok,["Static","viewSize","width"]),10),g=parseInt(xui.get(x.ok,["Static","viewSize","height"]),10);if(!r||!g){j=true}else{if(r!=q._uiviewsize.w||g!=q._uiviewsize.h){q._uiviewsize={w:r,h:g};j=true}}}}q.paneCode.setDockIgnore(true).setLeft(-10000).setVisibility("hidden").setZIndex(1);q.paneDesign.setDisplay("").setVisibility("visible").setZIndex(100).reLayout(true);if(!q._designer.tempSelected||!q._designer.tempSelected.length){s=true}if(CONF.getClientMode()!="project"||true){if(j){q.$transTaskListCached["Static:viewSize"]=q._designer.refreshViewSize(x.ok,false)}}else{q._designer.refreshViewSize(null,false)}if(s){q.$transTaskListCached["Instance:iniComponents"]=q._designer.refreshView(x.ok,null,n)}q._designer.reLayout(true)}}q._once=false},_disableUI:function(){var a=this,b=a._uiresetId||(a._uiresetId=a.KEY+":"+a.$xid+":progress");xui.resetRun(b,function(){if(!a.__UIdisabled){if(!a.toolbar4){return}a.codeeditor.setReadonly(true);a.toolbar4.setDisabled(true);a.treebarClass.setDisabled(true);if(a.imgProgress){a.imgProgress.setDisplay("")}a.__UIdisabled=true}})},_enable:function(){var a=this;xui.resetRun(a._uiresetId);a.__UIdisabled=false;a.codeeditor.setReadonly(false);a.toolbar4.setDisabled(false);a.treebarClass.setDisabled(false);if(a.imgProgress){a.imgProgress.setDisplay("none")}},checkRenderStatus:function(b){if(b._renderStatus&&b.$transTaskList&&b.$transTaskList.length){var a=b.$transTaskList.shift();xui.tryF(a)}},_codeeditor_onrender:function(b,d){var a=this;if(d){var c=a.KEY+":"+a.$xid+":rebuildNS";xui.resetRun(c,function(){a._rebuildNameSpace()},1000);if(a.__UIdisabled){a._enable()}else{if(xui.resetRun.exists(a._uiresetId)){xui.resetRun(c)}}if(!a.$initializd){a.$tasksthread=xui.Thread.repeat(function(){if(a.destroyed){return false}try{a.checkRenderStatus(a)}catch(f){}},300);a.$tasksthread.start();a.$initializd=true;a.showPage(a.$dftpage);a.fireEvent("afterRendered")}}else{a._disableUI()}a._renderStatus=!!d},_codeeditor_onChange:function(c,a){var b=this;b._dirty=a;b.fireEvent("onValueChanged",[b,b._dirty])},_codeeditor_onsave:function(b){var a=this;a.fireEvent("onCommandSave",[a])},_treebarclass_onitemselected:function(c,e,d){var b=this,a=e.id.split(".");b.tryToLocale(a)},addCodeToEditor:function(g,a,d,e,f){var c=this,b=this.codeeditor;b.addCodeInto(g,a,d,e,f)},tryToLocale:function(a){var c=this,b=this.codeeditor;b.locateTo(a[0],a[1])},_toolbar_onclick:function(d,f,a,g,j){var c=this,b=this.codeeditor,l=xui.use(j).offset();switch(f.id){case"design":c.buttonview.fireItemClickEvent("design");break;case"indentall":b.reindent();break;case"searchreplace":RAD.EditorTool.showFindWnd(b,l,b.getCM().getSelection());break;case"jumpto":RAD.EditorTool.showJumpToWnd(b,l);break;case"outline":c.layoutFill.updateItem("after",{hidden:!f.value});break;case"rendermode":b.showModeSelDlg(f);break}},focusEdit:function(j,q){var m=this,g=this.codeeditor,b=g.getBlockInfo(j,q),n=g.getCM(),c=n.doc.posFromIndex(b.from+1),f={},a=n.doc.posFromIndex(b.to),o={},l=n.doc.posFromIndex(n.doc.getValue().length+100),e,d;f.ch=0;f.line=c.line;f=n.doc.indexFromPos(f);f-=1;f=n.doc.posFromIndex(f);o.ch=0;o.line=a.line;e=document.createElement("span");e.innerHTML="...";e.className="cm-readonly";d=document.createElement("span");d.innerHTML="<br/>...";d.className="cm-readonly";n.markText({line:0,ch:0},f,{replacedWith:e,inclusiveLeft:true,inclusiveRight:true});n.markText(f,c,{className:"cm-readonly",readOnly:true,inclusiveLeft:true,inclusiveRight:true});n.markText(a,l,{replacedWith:d,inclusiveLeft:true,inclusiveRight:true});n.markText(o,a,{className:"cm-readonly",readOnly:true,inclusiveLeft:true,inclusiveRight:true})}}});xui.Class("RAD.EditorTool",null,{Static:{getPropName:function(a,e){if(!a||!e){return""}var b="doc.propname."+a.replace(/\./g,"_")+"."+e;var d=xui.getRes(b);if(d!=e){return xui.wrapRes(b)}else{var c=xui.get(window,a.split("."));c=c.prototype["get"+e.replace(/^[a-z]/g,function(f){return f.toUpperCase()})]||c["set"+e.replace(/^[a-z]/g,function(f){return f.toUpperCase()})];if(c&&c.$original$&&c.$original$!=a){return RAD.EditorTool.getPropName(c.$original$,e)}else{return xui.wrapRes(b)}}},getEventName:function(b,a){if(!b||!a){return""}var c="doc.eventname."+b.replace(/\./g,"_")+"."+a;var e=xui.getRes(c);if(e!=a){return xui.wrapRes(c)}else{var d=xui.get(window,b.split("."));d=d.prototype[a];if(d&&d.$original$&&d.$original$!=b){return RAD.EditorTool.getEventName(d.$original$,a)}else{return xui.wrapRes(c)}}},getDoc:function(a,g,b){if(!a){return""}if(a.indexOf("(")!=-1){a=a.replace(/[()]/g,"")}var f=xui.getRes("doc."+a);try{if(typeof f=="string"){var d=xui.get(window,a.split("."));if(d&&d.$original$){f=xui.getRes("doc."+d.$original$+((d.$type$=="instance"||d.$type$=="event")?".prototype":"")+"."+d.$name$)}if(typeof f=="string"){return null}}return b?f:this._buildDoc(f,g)}catch(c){return null}},_buildDoc:function(c,b){var a=[];if(c){if(b){return c.$desc}else{if(c.$desc){a.push('<div class="doc-inndiv">'+c.$desc+"</div>")}if(c.$rtn){a.push('<div class="doc-inndiv"><strong>'+xui.getRes("app.retV")+": </strong>"+c.$rtn+"</div>")}if(c.$paras){a.push('<div class="doc-inndiv"><div><strong>'+xui.getRes("app.param")+": </strong></div><ul>");xui.arr.each(c.$paras,function(d){d=d.replace(/^([^:\[]*)([^:]*):(.*)$/,"<strong>$1</strong> $2 : $3");a.push("<li> "+d+" </li>")});a.push("</ul></div>")}if(c.$snippet){a.push('<div class="doc-inndiv"><div><strong>'+xui.getRes("app.codesnip")+": </strong></div>");xui.arr.each(c.$snippet,function(d){a.push('<textarea id="doc:code" class="js plain fold" style="display:none;">'+d+"</textarea><p>&nbsp;</p>")});a.push("</div>")}if(c.$memo){a.push('<div class="doc-inndiv"><strong>'+xui.getRes("app.memo")+": </strong>"+c.$memo+"</div>")}if(c.$links){a.push('<div class="doc-inndiv"><div><strong>'+xui.getRes("app.seealso")+": </strong></div><ul>");xui.arr.each(c.$links,function(d){a.push('<li><a target="'+(d[2]||"")+'" href="'+d[1]+'">'+d[0]+"</a></li>")});a.push("</ul></div>")}}}return a.join("")},showFindWnd:function(b,d,c,a){xui.ComFactory.getCom("RAD.FAndR",function(){this._editor=b;this._init=c;this.show(null,b.getRoot(),null,null,0,0)})},showJumpToWnd:function(a,b){xui.ComFactory.getCom("RAD.JumpTo",function(){this.setEvents({onOK:function(c){try{a.callEditor("focus");a.callEditor("setCursor",[c-1,0],true)}catch(d){}}});this.show(null,null,null,null,b.left,b.top)})}}});xui.Class("RAD.EditorTheme","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dlg").setLeft("2.5em").setTop("3.125em").setWidth("45.833333333333336em").setHeight("26.416666666666668em").setCaption("$RAD.editorTheme.name").setMinBtn(false).setMaxBtn(false).setOverflow("hidden"));c.dlg.append(xui.create("xui.UI.Panel").setHost(c,"ctl_panel7").setDock("none").setLeft("0.625em").setTop("13.75em").setWidth("15.916666666666666em").setHeight("8.75em").setZIndex(1).setOverflow("visible").setCaption("$RAD.editorTheme.selFontSize"));c.ctl_panel7.append(xui.create("xui.UI.ComboInput").setHost(c,"_ctl_fs").setDirtyMark(false).setLeft("9.083333333333334em").setTop("3em").setWidth("5.25em").setZIndex(1003).setType("spin").setUnit("px").setPrecision(0).setIncrement(1).setMin(1).setMax(100).afterValueSet("_ctl_fs_aftervalueset"));c.ctl_panel7.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel124").setLeft("0em").setTop("3.3333333333333335em").setWidth("8.25em").setHeight("1.5em").setCaption("$RAD.editorTheme.selFontSize"));c.ctl_panel7.append(xui.create("xui.UI.CheckBox").setHost(c,"ctl_wrap").setDirtyMark(false).setLeft("3.5833333333333335em").setTop("0.6666666666666666em").setWidth("10.833333333333334em").setIconPos("right").setCaption("$RAD.editorTheme.lineWrapping").afterUIValueSet("_ctl_wrap_afteruivalueset"));c.dlg.append(xui.create("xui.UI.Panel").setHost(c,"ctl_panel4").setDock("none").setLeft("0.625em").setTop("0.625em").setWidth("15.916666666666666em").setHeight("12.75em").setZIndex(1).setCaption("$RAD.editorTheme.selTheme"));c.ctl_panel4.append(xui.create("xui.UI.List").setHost(c,"_ctl_theme").setDirtyMark(false).setItems([{id:"default",caption:"default"},{id:"3024-day",caption:"3024-day"},{id:"3024-night",caption:"3024-night"},{id:"abcdef",caption:"abcdef"},{id:"ambiance-mobile",caption:"ambiance-mobile"},{id:"ambiance",caption:"ambiance"},{id:"base16-dark",caption:"base16-dark"},{id:"base16-light",caption:"base16-light"},{id:"bespin",caption:"bespin"},{id:"blackboard",caption:"blackboard"},{id:"cobalt",caption:"cobalt"},{id:"colorforth",caption:"colorforth"},{id:"darcula",caption:"darcula"},{id:"duotone-dark",caption:"duotone-dark"},{id:"duotone-light",caption:"duotone-light"},{id:"eclipse",caption:"eclipse"},{id:"elegant",caption:"elegant"},{id:"erlang-dark",caption:"erlang-dark"},{id:"gruvbox-dark",caption:"gruvbox-dark"},{id:"hopscotch",caption:"hopscotch"},{id:"icecoder",caption:"icecoder"},{id:"idea",caption:"idea"},{id:"isotope",caption:"isotope"},{id:"lesser-dark",caption:"lesser-dark"},{id:"liquibyte",caption:"liquibyte"},{id:"lucario",caption:"lucario"},{id:"material",caption:"material"},{id:"mbo",caption:"mbo"},{id:"mdn-like",caption:"mdn-like"},{id:"midnight",caption:"midnight"},{id:"nord",caption:"nord"},{id:"monokai",caption:"monokai"},{id:"neat",caption:"neat"},{id:"neo",caption:"neo"},{id:"night",caption:"night"},{id:"oceanic-next",caption:"oceanic-next"},{id:"panda-syntax",caption:"panda-syntax"},{id:"paraiso-dark",caption:"paraiso-dark"},{id:"paraiso-light",caption:"paraiso-light"},{id:"pastel-on-dark",caption:"pastel-on-dark"},{id:"railscasts",caption:"railscasts"},{id:"rubyblue",caption:"rubyblue"},{id:"seti",caption:"seti"},{id:"shadowfox",caption:"shadowfox"},{id:"solarized",caption:"solarized"},{id:"ssms",caption:"ssms"},{id:"the-matrix",caption:"the-matrix"},{id:"tomorrow-night-bright",caption:"tomorrow-night-bright"},{id:"tomorrow-night-eighties",caption:"tomorrow-night-eighties"},{id:"ttcn",caption:"ttcn"},{id:"twilight",caption:"twilight"},{id:"vibrant-ink",caption:"vibrant-ink"},{id:"xq-dark",caption:"xq-dark"},{id:"xq-light",caption:"xq-light"},{id:"yeti",caption:"yeti"},{id:"yonce",caption:"yonce"},{id:"zenburn",caption:"zenburn"}]).setDock("fill").setBorderType("none").setValue("").afterValueSet("_ctl_theme_aftervalueset"));c.dlg.append(xui.create("xui.UI.Button").setHost(c,"btnOK").setLeft("31.833333333333332em").setTop("20.625em").setWidth("8.083333333333334em").setImageClass("spafont spa-icon-ok").setCaption("$RAD.ok").onClick("_btnok_onclick"));c.dlg.append(xui.create("xui.UI.Button").setHost(c,"ctl_sbutton13").setLeft("22.5em").setTop("20.625em").setWidth("8.083333333333334em").setImageClass("spafont spa-icon-cancel").setCaption("$RAD.cancel").onClick("_btncancel_onclick"));c.dlg.append(xui.create("xui.UI.Block").setHost(c,"codePreview").setLeft("17.416666666666668em").setTop("0.625em").setWidth("26.25em").setHeight("19.375em").setBorderType("inset").setBackground("#FFFFFF").setOverflow("hidden"));return b},_btnok_onclick:function(a,c,d,b){this.fireEvent("onOK",[this._theme,this._fontsize,this._lineWrapping],this);this.dlg.close()},_btncancel_onclick:function(a,c,d,b){this.dlg.close()},customAppend:function(b){var a=this,f=parseInt(xui.CSS.$getCSSValue(".codemirror","fontSize"),10)||13,e="default",c=false;var d=CONF.getStatus();if(d){if(xui.isFinite(d.editorFontSize)){f=d.editorFontSize}if(d.editorTheme){e=d.editorTheme}if(xui.isSet(d.lineWrapping)){c=d.lineWrapping}}a._ctl_fs.setUIValue(a._fontsize=f);a._ctl_theme.setUIValue(a._theme=e);a.ctl_wrap.setUIValue(a._lineWrapping=c);a.dlg.showModal(b);return false},_refreshCode:function(){var a=this,c="cm-theme-"+a._theme,b=CONF.mapServerPath(CONF.mapServerPath("/RAD/template/"+xui.getLang()+"/index.js"));if(a._theme!="default"&&!xui.CSS.get("id",c)){xui.CSS.includeLink("/plugins/codemirror5/theme/"+a._theme+".css",false,c)}CONF.getLocalFile(b,function(e){a.codePreview.getSubNode("PANEL").html("",true);var d=new CodeMirror(function(f){a.codePreview.getSubNode("PANEL").append(f);f.style.fontSize=a._fontsize+"px"},{theme:a._theme,lineWrapping:!!a._lineWrapping,readOnly:true,value:e})},function(){alert(xui.getRes("RAD.builder.noexist",b))})},_ctl_fs_aftervalueset:function(b){var a=this;a._fontsize=b.boxing().getValue();xui.resetRun(this.$xid,function(){a._refreshCode()},100)},_ctl_theme_aftervalueset:function(b){var a=this;a._theme=b.boxing().getValue();xui.resetRun(this.$xid,function(){a._refreshCode()},100)},_ctl_wrap_afteruivalueset:function(c,a,d){var b=this;b._lineWrapping=!!d;xui.resetRun(this.$xid,function(){b._refreshCode()},100)}}});xui.Class("RAD.JSONEditor","xui.Module",{Instance:{$PageEditor:null,activate:function(){this.tabs.setValue("editor")},setValue:function(c){var a=this,b=xui.isStr(c)?c?xui.unserialize(c):false:c;a._rootArr=xui.isArr(b);a.setInnerValue(c)},setInnerValue:function(e,b){var a=this,b=b||this.tabs.getUIValue(false);if(b=="editor"){var d=xui.isStr(e)?e?xui.unserialize(e):false:e;var c=a._json2rows(d,a._rootArr);a.tg.setRows(c).free()}else{e=(xui.isStr(e)?e:xui.serialize(e))||"";if(xui.Coder){e=xui.Coder.formatText(e)}a.$PageEditor.setValue(e);xui.asyRun(function(){a.$PageEditor.activate()})}},getValue:function(a,b){var c,b=b||this.tabs.getUIValue();if(b=="editor"){c=this._rows2json(this.tg.getRows(),this._rootArr)}else{c=this.$PageEditor.getValue()}return a?xui.unserialize(c):c},getEditor:function(){return this.tg},_dialog_beforeclose:function(b){var a=this;a.tg.removeAllRows();delete this.path;a.$PageEditor.setValue("");a.dialog.hide();return false},_btnSave_onclick:function(){var c=this,e=c.properties,b=c.getValue();if(b===false){return false}if(b){if(!this.path){var a=SPA.currentPage.split("/"),d="filename";xui.showCom("RAD.AddFile",function(){this.setProperties({cls:"save",fileName:d,parentPath:SPA.curProjectPath+"/data",typeCaption:xui.adjustRes("$RAD.pm.normaljs"),type:".json",tailTag:".json",forcedir:true,content:b});this.setEvents({onOK:function(){xui.message(xui.getRes("RAD.ps.saved",1))}})},null,null,true)}else{xui.Ajax(CONF.saveFile,{path:this.path,content:b},function(){this.setEvents({onOK:function(){xui.message(xui.getRes("RAD.ps.saved",1))}})},function(){},null,{rspType:"json",method:"POST"}).start()}}},_btncancel_onclick:function(){var a=this;a.tg.removeAllRows();a.$PageEditor.setValue("");a.dialog.close()},_check:function(b){var c=this;var a=RAD.CodeEditor.evalInSandbox("("+b+")",false,null,null,true);if(a.ko){xui.message(xui.getRes("RAD.JSEditor.codeerr"));return false}if(c._rootArr){if(!xui.isArr(a.ok)){xui.message("Must be an Array!");return false}}else{if(!xui.isHash(a.ok)){xui.message("Must be an Object!");return false}}a=RAD.ClassTool.parseSingleBlock(b);if(false===a){xui.message(xui.getRes("RAD.classtool.err1"));return false}return a},_btnok_onclick:function(){var c=this,d=c.properties,b=c.getValue(),a;if(a=c._check(b)){d.result=a;d.object=xui.unserialize(b)||null;xui.tryF(d.onOK,[c,b],c.host);c.dialog.close()}},_tabs_beforeuivalueset:function(d,b,g,f,a){var c=this,e=c.getValue(false,b);if(c._check(e)){c.setInnerValue(e,g)}else{return false}},customAppend:function(b){var c=this,e=c.properties,d=c.dialog;d.setCaption(e.caption).setImage(e.image).setImagePos(e.imagePos);if(e.fromRegion){d.setFromRegion(e.fromRegion)}if(!c.$PageEditor){var a=new RAD.PageEditor();a.setType("json.ex");a.setHost(c,"$PageEditor");c.$PageEditor=a;c.tabs.append(a,"code");a.codeeditor.setCodeType("json",true)}if(!SPA.currentPage){c.btnSave.setDisplay("none");c.btnLoad.setDisplay("none")}c.setValue(e.text||"");d.showModal(b);xui("body").append(c.xui_ui_block5)},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dialog").setLeft("4.375em").setTop("2.5em").setWidth("47.75em").setHeight("32.5em").setCaption("dialog").setMinBtn(false).beforeClose("_dialog_beforeclose"));c.dialog.append(xui.create("xui.UI.Div").setHost(c,"panelB").setDock("bottom").setHeight("3em"));c.panelB.append(xui.create("xui.UI.Div").setHost(c,"panelR").setDock("right").setWidth("18.5em"));c.panelR.append(xui.create("xui.UI.Button").setHost(c,"btnCancel").setLeft("0.8333333333333334em").setTop("0.5833333333333334em").setWidth("6.083333333333333em").setCaption("$inline.cancel").setImageClass("spafont spa-icon-cancel").onClick("_btncancel_onclick"));c.panelR.append(xui.create("xui.UI.Button").setHost(c,"btnOK").setLeft("9.166666666666666em").setTop("0.5833333333333334em").setWidth("6.083333333333333em").setCaption("$inline.ok").setImageClass("spafont spa-icon-ok").onClick("_btnok_onclick"));c.panelB.append(xui.create("xui.UI.Button").setHost(c,"btnLoad").setHoverPop("xui_ui_block5").setLeft("1em").setTop("0.6666666666666666em").setWidth("5.833333333333333em").setCaption("$RAD.Load").setImageClass("xui-icon-back"));c.dialog.append(xui.create("xui.UI.Block").setHost(c,"panelMain").setDock("fill").setBorderType("inset"));c.panelMain.append(xui.create("xui.UI.Tabs").setHost(c,"tabs").setItems([{id:"code",caption:"CODE"},{id:"editor",caption:"$RAD.spabuilder.menubar.jsoneditor",imageClass:"spafont spa-icon-hash"}]).setLeft("15.833333333333334em").setTop("5em").setValue("editor").beforeUIValueSet("_tabs_beforeuivalueset"));c.tabs.append(xui.create("xui.UI.TreeGrid").setHost(c,"tg").setTogglePlaceholder(true).setEditable(true).setIniFold(false).setRowHandler(false).setColSortable(false).setHeader([{id:"key",width:"8.333333333333334em",type:"input",caption:"key",editorCacheKey:"input",colResizer:true,flexSize:true},{id:"value",width:"16.666666666666668em",type:"textarea",caption:"value",editorCacheKey:"textarea",flexSize:true}]).setTagCmds([{id:"add",type:"text",caption:"",location:"right",itemClass:"xuicon xui-uicmd-getter",pos:"header row",tips:"Append a child"},{id:"up",type:"text",location:"right",itemClass:"xuicon xui-icon-arrowtop",pos:"row",tips:"Add a node to the front of the node"},{id:"down",type:"text",location:"right",itemClass:"xuicon xui-icon-arrowbottom",pos:"row",tips:"Add a node at the back of this node"},{id:"del",type:"text",location:"right",itemClass:"xuicon xui-uicmd-close",pos:"row",tips:"Delete this node"}]).setTreeMode("infirstcell").onCmd("_tg_oncmd").beforeRowActive("_tg_beforerowactive").beforeCellUpdated("_tg_beforecellupdated").beforeIniEditor("_tg_beforeIniEditor").onBeginEdit("_tg_onEdit").beforeEditApply("_tg_beforecellapply"),"editor");a(xui.create("xui.UI.Block").setHost(c,"xui_ui_block5").setLeft("5.833333333333333em").setTop("34.25em").setWidth("30em").setHeight("15.833333333333334em").setBorderType("flat"));c.xui_ui_block5.append(xui.create("xui.UI.TreeView").setHost(c,"treeview").setLeft("0em").setTop("4.166666666666667em").setSingleOpen(true).setDynDestory(true).setSelMode("none").setItems([{id:"data",sub:true}]).onClick("_treebarprj_onclick").onGetContent("_treebarprj_onGetContent").onItemSelected("_treebarprj_onitemselected"));return b},_getCellValue:function(d){var b=this,a;try{a=xui.str.trim(d);if(/^'/.test(a)&&!b._isString(a.slice(1))){a=["string",a.slice(1)]}else{a=a.replace(/^\s*/,"").replace(/\s*$/,"");a=a=="null"?["null","null"]:xui.isFinite(a)?["number",a]:/^\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*$/.test(a)?["regexp",a]:/^(true|false)$/.test(a)?["boolean",a.toLowerCase()]:/^new Date\([0-9 \,]*\)$/i.test(a)?["date",xui.serialize(xui.unserialize(a))]:/^((\s*function\s*([\w$]+\s*)?\(\s*([\w$\s,]*)\s*\)\s*)(\{([^\{\}]*)\}))\s*$/i.test(a)&&xui.isFun(xui.unserialize(a))?["function",a]:/^\{[\s\S]*\}$/.test(a)&&xui.isHash(xui.unserialize(a))?["hash",xui.stringify(xui.unserialize(a))]:/^\[[\s\S]*\]$/.test(a)&&xui.isArr(xui.unserialize(a))?["array",xui.stringify(xui.unserialize(a))]:["string",d]}}catch(c){a=null}if(a[0]=="string"){if(a[1]===false){return null}a[1]=xui.stringify(a[1])}if(a[1]==="false"&&a[0]!="string"){a[0]="boolean"}return a},_json2rows:function(d,e,c){var a=this,b=arguments.callee;if(!c){c=[]}if(d){xui.each(d,function(l,f){if(!d.hasOwnProperty(f)){return}var j={},g=a._getType(l);f={value:e?"["+f+"]":f,readonly:e};if(g=="hash"){j.sub=[];j.cells=[f,{value:"{...}"},""];b.call(a,l,false,j.sub)}else{if(g=="array"){j.sub=[];j.cells=[f,{value:"[...]"},""];b.call(a,l,true,j.sub)}else{j.cells=[f,xui.stringify(l),""]}}j._type=g;j.caption="";c.push(j)})}return c},_getType:function(a){return a===null?null:xui.isStr(a)?"string":xui.isNumb(a)?"number":xui.isHash(a)?"hash":xui.isArr(a)?"array":xui.isBool(a)?"boolean":xui.isDate(a)?"date":xui.isReg(a)?"regexp":xui.isFun(a)?"function":"undefined"},_rows2json:function(b,g){var e=arguments.callee,c=[],d,f;xui.arr.each(b,function(a){d=((typeof a.cells[0]=="object")?a.cells[0].value:a.cells[0]);if(a._type=="hash"){f=e(a.sub)}else{if(a._type=="array"){f=e(a.sub,true)}else{f=(typeof a.cells[1]=="object")?a.cells[1].value:a.cells[1]}}if(g){c.push(f)}else{c.push('"'+d+'":'+f)}});return g?"["+c.join(",")+"]":"{"+c.join(",")+"}"},_tg_onEdit:function(c,d,b,a){if(c.properties.multiLineValue){b.getSubNode("INPUT").scrollTop(0)}this.fireEvent("onEdit",[d._col.id,b])},_tg_beforeIniEditor:function(f,g,a,c,e){var d=this;if(e!="cell"){return}if(g._col.id!="value"){return}var e=g._row._type;if(e=="hash"||e=="array"){var j=this._rows2json(g._row.sub,e=="array");if(xui.Coder){j=xui.Coder.formatText(j)}g.$editorValue=j}else{if(e=="string"){var b=xui.unserialize(g.value);if(!d._isString(b)){g.$editorValue="'"+b}else{g.$editorValue=b}}}},_isString:function(a){return !(a=="undifined"||a=="null"||a=="NaN"||xui.isFinite(a)||/^\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*$/.test(a)||/^(true|false)$/.test(a)||/^new Date\([0-9 \,]*\)$/i.test(a)||(/^((function\s*([\w$]+\s*)?\(\s*([\w$\s,]*)\s*\)\s*)(\{([^\{\}]*)\}))$/i.test(a)&&xui.isFun(xui.unserialize(a)))||(/^\{[\s\S]*\}$/.test(a)&&xui.isHash(xui.unserialize(a)))||(/^\[[\s\S]*\]$/.test(a))&&xui.isArr(xui.unserialize(a)))},_tg_beforecellapply:function(d,e,b,c,a){if(a=="asycheck"){return false}},_tg_beforecellupdated:function(e,j,m){var g=this,a={hash:1,array:2},l=j._row,d=l.id,c=e.boxing();if(j._col.id=="value"){var f=this._getCellValue(m.value);if(!f){alert("Text format is not valid!");return false}else{var b={};m.value=f[1];if(a[f[0]]){b.sub=this._json2rows(xui.unserialize(f[1]),f[0]=="array");m.caption=f[0]=="hash"?"{...}":"[...]"}else{if(l.sub){b.sub=null}}xui.asyRun(function(){if(c.isDestroyed()){return}c.updateRow(d,b);l=c.getRowbyRowId(d);if(l){l._type=f[0]}g.fireEvent("onchange",[g])},100)}}else{if(!/^"(\\.|[^"\\])*"$/.test('"'+m.value+'"')){alert("Text format is not valid!");return false}xui.asyRun(function(){g.fireEvent("onchange",[g])},100)}},_tg_beforerowactive:function(){return false},_treebarprj_onclick:function(a,b){if(b.sub){a.boxing().toggleNode(b.id)}},_treebarprj_onitemselected:function(c,d,f,g,b){var a=this;if(!d.sub){this.path=d.id;xui.Ajax(CONF.getFileContent,{path:d.id,packagePath:SPA.curProjectPath},function(e){if(e&&e.data&&e.data.content){a.setValue(e.data.content)}},function(e){xui.message(e)}).start();this.xui_ui_block5.hide()}},_treebarprj_onGetContent:function(b,c,e){var d=(c.id=="data")?(SPA.curProjectPath+"/data"):c.id;var a=this;xui.Ajax(CONF.openFolderService,{path:d,curProjectPath:SPA.curProjectPath,hashCode:xui.id()},function(f){var j=f,g=[];if(j&&!j.error){if(xui.get(j,["data","files"])){xui.arr.each(j.data.files,function(l){g.push({id:l.location,caption:l.name,sub:l.type===0})})}e(g)}else{xui.message(xui.get(j,["error","errdes"])||j||"no response!")}},null,null,{method:"POST"})},_tg_oncmd:function(f,q,j,g,b){var m=this,d=f.boxing(),l=q?q._type:m._rootArr?"array":"hash",o,n,a;if(q&&q._pid){n=f.rowMap[q._pid];o=n&&n._type}else{n={sub:f.properties.rows};o=m._rootArr?"array":"hash"}switch(j){case"add":a=xui.stamp();if(q){if(l=="array"||l=="hash"){d.insertRows([{id:a,cells:[{value:l=="array"?"[index]":xui.rand(),readonly:l=="array"},"null",""]}],q.id)}else{var c=q.id;xui.confirm("Hash or Array","Modify this node as an Hash or Array?",function(){d.updateCellByRowCol(c,"value","{"+xui.rand()+":"+q.cells[1].value+"}",false,true);xui.asyRun(function(){d.editCellbyRowCol(c,"value")},200)},function(e){if(e=="close"){return}var r=q.id;d.updateCellByRowCol(r,"value","["+q.cells[1].value+"]",false,true);xui.asyRun(function(){d.editCellbyRowCol(r,"value")},200)},"As a Hash","As an Array");return}}else{d.insertRows([{id:a,cells:[{value:l=="array"?"[index]":xui.rand(),readonly:l=="array"},"null",""]}])}break;case"up":a=xui.stamp();d.insertRows([{id:a,cells:[{value:o=="array"?"[index]":xui.rand(),readonly:o=="array"},"null",""]}],null,q.id,true);break;case"down":a=xui.stamp();d.insertRows([{id:a,cells:[{value:o=="array"?"[index]":xui.rand(),readonly:o=="array"},"null",""]}],null,q.id,false);break;case"del":d.removeRows([q.id]);break}if(q&&l=="array"){xui.arr.each(q.sub,function(s,r){var e=s.cells[0];f.boxing().updateCell(e,{caption:"["+r+"]"})})}else{if(n&&o=="array"){xui.arr.each(n.sub,function(s,r){var e=s.cells[0];f.boxing().updateCell(e,{caption:"["+r+"]"})})}}if(a){xui.asyRun(function(){d.editCellbyRowCol(a+"",o=="array"?"value":"key")})}xui.asyRun(function(){m.fireEvent("onchange",[m])},100)}}});xui.Class("RAD.FunEditor","xui.Module",{Instance:{$PageEditor:null,activate:function(){this.$PageEditor.activate()},setValue:function(a){this.$PageEditor.setValue(a||"")},setReadonlyLines:function(b,a){this.$PageEditor.setReadonlyLines(b,a)},_dlg_onshow:function(){this.$PageEditor.activate()},_dialog_beforeclose:function(a){this.dialog.hide();return false},_btncancel_onclick:function(){this.setValue("");this.dialog.close()},_btnok_onclick:function(){var c=this,d=c.properties,b=c.$PageEditor.getValue();if(b===false){return false}var a=RAD.CodeEditor.evalInSandbox("("+b+")",false,null,null,true);if(a.ko){xui.message(xui.getRes("RAD.JSEditor.codeerr"));return false}d.result=RAD.ClassTool.parseSingleBlock(b);if(false===d.result){xui.message(xui.getRes("RAD.classtool.err1"));return false}d.object=xui.unserialize(d.result.code)||null;xui.tryF(d.onOK,[c],c.host);c.setValue(d.text="");c.dialog.close()},customAppend:function(b){var c=this,e=c.properties,d=c.dialog;d.setCaption(e.caption).setImage(e.image).setImagePos(e.imagePos);if(e.fromRegion){d.setFromRegion(e.fromRegion)}if(!c.$PageEditor){var a=new RAD.PageEditor;a.setHost(c,"$PageEditor");c.panelMain.append(a)}c.$PageEditor.setType("js");c.setValue(e.text||"");this.$PageEditor.reindent();if(e.head_readonly||e.tail_readonly){c.setReadonlyLines(e.head_readonly,e.tail_readonly)}d.showModal(b)},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dialog").setLeft("4.375em").setTop("2.5em").setWidth("41.416666666666664em").setHeight("24.916666666666668em").setCaption("dialog").setMinBtn(false).setMaxBtn(false).beforeClose("_dialog_beforeclose").onShow("_dlg_onshow"));c.dialog.append(xui.create("xui.UI.Div").setHost(c,"panelB").setDock("bottom").setHeight("3.3333333333333335em"));c.panelB.append(xui.create("xui.UI.Div").setHost(c,"panelR").setDock("right").setWidth("24.25em"));c.panelR.append(xui.create("xui.UI.Button").setHost(c,"btnCancel").setLeft("-5.25em").setTop("0.5em").setWidth("7.75em").setImageClass("spafont spa-icon-cancel").setCaption("$inline.cancel").onClick("_btncancel_onclick"));c.panelR.append(xui.create("xui.UI.Button").setHost(c,"btnOK").setLeft("4.75em").setTop("0.5em").setWidth("7.75em").setImageClass("spafont spa-icon-ok").setCaption("$inline.ok").onClick("_btnok_onclick"));c.dialog.append(xui.create("xui.UI.Block").setHost(c,"panelMain").setDock("fill").setBorderType("inset"));return b}}});xui.Class("RAD.ObjectEditor2","xui.Module",{Instance:{$PageEditor:null,activate:function(){this.$PageEditor.activate()},setValue:function(a){this.$PageEditor.setValue(a||"")},_dialog_beforeclose:function(a){this.dialog.hide();return false},_btncancel_onclick:function(){this.setValue("");this.dialog.close()},_btnSave_onclick:function(){var c=this,e=c.properties,b=c.$PageEditor.getValue();if(b===false){return false}if(b){var a=SPA.currentPage.split("/"),d=a.pop().replace(/\.js/i,"");xui.showCom("RAD.AddFile",function(){this.setProperties({cls:"save",fileName:d,parentPath:SPA.curProjectPath+"/data",typeCaption:xui.adjustRes("$RAD.pm.normaljs"),type:".json",tailTag:".json",forcedir:true,content:b});this.setEvents({onOK:function(){c.setValue(e.text="");c.dialog.close()}})},null,null,true)}},customAppend:function(b){var c=this,e=c.properties,d=c.dialog;if(e.fromRegion){d.setFromRegion(e.fromRegion)}if(!c.$PageEditor){var a=new RAD.PageEditor;a.setHost(c,"$PageEditor");a.setType(c._codetype);c.panelMain.append(a)}c.setValue(e.text||"");if(!SPA.currentPage){c.btnSave.setDisplay("none")}d.showModal(b,null,null,function(){if(c.$PageEditor){c.$PageEditor._refreshCM()}})},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dialog").setLeft("4.375em").setTop("-0.125em").setWidth("41.416666666666664em").setHeight("22.5625em").setCaption("$(RAD.pageEditor.Page Data)").setMinBtn(false).beforeClose("_dialog_beforeclose"));c.dialog.append(xui.create("xui.UI.Div").setHost(c,"panelB").setDock("bottom").setHeight("2.6666666666666665em"));c.panelB.append(xui.create("xui.UI.Div").setHost(c,"panelR").setDock("right").setWidth("30.916666666666668em"));c.panelR.append(xui.create("xui.UI.Button").setHost(c,"btnCancel").setLeft("4.083333333333333em").setTop("0.25em").setWidth("7.166666666666667em").setImageClass("xui-icon-back").setCaption("$RAD.close").onClick("_btncancel_onclick"));c.panelR.append(xui.create("xui.UI.Button").setHost(c,"btnSave").setLeft("14.083333333333334em").setTop("0.25em").setWidth("7.166666666666667em").setImageClass("xui-uicmd-save").setCaption("$RAD.save").onClick("_btnSave_onclick"));c.dialog.append(xui.create("xui.UI.Block").setHost(c,"panelMain").setDock("fill").setBorderType("inset"));return b}}});xui.Class("RAD.FileSelector","xui.Module",{Instance:{customAppend:function(c){var b=this,e=b.properties,a=e.parent,d=b.dialog;if(e.fromRegion){d.setFromRegion(e.fromRegion)}if(!d.get(0).renderId){d.render()}b.treebar.resetValue();d.show(c,true);CONF.callService({key:CONF.requestKey,curProjectPath:SPA.curProjectPath,paras:{action:"open",hashCode:xui.id(),path:SPA.curProjectPath}},function(f){var j=f;if(!j||j.error){xui.message(xui.get(j,["error","errdes"])||"no response!")}else{var g=SPA.buildFileItems(SPA.curProjectPath,j.data.files||j.data);b.treebar.setItems([g]).toggleNode(g.id,true)}})},_dialog_beforeclose:function(a){this.dialog.hide();return false},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dialog").setLeft("15.4375em").setTop("7.5em").setWidth("27.0625em").setHeight("25.833333333333332em").setResizer(false).setCaption("$RAD.selFile").setImageClass("spafont spa-icon-select").setMinBtn(false).setMaxBtn(false).onHotKeydown("_dialog_onhotkey").beforeClose("_dialog_beforeclose"));c.dialog.append(xui.create("xui.UI.Group").setHost(c,"panelbar2").setDock("top").setHeight("19.166666666666668em").setCaption("$RAD.selFilePath").setToggleBtn(false).setCustomStyle({PANEL:{overflow:"auto"}}).setCustomClass({PANEL:"xui-uibase"}));c.panelbar2.append(xui.create("xui.UI.TreeView").setHost(c,"treebar").setDirtyMark(false).setDock("none").setWidth("auto").setHeight("auto").setPosition("relative").beforeUIValueSet("_treebar_beforevalueupdated").onClick("_treebar_onclick").onGetContent("_treebar_ongetcontent"));c.dialog.append(xui.create("xui.UI.Button").setHost(c,"btnCancel").setDirtyMark(false).setLeft("5em").setTop("20em").setWidth("6.916666666666667em").setImageClass("spafont spa-icon-cancel").setCaption("$RAD.cancel").onClick("_btncancel_onclick"));c.dialog.append(xui.create("xui.UI.Button").setHost(c,"btnOK").setDirtyMark(false).setLeft("15.625em").setTop("20em").setWidth("6.916666666666667em").setImageClass("spafont spa-icon-ok").setCaption("$RAD.ok").onClick("_btnok_onclick"));return b},_btncancel_onclick:function(a,c,b){this.dialog.close()},_btnok_onclick:function(c,f,d){var b=this.treebar.getUIValue(),a=this;if(b){xui.tryF(a.properties.onOK,[this,b],a.host);a.dialog.close()}},_treebar_beforevalueupdated:function(c,a,d){if(d){var b=d.split("/").pop();if(b.indexOf(".")==-1){return false}}else{return false}},_dialog_onhotkey:function(b,a){if(a.key=="esc"){b.boxing().close()}},_treebar_ongetcontent:function(b,c,d){var a=this;CONF.callService({key:CONF.requestKey,curProjectPath:SPA.curProjectPath,paras:{action:"open",hashCode:xui.id(),path:c.id}},function(e){var g=e;if(g&&!g.error){var f=SPA.buildFileItems(c.id,g.data.files||g.data);d(f.sub)}else{xui.message(g.error.message)}})},_treebar_onclick:function(a,b,c,d){if(b.sub){a.boxing().toggleNode(b.id)}}}});xui.Class("RAD.ImageSelector","xui.Module",{Instance:{customAppend:function(c){var b=this,e=b.properties,a=e.parent,d=b.dialog;if(!d.get(0).renderId){d.render()}d.show(c,true);b.ctl_tabs2.setUIValue(null).setUIValue("inner")},_dialog_beforeclose:function(a){this.dialog.hide();return false},iniComponents:function(){var d=this,c=[],a=function(e){c.push(e.get(0))};a(xui.create("xui.UI.Dialog").setHost(d,"dialog").setLeft("3.125em").setTop("1.25em").setWidth("54.333333333333336em").setHeight("30em").setCaption("$(RAD.img.Image Selector)").setImageClass("spafont spa-icon-gallery").setMinBtn(false).onHotKeydown("_dialog_onhotkey").beforeClose("_dialog_beforeclose"));d.dialog.append(xui.create("xui.UI.Div").setHost(d,"xui_ui_div13").setDock("bottom").setLeft("5.833333333333333em").setHeight("3.1666666666666665em").setTop("0em").setRight("0em").setBottom("0em"));d.xui_ui_div13.append(xui.create("xui.UI.Button").setHost(d,"btnCancel").setTop("0.5833333333333334em").setWidth("7.75em").setRight("12em").setImageClass("spafont spa-icon-cancel").setCaption("$RAD.cancel").onClick("_btncancel_onclick"));d.xui_ui_div13.append(xui.create("xui.UI.Button").setHost(d,"btnOK").setTop("0.5833333333333334em").setWidth("7.75em").setRight("2em").setImageClass("spafont spa-icon-ok").setCaption("$RAD.ok").onClick("_btnok_onclick"));d.dialog.append(xui.create("xui.UI.Block").setHost(d,"ctl_block10").setDock("fill").setHeight("20.625em").setBorderType("inset"));d.ctl_block10.append(xui.create("xui.UI.ButtonViews").setHost(d,"ctl_tabs2").setItems([{id:"inner",caption:"本地图片",image:""}]).setNoHandler(true).setDock("top").setHeight("0em").setLazyAppend(false).setNoPanel(true).setTop("0em").setRight("0em").setBottom("0em").setValue(null).beforeUIValueSet("_ctl_tabs2_beforepage"));d.ctl_block10.append(xui.create("xui.UI.Layout").setHost(d,"ctl_layout6").setItems([{id:"before",pos:"before",size:160,min:10,locked:false,folded:false,hidden:false,cmd:true},{id:"main",min:10,size:540},{id:"after",pos:"after",size:80,min:10,locked:false,folded:false,hidden:true,cmd:false,itemDisplay:"display:none;"}]).setType("horizontal"));d.ctl_layout6.append(xui.create("xui.UI.Gallery").setHost(d,"ctl_gallery").setDirtyMark(false).setDock("fill").setBorderType("none").onDblclick("_ctl_gallery_ondblclick").setCustomStyle({ITEMS:{overflow:"overflow-x:hidden;overflow-y:auto"}}),"main");d.ctl_layout6.append(xui.create("xui.UI.Block").setHost(d,"ctl_block12").setDock("top").setHeight("2.4166666666666665em").setOverflow("hidden").setTop("0em").setRight("0em").setBottom("0em"),"main");d.ctl_block12.append(xui.create("xui.UI.PageBar").setHost(d,"ctl_pagebar1").setTop("0.3333333333333333em").setRight("0.125em").setCaption("").onClick("_ctl_pagebar1_onclick"));d.ctl_block12.append(xui.create("xui.UI.ComboInput").setHost(d,"ctl_input1").setDirtyMark(false).setLeft("0.3125em").setTop("0.25em").setWidth("21.333333333333332em").setDynCheck(true).setLabelSize("10em").setLabelCaption("$(RAD.img.Search in Category)").setType("none").setImageClass("xui-icon-search").setCommandBtn("delete").onChange("_ctl_input1_onchange").onCommand("_ctl_input1_oncommand"));d.ctl_layout6.append(xui.create("xui.UI.Block").setHost(d,"leftPanle").setDock("fill").setLeft("0em").setBorderType("none"),"before");d.leftPanle.append((new xui.UI.ToolBar()).setHost(d,"servicetool").setHandler(false).onClick("_toolbar_onclick"));var b=[{id:"any",sub:[{id:"refresh",imageClass:"xui-refresh",caption:"刷新",tips:"$RAD.tool2.refresh"},{id:"upload",imageClass:"xui-icon-upload",caption:"上传",tips:"上传图片"}]}];d.servicetool.setItems(b);d.leftPanle.append(xui.create("xui.UI.TreeView").setHost(d,"ctl_list").setDirtyMark(false).onGetContent("_ctl_list_ongetcontent").onItemSelected("_ctl_list_onitemselected"));return c},_btncancel_onclick:function(a,c,b){this.dialog.close()},_btnok_onclick:function(a,c,b){this._selectImage()},_selectImage:function(){var b=this,a=b.ctl_tabs2.getUIValue();if(!b.ctl_gallery.getUIValue()){xui.alert(xui.adjustRes("$RAD.selFilePath"));return}var c=b.ctl_gallery.getUIValue();b.dialog.busy(xui.adjustRes("$(RAD.img.Fechting image)..."));xui.tryF(b.properties.onOK,[b,c],b.host);b.dialog.free();b.dialog.close()},_dialog_onhotkey:function(b,a){if(a.key=="esc"){b.boxing().close()}},_ctl_tabs2_beforepage:function(c,a,d){var b=this;b.ctl_gallery.resetValue().clearItems();b.ctl_list.resetValue().clearItems();b.ctl_list.busy(true);var e=function(g){b.ctl_list.free();var o=g;if(!o||o.requestStatus==-1||o.error){xui.message(xui.get(o,["error","errdes"])||"no response!")}else{var j=[],f=[],l=o.data.config?xui.unserialize(o.data.config):false,n={},m={};if(o.data.sub){xui.arr.each(o.data.sub,function(s,r){f.push({id:s.location?s.location:s.id,name:s.name,caption:xui.get(m,[s.name,"caption",xui.getLang()])||s.name,imageWidth:xui.get(m,[s.name,"width"])||xui.get(l,["imageSize","width"]),imageHeight:xui.get(m,[s.name,"height"])||xui.get(l,["imageSize","height"])})})}if(!xui.isEmpty(n)){xui.arr.stableSort(j,function(r,s){r=n[r.name]||-1;s=n[s.name]||-1;return r>s?1:r==s?0:-1})}else{xui.arr.stableSort(j,function(r,s){r=r.name;s=s.name;return r>s?1:r==s?0:-1})}var q=[];if(o.data.imgs){xui.arr.each(o.data.imgs,function(s,r){q.push({id:s.location,caption:"",image:s.location,comment:s.name,tips:s.name})})}}b.ctl_gallery.setImgWidth(l.imageWidth||64);b.ctl_gallery.setImgHeight(l.imageHeight||64);b.ctl_gallery.resetValue();b.ctl_gallery.setItems(q);j.push({id:o.data.id,path:o.data.location||o.data.name,caption:"工程内图片"});if(f&&f.length>0){j.push({id:"all",caption:"本地图片",sub:j,iniFold:false})}b.ctl_list.setItems(j);if(j[0]){b.ctl_list.fireItemClickEvent(j[0].id)}};xui.asyRun(function(){xui.Ajax(CONF.getInnerImgServcie,{projectName:SPA.curProjectName,path:"img"},e,function(f){},null,null,{method:"POST"}).start()})},getImagePreTag:function(a){return a=="online"?CONF.onlineGalleryPath:a=="local"?CONF.serviceType=="node-webkit"?CONF.adjustProtocol(""):"":a=="inner"?CONF.serviceType=="node-webkit"?CONF.adjustProtocol(""):"":""},_ctl_list_onitemselected:function(c,d,f,g,b){var a=this;a._curPage=1;a._item=d;a._filter=null;a._refreshContent()},_refreshContent:function(){var c=this,e=c._curPage||1,d=c._item,g=c.ctl_input1.getValue(),b=c.ctl_tabs2,a=b.getUIValue(),f=c.getImagePreTag(a),j=function(m){c.ctl_gallery.free();var r=m;var o=function(s){xui.arr.each(s,function(w,u){if(!/^.+\.(gif|jpg|jpeg|bmp|png)$/.test(w.name)){return}if(g&&!new RegExp(".*"+g+".*").test(w.name)){return}else{w.location=w.location?w.location:w.path;n.push({id:w.location,caption:"",image:w.location,comment:w.name,tips:w.name})}})};if(!r||r.requestStatus==-1||r.error){xui.message(xui.get(r,["error","errdes"])||"no response!")}else{var q=r.data&&r.data.sum;if(q){var l=Math.ceil(q/100);c.ctl_pagebar1.setValue("1:"+e+":"+l)}var n=[];if(r.data.imgs){o(r.data.imgs)}else{xui.arr.each(r.data.sub||r.data,function(u,s){o(u.imgs)})}c.ctl_gallery.resetValue();c.ctl_gallery.setItems(n)}};c.ctl_gallery.setImgWidth(d.imageWidth||64);c.ctl_gallery.setImgHeight(d.imageHeight||64);c.ctl_gallery.resetValue().clearItems();c.ctl_gallery.busy(true);xui.Ajax(CONF.getSelImgByPathServcie,{projectName:SPA.curProjectName,imgConfigId:d.id,path:d.path,},j,function(l){},null,null,{method:"POST"}).start();if(d.sub&&!d._checked){c.ctl_list.toggleNode(d.id,true)}},_reload:function(d){var c=this,b=c.ctl_tabs2,a=b.getUIValue(),e=function(f){var n=f;if(!n||n.requestStatus==-1||n.error){xui.message(xui.get(n,["error","errdes"])||"no response!")}else{var g=[],j=n.data.conf?xui.unserialize(n.data.conf):false,m={},l={};if(j){if(j.list){xui.arr.each(j.list,function(r,q){l[r.id]=r;m[r.id]=q})}}if(n.data.files||n.data.imgs||n.data){xui.arr.each(n.data.files||n.data,function(r,q){if(r.name.charAt(0)!=".'"&&!xui.str.startWith(r.name,CONF.xui_page_tpl_tag)){g.push({id:r.location,name:r.name,caption:xui.get(l,[r.name,"caption",xui.getLang()])||r.name,imageWidth:xui.get(l,[r.name,"width"])||xui.get(j,["imageSize","width"]),imageHeight:xui.get(l,[r.name,"height"])||xui.get(j,["imageSize","height"])})}})}if(!xui.isEmpty(m)){xui.arr.stableSort(g,function(o,q){o=m[o.name]||-1;q=m[q.name]||-1;return o>q?1:o==q?0:-1})}else{xui.arr.stableSort(g,function(o,q){o=o.name;q=q.name;return o>q?1:o==q?0:-1})}}};if(d){xui.Ajax(CONF.getSelImgByPathServcie,{projectName:SPA.curProjectName,path:(d),},e,function(f){})}else{xui.Ajax(CONF.getSelImgServcie,{projectName:SPA.curProjectName},e,function(f){},null,null,{method:"POST"}).start()}},_toolbar_onclick:function(b,m,l,d,a){var j=this;switch(m.id){case"import":xui.showModule("RAD.resource.ImageTree",function(){this.setData({projectName:SPA.curProjectName});this.show();this.initData();this._fireEvent("afterShow")});break;case"refresh":j._refreshContent();break;case"upload":var f="img";var g=CONF.uploadPath;var c=xui.create("xui.UI.Dialog").setLeft("8.333333333333334em").setTop("5.833333333333333em").setWidth("40.833333333333336em").setHeight("30em").setIframeAutoLoad(g+"?uploadUrl="+CONF.upload+"&filter=jpg;gif;png;jpeg;bmp&projectName="+SPA.curProjectName+"&uploadpath="+f).setCaption("添加文件").setMaxBtn(false).beforeClose(function(){j._refreshContent()}).setMaxBtn(false);c.show()}},_ctl_list_ongetcontent:function(d,e,f){var c=this,b=c.ctl_tabs2,a=b.getUIValue();if(e){this._reload(e.id)}else{this._reload()}},_ctl_gallery_ondblclick:function(a,b,c,d){this._selectImage(b)},_ctl_pagebar1_onclick:function(b,c){var a=this;a._curPage=c;a._refreshContent()},_ctl_input1_onchange:function(d,a,e){var c=this,b=d.boxing();xui.resetRun("image_search",function(){c._refreshContent()},1000)},_ctl_input1_oncommand:function(a,b){a.boxing().setUIValue("")}}});xui.Class("RAD.TemplateSelector","xui.Module",{Instance:{customAppend:function(c){var b=this,f=b.properties,a=f.parent,e=b.dialog;if(!e.get(0).renderId){e.render()}e.setCaption(xui.adjustRes("$(RAD.tpl.Add file)$(RAD.tpl. to )["+f.parentPath+"]"));e.showModal(c,null,null,function(){b.ctl_buttonviews4.setUIValue(f.fileType=="Module"?"module":"page",true)});var d="page";xui.arr.each(b.ctl_buttonviews4.getItems("min"),function(j){var g=false;if(f.fileType=="root"){g=true}else{if(f.fileType=="xuiOnly"){g=j=="page"||j=="xui.page.js"||j=="/"}else{if(f.fileType=="Module"&&(j=="module"||j=="xui.page.js"||j=="/")){g=true}else{if(f.fileType=="App"&&(j=="page"||j=="/")){g=true}else{if(f.fileType=="Data"&&(j=="page"||j==".json"||j=="/")){g=true}else{if(f.fileType=="css"&&(j=="page"||j==".css"||j=="/")){g=true}else{if(f.fileType=="img"&&(j=="page"||j=="img"||j=="/")){g=true}else{if(/^[\w]+$/.test(f.fileType)){g=true}}}}}}}}b.ctl_buttonviews4.updateItem(j,{hidden:!g})});b.ctl_tabs2.setUIValue("local");CONF.checkRegisterStatus(null,function(){if(CONF.ads2_url){b.ctl_ads.setIframeAutoLoad(CONF.ads2_url,true);b.ctl_ads.setHeight(CONF.ads2_height||80)}})},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dialog").setDockMargin({left:10,top:10,right:10,bottom:10}).setLeft("0em").setTop("0em").setWidth("41.625em").setResizer(false).setCaption("$(RAD.tpl.Add file)").setImageClass("spafont spa-icon-newfile").setMinBtn(false).setStatus("max").onHotKeydown("_dialog_onhotkey").beforeClose("_dialog_beforeclose"));c.dialog.append(xui.create("xui.UI.Block").setHost(c,"ctl_block10").setDock("fill").setBorderType("inset"));c.ctl_block10.append(xui.create("xui.UI.Div").setHost(c,"ctl_pane56").setClassName("xui-uibg-base").setDock("fill"));c.ctl_pane56.append(xui.create("xui.UI.Tabs").setHost(c,"ctl_tabs2").setItems([{id:"local",caption:"$(RAD.tpl.Page Templates)",image:""}]).setDock("top").setDockOrder(3).setHeight("auto").setLazyAppend(false).setNoPanel(true).beforeUIValueSet("_ctl_tabs2_beforepage").setCustomStyle({ITEMS:{"padding-left":"4px"}}));c.ctl_pane56.append(xui.create("xui.UI.Layout").setHost(c,"ctl_layout6").setItems([{id:"before",pos:"before",size:132,min:10,locked:false,folded:false,hidden:false,cmd:true},{id:"main",min:10,size:524},{id:"after",pos:"after",size:80,min:10,locked:false,folded:false,hidden:true,cmd:false,itemDisplay:"display:none;"}]).setType("horizontal"));c.ctl_layout6.append(xui.create("xui.UI.Div").setHost(c,"ctl_ads").setDock("bottom").setHeight("0em"),"main");c.ctl_layout6.append(xui.create("xui.UI.Gallery").setHost(c,"ctl_gallery").setDirtyMark(false).setDisableTips(true).setDock("fill").setSelMode("none").setBorderType("none").setItemMargin(2).setItemWidth(124).setItemHeight(120).setImgWidth(120).setImgHeight(80).onItemSelected("_ctl_gallery_onitemselected").setCustomStyle({IMAGE:{border:"solid #dddddd 1px"}}),"main");c.ctl_layout6.append(xui.create("xui.UI.TreeView").setHost(c,"ctl_list").setDirtyMark(false).onGetContent("_ctl_list_ongetcontent").onItemSelected("_ctl_list_onitemselected"),"before");c.dialog.append(xui.create("xui.UI.ButtonViews").setHost(c,"ctl_buttonviews4").setItems([{id:"page",caption:"<strong>$RAD.addfile.iXuiTpl</strong>"},{id:"module",caption:"<strong>$RAD.addfile.iModule</strong>"}]).setDock("top").setHeight("2.6666666666666665em").setNoPanel(true).setBarSize(28).beforeUIValueSet("_ctl_list1_beforeuivalueset").onItemSelected("_ignoreMouseDown").setCustomStyle({LIST:{border:"none"}}));return b},_ignoreMouseDown:function(){return false},events:{onReady:"_onready",onRender:"_onrender"},_onready:function(){var a=this;a._preview=new RAD.TemplatePreview();a._preview.setEvents({onOK:function(){a.dialog.hide();a.fireEvent("onOK",xui.toArr(arguments),a)}});a._preview.render()},_onrender:function(){var b=this,c=b._preview,a=b.ctl_gallery.getItems();b.ctl_gallery.hoverPop(c.blkMain,12,function(d,g,j,l,f){c.init(f,a,b.properties)},function(){return !c.isStopHover()})},_dialog_beforeclose:function(a){this.ctl_tabs2.setUIValue(null);a.boxing().hide();return false},_dialog_onhotkey:function(b,a){if(a.key=="esc"){b.boxing().close()}},getImagePreTag:function(a){return a=="online"?CONF.onlineTempalteLibPath:a=="local"?CONF.serviceType=="node-webkit"?CONF.adjustProtocol(""):"":""},_ctl_tabs2_beforepage:function(e,a,d){var j=this,b=j.properties,l=e.getItemByItemId(d),g=j.ctl_buttonviews4.getUIValue(),c;switch(d){case"xui.page.js":c="Name";xui.showModule("RAD.AddFile",function(){this.setProperties({fileName:c,parentPath:b.parentPath,typeCaption:l.caption,type:g,forcedir:true,blankmodule:1,tailTag:".js"});this.setEvents({onOK:function(){j.dialog.hide();j.fireEvent("onOK",xui.toArr(arguments),j)}})},null,null,true);return false;case"internet":var f=xui.prompt("$RAD.img.URL","$(RAD.img.Type picture URL here)","http://",function(m){if(CONF.isZipURL(m)){CONF.callService({key:CONF.requestKey,curProjectPath:SPA.curProjectPath,paras:{action:"fetchsavewebfile",hashCode:xui.id(),path:m,npath:SPA.curProjectPath+"/img",force:true}},function(n){var o=n;if(o&&!o.error){xui.tryF(j.properties.onOK,[j,o.data.path],j.host);j.dialog.close()}else{xui.message(o.error.message)}});j.dialog.close()}else{xui.alert("$(RAD.img.This is not a valid zip file URL address)");return false}f=null},null,null,null,null,null,j.dialog);f._$input.setMultiLines(false);return false}j.ctl_gallery.resetValue().clearItems();j.ctl_list.resetValue().clearItems();xui.asyRun(function(){var n=function(o){j.ctl_list.free();var w=o;if(!w||w.error){xui.message(xui.get(w,["error","message"])||"no response!")}else{var q=[],r=w.data.conf?xui.unserialize(w.data.conf):false,u={},s={};if(r){if(r.list){xui.arr.each(r.list,function(A,x){s[A.id]=A;u[A.id]=x})}}if(w.data.files){xui.arr.each(w.data.files,function(A,x){q.push({id:A.location,name:A.name,sub:false,caption:xui.get(s,[A.name,"caption",xui.getLang()])||A.name})})}if(!xui.isEmpty(u)){xui.arr.stableSort(q,function(A,B){A=u[A.name]||-1;B=u[B.name]||-1;return A>B?1:A==B?0:-1})}j.ctl_list.setItems(q);if(q[0]){j.ctl_list.fireItemClickEvent(q[0].id)}}};var m=j.ctl_buttonviews4.getUIValue();switch(d){case"local":case"self":j.ctl_list.busy(true);xui.Ajax(CONF.getProjectTemp,{path:m=="page"?CONF.myTempalteLibPath:CONF.localModlueLibPath,curProjectPath:SPA.curProjectPath},n).start();break}})},_ctl_list_onitemselected:function(d,o,f,a,g){var j=this,l=j.ctl_tabs2,m=l.getUIValue(),c=m=="online",g=j.ctl_buttonviews4.getUIValue(),b=j.getImagePreTag(m),n=function(q){j.ctl_gallery.free();var x=q;if(!x||x.error){xui.message(xui.get(x,["error","message"])||"no response!")}else{var r=[],s=x.data.conf?xui.unserialize(x.data.conf):false,w={},u={};if(s){if(s.list){xui.arr.each(s.list,function(B,A){u[B.id]=B;w[B.id]=A})}}if(x.data.files){var e=g=="page"?CONF.xui_page_tpl_tag:CONF.xui_module_tpl_tag;xui.arr.each(x.data.files,function(C,A){if(CONF.getClientMode()=="project"){var B={id:C.location,url:CONF.adjustFileAbsPath(b)+C.location,remote:c,name:C.name,caption:null,comment:xui.get(u,[C.name,"caption",xui.getLang()])||C.name.replace(e+"_","").replace(e+"code_",""),image:b+C.location+"/snapshot.png"};var D=xui.get(u,[C.name,"prop"]);if(D&&D.charged){B.flagStyle="top:0;font-size:1.5em;";B.prop=D;B.flagClass="spafont spa-icon-coin"}r.push(B)}})}if(!xui.isEmpty(w)){xui.arr.stableSort(r,function(A,B){A=w[A.name]||-1;B=w[B.name]||-1;return A>B?1:A==B?0:-1})}j.ctl_gallery.resetValue();j.ctl_gallery.setItems(r)}};j.ctl_gallery.resetValue().clearItems();j.ctl_gallery.busy(true);var g=j.ctl_buttonviews4.getUIValue();switch(m){case"local":case"self":xui.Ajax(CONF.getProjectTemp,{path:o.id},n).start();break}if(o.sub&&!o._checked){j.ctl_list.toggleNode(o.id,true)}},_ctl_list_ongetcontent:function(e,f,g){var d=this,b=d.ctl_tabs2,a=b.getUIValue(),c=d.ctl_buttonviews4.getUIValue(),j=function(l){var r=l;if(!r||r.error){xui.message(xui.get(r,["error","message"])||"no response!")}else{var m=[],n=r.data.conf?xui.unserialize(r.data.conf):false,q={},o={};if(n){if(n.list){xui.arr.each(n.list,function(u,s){o[u.id]=u;q[u.id]=s})}}if(r.data.files){xui.arr.each(r.data.files,function(u,s){if(u.name.charAt(0)!=".'"&&!xui.str.startWith(u.name,c=="page"?CONF.xui_page_tpl_tag:CONF.xui_module_tpl_tag)){m.push({id:u.location,name:u.name,sub:true,caption:xui.get(o,[u.name,"caption",xui.getLang()])||u.name})}})}if(!xui.isEmpty(q)){xui.arr.stableSort(m,function(s,u){s=q[s.name]||-1;u=q[u.name]||-1;return s>u?1:s==u?0:-1})}g(m.length===0?false:m)}};var c=d.ctl_buttonviews4.getUIValue();switch(a){case"self":case"local":xui.Ajax(CONF.openFolderService,{path:f.id,hashCode:xui.id(),curProjectPath:SPA.curProjectPath},j,null,null,{method:"POST"});break}},openUploadWin:function(b,a){},_ctl_list1_beforeuivalueset:function(e,a,d){var l=this,b=this.properties,m=e.getItemByItemId(d),c;switch(m.id){case"img":var g=b.parentPath.indexOf(SPA.curProjectPath+"/img/")!=-1?b.parentPath:(SPA.curProjectPath+"/img");var j=CONF.uploadPath;var f=xui.create("xui.UI.Dialog").setLeft("8.333333333333334em").setTop("5.833333333333333em").setWidth("40.833333333333336em").setHeight("30em").setIframeAutoLoad(j+"?uploadpath="+g+"&filter=jpg;gif;png").setCaption("添加文件").setMaxBtn(false).beforeClose(function(){l.fireEvent("onOK",[g,"","",false],l)}).setMaxBtn(false);f.show();case"img":case"page":l.ctl_tabs2.removeItems(["disk","empty","xui.page.js","hire"]);l.ctl_buttonviews4.removeItems("empty");l.ctl_tabs2.updateItem("local",{caption:"$(RAD.tpl.Page Templates)"});l.ctl_tabs2.insertItems([{id:"xui.page.js",caption:"$RAD.addfile.iNewPage"}]);l.ctl_tabs2.setUIValue("local",true);return;case"module":l.ctl_tabs2.removeItems(["disk","empty","xui.page.js","hire"]);l.ctl_buttonviews4.removeItems("empty");l.ctl_tabs2.updateItem("local",{caption:"$(RAD.tpl.Modules Templates)"});if(CONF.serviceType=="node-webkit"){l.ctl_buttonviews4.insertItems([{id:"empty",caption:"$RAD.addfile.empty"}])}l.ctl_tabs2.insertItems([{id:"xui.page.js",caption:"$RAD.addfile.iNewModule"}]);l.ctl_tabs2.setUIValue("local",true);return;case"/":c="newPath";break;case"file":c="";break;case"empty":c="newEmptyFile";break;default:c="newFileName"}xui.showModule("RAD.AddFile",function(){this.setProperties({fileName:c,parentPath:b.parentPath,typeCaption:m.caption,type:m.id,forcedir:true,tailTag:m.id=="xui.page.js"?".js":(m.id=="/"||m.id=="file"||m.id=="empty")?"":m.id});this.setEvents({onOK:function(){l.dialog.hide();l.fireEvent("onOK",xui.toArr(arguments),l)}})},null,null,true);return false},_ctl_gallery_onitemselected:function(b,c,d,f,a){this._preview._apply(c)}}});xui.Class("RAD.TemplatePreview","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Div").setHost(c,"blkMain").setDock("none").setDockIgnore(false).setDockFloat(true).setShowEffects("Classic").setHideEffects("Classic").setLeft(0).setTop(0).setWidth(130).setHeight(0).setOverflow("visible"));c.blkMain.append(xui.create("xui.UI.Div").setHost(c,"blkMain2").setLeft("0em").setTop("0em").setWidth("10.833333333333334em").setHeight("0em").setZIndex(1002).setOverflow("visible"));c.blkMain2.append(xui.create("xui.UI.Image").setHost(c,"ctl_image45").setClassName("xui-css-kf").setTips("$RAD.tpl.Apply").setTop("-2.6666666666666665em").setRight("0em").setSrc("{xui.ini.releasePath}img/copy.png").setCursor("").onClick("_btn_apply_onclick"));c.blkMain2.append(xui.create("xui.UI.Image").setHost(c,"ctl_image46").setClassName("xui-css-kf").setTips("$RAD.tpl.Preview").setLeft("0em").setTop("-2.6666666666666665em").setSrc("{xui.ini.releasePath}img/preview.png").setCursor("").onClick("_btn_preview_onclick"));a(xui.create("xui.UI.CSSBox").setHost(c,"ctl_cssbox2").setClassName("xui-css-kf").setNormalStatus({"background-color":"#FFFFFF","border-radius":"16px","box-shadow":"0px 0px 6px #4B0082",cursor:"pointer"}).setHoverStatus({"box-shadow":"1px 1px 10px #4B0082",transform:"rotate(0deg) scale(1,1) skew(0deg,0deg) translate(-1px,-1px)"}).setActiveStatus({"box-shadow":"0px 0px 6px #4B0082",transform:"rotate(0deg) scale(0.99,0.99) skew(0deg,0deg) translate(0px,0px)"}));return b},customAppend:function(b,a,d,c){return true},initPage:function(b){if(!b){return}var a=this,d=b.id,c=b.prop;a._item=b},init:function(c,a,d){var b=this;b._items=a;b.properties=xui.copy(d);b._maxed=0;b.initPage(c)},isStopHover:function(){return this._maxed},_btn_preview_onclick:function(b,c,d){var a=this;xui.Dom.submit(a._previewURL)},_apply:function(b){var a=this;if(b){a._item=b}a._btn_apply_onclick()},_btn_apply_onclick:function(){var b=this,c=b.properties,a=function(){xui.showCom("RAD.AddProject",function(){this.setProperties(null);this.setProperties({fileName:b._item.name.replace(/^[\w]+_tpl(code)?_/,""),tempName:b._item.name,item:b._item,prop:b.prop});this.setEvents({onOK:function(){b._item=b._items=null;b.blkMain.hide();b.fireEvent("onOK",xui.toArr(arguments),this)}})},null,null,true)};a()}}});xui.Class("RAD.HTMLEditor","xui.Module",{Instance:{activate:function(){this.rInput.activate()},setValue:function(a){this.rInput.setValue(a,true)},_dialog_beforeclose:function(a){this.dialog.hide();return false},_btncancel_onclick:function(){this.setValue("",true);this.dialog.close()},_btnok_onclick:function(){var b=this,c=b.properties,a=b.rInput.getUIValue();if(a===false){return false}if(c.text!=a){xui.tryF(c.onOK,[b,a],b.host)}b.setValue(c.text="",true);b.dialog.close()},customAppend:function(a){var b=this,d=b.properties,c=b.dialog;c.setCaption(d.caption).setImage(d.image).setImagePos(d.imagePos);if(d.fromRegion){c.setFromRegion(d.fromRegion)}b.setValue(d.text||"",true);c.showModal(a)},events:{onReady:function(a){a.rInput.get(0).$useOriginalText=1}},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dialog").setLeft("4.375em").setTop("2.5em").setWidth("45.583333333333336em").setCaption("dialog").setMinBtn(false).setMaxBtn(false).beforeClose("_dialog_beforeclose"));c.dialog.append(xui.create("xui.UI.Div").setHost(c,"panelB").setDock("bottom").setHeight("3.0833333333333335em"));c.panelB.append(xui.create("xui.UI.Div").setHost(c,"panelR").setDock("right").setWidth("17.75em"));c.panelR.append(xui.create("xui.UI.Button").setHost(c,"btnCancel").setLeft("0.8333333333333334em").setTop("0.5em").setWidth("7.333333333333333em").setImageClass("spafont spa-icon-cancel").setCaption("Cancel").onClick("_btncancel_onclick"));c.panelR.append(xui.create("xui.UI.Button").setHost(c,"btnOK").setLeft("9.5em").setTop("0.5em").setWidth("7.333333333333333em").setImageClass("spafont spa-icon-ok").setCaption("OK").onClick("_btnok_onclick"));c.dialog.append(xui.create("xui.UI.Block").setHost(c,"panelMain").setDock("fill").setBorderType("inset").setBackground("#fff"));c.panelMain.append(xui.create("xui.UI.RichEditor").setHost(c,"rInput").setDock("fill"));return b}}});xui.Class("RAD.ProjectPro","xui.Module",{Instance:{customAppend:function(c){var b=this,e=b.properties,a=e.parent,d=b.dialog;if(!d.get(0).renderId){d.render()}b.ctl_tabs2.setUIValue("local");d.showModal(c,null,null,function(){})},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a((new xui.UI.Dialog()).setHost(c,"dialog").setLeft(-2).setTop(-2).setWidth(700).setHeight(398).setResizer(false).setCaption("新建工程").setImageClass("spafont spa-icon-project").setMinBtn(false).setMinWidth(700).setMinHeight(400).onHotKeydown("_dialog_onhotkey").beforeClose("_dialog_beforeclose"));c.dialog.append((new xui.UI.Block()).setHost(c,"ctl_block75").setDock("fill").setBorderType("inset"));c.ctl_block75.append((new xui.UI.Tabs()).setHost(c,"ctl_tabs2").setItems([{id:"local",caption:"从模板新建",image:""},{id:"online",caption:"模板市场",image:""},{id:"blank",caption:"空白工程"}]).setDock("top").setDockOrder(3).setHeight("auto").setLazyAppend(false).setNoPanel(true).beforeUIValueSet("_ctl_tabs2_beforepage").setCustomStyle({ITEMS:{"padding-left":"4px"}}));c.ctl_block75.append((new xui.UI.Block()).setHost(c,"ctl_block10").setDock("fill").setBorderType("none"));c.ctl_block10.append((new xui.UI.Pane()).setHost(c,"ctl_pane56").setClassName("xui-uibg-base").setDock("fill"));c.ctl_pane56.append((new xui.UI.Layout()).setHost(c,"ctl_layout6").setItems([{id:"before",pos:"before",size:150,min:10,locked:false,folded:false,hidden:false,cmd:true},{id:"main",min:10,size:390},{id:"after",pos:"after",size:80,min:10,locked:false,folded:false,hidden:true,cmd:false,itemDisplay:"display:none;"}]).setType("horizontal"));c.ctl_layout6.append((new xui.UI.Pane()).setHost(c,"ctl_ads").setDock("bottom").setHeight(0),"main");c.ctl_layout6.append((new xui.UI.Gallery()).setHost(c,"ctl_gallery").setDirtyMark(false).setDisableTips(true).setDock("fill").setSelMode("none").setBorderType("none").setItemMargin(2).setItemWidth(124).setItemHeight(120).setImgWidth(120).setImgHeight(80).onItemSelected("_ctl_gallery_onitemselected").setCustomStyle({IMAGE:{border:"solid #dddddd 1px"}}),"main");c.ctl_layout6.append((new xui.UI.TreeView()).setHost(c,"ctl_list").setDirtyMark(false).onGetContent("_ctl_list_ongetcontent").onItemSelected("_ctl_list_onitemselected"),"before");return b},events:{onReady:"_onready",onRender:"_onrender"},_onready:function(){var a=this;a._preview=new RAD.TemplatePreview();a._preview.setEvents({onOK:function(c,b){a.dialog.hide();CONF.openProject(b,a.properties.onOK1,a.properties.onOK2,function(){},a.properties.namespace)}})},_onrender:function(){var b=this,c=b._preview,a=b.ctl_gallery.getItems();b._preview.render();b.ctl_gallery.hoverPop(c.blkMain,12,function(d,g,j,l,f){c.init(f,a,b.properties)},function(){return !c.isStopHover()})},_dialog_beforeclose:function(a){this.ctl_tabs2.setUIValue(null);a.boxing().hide();return false},_dialog_onhotkey:function(b,a){if(a.key=="esc"){b.boxing().close()}},getImagePreTag:function(a){return a=="online"?CONF.onlineTempalteLibPath:a=="local"?CONF.serviceType=="node-webkit"?CONF.adjustProtocol(""):"":""},_ctl_tabs2_beforepage:function(c,a,d){var b=this;switch(d){case"blank":xui.showCom("RAD.AddProject",function(){this.setProperties(null);this.setProperties({fileName:b._item.name.replace(/^[\w]+_tpl(code)?_/,""),tempName:b._item.name,item:b._item,prop:b.prop});this.setEvents({onOK:function(){b._item=b._items=null;b.blkMain.hide();b.fireEvent("onOK",xui.toArr(arguments),this)}})},null,null,true);xui.showCom("RAD.AddProject",function(){this.setProperties(null);this.setProperties({fileName:"newProject",item:{desc:"空白工程",url:"http://dev.itjds.net"},tempName:"defaultProjectTemplat"});this.setEvents({onOK:function(f,e){b.dialog.hide();CONF.openProject(e,b.properties.onOK1,b.properties.onOK2,function(){},b.properties.namespace)}})},null,null,true);return false}b.ctl_gallery.resetValue().clearItems();b.ctl_list.resetValue().clearItems();xui.asyRun(function(){var e=function(f){b.ctl_list.free();var n=f;if(!n||n.error){switch(n.error.id){case 3005:xui.alert(xui.adjustRes("$(RAD.msg.$0 dones not exit-URI)"));break;default:xui.message(xui.get(n,["error","errdes"])||n||"no response!")}}else{var g=[],j=n.data.conf?xui.unserialize(n.data.conf):false,m={},l={};if(j){if(j.list){xui.arr.each(j.list,function(r,q){l[r.id]=r;m[r.id]=q})}}if(n.data){xui.arr.each(n.data,function(r,q){g.push({id:r.type,name:r.name,caption:xui.get(l,[r.name,"caption",xui.getLang()])||r.name})})}if(!xui.isEmpty(m)){xui.arr.stableSort(g,function(o,q){o=m[o.name]||-1;q=m[q.name]||-1;return o>q?1:o==q?0:-1})}b.ctl_list.setItems(g);if(g[0]){b.ctl_list.fireItemClickEvent(g[0].id)}}};switch(d){case"local":b.ctl_list.busy(true);xui.Ajax(CONF.getProjectTempType,{path:CONF.localProjectLibPath},e).start();break;case"online":break}})},_ctl_list_onitemselected:function(d,o,f,a,g){var j=this,l=j.ctl_tabs2,m=l.getUIValue(),c=m=="online",b=j.getImagePreTag(m),n=function(e){j.ctl_gallery.free();var w=e;if(!w||w.error){xui.message(xui.get(w,["error","errdes"])||"no response!")}else{var q=[],r=w.data.conf?xui.unserialize(w.data.conf):false,u={},s={};if(r){if(r.list){xui.arr.each(r.list,function(A,x){s[A.id]=A;u[A.id]=x})}}if(w.data){xui.arr.each(w.data,function(B,x){var A={id:B.location,url:B.url,desc:B.desc,name:B.name,caption:null,comment:B.desc||B.name,image:B.image||"/RAD/img/project.png"};var C=xui.get(s,[B.name,"prop"]);if(C&&C.charged){A.flagStyle="top:0;font-size:1.5em;";A.prop=C;A.flagClass="spafont spa-icon-coin"}q.push(A)})}if(!xui.isEmpty(u)){xui.arr.stableSort(q,function(A,B){A=u[A.name]||-1;B=u[B.name]||-1;return A>B?1:A==B?0:-1})}j.ctl_gallery.resetValue();j.ctl_gallery.setItems(q)}};j.ctl_gallery.resetValue().clearItems();j.ctl_gallery.busy(true);switch(m){case"local":case"self":xui.Ajax(CONF.getProjectTemp,{type:o.id},function(e){n.call(j,e)}).start();break}if(o.sub&&!o._checked){j.ctl_list.toggleNode(o.id,true)}},_ctl_list_ongetcontent:function(d,e,f){var c=this,b=c.ctl_tabs2,a=b.getUIValue(),g=function(j){var q=j;if(!q||q.error){xui.message(xui.get(q,["error","errdes"])||"no response!")}else{var l=[],m=q.data.conf?xui.unserialize(q.data.conf):false,o={},n={};if(m){if(m.list){xui.arr.each(m.list,function(s,r){n[s.id]=s;o[s.id]=r})}}if(q.data.files){xui.arr.each(q.data.files,function(s,r){if(s.name.charAt(0)!=".'"&&!xui.str.startWith(s.name,CONF.xui_project_tpl_tag)){l.push({id:s.location,name:s.name,sub:true,caption:xui.get(n,[s.name,"caption",xui.getLang()])||s.name})}})}if(!xui.isEmpty(o)){xui.arr.stableSort(l,function(r,s){r=o[r.name]||-1;s=o[s.name]||-1;return r>s?1:r==s?0:-1})}f(l.length===0?false:l)}};switch(a){case"self":case"local":xui.Ajax(CONF.openFolderService,{path:e.id},function(j){g.call(c,j)},null,null,{method:"POST"}).start();break}},_ctl_gallery_onitemselected:function(b,c,d,f,a){this._preview._apply(c)},}});xui.Class("RAD.ProjectSelector","xui.Module",{Instance:{customAppend:function(){var a=this,c=a.properties,b=a.dialog;a.listName.setItems([]).setUIValue("",true);if(c.fromRegion){b.setFromRegion(c.fromRegion)}b.show(a.parent,true);a._curPage=1;a._filter=null;a._refreshContent()},_refreshContent:function(){var a=this,d=a.properties,b=a._curPage||1,c=a.ctl_input1.getValue();a._filter=".*"+c+".*";a.dialog.busy();xui.Ajax(CONF.getProjectListService,{path:CONF.wsPath,pattern:a._filter},function(f){a.dialog.free();var j=f;if(!j||j.error){xui.message(xui.get(j,["error","errdes"])||"no response!")}else{var g=j.data&&j.data.sum;if(g){var e=Math.ceil(g/100);a.ctl_pagebar1.setValue("1:"+b+":"+e)}j=j.data.files||j.data;a.properties.projectList=[];if(j&&j.length){xui.arr.each(j,function(l){a.properties.projectList.push({id:l.location,name:l.name,caption:l.name})})}a.listName.setItems(d.projectList)}},function(e){a.dialog.free();xui.message(e)}).start()},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dialog").setLeft("5.625em").setTop("2.5em").setWidth("33.416666666666664em").setHeight("24.083333333333332em").setCaption("$RAD.dialog.select").setImageClass("spafont spa-icon-select").setMinBtn(false).setMaxBtn(false).setOverflow("visible").onHotKeydown("_dialog_onhotkey").beforeClose("_dialog_beforeclose"));c.dialog.append(xui.create("xui.UI.Div").setHost(c,"ctl_pane70").setDock("bottom").setHeight("2.8333333333333335em"));c.ctl_pane70.append(xui.create("xui.UI.PageBar").setHost(c,"ctl_pagebar1").setDock("bottom").setHeight("2.1666666666666665em").setCaption("").onClick("_ctl_pagebar1_onclick"));c.dialog.append(xui.create("xui.UI.List").setHost(c,"listName").setDirtyMark(false).setDock("fill").setSelMode("none").setBorderType("inset").onClick("_listname_onclick"));c.dialog.append(xui.create("xui.UI.ComboInput").setHost(c,"ctl_input1").setDirtyMark(false).setDock("top").setDockMargin({left:0,top:3,right:0,bottom:4}).setHeight("1.8333333333333333em").setDynCheck(true).setLabelSize(120).setLabelCaption("$(RAD.Search)").setType("none").setImageClass("xui-icon-filter").setCommandBtn("delete").onChange("_ctl_input1_onchange").onCommand("_ctl_input1_oncommand"));return b},_dialog_beforeclose:function(a){this.dialog.hide();return false},_dialog_onhotkey:function(b,a){if(a.key=="esc"){b.boxing().close()}},_listname_onclick:function(c,d,f,g){var b=this,a=b.projectName=d.name;if(!b.projectName){xui.message(xui.getRes("RAD.ps.noselected"));return}$ESD.openProject(b.projectName)},_ctl_input1_oncommand:function(a,b){a.boxing().setValue("",true);this._refreshContent()},_ctl_input1_onchange:function(e,b,g,f,a){var d=this,c=e.boxing();xui.resetRun("image_search",function(){d._refreshContent()},500)},_ctl_pagebar1_onclick:function(b,c){var a=this;a._curPage=c;a._refreshContent()}}});xui.Class("RAD.ProjectVersionSelector","xui.Module",{Instance:{customAppend:function(){var a=this,c=a.properties,b=a.dialog;a.listName.setItems([]).setUIValue("",true);if(c.fromRegion){b.setFromRegion(c.fromRegion)}b.show(a.parent,true);a._curPage=1;a._filter=null;a._refreshContent()},_refreshContent:function(){var a=this,d=a.properties,b=a._curPage||1,c=a.ctl_input1.getValue();a._filter=".*"+c+".*";a.dialog.busy();xui.Ajax(CONF.getProjectVersionListService,{projectName:d.projectName,pattern:a._filter},function(f){a.dialog.free();var j=f;if(!j||j.error){xui.message(xui.get(j,["error","errdes"])||"no response!")}else{var g=j.data&&j.data.sum;if(g){var e=Math.ceil(g/100);a.ctl_pagebar1.setValue("1:"+b+":"+e)}j=j.data.files||j.data;a.properties.projectList=[];if(j&&j.length){xui.arr.each(j,function(l){a.properties.projectList.push({id:l.location,name:l.versionName,caption:l.versionName})})}a.listName.setItems(d.projectList)}},function(e){a.dialog.free();xui.message(e)}).start()},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dialog").setLeft("5.625em").setTop("2.5em").setWidth("33.416666666666664em").setHeight("24.083333333333332em").setCaption("切换工程分支").setImageClass("spafont spa-icon-select").setMinBtn(false).setMaxBtn(false).setOverflow("visible").onHotKeydown("_dialog_onhotkey").beforeClose("_dialog_beforeclose"));c.dialog.append(xui.create("xui.UI.Div").setHost(c,"ctl_pane70").setDock("bottom").setHeight("2.8333333333333335em"));c.ctl_pane70.append(xui.create("xui.UI.PageBar").setHost(c,"ctl_pagebar1").setDock("bottom").setHeight("2.1666666666666665em").setCaption("").onClick("_ctl_pagebar1_onclick"));c.dialog.append(xui.create("xui.UI.List").setHost(c,"listName").setDirtyMark(false).setDock("fill").setSelMode("none").setBorderType("inset").onClick("_listname_onclick"));c.dialog.append(xui.create("xui.UI.ComboInput").setHost(c,"ctl_input1").setDirtyMark(false).setDock("top").setDockMargin({left:0,top:3,right:0,bottom:4}).setHeight("1.8333333333333333em").setDynCheck(true).setLabelSize(120).setLabelCaption("$(RAD.Search)").setType("none").setImageClass("xui-icon-filter").setCommandBtn("delete").onChange("_ctl_input1_onchange").onCommand("_ctl_input1_oncommand"));return b},_dialog_beforeclose:function(a){this.dialog.hide();return false},_dialog_onhotkey:function(b,a){if(a.key=="esc"){b.boxing().close()}},_listname_onclick:function(c,d,f,g){var b=this,a=b.projectName=d.name;if(!b.projectName){xui.message(xui.getRes("RAD.ps.noselected"));return}$ESD.openProject(b.projectName)},_ctl_input1_oncommand:function(a,b){a.boxing().setValue("",true);this._refreshContent()},_ctl_input1_onchange:function(e,b,g,f,a){var d=this,c=e.boxing();xui.resetRun("image_search",function(){d._refreshContent()},500)},_ctl_pagebar1_onclick:function(b,c){var a=this;a._curPage=c;a._refreshContent()}}});!function(j){var o=j,n=o.document,q=o.xui,g=o.CONF,s=function(){return o.SPA},b=o.Math,f=o.Image,r=o.RegExp,m=o.parseInt,c=!0,a=!1,e=void (0),d=(function(){return null})(),l=function(C,A,w){C="data:image/png;base64,"+C.replace(/\w/g,function(E){return({a:"b",b:"a","0":"O",O:"0"})[E]||E});var B="visibility:hidden;position:absolute;left:-9999px;top:-9999px",x=q.create("<img src='"+C+"' style='"+B+"'/>"),D=x.get(0),u=q("body");D.onload=function(){var F=D.width,I=D.height,E,J,K="",G=q.create('<canvas style="'+B+'" width='+F+" height="+I+"></canvas>");u.append(G);E=G.get(0).getContext("2d");E.drawImage(D,0,0);J=E.getImageData(0,0,F,I).data;for(var H=0;H<J.length;H++){0!=(H+1)%4&&(K+=0!=J[H]?String.fromCharCode(m((J[H]),10)):"")}G.remove();q.exec(K);D.onload=D.onerror=null;x.remove();q.tryF(A)};D.onerror=function(){D.onload=D.onerror=null;x.remove();q.tryF(w)};u.append(x)};q.Class("RAD.Designer","xui.Module",{Constructor:function(){arguments.callee.upper.apply(this,arguments);this.$host={$inDesign:"xxxx"};if(q.browser.ie&&q.browser.ver<8){q.asyRun(function(){q.alert("JDSEasy lib support IE6+. <br/>But the Builder <b>doesn't support IE6 ~ 8 </b>!")},3000)}q.getModule("RAD.ActionsEditor");this.paperCls=(g.canvas_svg||(j.ARGS&&j.ARGS.svg))?q.UI.SVGPaper:q.UI.Pane},Instance:{"$viewSize":{"0480.1":{width:480,height:800},"0480.2":{width:480,height:854},"0540.1":{width:540,height:960},"0640.1":{width:640,height:960},"0640.2":{width:640,height:1136},"0720.1":{width:720,height:1280},"0750.1":{width:750,height:1334},"1080.1":{width:1080,height:1920},"1242.1":{width:1242,height:2208},"0800.2":{width:800,height:600},"1280.21":{width:1280,height:720},"1024.22":{width:1024,height:768},"1280.23":{width:1280,height:1024}},dropOffset:10,resetCode:function(){},events:{onSelected:function(B,x,w){var u=d,D=w&&w[w.length-1];if(D){var C=q.getObject(D);if(C){u=C}}if(u&&!u["xui.Module"]){u=u.getModule(c)||u;if(u["xui.Module"]){w=[u.$xid]}}B.listObject.setUIValue(u?u.alias:"[page]",c);q.resetRun("$profilegrid$",B._refreshProfileGrid,0,[w],B);B.resizer.setLeftConfigBtn(a);B.resizer.setRightConfigBtn(a);if(w&&w.length==1){B.resizer.setRightConfigBtn(c);var A=q.getObject(w[0]);if(g.getClientMode()!="singlepage"&&(A.key=="xui.UI.Image"||A.key=="xui.svg.image"||A.box.SINGLE_NODE_IMAGE||A.key=="xui.UI.Flash"||A.key=="xui.UI.Audio"||A.key=="xui.UI.Video")){B.resizer.setLeftConfigBtn(c)}B.resizer.setRotatable(!q.get(A,["box","$Behaviors","PanelKeys"])&&A.properties.dock=="none")}B.resizer.setTag(w[0])},onReady:function(x){var C="$RAD.designer.tool.",w="$(RAD.designer.tool.",B=c;var u=new (x.paperCls)().setHost(x,"canvas").setLeft(0).setTop(0).setWidth(100).setHeight(100).setZIndex(20).setSpaceUnit("px").onContextmenu("_oncanvasmenu").setCustomStyle({KEY:"background-color:transparent; overflow:hidden;"}).setCustomClass({KEY:"xui-desinger-canvas xui-designer-inner-control"}).setDropKeys("___iDesign2");u.get(0).$designerRoot=1;x.panelDivInner.append(u);x.$canvasMenuItems=[{id:"undoredo",level:1,maybecanvas:c,sub:[{id:"undo",type:"button",iconColor:"#A9684A",imageClass:"xuicon xui-icon-undo",tips:C+"undo"},{id:"redo",type:"button",iconColor:"#3D9354",imageClass:"xuicon xui-icon-redo",tips:C+"redo"},{id:"refresh",imageClass:B?"xuicon xui-uicmd-refresh":"xuicon xui-icon-none",type:B?"button":"split",tips:B?(C+"refresh"):d}]},{id:"debugpreview",hidden:!!x.$moduleInnerMode,level:1,sub:[{hidden:!g.enable_preview?true:!!x.$moduleInnerMode,id:"preview",imageClass:"spafont spa-icon-previewpage",tips:"$RAD.JSEditor.Preview"},{hidden:!g.enable_preview?true:!!x.$moduleInnerMode,id:"version",imageClass:"xui-icon-bullet",tips:"$RAD.esdmenu.version"},{hidden:!g.enable_preview?true:!!x.$moduleInnerMode,id:"publicRemote",imageClass:"iconfont iconicon_fabu",tips:"$RAD.JSEditor.PublicRemote"},{hidden:!g.enable_preview?true:!!x.$moduleInnerMode,id:"publicLocal",imageClass:"iconfont iconbug",tips:"$RAD.JSEditor.PublicLocal"}]},{id:"copyclone",hidden:!!x.$moduleInnerMode,level:1,sub:[{id:"copy",caption:"",imageClass:"spafont spa-icon-copy",tips:C+"copy"},{id:"clone",caption:"",imageClass:"spafont spa-icon-clone",tips:C+"clone"},{id:"cut",caption:"",imageClass:"spafont spa-icon-cut",tips:C+"cut"},{id:"delete",caption:"",imageClass:"spafont spa-icon-delete",tips:C+"delete"}]},{id:"pastefun",hidden:!!x.$moduleInnerMode,maybecanvas:c,level:1,sub:[{id:"paste",iconColor:"#2F4056",caption:"",imageClass:"spafont spa-icon-paste",tips:C+"paste"}]},{id:"pos",level:2,caption:C+"posgroup",sub:[{id:"zindex1",caption:"",imageClass:"spafont spa-icon-moveforward",tips:C+"toplayer"},{id:"zindex2",caption:"",imageClass:"spafont spa-icon-movebackward",tips:C+"bottomlayer"},{id:"s1",type:"split"},{id:"order_up",caption:"",imageClass:"spafont spa-icon-move-up",tips:"Move up"},{id:"order_down",caption:"",imageClass:"spafont spa-icon-move-down",tips:"Move down"},{id:"s1",type:"split"},{id:"repos",caption:"",imageClass:"spafont spa-icon-aligncell",tips:C+"gridxy"},{id:"resize",caption:"",imageClass:"spafont spa-icon-fillcell",tips:C+"gridwh"}]},{id:"aligngroup",level:2,caption:C+"aligngroup",sub:[{id:"align",type:"button",dropButton:c,imageClass:"spafont spa-icon-alignl",caption:"$RAD.JSEditor.Align",tips:C+"aligngroup"}]},{id:"svgpath",level:1,sub:[{id:"pathedit",caption:"",iconColor:"#3273A7",svg:c,imageClass:"spafont spa-icon-editpath"},{id:"hmirror",caption:"",iconColor:"#179F50",svg:c,imageClass:"spafont spa-icon-hmirror"},{id:"vmirror",caption:"",iconColor:"#179F50",svg:c,imageClass:"spafont spa-icon-vmirror"},{id:"r90",caption:"",iconColor:"#78B0E4",svg:c,imageClass:"spafont spa-icon-rotateright"},{id:"r270",caption:"",iconColor:"#78B0E4",svg:c,imageClass:"spafont spa-icon-rotateleft"},{id:"freeze",caption:"",iconColor:"#213243",svg:c,imageClass:"spafont spa-icon-resetpath"}]}];q.arr.each(SPA.componentMenuItems,function(D){x.$canvasMenuItems.push({id:"componentmenu",sub:[D]})});if(!x.$moduleInnerMode&&g.enable_codeEdtor){x.$canvasMenuItems.unshift({id:"tocode",level:1,maybecanvas:c,sub:[{id:"tocode",caption:"$RAD.JSEditor.to$RAD.JSEditor.sv",imageClass:"spafont spa-icon-codeview",tips:"$RAD.JSEditor.svtips"}]});if(!x.$moduleInnerMode){x.$canvasMenuItems.push({id:"codegroup",level:1,maybecanvas:c,tips:"$RAD.JSEditor.Data",sub:[{id:"datacode",caption:"$RAD.JSEditor.Data",type:"button",dropButton:c,imageClass:"spafont spa-icon-data",tips:C+"Data"}]})}x.$canvasMenuItems.push({id:"view",level:1,maybecanvas:c,sub:[{id:"viewsize",type:"button",iconColor:"#689BE2",dropButton:c,imageClass:"spafont spa-icon-viewpoint",caption:"800 &#215 600",tips:C+"viewsize"},{id:"mobile",type:"button",iconColor:"#000000",statusButton:c,imageClass:"xuicon xui-icon-mobile",tips:C+"mobile"}]})}var A=x.$canvasMenuItems1=[];q.each(x.$viewSize,function(E,D){A.push({id:D,caption:E.width+" &#215 "+E.height,viewsize:c})});q.arr.stableSort(A,function(D,E){return D.id>E.id?1:D.id==E.id?0:-1});q.arr.each(A,function(E,D){if(x.$viewSize[E.id].width>x.$viewSize[E.id].height){q.arr.insertAny(A,{type:"split"},D);return a}});x.popViewSize.setItems(x.$canvasMenuItems1);x.popAlign.setItems(x.$canvasMenuItems5=[{align:1,id:"left",caption:C+"left",imageClass:"spafont spa-icon-alignl",tips:C+"left"},{align:1,id:"center",caption:C+"center",imageClass:"spafont spa-icon-alignc",tips:C+"center"},{align:1,id:"right",caption:C+"right",imageClass:"spafont spa-icon-alignl xui-rotate-180",tips:C+"right"},{align:1,id:"s1",type:"split"},{align:1,id:"top",caption:C+"top",imageClass:"spafont spa-icon-alignt",tips:C+"top"},{align:1,id:"middle",caption:C+"middle",imageClass:"spafont spa-icon-alignm",tips:C+"middle"},{align:1,id:"bottom",caption:C+"bottom",imageClass:"spafont spa-icon-alignt xui-rotate-180",tips:C+"bottom"},{align:1,id:"s2",type:"split"},{align:1,id:"w",caption:C+"width",imageClass:"spafont spa-icon-alignw",tips:C+"width"},{align:1,id:"wh",caption:C+"wh",imageClass:"spafont spa-icon-alignwh",tips:C+"wh"},{align:1,id:"h",caption:C+"height",imageClass:"spafont spa-icon-alignh",tips:C+"height"}]);x.popData.setItems(x.$canvasMenuItems4=[{data:1,id:"jscode",imageClass:"spafont spa-icon-formatjs",type:"button",caption:C+"tocode",tips:C+"tocode"},{data:1,id:"json",imageClass:"spafont spa-icon-formatjson",type:"button",caption:C+"tojson",tips:C+"tojson"},{id:"split_2",type:"split"},{data:1,id:"prfs",imageClass:"spafont spa-icon-options",type:"button",caption:w+"Profile Map)"},{data:1,id:"data",imageClass:"spafont spa-icon-data",type:"button",caption:w+"Data Map)"},{data:1,id:"value",imageClass:"spafont spa-icon-values",type:"button",caption:w+"Value Map)"}]);x.$canvasMenuItems.push({id:"inter",level:1,sub:[{id:"intermap",caption:"$(RAD.builder.Interaction Map)",imageClass:"xuicon xui-icon-xui"}]});x.toolbar.setItems(x.$canvasMenuItems);if(typeof g.customDesingerOnReady=="function"){g.customDesingerOnReady(x)}},onRender:function(w){var u=w._refresh=function(B,J,K,F,x){B=typeof(B)=="string"?w.getByAlias(B):B["xui.absObj"]?B:B.boxing();if(!B){return}var A=B.get(0),G="set"+q.str.initial(J),H="get"+q.str.initial(J),L,E;if(G=="setBBox"){G="_"+G}if(H=="getBBox"){H="_"+H}if(q.isFun(B[G])){if(B["xui.svg"]){if(A.renderId){E=B._getBBox();if(J=="bBox"){L=F}else{L=F[J]}}else{L=B[H]()}}else{if(A.renderId){if(K&&(J in K)){B.getRoot()[J+"By"](K[J],c)}else{if(F&&(J in F)){B.getRoot()[J](F[J],c)}}L=q.CSS.$px(A.getRoot().css(J),A.getRoot(),c)||0}else{L=A.properties[J]}}B[G](L)}var I=B[H]();if(x!==a&&(q.UI.$ps[J]||J==="bBox")){var D,C=!!B["xui.svg"];if(C){D=F&&((("x" in F)?b.round(F.x)!==b.round(E.x):0)||(("y" in F)?b.round(F.y)!==b.round(E.y):0)||(("width" in F)?b.round(F.width)!==b.round(E.width):0)||(("height" in F)?b.round(F.height)!==b.round(E.height):0))}else{L=q.CSS.$px(A.getRoot().css(J),A.getRoot(),c)||0;D=L!=q.CSS.$px(I,A.getRoot(),c)||0}if(D){if((L=A.parent)&&L.reSelectObject&&w.tempSelected&&q.arr.indexOf(w.tempSelected,A.$xid)!=-1){q.resetRun(":"+w.tempSelected.join(":"),function(){if(!A.box){return}var M=A.getRoot().parent();if(w.tempSelected.length>1){L.reSelectObject.call(L,A,M,c)}else{L.selectObject.call(L,A,M)}})}}}return I};w.$canvasXid=w.canvas.getRoot().xid();w.holder=q.create('<div style="display:none;"></div>');w.panelDiv.reBoxing().append(w.holder);w._createHandler();w._createResizer();w.focusBtn=q.create('<a href="javascript;" style="position:absolute;left:-10000px;top:-10000px;width:1px;height:1px;">o</a>');w.focusBtn.onKeydown(function(F,O){if(!w.resizer){return}var R=q.Event.getKey(O),L=R.key;if(L=="up"||L=="down"||L=="left"||L=="right"){if(w.resizer.get(0).isModule){return a}}var G=R.ctrlKey,N=R.shiftKey,E=1,K=w.resizer.reBoxing(),B=w.resizer.get(0),Q=B._target.get(0)?B._target.parent().offset(d,w.panelDiv.getRoot()):d,M=K.cssPos(),x=K.cssSize(),C={left:M.left-m(Q&&Q.left,10),top:M.top-m(Q&&Q.top,10),width:x.width,height:x.height},H=B.properties.dragArgs.heightIncrement,A=B.properties.dragArgs.widthIncrement;var I,P=a,J=d,D=d;switch(L){case"up":P=c;if(G){E=-1}else{if(N){E=(I=(b.round(C.top)+b.round(x.height))%H)?-I:-H}else{E=(I=b.round(C.top)%H)?-I:-H}}if(N){K.heightBy(E);B.regions.heightBy(E);J={width:0,height:E};C.height+=E}else{K.topBy(E);D={left:0,top:E};C.top+=E}break;case"down":P=c;if(G){E=1}else{if(N){E=(I=(b.round(C.top)+b.round(x.height))%H)?H-I:H}else{E=(I=b.round(C.top)%H)?H-I:H}}if(N){K.heightBy(E);B.regions.heightBy(E);J={width:0,height:E};C.height+=E}else{K.topBy(E);D={left:0,top:E};C.top+=E}break;case"left":P=c;if(G){E=-1}else{if(N){E=(I=(b.round(C.left)+b.round(x.width))%A)?-I:-A}else{E=(I=b.round(C.left)%A)?-I:-A}}if(N){B.regions.widthBy(E);K.widthBy(E);J={width:E,height:d};C.width+=E}else{K.leftBy(E);D={left:E,top:0};C.left+=E}break;case"right":P=c;if(G){E=1}else{if(N){E=(I=(b.round(C.left)+b.round(x.width))%A)?A-I:A}else{E=(I=b.round(C.left)%A)?A-I:A}}if(N){K.widthBy(E);B.regions.widthBy(E);J={width:E,height:d};C.width+=E}else{K.leftBy(E);D={left:E,top:0};C.left+=E}break;case"delete":w._deleteSelected();w._focus();break;case"esc":if(w.tempSelected&&w.tempSelected.length){w._clearSelect();w._setSelected([],c);return a}}if(P){B.boxing().onUpdate(B,B._target,J,D);return a}}).onKeypress(function(G,F){if(!w.resizer){return}if(w.$moduleInnerMode){return}var B=q.Event.getKey(F),A=B.key,D=B.ctrlKey,x=B.shiftKey,E=B.altKey;if(D){switch(A){case"c":var C=w.tempSelected;if(C&&C.length>0){if(E){w._toolbaraction({id:"clone"},{id:"copyclone"})}else{w._toolbaraction({id:"copy"},{id:"copyclone"})}}break;case"x":var C=w.tempSelected;if(C&&C.length>0){w._toolbaraction({id:"cut"},{id:"copyclone"})}break;case"v":if(s().__copied){var C=w.tempSelected,D;if(!C||C.length==0||(C.length===1&&(D=w.getByCacheId(C))&&D.get(0)&&D.get(0).boxing().getDropKeys)){w._toolbaraction({id:"paste"},{id:"pastefun"})}}break;case"a":return a;case"s":w.saveDesign();return a;break}}}).onFocus(function(A,x){w.resizer.active(a)}).onBlur(function(A,x){if(w.resizer&&w.tempSelected&&w.tempSelected.length){w.resizer.inActive();q.Event.keyboardHook("esc",0,0,0,function(){w._clearSelect();w._setSelected([],c);w._focus();return false},"xui-designer-"+w.$xid)}});w.layoutBase.reBoxing().prepend(w.focusBtn);w._giveHandler(w.canvas.get(0),c);w._enablePanelDesign(w.canvas.get(0));if(typeof g.customDesingerOnRender=="function"){g.customDesingerOnRender(w)}},onDestroy:function(u){u._resetHistory(c);if(u.frame&&u.frame.destroy){u.frame.destroy(c,c)}}},toInterMap:function(){var u=this;u._clearSelect();u._setSelected([],c);q.getModule("RAD.InteractionMap",function(w){this.refreshInterMap(u);this.show()})},getByAlias:function(w,u){if(w==="canvas"){return u?this.canvas.get(0):this.canvas}var x=this.$host[w];if(x){return u?x.get(0):x}return x},isDirty:function(){return !!this._dirty||!!this._canvaseventdirty||!!this._desingviewdirty||!!this._styledirty},"$tryToRefreshSel":function(w){var x=this,u;if((u=w.parent)&&u.reSelectObject&&x.tempSelected&&q.arr.indexOf(x.tempSelected,w.$xid)!=-1){q.resetRun(":"+x.tempSelected.join(":"),function(){if(!w.box||!w.getRootNode()){return}if(x.tempSelected.length>1){u.reSelectObject.call(u,w,w.getRoot().parent(),c)}else{u.selectObject.call(u,w,w.getRoot().parent())}})}},resetCodeFromDesigner:function(B){var C=this;if(g.getClientMode()!="project"||true){if(C._desingviewdirty){var D=C.$curViewSize,E=C.panelDivInner.get(0).CC;D.touchDevice=!!(E&&E.KEY&&E.KEY.indexOf("phonestyle")!=-1);C.resetCode("Static","designViewConf",C.stringify(D,"        "),!!B);C._desingviewdirty=a}if(C._styledirty){var D={},x;q.arr.each(["zoom","theme","background-color","background-image","background-repeat","background-position","background-attachment"],function(G,F){F=q.get(C._cls,["Static","viewStyles",G]);if(F){D[G]=F}});C.resetCode("Static","viewStyles",C.stringify(D,"        "),!!B);C._styledirty=a}}if(C._canvaseventdirty){var w=q.get(C._cls,["Instance","events"]);var A=w?C.stringify(w):"{}";A=A.replace(/\n/g,"\n"+q.str.repeat(" ",8));C.resetCode("Instance","events",A,!!B)}if(C._dirty){var u=C.getWidgets(c);var A=("{\n"+C.getJSCode(u)).replace(/\n/g,"\n"+q.str.repeat(" ",12))+"\n"+q.str.repeat(" ",8)+"}";C.resetCode("Instance","iniComponents",A,!!B,c);C.clearDirty();return A}},_bldTips:function(x,u,A){if(x.moduleClass&&x.moduleXid){x=q.Module.getFromDom(x.getDomId());if(!x["xui.Module"]){return}}if(!A){var w=x.serialize(false);if(w.children){w.children="( "+w.children.length+"... )"}w=q.Coder.formatText(q.stringify(w,function(D,C,B){if(C=="events"){B.push('"events":'+q.stringify(D,function(E,F,G){G.push('"'+F+'":"'+(q.isArr(E)?("["+E.length+(E.length<=1?" action]":" actions]")):E)+'"');return false}));return false}}));w=w.replace(/[\n\r]+/g,"<br/>").replace(/ /g,"&nbsp;")}return"<div><div class='xui-uiborder-b' style='padding:4px 0'>&lt;"+x.key+" : "+x.alias+"></div>"+(A?"":"<div class='xui-uiborder-b xui-ui-ellipsis' style='padding:4px 0; max-width:50em'>"+w+"</div>")+(u?("<div style='text-align:right;padding:4px 0'><em>"+u+"</em></div>"):"")+"</div>"},_bldTips2:function(w,u){return u?("<div class='xui-uiborder-b' style='padding:4px 0'>&lt;"+w+"></div><div style='text-align:right;padding:4px 0'><em>"+u+"</em></div>"):""},_inplaceedit:function(J,u,M,E,N,A,I,F,P){var C=this,H=!!E[0],x=E[1],T=E[2],Q=E[3],L=E[4]||J.properties.multiLines,D=E[5],K=E[6],S,B=J.key+":"+J.$xid;if(K){C._clearSelect();C._setSelected([],c);K(C,J,N,A,I,F,P);return}var O=function(w){if(!R||!R.getSubNode("INPUT")){return}R.getSubNode("INPUT").onBlur();R.setVisibility("hidden").setLeft(-1000).setValue("",c);q.Event.keyboardHook("esc",0,0,0,B)};if(!C.$inplaceEditor||C.$inplaceEditor.isDestroyed()){C.$inplaceEditor=new q.UI.ComboInput({type:"none",dirtyMark:a,visibility:"hidden"},{onHotKeydown:function(U,w){if(w.key=="tab"||(w.key=="enter"&&!U.properties.multiLines)){O();return a}}});C.panelDiv.append(C.$inplaceEditor);C.$inplaceEditor.render(c);C.$inplaceEditor.getRoot().beforeMousedown(function(U,w){})}var R=C.$inplaceEditor;R.afterUIValueSet(function(X,V,w){var U=J.alias;S=q.clone(S,c);var W=function(Z){if(H){if(typeof T=="function"){T(C.getByAlias(U,c),S,Q,Z)}else{var Y={};Y[Q||"caption"]=Z;C.getByAlias(U)[T](S.id,Y)}}else{if(typeof T=="function"){T(C.getByAlias(U,c),Z)}else{C.getByAlias(U)[T](Z)}}};W(w);C.markDirty(function(){W(V)},function(){W(w)},"set label");if(C.tempSelected&&C.tempSelected.length==1&&J.parent&&J.parent.selectObject){J.parent.selectObject.call(J.parent,J,J.getRoot().parent())}});var G;if(H){if(typeof x=="function"){S=x(J,N.get(0))}else{S=J.boxing()[x](N.get(0).$xid)}if(S){G=S[Q||"caption"]||""}else{return}}else{if(typeof x=="function"){G=x(J,N.get(0))}else{G=J.boxing()[x]()}}R.setMultiLines(!!L);R.setResizer(c);R.setValue(G,c);R.setZIndex(q.Dom.TOP_ZINDEX+10);R.setLeft(A-1).setTop(I-1).setWidth(F<102?102:(F+2)).setHeight(L?(P<52?52:(P+2)):(P<20?20:(P+2)));if(D){D(R,J,C)}q.asyRun(function(){R.getRoot().setBlurTrigger(B,O);q.Event.keyboardHook("esc",0,0,0,function(){R.setValue(G,c);O();C._focus();return false},B)});R.setVisibility("visible").activate()},_onIconlistMenu:function(u,x,A){var w;if(w=u.getItemByDom(A)){u.boxing().setUIValue(w.id,c)}this._showPopMenu(x);return a},_showPopMenu:function(C,u){var B=this,x=B.toolbar.getItems(),A,w=[];q.arr.each(x,function(F,D){if(F.hidden){return}if(F.deprecated){return}if(u&&!F.maybecanvas){return}if(F.id=="codegroup"){w.push({id:F.id,caption:F.tips,sub:B.$canvasMenuItems4});return}else{if(F.id=="pastefun"){if(!s().__copied){return}var H=B.tempSelected,G;if(!H||H.length==0||(H.length===1&&(G=B.getByCacheId(H))&&G.get(0)&&G.get(0).boxing().getDropKeys)){}else{return}}}if(F.level==1&&D!==0&&w.length>0){w.push({type:"split"})}if(F.level==1){q.arr.each(F.sub,function(I){if(I.hidden){return}if(I.id=="viewsize"){w.push({id:F.id,caption:I.tips,sub:B.$canvasMenuItems1})}else{if(I.type=="split"){w.push({type:"split"})}else{if(I.tips){w.push({id:I.id,image:I.image,imagePos:I.imagePos,imageClass:I.imageClass,caption:I.tips})}}}})}else{var E=[];q.arr.each(F.sub,function(I){if(I.hidden){return}if(I.id=="viewsize"){E.push({id:F.id,caption:"xxxxxxxxxx",image:I.image,imagePos:I.imagePos,imageClass:I.imageClass,sub:B.$canvasMenuItems1})}else{if(I.type=="split"){E.push({type:"split"})}else{if(I.id=="aligngroup"){E=d}else{if(I.id=="align"){w.push({id:F.id,caption:I.tips,sub:B.$canvasMenuItems5})}else{E.push({id:I.id,image:I.image,imagePos:I.imagePos,imageClass:I.imageClass,caption:I.tips})}}}}});if(E&&E.length){w.push({id:F.id,caption:F.caption,sub:E})}}});A=new q.UI.PopMenu({_maxheight:400,items:w},{onHide:function(D){D.boxing().destroy(c,c)},onMenuSelected:function(E,D){if(D.viewsize){B.popViewSize.fireItemClickEvent(D.id)}else{if(D.align){B.popAlign.fireItemClickEvent(D.id)}else{if(D.data){B.popData.fireItemClickEvent(D.id)}else{B.toolbar.fireItemClickEvent(D.id)}}}}});A.pop(q.Event.getPos(C))},_oncanvasmenu:function(u,w,x){if(q.Event.getSrc(w)==this.canvas.getRootNode()){this._showPopMenu(w,c);return a}},_createHandler:function(){var u=this;u.proxy=q.create('<div style="position:absolute;border:dashed 1px blue;overflow:visible;left:-100px;top:-100px;z-index:1000"></div>');u.proxy.get(0).zIndexIgnore=c;u.holder.append(u.proxy)},_editSVGPath:function(w){var x=this,u=w.alias,A;var B=function(L,D,O,F,N,J){if(O=="contextmenu"){if(N=="main"||N=="path1"||N=="path2"){switch(F.type){case"path":var I="$RAD.designer.tool.",M=[{id:"delpath",caption:I+"delpath",svg:c,imageClass:"spafont spa-icon-deletepath"},{id:"addpath",caption:I+"addpath",svg:c,imageClass:"spafont spa-icon-addpath"}],G,R;if(J===0){M.shift()}R=F.getPath();G=R.join("");if(typeof(R)=="string"){R=Raphael.parsePathString(R)}if(R[R.length-1][0]=="Z"){M.push({id:"openpath",caption:I+"openpath",svg:c,imageClass:"spafont spa-icon-breakpath"})}else{M.push({id:"closepath",caption:I+"closepath",svg:c,imageClass:"spafont spa-icon-closepath"})}var E=new q.UI.PopMenu({items:M},{onMenuSelected:function(V,T){switch(T.id){case"addpath":var U=q.copy(R[J===0?1:J]);q.arr.each(U,function(X,W){if(q.isNumb(X)){U[W]=X+10}});q.arr.insertAny(R,U,J+1,c);break;case"delpath":q.arr.removeFrom(R,J);break;case"openpath":q.arr.removeFrom(R,R.length-1);break;case"closepath":R.push(["Z"]);break}var S=function(){x.getByAlias(u).setAttr("KEY",{path:R.join("")},a,c)};S();w.boxing()._addHandler(B,g.SVGHandlerType);x.markDirty(function(){x.getByAlias(u).setAttr("KEY",{path:G},a,c)},S,"set svg path")}});E.pop(q.Event.getPos(D));break}}}else{if(O=="beforedragstart"){A=a;var H=x.getByAlias(u);x._oattr=q.clone(H.getAttr());if(H.constructor._CONNECTOR){x._oconnect={fromObj:H.getFromObj(),fromPoint:H.getFromPoint(),toObj:H.getToObj(),toPoint:H.getToPoint()}}}else{if(O=="drag"){A=c}else{if(O=="beforedragend"){if(A){var H=x.getByAlias(u),K=q.clone(H.getAttr()),Q,P=q.clone(x._oattr),C=x._oconnect;delete x._oattr;delete x._oconnect;if(H.constructor._CONNECTOR){Q={fromObj:H.getFromObj(),fromPoint:H.getFromPoint(),toObj:H.getToObj(),toPoint:H.getToPoint()}}x.markDirty(function(){var S=x.getByAlias(u);if(S.constructor._CONNECTOR&&C){S.setProperties(C,d,c)}S.setAttr(P,d,c,c)},function(){if(H.constructor._CONNECTOR&&Q){H.setProperties(Q,d,c)}x.getByAlias(u).setAttr(K,d,c,c)},"set svg path")}}}}}};w.boxing()._addHandler(B,g.SVGHandlerType);if(w._pathHandler){x.withPathHandler=w.boxing();x._detatchResizer()}},_createResizer:function(){var u=this;u.resizer=q.create("AdvResizer",{forceMovable:a,minWidth:2,minHeight:2,rotatable:c,dragArgs:{widthIncrement:this.dropOffset,heightIncrement:this.dropOffset},zIndex:q.Dom.TOP_ZINDEX},{onConfig:function(A,D,E,F,x){if(x!=="click"){return a}var C=q.getObject(A.properties.tag);if(C){if(F=="right"){if(C.box["xui.UI.FusionChartsXT"]&&!FCCONF.attrCat[C.properties.chartType]){var B=u.profileGrid;if(B){B.getSubNodeInGrid("CELLA","properties:JSONData","value").onClick(c)}}else{u._decorationWnd(C,u.resizer)}}else{if(F=="left"){if(C.key=="xui.svg.image"||C.box.SINGLE_NODE_IMAGE){q.ModuleFactory.getCom("RAD.ImageSelector",function(){this.setProperties({fromRegion:E,onOK:function(H,G){C.boxing().setAttr("KEY",{src:g.adjustRelativePath(G)},a,c)}});this.show()})}else{var B=u.profileGrid,A=B.get(0);if(B){var w=B.getCellbyRowCol("properties:src","value");if(w&&w.event){B.editCellbyRowCol("properties:src","value");B.getEditor().expand()}}}}}}},onContextmenu:function(w,x,A){this._showPopMenu(x);return a}});u.resizer.get(0).tagcls="xui-designer-inner-control";u.resizer.setHost(u).onShowTips(function(A,B,D){var x=[],C;q.arr.each(u.tempSelected,function(F,E){F=q.getObject(F);if(E===0){C=F}F=(F["xui.Module"]?F:F.getModule(c))||F;if(F["xui.Module"]){x=[F.alias];return a}else{x.push(F.alias)}});var w=u.$moduleInnerMode?"":g.enable_codeEdtor?("$(RAD.designer.Dblclick to edit the code)</em></div>"):"";if(x.length==1){q.Tips.show(D,u._bldTips(C,w))}else{q.Tips.show(D,"<div class='xui-uiborder-b' style='padding:4px;white-space:normal'>&lt;"+x.join("> &lt;")+"></div><div style='text-align:right'><em>"+w)}return a}).onItemsSelected(function(A,x){q.filter(x,function(D){var C=q.getObject(D);if(!(C instanceof q.UIProfile)){return a}if(C.box.$initRootHidden){return a}});if(this.pProfile){this.pProfile.setSelectFromResizer.call(this.pProfile,x)}u.resizer.setReadonly(a);A.isModule=0;if(x&&x.length){var B=q.getObject(x[0]),w=B.getModule(c);if(w){u.resizer.setReadonly(c);A.isModule=1}}}).onResetTarget(function(A,x){if(x&&x.length==1){var B=q.getObject(x[0]);if(B.box["xui.svg"]&&B.box._CONNECTOR){u._editSVGPath(B)}}u.resizer.setReadonly(a);A.isModule=0;if(x&&x.length){var C=q.getObject(x[0]),w=C.getModule(c);if(w){u.resizer.setReadonly(c);A.isModule=1}}}).onActive(function(w){q.clearTimeout(this.timer);this._focus()}).onUpdate(function(A,F,I,x,C){if(A.isModule){return a}var E={left:1,top:1,bottom:1,right:1,width:1,height:1,rotate:1,position:1,tabindex:1,"z-index":1,visibility:1,display:1,dock:1,tips:1};var H=this;if(F){var G=a,B,w=[],D=[];F.each(function(Q){Q=q([Q]);var K=q.UIProfile.getFromDom(Q.get(0).id),O=K.boxing(),J=K.properties,X,W=J.position=="absolute"?J.dock:"none",L=K.box.$DataModel;if(K.locked){G=c;return}if((X=K.properties)&&X.locked){G=c;return}var P=K.alias,M=((K.properties.position=="relative"||K.properties.position=="static")&&(q.get(K,["parent","properties","conDockRelative"])||q.get(K,["parent","properties","conLayoutColumns"])));if(O["xui.svg"]){var Y=O._getBBox(),S={};if(I){if(!M){S.width=b.max(0,Y.width+I.width||0)}S.height=b.max(0,Y.height+I.height||0)}if(x){if(!M&&x.left){S.x=Y.x+x.left}if(!M&&x.top){S.y=Y.y+x.top}}u._refresh(P,"bBox",d,S);w.push(function(){u._refresh(P,"bBox",d,S,a)});D.push(function(){u._refresh(P,"bBox",d,Y,a)})}else{if(I){var V=d,N=d;if(I.width){if(J&&!L.width){G=c}else{switch(W){case"top":case"bottom":case"fill":case"cover":case"width":G=c;break;case"left":case"right":case"height":G=c;default:if(!M){V=u._refresh(P,"width",I);w.push(function(){return u._refresh(P,"width",I,d,a)});D.push(function(){u._refresh(P,"width",{width:-I.width},d,a)})}else{u.resizer.rePosSize()}}}}if(I.height){if(J&&!L.height){G=c}else{switch(W){case"left":case"right":case"fill":case"cover":case"height":G=c;break;case"top":case"bottom":case"width":G=c;default:N=u._refresh(P,"height",I);w.push(function(){u._refresh(P,"height",I,d,a)});D.push(function(){u._refresh(P,"height",{height:-I.height},d,a)})}}}H._sizeUpdated(Q,{width:V,height:N});q.UI.$tryResize(K,V,N,d,c)}if(x){var U=d,R=d;if(x.left){if(J&&!L.left){G=c}else{switch(W){case"top":case"bottom":case"left":case"right":case"fill":case"cover":case"width":G=c;break;case"height":G=c;default:if(!M){U=u._refresh(P,"left",x);w.push(function(){return u._refresh(P,"left",x,d,a)});D.push(function(){u._refresh(P,"left",{left:-x.left},d,a)})}else{u.resizer.rePosSize()}}}}if(x.top){if(J&&!L.top){G=c}else{switch(W){case"left":case"right":case"top":case"bottom":case"fill":case"cover":case"height":G=c;break;case"width":G=c;default:if(!M){R=u._refresh(P,"top",x);w.push(function(){return u._refresh(P,"top",x,d,a)});D.push(function(){u._refresh(P,"top",{top:-x.top},d,a)})}else{u.resizer.rePosSize()}}}}H._posUpdated(Q,{left:U,top:R})}}if(q.isDefined(C)){var T=u._refresh(P,"rotate",d,{rotate:C});w.push(function(){return u._refresh(P,"rotate",d,{rotate:C},a)});D.push(function(){u._refresh(P,"rotate",d,{rotate:T},a)});H._rotateUpdated(Q,C)}});if(G){A.boxing().rePosSize()}}u.markDirty(function(){q.arr.each(D,function(J){q.tryF(J)})},function(){q.arr.each(w,function(J){q.tryF(J)})},"set controls' "+(I?"size":"position"));return a}).onFocusChange(function(x,w){if(x.isModule){return}if(this.tempSelected){this.SelectedFocus=w;q.resetRun("$profilegrid$",this._refreshProfileGrid,0,[this.tempSelected],this);this.resizer.setLeftConfigBtn(a);this.resizer.setRightConfigBtn(a);if(this.tempSelected&&this.tempSelected.length==1){this.resizer.setRightConfigBtn(c);var A=q.getObject(this.tempSelected[0]);if(g.getClientMode()!="singlepage"&&(A.key=="xui.UI.Image"||A.key=="xui.svg.image"||A.box.SINGLE_NODE_IMAGE||A.key=="xui.UI.Flash"||A.key=="xui.UI.Audio"||A.key=="xui.UI.Video")){this.resizer.setLeftConfigBtn(c)}}this.resizer.setTag(this.tempSelected[0])}}).onDblclick(function(x,B,D){if(!this.$moduleInnerMode&&g.enable_codeEdtor){var w=this.tempSelected;if(w&&w.length){var C=q.getObject(w[0]);C=target=(C["xui.Module"]?C:C.getModule(c))||C;u.resetTaskList();if(u._dirty){u.resetCodeFromDesigner()}u.addTask(function(){u.searchInEditor('.setHost(host,"'+C.alias+'"')});u.__dblclickctrl=c;q.asyRun(function(){u.__dblclickctrl=a});u.startTaskList()}}else{if(typeof g.designer_ctrldblclick=="function"){var w=this.tempSelected,A;if(w&&w.length){A=q.getObject(w[0])}u.__dblclickctrl=c;q.asyRun(function(){u.__dblclickctrl=a});g.designer_ctrldblclick(u,A,B,D)}}}).onRegionClick(function(x,F){if(x.isModule){return}var I=q.Event.getPos(F),E,H,A,G;var w=function(M,R,T,U,N,W,L,S,X,P,J){if(N&&!N.isEmpty()){if(M.box["xui.svg"]){var K=M.boxing().getPaper(),O;if(K&&(O=K.getById(N.get(0).raphaelid))){var Z=O._getBBox();if(!("x2" in Z)){Z.x2=Z.x+Z.width}if(!("y2" in Z)){Z.y2=Z.y+Z.height}if(L.left>Z.x&&L.top>Z.y&&L.left<Z.x2&&L.top<Z.y2){q.asyRun(function(){u._inplaceedit(M,R,T,U,N,S.left+Z.x,S.top+Z.y,Z.width+20,Z.height)},200);return c}}}else{var V=N.offset(d,W),Y=N.offsetWidth(),Q=N.offsetHeight();if(L.left>V.left&&L.top>V.top&&L.left<V.left+Y&&L.top<V.top+Q&&L.left<X&&L.top<P){q.asyRun(function(){if(!N.get(0)||!N.get(0).offsetWidth){return}u._inplaceedit(M,R,T,U,N,S.left+V.left,S.top+V.top,Y,Q)},200);return c}}}return a};var D=function(L,Q){var K=Q.getRoot(),O={},N=K.offset();O.left=L.left-N.left;O.top=L.top-N.top;var P=Q._paper.getElementsByPoint(O.left,O.top);for(var M=0,J=P.length;M<J;M++){if(!P[M]._decoration){u._clearSelect();u._setSelected([],c);rt=q.UIProfile.getFromDom(P[M].node).$xid;return rt}}},C=function(Z,M){var T=g.inplaceedit&&g.inplaceedit[M.key],V,K,N;if(!q.isHash(T)){return a}for(var R in T){var Y=T[R],U=!!Y[0];if(M.box["xui.svg"]){var V=M.parent.getRoot(),L={},S=V.offset(),X=V.offset(d,u.panelDiv.getRoot()),W=V.offsetWidth(),Q=V.offsetHeight();L.left=Z.left-S.left;L.top=Z.top-S.top;if(U){var K=M.getSubNode(R,c).get(),N;for(var P=0,O=K.length;P<O;P++){N=K[P];if(N.id){var J=M.getSubId(N.id);if(w(M,R,1,Y,q([N.$xid]),V,L,X,W,Q,J)){return c}}}}else{if(w(M,R,0,Y,M.getSubNode(R),V,L,X,W,Q,J)){return c}}}else{var V=M.getRoot(),L={},S=V.offset(),X=V.offset(d,u.panelDiv.getRoot()),W=V.offsetWidth(),Q=V.offsetHeight();L.left=Z.left-S.left;L.top=Z.top-S.top;if(U){var K=M.getSubNode(R,c).get(),N;for(var P=0,O=K.length;P<O;P++){N=K[P];if(N.id){var J=M.getSubId(N.id);if(w(M,R,1,Y,q([N.$xid]),V,L,X,W,Q,J)){return c}}}}else{if(w(M,R,0,Y,M.getSubNode(R),V,L,X,W,Q,J)){return c}}}}return a},B=function(O,V,T){var Q=arguments.callee,K,L,R,U,N,J={},P=T.offset(),S=T.offsetWidth(),M=T.offsetHeight();J.left=V.left-P.left;J.top=V.top-P.top;q.arr.each(O,function(W){if(!(K=W[0].getRoot()).isEmpty()){if((W[0].children).length){if(L=Q(W[0].children,V,K)){return a}}if(K.css("display")=="none"){return}if(K.css("visibility")=="hidden"){return}if(K.get(0).offsetHeight===0){return}if(K.get(0).offsetWidth===0){return}R=K.offset(d,T);U=K.offsetWidth();N=K.offsetHeight();if(J.left>R.left&&J.top>R.top&&J.left<R.left+U&&J.top<R.top+N&&J.left<S&&J.top<M){L=W[0].$xid;return a}}});return L};if(!(E=this.tempSelected)||!E.length){return}q.arr.each(E,function(K){var J=q.getObject(K);if(J.key=="xui.UI.SVGPaper"){G=D(I,J);if(G){return a}}G=B(J.children,I,J.getRoot());if(G){return a}G=C(I,J);if(G){return a}if(G){return a}});if(G){if(G!==c){this.selectWidget([G]);return a}}});u.resizer.setOffsetParent(u.panelDiv.getRootNode());u.holder.append(u.resizer)},_showAnimEditor:function(x,A,u){var w=this;q.showModule("RAD.AnimationConf",function(B){B.setProperties({frames:x.properties.frames});B.setEvents({onchange:A})})},_showAPIEditor:function(w,A,u){var x=this;q.showModule("RAD.APIConfig",function(B){B.setDataToEditor(w,x.$host,x._cls);B.setEvents({onchange:A})})},_showExpressionEditor:function(A,x,u){var w=this;q.showModule("RAD.expression.SimpleExpressionEditor",function(B){B.setDataToEditor(w.$host,w._cls,A);B.setEvents({onchange:x})})},_decorationWnd:function(M,F,T,u,x,E){var C=this,R,K,L=M.alias;if(T=="expression"){}else{if(T=="effects"){var Q=q.clone(M.properties.showEffects,c),G=q.clone(M.properties.hideEffects,c);R=function(){C.getByAlias(L).setShowEffects(q.clone(Q,c),c).setHideEffects(q.clone(G,c),c)}}else{if(M.box["xui.svg"]){var O=q.clone(M.boxing().getAttr(),c);R=function(){C.getByAlias(L).setAttr(q.clone(O,c),d,c,c)}}else{if(M.box["xui.UI.FusionChartsXT"]){var S=q.clone(M.boxing().getJSONData(),c);R=function(){C.getByAlias(L).setJSONData(q.clone(S,c),c)}}else{if(M.box["xui.UI.CSSBox"]){var D=q.clone(M.properties.normalStatus,c),J=q.clone(M.properties.hoverStatus,c),N=q.clone(M.properties.activeStatus,c),B=q.clone(M.properties.focusStatus,c);R=function(){C.getByAlias(L).setNormalStatus(q.clone(D,c),c).setHoverStatus(q.clone(J,c),c).setActiveStatus(q.clone(N,c),c).setFocusStatus(q.clone(B,c),c)}}else{if(M.box["xui.Module"]){var A=M.properties,I=(new (q.SC(M.KEY))()).getProfile(),H=q.clone(A.__inner_coms_prf__);R=function(){M.setProfile(H);if(q.isEmpty(H)){delete A.__inner_coms_prf__}else{A.__inner_coms_prf__=H}}}else{var w=q.clone(M.CC,c),P=q.clone(M.CS,c);R=function(){C.getByAlias(L).setCustomClass(q.clone(w,c),c).setCustomStyle(q.clone(P,c),c)}}}}}}}q.ModuleFactory.getCom(T=="effects"?"RAD.CustomEffects":M.box["xui.svg"]?"RAD.SVGCustomDecoration":M.box["xui.UI.FusionChartsXT"]?"RAD.ChartCustomSetting":M.box["xui.UI.CSSBox"]?"RAD.CustomDecoration2":M.box["xui.Module"]?"RAD.ModuleDesigner":"RAD.CustomDecoration",function(){this.setProperties({targetProfile:M,src:F,page:C});var U=a;this.setEvents({onFinished:function(ai,X){if(!U){return}if(T=="effects"){var ae=q.clone(M.properties.showEffects,c),aa=q.clone(M.properties.hideEffects,c);K=function(){C.getByAlias(L).setShowEffects(q.clone(ae,c),c).setHideEffects(q.clone(aa,c),c)};if(u){u.boxing().updateCell(x,{_ext:{showEffects:ae,hideEffects:aa}},a,c)}}else{if(M.box["xui.svg"]){var ab=q.clone(M.boxing().getAttr(),c);K=function(){C.getByAlias(L).setAttr(q.clone(ab,c),d,c,c)};if(u){u.boxing().updateCell(x,{_ext:{attr:ab}},a,c)}}else{if(M.box["xui.UI.FusionChartsXT"]){var Z=q.clone(M.boxing().getJSONData(),c);K=function(){C.getByAlias(L).setJSONData(q.clone(Z,c),c)};if(u){u.boxing().updateCell(x,{_ext:{JSONData:Z}},a,c)}if(u){u.boxing().updateCell(x,{_ext:{chartOption:Z}},a,c)}}else{if(M.box["xui.UI.CSSBox"]){var ad=q.clone(M.properties.normalStatus,c),ah=q.clone(M.properties.hoverStatus,c),af=q.clone(M.properties.activeStatus,c),Y=q.clone(M.properties.focusStatus,c);K=function(){C.getByAlias(L).setNormalStatus(q.clone(ad,c),c).setHoverStatus(q.clone(ah,c),c).setActiveStatus(q.clone(af,c),c).setFocusStatus(q.clone(Y,c),c)};if(u){u.boxing().updateCell(x,{_ext:{normalStatus:ad,hoverStatus:ah,activeStatus:af,focusStatus:Y}},a,c)}}else{if(M.box["xui.Module"]){var W=M.properties,ac={};q.each(ai,function(ao,am){var an={},ap=ao.properties||{},aj=I[am].properties||{};for(var ak in ap){if(!q.compareVar(ap[ak],aj[ak])){an[ak]=ap[ak]}}for(var ak in aj){if(!(ak in an)){if(!q.compareVar(ap[ak],aj[ak])){var al=q.get(X[am],["box","$DataStruct",ak]);an[ak]=q.isSet(al)?al:d}}}if(!q.isEmpty(an)){ac[am]={properties:an}}});K=function(){M.setProfile(ac);if(q.isEmpty(ac)){delete W.__inner_coms_prf__}else{W.__inner_coms_prf__=ac}};K()}else{var ag=q.clone(M.CC,c),V=q.clone(M.CS,c);K=function(){C.getByAlias(L).setCustomClass(q.clone(ag,c),c).setCustomStyle(q.clone(V,c),c)};if(u){u.boxing().updateCell(x,{_ext:{CC:ag,CS:V}},a,c)}}}}}}if(!E){C.markDirty(R,K,"set "+(M.box["xui.svg"]?"svg attr":M.box["xui.UI.FusionChartsXT"]?"chart configuration":"custom CSS"))}},onDirty:function(W){U=c;if(!E){if(W){var V=M.getRoot().parent();if(M.parent&&C.tempSelected.length==1){M.parent.reSelectObject.call(M.parent,M,V,c)}}}}});this.show()},d,!M.box["xui.Module"])},_detatchResizer:function(){var u=this;if(u.resizer.get(0)){u.holder.append(u.resizer)}if(u.proxy.get(0)){u.holder.append(u.proxy)}u.pProfile=u.pNode=d;u._parentOffset&&u._parentOffset.afterScroll(d,"xui-designer-resizer-off")},_attachResizer:function(B,C){var D=this,w=D.panelDiv.getRoot(),A=w.get(0),x;D.proxy.css("display","none");if(!D.proxy||!D.proxy.get(0)){D._createHandler()}D._clearSelect();D.resizer.resetTarget(d,a);w.append(D.resizer);if(x=q(C).get(0)){q(C).append(D.proxy);var u=[];do{if(x!==A){u.push(x)}}while(x=x.offsetParent);if(u.length){D._parentOffset=q(u);D._parentOffset.afterScroll(function(){q.resetRun("xui-designer-resizer-off",function(){D&&D.resizer&&D.resizer.rePosSize()})},"xui-designer-resizer-off")}}D.pProfile=B;D.pNode=q(C);q.merge(D.resizer.get(0).properties.dragArgs,{widthIncrement:D.dropOffset,heightIncrement:D.dropOffset},"all")},_focus:function(){var u=this;q.asyRun(function(){u.focusBtn.focus(true)})},_setSelected:function(w,F){var E=this,C=E.toolbar,A=E.tempSelected,I,G,H;w=q.isArr(w)?w:[];E.tempSelected=w;E.SelectedFocus=w.length-1;if(w.length){var B=q.getObject(w[0]);if(B){H=B.getModule()}}C.showGroup("aligngroup",H?a:w.length>1);if(w.length==1&&(I=q.getObject(w[0]))){G=!!(I.box["xui.UI"]&&!I.box.$initRootHidden);C.showGroup("pos",H?a:G)}else{C.showGroup("pos",a)}if(!E.$moduleInnerMode){C.showGroup("copyclone",w.length>0?c:a)}C.showGroup("svgpath",a);if(w.length==1){var D=q.getObject(w[0]);if(D&&D.box["xui.svg"]&&D._elset[0].type=="path"){C.showGroup("svgpath",c)}if(D&&D.box["xui.svg"]){C.updateItem("order_up",{disabled:true});C.updateItem("order_down",{disabled:true})}else{C.updateItem("order_up",{disabled:false});C.updateItem("order_down",{disabled:false})}}var x=a;if(s().__copied){var u;x=!w||w.length===0||(w.length===1&&(u=E.getByCacheId(w))&&u.get(0)&&u.get(0).boxing().getDropKeys)}C.showGroup("pastefun",!!x);if(F){E.fireEvent("onSelected",[E,E.pProfile,w],E.parent)}E._focus();if(w.length==1){var B=q.getObject(w[0]);if(B&&B.$onSelectedInDesign){B.$onSelectedInDesign(E)}}else{if(A&&A.length==1&&!w.length){var B=q.getObject(A[0]);if(B&&B.$onUnSelectedInDesign){B.$onUnSelectedInDesign(E)}}}return E},_sizeUpdated:function(A,x){var w,u=this;if(!(w=u.profileGrid.get(0).$widget)){return}if(q.UIProfile.getFromDom(A.get(0).id)==w.get(w._nodes.length-1)){if(x.width!==d){u.profileGrid.updateCellByRowCol("properties:width","value",{value:x.width})}if(x.height!==d){u.profileGrid.updateCellByRowCol("properties:height","value",{value:x.height})}}},_posUpdated:function(A,u){var x,w=this;if(!(x=w.profileGrid.get(0).$widget)){return}if(q.UIProfile.getFromDom(A.get(0).id)==x.get(x._nodes.length-1)){if(u.left!==d){w.profileGrid.updateCellByRowCol("properties:left","value",{value:u.left})}if(u.top!==d){w.profileGrid.updateCellByRowCol("properties:top","value",{value:u.top})}}},_rotateUpdated:function(A,w){var x,u=this;if(!(x=u.profileGrid.get(0).$widget)){return}if(q.UIProfile.getFromDom(A.get(0).id)==x.get(x._nodes.length-1)){u.profileGrid.updateCellByRowCol("properties:rotate","value",w)}},parseFun:function(u){var x=u;var w=new r("^(\\s*\\/\\*[^*@]*\\*+([^\\/][^*]*\\*+)*\\/\\s*)|^(\\s*\\/\\/[^\\n]*\\s*)");while(w.test(x)){x=x.replace(w,"")}x=x.replace(/\s*/,"");if(!x){return{comments:d,code:d}}if(a===this.check(x.replace(/\s*$/,""))){return a}return{comments:"\n"+u.replace(x,""),code:x.replace(/\s*$/,"")}},_designable:function(u){var w=this;if(u["xui.Module"]){w._mdlDesignable(u)}else{w._uiDesignable(u)}},_mdlDesignable:function(x,u){var A=this;x.$inDesign=A.$canvasXid;if(!u){x.boxing().setHost(A.$host,x.alias);x.$refreshTrigger=function(D){A._designable(D)};x.$panelRestore=function(D){A._designable(D)}}var B={},w,C;B[x.KEY+"["+x.$xid+"]"]=1;x.getAllComponents().each(function(E){E.$inDesign=A.$canvasXid;if(E["xui.UIProfile"]){var I;if(I=q.get(s(),["curProjectConfig","$DevEnv","SpaceUnit"])){x._spaceUnit=I}E._showTips=function(K,M,L){var J=A._bldTips(K,"in design mode",true);if(J){q.Tips.show(L,J);return false}};E.tagcls="xui-designer-inner-control";if(E.rendered){E.getAllNodes().addClass(E.tagcls)}var H=q.UI.__resetDftProp_in_Desinger,F=E.box.__resetDftProp_in_Desinger,D=E.box.$DataModel;for(var G in D){if(E.properties[G]===(D[G]&&("ini" in D[G])?D[G].ini:"")){if(F&&(G in F)){E.properties[G]=F[G]}else{if(H&&(G in H)){E.properties[G]=H[G]}}}}E.theme=E.theme||q.get(g,["WidgetDftTheme",E.key]);A._giveHandler(E);E.$refreshTrigger=function(J){A._designable(J)}}if(E["xui.UIProfile"]){if(E.moduleClass&&E.moduleXid&&(I=q.SC.get(E.moduleClass))&&(I=I.getInstance(E.moduleXid))&&I["xui.Module"]){if(!B[C=I.KEY+"["+I.$xid+"]"]){B[C]=1;I.$refreshTrigger=function(J){A._mdlDesignable(J,c)}}}}});if(g._$initForDesign[x.key]){g._$initForDesign[x.key](A,x)}},_uiDesignable:function(u){var B=this;u.boxing().setHost(B.$host,u.alias);u.$inDesign=B.$canvasXid;if(u["xui.UIProfile"]){var D;if(D=q.get(s(),["curProjectConfig","$DevEnv","SpaceUnit"])){u._spaceUnit=D}u._showTips=function(H,J,I){var G=B._bldTips(H,"in design mode",true);if(G){q.Tips.show(I,G);return false}};u.tagcls="xui-designer-inner-control";if(u.rendered){u.getAllNodes().addClass(u.tagcls)}var F=q.UI.__resetDftProp_in_Desinger,E=u.box.__resetDftProp_in_Desinger,A=u.box.$DataModel;for(var x in A){if(u.properties[x]===(A[x]&&("ini" in A[x])?A[x].ini:"")){if(E&&(x in E)){u.properties[x]=E[x]}else{if(F&&(x in F)){u.properties[x]=F[x]}}}}u.theme=u.theme||q.get(g,["WidgetDftTheme",u.key]);B._giveHandler(u);u.$refreshTrigger=function(G){B._designable(G)}}if(u["xui.UIProfile"]){u.$panelRestore=function(G){B._designable(G)};var D=q.get(u,["behavior","PanelKeys"]);if(D&&D.length){B._enablePanelDesign(u)}if(u.children&&u.children.length){var w={},D,C;q.arr.each(u.children,function(G){G=G[0];if(G["xui.UIProfile"]){if(G.moduleClass&&G.moduleXid&&(D=q.SC.get(G.moduleClass))&&(D=D.getInstance(G.moduleXid))&&D["xui.Module"]){if(!w[C=D.KEY+"["+D.$xid+"]"]){w[C]=1;B._mdlDesignable(D,a)}}else{B._uiDesignable(G)}}})}}if(g._$initForDesign[u.key]){g._$initForDesign[u.key](B,u)}},_WidgetsSelected:function(u){var w=this;w._setSelected(u,c);if(w.iconlist){w.iconlist.setUIValue(d)}},_clearSelect:function(){var u=this;q.Event.keyboardHook("esc",0,0,0,"xui-designer-"+u.$xid);if(u.resizer&&u.resizer.get(0)&&u.resizer.get(0).renderId){u.resizer.resetTarget(d,a);u._detatchResizer()}if(u.iconlist){u.iconlist.setUIValue(d)}if(u.withPathHandler){u.withPathHandler._removeHandler();delete u.withPathHandler}},getByCacheId:function(x){var u=[],w,A=q.UI._cache;x=x instanceof Array?x:[x];q.arr.each(x,function(B){if(w=A["$"+B]){u[u.length]=w}});return q.UI.pack(u,a)},_deleteSelected:function(x){var w=this,u=function(){var D=w.getByCacheId(w.tempSelected),B;w._clearSelect();var C=[],F=[];if(!D.isEmpty()){var A=[];var I=w.getByCacheId(w.tempSelected);var J=I.get(0).parent?I.get(0).parent.alias:"canvas";B=I.get(0).childrenId;I.each(function(N){N=(N["xui.Module"]?N:N.getModule(c))||N;if(q.arr.indexOf(C,N.alias)!=-1){return}C.push(N.alias);var M=N.serialize(a);delete M.events;var L;if(L=w.iconlist.getItemByItemId(N.$xid)){M._item=q.copy(L,c)}F.push(M)})}else{var H=q.getObject(w.tempSelected[0]);H=(H["xui.Module"]?H:H.getModule(c))||H;if(q.arr.indexOf(C,H.alias)!=-1){return}if(!J){J=H.parent?H.parent.alias:"canvas"}C.push(H.alias);var E=H.serialize(a);delete E.events;var K;if(K=w.iconlist.getItemByItemId(H.$xid)){E._item=q.copy(K,c)}F.push(E)}var G=function(){q.arr.each(C,function(L){var M=w.getByAlias(L,c);if(M){if(w.iconlist.getItemByItemId(M.$xid)){w.iconlist.removeItems(M.$xid)}M.boxing().destroy(c,c)}})};G();w.markDirty(function(){q.arr.each(F,function(O){var N=O._item&&O._item.image,M=O._item&&O._item.imageClass,L=O._item&&O._item.imgStyle;var P=q.create(q.clone(O));P=P.get(0);w._designable(P);if(P["xui.Module"]){if(P.getUIComponents().isEmpty()){w.iconlist.insertItems([{id:P.$xid,imgWidth:"16",imgHeight:"16",tips:w._bldTips(P,w.$moduleInnerMode?"":g.enable_codeEdtor?("$(RAD.designer.Dblclick to edit the code)"):""),imgStyle:L,imageClass:M}],d,a)}else{w.getByAlias(J).append(P,B)}}else{if(!P.box["xui.UI"]||P.box.$initRootHidden){w.iconlist.insertItems([{id:P.$xid,imgWidth:"16",imgHeight:"16",tips:w._bldTips(P,w.$moduleInnerMode?"":g.enable_codeEdtor?("$(RAD.designer.Dblclick to edit the code)"):""),imgStyle:L,imageClass:M}],d,a);if(P.box["xui.UI"]){w.canvas.append(P)}}else{w.getByAlias(J).append(P,B)}}})},G,"delete controls");w._setSelected(d,c)};if(!w.tempSelected||!w.tempSelected.length){return}if(!x){q.confirm(q.getRes("RAD.designer.confirmdel"),q.getRes("RAD.designer.confirmdel2",w.tempSelected.length),u)}else{u()}},_giveHandler:function(x,u){var C=function(){return},B=function(){return a},A=this,w=function(){if(!u){(x.box["xui.svg"]?x.boxing().getAllNodes():(x.getRoot().setSelectable(a))).beforeClick(C).afterClick(B).onClick(d).onClick(function(T,O,G){var P=q.Event.getSrc(O),V,H,K;var N=T.box["xui.svg"];while(((!P.id)||P.id==q.$localeDomId||P.tagName=="tspan")&&P.parentNode!==n&&P.parentNode!==j){P=P.parentNode}H=P.id;P=d;if(!H){return}var U=q.UIProfile.getFromDom(H);if(V=U.box._ACTIVEHANDLER){noHandler=true;for(var M=0,L=V.length;M<L;M++){if(U.getKey(H).split("-")[1]==(V[M]=="KEY"?(void 0):V[M])){noHandler=false;break}}if(noHandler){return}}K=q.UIProfile.getFromDom(q.use(G).id());if(!K){return}if(U&&U!==K){if(U._render_holder){U=U._render_holder}else{var J=U.getModule();U=J&&J._render_holder}}if(U!==K){return}var Q;var I=K.getModule(c);if(I){Q=I.getUIComponents();K=Q.get(0)}var V,S,R=q.Event.$keyboard;if(A.pProfile&&(A.pProfile!=K.parent)){A.pProfile.selected=[]}if(V=K.parent){S=K.getRoot().parent();if(Q){var F=[];Q.each(function(W){F.push(W.$xid)});return V.setSelectFromPanel(V.getContainer(),F)}else{if(A.tempSelected&&A.tempSelected.length&&q.arr.indexOf(A.tempSelected,K.$xid)!=-1){A.resizer.onRegionClick(O)}else{if(R&&R.shiftKey){V.reSelectObject.call(V,K,S)}else{V.selectObject.call(V,K,S)}}}}q.Event.simulateEvent(n.documentElement,"mousedown",{screenX:0,screenY:0,clientX:0,clientY:0});return a});x.$afterAttached=function(F){F.getRoot().setSelectable(a).beforeClick(d).afterClick(d).onClick(d)};x.$onDock=function(F){A.$tryToRefreshSel(F)};x.$afterRefresh=function(F){A.$tryToRefreshSel(F)};if(x.box.KEY=="xui.UI.Image"){x.$afterLoad=function(){A.$tryToRefreshSel(x)}}if(x.$inDesign&&x["xui.UIProfile"]){var D=function(J,I){var G=J.getRoot&&J.getRoot();if(G&&!q.isEmpty(G)){if(J.$$binderdiv){J.$$binderdiv.remove()}if(G.width()>=50){var H;if(j.get){H=get}var F=[];j.get=function(M){F.push(M)};try{q.each(I,function(M,N){if((N in J.properties)&&q.isFun(M)){M()}})}catch(K){}finally{j.get=H}if(F.length){var L=q.create("<div style='position:absolute;left:0;top:0;z-index:999999;color:#aaa;'>["+F[0]+(F.length>1?"...":"")+"]</div>");G.append(J.$$binderdiv=L)}}}};if(!q.isEmpty(x.properties.propBinder)){D(x,x.properties.propBinder)}x.$afterPropertyChanged=function(H,G,F){if(G=="propBinder"){D(H,F)}}}}var E=x.behavior.PanelKeys;q.arr.each(E,function(F){if((F=="KEY"||F=="PANEL"||F==x.box._CONTAINERKEY)&&!x.box._ITEMCONTAINER){x.getSubNode(F,c).addClass("xui-designer-canvas").$addEventHandler("mousedown").$addEventHandler("mouseup").$addEventHandler("click")}x.getSubNode(F,c).$addEventHandler("mouseover").$addEventHandler("mouseout").$addEventHandler("drop").$addEventHandler("drag").$addEventHandler("dragstop")})};if(x.renderId){w()}else{x.$onrender=w}},_enablePanelDesign:function(u){var E=u,B=u.boxing(),H,F=u.box.KEY,C=u.behavior.PanelKeys,D=this,A,x,G=this,w={beforeMouseover:function(M,R,I){if(M.moduleClass&&M.moduleXid){return}var V=q.DragDrop,L=V.getProfile(),U=L.dragKey,Q=L.dragData,T=Q&&Q.data&&Q.data[0]&&q.getObject(Q.data[0]),O=T&&T.getRoot().parent().xid();if(!U||!Q||!(new r("\\b"+U+"\\b")).test(M.box.getDropKeys(M,I)+":___iDesign")||(Q.parentId==M.$xid&&O==I)||(Q.data&&q.arr.indexOf(Q.data,M.$xid)!=-1)||(M.onDropTest&&(a===M.boxing().onDropTest(M,U,Q)))){return}if(T){var K=function(W){var X;q.arr.each(W,function(Y){if((Y[0]||Y)==M){X=1;return false}else{X=K(Y.children)}});return X};var J=[];for(var P=0,N=Q.data.length,S=Q.data[P];P<N;P++){J.push(q.getObject(S))}if(K(J)){return}if(M.box){if(M.box._IllegalDetect&&q.isSet(M.box._IllegalDetect(M,{_nodes:J},false))){return}}}else{if(M.box){if(M.box._IllegalDetect&&q.isSet(M.box._IllegalDetect(M,{_nodes:[{box:q.SC.get(Q.cls)}]},false))){return}}}if(Q){if(M.box.KEY=="xui.UI.SVGPaper"){}else{if(Q.type){if(q.str.startWith(Q.type,"xui.svg.")){return}}else{if(!Q.data){return}for(var P=0,N=Q.data.length;P<N;P++){if(q.str.startWith(q.getObject(Q.data[P]).box.KEY,"xui.svg.")){return}}}}}V.setDropElement(I);q.resetRun("setDropFace",V.setDropFace,0,[I],V);if(M.onDragEnter){M.boxing().onDragEnter(M,R,this,U,Q,M.getItemByDom(q.use(I).id()))}},beforeDrop:function(P,au,Y){if(P.moduleClass&&P.moduleXid){return}try{var I,T=q.DragDrop.getProfile(),am=T.x,al=T.y,ar=T.dragKey,ap=T.dragData,ax=(ap.cls=="xui.Module"?ap.type:ap.cls),ac=ap.iniProp,at=ap.className,V=ap.children,Z=ap.iniEvents,N=ap.customRegion,L=ap.image,M=ap.imagePos,R=ap.imageClass,av=ap.data,aj=ap.caption,af=ap.pos,aw,ak=G.dropOffset,S=function(az,ay,aA){D.markDirty(function(){var aB=D.getByAlias(aA.alias,c);if(!(aB.box["xui.UI"]&&!aB.box.$initRootHidden)){D.iconlist.removeItems(aB.$xid)}aB.boxing().destroy(c,c)},function(){var aD=aA._item&&aA._item.image,aC=aA._item&&aA._item.imageClass,aB=aA._item&&aA._item.imgStyle;var aE=q.create(q.clone(aA));aE=aE.get(0);D._designable(aE);if(!(aE.box["xui.UI"]&&!aE.box.$initRootHidden)){D.iconlist.insertItems([{id:aE.$xid,imgWidth:"16",imgHeight:"16",tips:D._bldTips(aE,D.$moduleInnerMode?"":g.enable_codeEdtor?("$(RAD.designer.Dblclick to edit the code)"):""),imgStyle:aB,imageClass:aC}],d,a);if(aE.box["xui.UI"]){D.canvas.append(aE)}}else{D.getByAlias(az).append(aE,ay)}},"add control")},ah=function(){var aH=arguments.callee.page,aJ=q.SC(ax),aF;var ay=P.getItemIdByDom(q.use(Y).id());if(!(aJ["xui.UI"]&&!aJ.$initRootHidden)){aF=q.create(ax);aF.get(0).$inDesign=aH.$canvasXid;if(aF.get(0)["xui.UIProfile"]){var aJ;if(aJ=q.get(s(),["curProjectConfig","$DevEnv","SpaceUnit"])){aF.get(0)._spaceUnit=aJ}}if(q.isHash(ac)){aF.setProperties(q.clone(ac))}try{aF.setAlias(ac.name);aF.setEvents(Z)}catch(aG){}aF=aF.get(0);aH.iconlist.insertItems([{id:aF.$xid,imgWidth:"16",imgHeight:"16",tips:aH._bldTips(aF,aH.$moduleInnerMode?"":g.enable_codeEdtor?("$(RAD.designer.Dblclick to edit the code)"):""),imgStyle:L?"background:url("+L+") imagePos":"",imageClass:R}],d,a);aH.iconlist.setUIValue(aF.$xid);aH._designable(aF);if(aF.box["xui.UI"]){aH.canvas.append(aF)}}else{aF=new (q.SC(q.absBox.$type[ax]));aF.get(0).$inDesign=aH.$canvasXid;if(aF.get(0)["xui.UIProfile"]){var aJ;if(aJ=q.get(s(),["curProjectConfig","$DevEnv","SpaceUnit"])){aF.get(0)._spaceUnit=aJ}}if(q.isHash(ac)){aF.setProperties(q.clone(ac))}if(aj){if("labelCaption" in aF.Class.$DataStruct){if(parseFloat(aF.getLabelSize())>0){aF.setLabelCaption(q.adjustRes(aj))}}else{if("caption" in aF.Class.$DataStruct){aF.setCaption(q.adjustRes(aj))}}}if(!N&&aF["xui.UI"]){var aE=P.keys.PANEL?P.getSubNode(P.keys.PANEL,P.getSubId(Y)):P.getRoot();if(!aE.isEmpty()){var az=aF.get(0).properties,aD=aE.get(0).style.height;if(P.properties.conDockRelative||P.properties.conLayoutColumns){aF.setPosition("relative")}else{if(aD&&aD!="auto"){var aB=q.use(Y).offset(),aA={left:m((am-aB.left)/ak)*ak,top:m((al-aB.top)/ak)*ak};if(!aF["xui.svg"]&&q.$us(aF.get(0))>0){aA.left=q.CSS.$forceu(aA.left,"em",aH.canvas.get(0));aA.top=q.CSS.$forceu(aA.top,"em",aH.canvas.get(0))}try{aF.setLeft(q.arr.indexOf(["top","bottom","width","fill","cover"],az.dock)!=-1?0:aA.left);aF.setTop(q.arr.indexOf(["left","right","height","fill","cover"],az.dock)!=-1?0:aA.top);if(!aF["xui.svg"]){aF.setPosition("absolute")}}catch(aG){}}else{aF.setLeft("auto");aF.setTop("auto");if(!aF["xui.svg"]){aF.setPosition("relative")}}}}}try{aF.setZIndex(1)}catch(aG){}aH._designable(aF.get(0));aF.render();P.boxing().append(aF,ay);aF=aF.get(0);aw=[aF.$xid];P.setSelectFromPanel.call(P,q(Y),aw)}var aC=aF.serialize(a),aI=aF.parent?aF.parent.alias:"canvas";delete aC.events;if(!(aF.box["xui.UI"]&&!aF.box.$initRootHidden)){aC._item=q.copy(aH.iconlist.getItemByItemId(aF.$xid),c)}S(aI,ay,aC);return aF},ai=function(az,ay,aA){D.markDirty(function(){var aB=D.getByAlias(aA.alias,c);D.iconlist.removeItems(aB.$xid);aB.destroy(c,c)},function(){var aE=aA._item&&aA._item.image,aC=aA._item&&aA._item.imageClass,aB=aA._item&&aA._item.imgStyle;var aF=q.create(q.clone(aA));D._designable(aF);var aD=aF.getUIComponents();if(aD.isEmpty()){D.iconlist.insertItems([{id:aF.$xid,imgWidth:"16",imgHeight:"16",tips:D._bldTips(aF,D.$moduleInnerMode?"":g.enable_codeEdtor?("$(RAD.designer.Dblclick to edit the code)"):""),imgStyle:aB,imageClass:aC}],d,a)}else{aD.setZIndex(1);D.getByAlias(az).append(aF,ay)}},"add module")},Q=function(){var aE=arguments.callee.page,aH=q.SC(ax);if(!aH||!aH["xui.Module"]){return}if(s().currentPage){var aI=q.getClassName(s().currentPage);if(aI==ax){q.message("You cant add one moudle into itself!");return}}var aD=new aH(),ay=P.getItemIdByDom(q.use(Y).id());aD.$inDesign=aE.$canvasXid;if(aD["xui.UIProfile"]){var aH;if(aH=q.get(s(),["curProjectConfig","$DevEnv","SpaceUnit"])){aD._spaceUnit=aH}}aD.setHost(aE.$host,aD.alias);if(q.isHash(Z)){aD.setEvents(q.clone(Z))}if(q.isHash(ac)){aD.setProperties(q.clone(ac))}var aG=aD.getUIComponents();aE._designable(aD);aD.render();if(aG.isEmpty()){aE.iconlist.insertItems([{id:aD.$xid,imgWidth:"16",imgHeight:"16",tips:aE._bldTips(aD,aE.$moduleInnerMode?"":g.enable_codeEdtor?("$(RAD.designer.Dblclick to edit the code)"):""),imgStyle:L?"background:url("+L+") imagePos":"",imageClass:R}],d,a);aE.iconlist.setUIValue(aD.$xid)}else{aG.setZIndex(1);P.boxing().append(aD,ay);aw=[aG.get(0).$xid];P.setSelectFromPanel.call(P,q(Y),aw)}var aA=aD.serialize(a),aF=P.alias||"canvas";delete aA.events;if(aG.isEmpty()){aA._item=q.copy(aE.iconlist.getItemByItemId(aD.$xid),c)}try{if(!ap.isCom){var aB=q.addChild(ap,aD,P.boxing(),aE.$host);var az=aB[0].get(0);aE._designable(az);aE.selectWidget([az.$xid])}}catch(aC){}ai(aF,ay,aA)};ah.page=D;Q.page=D;if(ax){if(ap.cls=="xui.Module"){if(q.SC.get(ax)){Q()}else{q.observableRun(function(){q.Dom.setCover(q.getRes("RAD.designer.loading")+ax);q.require(ax,Q,d,function(ay){q.alert(ay)},function(ay){q.alert(ay)},c,d,{appPath:g.adjustProtocol(s().curProjectPath)})})}}else{var I;if(q.SC.get(ax)){try{I=ah()}catch(au){}}else{q.observableRun(function(){q.Dom.setCover(q.getRes("RAD.designer.loading")+ax);q.SC(ax,ah,c)})}if(V&&ap.cls!="xui.Module"){q.addChild(ap,I.boxing(),P.boxing(),D.$host)}}}else{var ae=q.use(Y).offset(),ab=P.alias,K,O={left:m((am-ae.left)/ak)*ak,top:m((al-ae.top)/ak)*ak};aw=av;I=G.getByCacheId(aw);var ad=I.get(0).parent?I.get(0).parent.alias:"canvas",ag=I.get(0).childrenId,an,X,W;var U=[];var aq=I.get(0).getModule(c);if(aq){U.push(aq.alias);aq.getUIComponents().each(function(ay){if(ay.properties.dock!="none"){q.UI.$dock(ay,c)}});I=aq}else{I.each(function(ay){U.push(ay.alias)});D.resizer.resetTarget(I.reBoxing());var ao=I.getRoot().parent().offset(d,D.panelDiv.getRoot());D.resizer.setTopOffset(m(ao.top,10));D.resizer.setLeftOffset(m(ao.left,10));I.each(function(aA,ay){if(ay===0){if(aA.box["xui.svg"]){var az=aA.boxing()._getBBox();X=az.x;W=az.y}else{X=aA.$px(aA.properties.left);W=aA.$px(aA.properties.top)}}else{if(aA.box["xui.svg"]){var az=aA.boxing()._getBBox();X=b.min(az.x,X);W=b.min(az.y,W)}else{X=b.min(aA.$px(aA.properties.left),X);W=b.min(aA.$px(aA.properties.top),W)}}});var J=X-O.left,aa=W-O.top;I.each(function(az){if(az.properties.dock!="none"){q.UI.$dock(az,c)}else{if(az.box["xui.svg"]){var ay=az.boxing()._getBBox();delete ay.x2;delete ay.y2;ay.x-=J;ay.y-=aa;az.boxing()._setBBox(ay)}else{az.boxing().setLeft(az.$px(az.properties.left)-J).setTop(az.$px(az.properties.top)-aa)}}})}K=P.getItemIdByDom(Y);P.boxing().append(I,K);P.setSelectFromPanel.call(P,q(Y),aw);if(!ad){ad="canvas"}D.markDirty(function(){q.arr.each(U,function(az){var ay=D.getByAlias(az),aB=ay.get(0);D.getByAlias(ad).append(ay,ag);if(aB["xui.Module"]){aB.getUIComponents().each(function(aC){if(aC.properties.dock!="none"){q.UI.$dock(aC,c)}})}else{if(aB.properties.dock!="none"){q.UI.$dock(aB,c)}else{if(aB.box["xui.svg"]){var aA=ay._getBBox();delete aA.x2;delete aA.y2;aA.x+=J;aA.y+=aa;ay._setBBox(aA)}else{ay.setLeft(aB.$px(aB.properties.left)+J).setTop(aB.$px(aB.properties.top)+aa)}}}})},function(){q.arr.each(U,function(az){var ay=D.getByAlias(az),aB=ay.get(0);D.getByAlias(ab).append(ay,K);if(aB["xui.Module"]){aB.getUIComponents().each(function(aC){if(aC.properties.dock!="none"){q.UI.$dock(aC,c)}})}else{if(aB.properties.dock!="none"){q.UI.$dock(aB,c)}else{if(aB.box["xui.svg"]){var aA=ay._getBBox();delete aA.x2;delete aA.y2;aA.x-=J;aA.y-=aa;ay._setBBox(aA)}else{ay.setLeft(aB.$px(aB.properties.left)-J).setTop(aB.$px(aB.properties.top)-aa)}}}})},"change controls' parent container")}}catch(au){q.alert(au)}},beforeMousedown:function(M,O,I){if(M.moduleClass&&M.moduleXid){return}if(q.Event.getBtn(O)!="left"){return}var K=q.Event.getSrc(O).$xid;if(M.box.KEY=="xui.UI.SVGPaper"&&M.getSubNode("SVG").xid()==K){I=K=M.getRoot().xid()}if(K!==I){return}var L=q(I),P=q.Event.getPos(O),J=L.offset(),Q=L.innerWidth(),N=L.innerHeight();if(P.left-J.left>Q){return}if(P.top-J.top>N){return}M._offsetPos=J;M._scrollTop=L.scrollTop();M._scrollLeft=L.scrollLeft();D._attachResizer(M,I);M._selregion={};var P=q.Event.getPos(O);q(I).startDrag(O,{targetReposition:a,dragType:"blank",dragCursor:"crosshair",targetLeft:P.left,targetTop:P.top,dragDefer:2});M.$dragging=a;q.Event.simulateEvent(n.documentElement,"mousedown",{screenX:0,screenY:0,clientX:0,clientY:0})},onClick:function(K,L,M){var J=q.Event.getSrc(L),I=q.use(M).get(0);if(K.box.KEY=="xui.UI.SVGPaper"){J=J.parentNode}if(J!==I){return}G._clearSelect();K.setSelectFromPanel.call(K,q(M),[])},beforeDrag:function(L,N,O){if(L.moduleClass&&L.moduleXid){return}var K,I=q.DragDrop.getProfile(),P=I.offset,J=D.proxy;var M=L._selregion;if((K=P.x)<0){P.x=-K}if((K=P.y)<0){P.y=-K}M.left=b.min(I.ox,I.x)-L._offsetPos.left+L._scrollLeft;M.top=b.min(I.oy,I.y)-L._offsetPos.top+L._scrollTop;M.width=P.x;M.height=P.y;J.cssRegion(M);if(!L.$dragging){J.css("display","block");L.$dragging=c}},beforeDragstop:function(M,Z,Q){if(M.moduleClass&&M.moduleXid){return}var O=M._selregion,W=D.proxy,T=[],R,V,U,Y,L,X,K,P,J,N,I,S=q.use(Q).get(0);P=O.left;J=O.top;N=P+O.width;I=J+O.height;if(V=M.children){q.arr.each(V,function(ab,ad){ab=ab[0];var aa=ab.box["xui.svg"],ae=ab.getRootNode();if(!ae){return}var ac=ae.parentNode,af;if(aa){ac=ac.parentNode}if(ab.renderId&&ae&&ac===S&&ae.style.display!="none"&&ae.style.visibility!="hidden"){if(aa){af=ab.boxing()._getBBox();Y=af.x;L=af.y;X=Y+af.width;K=L+af.height}else{U=ab.getRoot();Y=U.offsetLeft();L=U.offsetTop();X=Y+U.width();K=L+U.height()}if(N>Y&&X>P&&I>L&&K>J&&(ab.box["xui.svg"]||!(Y<P&&X>N&&L<J&&K>I))){T.push(ab.$xid)}}});M.setSelectFromPanel.call(M,q(Q),T)}q.asyRun(function(){W.css("display","none")})},onMouseup:function(I,J,K){if(I.moduleClass&&I.moduleXid){return}q.asyRun(function(){D.proxy.css("display","none")})}};if(H=C){A={};q.arr.each(H,function(I){if(u.keys.KEY==u.keys[I]){q.merge(A,w)}else{A[I]=q.copy(w)}});if(!q.isEmpty(A)){u._CB=A;u.clearCache()}if(q.browser.isTouch){q.arr.each(H,function(I){B.getSubNode(I,c).each(function(K){var L=q.$cache.droppable,J="___iDesign";L[J]=L[J]||[];L[J].push(K.$xid)})})}}q.merge(u,{selectObject:function(K,J){var I=this,L=K.$xid;if(I.box.KEY=="xui.UI.SVGPaper"&&J.parent().get(0)==I.getRootNode()){J=J.parent()}return this.setSelectFromPanel(J,[L])},reSelectObject:function(L,K,J){var I=this;if(I.box.KEY=="xui.UI.SVGPaper"&&K.parent().get(0)==I.getRootNode()){K=K.parent()}if(!J){id=L.$xid;if(I.selected&&q.arr.indexOf(I.selected,id)!=-1){q.arr.removeValue(I.selected,id)}else{(I.selected||(I.selected=[])).push(id)}}return this.setSelectFromPanel(K,I.selected)},setSelectFromResizer:function(J){var I=this;I.selected=J;return this.resetSelectRel()},setSelectFromPanel:function(M,L){var K=this,I;q.filter(L,function(Q){var P=q.getObject(Q);if(!(P instanceof q.UIProfile)){return a}if(P.box.$initRootHidden){return a}if(!P.getModule()){I=c}});if(L.length){if(I){q.filter(L,function(Q){var P=q.getObject(Q);if(P.getModule()){return a}})}else{var N=q.getObject(L[0]);L=[];var J=N.getModule(c);if(J){J.getUIComponents().each(function(P){L.push(P.$xid)})}}}if(K.box.KEY=="xui.UI.SVGPaper"&&M.parent().get(0)==K.getRootNode()){M=M.parent()}if(G.pProfile!==K||(G.pNode&&G.pNode.id())!==(M&&M.get(0)&&M.id())){G._clearSelect();G._attachResizer(K,M)}if(G.withPathHandler){G.withPathHandler._removeHandler();delete G.withPathHandler}K.selected=L;G.resizer.resetTarget(G.getByCacheId(K.selected).reBoxing(),a);if(L[0]){var O=q.getObject(L[0]).getRoot().parent().offset(d,D.panelDiv.getRoot());G.resizer.setTopOffset(m(O.top,10));G.resizer.setLeftOffset(m(O.left,10))}return this.resetSelectRel()},resetSelectRel:function(){var J=this;if(J.selected&&J.selected.length){var I=G.resizer.get(0).properties;I.dragArgs={dragKey:"___iDesign",widthIncrement:G.dropOffset,heightIncrement:G.dropOffset,dragData:{parentId:J.$xid,data:J.selected}}}else{G._clearSelect()}q.tryF(G._WidgetsSelected,[J.selected],G);G._focus()}},"all")},_refreshProfileGrid:function(O,I,B){var E=this,R=E._cls,w=E.profileGrid,N=w.get(0),G;if(!w){return}if(!O||!O.length){G=E.canvas}else{G=E.getByCacheId(O);if(!G.get(0)){G=q.getObject(O[0]).boxing()}}if(!B&&N.$widget&&(G===N.$widget||(G.size()==1&&N.$widget.size()==1&&G.get(0)==N.$widget.get(0)))){return}N.$widget=G;if(I){return}if(g.grid_showPropBinder){if(O&&O.length===1){if(w.getHeader().length!==3){w.setHeader([{id:"key",caption:"$RAD.designer.gridcol1",width:120,type:"label"},{id:"value",caption:"$RAD.designer.gridcol2",width:100,type:"label",cellStyle:"text-indent:2px;"},{id:"binder",caption:"$RAD.designer.gridcol3",width:150,type:"label",cellStyle:"text-indent:2px;",minWidth:80,editMode:"hover",flexSize:c,disabled:c,editable:a}])}}else{if(w.getHeader().length!==2){w.setHeader([{id:"key",caption:"$RAD.designer.gridcol1",width:120,type:"label"},{id:"value",caption:"$RAD.designer.gridcol2",width:100,type:"input",flexSize:c,cellStyle:"text-indent:2px;"}])}}}var L=function(S,T){s()&&s().fe("onInitPropValueCell",[T,d,S.value,"RAD.Designer",G,S,w]);return S};if(!O||!O.length){var H=this.canvas.get(0);if(!q.get(R,["Instance","events"])){q.set(R,["Instance","events"],{})}var A=q.get(R,["Instance","events"]);if(g.getClientMode()!="project"){var Q=q.get(R,["Static","viewStyles"]);var J=[{id:"properties:width",noAPI:1,cells:[{caption:"$RAD.designer.conf.canvas.width"},L({type:"number",unit:"px",value:H.properties.width},"width")]},{id:"properties:height",noAPI:1,cells:[{caption:"$RAD.designer.conf.canvas.height"},L({type:"number",unit:"px",value:H.properties.height},"height")]},{id:"properties:theme",noAPI:1,cells:[{caption:"$RAD.designer.conf.canvas.theme"},L({type:"combobox",value:(Q&&Q.theme)||"default",editorListItems:g.designer_themes},"theme")]},{id:"properties:zoom",noAPI:1,cells:[{caption:"$RAD.designer.conf.canvas.zoom"},L({type:"combobox",value:(Q&&Q.zoom)||"",editorListItems:g.designer_zoom},"zoom")]},{id:"properties:background-color",noAPI:1,cells:[{caption:"$(RAD.custom_dlg.background$-color)"},L({type:"color",value:(Q&&Q["background-color"])||""},"background-color")]},{id:"properties:background-image",noAPI:1,cells:[{caption:"$(RAD.custom_dlg.background$-image)"},L((g.getClientMode()=="singlepage")?{type:"input",value:(Q&&Q["background-image"])||""}:(g.getClientMode()=="component")?{type:"popbox",value:(Q&&Q["background-image"])||"",event:function(V,S,T){var W=V.getSubNode("CELL",S._serialId),U=function(Y){Y=g.adjustRelativePath(Y);T.boxing().setUIValue("url("+Y+")");W.focus()};if(s()&&a===s().fe("beforeURISelectorPop",["canvas:background-image",(Q&&Q["background-image"])||"",U,"RAD.Designer",G,W.get(0),S,V.boxing(),T.boxing()])){return}if(g.getClientMode()!="singlepage"){var X=Q&&Q["background-image"]||"";q.ModuleFactory.getCom("RAD.ImageSelector",function(){this.host=E;this.setProperties({caption:"$(RAD.img.Image Selector)",image:"spafont spa-icon-gallery",text:X,fromRegion:W.cssRegion(c),onOK:function(Z,Y){U(Y)}});this.show()})}}}:{type:"popbox",value:(Q&&Q["background-image"])||"",event:function(U,S,T){var V=U.getSubNode("CELL",S._serialId);q.ModuleFactory.getCom("RAD.ImageSelector",function(){this.setProperties({fromRegion:V.cssRegion(c),onOK:function(X,W){W=g.adjustRelativePath(W);T.boxing().setUIValue("url("+W+")");V.focus()}});this.show()})}},"background-image")]},{id:"properties:background-position",noAPI:1,cells:[{caption:"$(RAD.custom_dlg.background$-position)"},L({type:"combobox",value:(Q&&Q["background-position"])||"",editorListItems:g.designer_background_position},"background-position")]},{id:"properties:background-repeat",noAPI:1,cells:[{caption:"$(RAD.custom_dlg.background$-repeat)"},L({type:"combobox",value:(Q&&Q["background-repeat"])||"",editorListItems:g.designer_background_repeat},"background-repeat")]},{id:"properties:background-attachment",noAPI:1,cells:[{caption:"$(RAD.custom_dlg.background$-attachment)"},L({type:"combobox",value:(Q&&Q["background-attachment"])||"",editorListItems:g.designer_background_attachment},"background-attachment")]}]}else{var J=[{id:"properties:width",cells:[{caption:"$RAD.designer.conf.canvas.width"},L({type:"number",unit:"px",value:H.properties.width},"width")]},{id:"properties:height",cells:[{caption:"$RAD.designer.conf.canvas.height"},L({type:"number",unit:"px",value:H.properties.height},"height")]}]}var F=[{id:"properties:autoDestroy",tipk:"prop",tipv:"autoDestroy",cells:[{caption:"$RAD.designer.conf.canvas.autoDestroy",tips:g.enable_openAPI?('<div style="background-color:#EBEADB;">'+q.getRes("RAD.designer.openapi")+"</div>"):""},L({type:"checkbox",value:false!==q.get(R,["Instance","autoDestroy"])},"autoDestroy")]},{id:"properties:properties",tipk:"prop",tipv:"properties",cells:[{caption:"$RAD.designer.conf.canvas.properties",tips:g.enable_openAPI?('<div style="background-color:#EBEADB;">'+q.getRes("RAD.designer.openapi")+"</div>"):""},L({type:"button",value:"[ $(RAD.designer.conf.Object) ]",caption:"[ $(RAD.designer.conf.Object) ]",event:function(U,S,Y,Z,V,X){var W=E.stringify(q.get(R,["Instance","properties"])||{}),T=function(ac){var ab=q.get(R,["Instance"]);if(!ab){q.set(R,["Instance"],ab={})}var aa=ab.properties;ab.properties=typeof(ac)=="string"?q.unserialize(ac):ac;E.resetCode("Instance","properties",E.stringify(ac,"        "),c,a);if(E.markDirty){E.markDirty(function(){var ad=q.get(R,["Instance"]);if(!ad){q.set(R,["Instance"],ad={})}ad.properties=aa;E.resetCode("Instance","properties",E.stringify(aa,"        "),c,a)},function(){var ad=q.get(R,["Instance"]);if(!ad){q.set(R,["Instance"],ad={})}ad.properties=ac;E.resetCode("Instance","properties",E.stringify(ac,"        "),c,a)},"set properties")}q(X).focus()};if(s()&&a===s().fe("beforeObjectEditorPop",["jsonEditor","properties",W,T,"RAD.Designer",R,q(X).get(0),U.boxing(),Y&&Y.boxing()])){return}q.getCom("RAD.JSONEditor",function(ab,aa){this.host=E;this.setProperties({imageClass:"spafont spa-icon-formatjson",caption:"$RAD.designer.conf.canvas.properties",text:W,onOK:function(ac){T(ac.properties.object)}});this.show()})}},"properties")]},{id:"functions:functions",tipk:"prop",tipv:"functions",hidden:!!E.$moduleInnerMode,cells:[{caption:"$RAD.designer.conf.canvas.functions",tips:g.enable_openAPI?('<div style="background-color:#EBEADB;">'+q.getRes("RAD.designer.openapi")+"</div>"):""},L({type:"button",value:"[ $(RAD.designer.conf.Editor) ]",caption:"[ $(RAD.designer.conf.Editor) ]",event:function(T,S,W,X,U,V){q.getCom("RAD.FunctionsEditor",function(Z,Y){this.host=E;this.setProperties({type:"page",page:E,functions:q.get(E,["_cls","Instance","functions"])});this.setEvents({onOK:function(ac){var ab=q.get(R,["Instance"]);if(!ab){q.set(R,["Instance"],ab={})}var aa=ab.functions||{};if(!aa){q.set(R,["Instance","functions"],{})}ab.functions=ac;E.resetCode("Instance","functions",E.stringify(ac,"        "),c,a);if(E.markDirty){E.markDirty(function(){var ad=q.get(R,["Instance"]);if(!ad){q.set(R,["Instance"],ad={})}ad.functions=aa;E.resetCode("Instance","functions",E.stringify(aa,"        "),c,a)},function(){var ad=q.get(R,["Instance"]);if(!ad){q.set(R,["Instance"],ad={})}ad.functions=ac;E.resetCode("Instance","functions",E.stringify(ac,"        "),c,a)},"set functions")}q(V).focus()}});this.show()})}},"functions")]}];q.filter(J,function(V,U){var S=V.id.split(":"),T=S[1]||V.id;if(g.page_hiddenPropEvents[T]){return a}if(g.page_hiddenPropEvents_filter&&a===g.page_hiddenPropEvents_filter(T)){return a}});q.filter(F,function(V,U){var S=V.id.split(":"),T=S[1]||V.id;if(g.page_hiddenPropEvents[T]){return a}if(g.page_hiddenPropEvents_filter&&a===g.page_hiddenPropEvents_filter(T)){return a}});if(!E.$moduleInnerMode){var x=E.__buildSubRows(this.canvas,"special",c,w);if(x&&x.length){q.arr.insertAny(F,x)}J.push({id:"common",group:c,caption:"<span class='xui-node-span spafont spa-icon-star' style='vertical-align:middle;font-weight: normal;height: 1em;width: 1em;vertical-align:text-bottom;'></span><span style='padding-'left':4px;'>$(RAD.designer.conf.Commonly used)</span>",sub:F});J.push({id:"UIE",group:c,caption:"<span class='xui-node-span spafont spa-icon-click' style='vertical-align:middle;font-weight: normal;height: 1em;width: 1em;vertical-align:text-bottom;'></span><span style='padding-'left':4px;'>$RAD.designer.conf.Events</span>",sub:c})}}else{if(O[0]&&q.getObject(O[0])&&q.getObject(O[0])["xui.Module"]){var H=q.getObject(O[0]),J=[];J.push({id:"key",tipk:"class",cells:[{caption:"<strong>$RAD.designer.words.class</strong>",tips:q.getRes("RAD.designer.openapi")},L({disabled:c,value:"<strong>"+H.key+"</strong>",type:"label",tips:q.getRes("RAD.designer.openapi")},"class")]});J.push({id:"alias",tipk:"fun",tipv:"setAlias",cells:[{caption:"<strong>$RAD.designer.words.alias</strong>"},L({value:H.alias,type:"input"},"alias")]});J.push({id:"properties:inner-designer",cells:[{caption:"$(RAD.designer.conf.canvas.inner$-designer)"},L({type:"button",tagVar:H,value:"[ $(RAD.designer.conf.Editor) ]",caption:"[ $(RAD.designer.conf.Editor) ]",event:function(T,S,W,X,U,V){E._decorationWnd(H,V)}},"inner-designer")]});J.push({id:"properties:properties",cells:[{caption:"$RAD.designer.conf.canvas.properties"},L({type:"button",tagVar:H,value:"[ $(RAD.designer.conf.Object) ]",caption:"[ $(RAD.designer.conf.Object) ]",event:function(T,Y,X,W,V,S){var U=q.clone(Y.tagVar.properties),Z=E.stringify(Y.tagVar.properties||{}),aa=function(ab){Y.tagVar.setProperties(ab,c);if(E.markDirty){E.markDirty(function(){Y.tagVar.setProperties(U,c)},function(){Y.tagVar.setProperties(ab,c)},"set properties")}q(S).focus()};if(s()&&a===s().fe("beforeObjectEditorPop",["jsonEditor","properties",Z,aa,"RAD.Designer",Y.tagVar.boxing(),q(S).get(0),T.boxing(),X&&X.boxing()])){return}q.getCom("RAD.JSONEditor",function(ab){this.host=E;this.setProperties({imageClass:"spafont spa-icon-property",caption:"$RAD.designer.conf.canvas.properties",text:Z,onOK:function(ac){aa(ac.properties.object)}});this.show()})}},"properties")]});q.filter(J,function(V,U){var S=V.id.split(":"),T=S[1]||V.id;if(g.page_hiddenPropEvents[T]){return a}if(g.page_hiddenPropEvents_filter&&a===g.page_hiddenPropEvents_filter(T)){return a}});if(!E.$moduleInnerMode){var F=[];var x=E.__buildSubRows(H,"special",c,w);if(x&&x.length){q.arr.insertAny(F,x)}J.push({id:"common",group:c,caption:"<span class='xui-node-span spafont spa-icon-star' style='vertical-align:middle;font-weight: normal;height: 1em;width: 1em;vertical-align:text-bottom;'></span><span style='padding-'left':4px;'>$(RAD.designer.conf.Commonly used)</span>",sub:F});J.push({id:"UIE",group:c,caption:"<span class='xui-node-span spafont spa-icon-click' style='vertical-align:middle;font-weight: normal;height: 1em;width: 1em;vertical-align:text-bottom;'></span><span style='padding-'left':4px;'>$RAD.designer.conf.Events</span>",sub:c})}}else{var K,P,u=E.getByCacheId(O),H,D=a,J=[];if(P=u._nodes.length){H=u.get(this.SelectedFocus);if(!!E.$moduleInnerMode||P>1){D=c}}else{H=q.getObject(O[0]);u=H.boxing();P=1}if(!H){return}J.push({id:"key",tipk:"class",cells:[{caption:"<strong>$RAD.designer.words.class</strong>",tips:q.getRes("RAD.designer.openapi")},L({disabled:c,value:"<strong>"+H.key+"</strong>",type:"label",tips:q.getRes("RAD.designer.openapi")},"class")]});J.push({id:"alias",tipk:"fun",tipv:"setAlias",cells:[{caption:"<strong>$RAD.designer.words.alias</strong>",tips:q.getRes("RAD.designer.openapi")},L({value:H.alias,type:"input",disabled:D},"alias")]});J.push({id:"properties:name",tipk:"property",tipv:"name",cells:[{caption:"<strong>$doc.propname.xui_absObj.name</strong>",tips:q.getRes("RAD.designer.openapi")},L({value:H.properties.name,type:"input",disabled:D},"name")]});J.push({id:"properties:desc",tipk:"property",tipv:"desc",cells:[{caption:"<strong>$doc.propname.xui_absObj.desc</strong>",tips:q.getRes("RAD.designer.openapi")},L({value:H.properties.desc,type:"input",disabled:D},"desc")]});if("locked" in H.properties){J.push({id:"properties:locked",tipk:"property",tipv:"locked",cells:[{caption:"<strong>$doc.propname.xui_UI.locked</strong>",tips:q.getRes("RAD.designer.openapi")},L({value:H.properties.locked,type:"checkbox"},"locked")]})}if("required" in H.properties){J.push({id:"properties:required",tipk:"property",tipv:"required",cells:[{caption:"<strong>$doc.propname.xui_absValue.required</strong>",tips:q.getRes("RAD.designer.openapi")},L({value:H.properties.required,type:"checkbox"},"required")]})}if(("tabindex" in H.properties)&&!H.box.$DataModel.tabindex.hidden){J.push({id:"properties:tabindex",tipk:"property",tipv:"tabindex",cells:[{caption:"<strong>$doc.propname.xui_UI.tabindex</strong>",tips:q.getRes("RAD.designer.openapi")},L({value:H.properties.tabindex,type:"spin",editMode:"hover",precision:0,step:1,min:-1,max:999999990,disabled:D},"tabindex")]})}if(("zIndex" in H.properties)&&!H.box.$DataModel.zIndex.hidden){J.push({id:"properties:zIndex",tipk:"property",tipv:"zIndex",cells:[{caption:"<strong>$doc.propname.xui_UI.zIndex</strong>",tips:q.getRes("RAD.designer.openapi")},L({value:H.properties.zIndex,type:"spin",editMode:"hover",precision:0,step:1,min:0,max:9999,disabled:D},"zIndex")]})}var C=[];if(H.box["xui.UI.FusionChartsXT"]){C=["fint","carbon","ocean","zune"]}else{if(g.CustomThemes){C=g.CustomThemes[H.key]||[]}}if(!g.enable_codeEdtor){if(H.domId&&H.box["xui.UI"]){J.push({id:"theme",tipk:"fun",tipv:"setTheme",cells:[{caption:"<strong>$RAD.designer.words.theme</strong>",tips:q.getRes("RAD.designer.openapi")},L({value:H.theme,type:"combobox",disabled:D,editorListItems:C},"theme")]})}}if(P==1){var x=E.__buildSubRows(u,"special",c,w);if(x&&x.length){J.push({id:"common",group:c,caption:"<span class='xui-node-span spafont spa-icon-star' style='vertical-align:middle;font-weight: normal;height: 1em;width: 1em;vertical-align:text-bottom;'></span><span style='padding-'left':4px;'>$(RAD.designer.conf.Commonly used)</span>",sub:x})}}J.push({id:"properties",group:c,caption:"<span class='xui-node-span spafont spa-icon-property' style='vertical-align:middle;font-weight: normal;height: 1em;width: 1em;vertical-align:text-bottom;'></span><span style='padding-'left':4px;'>$RAD.designer.conf.Properties</span>",sub:c});if(!E.$moduleInnerMode&&P==1){if(H.box&&!q.isEmpty(H.box.$EventHandlers)){J.push({id:"UIE",group:c,caption:"<span class='xui-node-span spafont spa-icon-click' style='vertical-align:middle;font-weight: normal;height: 1em;width: 1em;vertical-align:text-bottom;'></span><span style='padding-'left':4px;'>$RAD.designer.conf.Events</span>",sub:c})}}if(!E.$moduleInnerMode&&g.enable_codeEdtor){if(H.domId&&H.box["xui.UI"]){J.push({id:"others",group:c,caption:"$RAD.designer.conf.Others",sub:[{id:"domId",tipk:"fun",tipv:"setDomId",value:"setDomId",cells:[{caption:"$RAD.designer.words.domId",tips:q.getRes("RAD.designer.openapi")},{value:H.domId,type:"input",disabled:D}]},{id:"theme",tipk:"fun",tipv:"setTheme",cells:[{caption:"$RAD.designer.words.theme",tips:q.getRes("RAD.designer.openapi")},{value:H.theme,type:"combobox",disabled:D,editorListItems:C}]}]})}}}}w.removeAllRows();s()&&s().fe("onInitEditorRows",[d,d,G.get(0).properties,"RAD.Designer",G,J,w]);w.setRows(J);var M=E.propFilter.getUIValue();if(!M){w.toggleRow("common",c);w.toggleRow("properties",c);if(!E.$moduleInnerMode){w.toggleRow("UIE",c)}}},markDirty:function(w,x,u){var A=this;A._dirty=c;A.fireEvent("onValueChanged",[A,c],A.host);if(x&&w){A._recordHistory(w,x,u)}},clearDirty:function(w){var u=this;u._dirty=u._canvaseventdirty=u._desingviewdirty=u._styledirty=a;u._resetHistory();u.fireEvent("onValueChanged",[u,a,w],u.host)},_undoDepth:50,_undoHistory:d,_undoPointer:0,_recordHistory:function(w,x,u){var A=this;if(!A._undoHistory){A._undoHistory=[]}if(A._undoPointer<A._undoHistory.length-1){A._undoHistory.splice(A._undoPointer+1)}while(A._undoHistory.length>=A._undoDepth){A._undoHistory.shift()}A._undoHistory.push({undo:w,redo:x,tips:u});A._undoPointer=A._undoHistory.length-1;q.resetRun("desingerredoundo",function(){if(!A.toolbar){return}A.toolbar.updateItem("undo",{disabled:a,tips:q.wrapRes("$RAD.designer.tool.undo")+" : "+A._undoHistory[A._undoPointer].tips});A.toolbar.updateItem("redo",{disabled:c,tips:d})})},_resetHistory:function(w){var u=this;if(!u._undoHistory){u._undoHistory=[]}q.breakO(u._undoHistory,2);u._undoPointer=u._undoHistory.length=0;if(w){return}q.resetRun("desingerredoundo",function(){if(!u.toolbar){return}u.toolbar.updateItem("undo",{disabled:c,tips:d});u.toolbar.updateItem("redo",{disabled:c,tips:d})})},_redo:function(A){var u=this;u._clearSelect();u._setSelected([],c);if(u._undoPointer>=u._undoHistory.length-1){return}var w=u._undoHistory[u._undoPointer+1];u.toolbar.updateItem("undo",{disabled:c,tips:d});u.toolbar.updateItem("redo",{disabled:c,tips:d});try{q.tryF(w.redo,[],u);u._undoPointer++;q.resetRun("desingerredoundo",function(){if(!u.toolbar){return}u.toolbar.updateItem("undo",{disabled:a,tips:q.wrapRes("$RAD.designer.tool.undo")+" : "+u._undoHistory[u._undoPointer].tips});var C=u._undoPointer>=u._undoHistory.length-1;var B=C?d:(q.wrapRes("$RAD.designer.tool.redo")+" : "+u._undoHistory[u._undoPointer+1].tips);u.toolbar.updateItem("redo",{disabled:C,tips:B});if(A&&B){q.Tips.show(A,B)}else{q.Tips.hide()}})}catch(x){q.echo(w.undo+"",w.redo+"",x.toString());u._resetHistory()}finally{u.markDirty()}},_undo:function(A){var u=this;u._styledirty=c;u._clearSelect();u._setSelected([],c);if(u._undoPointer<0){return}if(u._undoPointer>=u._undoHistory.length){u._undoPointer=u._undoHistory.length-1}var w=u._undoHistory[u._undoPointer];u.toolbar.updateItem("undo",{disabled:c,tips:d});u.toolbar.updateItem("redo",{disabled:c,tips:d});try{q.tryF(w.undo,[],u);u._undoPointer--;q.resetRun("desingerredoundo",function(){if(!u.toolbar){return}var B=u._undoPointer<0?d:(q.wrapRes("$RAD.designer.tool.undo")+" : "+u._undoHistory[u._undoPointer].tips);u.toolbar.updateItem("undo",{disabled:u._undoPointer<0,tips:B});u.toolbar.updateItem("redo",{disabled:a,tips:q.wrapRes("$RAD.designer.tool.redo")+" : "+u._undoHistory[u._undoPointer+1].tips});if(A&&B){q.Tips.show(A,B)}else{q.Tips.hide()}})}catch(x){q.echo(w.undo+"",w.redo+"",x);u._resetHistory()}finally{u.markDirty()}},"$toolbar_onclick":function(u,w,A,x,B){this._toolbaraction(w,A,x,B)},_toolbaraction:function(T,O,aq,R){var x=this,Z=T.id;switch(O.id){case"inter":if(Z=="intermap"){x.toInterMap()}break;case"tocode":if(Z=="tocode"&&x.toCodeView){x.toCodeView()}break;case"componentmenu":if(!ns.ViewMenuBar){ns.ViewMenuBar={}}if(!ns.ViewMenuBar[T.id]){q.create("xui.APICaller").setHost(ns,"getActions").setProperties("src",R).setResponseDataTarget([{type:"popmenu",name:"pagectx",path:"data"}]).setQueryArgs({viewBarId:T.id,pos:{src:R}}).setResponseCallback().setQueryURL("/radplugins/getActions").invoke()}else{ns.ViewMenuBar[T.id].pop(R)}break;case"debugpreview":switch(Z){case"publicRemote":am={projectName:s().curProjectName,currentClassName:s().currentPage};q.showModule2("dsm.view.config.entity.rebuildModuleView",null,null,am);break;case"publicLocal":am={projectName:s().curProjectName,currentClassName:s().currentPage};q.showModule2("dsm.view.config.entity.DSMModuleView",null,null,am);break;case"version":var F=SPA.tabsMain,Z=F.getUIValue(),al=F.getItemByItemId(Z),am={path:al.id};q.ModuleFactory.getModule("RAD.VersionManager",function(){this.show(null,null,null,null,am)});break;case"preview":if(g.getClientMode()!="project"){g.previewPage2(s())}else{if(g.clientType&&g.clientType=="ESDClient"){g.debugApp("/debug/"+s().curProjectName+"/",q.getClassName(s().currentPage)+".cls",{rand:q.rand(),width:x.canvas.getWidth(),height:x.canvas.getHeight(),theme:q.get(s(),["curProjectConfig","$PageAppearance","theme"])||"",ficdn:q.get(s(),["curProjectConfig","$FontIconsCDN"])||"",lang:q.getLang()},c)}else{g.debugApp("/debug/"+s().curProjectName+"/","debug.html",{rand:q.rand(),width:x.canvas.getWidth(),height:x.canvas.getHeight(),touch:x.$touchdivce||0,cls:q.getClassName(s().currentPage.replace(s().curProjectPath+"/","")),theme:q.get(s(),["curProjectConfig","$PageAppearance","theme"])||"",ficdn:q.get(s(),["curProjectConfig","$FontIconsCDN"])||"",lang:q.getLang()},c)}}break}break;case"undoredo":switch(Z){case"undo":x._undo(q.Event.getPos(aq));break;case"redo":x._redo(q.Event.getPos(aq));break;case"refresh":var P=x._dirty;x.refreshView(x.getJSCode(x.getWidgets(c)),c);if(P){x.markDirty()}q.message(q.getRes("RAD.designer.refreshOK"));break}break;case"view":switch(Z){case"viewsize":x.popViewSize.pop(R);break;case"mobile":x.setMobileFrame(T.value,a);if(g.getClientMode()!="project"){x._desingviewdirty=c}break}break;case"codegroup":switch(Z){case"datacode":x.popData.pop(R);return;case"jscode":case"json":case"prfs":case"data":case"value":var af,ac,D,X={},at=x.getByCacheId(x.tempSelected);if(!at.isEmpty()){ac=[];at.each(function(av){av=(av["xui.Module"]?av:av.getModule(c))||av;if(X[av.alias]){return}X[av.alias]=1;ac.push(av)})}else{ac=x.getWidgets(c)}switch(Z){case"jscode":D=x.getJSCode(ac);D="(function Code(){\n    "+D.replace(/(\r\n|\n)/g,"$1    ")+"\n}());";break;case"json":D=q.Coder.formatText(x.getJSONCode(ac),"js");break;case"prfs":var G=new q.Module(),D=x.getJSCode(ac);G.iniComponents=new Function([],D);D=q.Coder.formatText(q.stringify(G.getProfile()),"js");G.destroy(c,c);G=d;break;case"data":var G=new q.Module(),D=x.getJSCode(ac);G.iniComponents=new Function([],D);D=q.Coder.formatText(q.stringify(G.getData()),"js");G.destroy(c,c);G=d;break;case"value":var G=new q.Module(),D=x.getJSCode(ac);G.iniComponents=new Function([],D);D=q.Coder.formatText(q.stringify(G.getValue(c)),"js");G.destroy(c,c);G=d;break}if(s()&&a===s().fe("beforeObjectEditorPop",["objectEditor",Z,D,function(){},"RAD.Designer",x,q(R).get(0)])){return}q.showCom("RAD.ObjectEditor2",function(){},function(){this._codetype=Z=="jscode"?"js":"json";this.setValue(D)});break}break;case"aligngroup":if(Z=="align"){x.popAlign.pop(R);return}var U=x.getByCacheId(this.tempSelected);var ak=U.get(this.SelectedFocus),al=ak.getRoot(),H,V,W,C,ar,I,u,ao,aj,ag=[],Y=[];C=ak.box["xui.svg"];if(C){I=ak.boxing()._getBBox();H={width:b.round(I.width),height:b.round(I.height)};V={left:b.round(I.x),top:b.round(I.y)}}else{H=al.cssSize();V=al.cssPos()}U.each(function(aA){if(aA.locked){return}if(aA.properties&&aA.properties.locked){return}var aw,az,ay,av,ax;aw=aA.alias;C=aA.box["xui.svg"];if(C){W=aA.boxing();ar={};switch(Z){case"left":ar.x=V.left;break;case"center":ar.x=V.left+H.width/2-W.getWidth()/2;break;case"right":ar.x=V.left+H.width-W.getWidth();break;case"top":ar.y=V.top;break;case"middle":ar.y=V.top+H.height/2-W.getHeight()/2;break;case"bottom":ar.y=V.top+H.height-W.getHeight();break;case"w":case"wh":case"h":ar.width=H.width;ar.height=H.height;break}x._refresh(aw,"bBox",d,ar);ag.push(function(){x._refresh(aw,"bBox",d,ar,a)});Y.push(function(){x._refresh(aw,"bBox",d,I,a)})}else{W=aA.getRoot();ao=W.cssPos();aj=W.cssSize();switch(Z){case"left":if((az=V.left-ao.left)){x._refresh(aw,"left",{left:az});ag.push(function(){x._refresh(aw,"left",{left:az},d,a)});Y.push(function(){x._refresh(aw,"left",{left:-az},d,a)})}break;case"center":if((az=V.left+H.width/2-aj.width/2-ao.left)){x._refresh(aw,"left",{left:az});ag.push(function(){x._refresh(aw,"left",{left:az},d,a)});Y.push(function(){x._refresh(aw,"left",{left:-az},d,a)})}break;case"right":if((az=V.left+H.width-aj.width-ao.left)){x._refresh(aw,"left",{left:az});ag.push(function(){x._refresh(aw,"left",{left:az},d,a)});Y.push(function(){x._refresh(aw,"left",{left:-az},d,a)})}break;case"top":if((ay=V.top-ao.top)){x._refresh(aw,"top",{top:ay});ag.push(function(){x._refresh(aw,"top",{top:ay},d,a)});Y.push(function(){x._refresh(aw,"top",{top:-ay},d,a)})}break;case"middle":if((ay=V.top+H.height/2-aj.height/2-ao.top)){x._refresh(aw,"top",{top:ay});ag.push(function(){x._refresh(aw,"top",{top:ay},d,a)});Y.push(function(){x._refresh(aw,"top",{top:-ay},d,a)})}break;case"bottom":if((ay=V.top+H.height-aj.height-ao.top)){x._refresh(aw,"top",{top:ay});ag.push(function(){x._refresh(aw,"top",{top:ay},d,a)});Y.push(function(){x._refresh(aw,"top",{top:-ay},d,a)})}break;case"w":if((av=H.width-aj.width)){x._refresh(aw,"width",{width:av});ag.push(function(){x._refresh(aw,"width",{width:av},d,a)});Y.push(function(){x._refresh(aw,"width",{width:-av},d,a)})}break;case"wh":if((av=H.width-aj.width)||(ax=H.height-aj.height)){x._refresh(aw,"width",{width:av});x._refresh(aw,"height",{height:ax});ag.push(function(){x._refresh(aw,"width",{width:av},d,a);x._refresh(aw,"height",{height:ax},d,a)});Y.push(function(){x._refresh(aw,"width",{width:-av},d,a);x._refresh(aw,"height",{height:-ax},d,a)})}break;case"h":if((ax=H.height-aj.height)){x._refresh(aw,"height",{height:ax});ag.push(function(){x._refresh(aw,"height",{height:ax},d,a)});Y.push(function(){x._refresh(aw,"height",{height:-ax},d,a)})}break}}});this.resizer.rePosSize();this._focus();x.markDirty(function(){q.arr.each(Y,function(av){q.tryF(av)})},function(){q.arr.each(ag,function(av){q.tryF(av)})},"set controls' "+((Z=="w"||Z=="h"||Z=="wh")?"size":"position"));break;case"pos":var U=x.getByCacheId(this.tempSelected),M=0,Y=[],ag=[];U.each(function(av){var aD=av.alias,aE=av.boxing(),ax=aE.reBoxing();switch(Z){case"zindex1":var aw;if(av.locked){return}if(av.properties&&av.properties.locked){return}if(av.box["xui.svg"]){av.boxing().toFront();ag.push(function(){var aM=x.getByAlias(aD);aM.toFront()});Y.push(function(){var aM=x.getByAlias(aD);aM.toBack()})}else{if(!M){M=ax.topZindex()}aw=ax.css("zIndex");var aF=function(){x.getByAlias(aD).getRoot().css("zIndex",M+1);x.profileGrid.updateCellByRowCol("properties:zIndex","value",{value:M+1})};aF();ag.push(aF);Y.push(function(){x.getByAlias(aD).getRoot().css("zIndex",aw);x.profileGrid.updateCellByRowCol("properties:zIndex","value",{value:aw})});x._refresh(aE,"zIndex")}break;case"zindex2":if(av.locked){return}if(av.properties&&av.properties.locked){return}if(av.box["xui.svg"]){av.boxing().toBack();ag.push(function(){var aM=x.getByAlias(aD);aM.toBack()});Y.push(function(){var aM=x.getByAlias(aD);aM.toFront()})}else{aw=ax.css("zIndex");var aF=function(){x.getByAlias(aD).getRoot().css("zIndex",0);x.profileGrid.updateCellByRowCol("properties:zIndex","value",{value:0})};aF();ag.push(aF);Y.push(function(){x.getByAlias(aD).getRoot().css("zIndex",aw);x.profileGrid.updateCellByRowCol("properties:zIndex","value",{value:aw})});x._refresh(aE,"zIndex")}break;case"order_up":if(av.locked){return}if(av.properties&&av.properties.locked){return}if(!av.box["xui.svg"]){var aH=av.getRoot(),az=aH.prev();while(az.n0&&!q.UIProfile.getFromDom(az.id())){az=az.prev()}if(!aH.isEmpty()&&!az.isEmpty()){aH.swap(az);aH.parent().children().each(function(aN,aM){if(aN=q.UIProfile.getFromDom(aN.id)){aN.properties._dockOrder=aM+1}});x._sortchildren(av.parent.children,true);av.boxing().adjustDock(true);q.asyRun(function(){if(x.resizer){x.resizer.rePosSize()}})}}break;case"order_down":if(av.locked){return}if(av.properties&&av.properties.locked){return}if(!av.box["xui.svg"]){var aH=av.getRoot(),aC=aH.next();while(aC.n0&&!q.UIProfile.getFromDom(aC.id())){aC=aC.next()}if(!aH.isEmpty()&&!aC.isEmpty()){aH.swap(aC);aH.parent().children().each(function(aN,aM){if(aN=q.UIProfile.getFromDom(aN.id)){aN.properties._dockOrder=aM+1}});x._sortchildren(av.parent.children,true);av.boxing().adjustDock(true);q.asyRun(function(){if(x.resizer){x.resizer.rePosSize()}})}}break;case"repos":case"resize":if(av.locked){return}if(av.properties&&av.properties.locked){return}var aA=x.dropOffset;if(av.box["xui.svg"]){var aL=aE._getBBox(),aG={};aG.x=m(aL.x/aA)*aA;aG.y=m(aL.y/aA)*aA;if(Z=="resize"){aG.width=m((aL.width+aA-1)/aA)*aA;aG.height=m((aL.height+aA-1)/aA)*aA}x._refresh(aD,"bBox",d,aG);x.resizer.rePosSize();ag.push(function(){x._refresh(aD,"bBox",d,aG,a)});Y.push(function(){x._refresh(aD,"bBox",d,aL,a)})}else{var ay=ax.left(),aK=ax.top(),aJ,aB;if(Z=="resize"){aJ=ax.width();aB=ax.height()}var aF=function(){var aM=x.getByAlias(aD).getRoot();aM.left(m(ay/aA)*aA).top(m(aK/aA)*aA);if(Z=="resize"){aM.width((m((aJ+aA-1)/aA))*aA).height((m((aB+aA-1)/aA))*aA)}},aI=function(){var aM=x.getByAlias(aD).getRoot();aM.left(ay).top(aK);if(Z=="resize"){aM.width(aJ).height(aB)}};aF();Y.push(aI);ag.push(aF);x._refresh(aE,"left");x._refresh(aE,"top");x._refresh(aE,"width");x._refresh(aE,"height");x.resizer.rePosSize()}break}});x.markDirty(function(){q.arr.each(Y,function(av){q.tryF(av)})},function(){q.arr.each(ag,function(av){q.tryF(av)})},"set controls' "+(Z=="resize"?"size":"position"));this._focus();break;case"copyclone":if(!x.$moduleInnerMode){if("delete"==Z){this._deleteSelected()}else{if("cut"==Z||"copy"==Z){var R=x.getByCacheId(this.tempSelected);if(R.isEmpty()){R=q.getObject(x.tempSelected[0]);R=R.boxing()}var A=R.get(0).getModule(c);if(A){R=A}var T;if(T=x.iconlist.getItemByItemId(R.get(0).$xid)){s().__tempitem=q.clone(T,c)}var ab=R.clone();ab.each(function(av){x._designable(av)});if(A){ab.render()}q.message(q.getRes("RAD.designer."+("cut"==Z?"cutOK":"copyOK"),ab.size()));s().__copied=ab;var B=s().__pasteDlg;if(!B){B=s().__pasteDlg=q.pop(q.wrapRes("RAD.designer.clipboard"),"<div style='position:relative;overflow:auto;width:200px;height:100px;'></div>",d,20,20);B.setResizer(c).setMinBtn(c).onDestroy(function(){delete s().__copied;delete s().__pasteDlg;delete s().__tempitem;q.message(q.wrapRes("RAD.designer.clearClipboard"))});B.getRoot().css("opacity",0.75).onMouseover(function(av,aw,ax){q(ax).css("opacity",1)}).onMouseout(function(av,aw,ax){q(ax).css("opacity",0.75)})}B.setHtml("",c);var ap=new q.UI.Block({dock:"fill",overflow:"auto",borderType:"inset"});ap.append(R.clone());B.append(ap);if("cut"==Z){this._deleteSelected(c)}}else{if("clone"==Z){var au=[],aa,R=x.getByCacheId(this.tempSelected),X=[],N=[];if(R.isEmpty()){R=q.getObject(x.tempSelected[0]);R=R.boxing()}var A=R.get(0).getModule(c);if(A){R=A}var J=R.get(0).parent?R.get(0).parent.alias:"canvas",L=R.get(0).childrenId,ab=R.clone();ab.each(function(av){x._designable(av)});if(A){ab.render()}ab.each(function(aA,ax){aA.$inDesign=x.$canvasXid;if(aA["xui.UIProfile"]){var aw;if(aw=q.get(s(),["curProjectConfig","$DevEnv","SpaceUnit"])){aA._spaceUnit=aw}}var av;var ay;if(ay=x.iconlist.getItemByItemId(R.get(ax).$xid)){av=q.clone(ay,c)}else{if(aA.box["xui.svg"]){var aC=R.get(ax).boxing()._getBBox();aC.x+=10;aC.y+=10;delete aC.x2;delete aC.y2;aA.boxing()._setBBox(aC)}else{var aB=aA.properties;if(m(aB.left)||aB.left===0){aB.left=q.CSS.$addpx(aB.left,10,aA.getRootNode())}if(m(aB.top)||aB.top===0){aB.top=q.CSS.$addpx(aB.top,10,aA.getRootNode())}}}var az=aA.serialize(a);delete az.events;if(av){az._item=av}X.push(aA.alias);N.push(az);x._designable(aA);if(aA["xui.Module"]?aA.getUIComponents().isEmpty():aA.box["xui.UI"]?aA.box.$initRootHidden:c){x.iconlist.insertItems([{id:aA.$xid,imgWidth:"16",imgHeight:"16",tips:x._bldTips(aA,x.$moduleInnerMode?"":g.enable_codeEdtor?("$(RAD.designer.Dblclick to edit the code)"):""),imgStyle:az._item.imgStyle,imageClass:az._item.imageClass}],d,a);x.iconlist.setUIValue(aA.$xid);if(aA.box["xui.UI"]){x.canvas.append(aA)}}else{x.getByAlias(J).append(aA,L)}au.push(aA.$xid)});x.selectWidget(au);q.message(q.getRes("RAD.designer.colneOK",ab.size()));var K=function(){q.arr.each(N,function(ay){var ax=ay._item&&ay._item.image,aw=ay._item&&ay._item.imageClass,av=ay._item&&ay._item.imgStyle;var az=q.create(q.clone(ay));az=az.get(0);x._designable(az);if(az.box["xui.Module"]?az.getUIComponents().isEmpty():az.box["xui.UI"]?az.box.$initRootHidden:c){x.iconlist.insertItems([{id:az.$xid,imgWidth:"16",imgHeight:"16",tips:x._bldTips(az,x.$moduleInnerMode?"":g.enable_codeEdtor?("$(RAD.designer.Dblclick to edit the code)"):""),imgStyle:av,imageClass:aw}],d,a);if(az.box["xui.UI"]){x.canvas.append(az)}}else{x.getByAlias(J).append(az,L)}})},S=function(){q.arr.each(N,function(aw){var av=x.getByAlias(aw.alias);av.each(function(ax){if(x.iconlist.getItemByItemId(ax.$xid)){x.iconlist.removeItems([ax.$xid])}});av.destroy(c,c)})};x.markDirty(S,K,"clone controls")}}}}break;case"pastefun":if(!x.$moduleInnerMode){if("paste"==Z){if(s().__copied){var U=this.tempSelected,an,au=[],E;if(!U||U.length==0||(U.length===1&&(an=x.getByCacheId(U))&&an.get(0)&&an.get(0).boxing().getDropKeys)){var J=(!U||U.length==0)?"canvas":an.get(0).alias,L=(an&&an.getUIValue)?an.getUIValue():d,X=[],N=[];var ab=s().__copied.clone();ab.each(function(aA,ax){aA.$inDesign=x.$canvasXid;if(aA["xui.UIProfile"]){var aw;if(aw=q.get(s(),["curProjectConfig","$DevEnv","SpaceUnit"])){aA._spaceUnit=aw}}var av;if(aA["xui.Module"]?aA.getUIComponents().isEmpty():aA.box["xui.UI"]?aA.box.$initRootHidden:c){av=q.clone(s().__tempitem,c)}else{if(aA.box["xui.svg"]){var az=x.getByAlias(J,c);if(!az||az.box.KEY!="xui.UI.SVGPaper"){q.message(q.getRes("RAD.designer.msg.SVG control $0 cant paste to normal container-"+aA.alias));return}}else{var aC=aA.properties;if(m(aC.left)||aC.left===0){aC.left=q.CSS.$addpx(aC.left,10,aA.getRootNode())}if(m(aC.top)||aC.top===0){aC.top=q.CSS.$addpx(aC.top,10,aA.getRootNode())}}}var ay=aA.serialize(a);delete ay.events;if(av){ay._item=av}X.push(aA.alias);N.push(ay);x._designable(aA);if(aA["xui.Module"]?aA.getUIComponents().isEmpty():aA.box["xui.UI"]?aA.box.$initRootHidden:c){x.iconlist.insertItems([{id:aA.$xid,imgWidth:"16",imgHeight:"16",tips:x._bldTips(aA,x.$moduleInnerMode?"":g.enable_codeEdtor?("$(RAD.designer.Dblclick to edit the code)"):""),imgStyle:ay._item.imgStyle,imageClass:ay._item.imageClass}],d,a);x.iconlist.setUIValue(aA.$xid);if(aA.box["xui.UI"]){x.canvas.append(aA)}}else{x.getByAlias(J).append(aA,L)}if(aA["xui.Module"]?aA.getUIComponents().isEmpty():aA.box["xui.UI"]?aA.box.$initRootHidden:c){}else{if(aA.box["xui.svg"]){var aB=aA.boxing()._getBBox();aB.x+=10;aB.y+=10;delete aB.x2;delete aB.y2;aA.boxing()._setBBox(aB)}}au.push(aA.$xid)});x.selectWidget(au);q.message(q.getRes("RAD.designer.pasted",ab.size()));var K=function(){q.arr.each(N,function(ay){var ax=ay._item&&ay._item.image,aw=ay._item&&ay._item.imageClass,av=ay._item&&ay._item.imgStyle;var az=q.create(q.clone(ay));az=az.get(0);x._designable(az);if(az["xui.Module"]?az.getUIComponents().isEmpty():az.box["xui.UI"]?az.box.$initRootHidden:c){x.iconlist.insertItems([{id:az.$xid,imgWidth:"16",imgHeight:"16",tips:x._bldTips(az,x.$moduleInnerMode?"":g.enable_codeEdtor?("$(RAD.designer.Dblclick to edit the code)"):""),imgStyle:av,imageClass:aw}],d,a);if(az.box["xui.UI"]){x.canvas.append(az)}}else{x.getByAlias(J).append(az,L)}})},S=function(){q.arr.each(N,function(aw){var av=x.getByAlias(aw.alias);av.each(function(ax){if(ax.box["xui.Module"]?ax.getUIComponents().isEmpty():ax.box["xui.UI"]?ax.box.$initRootHidden:c){x.iconlist.removeItems([ax.$xid])}});av.destroy(c,c)})};x.markDirty(S,K,"paste controls")}}else{q.message(q.wrapRes("RAD.designer.clearClipboard"))}}}break;case"svgpath":var ai,ad,ah;if(x.tempSelected&&x.tempSelected.length==1){ai=q.getObject(x.tempSelected[0]);if(ai&&ai.box["xui.svg"]){ad=ai._elset[0];ah=ad.attr("path")}}if(!ah){return}if(Z=="pathedit"){x._editSVGPath(ai);return}var ae=ai.alias,Q=ah.join("");switch(Z){case"vmirror":ah=q.svg.$transform(Q,"s1,-1");break;case"r90":ah=q.svg.$transform(Q,"r90");break;case"hmirror":ah=q.svg.$transform(Q,"s-1,1");break;case"r270":ah=q.svg.$transform(Q,"r270");break;case"freeze":var w=ad.attr("transform");if(w&&w.length>=1){ah=q.svg.$transform(Q,w);ad.attr("transform","")}else{return}break}ai.boxing().setAttr("KEY",{path:ah},a,c);x.$tryToRefreshSel(ai);x.markDirty(function(){x.getByAlias(ae).setAttr("KEY",{path:Q},a,c)},function(){x.getByAlias(ae).setAttr("KEY",{path:ah},a,c)},"set svg path");break}},"$profilegrid_cmd":function(B,K,N,u,H){var F=this;switch(H){case"delete":var C=K.$tagVar,A=C._eventkey;if(A){var E=C.target,G=C.funname,x=F.canvas,I=E===(x&&x.get(0))||E._isCanvas;var M,D;if(I){var w=q.get(F._cls,["Instance","events"]);if(!w){q.set(F._cls,["Instance","events"],w={})}M=w[A]}else{if(E["xui.Module"]){M=E.events[A]}else{M=E[A]}}q.confirm(q.getRes("RAD.designer.confirmdel"),q.getRes("RAD.action.Do you wanna delete the event handler")+"?",function(){F.markDirty(function(){if(I){var O=q.get(F._cls,["Instance","events"]);if(!O){q.set(F._cls,["Instance","events"],O={})}O[A]=M;F._canvaseventdirty=c}else{if(E["xui.Module"]){E.events[A]=M}else{E[A]=M}}},D=function(){if(I){var O=q.get(F._cls,["Instance","events"]);if(!O){q.set(F._cls,["Instance","events"],O={})}delete O[A];F._canvaseventdirty=c}else{if(E["xui.Module"]){E.events[A]=d}else{E[A]=d}}},"set event");D();if(G){delete K.funname;q.alert(q.getRes("RAD.action.All event actions and handler were deleted, but function '$0' was preserved in the code",G)+"!")}else{q.alert(q.getRes("RAD.action.All actions were deleted")+"!")}K.value=K.$tagVar.funname="";if(K._editor){K._editor.setValue("",c);K._editor.setCaption("")}B.boxing().updateCell(K,{caption:""})})}return a;case"spafont spa-icon-function":var L=K.value,J=B;var E=B.$widget.get(F.SelectedFocus<=0?0:F.SelectedFocus);F._showExpressionEditor(L,function(O,P){J.boxing().updateCell(K,{value:P});E.setProperties("expression",P);F.markDirty(function(){J.boxing().updateCell(K,{value:L});E.setProperties("expression",L)},function(){J.boxing().updateCell(K,{value:P});E.setProperties("expression",P)},"modify value")});case"pop":var C=K.$tagVar;if(C){if(C.prop=="sandboxTheme"){q.getModule("RAD.ThemeRoller",function(Q,P){var O=C.profile.boxing();P.setTargetContainer(O,N.boxing().getValue());P.render(c);P.getRoot().popToTop(u).setBlurTrigger("design:pop:themeroller",function(){P.destroy()});this.setEvents("onChange",function(R,S,T){var U=S?R:(T||"");if(N){N.boxing().setValue(U,c)}B.boxing().updateCell(K,{value:U},a,a);O.setSandboxTheme(U)})})}else{if(C.prop=="imageClass"){q.getModule("RAD.SelFontAwesome",function(P,O){O.render(c);O.getRoot().popToTop(u).setBlurTrigger("design:pop:SelFontAwesome",function(){O.destroy()});this.setEvents("onSel",function(Q){if(N){N.boxing().setUIValue(Q)}else{B.boxing().updateCell(K,{value:Q})}})})}}}break;default:var C=K.$tagVar;if(C.prop=="excelCellId"){if(!/\s*[A-Z]+\s*[0-9]+\s*/.test(N.properties.$UIvalue)){q.alert("The excel cell id is invalid")}else{q.alert("It's a valid excel cell id!")}}else{if(C.prop=="excelCellFormula"||C.prop=="gridValueFormula"){if(!q.ExcelFormula.validate(N.properties.$UIvalue)){q.alert("The excel formula is invalid")}else{q.alert("It's a valid excel formula!")}}}}},"$showActionEditor":function(D,P,J,E,I,x,C,F,L){var A={},H=P._$canvas||P===(D.canvas&&D.canvas.get(0)),O;if(H){var u=q.get(D._cls,["Instance","events"]);if(!u){q.set(D._cls,["Instance","events"],u={})}O=A.actionConf=u[J]}else{if(P["xui.Module"]){O=A.actionConf=P.events[J]}else{O=A.actionConf=P[J]}}A.target=P;A.parent=D;A.cls=D._cls;A.className=D._className;A._eventkey=J;A._selected=I;A._cap=E;if(g.getClientMode()=="project"&&s().treebarCls){A.pages=q.clone(s().treebarCls.getItems(),c)}var G=[],K={},M=function(T){var U=T.properties,S=(T["xui.Module"]||T.moduleClass)?"module":"control",Q=T.key.split(".").pop(),R;if(S=="module"){R=T.getAlias()+" ( "+T.key+" )"}else{R=T.alias+" ( "+Q+" )";if(U.name||U.desc){R+=" <br />[ "+(U.name||"")+(U.name?" - ":"")+(U.desc||"")+" ]"}if(U.caption||U.labelCaption){R+=" [ "+(U.caption||U.labelCaption)+" ]"}}return R},N=function(S,U,R){var Z=arguments.callee,W=(S["xui.Module"]||S.moduleClass)?"module":"control",aa=S.key.split(".").pop(),Y=W=="module"?{imageClass:"xuicon spafont spa-icon-page"}:R[S.box.KEY],T,V;if(W=="module"){if(K[V=S.moduleClass+"["+S.moduleXid+"]"]){return}K[V]=1;S=q.Module.getInstance(S)}var X={id:S.alias,caption:M(S),image:Y&&Y.image||"",imagePos:Y&&Y.imagePos||"",imageClass:Y&&Y.imageClass||"","0":S,_type:W};if(P==S){X.caption="<strong>"+X.caption+"</strong>"}U.push(X);if(W=="module"){return}if(S.children&&S.children.length){var Q=[];X.sub=Q;q.arr.each(S.children,function(ab){Z.call(d,ab[0],Q,R)})}};N(D.canvas.get(0),G,g.mapWidgets);if(!G[0].sub){G[0].sub=[]}q.each(D.$host,function(T,S){if(S=="$inDesign"||!T["xui.absBox"]||!T.n0){return}var R=T.get(0),Q=g.mapWidgets,W,X;if(R["xui.Module"]?R.getUIComponents().isEmpty():R.box["xui.UI"]?R.box.$initRootHidden:c){if(-1==q.arr.subIndexOf(G[0].sub,"id",R.alias)){var V=R["xui.Module"]?"module":"control",Y=R.key.split(".").pop(),X=V=="module"?{imageClass:"xuicon spafont spa-icon-page"}:Q[R.box.KEY],U,W={id:R.alias,caption:M(R),image:X&&X.image||"",imagePos:X&&X.imagePos||"",imageClass:X&&X.imageClass||"","0":R,_type:V};if(P==R){W.caption="<strong>"+W.caption+"</strong>"}G[0].sub.push(W)}}});A.controls=G[0].sub||[];A.argsdoc=q.get(RAD.EditorTool.getDoc(P.key+".prototype."+J,d,c),["$paras"]);A.args=q.fun.args(P.box.$EventHandlers[J]);A.argsvar=RAD.ClassTool.getArgsFromAPI(P.key,J,c);if(!A.argsvar){A.argsdoc=[];A.argsvar=[];var w=function(R){var Q=(R+"").split("("),S;Q.shift();S=Q.join("(");S.replace(/\s*((\w)+)(\s*\/\*[^*]*\*+([^\/][^*]*\*+)*\/)?|(\s*\/\/[^\n]*)|(\)[\s\S]*)/g,function(X,U,T,Y,W,V){if(X.charAt(0)!=")"){V=Y?Y.replace(/^\s*\/\*/,"").replace(/\s*\*\/\s*$/,"").replace(/\s*[\n\r]+\s*\*\s*/g," ").replace(/^\s*/,""):"";X=V.split(/[^\w\.]+/);W=X[0];A.argsvar.push({ori:W||"Object",type:(W||"Object")+".prototype"});A.argsdoc.push(U+" : "+V)}})};w(P.box.$EventHandlers[J])}q.each(A.argsvar,function(Q,S){if(S==0&&A.argsvar[S].ori=="xui.UIProfile"){A.argsvar[S]="curProfile"}else{if(S==0&&A.argsvar[S].ori=="xui.Profile"){A.argsvar[S]="curProfile"}else{if(Q.ori=="Event"){A.argsvar[S]="e"}else{if(Q.type){A.argsvar[S]=Q.type=="Object.prototype"?{}:S=="Array.prototype"?[]:""}else{if(Q.code){A.argsvar[S]=q.get(j,Q.code.split("."));if(q.str.startWith(Q.code,"CONF.mixed_prop.")){var R=A.argsvar[S]}q.each(R,function(U,T){R[T]=q.getRes("RAD.xui_item_attr."+T)});if(Q.code=="CONF.mixed_prop.xui_UI_TreeView_item"||Q.code=="CONF.mixed_prop.xui_UI_TreeBar_item"){R.sub="sub -> [...]"}}}}}}});var B=function(R){var Q;D.markDirty(function(){if(H){var W=q.get(D._cls,["Instance","events"]);if(!W){q.set(D._cls,["Instance","events"],W={})}W[J]=O}else{if(P["xui.Module"]){P.events[J]=O}else{P[J]=O}}},Q=function(){if(H){var W=q.get(D._cls,["Instance","events"]);if(!W){q.set(D._cls,["Instance","events"],W={})}W[J]=R;D._canvaseventdirty=c}else{if(P["xui.Module"]){P.events[J]=R}else{P[J]=R}}});Q();var S,V=(R&&R.actions)||R,T=0;if(V){q.arr.each(V,function(W){if(typeof W=="string"){S=W;return a}});q.arr.each(V,function(W){if(q.isHash(W)&&W.script){S=W.script;return a}});q.arr.each(V,function(W){if(q.isHash(W)){T++}})}var U=(T===0?"":T===1?(""+T+" "+q.adjustRes("$RAD.designer.action")):(""+T+" "+q.adjustRes("$RAD.designer.actions")));if(S){U+=(U?" + ":"")+q.getRes("RAD.action.Function")}if(U){U="["+U+"]"}if(x){F.boxing().updateCell(x,{caption:U})}if(x&&x._editor){x._editor.setCaption(U)}q.tryF(C)};if(s()&&a===s().fe("beforeActionsEditorPop",[J,A.actionConf,A,function(Q){B(Q)},"RAD.Designer",P,x&&F.getSubNode("CELL",x._serialId).get(0),x,F.boxing(),L&&L.boxing()])){return}q.showCom("RAD.ActionsEditor",function(){this.properties=A;this.setEvents({onDirty:function(S,R,Q){B(Q)}})})},"$prfilegrid_beforepop":function(x,u,w,C,A,B){if(s()&&a===s().fe("beforeEditorComboPop",[u._row.id.split(":").pop(),d,u.value,function(D){w.boxing().setUIValue(D||"",c)},"RAD.Designer",x.$widget,C,x.getSubNode("CELL",u._serialId).get(0),u,x.boxing(),w&&w.boxing()])){return a}},"$profilegrid_eclick":function(A,I,N,G){if(!I._row||!q.str.startWith(I._row.id,"event:")){return}var x=I.$tagVar,D=x.target,E=x.parent,B=x.key,K=x.cap;if(G=="left"||!g.enable_codeEdtor){this.$showActionEditor(E,D,B,K,d,I,d,A,N)}else{var M=x.path,C=x.comments||"",L=x.ini,F=x.funname,H=D._$canvas||D===(E.canvas&&E.canvas.get(0));if(E.hasTask()){return}if(!F){F="_"+(H?"page":D.alias).toLowerCase().replace(/\./g,"_")+"_"+B.toLowerCase();A.boxing().updateCell(I.id,{value:F},a,c)}E.resetTaskList();if(E._dirty){var u=E.getWidgets(c);var w=("{\n"+E.getJSCode(u)).replace(/\n/g,"\n"+q.str.repeat(" ",12))+"\n"+q.str.repeat(" ",8)+"}";E.resetCode(M,"iniComponents",w,a,c)}if(E._canvaseventdirty){var J=q.get(E._cls,["Instance","events"]);var w=J?E.stringify(J):"{}";w=w.replace(/\n/g,"\n"+q.str.repeat(" ",8));E.resetCode("Instance","events",w)}if(!E._cls.Instance[F]){if(H){E.addCode(M,F,L.toString().replace(new r("\\s*\\}$"),"\n\n}"),null,null,C)}else{if(D["xui.Module"]){E.addCode(M,F,L.toString().replace(new r("\\s*\\}$"),"\n\n}"),null,null,C)}else{var w=L.toString().replace(new r("\\s*\\}$"),"")+"\n"+q.str.repeat(" ",4)+"var ns = this, uictrl = profile.boxing();\n}";E.addCode(M,F,w,null,null,C)}}}E.addTask(function(){E.focusEditor(M,F)});E.startTaskList();E.clearDirty()}},"$profilegrid_beforecellvalueset":function(C,x,A){if(!("value" in A)&&!("unit" in A)){return}var H=this,R,N,E,Y,L,Q,Z=C.$widget,D=H.canvas,aa=H._cls;Q=A.value;if((R=x._row.id.split(":")).length>1){E=R[0];L=R[1]}else{L=x._row.id}if(x._col.id=="binder"){var J=Z.getPropBinder(),I=q.copy(J);I[L]=H._anaPropbinder(Q).fun;if(!I[L]){if(Q){C.boxing().updateCell(x,{value:""},a,c);return a}else{delete I[L]}}Z.setPropBinder(I);var P=Z.getAlias();if(H.markDirty){H.markDirty(function(){H.getByAlias(P).setPropBinder(J)},function(){H.getByAlias(P).setPropBinder(I)},"set controls' property")}}else{var O={rotate:1,left:1,top:1,width:1,height:1,right:1,position:1,bottom:1,dock:1,dockMargin:1,dockFloat:1,dockIgnore:1,dockMinH:1,dockMinW:1,dockMaxH:1,dockMaxW:1,dockStretch:1,conDockPadding:1,conDockSpacing:1,conDockFlexFill:1,conDockStretch:1};try{switch(E){case"properties":Y="set"+q.str.initial(L);if(Z.get(0)==(D&&D.get(0))){var G=H.panelBG.getRoot();if(L=="autoDestroy"){var M;if(H.markDirty){H.markDirty(function(){var ab=q.get(aa,["Instance"]);if(!ab){q.set(aa,["Instance"],ab={})}ab.autoDestroy=ov;H.resetCode("Instance","autoDestroy",ov+"",c,a)},M=function(){var ab=q.get(aa,["Instance"]);if(!ab){q.set(aa,["Instance"],ab={})}ab.autoDestroy=Q;H.resetCode("Instance","autoDestroy",Q+"",c,a)},"set autoDestroy")}M()}else{if(L=="width"||L=="height"){var V={};V[L]=Q;H.setViewSize(V)}else{var w=q.get(aa,["Static","viewStyles"]);if(!w){q.set(aa,["Static","viewStyles"],w={})}var K=w[L],Q=A.value||"";w[L]=Q;if(L=="theme"){H.panelDiv.setSandboxTheme(q.adjustRes(Q),c,'[class~="xui-designer-inner-control"]');H.panelDiv.getChildren(true,"penetrate").reLayout(true)}else{if(L=="zoom"){}else{G.css(L,q.adjustRes(Q))}}H.profileGrid.updateCellByRowCol("properties:"+L,"value",{value:Q});if(H.markDirty){H.markDirty(function(){var ab=q.get(H._cls,["Static","viewStyles"]);if(!ab){q.set(H._cls,["Static","viewStyles"],ab={})}if(!K){K=""}ab[L]=K;if(L=="theme"){H.panelDivInner.setSandboxTheme(q.adjustRes(K),c,'[class~="xui-designer-inner-control"]');H.panelDiv.getChildren(true,"penetrate").reLayout(true)}else{if(L=="zoom"){}else{G.css(L,q.adjustRes(K))}}H.profileGrid.updateCellByRowCol("properties:"+L,"value",{value:K});H._styledirty=1},function(){var ab=q.get(H._cls,["Static","viewStyles"]);if(!ab){q.set(H._cls,["Static","viewStyles"],ab={})}if(!Q){Q=""}ab[L]=Q;if(L=="theme"){H.panelDiv.setSandboxTheme(q.adjustRes(Q),c,'[class~="xui-designer-inner-control"]');H.panelDiv.getChildren(true,"penetrate").reLayout(true)}else{if(L=="zoom"){}else{G.css(L,q.adjustRes(Q))}}H.profileGrid.updateCellByRowCol("properties:"+L,"value",{value:Q});H._styledirty=1},"set page style")}H._styledirty=c}}}else{if(L=="width"&&(Z.getPosition()=="relative"||Z.getPosition()=="static")&&(q.get(Z.get(0),["parent","properties","conDockRelative"])||q.get(Z.get(0),["parent","properties","conLayoutColumns"]))){return a}else{var X,T=x.unit=="em"?4:0;if(Z.get(0).box.$DataModel[L].$spaceunit){if("value" in A){A.value=String((Q=="auto")?Q:(parseFloat(Q)===0?0+(A.unit||x.unit||""):parseFloat(Q)?parseFloat(Q):"auto"))}A.precision=T;if(Q!==A.value||A.unit!==x.unit||A.precision!==T){C.boxing().updateCell(x,A);X=1}Q=A.value=="auto"?"auto":x.value+x.unit}var u=[];Z.each(function(ae){var ab=ae.box.$DataModel,ad=Q=="auto"?"auto":Q;var ac=ae.properties[L];if(ad!==ac){if(q.isFun(ae.boxing()[Y])){u.push([ae.alias,Y,ad,ac]);ae.boxing()[Y](ad,!!A.unit);var ab=ae.box.$DataModel;if(ab[L]&&ab[L].linkage){q.arr.each(ab[L].linkage,function(af){C.boxing().updateCellByRowCol("properties:"+af,"value",A,a,a)})}}}});if(H.markDirty){H.markDirty(function(){q.arr.each(u,function(ab){H.getByAlias(ab[0])[ab[1]](ab[3])})},function(){q.arr.each(u,function(ab){H.getByAlias(ab[0])[ab[1]](ab[2])})},"set controls' property")}}if(H.resizer&&O[L]){H.resizer.rePosSize()}if(X){return a}}break;case"event":var S=x.value,Q=A.value,W=function(ac,ae,ab,ad){var ag=ac[ae],af={};if(q.isHash(ag)){af.actions=ag.actions||[];af["return"]=ag["return"]}else{if(q.isArr(ag)){af.actions=ag}else{if(ag){af.actions=[ag]}else{af.actions=[]}}}q.arr.removeValue(af.actions,ab);af.actions.push(ad);if(!("return" in af)){if(af.actions.length===1){if(q.isStr(af.actions[0])){af.actions=af.actions[0]}}af=af.actions}if(!af||q.isEmpty(af)){delete ac[ae]}else{ac[ae]=af}};if(Z.get(0)==(D&&D.get(0))){var w=q.get(aa,["Instance","events"]);if(!w){q.set(aa,["Instance","events"],w={})}W(w,L,S,Q);if(H.markDirty){H.markDirty(function(){var ab=q.get(H._cls,["Instance","events"]);if(!ab){q.set(H._cls,["Instance","events"],ab={})}W(ab,L,Q,S)},function(){var ab=q.get(H._cls,["Instance","events"]);if(!ab){q.set(H._cls,["Instance","events"],ab={})}W(ab,L,S,Q)},"set module event")}H._canvaseventdirty=c}else{if(Z["xui.Module"]){var u=[];Z.each(function(ac){var ab=ac[L];u.push([ac.alias,L,S,Q]);W(ac.events,L,S,Q)});if(H.markDirty){H.markDirty(function(){q.arr.each(u,function(ab){var ac=H.getByAlias(ab[0],c);W(ac.events,ab[1],ab[3],ab[2])})},function(){q.arr.each(u,function(ab){var ac=H.getByAlias(ab[0],c);W(ac.events,ab[1],ab[2],ab[3])})},"set module's event")}}else{var u=[];Z.each(function(ac){var ab=ac[L];u.push([ac.alias,L,S,Q]);W(ac,L,S,Q)});if(H.markDirty){H.markDirty(function(){q.arr.each(u,function(ab){var ac=H.getByAlias(ab[0],c);W(ac,ab[1],ab[3],ab[2])})},function(){q.arr.each(u,function(ab){var ac=H.getByAlias(ab[0],c);W(ac,ab[1],ab[2],ab[3])})},"set control's event")}}}break;default:if(L=="domId"){var B=Z.get(0).domId;if(Q==B){return a}if(Z.get(0).$domId!=Q&&!/^[\w_-]*$/.test(Q)){q.message(q.getRes("RAD.designer.domIdValid",Q));return a}if(Z.get(0).$domId!=Q&&q.Dom.byId(Q)){q.message(q.getRes("RAD.designer.domIdExists",Q));return a}var X;if(q.str.trim(String(Q))==""){Q=Z.get(0).$domId}if(Q!==A.value){C.boxing().updateCell(x,{value:Q});X=1}Z.get(0).boxing().setDomId(Q);var P=Z.get(0).alias;if(H.markDirty){H.markDirty(function(){H.getByAlias(P).setDomId(B)},function(){H.getByAlias(P).setDomId(Q)},"modify control's domId")}if(X){return a}}else{if(L=="theme"){if(Q){Q=(""+Q).replace(/[^a-zA-Z0-9-]/g,"")}var X;if(Q!==A.value){C.boxing().updateCell(x,{value:Q});X=1}if(!Q){Q=d}var u=[];Z.each(function(ab){if(Q!=ab.theme){u.push([ab.alias,ab.theme,Q]);ab.boxing().setTheme(Q)}});if(H.markDirty){H.markDirty(function(){q.arr.each(u,function(ab){var ac=H.getByAlias(ab[0],c);ac.boxing().setTheme(ab[1])})},function(){q.arr.each(u,function(ab){var ac=H.getByAlias(ab[0],c);ac.boxing().setTheme(ab[2])})},"modify controls' theme")}if(X){return a}}else{if(L=="alias"){var F=Z.get(0).alias;if(Q==F){return a}if(!Q){return a}var A=H.getNames();if(A[Q]){q.message(q.getRes("RAD.designer.nameExists",Q));return a}H.listObject.setUIValue(Q,c);Z.get(0).boxing().setAlias(Q);if(H.markDirty){H.markDirty(function(){H.getByAlias(Q).setAlias(F)},function(){H.getByAlias(F).setAlias(Q)},"modify control's alias")}}else{var u=[];Z.each(function(ac){var ab=ac.properties[L];if(Q!==ab){if(q.isFun(ac.boxing()[Y])){u.push([ac.alias,Y,Q,ab]);ac.boxing()[Y](Q)}}});if(H.markDirty){H.markDirty(function(){q.arr.each(u,function(ab){H.getByAlias(ab[0])[ab[1]](ab[3])})},function(){q.arr.each(u,function(ab){H.getByAlias(ab[0])[ab[1]](ab[2])})},"modify controls' property")}}}}}}catch(U){throw (U);return a}}},_onIcondbl:function(w,x,C,E){if(this.$moduleInnerMode||!g.enable_codeEdtor){return}var B=this;if(g.enable_codeEdtor){var u=this.tempSelected;if(u&&u.length){var D=q.getObject(u[0]);D=(D["xui.Module"]?D:D.getModule())||D;B.resetTaskList();if(B._dirty){B.resetCodeFromDesigner()}B.addTask(function(){B.searchInEditor('.setHost(host,"'+D.alias+'"')});B.__dblclickctrl=c;q.asyRun(function(){B.__dblclickctrl=a});B.startTaskList()}}else{if(typeof g.designer_ctrldblclick=="function"){var u=this.tempSelected,A;if(u&&u.length){A=q.getObject(u[0])}B.__dblclickctrl=c;q.asyRun(function(){B.__dblclickctrl=a});g.designer_ctrldblclick(B,A,C,E)}}},"$tg_dblclick":function(A,H,D,u){if(!g.enable_openAPI){return}if(H.noAPI){return}if(H.group){return}var E=this,x=E.canvas,B=H.tipv,w=(H.tipk=="property"?"get"+q.str.initial(B):B)||"",C,G,F;if(!(C=A.$widget)){return}if(C==x){G="xui.Module"}else{if(!(G=C.get(0)&&C.get(0).key)){return}}if(H.tipk=="class"){g.openAPI(G)}else{g.openAPI(G+".prototype"+(w?".":"")+w)}},"$tg_tips":function(w,L,E){var D=this,x=D.canvas,N=w.keys,u,B,I,H,J,A,O,F,K="",G="";if(w.properties.disabled){return}if(!(A=w.$widget)){return}if(A==x){O="xui.Module"}else{if(!(O=A.get(0)&&A.get(0).key)){return}}I=L.id;H=L.parentNode&&L.parentNode.id;if(!I||!H){return}B=w.getSubId(I);if(I.indexOf(N.FCELL)==0||H.indexOf(N.FCELL)==0){u=F=w.rowMap[B];if(!u){q.Tips.hide();return a}}else{if(I.indexOf(N.CELL)==0||H.indexOf(N.CELL)==0){u=w.cellMap[B];if(!u){q.Tips.hide();return a}F=u._row}}if(F){if(F.tipk){if(g.enable_codeEdtor){if(F.tipk){if(F.tipk=="class"){K=O+" [Class]"}else{var P=(F.tipk=="property"?"set"+q.str.initial(F.tipv):F.tipv)||"",M=O+(P?(".prototype."+P):""),C=RAD.EditorTool.getDoc(M,c);if(C){K=F.tipv+" : "+C}else{if(F.tipk=="fun"){K=O+" [$RAD.designer.conf.function] : <b>"+F.tipv+"</b> "}else{if(F.tipk=="property"){K=O+" [$RAD.designer.conf.property] : <b>"+F.tipv+"</b> "}else{if(F.tipk=="event"){K=O+" [$RAD.designer.conf.event] : <b>"+F.tipv+"</b> "}}}}}}if(F.tipk=="class"||u.value==F.tipv){G=g.enable_openAPI?q.getRes("RAD.designer.openapi"):""}else{if(u.tips){G=u.tips}}}else{if(F.tipk=="class"){K=O+" [$RAD.designer.conf.Class]"}else{if(F.tipk=="fun"){K=O+" [$RAD.designer.conf.function] : <b>"+F.tipv+"</b>"}else{if(F.tipk=="property"){K=O+" [$RAD.designer.conf.property] : <b>"+F.tipv+"</b>"}else{if(F.tipk=="event"){K=O+" [$RAD.designer.conf.event] : <b>"+F.tipv+"</b>"}}}}}q.Tips.show(E,D._bldTips2(K,G))}else{if(u&&u.tips){q.Tips.show(E,u.tips)}else{q.Tips.hide()}}}else{q.Tips.hide()}return a},"$profilegrid_onrequestdata":function(u,w,x){return this.__buildSubRows(u.$widget,w.id,a,u.boxing())},_showEditor:function(B,w,D,A,C,u,x){q.ModuleFactory.getCom("RAD.PropEditor",function(){var E=[],K,G,J=g.widgets_mapProp[D+"_conf"]||{},F=q.get(g.widgets_mapProp,[D,w])||q.get(g.widgets_mapProp,[D,"all"]);if(!F){var H=g.widgets_itemsProp[D+"_conf"]||{};var I=g.widgets_itemsProp[D][w]||g.widgets_itemsProp[D].all;F={cells:[]};q.arr.each(x||I.header,function(L){if(L=="renderer"){return}if(!q.isHash(L)){var M=L;if(q.isHash(H[L])){L=q.clone(H[L])}else{L={}}L.id=M;F.cells.push(L)}else{F.cells.push(q.clone(L))}})}q.arr.each(F.cells,function(L){if(!q.isHash(L)){G=L;if(q.isHash(J[L])){L=q.copy(J[L])}else{L={}}L.id=G}else{L=q.clone(L)}if(A&&q.isHash(A)&&(L.id in A)){L.value=A[L.id]}E.push({id:L.id,caption:"$RAD.xui_item_attr."+L.id,cells:[L]})});this.setProperties({targetProfile:B,propKey:D,uiData:E,realData:q.clone(A),src:C}).setEvents({onChanged:u});this.show()})},_showMixedEditor:function(C,x,A,E,B,D,w,u){q.ModuleFactory[u?"newCom":"getCom"]("RAD.MixPropEditor",function(){var F=[],G=[],N=[],M,K,L,I=g.widgets_itemsProp[E+"_conf"]||{};x=x||C.key;var H=g.widgets_itemsProp[E][x]||g.widgets_itemsProp[E].all;q.arr.each(H.header,function(O){var P=(O.id||O)+"";if(!q.isHash(O)){L=O;if(q.isHash(I[O])){O=q.copy(I[O])}else{O={}}O.id=L}else{O=q.clone(O)}O.caption="$RAD.xui_item_attr."+O.id;F.push(O)});q.arr.each(H.subheader,function(O){var P=(O.id||O)+"";if(!q.isHash(O)){L=O;if(q.isHash(I[O])){O=q.copy(I[O])}else{O={}}O.id=L}else{O=q.clone(O)}O.caption="$RAD.xui_item_attr."+O.id;G.push(O)});var J=function(O,P){q.arr.each(O,function(T,Q){M={cells:[]};var S=0;q.arr.each(H.header,function(V,U){var W=(V.id||V)+"";if(q.absObj.$specialChars[W.charAt(0)]){return}K={};if(H.rows&&H.rows[T.id]){K=H.rows[T.id].cells[U]?q.copy(H.rows[T.id].cells[U]):{};if(!("value" in K)){if(q.isHash(T)){if(W in T){if(typeof T[W]=="object"||typeof T[W]=="function"){K.obj=T[W]}else{K.value=T[W]}K.needCollect=1}}else{if(W=="id"){K.value=T;K.needCollect=1}}}}else{if(q.isHash(T)&&(W in T)){if(typeof T[W]=="object"||typeof T[W]=="function"){K.obj=T[W]}else{K.value=T[W]}K.needCollect=1}else{if(W=="id"){K.value=T;K.needCollect=1}}}if(!("value" in K)&&("dftValue" in F[S])){K.value=F[S].dftValue}M.cells.push(K);if(W=="id"&&K.value==q.UI.TreeGrid._temprowid){M._ignore=1}if(H.rows&&H.rows[T.id]){M.tag=H.rows[T.id].tag}S++});if(M._ignore){return}P.push(M);if(H.innerKey){M._innerData=q.clone(T[H.innerKey],function(V,U){return(U+"").charAt(0)!="_"})}if(H.hasSub){M.sub=[];if(T.sub&&T.sub.length){if(x=="xui.UI.TreeGrid"&&!T.sub[0].id){T.sub=q.UI.TreeGrid._adjustRows(C,T.sub)}var R=new q.id();q.arr.each(T.sub,function(V,U){if(q.isHash(V)&&!("id" in V)){V.id=T.id+"-"+R.next()}});J(T.sub,M.sub)}}})};J(B,N);this.setProperties({targetProfile:C,propKey:A,propN:A==E?"":E,uiHeader:F,subheader:G,uiRows:N,fixedRows:a,subFixedRows:"subFixedRows" in H?H.subFixedRows:F.length,treeMode:H.hasSub,uniqueKey:H.uniqueKey,innerKey:H.innerKey,headerSize:x=="xui.UI.TreeGrid"?C.properties.header.length:d,src:D}).setEvents({onChanged:w});this.show()})},_buildPropRows:function(ae,aa,C,N,u){var K=this,T=ae.box.$DataModel,D=ae.properties,P,X,S,R=D.propBinder,W,ab,F,Z,A,x,M,L,V,Q,ad,J,E,O,I,H,Y;var w=[];if((C||N)&&ae.box["xui.UI"]&&!ae.box.$initRootHidden&&!ae.box["xui.UI.FusionChartsXT"]&&!ae.box["xui.UI.ECharts"]){var L=function(ai,ag,ah,af,aj,ak){K._decorationWnd(ae,ak,d,ai,ag,N)};var I="[ $RAD.designer.conf.Object ]",G=[];var B={value:I,caption:I,event:L,type:"button"};if(!(g.lock_hidden_prop.CS&&(ae.locked||(D&&D.locked)))){G.push({caption:"$(RAD.custom_dlg.Custom Style)",tips:q.getRes("RAD.designer.openapi")});G.push(B);w.push({id:"CS",tipk:"fun",tipv:"setCustomStyle",cells:G})}}q.each(ae.box.$DataStruct,function(ag,aj){if(aj.charAt(0)=="_"){return}if(g.widgets_hiddenProps[aj]){return}if(q.get(g.widgets_hiddenProps,[ae.box.KEY,aj])){return}if(g.widgets_hiddenProps_filter&&a===g.widgets_hiddenProps_filter(ae.box.KEY,aj,ae)){return}if(g.lock_hidden_prop[aj]&&(ae.locked||(D&&D.locked))){return}M=V=E=W=ab=F=Z=M=L=V=Q=d;ad=J=a;Y=I="";H="none";P=d;S=d;X=d;A=d;if(aj.charAt(0)=="_"||aj.charAt(0)=="$"){return}if(aj=="required"||aj=="name"||aj=="desc"||aj=="locked"){return}if(T[aj].hidden){return}if(T[aj].inner&&!T[aj].trigger){return}if(!N&&aa){var am=q.arr.indexOf(aa,aj)!=-1;if(C===c?!am:am){return}}if(ae.box["xui.UI.CSSBox"]&&(aj==="normalStatus"||aj==="hoverStatus"||aj==="activeStatus"||aj==="focusStatus")){H="button";L=function(at,aq,ar,ap,au,av){K._decorationWnd(ae,av,d,at,aq,N)};I=Y="[ $RAD.designer.conf.Editor ]"}else{if(aj=="expression"){H="button";L=function(at,aq,ar,ap,au,av){var aw=ae.getProperties().expression;K._showExpressionEditor(aw,function(ax,ay){ae.setProperties("expression",ay);if(!N){K.markDirty(function(){ae.setProperties("expression",aw)},function(){ae.setProperties("expression",ay)},"modify expression")}})};I=Y="[ $RAD.designer.expression ]"}else{if(ae.box["xui.APICaller"]&&(aj=="queryArgs"||aj=="queryOptions"||aj=="queryHeader"||aj=="fakeCookies"||aj=="requestDataSource"||aj=="responseDataTarget"||aj=="responseCallback")){H="button";L=function(at,aq,ar,ap,au,av){K._showAPIEditor(ae,function(ay){var aw=ae.getProperties();var ax={_ext:{}};q.each(ay,function(aA,az){if(!q.compareVar(aA,aw[az])){ax._ext[az]=q.clone(aA)}});at.boxing().updateCell(aq,ax,a,c);ae.setProperties(q.clone(ay));if(!N){K.markDirty(function(){ae.setProperties(aw)},function(){ae.setProperties(ay)},"modify apicaller")}q(av).focus()})};I=Y="[ $RAD.designer.conf.Editor ]"}else{if(ae.box["xui.AnimBinder"]&&aj=="frames"){H="button";L=function(at,aq,ar,ap,au,av){K._showAnimEditor(ae,function(ax){var aw=ae.properties.frames;var ay={_ext:{}};q.each(ax,function(aA,az){if(!q.compareVar(aA,aw[az])){ay._ext[az]=q.clone(aA)}});ae.properties.frames=q.clone(ax);if(!N){K.markDirty(function(){ae.properties.frames=q.clone(aw)},function(){ae.properties.frames=q.clone(ax)},"modify apicaller")}q(av).focus()})};I=Y="[ $RAD.designer.conf.Editor ]"}else{if(ae.box["xui.AnimBinder"]&&(aj=="type")){H="listbox";F=(function(aq){var ap=[];q.each(aq,function(at,ar){ap.push({id:ar,tips:'<img src="/RAD/img/animate/'+ar+'.gif" /> '})});return ap})(q.Dom.$AnimateEffects)}else{if(ae.box["xui.svg"]&&aj==="attr"){H="button";L=function(at,aq,ar,ap,au,av){K._decorationWnd(ae,av,d,at,aq,N)};I=Y="[ $RAD.designer.conf.Editor ]"}else{if(ae.box["xui.UI.FusionChartsXT"]&&aj==="JSONData"&&FCCONF.attrCat[D.chartType]){H="button";L=function(at,aq,ar,ap,au,av){K._decorationWnd(ae,av,d,at,aq,N)};I=Y="[ $RAD.designer.conf.Editor ]"}else{if(ae.box["xui.UI"]&&(aj==="showEffects"||aj==="hideEffects")){H="button";L=function(at,aq,ar,ap,au,av){K._decorationWnd(ae,av,"effects",at,aq,N)};I=Y="[ $RAD.designer.conf.Editor ]"}else{if(ae.box["xui.UI"]&&(aj==="sandboxTheme")){H="combobox";F=q.copy(g.designer_themes2);if(g.enable_editSandboxTheme){A="pop"}V={prop:aj,profile:ae,page:K}}else{if(g.widgets_itemsProp[aj]&&(g.widgets_itemsProp[aj][ae.key]||g.widgets_itemsProp[aj].all)){H="button";L=function(at,ay,ax,aw,av,ap){var ar=ay.$tagVar,aq=at.boxing();if(!ar){return}var au=q.clone(ar.profile.boxing()["get"+q.str.initial(ar.name)](),c);K._showMixedEditor(ae,ae.key,ar.name,ar.name,au,ap,function(aF){var aA=ar;if(!aA){return}var az=aA.profile,aI=az.boxing(),aE=aA.page,aB=aA.name,aD=az.alias,aJ="get"+q.str.initial(aB),aH="set"+q.str.initial(aB),aG=q.clone(aI[aJ](),c),aK;aI[aH](q.clone(aF,c));if(!N){aE.markDirty(function(){aE.getByAlias(aD)[aH](q.clone(aG,c))},function(){aE.getByAlias(aD)[aH](q.clone(aF,c))},"modify contorl's mix-type property");if(aE.resizer&&aB=="items"){if(aK=aA.profile.behavior.PanelKeys){aE._giveHandler(aA.profile)}}}var aC={_ext:{}};aC._ext[aB]=aF;q(ap).focus();aq.updateCell(ay,aC,a,c)})};V={widgetName:ae.alias,profile:ae,name:aj,page:K};I=Y="[ $RAD.designer.conf.Object ]"}else{if(g.widgets_mapProp[aj]&&(g.widgets_mapProp[aj][ae.key]||g.widgets_mapProp[aj].all)){H="button";L=function(at,az,ay,ax,aw,ap){var aq=az.$tagVar;if(!aq){return}aq.cell=az;aq.grid=at.boxing();var av=aq.profile.boxing()["get"+q.str.initial(aq.name)]();var ar=ae.key,au=aq.name;K._showEditor(ae,ar,au,av,ap,function(aF){var aB=this,aN,aD=aq,aA=aD.grid,aM=aD.cell,aC=aD.profile,aG=aC.alias,aJ=aC.boxing(),aL="get"+q.str.initial(aq.name),aI="set"+q.str.initial(aq.name),aK=q.clone(aJ[aL](),c);aJ[aI](q.clone(aF,c));if(!N){var aH=aD.page;aH.markDirty(function(){aH.getByAlias(aG)[aI](q.clone(aK,c))},function(){aH.getByAlias(aG)[aI](q.clone(aF,c))},"modify contorl's hash-type property");if(aH.resizer&&"dockMargin"==aq.name){aH.resizer.rePosSize()}}var aE={_ext:{}};aE._ext[aq.name]=aF;aA.updateCell(aM,aE,a,c);q(ap).focus()})};V={widgetName:ae.alias,name:aj,profile:ae,page:K};I=Y="[ $RAD.designer.conf.Object ]"}else{if(aj=="hoverPop"){H="combobox";var af=K.getWidgets(c),al=[];q.arr.each(af,function(ap){if(ap.alias!=ae.alias){al.push(ap.alias)}});if(al&&al.length){F=al}}else{if(aj=="dataBinder"){H="combobox";var af=K.getWidgets(c),al=[];q.arr.each(af,function(ap){if(ap.key=="xui.DataBinder"){al.push(ap.properties.name)}});if(al&&al.length){F=al}}else{if(aj=="excelCellId"){H="input";A="xuicon xui-uicmd-select";V={prop:aj,profile:ae,page:K}}else{if(aj=="excelCellFormula"||aj=="gridValueFormula"){H="input";A="xuicon xui-uicmd-select";V={prop:aj,profile:ae,page:K}}else{if(aj=="formTarget"){H="combobox";var af=K.getWidgets(c),al=q.copy(T[aj].combobox);q.arr.each(af,function(aq,ap){if(aq.key=="xui.APICaller"){if(ap===0){al.push({type:"split"})}al.push(aq.properties.name)}});if(al&&al.length){F=al}}else{if(aj=="className"){H="combobox";var af=K.getWidgets(c),al=q.copy(g.designer_list_class);q.arr.each(af,function(ap){if(ap.key=="xui.UI.CSSBox"){al.push(ap.properties.className)}});if(al&&al.length){F=al}}else{if(aj=="imageClass"){H="combobox";F=g.designer_list_imageclass;x="18em";if(g.enable_fontAwesome){A="pop"}V={prop:aj,profile:ae,page:K}}else{if(aj=="imagePos"){H="combobox";F=g.designer_background_position}else{if(aj=="value"){if(ae.box["xui.UI.CheckBox"]||ae.box["xui.UI.SCheckBox"]){H="checkbox"}else{if(ae.box["xui.UI.DatePicker"]){H=D.timeInput?"datetime":"date"}else{if(ae.box["xui.UI.TimePicker"]){H="time"}else{if(ae.box["xui.UI.ColorPicker"]){H="color"}else{if(ae.box["xui.UI.ComboInput"]){H=D.type;if(H=="file"||H=="cmdbox"){H="label"}else{if(H=="listbox"||H=="helpinput"||H=="combobox"){if(H=="listbox"){H="combobox";F=function(){return ae.boxing().getItems("min")}}else{F=function(){return D.editorListItems||d}}editorListKey=D.listKey||""}else{F=d;editorListKey=""}}}else{if(ae.box["xui.absList"]){H="helpinput";F=function(){var aq=D.items,ar=[];if(aq){var ap=function(at,au){ar.push({id:at.id||at,caption:q.str.repeat("&nbsp;&nbsp;",au||0)+(at.caption||at.id||at)});if(at.sub){q.arr.each(at.sub,function(av){ap(av,++au)})}};q.arr.each(aq,function(at){ap(at,0)});return ar}else{return d}};editorListKey=D.listKey||""}else{if(aj=="value"){H="input";A="spafont spa-icon-function"}}}}}}}}else{if(aj=="activeItem"){if(ae.box.KEY=="xui.UI.Image"||ae.box.KEY=="xui.svg.image"||ae.box.SINGLE_NODE_IMAGE){H="combobox";F=function(){return q.absList.prototype.getItems("min",D.items)}}}else{if(aj=="activeAnim"){H="combobox";var af=K.getWidgets(c),al=[];q.each(q.Dom.$preDefinedAnims,function(ap,aq){al.push(aq)});q.arr.each(af,function(aq,ap){if(aq.key=="xui.AnimBinder"){if(ap===0){al.push({type:"split"})}al.push(aq.properties.name)}});if(al&&al.length){F=al}}else{if(T[aj].readonly){return}else{if(T[aj].custom){H="popbox";ad=c;I=Y="[ $RAD.designer.conf.custom ]";if(q.isFun(T[aj].customIniCell)){H="label";I="";E=T[aj].customIniCell(ae,aj)}L=function(at,ap){var ar=ap.$tagVar,av=ar.page,aq=at.boxing();var au=at.getSubNode("CELL",ap._serialId),aw=function(aE,ay){var aD=ar.profile,aB=aD.alias,ax=aD.boxing(),aC="set"+q.str.initial(ar.key),aA="get"+q.str.initial(ar.key);if(!q.isFun(ax[aC])){return}var az=ax[aA]();ax[aC](q.clone(aE,c));if(!N){av.markDirty(function(){av.getByAlias(aB)[aC](q.clone(az,c))},function(){av.getByAlias(aB)[aC](q.clone(aE,c))},"set control's custom property")}if(ay){aq.updateCell(ap,ay,a,c)}au.focus()};T[aj].custom(ar.profile,ar.key,ar.profile.properties[ar.key],aw,av,at,ap,au)};V={profile:ae,alias:ae.alias,key:aj,page:K}}else{if(T[aj].html){H="button";ad=c;L=function(au,ap,aq){var aw=ap.$tagVar;if(!aw){return}aw.cell=ap;aw.grid=au.boxing();var av=au.getSubNode("CELL",ap._serialId),ar=aw.profile.boxing()["get"+q.str.initial(aw.name)]();var at=function(aB){var aI,az=aw.profile,aD=aw.page,ax=aw.grid,aH=aw.cell,aC=az.alias,aF=az.boxing(),aE="set"+q.str.initial(aw.name),aG="get"+q.str.initial(aw.name);if(!q.isFun(aF[aE])){return}var ay=aF[aG]();aF[aE](aB);if(!N){aD.markDirty(function(){aD.getByAlias(aC)[aE](ay)},function(){aD.getByAlias(aC)[aE](aB)},"set control's html property")}var aA={_ext:{}};aA._ext[aw.name]=aB;ax.updateCell(aH,aA,a,c);av.focus()};if(s()&&a===s().fe("beforeObjectEditorPop",["htmlEditor",aj,ar,at,"RAD.Designer",ae.boxing(),av.get(0),ap,au.boxing()])){return}q.ModuleFactory.getCom("HTMLEditor",function(){this.host=K;this.setProperties({caption:aw.widgetName+" => "+aw.name,image:"spafont spa-icon-html",text:ar,fromRegion:av.cssRegion(c),tagVar:aw,onOK:function(ay,ax){at(ax)}});this.show()})};V={widgetName:ae.alias,profile:ae,name:aj,page:K};I=Y="[ HTML ]"}else{if(T[aj].listbox){H="listbox";Z=[];ab=ae.key+":properties:"+aj;if(q.isFun(T[aj].listbox)){var ak=T[aj].listbox;Z=function(){var ap=ak.call(ae),aq=[];q.arr.each(ap,function(ar){aq.push({id:ar,caption:ar,value:ar})});return aq}}else{if(q.isObj(T[aj].listbox[0])){Z=q.copy(T[aj].listbox)}else{q.arr.each(T[aj].listbox,function(aq,ap){Z.push({id:aq,caption:aq})})}}q.UI.cacheData(ab,Z)}else{if(T[aj].combobox){H="combobox";Z=[];if(q.isFun(T[aj].combobox)){var ak=T[aj].combobox;Z=function(){var ap=ak.call(ae),aq=[];q.arr.each(ap,function(ar){aq.push({id:ar,caption:ar})});return aq}}else{if(q.isObj(T[aj].combobox[0])){Z=q.copy(T[aj].combobox)}else{q.arr.each(T[aj].combobox,function(aq,ap){Z.push({id:aq,caption:aq})})}}ab=ae.key+":properties:"+aj;q.UI.cacheData(ab,Z)}else{if(T[aj].helpinput){ab=ae.key+":properties:"+aj;H="helpinput";Z=q.copy(T[aj].helpinput);q.UI.cacheData(ab,Z)}else{if(T[aj].trigger){H="button";ad=c;I=Y="[ $RAD.designer.conf.Invoke ]";Q=aj;L=function(aq,ap,at){var ar=ap.$tagVar;if(!ar){return}q.tryF(ar.trigger,d,ar.profile.boxing())};V={profile:ae,name:aj,trigger:T[aj].trigger}}else{if(q.isBool(ag)){H="checkbox";M=aj}else{if(T[aj].format){if(g.getClientMode()!="singlepage"&&(T[aj].format=="image"||T[aj].format=="imageurl"||T[aj].format=="media")){H="popbox";L=function(au,ap,aq){var ar=ap.$tagVar;if(!ar){return}ar.cell=ap;ar.grid=au.boxing();var aw=ar.profile.boxing()["get"+q.str.initial(ar.name)]();var av=au.getSubNode("CELL",ap._serialId),at=function(aH){var aG,ay=ar.profile,aB=ar.page,ax=ar.grid,aF=ar.cell,aA=ay.alias,aD=ay.boxing(),aC="set"+q.str.initial(ar.name),aE="get"+q.str.initial(ar.name),az=aD[aE]()||"";if(!q.isFun(aD[aC])){return}aH=g.adjustRelativePath(aH);if(T[aj].format=="imageurl"){aH="url("+aH+")"}if(!N){aB.markDirty(function(){aB.getByAlias(aA)[aC](az)},function(){aB.getByAlias(aA)[aC](aH)},"set control's media file path property")}if(aq.box){aq.boxing().setUIValue(aH)}else{ax.updateCell(aF,{value:aH},true,true)}av.focus()};if(s()&&a===s().fe("beforeURISelectorPop",[aj,aw,at,"RAD.Designer",ar.profile.boxing(),av.get(0),ap,au.boxing(),aq.boxing()])){return}if(g.getClientMode()!="singlepage"){q.ModuleFactory.getCom((T[aj].format=="image"||T[aj].format=="imageurl")?"RAD.ImageSelector":"RAD.FileSelector",function(){this.host=K;this.setProperties({caption:ar.widgetName+" => "+ar.name,image:"spafont spa-icon-gallery",text:aw,fromRegion:av.cssRegion(c),tagVar:ar,onOK:function(ay,ax){at(ax)}});this.show()})}};V={widgetName:ae.alias,profile:ae,name:aj,page:K}}else{if(T[aj].format=="color"){H="color"}else{H="input"}}}else{if(q.UI.$ps[aj]){H="number";P=ae._spaceUnit||(ae.$isEm(D[aj])?"em":"px");S="px;em";X=P=="em"?4:0}else{if(T[aj]&&T[aj].$spaceunit){H="number";P=ae._spaceUnit||(ae.$isEm(D[aj])?"em":"px");S="px;em";X=P=="em"?4:0}else{if(q.isNumb(ag)){H="number"}else{if(q.isDate(ag)){H="date"}else{if(q.isObj(ag)){H="button";ad=c;L=function(ar,ap,ax){var aw=ap.$tagVar;if(!aw){return}aw.cell=ap;aw.grid=ar.boxing();var at=ar.getSubNode("CELL",ap._serialId),au=aw.profile.boxing()["get"+q.str.initial(aw.name)](),av=q.Coder.formatText(K.stringify(q.clone(au,function(az,ay){return(ay+"").charAt(0)!="_"}))),aq=function(aD){var aK,aB=aw,aA=aB.profile,aE=aA.alias,aF=aB.page,ay=aB.grid,aJ=aB.cell,aH=aB.profile.boxing(),aG="set"+q.str.initial(aw.name),aI="get"+q.str.initial(aw.name);if(!q.isFun(aH[aG])){return}var az=aH[aI]();aH[aG](q.clone(aD,c));if(!N){aF.markDirty(function(){aF.getByAlias(aE)[aG](q.clone(az,c))},function(){aF.getByAlias(aE)[aG](q.clone(aD,c))},"set control's object-type property");if(aF.resizer&&"dockMargin"==aw.name){aF.resizer.rePosSize()}}var aC={_ext:{}};aC._ext[aw.name]=aD;ay.updateCell(aJ,aC,a,c);at.focus();if(aw.name=="items"){if(d===aD){aH.setItems([])}if(aK=aB.profile.behavior.PanelKeys){aF._giveHandler(aB.profile)}}};if(s()&&a===s().fe("beforeObjectEditorPop",["jsonEditor","properties",av,aq,"RAD.Designer",aw.profile.boxing(),at.get(0),ar.boxing(),ax&&ax.boxing()])){return}q.ModuleFactory.getCom("jsonEditor",function(){this.host=K;this.setProperties({caption:aw.widgetName+" => "+aw.name,imageClass:(au&&au.constructor==Array)?"spafont spa-icon-array":"spafont spa-icon-hash",text:av,fromRegion:at.cssRegion(c),onOK:function(ay){aq(ay.properties.object)}});this.show()})};V={widgetName:ae.alias,profile:ae,name:aj,page:K};I=Y="[ $(RAD.designer.conf.Object) ]"}else{if(T[aj].type){H=T[aj].type}else{H="input"}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}if(!I){I=T[aj].dynamic?ae.boxing()["get"+q.str.initial(aj)]():D[aj]}var an={value:I,type:H,editorCommandBtn:A,units:S,unit:P,precision:X,trimTailZero:c,disabled:J,editorReadonly:ad,"$tag":M,event:L,"$tagVar":V,editorListKey:ab,editorListItems:F};if(Y){an.caption=Y}if(E){q.merge(an,E,"all")}if(x||T[aj].dftWidth){an.editorDropListWidth=x||T[aj].dftWidth}if(O=q.get(g.widgets_customCellOptions,[ae.key,aj])){q.merge(an,O,"all")}var ah;if(T[aj].caption){ah=q.adjustRes(T[aj].caption)}else{ah=RAD.EditorTool.getPropName(ae.key,aj)}s()&&s().fe("onInitPropValueCell",[aj,d,I,N?"RAD.ActionsEditor":"RAD.Designer",ae,an,u]);var ao=[{caption:ah,tips:q.getRes("RAD.designer.openapi")},an];w.push({id:"properties:"+aj,tipk:"property",tipv:aj,value:aj,cells:ao});if(g.grid_showPropBinder&&K.tempSelected&&K.tempSelected.length===1&&!T[aj].inner&&!T[aj].readonly&&(g.PropBinderWhiteList&&(g.PropBinderWhiteList[aj]||(g.PropBinderWhiteList[ae.box.KEY]&&g.PropBinderWhiteList[ae.box.KEY][aj])))&&!(g.PropBinderBlackList&&(g.PropBinderBlackList[aj]||(g.PropBinderBlackList[ae.box.KEY]&&g.PropBinderBlackList[ae.box.KEY][aj])))){var ai=K._anaPropbinder(q.get(D,["propBinder",aj]));ao.push({type:"popbox",disabled:a,editable:c,editorProperties:{dropImageClass:"xuicon xui-icon-link"},value:ai.str,tag:ai.type,tagVar:ai.fun,event:function(at,aq,ar,ap,au,av){if(s()&&a===s().fe("beforePropbinderSet",[aj,aq.tagVar,function(ax,aw){var ay=K._anaPropbinder(ax);at.boxing().updateCell(aq,{tag:ay.type,tagVar:ay.fun,value:ay.fun?ay.str:""},a,c);if(q.isSet(aw)){at.boxing().updateCell(aq._row.cells[1],aw,a,c)}K.markDirty()},aq.tag,aq.value,"RAD.Designer",ae.boxing(),at.getSubNode("CELL",aq._serialId).get(0),aq,at.boxing(),ar&&ar.boxing()])){return}}})}});if(!C&&g.widgets_prop_cat){var U=[],ac;q.arr.each(g.widgets_prop_cat,function(af){ac=[];q.arr.each(af.items,function(ah,ag){if((ag=q.arr.subIndexOf(w,"id","properties:"+ah))!=-1){ac.push(w[ag]);w[ag]=d}});if(ac.length){U.push({id:"sub:"+af.id,caption:"<span style='"+(N?"":"font-weight:normal")+";'>$(RAD.designer.conf.propcat."+af.id+")</span>",group:c,cellStyle:N?"":"font-weight:normal",sub:ac})}});q.filter(w,function(af){return !!af});if(w.length){q.arr.stableSort(w,function(af,ag){return af.id>ag.id?1:-1});U.push({id:"sub:featured",caption:"<span style='"+(N?"":"font-weight:normal")+";'>$(RAD.designer.conf.propcat.Featured Prop)</span>",group:c,sub:w});if(U.length>=2){var ac=U[U.length-1];U[U.length-1]=U[U.length-2];U[U.length-2]=ac}}return U}else{return w}},_anaPropbinder:function(A){var w={},x,u=q.isFun(A);if(A){if(u){x=(q.fun.body(A)||"").replace(/^\s*/,"").replace(/\s*$/,"");w.fun=A;if(/^\s*return\s*get\s*\((\s*("(\\.|[^"\\])*")|('(\\.|[^'\\])*'))\s*\)[;\s]*$/.test(x)){w.str=x.replace(/^\s*return\s* get\s*\(['"]/,"").replace(/['"]\)[;\s]+$/,"");w.type="var"}else{if(/^\s*return\s+/.test(x)){w.str=x.replace(/^\s*return\s*/,"").replace(/[;\s]+$/,"");w.type="expression"}else{w.str=A+"";w.type="function"}}}else{w.str=A;if(/^\s*function\s*\(/.test(A)&&q.isFun(w.fun=q.unserialize(A))){w.type="function"}else{if(A.indexOf("'")==-1&&A.indexOf('"')==-1&&q.isFun(w.fun=q.unserialize('function(){return get("'+A+'");}'))){w.type="var"}else{if(q.isFun(w.fun=q.unserialize("function(){return "+A+";}"))){w.type="expression"}else{w={}}}}}return w}return w},_buildEventsRows:function(B,u,x,F){var C=this,w=C.canvas,E=B===(w&&w.get(0)),A=[];q.each(E?q.Module.$EventHandlers:B.box.$EventHandlers,function(S,aa){if(aa.charAt(0)=="_"){return}if(g.widgets_hiddenEvents[aa]){return}if(q.get(g.widgets_hiddenEvents,[B.box.KEY,aa])){return}if(g.widgets_hiddenEvents_filter&&a===g.widgets_hiddenEvents_filter(B.box.KEY,aa,B)){return}var ac=RAD.EditorTool.getDoc(B.key+".prototype."+aa,d,c),J=S+"",N="";if(ac){var V="\n        ";N="/**";N+=V+" * "+(ac.$desc||"");N+=V+" * @method "+aa+" ["+(E?"xui.Module":B.box.KEY)+" event]";J="";if(ac.$paras){J+="function(";var O=ac.$paras;var L=q.fun.args(B.box.$EventHandlers[aa]);for(var Z=0,Y=L.length;Z<Y;Z++){if(O[Z]){L[Z]=O[Z].split(/\s*:\s*/)[0]}var M=["",L[aa],"",""];if(O[Z]){M=/(.*):(\s*[\w\.]*)([^\w].*)/.exec(O[Z])}N+=V+" * @param {"+(M[2]||"").replace(/\s/g,"")+"} "+(M[1]||"").replace(/\s/g,"")+" "+(M[3]||"")}if(ac.$rtn){N=V+" * @return "+ac.$rtn}N+=V+"*/";J+=L.join(", ");J+="){\n";J+="}"}else{J+=S+""}}if(u){var X=q.arr.indexOf(u,aa)!=-1;if(x===c?!X:X){return}}var H=aa.charAt(0)=="b"?"$(RAD.designer.eventbfrtag)":aa.charAt(0)=="a"?"$(RAD.designer.eventafttag)":"$(RAD.designer.eventontag)",T=RAD.EditorTool.getEventName(E?"xui.Module":B.key,aa,c),I=(g.enable_codeEdtor?("$(RAD.designer.conf.Dblclick to create or edit the event handler)"):""),R,W;if(E){var K=q.get(C._cls,["Instance","events"]);if(!K){q.set(C._cls,["Instance","events"],K={})}R=q.copy(K[aa])}else{if(B["xui.Module"]){R=q.copy(B.events[aa])}else{R=q.copy(B[aa])}}if(R&&(q.isStr(R)||q.isFun(R))){R=[R]}var P=R&&R.actions||R;q.arr.each(P,function(ad){if(typeof ad=="string"){W=ad;return a}});q.arr.each(P,function(ad){if(q.isHash(ad)&&ad.script){funname2=ad.script;return a}});q.filter(P,function(ad){return q.isHash(ad)});var Q,U=((Q=P?q.isArr(P)?P.length:1:0)===0?"":Q===1?(""+Q+" "+q.adjustRes("$RAD.designer.action")):(""+Q+" "+q.adjustRes("$RAD.designer.actions")));if(W){U+=(U?" + ":"")+q.getRes("RAD.action.Function")}if(U){U="["+U+"]"}target2=B;if(E){target2=new q.Module;target2._isCanvas=1}var ab={widgetName:E?q.getRes("RAD.pm.Page"):B.alias,path:"Instance",key:aa,target:target2,funname:W,comments:N,ini:J,_eventkey:aa,cap:"$(RAD.action."+(E?"Page":B["xui.Module"]?"Module":"Control")+")  => "+(E?"":B.alias+" - ")+T,parent:C};if(E){ab.target._$canvas=!!E}A.push({id:"event:"+aa,tipk:"event",tipv:aa,tag:2,value:aa,cells:[{caption:H+T,tips:q.getRes("RAD.designer.openapi")},{value:W,tips:I,type:"cmdbox","$tagVar":ab,editMode:"hover",caption:U,editorProperties:{commandBtn:"delete"},editorEvents:{onShowTips:function(ad,af,ag){var ae=ad.box.$Keys;if(ad.getKey(af.id)==ae.INPUT){q.Tips.show(ag,q.getRes("RAD.action.Click to edit actions"))}else{if(ad.getKey(af.id)==ae.BTN||ad.getKey(af.parentNode.id)==ae.BTN){q.Tips.show(ag,q.getRes("RAD.action.Click to edit event function"))}else{if(ad.getKey(af.id)==ae.SBTN||ad.getKey(af.parentNode.id)==ae.SBTN){q.Tips.show(ag,q.getRes("RAD.action.Delete the event responses"))}else{q.Tips.hide()}}}return a}}}]})});if(!x&&g.widgets_events_cat){var G=[],D;q.arr.each(g.widgets_events_cat,function(H){D=[];q.arr.each(H.items,function(J,I){if((I=q.arr.subIndexOf(A,"id","event:"+J))!=-1){D.push(A[I]);A[I]=d}});if(D.length){G.push({id:"sub:"+H.id,caption:"<span style='"+(F?"":"font-weight:normal")+";'>$(RAD.designer.conf.propcat."+H.id+")</span>",group:c,cellStyle:F?"":"font-weight:normal",sub:D})}});q.filter(A,function(H){return !!H});if(A.length){q.arr.stableSort(A,function(H,I){return H.id>I.id?1:-1});G.push({id:"sub:featured",caption:"<span style='"+(F?"":"font-weight:normal")+";'>$(RAD.designer.conf.propcat.Featured Events)</span>",group:c,sub:A});if(G.length>=2){var D=G[G.length-1];G[G.length-1]=G[G.length-2];G[G.length-2]=D}}return G}else{return A}},__buildSubRows:function(K,A,D,u){var F=[],I=this,G=K["xui.Module"]?1:K._nodes.length,E=G>1?c:a,H=K.get(I.SelectedFocus<=0?0:I.SelectedFocus),C=I.canvas,J=H===(C&&C.get(0)),B=G===1?(g.widgets_xprops[J?"xui.Module":K["xui.Module"]?"xui.Module":H.key]||[]):[];if(!J&&(A=="properties"||A=="special")){var x=I._buildPropRows(H,B,D,d,u);if(x.length){q.arr.insertAny(F,x)}}if(!I.$moduleInnerMode){if(A=="UIE"||A=="special"){var w=I._buildEventsRows(H,B,D);if(w.length){q.arr.insertAny(F,w)}}}if(A=="special"){q.arr.stableSort(F,function(L,M){L=q.arr.indexOf(B,L.value);M=q.arr.indexOf(B,M.value);return L>M?1:L==M?0:-1})}if(!J&&!K["xui.Module"]&&A!=="UIE"){q.filter(F,function(O,M){var N=K._nodes,L=function(S,Q){var T=Q[1].value,U,P;for(var R=0;R<N.length;R++){if(I.SelectedFocus===R){continue}U=N[R].properties;if(!(S in U)){P=N[R].box.$EventHandlers;if(!(S in P)){Q[1].disabled=c}}if(U[S]!==T){Q[1].disabled=c}}};if(!O.group){L(O.value,O.cells)}else{q.arr.each(O.sub,function(P){L(P.value,P.cells)})}})}return F},"$iconlist_aftervalueupdated":function(A,x,w){var B=this;if(w){B.resizer.resetTarget(d,a);var u=q.getObject(w);if(u["xui.Module"]){if(u.getUIComponents().isEmpty()){B._setSelected([w],c)}else{B.selectWidget(w)}}else{B._setSelected([w],c)}}},_propFilter_oncmd:function(){var u=this.propFilter;if(u.getUnit()!="Show All"){u.setUnit("Show All")}else{u.resetValue("");this.profileGrid.get(0).$itemFilter=this.profileGrid.get(0).$widget=null;this._setSelected(this.tempSelected,c)}},_propFilter_unit:function(x,A){var u=this.propFilter;if(A=="Show All"){u.setInputReadonly(false);this.profileGrid.get(0).$itemFilter=this.profileGrid.get(0).$widget=null;this._setSelected(this.tempSelected,c)}else{u.resetValue("").setInputReadonly(true);this._propFilter_()}},_propFilter_onchange:function(w,u,x){q.resetRun("_propFilter_",this._propFilter_,500,[],this)},_propFilter_:function(){var A=this,B=A.propFilter.getUIValue(),x=A.propFilter.getUnit(),u=function(D,G){var I,H={};if(G=="canvas"){I={properties:{width:1,height:1,theme:1}};if(!A._cls){q.each(I.properties,function(K,J){H["properties:"+J]=1});return H}var E=A._cls.Instance,F=A._cls.Static;if(E.events){I.events=E.events}if(E.autoDestroy){I.properties.autoDestroy=1}if(!q.isEmpty(E.properties)){I.properties.properties=1}if(!q.isEmpty(E.functions)){I.properties.functions=1}q.each(F&&F.viewStyles,function(K,J){if(K){I.properties[J]=1}});q.each(F&&F.designViewConf,function(K,J){if(K){I.properties[J]=1}})}else{if(G=="xui.Module"){I=D.serialize(false);if(I.properties){I.properties={properties:I.properties}}}else{I=D.serialize(false);if(I.theme){H.theme=1}if(I.domId){H.domId=1}}H.key=1;H.alias=1}q.each(I.properties,function(K,J){H["properties:"+J]=1});q.each(I.events,function(K,J){H["event:"+J]=1});if(I.CS){H.CS=1}if(I.CC){H.CC=1}return H},w=function(){return new r(":\\w*"+B||"","i")},C=function(){return new r("(<[^>]*>)+(.*"+(B||"")+".*)(<[^>]*>)+","i")};this.profileGrid.doFilter(x!="Show All"||B?function(I,H,F){var D=arguments.callee,G,E=function(){var J=A.profileGrid.get(0).$widget.get(0);if(J.$xid!=D._$widget){delete D._$reg;delete D._$reg2;delete D._$hash;D._$widget=J.$xid}if(x!="Show All"){if(!D._$hash){D._$hash=u(J,J==A.canvas.get(0)?"canvas":J["xui.Module"]?"xui.Module":J.key)}}else{if(B){if(!D._$reg){D._$reg=w(B)}if(!D._$reg2){D._$reg2=C(B)}}}};if(I=="begin"){E()}else{if(I=="end"){if(H!="prepareItem"){}}else{if(x!="Show All"){G=I.group||I.sub?false:!D._$hash[I.id]}else{if(B){G=I.group||I.sub?false:(!D._$reg.test(I.id)&&!D._$reg2.test(I.cells?I.cells[0]._caption:I.caption))}}if(H!="prepareItem"&&I.id&&I.sub&&!I._checked){if(x!="Show All"){if(q.isArr(I.sub)){q.filter(I.sub,function(J){return !!D._$hash[J.id]})}}F.boxing().toggleRow(I.id,true,false,true)}return G}}}:d)},"$listobject_onlistshow":function(x,F){var C=this;var H=function(M){var I=q.getObject(M),J;if(I&&(J=I.getRoot())&&J.get(0)){var K=J.cssRegion(c,C.panelDiv.getRoot());if(I.box["xui.svg"]){var L=I.boxing()._getBBox();K.width=L.width;K.height=L.height}C.frame.cssRegion(K).css("display","block")}},u=function(){C.frame.css("display","none")};if(!C.objlistBlock){C.objlistBlock=new q.UI.Block({width:b.min(300,x.getRoot().width()),height:400,borderType:"ridge",background:"#fff",shadow:c,resizer:c});if(!C.frame||!C.frame.get(0)){C.frame=q.create('<div style="z-index:2000;background-color:red;position:absolute;font-size:0;line-height:0;display:none;">').css("opacity",0.3);C.panelDiv.getRoot().append(C.frame)}C.treebarObj=new q.UI.TreeBar({group:a,selMode:"single"},{onItemSelected:function(I,J,K){C.selectWidget(J.id);I.parent.getRoot().css("display","none");C.frame.css("display","none");I.boxing().clearItems();C._focus();return a},onClick:function(I,J){if(I.boxing().getUIValue()==J.id){I.parent.getRoot().css("display","none");C.frame.css("display","none");I.boxing().clearItems();C._focus()}},beforeHoverEffect:function(J,K,M,N,I){if(!K){return}if(K.id==this.canvas.get(0).$xid){return}var L=q.getObject(K.id);if(!L["xui.UIProfile"]&&!L["xui.Module"]){return}if((L["xui.UIProfile"]&&L.box.$initRootHidden)){return}if(I=="mouseover"){q.resetRun("",H,100,[K.id])}else{q.resetRun("",u,100)}}},C);C.objlistBlock.append(C.treebarObj).render(c)}var D=[],B={};var E=function(K,L,J){if((C.$inplaceEditor&&C.$inplaceEditor.get(0))==K){return}var N=K.moduleClass?"module":"control",O=N=="module"?"xui.Module":K.box.KEY,M;if(N=="module"){K=K.getModule(c);if(B[M=K.KEY+"["+K.$xid+"]"]){return}B[M]=1}var R=arguments.callee,Q=J[O],P={id:K.$xid,type:N,caption:K.alias,image:Q&&Q.image||"",imagePos:Q&&Q.imagePos||"",imageClass:Q&&Q.imageClass||""};L.push(P);if(N=="module"){return}if(K.children&&K.children.length){var I=[];P.sub=I;q.arr.each(K.children,function(S){R.call(d,S[0],I,J)})}};E(C.canvas.get(0),D,g.mapWidgets);C.treebarObj.setItems(D).toggleNode(C.canvas.get(0).$xid,c,c,c);var w=C.objlistBlock.reBoxing();w.popToTop(x.getRoot(),d,d,function(){var I=C.tempSelected&&C.tempSelected[0];if(I){q.asyRun(function(){var J=C.treebarObj.getItemByItemId(I);if(J){C.treebarObj.focusItem(J.id);C.treebarObj.setUIValue(J.id,c);H(I)}})}});var A="design:pop:objecttree",G=function(){q.Event.keyboardHook("esc",0,0,0,A);w.css("display","none");C.treebarObj.clearItems();C.frame.css("display","none");C._focus();return false};w.setBlurTrigger(A,G);q.Event.keyboardHook("esc",0,0,0,G,A)},"$unique":function(u){var A,x,w=q.copy(u);u.length=0;for(A=0,x=w.length;A<x;A++){if(q.arr.indexOf(u,w[A])==-1){u[u.length]=w[A]}}return u},getWidgets:function(B,E){if(!B){this._clearSelect()}var A=this,u={},D,F,w=[],C;if(E){if(E["xui.UIProfile"]){C=E.children}else{if(E["xui.Module"]){return E.getComponents().get()}}}if(!C){C=A.canvas.get(0).children||A.canvas.get(0).childNodes}q.arr.each(C,function(G){if((A.$inplaceEditor&&A.$inplaceEditor.get(0))==G[0]){return}if(F=G[0].getModule(c)){if(!u[D=F.KEY+"["+F.$xid+"]"]){u[D]=1;w.push(F)}}else{w.push(G[0])}});var x=this.iconlist&&this.iconlist.getItems();if(x&&x.length){q.arr.each(x,function(H,G){if(H=q.getObject(H.id)){w.push(H)}})}return this.$unique(w)},_sortchildren:function(x,u){var w=function(A,C){A=q.arr.stableSort(A,function(E,F){E=(E[0]||E);F=(F[0]||F);if(C==1&&(E.key=="xui.DataBinder"||E.key=="xui.APICaller"||E.key=="xui.AnimBinder")){E=-2}else{if(E.key=="xui.UI.CSSBox"){E=999999998}else{if(E.key=="xui.Timer"){E=-4}else{E=E.properties._dockOrder||0}}}if(C==1&&(F.key=="xui.DataBinder"||F.key=="xui.APICaller"||E.key=="xui.AnimBinder")){F=-2}else{if(F.key=="xui.UI.CSSBox"){F=999999998}else{if(F.key=="xui.Timer"){F=-4}else{F=F.properties._dockOrder||0}}}return E>F?1:E==F?0:-1});if(!u){C++;for(var B=0,D;B<A.length;B++){if((D=A[B][0]||A[B])&&D.box.KEY!="xui.UI.SVGPaper"&&(D=D.children)&&D.length){w(D,C)}}}};w(x,1);return x},stringify:function(x,w){var u=typeof x;x=q.stringify(x);x=(u=="object"||u=="function")?q.Coder.formatText(x,"js"):x;x=x.replace(/\n$/,"");if(w){x=x.replace(/\n/g,"\n"+w)}return x},getJSONCode:function(u,A,w){this._sortchildren(u);var x=q.stringify(u);if(A){x=q.Coder.formatText(x)}return w?x:("xui.create("+x+").get();")},getJSCode:function(w,x,A,u){this._sortchildren(w);var D=this,F,C=[],B={};if(!u){C.push("// [[Code created by JDSEasy RAD Studio\n");C.push("var host=this, children=[], properties={}, append=function(child){children.push(child.get(0));};\n");C.push("xui.merge(properties, this.properties);")}var E=function(P,M,I,J){var R=arguments.callee,O=P.box["xui.UI"],H=P.serialize(a),G=H.alias,N,Q,L,K=P.boxing();if((P["xui.Module"]&&(H=(Q=P).serialize(a)))||((P.moduleClass&&P.moduleXid)&&(P.moduleClass!==x&&P.moduleXid!==A)&&((Q=q.SC.get(P.moduleClass))&&(Q=Q.getInstance(P.moduleXid))&&Q["xui.Module"]&&(H=Q.serialize(a))))){if(!B[L=Q.KEY+"["+Q.$xid+"]"]){B[L]=1;if(!u){J.push("\n\n");if(M){J.push(M+".append(\n    ")}else{J.push("append(\n    ")}J.push('xui.create("'+H.key+'", "xui.Module")');G=H.alias;J.push('\n    .setHost(host,"'+G+'")')}if(H.properties){J.push("\n    .setProperties("+D.stringify(H.properties,"    ")+")")}if(H.events){J.push("\n    .setEvents("+D.stringify(H.events,"    ")+")")}if(!u){if(M&&I){J[J.length-1]+=",\n    "+I}J.push("\n);")}}}else{delete H.id;if(H.properties&&H.properties.dropKeys){if(H.properties.dropKeys==P.box.$DataStruct.dropKeys){delete H.properties.dropKeys}}if(H.theme){H.theme=(""+H.theme).replace(/[^a-zA-Z0-9-]/g,"")}if(!H.theme){delete H.theme}if(q.isEmpty(H.properties)){delete H.properties}if(q.isEmpty(H.events)){delete H.events}if(q.isEmpty(H.CS)){delete H.CS}if(q.isEmpty(H.CC)){delete H.CC}if(q.isEmpty(H.CB)){delete H.CB}if(q.isEmpty(H.CF)){delete H.CF}if(!u){J.push("\n\n");if(M){J.push(M+".append(\n    ")}else{J.push("append(\n    ")}J.push('xui.create("'+H.key+'")');J.push('\n    .setHost(host,"'+G+'")')}if(H.theme){J.push('\n    .setTheme("'+H.theme+'")')}if(H.domId!=H.$domId){J.push('\n    .setDomId("'+H.domId+'")')}if(H.properties){if(typeof K.setSpaceUnit=="function"&&"spaceUnit" in H.properties){J.push("\n    .setSpaceUnit("+D.stringify(H.properties.spaceUnit,"    ")+")")}q.each(H.properties,function(T,S){if(S=="spaceUnit"){return}if(S=="value"){return}Q="set"+q.str.initial(S);if(typeof K[Q]=="function"){J.push("\n    ."+Q+"("+D.stringify(T,"    ")+")")}});if(typeof K.setValue=="function"&&"value" in H.properties){J.push("\n    .setValue("+D.stringify(H.properties.value,"    ")+")")}}if(H.events){q.each(H.events,function(T,S){J.push("\n    ."+S+"("+D.stringify(T,"    ")+")")})}if(H.CS){J.push("\n    .setCustomStyle("+D.stringify(H.CS,"    ")+")")}if(H.CC){J.push("\n    .setCustomClass("+D.stringify(H.CC,"    ")+")")}if(H.CB){J.push("\n    .setCustomBehavior("+D.stringify(H.CB,"    ")+")")}if(H.CF){J.push("\n    .setCustomFunction("+D.stringify(H.CF,"    ")+")")}if(!u){if(M&&I){J[J.length-1]+=",\n    "+I}J.push("\n);");if(P.children&&P.children.length){q.arr.each(P.children,function(W){var T=W[0],S=[],V;for(var U=1;U<W.length;U++){switch(typeof W[U]){case"number":S.push(W[U]);break;case"string":S.push('"'+W[U]+'"');break}}if(S.length){V=S.join(",")}else{V=d}R.call(this,T,"host."+G,V,J)},this)}}}};q.arr.each(w,function(G){E(G,d,d,C)});if(!u){C.push("\n\n");C.push("return children;\n");C.push("// ]]Code created by JDSEasy RAD Studio")}return q.fromUTF8(C.join(""))},getNames:function(){var w=this.getWidgets(c);var A=this,x,B={};var u=function(D){var C=arguments.callee;B[D.alias]=D;if(D["xui.Module"]){D.getUIComponents().each(function(E){C.call(d,E)})}else{if(!D.moduleClass&&D.children&&D.children.length){q.arr.each(D.children,function(E){C.call(d,E[0])})}}};q.arr.each(w,function(C){u(C)});return B},selectWidget:function(w){if(!q.isArr(w)){w=[w]}var u=q.getObject(w[0]);if(u["xui.Module"]){w=[];u.getUIComponents().each(function(B,A){if(A===0){u=B}w.push(B.$xid)})}var x=u.parent;if(!x){return}if(x.setSelectFromPanel){x.setSelectFromPanel.call(x,u.getRoot().parent(),w);this._setSelected(w,c)}else{this._clearSelect();this._setSelected(d,c)}},activate:function(){},setLinkObj:function(u){this._cls=u},refreshView:function(w,E,B){var F=this;if(!E){F._cls=w}if(B){F._className=B}var D=F.getWidgets(c);q.arr.each(D,function(G){G.boxing().destroy(c,c)});if(F.iconlist){F.iconlist.clearItems()}F.canvas.removeChildren(c,c,c);var C=E?w:q.get(w,["Instance","iniComponents"]);if(C){var x=[];try{(typeof C=="string"?C:q.fun.body(C._____string||C)).replace(/\bxui.create\s*\(\s*['"]([\w.]+)['"]\s*[,)]/g,function(H,G){if(!(H=q.SC.get(G))){x.push(G);H=d}})}catch(A){}q.Dom.setCover(q.getRes("RAD.designer.createContent"));C=new Function([],typeof C=="string"?C:q.fun.body(C._____string||C));var u=function(){try{F.$host={$inDesign:"xxx"};var H,J=[],G=q.get(s(),["curProjectConfig","$DevEnv","SpaceUnit"]);try{if(G){var I=q.SpaceUnit;q.SpaceUnit=G;G=I}H=C.call(F.$host)||[]}finally{if(G){q.SpaceUnit=G;G=null}}q.arr.each(H,function(L){L=q.isArr(L)?L[0]:L;F._designable(L)});q.each(H,function(L){if(L&&L.Class){if(L.key=="xui.APICaller"){if(L.boxing().getAutoRun()&&q.str.endWith(L.properties.queryURL,".dyn")){L.boxing().invoke()}}else{if(L.boxing&&L.boxing().checkValid){L.boxing().checkValid(true)}}}});q.filter(H,function(L){if(L["xui.Module"]?L.getUIComponents().isEmpty():L.box["xui.UI"]?L.box.$initRootHidden:c){J.push(L);return !!L.box["xui.UI"]||!!L.box["xui.Module"]}});q.arr.each(H,function(L){F.canvas.append(L)});q.arr.each(J,function(M){var L=M["xui.Module"]?"xui.Module":M.box.KEY;F.iconlist.insertItems([{id:M.$xid,imgWidth:"16",imgHeight:"16",tips:F._bldTips(M,F.$moduleInnerMode?"":g.enable_codeEdtor?("$(RAD.designer.Dblclick to edit the code)"):""),imgStyle:g.mapWidgets[L]&&g.mapWidgets[L].image?("background:url("+g.mapWidgets[L].image+") "+g.mapWidgets[L].imagePos):"",imageClass:g.mapWidgets[L]&&g.mapWidgets[L].imageClass}],d,a)});var I=F.layoutBase.reBoxing();if(I.css("display")=="none"){I.css("display","block");I.parent().css("background","")}q.asyRun(function(){q.UI.pack(H,a).adjustDock()})}catch(K){F.iconlist.clearItems();F.canvas.reBoxing().empty();F.layoutBase.reBoxing().css("display","none").parent().css("background","url("+q.getPath("img/","error.gif")+")");q.message(q.getRes("RAD.designer.comCodeErr"));q.pop(K.stack||K.description||K.message||K.toString());if(j.console){console.log(K)}q.asyRun(function(){if(F.toCodeView){F.toCodeView()}})}q.Dom.setCover(a)};if(x.length){q.require(x,u,d,function(G){q.alert(G)},function(G){q.alert(G)},c,d,{appPath:g.adjustProtocol(s().curProjectPath)})}else{u()}}F.clearDirty();F._clearSelect();F._setSelected([],c);q.resetRun("$profilegrid$",F._refreshProfileGrid,0,[0,0,c],F);return C},refreshViewSize:function(C,B){var w=this,u=w.canvas,A=w.panelBG.getRoot(),x,D;if(g.getClientMode()!="project"){q.arr.each(["background-color","background-image","background-repeat","background-position","background-attachment"],function(F,E){E=q.get(C,["Static","viewStyles",F]);A.css(F,E?q.adjustRes(E):"")});x=q.get(C,["Static","viewStyles","theme"])||"default";w.panelDiv.setSandboxTheme(x,c,'[class~="xui-designer-inner-control"]');w.panelDiv.getChildren(true,"penetrate").reLayout(true);w._desingviewdirty=a;w._styledirty=a;D=q.get(C,["Static","designViewConf"])||q.get(C,["Static","viewSize"])||w.$viewSize["1280.23"]}else{D=q.get(s(),["curProjectConfig","$DevEnv","designViewConf"])||w.$viewSize["1280.23"]}if(!D.height||!D.width){D=w.$viewSize["1280.23"]}w.setViewSize(D,B);w.setMobileFrame(!!D.touchDevice);w._desingviewdirty=a;return w.stringify(D)},_popdata_onmenusel:function(w,u){this._toolbaraction(u,{id:"codegroup"})},_popalign_onmenusel:function(w,u){this._toolbaraction(u,{id:"aligngroup"})},_popvs_onmenusel:function(x,u){var w=this;w.setViewSize(w.$viewSize[u.id])},setMobileFrame:function(x,B,A){var w=this;w.$touchdivce=x;if(g.getClientMode()!="project"){w.panelDivInner.setCustomClass({KEY:x?"phonestyle xui-cursor-touch":""});if(!B){w.toolbar.updateItem("mobile",{value:!!x})}else{if(A!==a){w.markDirty(function(){w.setMobileFrame(!x,a,a)},function(){w.setMobileFrame(x,a,a)},(x?"hide":"show")+" mobile frame")}}}else{var u=w.panelDivInner.getRoot();w.panelDivInner.setCustomClass({KEY:x?"phonestyle xui-cursor-touch":""});w._desingviewdirty=true;if(x){if(q.get(w._cls,["Static","designViewConf"])){q.get(w._cls,["Static","designViewConf"]).touchDevice=true}u.addClass("phonestyle xui-cursor-touch")}else{if(q.get(w._cls,["Static","designViewConf"])){q.get(w._cls,["Static","designViewConf"]).touchDevice=false}u.removeClass("phonestyle xui-cursor-touch")}}},setViewSize:function(G,u){var B=this,D=B.canvas.getWidth(),A=B.canvas.getHeight(),x=D,E=A,C;if("width" in G){G.width=m(G.width,10);if(!q.isNumb(G.width)||G.width<=0){G.width=B.$viewSize["1280.23"].width}}if("height" in G){G.height=m(G.height,10);if(!q.isNumb(G.height)||G.height<=0){G.height=B.$viewSize["1280.23"].height}}if(G.width&&String(G.width)!=String(D)){B.panelBG.setWidth(G.width);B.canvas.setWidth(G.width);C=1}if(G.height&&String(G.height)!=String(A)){B.panelBG.setHeight(G.height);B.canvas.setHeight(G.height);C=1}if(C){D=m(G.width||D,10);A=m(G.height||A,10);var F=B.profileGrid;if(F&&(F=F.get(0).$widget)&&(F.get(0)==B.canvas.get(0))){B.profileGrid.updateCellByRowCol("properties:width","value",{value:D});B.profileGrid.updateCellByRowCol("properties:height","value",{value:A})}B.$curViewSize={width:D,height:A};if(g.getClientMode()!="project"){B.toolbar.updateItem("viewsize",{caption:D+" &#215 "+A});B._desingviewdirty=c;if(u!==a){B.markDirty(function(){B.setViewSize({width:x,height:E},a)},function(){B.setViewSize({width:D,height:A},a)},"set canvas view size to ["+D+","+A+"]")}}}},reLayout:function(u){this.toolbar.reLayout(u)},iniComponents:function(){var x=this,w=[],u=function(A){w.push(A.get(0))};u((new q.UI.Layout()).setHost(x,"layoutBase").setItems([{id:"before",pos:"before",size:170,min:100,max:300,locked:a,folded:a,hidden:c,cmd:c,itemDisplay:"display:none;"},{id:"main",min:10},{id:"after",pos:"after",size:280,min:100,max:500,locked:a,folded:a,hidden:a,cmd:c}]).setType("horizontal"));x.layoutBase.append((new q.UI.ToolBar()).setHost(x,"toolbar").setAutoIconColor(false).onClick("$toolbar_onclick"),"main");x.layoutBase.append((new q.UI.Panel()).setHost(x,"panelRight").setCaption("$RAD.designer.configwnd").setImageClass("spafont spa-icon-conf2").setCustomStyle({PANEL:"overflow:hidden"}),"after");x.panelRight.append((new q.UI.ComboInput()).setHost(x,"listObject").setDirtyMark(a).setDock("top").setType("popbox").setInputReadonly(c).beforeComboPop("$listobject_onlistshow"));x.panelRight.append((new q.UI.Block()).setHost(x,"prblock2").setDock("top").setHeight("2.66667em").setOverflow("hidden"));x.prblock2.append((new q.UI.ComboInput()).setHost(x,"propFilter").setHeight("2em").setDirtyMark(a).setDock("top").setDockMargin({left:4,top:4,right:4,bottom:4}).setType("input").setCommandBtn("delete").setTips("$(RAD.designer.tool.Filter) ").setDynCheck(c).setUnits("Show All;Modified Only").setUnit("Show All").setImageClass("xuicon xui-icon-filter").onChange("_propFilter_onchange").onCommand("_propFilter_oncmd").afterUnitUpdated("_propFilter_unit"));x.panelRight.append((new q.UI.TreeGrid()).setHost(x,"profileGrid").setDirtyMark(a).setEditable(c).setRowHandler(a).setRowNumbered(a).setColSortable(a).setActiveMode("cell").setHeader([{id:"key",caption:"$RAD.designer.gridcol1",width:120,type:"label"},{id:"value",caption:"$RAD.designer.gridcol2",width:100,type:"input",flexSize:c,cellStyle:"text-indent:2px;"}]).setTreeMode("infirstcell").onShowTips("$tg_tips").onGetContent("$profilegrid_onrequestdata").beforeCellUpdated("$profilegrid_beforecellvalueset").onEditorClick("$profilegrid_eclick").beforeComboPop("$prfilegrid_beforepop").onCommand("$profilegrid_cmd").onDblclickRow("$tg_dblclick"));x.layoutBase.append((new q.UI.Div()).setHost(x,"panelDiv").setDock("fill").setSpaceUnit("px").setCustomStyle({KEY:"overflow:auto;"}).setCustomClass({KEY:"xui-designer-root"}),"main");x.panelDiv.append((new q.UI.Div()).setHost(x,"panelDivInner").setLeft(10).setTop(10).setWidth("auto").setHeight("auto").setZIndex(10).setSpaceUnit("px").setOverflow("hidden").setCustomClass({KEY:"xui-designer-frame xui-uibase xui-designer-inner-control"}));x.panelDivInner.append((new q.UI.Div()).setHost(x,"panelBG").setLeft(0).setTop(0).setWidth(100).setHeight(100).setZIndex(10).setSpaceUnit("px").setPosition("relative").setCustomClass({KEY:"xui-designer-canvas xui-designer-inner-control"}));x.panelBG.append((new q.UI.Div()).setHost(x,"panelBGl").setWidth(100).setHeight(100).setCustomStyle({KEY:"font-size:0;line-height:0;position:absolute;left:0;top:0;width:10px;height:100%;background:url("+q.getPath("/RAD/img/","designer/left.gif")+") left top"}).setCustomClass({KEY:"xui-designer-inner-control"}));x.panelBG.append((new q.UI.Div()).setHost(x,"panelBGb").setWidth(100).setHeight(100).setCustomStyle({KEY:"font-size:0;line-height:0;position:absolute;left:0;bottom:0;height:10px;width:100%;background:url("+q.getPath("/RAD/img/","designer/top.gif")+") left bottom"}).setCustomClass({KEY:"xui-designer-inner-control"}));x.panelBG.append((new q.UI.Div()).setHost(x,"panelBGt").setWidth(100).setHeight(100).setCustomStyle({KEY:"font-size:0;line-height:0;position:absolute;left:0;top:0;height:10px;width:100%;background:url("+q.getPath("/RAD/img/","designer/top.gif")+") left top"}).setCustomClass({KEY:"xui-designer-inner-control"}));x.panelBG.append((new q.UI.Div()).setHost(x,"panelBGr").setWidth(100).setHeight(100).setCustomStyle({KEY:"font-size:0;line-height:0;position:absolute;right:0;top:0;width:10px;height:100%;background:url("+q.getPath("/RAD/img/","designer/left.gif")+") top right"}).setCustomClass({KEY:"xui-designer-inner-control"}));u((new q.UI.PopMenu()).setHost(x,"popViewSize").onMenuSelected("_popvs_onmenusel"));u((new q.UI.PopMenu()).setHost(x,"popAlign").onMenuSelected("_popalign_onmenusel"));u((new q.UI.PopMenu()).setHost(x,"popData").onMenuSelected("_popdata_onmenusel"));return w},iniExComs:function(u,x){var w=this;if(g.grid_showPropBinder){w.layoutBase.updateItem("after",{size:400})}w.layoutBase.append((new q.UI.Gallery).setHost(w,"iconlist").setIconOnly(c).setDirtyMark(a).setDock("bottom").setHeight(40).setZIndex(10).setDisplay("none").afterUIValueSet("$iconlist_aftervalueupdated").setCustomStyle({KEY:"border-'top':solid 1px #CDCDCD;"}).onContextmenu("_onIconlistMenu").onDblclick("_onIcondbl"),"main");w.iconlist.setDisplay("")}},Static:{destroy:function(){this.clearDirty();this._clearSelect();this._setSelected([],c);this.objlistBlock.destroy(c,c);this._resetHistory();if(this.treebarObj){this.treebarObj.destroy()}arguments.callee.upper.apply(this,arguments)}},Initialize:function(){var w=new f();w.src=q.ini.img_dd;w=d;var u=function(B){var A=arguments.callee;q.arr.each(B.$children,function(C){var C=q.SC.get(C);if(C.$children){A(C)}})};u(q.UI);if(g.getClientMode()=="project"){var x=function(B){var C=s();if(C&&C.curProjectPath){var E=g.getStatus(),D=E.projects||(E.projects=[]),A=q.arr.subIndexOf(D,"id",C.curProjectPath);if(A!=-1){q.arr.removeFrom(D,A)}if(C.tabsMain){D.push({caption:C.curProjectName,id:C.curProjectPath,file:C.tabsMain.getUIValue(),files:C.tabsMain.getItems("min")});if(D.length>=10){D.shift()}}if(B){q.merge(E,B,"all")}g.saveStatus(E)}};j.onbeforeunload=function(A){x({theme:q.getTheme(),lang:q.getLang()});if(q.browser.ie){j.event.returnValue=" "}else{return" "}};q.doc.onContextmenu(function(){return a})}}})}(window);xui.Class("RAD.ModuleDesigner","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dialog").setDockMargin({left:20,top:20,right:20,bottom:20}).setLeft("0em").setTop("0em").setWidth("50em").setHeight("30em").setCaption("$(RAD.custom_dlg.Module Designer)").setMinBtn(false).setMaxBtn(false).setMovable(false).setStatus("max").beforeClose("_beforeclose"));c.dialog.append(xui.create("xui.UI.Block").setHost(c,"paneMain").setDock("fill").setLeft("13.333333333333334em").setTop("3.3333333333333335em").setBorderType("inset"));c.dialog.append(xui.create("xui.UI.Block").setHost(c,"xui_ui_block3").setDock("bottom").setLeft("14.166666666666666em").setTop("4.166666666666667em").setHeight("3.3333333333333335em").setBorderType("none"));c.xui_ui_block3.append(xui.create("xui.UI.Div").setHost(c,"xui_ui_div15").setTop("0.25em").setWidth("22.916666666666668em").setHeight("3em").setRight("1em"));c.xui_ui_div15.append(xui.create("xui.UI.Button").setHost(c,"btnCancel").setLeft("4.083333333333333em").setTop("0.5em").setWidth("7.333333333333333em").setImageClass("spafont spa-icon-cancel").setCaption("$RAD.Cancel").onClick("_btncancel_onclick"));c.xui_ui_div15.append(xui.create("xui.UI.Button").setHost(c,"btnOK").setLeft("12.75em").setTop("0.5em").setWidth("7.333333333333333em").setImageClass("spafont spa-icon-ok").setCaption("$RAD.OK").onClick("_btnok_onclick"));return b},iniExComs:function(){var b=this;var a=new RAD.Designer();a.$moduleInnerMode=1;a.setHost(b,"_designer");a.setEvents("onValueChanged",function(d,c){b._dirty=b._dirty||c;b.fireEvent("onValueChanged",[b,b._dirty]);b.fireEvent("onDirty")});b.paneMain.append(a);b._designer=a},events:{onModulePropChange:"_onModulePropChange",onRender:"_onRender"},customAppend:function(b,a,d,c){this.dialog.showModal();return true},_onModulePropChange:function(){var a=this,d=a.properties;if(!("page" in d)){return}var b=d.page,c=d.targetProfile;a.$iniCode=b.getJSCode(b.getWidgets(true,c),c.KEY,c.$xid)},_onRender:function(b,c){var a=xui.get(SPA,["curProjectConfig","$PageAppearance"]);if(a&&a.theme){b.paneMain.setSandboxTheme(a.theme,true,'[class~="xui-designer-inner-control"]')}b._designer.refreshViewSize(null,false);xui.asyRun(function(){b._designer.refreshView(b.$iniCode,true)})},_beforeclose:function(){var a=this;if(a._dirty){xui.confirm(xui.getRes("RAD.notsave"),xui.getRes("RAD.notsave2"),function(){a._dirty=false;a.dialog.close()});return false}return true},_btncancel_onclick:function(b,d,f,c){var a=this;a._dirty=false;a.dialog.close()},_btnok_onclick:function(c,j,l,d){var b=this,g={},f={},a;xui.each(b._designer.$host,function(e,m){if(m=="$inDesign"||!e["xui.absBox"]||!e.n0){return}var n=e.get(0);a=g[n.alias]=n.serialize(false,false,false);f[n.alias]=n;delete a.key;delete a.alias;delete a.events;delete a["xui.Module"]});b.fireEvent("onFinished",[g,f]);b._dirty=false;b.dialog.close()}}});xui.Class("RAD.ToolBox","xui.Module",{Instance:{initialize:function(){this.autoDestroy=false;this.properties={}},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a((new xui.UI.Block()).setHost(c,"dlg").setZIndex(10000).setHeight("550px").setWidth("40px").setCustomStyle({}));c.dlg.append((new xui.UI.ToolBar()).setHandler(false).setAutoIconColor(false).setIconFontSize("1em").setHandler(false).setHost(c,"closebar").setHAlign("right").setItems([{id:"closegroup",sub:[{id:"close",imageClass:"xui-uicmd-close",hidden:true,tips:"隐藏工具栏"},{id:"open",imageClass:"xui-uicmd-toggle",tips:"展开工具栏"}]}]).onClick("_close_onclick"));c.dlg.append((new xui.UI.ButtonViews()).setHost(c,"treebarCom").setLeft("0em").setTop("0em").setAutoIconColor(false).setItems(xui.clone(CONF.widgets)).setBarLocation("left").setBarSize("7em").setSideBarStatus("fold").onItemSelected(function(j,q,l,d,m){var n=this,o=j.boxing(),f=q.sub;this.closebar.updateItem("close",{hidden:false});this.closebar.updateItem("open",{hidden:true});c.dlg.setWidth("19em");if(q.view=="Gallery"){var g=[];xui.arr.each(f,function(e){if(e.sub&&e.group&&e.sub.length>0){xui.arr.each(e.sub,function(r){g.push(r)})}else{g.push(e)}});o.append((new xui.UI.Div()).setHost(c,q.id+"Div").setLeft("0em").setTop("0.5em").setDock("fill").append((new xui.UI.Gallery()).setHost(c,q.id+"tree").setDragKey("___iDesign").setDock("fill").setSelMode("single").setIconFontSize("2em").setColumns(2).setItems(g).onStartDrag("_itembeforeMousedown").setCustomStyle({KEY:{"background-color":"#FFFFFF"},CONTENT:{margin:"0.5em"},COMMENT:{margin:"0.5em"},ITEMS:{"background-color":"#FFFFFF"},ITEMFRAME:{"background-color":"transparent","border-top":"dashed 1px #ababab","border-right":"dashed 1px #ababab","border-bottom":"dashed 1px #ababab","border-left":"dashed 1px #ababab",margin:"1px 1px 1px 1px"},},q.id)))}else{o.append((new xui.UI.Panel()).setHost(c,q.id+"panel").setLeft("0em").setTop("0em").setImageClass(q.imageClass).setCaption(q.caption+"组件").append((new xui.UI.TreeBar()).setHost(c,q.id+"tree").setDragKey("___iDesign").setDock("fill").setSelMode("none").setItems(q.sub).onStartDrag("_itembeforeMousedown").setCustomStyle({KEY:{"background-color":"#FFFFFF"}},q.id)))}}));return b},events:{onRender:"_com_onrender"},clearContent:function(){this.treebarCom.clearItems()},_close_onclick:function(b,g,d,c,f){this.closebar.getSubNode("MENU2").css("display","none");if(g.id=="close"){this.dlg.setWidth("40px");this.closebar.updateItem("close",{hidden:true});this.closebar.updateItem("open",{hidden:false})}else{if(g.id=="open"){this.dlg.setWidth("19em");var a=SPA.layout.getItems();xui.each(a,function(e){if(e.id=="before"&&e.folded){SPA.layout.fireCmdClickEvent("before")}});this.treebarCom.fireItemClickEvent("xui.UI.absContainer");this.closebar.updateItem("close",{hidden:false});this.closebar.updateItem("open",{hidden:true})}}},fillContent:function(a,c){var b=this;buildItems=function(d){var e=[];xui.each(d,function(f){if(f.key&&CONF.mapWidgets[f.key]){var g=CONF.mapWidgets[f.key];f.imageClass=CONF.mapWidgets[f.key].imageClass;if(!xui.str.startWith(f.id,f.className)){xui.id=f.className+"."+f.id}}f.children=f.sub;f.properties=f.iniProp;if(f.sub){f.sub=buildItems(f.sub)}});return d}},customAppend:function(b,a,d,c){return true},show2:function(){this.dlg.show()},hide:function(){this.dlg.hide()},_itembeforeMousedown:function(d,j,a){if(xui.Event.getBtn(j)!="left"){return}if(d.properties.disabled){return}if(!d.properties.dragKey){return}if(d.behavior.NoDraggableKeys){var g=d.getKey(xui.Event.getSrc(j).id||"").split("-")[1];if(g&&xui.arr.indexOf(d.behavior.NoDraggableKeys,g)!=-1){return}}var b=xui.use(a).id(),n=d.getSubId(b),l=d.properties,o=d.getItemByDom(b),m=xui.Event.getPos(j);var f=o.className;if(o.className&&o.key=="xui.Module"){f=o.className}else{f=o.key}if(o.draggable){var c=xui(a).clone(true);c.css("width","100%");d.getSubNode("ITEMICON",n).startDrag(j,{dragType:"icon",shadowFrom:c,dragCursor:"pointer",targetLeft:m.left-12,targetTop:m.top+12,dragKey:o.dragKey||d.properties.dragKey,dragData:{cls:o.cls||o.key,type:f,children:o.sub,caption:o.caption,iniProp:o.iniProp,iniEvents:o.iniEvents,customRegion:o.customRegion,image:o.image,imagePos:o.imagePos,imageClass:o.imageClass}});xui.use(a).tagClass("-hover",false);xui.use(a).tagClass("-active",false);if(RAD.Designer){xui.each(RAD.Designer.getAllInstance(),function(e){if(e&&!e.destroyed){e._clearSelect();if(e.resizer){e._setSelected([],true)}}})}return false}}}});xui.Class("RAD.ClassTree","xui.Module",{Instance:{initialize:function(){this.autoDestroy=false;this.properties={}},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a((new xui.UI.Panel()).setHost(c,"clsdlg").setLeft(0).setTop(0).setCaption("$RAD.toolbox.clsdlg").setDock("fill").setImageClass("fa fa-magic").setCustomStyle({PANEL:"overflow:hidden"}));c.clsdlg.append((new xui.UI.ComboInput()).setHost(c,"pattern").setName("pattern").setDock("top").setLeft("3.6666666666666665em").setTop("2em").setWidth("15em").setLabelSize("3em").setLabelCaption("$RAD.toolbox.search").setType("helpinput").onChange("_reload"));c.clsdlg.append((new xui.UI.TreeBar()).setHost(c,"treebarCom").setSelMode("none").setDragKey("___iDesign").onGetContent("_treebarcom_ongetcontent").setCustomStyle({KEY:{"background-color":"#FFFFFF"}}));return b},events:{onRender:"_com_onrender"},clearContent:function(){this.treebarCom.clearItems()},topNodes:[{id:"jds.localModule",key:"jds.localModule",caption:"$RAD.toolbox.localModule",group:true,iniFold:false,path:"Module",imageClass:"spafont spa-icon-module",dynDestory:true,sub:true},{id:"package",key:"jds.package",caption:"$RAD.toolbox.packageTree",group:true,iniFold:true,imageClass:"fa fa-cubes",sub:true},{id:"jds.extcomproject",key:"jds.extcomproject",caption:"$RAD.toolbox.extcomproject",group:true,imageClass:"spafont spa-icon-com",sub:true},{id:"project",key:"jds.project",caption:"$RAD.toolbox.projectcom",group:true,iniFold:true,imageClass:"fa fa-cloud",sub:true},{id:"database",key:"jds.database",caption:"$RAD.toolbox.dbcom",group:true,imageClass:"fa fa-database",sub:true}],_dlgpos:{},_dlgsize:{},_ctl_beforepop:function(c,a){var b=this;b.fireEvent("afterPop");a.properties={fill:"none",minBtn:true,maxBtn:false,landBtn:false,pinBtn:true};a.events={beforePin:function(d){b._dlgpos.left=d.properties.left;b._dlgpos.top=d.properties.top;b._dlgsize.width=d.properties.width;b._dlgsize.height=d.properties.height;b.fireEvent("afterLand",[b]);d.boxing().removeChildren().destroy()}};a.init=function(f,g,e){if(b._dlgpos.left){f.setLeft(b._dlgpos.left)}if(b._dlgpos.top){f.setTop(b._dlgpos.top)}if(b._dlgsize.width){f.setWidth(b._dlgsize.width)}if(b._dlgsize.height){f.setHeight(b._dlgsize.height)}f.setInitPos("auto");f.show(e.parent||xui("body"));var d=[];xui.arr.each(g.children,function(j){d.push(j[0])});if(d.length){f.append(xui.UI.pack(d,false))}return false}},buildItems:function(a){var b=[];xui.each(a,function(c){if(c.key&&CONF.mapWidgets[c.key]){var d=CONF.mapWidgets[c.key];c.imageClass=CONF.mapWidgets[c.key].imageClass;if(!xui.str.startWith(c.id,c.className)){xui.id=c.className+"."+c.id}}c.children=c.sub;c.properties=c.iniProp;if(c.sub){c.sub=buildItems(c.sub)}});return a},fillContent:function(c,e){var a=[],d=this;var b=this.topNodes;d.treebarCom.setItems(this.buildItems(b)).setCustomBehavior({BAR:{beforeMousedown:function(j,m,f){if(xui.Event.getBtn(m)!="left"){return}if(j.properties.disabled){return}if(!j.properties.dragKey){return}if(j.behavior.NoDraggableKeys){var l=j.getKey(xui.Event.getSrc(m).id||"").split("-")[1];if(l&&xui.arr.indexOf(j.behavior.NoDraggableKeys,l)!=-1){return}}var g=xui.use(f).id(),q=j.getSubId(g),n=j.properties,s=j.getItemByDom(g),o=xui.Event.getPos(m);if(s.draggable){var r=s.className?s.className:s.key;j.getSubNode("ITEMICON",q).startDrag(m,{dragType:"icon",shadowFrom:f,dragCursor:"pointer",targetLeft:o.left+12,targetTop:o.top+12,sub:true,dragKey:s.dragKey||j.properties.dragKey,dragData:{cls:s.cls||s.key,type:r,caption:s.caption,iniProp:s.iniProp,children:s.sub,iniEvents:s.iniEvents,customRegion:s.customRegion,image:s.image,imagePos:s.imagePos,imageClass:s.imageClass}});xui.use(f).tagClass("-hover",false);xui.use(f).tagClass("-active",false);if(RAD.Designer){xui.each(RAD.Designer.getAllInstance(),function(u){if(u&&!u.destroyed){u._clearSelect();if(u.resizer){u._setSelected([],true)}}})}return false}}}}).toggleNode("xui.UI.absForm",true).beforePrepareItem(function(g,j,f){if(j.key&&CONF.mapWidgets[j.key]){var l=CONF.mapWidgets[j.key];j.imageClass=CONF.mapWidgets[j.key].imageClass}})},customAppend:function(b,a,d,c){return true},show2:function(){this.clsdlg.show()},hide:function(){this.clsdlg.hide()},_reload:function(a,b){ns=this;ns.treebarCom.setItems(this.buildItems(this.topNodes));ns.treebarCom.fireItemClickEvent("package")},_treebarcom_ongetcontent:function(b,c,d){var a=this;switch(c.key){case"jds.extcomproject":xui.Ajax(CONF.GetExtComProjectTreeService,null,function(e){var g=e;if(!g||g.error){xui.message("No module in this project!");d(false)}else{var f=[];xui.arr.each(g.data,function(l,j){if(l.projectName!=SPA.curProjectName){f.push({id:l.id,cls:l.cls,key:"jds.package",packName:l.location,draggable:false,sub:true,iniFold:false,imageClass:l.imageClass|"fa fa-cubes",name:l.caption,caption:l.caption,projectName:l.projectName,iniProp:l.iniProp,caption:l.caption})}});d(f)}},function(e){d(false)}).start();break;case"jds.project":xui.Ajax(CONF.GetAllProjectTreeService,null,function(e){var g=e;if(!g||g.error){xui.message("No module in this project!");d(false)}else{var f=[];xui.arr.each(g.data,function(l,j){if(l.projectName!=SPA.curProjectName){f.push({id:l.id,cls:l.cls,key:"jds.package",packName:l.location,draggable:false,sub:true,imageClass:l.imageClass|"fa fa-cubes",name:l.caption,projectName:l.projectName,iniProp:l.iniProp,caption:l.caption})}});d(f)}},function(e){d(false)}).start();break;case"jds.localModule":xui.Ajax(CONF.getAllComponentsByPath,{path:c.path,pattern:a.pattern.getUIValue(),projectName:c.projectName?c.projectName:SPA.curProjectName},function(e){var g=e;if(!g||g.error){xui.message("No module in this project!");d(false)}else{var f=[];xui.arr.each(g.data,function(m,j){var l=xui.clone(m);if(m.alias){l.caption=m.alias}f.push(l)});d(f)}},function(e){d(false)}).start();break;case"jds.package":xui.Ajax(CONF.GetAllPackages,{pattern:a.pattern.getUIValue(),projectName:c.projectName?c.projectName:SPA.curProjectName},function(e){var g=e;if(!g||g.error){xui.message("No module in this project!");d(false)}else{var f=[];xui.arr.each(g.data,function(l,j){f.push({id:l.projectName+"."+l.id,cls:l.cls,key:"jds.localModule",path:l.location,draggable:false,sub:true,projectName:l.projectName,imageClass:"fa fa-th-large",name:l.caption,iniProp:l.iniProp,caption:l.caption})});d(f)}},function(e){d(false)}).start();break;case"jds.database":xui.Ajax(CONF.getTableTreesService,{text:"FDT",url:c.url?c.url:"console"},function(e){var g=e;if(!g||g.error){xui.message("No module in this project!");d(false)}else{var f=[];xui.arr.each(g.data,function(l,j){xui.arr.each(l.sub,function(n,m){n.key="db.table";n.sub=true;n.iniFold=true;n.draggable=false});f.push({id:l.id,cls:l.cls,url:l.url,iniFold:false,draggable:false,sub:l.sub,imageClass:l.imageClass,name:l.caption,iniProp:l.iniProp,caption:l.caption})});d(f)}},function(e){d(false)}).start();break;case"db.table":xui.Ajax(CONF.GetTableComponentsService,{url:c.url?c.url:"console",tableName:c.id,configKey:c.configKey},function(e){var g=e;if(!g||g.error){xui.message("No module in this project!");d(false)}else{var f=[];xui.arr.each(g.data,function(l,j){f.push({id:l.id,cls:l.cls,key:l.key,url:l.url,draggable:false,sub:true,imageClass:l.imageClass,name:l.caption,iniProp:l.iniProp,caption:l.caption})});d(g.data)}},function(e){d(false)}).start();break}}}});xui.Class("RAD.ServiceTree","xui.Module",{Instance:{initialize:function(){this.autoDestroy=false;this.properties={}},iniComponents:function(){var d=this,c=[],a=function(e){c.push(e.get(0))};a((new xui.UI.Block()).setHost(d,"servicedlg").setDock("fill").setBorderType("ridge").setCustomStyle({PANEL:"overflow:hidden"}));d.servicedlg.append((new xui.UI.ToolBar()).setHost(d,"servicetool").setHandler(false).onClick("_toolbar_onclick").setCustomStyle({ITEMS:"border-width:0 0 1px 0;"}));var b=[{id:"any",sub:[{id:"refresh",imageClass:"xui-refresh",caption:"",tips:"$RAD.tool2.refresh"},{id:"import",imageClass:"xui-uicmd-add",caption:"",tips:"$RAD.toolbox.importapi"}]}];d.servicetool.setItems(b);d.servicedlg.append((new xui.UI.ComboInput()).setHost(d,"pattern").setName("pattern").setDock("top").setLeft("3.6666666666666665em").setTop("2em").setWidth("15em").setLabelSize("3em").setLabelCaption("$RAD.toolbox.search").setType("helpinput").onChange("_reload"));d.servicedlg.append((new xui.UI.TreeBar()).setHost(d,"treebarCom").setSelMode("none").setDragKey("___iDesign").onGetContent("_treebarcom_ongetcontent").setCustomStyle({KEY:{"background-color":"#FFFFFF"}}));return c},clearContent:function(){this.treebarCom.clearItems()},topNodes:[{id:"pageService",key:"jds.getPageServiceToolBoxService",caption:"$RAD.toolbox.pageService",group:true,iniFold:false,imageClass:"spafont spa-icon-action1",sub:true},{id:"projectService",key:"jds.getProjectServiceToolBoxService",caption:"$RAD.toolbox.projectService",group:true,iniFold:false,imageClass:"fa fa-cubes",sub:true},{id:"localService",key:"jds.localService",caption:"$RAD.toolbox.cls",group:true,iniFold:true,imageClass:"spafont spa-icon-options",sub:true}],_buildItems:function(a){var b=[],c=this;xui.each(a,function(d){if(d.key&&CONF.mapWidgets[d.key]){var e=CONF.mapWidgets[d.key];d.imageClass=CONF.mapWidgets[d.key].imageClass}d.children=d.sub;d.properties=d.iniProp;if(d.sub){d.sub=c._buildItems(d.sub)}});return a},fillContent:function(b,d){var a=[],c=this;c.treebarCom.setItems(c._buildItems(this.topNodes)).setCustomBehavior({BAR:{beforeMousedown:function(j,m,f){if(xui.Event.getBtn(m)!="left"){return}if(j.properties.disabled){return}if(!j.properties.dragKey){return}if(j.behavior.NoDraggableKeys){var l=j.getKey(xui.Event.getSrc(m).id||"").split("-")[1];if(l&&xui.arr.indexOf(j.behavior.NoDraggableKeys,l)!=-1){return}}var g=xui.use(f).id(),q=j.getSubId(g),n=j.properties,r=j.getItemByDom(g),o=xui.Event.getPos(m);if(r.draggable){j.getSubNode("ITEMICON",q).startDrag(m,{dragType:"icon",shadowFrom:f,dragCursor:"pointer",targetLeft:o.left+12,targetTop:o.top+12,sub:true,dragKey:r.dragKey||j.properties.dragKey,dragData:{cls:r.cls||r.key,type:r.key,caption:r.caption,iniProp:r.iniProp,children:r.sub,iniEvents:r.iniEvents,customRegion:r.customRegion,image:r.image,imagePos:r.imagePos,imageClass:r.imageClass}});xui.use(f).tagClass("-hover",false);xui.use(f).tagClass("-active",false);if(RAD.Designer){xui.each(RAD.Designer.getAllInstance(),function(e){if(e&&!e.destroyed){e._clearSelect();if(e.resizer){e._setSelected([],true)}}})}return false}}}}).beforePrepareItem(function(f,g,e){if(g.key&&CONF.mapWidgets[g.key]){var j=CONF.mapWidgets[g.key];g.imageClass=CONF.mapWidgets[g.key].imageClass}});c._reload()},customAppend:function(b,a,d,c){return true},show2:function(){this.servicedlg.show()},hide:function(){this.servicedlg.hide()},_reload:function(a,b){ns=this;ns.treebarCom.setItems(ns._buildItems(this.topNodes));ns.treebarCom.fireItemClickEvent("pageService")},_toolbar_onclick:function(b,c,f,d,g){var a=this;switch(c.id){case"refresh":a.treebarCom.setItems(a._buildItems(this.topNodes));break;case"import":xui.getModule("RAD.api.APITree",function(){this.setData({projectName:SPA.curProjectName});this.show();this.initData();this._fireEvent("afterShow")});break}},_treebarcom_ongetcontent:function(a,b,c){ns=this;if(b.key=="jds.localService"){xui.Ajax(CONF.getLocalServiceToolBoxService,{projectName:SPA.curProjectName,pattern:ns.pattern.getUIValue()},function(d){var e=d;if(!e||e.error){xui.message("No module in this project!");c(false)}else{c(ns._buildItems(e.data))}},function(d){c(false)},null,{method:"post"}).start()}else{if(b.key=="jds.getPageServiceToolBoxService"){xui.Ajax(CONF.getPageServiceToolBoxService,{projectName:SPA.curProjectName,className:SPA.currentClassName,pattern:ns.pattern.getUIValue()},function(d){var e=d;if(!e||e.error){xui.message("No module in this project!");c(false)}else{c(ns._buildItems(e.data))}},function(d){c(false)},null,{method:"post"}).start()}else{if(b.key=="jds.getProjectServiceToolBoxService"){xui.Ajax(CONF.getProjectServiceToolBoxService,{projectName:SPA.curProjectName,pattern:ns.pattern.getUIValue()},function(d){var f=d;if(!f||f.error){xui.message("No module in this project!");c(false)}else{var e=[];c(ns._buildItems(f.data))}},function(d){c(false)},null,{method:"post"}).start()}else{if(b.key=="jds.Server"){xui.Ajax(CONF.getRemoteServiceByKeyService,{projectName:SPA.curProjectName,pattern:ns.pattern.getUIValue(),serverId:b.id},function(d){var f=d;if(!f||f.error){xui.message("No service in this project!");c(false)}else{var e=[];c(f.data)}},function(d){c(false)},null,{method:"post"}).start()}}}}}}});xui.Class("RAD.ProjectTree","xui.Module",{Instance:{Dependencies:[],Required:[],events:{},initialize:function(){},iniComponents:function(){var d=this,c=[],b={},a=function(e){c.push(e.get(0))};xui.merge(b,this.properties);a(xui.create("xui.APICaller").setHost(d,"openFolder").setName("openFolder").setQueryAsync(false).setQueryURL(CONF.openOtherFolderService).setQueryMethod("POST").setRequestDataSource([{type:"treeview",name:"xui_ui_treeview27",path:""}]).setResponseDataTarget([]).setResponseCallback([]));a(xui.create("xui.APICaller").setHost(d,"getProjectTree").setName("getProjectTree").setAutoRun(true).setQueryURL(CONF.getAllProjectTreeSrvice).setRequestDataSource([{name:"dialog",path:"",type:"form"}]).setResponseDataTarget([{name:"xui_ui_treeview27",path:"data",type:"treeview"},{name:"dialog",path:"data",type:"form"}]).setResponseCallback([]));a(xui.create("xui.APICaller").setHost(d,"copyTo").setName("copyTo").setQueryAsync(false).setQueryURL(CONF.importFileService).setQueryMethod("POST").setRequestDataSource([{type:"treeview",name:"xui_ui_treeview27",path:""},{type:"form",name:"dialog",path:""}]).setResponseDataTarget([]).setResponseCallback([]).onData("_copyto_ondata"));a(xui.create("xui.UI.Dialog").setHost(d,"dialog").setLeft("12.5em").setTop("7.5em").setHeight("37.5em").setCaption("$RAD.toolbox.selectResource").setImageClass("fa fa-cubes"));d.dialog.append((new xui.UI.ComboInput()).setHost(d,"pattern").setName("pattern").setDock("top").setLeft("3.6666666666666665em").setTop("2em").setWidth("15em").setLabelSize("3em").setLabelCaption("$RAD.toolbox.search").setType("helpinput").onChange("_reload"));d.dialog.append(xui.create("xui.UI.HiddenInput").setHost(d,"projectName").setName("projectName").setValue(SPA.curProjectName));d.dialog.append(xui.create("xui.UI.HiddenInput").setHost(d,"tpath").setName("tpath").setValue(""));d.dialog.append(xui.create("xui.UI.Block").setHost(d,"xui_ui_block249").setDock("bottom").setLeft("7.5em").setTop("18.333333333333332em").setHeight("3.5833333333333335em"));d.xui_ui_block249.append(xui.create("xui.UI.Button").setHost(d,"xui_ui_button38").setLeft("8.333333333333334em").setTop("0.8333333333333334em").setCaption("确定").setImageClass("iconfont iconduigoux").onClick([{args:["$RAD.toolbox.selectResource","$RAD.toolbox.selectResource"],conditions:[{left:"{page.xui_ui_treeview27.getUIValue()}",right:"",symbol:"empty"}],desc:"动作 3",method:"alert",target:"msg",type:"other",onOK:2},{args:["{page.copyTo.invoke()}"],desc:"动作 2",koFlag:"_DI_fail",method:"invoke",okFlag:"_DI_succeed",target:"copyTo",type:"control",redirection:"other:callback:call"}]));d.dialog.append(xui.create("xui.UI.TreeView").setHost(d,"xui_ui_treeview27").setName("lefttree").setItems([{caption:"$RAD.toolbox.allProject",disabled:true,hidden:false,id:"root",iniFold:false}]).setLeft("0em").setTop("0em").setIniFold(false).setSelMode("multibycheckbox").setOptBtn("xui-uicmd-opt").setTogglePlaceholder(true).setValue("").onGetContent({actions:[{args:["{page.openFolder.setQueryData()}",null,null,"{args[1]}",""],desc:"动作 1",method:"setQueryData",redirection:"other:callback:call",target:"openFolder",type:"control"},{args:["{page.openFolder.invoke()}",null,null,"{args[2]}"],desc:"动作 3",method:"call",target:"callback",type:"other"}],"return":"{temp.okData.data}"}));return c},_reload:function(a,b){ns=this;ns.treebarCom.setItems(buildItems(this.topNodes));ns.treebarCom.fireItemClickEvent("localService")},_copyto_ondata:function(d,c,f){var b=this,a=d.boxing();var e=c;if(e&&e.requestStatus!=-1){b.fireEvent("onOK",[e.data]);b.dialog.close();b.destroy()}else{if(e&&!e.error){xui.message(xui.get(e,["error","errdes"])||e||"no response!")}else{xui.message(xui.get(e,["error","errdes"])||e||"no response!")}}},customAppend:function(b,a,d,c){return false}}});xui.Class("RAD.ProjectModuleTree","xui.Module",{Instance:{Dependencies:[],Required:[],events:{},initialize:function(){},iniComponents:function(){var d=this,c=[],b={},a=function(e){c.push(e.get(0))};xui.merge(b,this.properties);a(xui.create("xui.APICaller").setHost(d,"openFolder").setName("openFolder").setQueryAsync(false).setQueryURL(CONF.openOtherFolderService).setQueryMethod("POST").setRequestDataSource([]).setResponseDataTarget([]).setResponseCallback([]));a(xui.create("xui.APICaller").setHost(d,"getProjectTree").setName("getProjectTree").setAutoRun(true).setQueryURL(CONF.GetExtModuleProjectTreeService).setRequestDataSource([{name:"dialog",path:"",type:"form"}]).setResponseDataTarget([{name:"xui_ui_treeview27",path:"data",type:"treeview"},{name:"dialog",path:"data",type:"form"}]).setResponseCallback([]));a(xui.create("xui.APICaller").setHost(d,"copyTo").setName("copyTo").setQueryAsync(false).setQueryURL(CONF.importFileService).setQueryMethod("POST").setRequestDataSource([{type:"treeview",name:"xui_ui_treeview27",path:""},{type:"form",name:"dialog",path:""}]).setResponseDataTarget([]).setResponseCallback([]).onData("_copyto_ondata"));a(xui.create("xui.UI.Dialog").setHost(d,"dialog").setLeft("12.5em").setTop("7.5em").setHeight("37.5em").setCaption("选择资源").setImageClass("fa fa-cubes"));d.dialog.append(xui.create("xui.UI.HiddenInput").setHost(d,"projectName").setName("projectName").setValue(SPA.curProjectName));d.dialog.append(xui.create("xui.UI.HiddenInput").setHost(d,"tpath").setName("tpath").setValue(""));d.dialog.append(xui.create("xui.UI.Block").setHost(d,"xui_ui_block249").setDock("bottom").setLeft("7.5em").setTop("18.333333333333332em").setHeight("3.5833333333333335em"));d.xui_ui_block249.append(xui.create("xui.UI.Button").setHost(d,"xui_ui_button38").setLeft("8.333333333333334em").setTop("0.8333333333333334em").setCaption("确定").setImageClass("iconfont iconduigoux").onClick([{args:["请选择资源"," 请选择资源"],conditions:[{left:"{page.xui_ui_treeview27.getUIValue()}",right:"",symbol:"empty"}],desc:"动作 3",method:"alert",target:"msg",type:"other",onOK:2},{args:["{page.copyTo.invoke()}"],desc:"动作 2",koFlag:"_DI_fail",method:"invoke",okFlag:"_DI_succeed",target:"copyTo",type:"control",redirection:"other:callback:call"}]));d.dialog.append(xui.create("xui.UI.TreeView").setHost(d,"xui_ui_treeview27").setName("lefttree").setItems([{caption:"所有工程",disabled:true,hidden:false,id:"root",iniFold:false}]).setLeft("0em").setTop("0em").setIniFold(false).setSelMode("multibycheckbox").setOptBtn("xui-uicmd-opt").setTogglePlaceholder(true).setValue("").onGetContent({actions:[{args:["{page.openFolder.setQueryData()}",null,null,"{args[1]}",""],desc:"动作 1",method:"setQueryData",redirection:"other:callback:call",target:"openFolder",type:"control"},{args:["{page.openFolder.invoke()}",null,null,"{args[2]}"],desc:"动作 3",method:"call",target:"callback",type:"other"}],"return":"{temp.okData.data}"}));return c},_copyto_ondata:function(d,c,f){var b=this,a=d.boxing();var e=c;if(e&&e.requestStatus!=-1){b.fireEvent("onOK",[e.data]);b.dialog.close();b.destroy()}else{if(e&&!e.error){xui.message(xui.get(e,["error","errdes"])||e||"no response!")}else{xui.message(xui.get(e,["error","errdes"])||e||"no response!")}}},customAppend:function(b,a,d,c){return false}}});xui.Class("RAD.AddFile","xui.Module",{Instance:{_serial:1,customAppend:function(l){var g=this,f=g.dialog,a=g.properties,b=a.parent;if(!f.get(0).renderId){f.render()}var e=a.fileName||"newFileName";var c=a.parentPath;if(SPA.curProjectPath){var d=SPA.curProjectPath;if(d.indexOf("VVVERSION")>-1){d=d.replace("VVVERSION","(V")+")"}if(c==d){c=""}else{if(c+"/"==d){c=""}else{c=xui.replace(a.parentPath,d,"")}}}var j="$RAD.addfile.addfile";var m=c;switch(a.type){case"prj":g.input.setType("input");g.input.resetValue(e);j="$RAD.addfile.addproject";break;case"file":e="";g.input.setValue("",true);g.input.setType("file");g.input.getSubNode("INPUT").attr("accept",CONF.fileAccept);j="$RAD.addfile.导入文件";break;case"class":e="";g.input.setType("input");g.input.resetValue(e);if(c){c=xui.replace(c,"/",".");if(xui.str.endWith(c,".")){c=c.substring(0,c.length-1)}}j="$RAD.addfile.newpage";m=c+e;break;case"/":e=e+((new Date).getMinutes()+(g._serial++));g.input.setType("input");g.input.resetValue(e);j="$RAD.addfile.newfolder";if(xui.str.endWith(c,"/")){m=c+e}else{m=c+"/"+e}break;case"folder":e=e+((new Date).getMinutes()+(g._serial++));g.input.setType("input");g.input.resetValue(e);j="$RAD.addfile.newfolder";m=c+e+a.tailTag;break;case"json":e=e+((new Date).getMinutes()+(g._serial++));g.input.setType("input");g.input.resetValue(e);j="$RAD.addfile.newjson";break;default:e=e+((new Date).getMinutes()+(g._serial++));g.input.setType("input");g.input.resetValue(e)}g.dialog.setCaption(j);g._pPath=c;if(a.type=="module"&&!xui.str.startWith(g._pPath,SPA.curProjectPath+"/Module")){g._pPath=SPA.curProjectPath+"/Module"}g.inputTarget.resetValue(m).setTips(m);g.blockTypeCap.setHtml("<div style='padding:2px 0 0 2px'>"+a.typeCaption+"</div>");f.showModal(l);return true},reset:function(){var a=this;a.input.setValue("",true).setType("none");a.inputTarget.setValue("",true).setTips("")},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dialog").setLeft("8.625em").setTop("3.625em").setWidth("40em").setHeight("13.5em").setResizer(false).setImageClass("spafont spa-icon-newfile").setMinBtn(false).setMaxBtn(false).setOverflow("hidden").onHotKeydown("_dialog_onhotkey").beforeClose("_dialog_beforeclose"));c.dialog.append(xui.create("xui.UI.Block").setHost(c,"ctl_block8").setLeft("0.375em").setTop("0.3125em").setWidth("37.916666666666664em").setHeight("5.916666666666667em").setBorderType("inset").setOverflow("hidden"));c.ctl_block8.append(xui.create("xui.UI.Label").setHost(c,"label3").setLeft("24.083333333333332em").setTop("3.5833333333333335em").setWidth("4.375em").setCaption("$RAD.addfile.filetype"));c.ctl_block8.append(xui.create("xui.UI.ComboInput").setHost(c,"input").setDefaultFocus(true).setLeft("1.25em").setTop("3.25em").setWidth("22em").setDynCheck(true).setLabelSize("8.333333333333334em").setLabelCaption("$RAD.addfile.filename").setType("none").beforeUIValueSet("_beforeInpuSet").afterUIValueSet("_refresh"));c.ctl_block8.append(xui.create("xui.UI.ComboInput").setHost(c,"inputTarget").setReadonly(true).setLeft("1.25em").setTop("0.75em").setWidth("35.5em").setLabelSize("8.333333333333334em").setLabelCaption("$RAD.addfile.target").setType("none"));c.ctl_block8.append(xui.create("xui.UI.Block").setHost(c,"blockTypeCap").setLeft("28.833333333333332em").setTop("3.3333333333333335em").setWidth("7.916666666666667em").setHeight("1.75em").setBorderType("inset"));c.dialog.append(xui.create("xui.UI.Button").setHost(c,"btnCancel").setLeft("10.833333333333334em").setTop("7.166666666666667em").setWidth("7.833333333333333em").setTabindex(3).setImageClass("spafont spa-icon-cancel").setCaption("$RAD.cancel").onClick("_btncancel_onclick"));c.dialog.append(xui.create("xui.UI.Button").setHost(c,"btnOK").setLeft("21.416666666666668em").setTop("7.166666666666667em").setWidth("7.833333333333333em").setTabindex(4).setImageClass("spafont spa-icon-ok").setCaption("$RAD.ok").onClick("_btnok_onclick"));return b},_dialog_beforeclose:function(a){this.properties={};this.dialog.hide();return false},_btncancel_onclick:function(a,c,b){this.dialog.close()},_beforeInpuSet:function(d,b,a){var c=this;if(d.properties.type=="file"&&a){a=c._adjuestFileName(a);if(!CONF.fileNames.test(a)){xui.message(xui.getRes("RAD.addfile.invalidName"));return false}}},_refresh:function(c,a,e){var b=this,d=b._pPath,f=b.properties;e=b._adjuestFileName(e);if(e.indexOf(".")>-1){if(d){if(!xui.str.endWith(d,"/")){d=d+"/"}d=xui.replace(d,"\\.","/")}if(xui.str.endWith(e,".cls")){f.tailTag=".cls";f.type="class"}else{f.tailTag="textfile";f.type="textfile"}b.blockTypeCap.setHtml("<div style='padding:2px 0 0 2px'>"+e.substring(e.indexOf("."))+"</div>");e=d+e}else{switch(f.tailTag){case".cls":e=e+f.tailTag;if(d){e=d+"."+e}break;case"folder":if(d){e=d+"."+e}e=d+e;break;case"/":e=d+e;break;default:e=d+e+f.tailTag}}b.inputTarget.resetValue(e)},_adjuestFileName:function(a){return a.replace(/^ +/,"").replace(/[\. ]*$/,"").replace(/\"/g,"")},_btnok_onclick:function(a,c,b){this._apply()},_apply:function(){var g=this,a=g.properties,f=a.type,c=g.input.getUIValue(),b=f=="file"?g.input.getUploadObj():null,d=g._pPath,j;c=g._adjuestFileName(c);if(a.blankmodule||f=="page"||f=="module"||f=="prj"){if(!CONF.fileNames2.test(c)){xui.alert(xui.adjustRes("$(RAD.tpl.Allows letters and numbers only, the first must be a letter)"));return}}if(!c){xui.message(xui.getRes("RAD.addfile.notarget"));return}else{if(f=="file"){c==b.value}else{if(!CONF.fileNames.test(c)){xui.message(xui.getRes("RAD.addfile.filenameformat"));g.input.activate();return}if(a.blankmodule){j="xui.Module"}}g.dialog.busy(xui.adjustRes("$(RAD.tpl.Building the template)..."));switch(f){case"prj":xui.Ajax(CONF.newProject,{tempName:a.tempName,path:d,projectName:c},function(m){var n=m;g.dialog.free();if(n&&n.requestStatus!=-1){g.dialog.close();$ESD.openProject(c)}else{if(n&&!n.error){xui.message(xui.get(n,["error","errdes"])||n||"no response!")}else{xui.message(xui.get(n,["error","errdes"])||n||"no response!")}}},null,null,{method:"POST"}).start();break;case"class":var e=g._pPath?g._pPath+"."+c:c;xui.Ajax(CONF.addClass,{className:e,projectName:SPA.curProjectName},function(m){var n=m;g.dialog.free();if(n&&n.requestStatus!=-1){g.dialog.close();g.fireEvent("onOK",[n.data,f])}else{if(n&&!n.error){xui.message(xui.get(n,["error","errdes"])||n||"no response!")}else{xui.message(xui.get(n,["error","errdes"])||n||"no response!")}}},null,null,{method:"POST"}).start();break;case"textfile":var l=g._pPath?g._pPath+"."+c:c;xui.Ajax(CONF.addTextFile,{path:l,projectName:SPA.curProjectName},function(m){var n=m;g.dialog.free();if(n&&n.requestStatus!=-1){g.dialog.close();g.fireEvent("onOK",[n.data,f])}else{if(n&&!n.error){xui.message(xui.get(n,["error","errdes"])||n||"no response!")}else{xui.message(xui.get(n,["error","errdes"])||n||"no response!")}}},null,null,{method:"POST"}).start();break;case"page":var e=g._pPath?g._pPath+"."+c:c;xui.Ajax(CONF.addFromTpl,{tempPath:a.packagePath?a.packagePath+"App/index.js":"",className:e,projectName:SPA.curProjectName},function(m){var n=m;g.dialog.free();if(n&&n.requestStatus!=-1){g.dialog.close();g.fireEvent("onOK",[n.path,c,f])}else{if(n&&!n.error){xui.message(xui.get(n,["error","errdes"])||n||"no response!")}else{xui.message(xui.get(n,["error","errdes"])||n||"no response!")}}},null,null,{method:"POST"}).start();break;case"module":xui.Ajax(CONF.addModule,{className:g._pPath+"."+c,projectName:SPA.curProjectName},function(m){var n=m;g.dialog.free();if(n&&n.requestStatus!=-1){g.dialog.close();g.fireEvent("onOK",[n.data,f])}else{if(n&&!n.error){xui.message(xui.get(n,["error","errdes"])||n||"no response!")}else{xui.message(xui.get(n,["error","errdes"])||n||"no response!")}}},null,null,{method:"POST"}).start();break;case"/":xui.Ajax(CONF.addFolder,{projectName:SPA.curProjectName,path:d+c,fileName:c},function(m){var n=m;g.dialog.free();if(n&&n.requestStatus!=-1){g.dialog.close();g.fireEvent("onOK",[n.data,f])}else{if(n&&!n.error){xui.message(xui.get(n,["error","errdes"])||n||"no response!")}else{xui.message(xui.get(n,["error","errdes"])||n||"no response!")}}},null,null,{method:"POST"}).start();break;default:xui.IAjax(CONF.addFile,{path:d,content:a.content,file:b,type:f=="/"?"dir":"file",projectName:SPA.curProjectName,fileName:c},function(m){var n=m;g.dialog.free();if(n&&n.requestStatus!=-1){g.fireEvent("onOK",[n.data,f]);g.dialog.close();g.input.resetValue(null);g.destroy()}else{if(n&&!n.error){xui.message(xui.get(n,["error","errdes"])||n||"no response!");g.dialog.close();g.input.resetValue(null);g.destroy()}else{xui.message(xui.get(n,["error","errdes"])||n||"no response!")}}},function(m){g.dialog.free();g.fireEvent("onOK",[d,d+"/"+c,c,f]);g.dialog.close();g.destroy()},"test",{method:"POST",rspType:"json"}).start();break}}},_dialog_onhotkey:function(b,a){if(a.key=="esc"){b.boxing().close()}}}});xui.Class("RAD.DelFile","xui.Module",{Instance:{customAppend:function(c){var b=this,e=b.properties,a=e.parent,d=b.dialog;if(e.fromRegion){d.setFromRegion(e.fromRegion)}if(!d.get(0).renderId){d.render()}b.treebar.resetValue();d.show(c,true);CONF.callService({key:CONF.requestKey,curProjectPath:SPA.curProjectPath,paras:{action:"open",hashCode:xui.id(),path:a.curProjectPath}},function(f){var j=f;if(!j||j.error){xui.message(xui.get(j,["error","errdes"])||"no response!")}else{var g=a.buildFileItems(a.curProjectPath,j.data.files||j.data);b.treebar.setItems([g]).toggleNode(g.id,true)}})},_dialog_beforeclose:function(a){this.dialog.hide();return false},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dialog").setLeft("15.4375em").setTop("7.5em").setWidth("27.0625em").setHeight("15.083333333333334em").setResizer(false).setCaption("$RAD.tool2.del").setImageClass("spafont spa-icon-deletefile").setMinBtn(false).setMaxBtn(false).onHotKeydown("_dialog_onhotkey").beforeClose("_dialog_beforeclose"));c.dialog.append(xui.create("xui.UI.Group").setHost(c,"panelbar2").setDock("top").setDockMargin({left:6,top:0,right:6,bottom:0}).setHeight("8.75em").setCaption("$RAD.delfile.sel").setToggleBtn(false).setCustomStyle({PANEL:"overflow:auto"}));c.panelbar2.append(xui.create("xui.UI.TreeBar").setHost(c,"treebar").setDock("none").setWidth("auto").setHeight("auto").setPosition("relative").setSelMode("multi").setValue("").beforeUIValueSet("_treebar_beforevalueupdated").onGetContent("_treebar_ongetcontent"));c.dialog.append(xui.create("xui.UI.Button").setHost(c,"btnCancel").setLeft("5em").setTop("9.375em").setWidth("6.916666666666667em").setImageClass("spafont spa-icon-cancel").setCaption("$RAD.cancel").onClick("_btncancel_onclick"));c.dialog.append(xui.create("xui.UI.Button").setHost(c,"btnOK").setLeft("15.625em").setTop("9.375em").setWidth("6.916666666666667em").setImageClass("spafont spa-icon-ok").setCaption("$RAD.ok").onClick("_btnok_onclick"));return b},_btncancel_onclick:function(a,c,b){this.dialog.close()},_btnok_onclick:function(c,f,d){var b=this.treebar.getUIValue(),a=this;if(!b){xui.message(xui.getRes("RAD.delfile.notarget"))}else{xui.UI.Dialog.confirm(xui.getRes("RAD.delfile.confirmdel"),xui.getRes("RAD.delfile.confirmdel2",b.split(";").length),function(){xui.tryF(a.properties.onOK,[b],a.host);a.dialog.close()})}},_treebar_beforevalueupdated:function(c,b,d){if(!d){return}var a=d.split(";");a.sort();xui.filter(a,function(n,f){for(var g=0,e=this.length;g<e;g++){if(g==f){break}var m=this[f].replace(this[g],"");if(m!=this[f]&&(m.indexOf("/")!=-1||m.indexOf("\\")!=-1)){return false}}});return a.join(";")},_dialog_onhotkey:function(b,a){if(a.key=="esc"){b.boxing().close()}},_treebar_ongetcontent:function(b,c,d){var a=this;CONF.callService({key:CONF.requestKey,curProjectPath:SPA.curProjectPath,paras:{action:"open",hashCode:xui.id(),path:c.id}},function(e){var g=e;if(g&&!g.error){var f=a.properties.parent.buildFileItems(c.id,g.data.files||g.data);d(f.sub)}else{xui.message(g.error.message)}})}}});xui.Class("RAD.About","xui.Module",{Instance:{initialize:function(){},Dependencies:[],Required:[],properties:{},events:{},functions:{},iniComponents:function(){var d=this,c=[],b={},a=function(e){c.push(e.get(0))};xui.merge(b,this.properties);a(xui.create("xui.UI.Dialog").setHost(d,"xui_ui_dialog17").setLeft("9.166666666666666em").setTop("5.833333333333333em").setWidth("32.833333333333336em").setHeight("17.833333333333332em").setResizer(false).setCaption("$RAD.menu.about").setMinBtn(false).setMaxBtn(false).setOverflow("hidden"));d.xui_ui_dialog17.append(xui.create("xui.UI.Div").setHost(d,"xui_ui_div43").setLeft("1.6666666666666667em").setTop("0.625em").setWidth("27.916666666666668em").setHeight("3.75em").setHtml("<b><i>onecode<br>联合推出的云原生代码工具</i></b>"));d.xui_ui_dialog17.append(xui.create("xui.UI.Button").setHost(d,"xui_ui_button23").setLeft("11.666666666666666em").setTop("11.583333333333334em").setWidth("9.166666666666666em").setHeight("2.5em").setZIndex("10").setCaption("$inline.ok").onClick([{desc:"动作 1",type:"page",target:"RAD.About",args:[],method:"destroy"}]));d.xui_ui_dialog17.append(xui.create("xui.UI.Image").setHost(d,"xui_ui_image13").setLeft("15.833333333333334em").setTop("-2.0833333333333335em").setWidth("3.8333333333333335em").setHeight("3.4166666666666665em").setActiveItem("/RAD/img/logo.png").onClick([{desc:"url",type:"other",target:"url",params:["http://www.itjds.com:81"],method:"open--_blank"}]));d.xui_ui_dialog17.append(xui.create("xui.UI.Label").setHost(d,"xui_ui_label29").setLeft("5.833333333333333em").setTop("6.666666666666667em").setWidth("17.25em").setCaption("联系方式：18618287247"));d.xui_ui_dialog17.append(xui.create("xui.UI.Label").setHost(d,"xui_ui_label30").setLeft("10.416666666666666em").setTop("7.916666666666667em").setWidth("12.666666666666666em").setHeight("2.4166666666666665em").setCaption("微信：wenzhanglwz"));return c}},Static:{}});xui.Class("UIDesigner","xui.Module",{Instance:{$classEditor:null,$pageviewType:"xui.UI.Tabs",$firstView:"design",$dftCodePath:"/template/",$dftCodeFileName:"index.js",$fetchedCode:"",$iniCode:"",$url:"",$dirty:false,fe:function(b,a){if(this.events[b]){return this.fireEvent(b,a)}},onDestroy:function(){this.$classEditor.destroy()},events:{onReady:function(){SPA=this;xui.ComFactory.setProfile(CONF.ModuleFactoryProfile)},onRender:function(a,b){a.setValue(a.$fetchedCode||a.$iniCode,a.$fetchedurl);a.$classEditor.setDftPage(a.$firstView);xui.CSS.addStyleSheet(xui.UI.buildCSSText({".xui-designer-root .xui-designer-canvas":{"background-image":"url("+xui.getPath("img/designer/","bg.gif")+")","background-position":"left top","background-repeat":"repeat","background-color":"","background-attachment":""}}),"xui.UI.design",null,true)},afterIniComponents:function(){var b=this,a;b.appRoot.append(b.$btnRun=new xui.UI.Button({caption:xui.wrapRes("RAD.builder.run"),tips:"$RAD.builder.runTips",zIndex:100,left:"auto",top:6,right:300,width:"6em",height:"5em",type:"custom",border:true,renderer:function(c){return"<img src=img/run.gif /><br />"+c.caption}},{onClick:function(){var d=b.getValue(),c=RAD.ClassTool.getClassName(d);if(false===d){return}if(!c){xui.message(xui.getRes("RAD.classtool.noClass"));return false}CONF.debugApp(CONF.testPath,"",{testTpl:CONF.testTpl,clsName:c,content:d,path:path,theme:SPA.$curTheme||"default",lang:xui.getLang()},true,"post")}}));b.appRoot.append(b.$btnSave=new xui.UI.Button({id:"save",caption:"保存",tips:"保存",zIndex:101,left:"auto",top:6,right:210,width:"6em",height:"5em",type:"custom",border:true,renderer:function(c){return"<img src=img/save.png /><br />保存本地"}},{onClick:function(){var c=b.getValue();if(path.indexOf(".vv")>-1||path.indexOf(".cls")>-1||path.indexOf(".module")>-1||path.indexOf(".js")>-1){clsName=RAD.ClassTool.getClassName(c);if(false===c){return}if(!clsName){xui.message(xui.getRes("RAD.classtool.noClass"));return false}}CONF.saveAS("/RAD/save",{content:c,path:path},"post")}}))}},iniResource:function(c,g){if(xui.Dom.byId("_post_data")){var b=xui("_post_data").text();b=xui.str.trim(b);if(b&&b.length>1){c.$iniCode=c.$fetchedCode=b;return}}var c=this,d=xui.urlDecode(location.href.split("#")[1],"url");xui.Thread.suspend(g);var f=false,e=false,a=function(){if(f&&e){xui.Thread.resume(g)}};if(!d){e=true}CONF.getLocalFile(CONF.mapServerPath(c.$dftCodePath)+xui.getLang()+"/"+(CONF.initFilePath||c.$dftCodeFileName),function(j){c.$iniCode=j;f=true;a()},function(){f=true;a();alert(xui.getRes("RAD.builder.noexist",CONF.mapServerPath(c.$dftCodePath)))});if(d){c.$url=d;CONF.callService({key:CONF.requestKey2,paras:{action:"fetchwebfile",path:d}},function(j){var l=j;if(!l.error){c.$fetchedCode=l.data;c.$fetchedurl=d}else{xui.message(l.error.message)}e=true;a()},function(){e=true;a();alert(xui.getRes("RAD.builder.noexist",d))})}},iniExComs:function(a,b){var a=this;xui.ComFactory.newCom("RAD.JSEditor",function(d,c,f){var e=this;e.host=a;e.setEvents("onValueChanged",function(j,g){a.$dirty=g});e.create(function(j,g){e.paneMain.setDockMargin({left:0,top:40,right:0,bottom:0});a.appRoot.append(e)},f);a.$classEditor=e;xui.newCom("RAD.ToolBox",function(){c._designer.layoutBase.updateItem("before",{hidden:false});c._designer.layoutBase.append(this.dlg,"before");this.render();this.fillContent();this.setEvents({afterPop:function(){c._designer.layoutBase.updateItem("before",{hidden:true})},afterLand:function(g){c._designer.layoutBase.updateItem("before",{hidden:false});g.dlg.append(g.treebarCom)}});a.toolBoxBlock=this})},b,{$pageviewType:a.$pageviewType})},getValue:function(){return this.$classEditor.getValue()},setValue:function(d,c){var b=this;if(d){b.$classEditor.setValue(d)}if(c){b.$url=c}var a=b.$url?!xui.absIO.isCrossDomain(b.$url)?"":"none":"none";b.$dirty=false},_pop_onmenuselected:function(b,c,e){var a=this,d=c.id;if(xui.getLang()==d){return}SPA.$btnLang.setCaption(xui.wrapRes("RAD."+d));xui.setLang(d);a.ctl_menubar1.clearPopCache();xui.include("xui.Locale."+c.id+".app",CONF.getAPIPath()+"Locale/"+c.id+".js",function(){if(!xui.Locale[d].doc){xui.Locale[d].doc=xui.Locale.en.doc}});xui.include("lang."+d,CONF.getAPIPath()+"Locale/"+d+".js")},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a((new xui.UI.PopMenu).setHost(c,"popLang").onMenuSelected("_pop_onmenuselected"));a((new xui.UI.Pane).setHost(c,"appRoot").setDock("fill").setWidth(800).setHeight(600).setDockMinW(600).setDockMinH(300));c.appRoot.append((new xui.UI.MenuBar).setHost(c,"ctl_menubar1").setItems([{id:"tools",caption:"$RAD.menu.tools",imageClass:"spafont spa-icon-tool",sub:[{id:"editorTheme",caption:"$RAD.menu.editorTheme"},{type:"split"},{id:"command",caption:"$RAD.menu.command"},{type:"split"},{id:"api",caption:"$RAD.menu.api"},]}]).setHandler(false).setDockFloat(true).setDockMargin({top:6,left:2,right:0,bottom:0}).setCustomStyle({BORDER:"border:none;background:none;"}).onMenuSelected("_menubar_selected").setZIndex(5));return b},_image1_onclick:function(){CONF.openURL(CONF.path_website)},_menubar_selected:function(b,e,c,d){var a=this;switch(c.id){case"cookbook":CONF.openBook();break;case"api":CONF.openAPI();break;case"jsoneditor":CONF.openJSONEditor();break;case"command":xui.Debugger.log("Ready");break}},_onmenusel:function(a,b){var c=b.id;if((SPA.$curTheme||"default")==c){return}xui.setTheme(c,true,function(){SPA.$curTheme=c;SPA.$btnTheme.setCaption(xui.wrapRes(b.caption))})},getDesigner:function(){return this.$classEditor._designer},getViewSize:function(){return xui.copy(this.getDesigner().$curViewSize)},setViewSize:function(a){this.getDesigner().setViewSize(a)},getSelected:function(){var b=this.getDesigner().tempSelected,a;if(b&&b.length){a=[];xui.arr.each(b,function(c){a.push(xui.getObject(c))})}return a},selectByAlias:function(a){var b=this.getDesigner(),c=b.getNames();if(c[a]){b.selectWidget(c[a].$xid)}},clearSelected:function(){var a=this.getDesigner();a._clearSelect();a._setSelected(null,true)},delSelected:function(){this.getDesigner()._deleteSelected(true)},getWidgetByAlias:function(a){var b=this.getDesigner(),c=b.getNames();return c[a]},addWidget:function(d,b,a){if(d.$key=="xui.UIProfile"){d=d.boxing()}if(d["xui.UI"]){var c=this.getDesigner(),e=this.getWidgetByAlias(b);if(e&&e.behavior.PanelKeys&&e.behavior.PanelKeys.length){e=e.boxing()}else{e=c.canvas}e.append(d,a);c._designable(d.get(0));c._dirty=true}},removeWidgetByAlias:function(a){var b=this.getDesigner(),c=this.getWidgetByAlias(a);if(c){c.boxing().destroy();b._dirty=true}this.clearSelected()},getRootWidgets:function(){return this.getDesigner().getWidgets()},getAllWidgets:function(){return this.getDesigner().getNames()},getJSCode:function(){var a=this.getDesigner(),b=a.getJSCode(a.getWidgets());b=b.replace(/^return xui\.create\(/,"");b=b.replace(/\)\.get\(\);$/,"");return b},getJSONCode:function(){var a=this.getDesigner(),b=a.getJSONCode(a.getWidgets());b=b.replace(/^return xui\.create\(/,"");b=b.replace(/\)\.get\(\);$/,"");return b},clearCode:function(){var a=this.getDesigner();a._clearSelect();a.canvas.removeChildren(null,true);a._dirty=true;a.resetCodeFromDesigner(true)},setJSCode:function(b){var a=this.getDesigner();this.clearCode();a.refreshView(b,true);a._dirty=true;a.resetCodeFromDesigner(false)},setJSONCode:function(a){this.setJSCode("return xui.UI.unserialize("+a+").get();")},isDirtied:function(){return this.getDesigner().isDirty()},markDirty:function(a){var b=this.getDesigner();if(a){b._dirty=true}else{b.clearDirty()}}}});xui.Class("RAD.FAndR","xui.Module",{Instance:{_editor:null,initialize:function(){this.autoDestroy=true;this.properties={}},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"ctl_dialog").setShowEffects("Slide In TB").setHideEffects("Slide In TB").setLeft("0em").setTop("0em").setHeight("15em").setSelectable(false).setResizer(false).setInitPos("auto").setCaption("$RAD.pageEditor.searchreplace").setMinBtn(false).setMaxBtn(false).setOverflow("hidden").onHotKeydown("_ctl_dialog_onhotkeydown").beforeClose("_ctl_dialog_beforeclose"));c.ctl_dialog.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel1").setLeft("1.25em").setTop("0.875em").setWidth("5.25em").setCaption("$RAD.pageEditor.search"));c.ctl_dialog.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel2").setLeft("1.25em").setTop("3.5em").setWidth("5.25em").setCaption("$RAD.pageEditor.replacewith"));c.ctl_dialog.append(xui.create("xui.UI.Input").setHost(c,"ctl_i1").setDirtyMark(false).setLeft("6.875em").setTop("0.625em").setWidth("14.666666666666666em").onHotKeydown("_ctl_i1_onhotkeydown"));c.ctl_dialog.append(xui.create("xui.UI.Input").setHost(c,"ctl_i2").setDirtyMark(false).setLeft("6.875em").setTop("3.25em").setWidth("14.666666666666666em"));c.ctl_dialog.append(xui.create("xui.UI.Button").setHost(c,"ctl_sbtnSearch").setDefaultFocus(true).setLeft("2.4166666666666665em").setTop("6.666666666666667em").setWidth("9.166666666666666em").setCaption("$RAD.pageEditor.search").onClick("_ctl_sbtnsearch_onclick"));c.ctl_dialog.append(xui.create("xui.UI.Button").setHost(c,"ctl_sbtnReplace").setLeft("2.4166666666666665em").setTop("9.166666666666666em").setWidth("9.166666666666666em").setCaption("$RAD.pageEditor.replace").onClick("_ctl_sbtnreplace_onclick"));c.ctl_dialog.append(xui.create("xui.UI.Button").setHost(c,"ctl_sbtnSR").setLeft("12.75em").setTop("6.666666666666667em").setWidth("9.166666666666666em").setCaption("$RAD.pageEditor.replacesearch").onClick("_ctl_sbtnsr_onclick"));c.ctl_dialog.append(xui.create("xui.UI.Button").setHost(c,"ctl_sbtnRA").setLeft("12.75em").setTop("9.166666666666666em").setWidth("9.166666666666666em").setCaption("$RAD.pageEditor.replaceall").onClick("_ctl_sbtnra_onclick"));c.ctl_dialog.append(xui.create("xui.UI.Block").setHost(c,"xui_ui_block91").setLeft("1.6666666666666667em").setTop("5.833333333333333em").setWidth("20.75em").setHeight("0em").setBorderType("inset"));return b},customAppend:function(c,a,e,d){var b=this;if(b._init){b.ctl_i1.setUIValue(b._init)}b.ctl_i2.setUIValue("");b.ctl_dialog.show(c,false,e,d,function(){b.ctl_i1.activate()})},_ctl_dialog_beforeclose:function(a){this.ctl_dialog.hide();this._SearchCursor=null;return false},getCM:function(){var a=this;if(a._editor){return a._editor.getCM()}},_ctl_sbtnsearch_onclick:function(d,j,l,g){var c=this,f=c.ctl_i1.getUIValue(),a;if(f&&(a=c.getCM())){var b=c._SearchCursor=a.getSearchCursor(f,a.doc.getCursor(),true);if(b.findNext()){a.doc.setSelection(b.from(),b.to())}else{b=c._SearchCursor=a.getSearchCursor(f,0,true);if(b.findNext()){a.doc.setSelection(b.from(),b.to())}else{xui.message(xui.getRes("RAD.pageEditor.findnone"))}}}},_ctl_sbtnreplace_onclick:function(c,j,l,g){var b=this,f=b.ctl_i1.getUIValue(),d=b.ctl_i2.getUIValue(),a;if(f&&(a=b.getCM())){if(b._SearchCursor&&a.getSelection()==f){b._SearchCursor.replace(d)}}},_ctl_sbtnsr_onclick:function(c,j,l,g){var b=this,f=b.ctl_i1.getUIValue(),d=b.ctl_i2.getUIValue(),a;if(f&&(a=b.getCM())){if(b._SearchCursor&&a.getSelection()==f){b._SearchCursor.replace(d)}b._ctl_sbtnsearch_onclick()}},_ctl_sbtnra_onclick:function(b,f,a,m){var j=this,g=j.ctl_i1.getUIValue(),l=j.ctl_i2.getUIValue(),n;if(g&&(n=j.getCM())){var d=0;var c=j._SearchCursor=n.getSearchCursor(g,0,true);while(c.findNext()){c.replace(l);d++}xui.message(xui.getRes("RAD.pageEditor.replaceCount",d))}},_ctl_dialog_onhotkeydown:function(b,a){if(a.key=="esc"){this.ctl_dialog.close()}},_ctl_i1_onhotkeydown:function(b,a,c,d){if(a.key=="enter"){this.ctl_sbtnSearch.onClick()}}}});xui.Class("RAD.JumpTo","xui.Module",{Instance:{initialize:function(){this.autoDestroy=true;this.properties={}},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"ctl_dialog").setLeft("4.375em").setTop("3.25em").setWidth("16.416666666666668em").setHeight("10.083333333333334em").setResizer(false).setCaption("$RAD.jumpto").setMinBtn(false).setMaxBtn(false).setOverflow("hidden").onHotKeydown("_ctl_dialog_onhotkeydown").beforeClose("_ctl_dialog_beforeclose"));c.ctl_dialog.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel1").setLeft("0.625em").setTop("0.5833333333333334em").setWidth("4.625em").setCaption("$RAD.jumpto"));c.ctl_dialog.append(xui.create("xui.UI.ComboInput").setHost(c,"ctl_comboinput3").setDirtyMark(false).setLeft("6.875em").setTop("0.3333333333333333em").setWidth("5.583333333333333em").setHeight("1.9166666666666667em").setType("spin").setPrecision(0).setIncrement(1).setMin(1).setMax(100000).setValue(1));c.ctl_dialog.append(xui.create("xui.UI.Button").setHost(c,"ctl_sbutton5").setLeft("2.5em").setTop("4.166666666666667em").setWidth("4.666666666666667em").setHeight("1.9166666666666667em").setCaption("$RAD.cancel").onClick("_ctl_sbutton5_onclick"));c.ctl_dialog.append(xui.create("xui.UI.Button").setHost(c,"ctl_btnok").setLeft("9.166666666666666em").setTop("4.166666666666667em").setWidth("4.666666666666667em").setHeight("1.9166666666666667em").setCaption("$RAD.ok").onClick("_ctl_btnok_onclick"));c.ctl_dialog.append(xui.create("xui.UI.Block").setHost(c,"xui_ui_block112").setLeft("0.8333333333333334em").setTop("3.3333333333333335em").setWidth("14.166666666666666em").setHeight("0em").setBorderType("inset"));return b},customAppend:function(b,a,d,c){this.ctl_comboinput3.setUIValue(1,true);this.ctl_dialog.showModal(b,d,c)},events:{},_ctl_sbutton5_onclick:function(a,c,d,b){this.ctl_dialog.close()},_ctl_dialog_beforeclose:function(a){this.ctl_dialog.hide();return false},_ctl_btnok_onclick:function(a,c,d,b){this.fireEvent("onOK",[this.ctl_comboinput3.getUIValue()]);this.ctl_dialog.close()},_ctl_dialog_onhotkeydown:function(b,a){if(a.key=="esc"){this.ctl_dialog.close()}}}});xui.Class("RAD.ServiceTester","xui.Module",{Instance:{initialize:function(){this.autoDestroy=true;this.properties={}},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dlg").setLeft("11.416666666666666em").setTop("3.75em").setWidth("44.416666666666664em").setHeight("33.75em").setCaption("$RAD.spabuilder.st_title").setMinBtn(false).setMaxBtn(false).setOverflow("visible").beforeClose("_dlg_beforeclose"));c.dlg.append(xui.create("xui.UI.Group").setHost(c,"ctl_group1").setLeft("0.625em").setTop("3.3333333333333335em").setWidth("42.583333333333336em").setConDockPadding({left:4,top:4,right:4,bottom:4}).setCaption("$RAD.spabuilder.st_queryobj").setToggleBtn(false).setCustomStyle({PANEL:"overflow:visible"}));c.ctl_group1.append(xui.create("xui.Module.JSONEditor","xui.Module").setHost(c,"ctl_query").setProperties({value:"{a:1,b:2}"}));c.dlg.append(xui.create("xui.UI.Group").setHost(c,"ctl_group3").setLeft("0.625em").setTop("16.666666666666668em").setWidth("42.583333333333336em").setConDockPadding({left:4,top:4,right:4,bottom:4}).setCaption("$RAD.spabuilder.st_result").setToggleBtn(false).setCustomStyle({PANEL:"overflow:visible"}));c.ctl_group3.append(xui.create("xui.UI.Input").setHost(c,"ctl_result").setDock("fill").setLeft("3.125em").setTop("0em").setMultiLines(true).setDirtyMark(false));c.dlg.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel1").setLeft("0.625em").setTop("0.625em").setWidth("6.833333333333333em").setHeight("0.5833333333333334em").setCaption("$RAD.spabuilder.st_uri"));c.dlg.append(xui.create("xui.UI.Button").setHost(c,"ctl_sbutton5").setLeft("27.833333333333332em").setTop("27.25em").setWidth("6.875em").setCaption("$RAD.close").onClick("_ctl_sbutton5_onclick"));c.dlg.append(xui.create("xui.UI.Button").setHost(c,"ctl_sbutton6").setLeft("16.583333333333332em").setTop("27.25em").setWidth("10.625em").setCaption("$RAD.spabuilder.st_createcode").onClick("_ctl_sbutton6_onclick"));c.dlg.append(xui.create("xui.UI.Button").setHost(c,"ctl_sbutton15").setLeft("28.25em").setTop("14.166666666666666em").setWidth("13.125em").setHeight("2.25em").setCaption("<strong>$RAD.spabuilder.st_send</strong>").onClick("_ctl_sbutton15_onclick"));c.dlg.append(xui.create("xui.UI.RadioBox").setHost(c,"ctl_method").setItems([{id:"auto",caption:"Auto"},{id:"get",caption:"Get"},{id:"post",caption:"Post"}]).setLeft("8.25em").setTop("14.25em").setWidth("19.166666666666668em").setHeight("2.5em").setValue("auto").setDirtyMark(false));c.dlg.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel13").setLeft("0em").setTop("14.75em").setWidth("8.25em").setHeight("0.25em").setCaption("$RAD.spabuilder.st_method"));c.dlg.append(xui.create("xui.UI.ComboInput").setHost(c,"ctl_uri").setLeft("8.25em").setTop("0.375em").setWidth("34.833333333333336em").setValueFormat("^(http|https)\\:").setType("popbox").setDirtyMark(false).setValue("").onClick("_ctl_uri_onclick"));return b},customAppend:function(c,a,e,d){var b=this;b.dlg.showModal();return true},init:function(b){var a=this;if(b){a.ctl_uri.setValue("",true)}a.ctl_method.setValue("auto",true)},_ctl_sbutton5_onclick:function(c,f,g,d){var b=this,a=c.boxing();b.dlg.close()},_ctl_sbutton15_onclick:function(f,j,b,n){var m=this,c=f.boxing(),o={},d=m.ctl_uri.getValue(),g=m.ctl_query.getValue();if(d){var l=xui.unserialize(g);if(!l){l={}}l._rand=xui.rand();var a=m.ctl_method.getValue();if(a!="auto"){o.method=a}c.getRoot().onMouseout(true);c.setDisabled(true).setCaption("<strong>$RAD.spabuilder.st_sending</strong>");xui.request(d,l||"",function(e){var q=e;if(q){m.showResult(q)}else{m.showErr(e)}c.setDisabled(false).setCaption("<strong>$RAD.spabuilder.st_send</strong>")},function(e){m.showErr(e);c.setDisabled(false).setCaption("<strong>$RAD.spabuilder.st_send</strong>")},null,o)}else{xui.message(xui.getRes("RAD.spabuilder.st_nodata"))}},showErr:function(a){xui.alert(a)},showResult:function(b){var a=this;a.ctl_result.setValue(xui.Coder.formatText(xui.stringify(b)),true)},_ctl_sbutton6_onclick:function(f,j,b,n){var l=this,m=f.boxing(),d=l.ctl_uri.getValue(),g=l.ctl_query.getValue(),a=l.ctl_method.getValue();var c='xui.request("$1", $2, \nfunction(rsp){\n    var rspobj = rsp;\n    if(rspobj){\n        // handle result\n    }else{\n        // handle exception\n    }\n}, function(rsp){\n    // handle exception\n}, null, $3);';c=c.replace("$1",d).replace("$2",xui.Coder.formatText(g||"")).replace("$3",a=="auto"?"null":("{method:'"+a+"'}"));l.ctl_result.setValue(c,true)},_dlg_beforeclose:function(a){this.dlg.hide();return false},_ctl_uri_onclick:function(c,d){var b=this,a=c.boxing();xui.Dom.submit(a.getValue())}}});xui.Class("RAD.CustomDecoration","xui.Module",{Instance:{initialize:function(){this.autoDestroy=true;this.properties={}},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dialog").setLeft("13.125em").setTop("1.25em").setWidth("17.666666666666668em").setHeight("40.416666666666664em").setShadow(false).setResizer(false).setCaption("$(RAD.custom_dlg.Custom Decoration)").setMinBtn(false).setMaxBtn(false).setOverflow("visible").beforeClose("_dialog_beforeclose"));c.dialog.append(xui.create("xui.UI.Group").setHost(c,"grpNodes").setLeft("0em").setTop("0.25em").setWidth("16.916666666666668em").setHeight("11.416666666666666em").setCaption("grpNodes"));c.grpNodes.append(xui.create("xui.UI.TreeView").setHost(c,"tv").setDirtyMark(false).onItemSelected("_tv_onitemselected").setCustomStyle({BOX:"background-color:transparent;"}));c.dialog.append(xui.create("xui.UI.Block").setHost(c,"ctl_block3").setLeft("0em").setTop("13.416666666666666em").setWidth("16.916666666666668em").setHeight("23.666666666666668em").setBorderType("inset").setBackground("#fff"));c.ctl_block3.append(xui.create("xui.UI.TreeGrid").setHost(c,"tg").setDirtyMark(false).setEditMode("hover").setRowHandler(false).setColSortable(false).setHeader([{id:"key",width:"7.5em",type:"label",caption:"$RAD.custom_dlg.Attribute"},{id:"value",editable:true,width:"11.166666666666666em",flexSize:true,type:"input",caption:"$RAD.custom_dlg.Value"}]).afterCellUpdated("_tg_aftercellupdated").beforeComboPop("_tg_beforeComboPop").setCustomStyle({SCROLL:{overflowX:"hidden",overflowY:"auto"}}));c.dialog.append(xui.create("xui.UI.Input").setHost(c,"ctl_input1").setReadonly(true).setLeft("0em").setTop("11.666666666666666em").setWidth("16.916666666666668em").setLabelCaption("ctl_input1"));return b},customAppend:function(c,a,e,d){var b=this,f=b.properties;b.setTargetProfile(f.targetProfile);xui("body").append(b.dialog);b.dialog.getRoot().popToTop(f.src,2).setBlurTrigger("RAD.CustomDecoration",function(){b.dialog.close()});b.dialog.activate();return true},setTargetProfile:function(b){var j=this,f=[],l;var g=function(w,q,o,n){var u;for(var s in w){if(s.charAt(0)!="$"&&w[s]){var r=(w[s]&&w[s].tagName||"span").toLowerCase();if(!/[a-z]/.test(s)){u={id:s,caption:s+" ["+r.toUpperCase()+"]",imageClass:"spafont spa-icon-domnode"};if(q&&w[s].text&&q[(n?(n+"."):"")+w[s].text.replace(/^{(.*)}$/,"$1")]){u.sub=[];var n=(n?(n+"."):"")+w[s].text.replace(/^{(.*)}$/,"$1");if(n=="rows.cells"){n="rows.cells.input"}arguments.callee(q[n],q,u.sub,n);if(r=="text"&&u.sub.length){u=u.sub[0]}}else{if(r=="text"&&!w[s].svg){continue}else{if(typeof w[s]=="object"&&r!="text"){u.sub=[];arguments.callee(w[s],q,u.sub,n)}}}if(!u.sub||!u.sub.length){delete u.sub}o[o.length]=u}}}};var d="_",c=b.box.$Templates,a=(c[d].tagName||"span").toLowerCase();f.push(l={id:"KEY",caption:"ROOT ["+a.toUpperCase()+"]",imageClass:"spafont spa-icon-domnode",sub:[]});var e=c[d].$submap;if(e&&c[d].text&&e[c[d].text.replace(/^{(.*)}$/,"$1")]){var m=c[d].text.replace(/^{(.*)}$/,"$1");g(e[m],e,l.sub,m);if(a=="text"&&l.sub.length){l=l.sub[0]}}g(c[d],e,l.sub,null);if(!l.sub.length){delete l.sub}j.grpNodes.setCaption(b.key.slice(b.key.lastIndexOf(".")+1)+" : "+b.alias+" $RAD.custom_dlg.Nodes");j.tv.setTagVar(b);j.tv.setItems(f);j.tg.updateCellByRowCol("classname","value",{value:""},false,false);j.tg.updateCellByRowCol("font-family","value",{value:"",disabled:a=="image"},false,false);j.tg.updateCellByRowCol("font-size","value",{value:"",disabled:a=="image"},false,false);j.tg.updateCellByRowCol("font-weight","value",{value:"",disabled:a=="image"},false,false);j.tg.updateCellByRowCol("font-style","value",{value:"",disabled:a=="image"},false,false);j.tg.updateCellByRowCol("color","value",{value:a=="image"?"#EBEADB":"",disabled:a=="image"},false,false);j.tg.updateCellByRowCol("background-color","value",{value:""},false,false);j.tg.updateCellByRowCol("background-image","value",{value:""},false,false);j.tg.updateCellByRowCol("background-position","value",{value:""},false,false);j.tg.updateCellByRowCol("background-repeat","value",{value:""},false,false);j.tg.updateCellByRowCol("background-attachment","value",{value:""},false,false);j.tg.updateCellByRowCol("border-left","value",{value:""},false,false);j.tg.updateCellByRowCol("border-right","value",{value:""},false,false);j.tg.updateCellByRowCol("border-top","value",{value:""},false,false);j.tg.updateCellByRowCol("border-bottom","value",{value:""},false,false);j.tg.updateCellByRowCol("border-radius","value",{value:""},false,false);j.tg.updateCellByRowCol("padding","value",{value:""},false,false);j.tg.updateCellByRowCol("margin","value",{value:""},false,false);j.tg.updateCellByRowCol("text-decoration","value",{value:"",disabled:a=="image"},false,false);j.tg.updateCellByRowCol("text-align","value",{value:"",disabled:a=="image"},false,false);j.tg.updateCellByRowCol("text-shadow","value",{value:"",disabled:a=="image"},false,false);j.tg.updateCellByRowCol("cursor","value",{value:""},false,false);j.tg.updateCellByRowCol("overflow","value",{value:"",disabled:a=="image"},false,false);j.tg.updateCellByRowCol("line-height","value",{value:"",disabled:a=="image"},false,false);j.tg.updateCellByRowCol("opacity","value",{value:1},false,false);j.tg.updateCellByRowCol("transform","value",{value:""},false,false);j.tg.updateCellByRowCol("box-shadow","value",{value:""},false,false);j.tg.updateCellByRowCol("$gradient","value",{value:""},false,false);j.tg.updateCellByRowCol("$zoom","value",{value:""},false,false);j.tg.setDisabled(true);j.ctl_input1.setValue("");j.tv.toggleNode("KEY",true,true);j.tv.fireItemClickEvent("KEY")},_tv_onitemselected:function(f,r,l){var n=this,c=f.boxing().getTagVar();n.tg.setDisabled(false);if(!n.$coverMark){n.$coverMark=xui.create('<div style="z-index:2000;border:solid 1px;background-color:#ff0000;position:absolute;font-size:0;line-height:0;display:none;">').css("opacity",0.3);xui("body").append(n.$coverMark);n.$coverMarkTask=xui.Thread.repeat(function(){n.$coverMarkTask.$_mark=!n.$coverMarkTask.$_mark;n.$coverMark.css("backgroundColor",n.$coverMarkTask.$_mark?"#0000ff":"#ff0000");n.$coverMark.css("border-color",n.$coverMarkTask.$_mark?"#fff":"#000")},500)}if(r.id=="KEY"){n.$coverMark.css("display","none");var d=c.getRootNode();var m="<"+d.tagName+" id='"+d.id+"' class='"+d.className+"' style='"+xui(d).attr("style")+"'>";n.ctl_input1.setValue(m).setTips(m.replace(/</,"&lt;"))}else{var a=c.getSubNode(r.id,true);if(a.get(0)){var o=false;a.each(function(s){if(s.offsetWidth){var u=xui(s).offset();u.width=s.offsetWidth;u.height=s.offsetHeight;if(u.width<=0){u.width=2}else{u.width-=2}if(u.height<=0){u.height=2}else{u.height-=2}if(u.width<=0){u.width=2}if(u.height<=0){u.height=2}n.$coverMark.cssRegion(u).css("display","block");var e="<"+s.tagName+" id='"+s.id+"' class='"+s.className+"' style='"+xui(s).attr("style")+"'>";n.ctl_input1.setValue(e).setTips(e.replace(/</,"&lt;"));o=true;return false}});if(!o){n.$coverMark.css("display","none")}}else{n.$coverMark.css("display","none")}}n.tg.updateCellByRowCol("classname","value",{value:c.CC[r.id]||null},false,false);var j=c.CS[r.id],b={},q;if(j){if(xui.isStr(j)){var g=j.split(/\s*;+\s*/);xui.arr.each(g,function(e){if(e){var s=e.split(/\s*:\s*/);if(s.length==2){b[s[0]]=s[1]}}})}else{b=j}}n.tg.updateCellByRowCol("font-family","value",{value:b["font-family"]||""},false,false);n.tg.updateCellByRowCol("font-size","value",{value:b["font-size"]||""},false,false);n.tg.updateCellByRowCol("font-weight","value",{value:b["font-weight"]||""},false,false);n.tg.updateCellByRowCol("font-style","value",{value:b["font-style"]||""},false,false);n.tg.updateCellByRowCol("color","value",{value:b.color||""},false,false);n.tg.updateCellByRowCol("background-color","value",{value:b["background-color"]||""},false,false);n.tg.updateCellByRowCol("background-image","value",{value:b["background-image"]||""},false,false);n.tg.updateCellByRowCol("background-position","value",{value:b["background-position"]||""},false,false);n.tg.updateCellByRowCol("background-repeat","value",{value:b["background-repeat"]||""},false,false);n.tg.updateCellByRowCol("background-attachment","value",{value:b["background-attachment"]||""},false,false);n.tg.updateCellByRowCol("border-top","value",{value:(q=b["border-top"])?q:(q=b.border)?q:""},false,false);n.tg.updateCellByRowCol("border-right","value",{value:(q=b["border-right"])?q:(q=b.border)?q:""},false,false);n.tg.updateCellByRowCol("border-bottom","value",{value:(q=b["border-bottom"])?q:(q=b.border)?q:""},false,false);n.tg.updateCellByRowCol("border-left","value",{value:(q=b["border-left"])?q:(q=b.border)?q:""},false,false);n.tg.updateCellByRowCol("border-radius","value",{value:b["border-radius"]||""},false,false);n.tg.updateCellByRowCol("padding","value",{value:(q=b.padding)?q:((q=(b["padding-top"]||"0")+" "+(b["padding-right"]||"0")+" "+(b["padding-bottom"]||"0")+" "+(b["padding-left"]||"0"))!="0 0 0 0")?q:""},false,false);n.tg.updateCellByRowCol("margin","value",{value:(q=b.margin)?q:((q=(b["margin-top"]||"0")+" "+(b["margin-right"]||"0")+" "+(b["margin-bottom"]||"0")+" "+(b["margin-left"]||"0"))!="0 0 0 0")?q:""},false,false);n.tg.updateCellByRowCol("text-align","value",{value:b["text-align"]||""},false,false);n.tg.updateCellByRowCol("text-decoration","value",{value:b["text-decoration"]||""},false,false);n.tg.updateCellByRowCol("text-shadow","value",{value:b["text-shadow"]||""},false,false);n.tg.updateCellByRowCol("box-shadow","value",{value:b["box-shadow"]||""},false,false);n.tg.updateCellByRowCol("$gradient","value",{value:b["$gradient"]||""},false,false);n.tg.updateCellByRowCol("$zoom","value",{value:b["$zoom"]||""},false,false);n.tg.updateCellByRowCol("cursor","value",{value:b.cursor||""},false,false);n.tg.updateCellByRowCol("overflow","value",{value:b.overflow||""},false,false);n.tg.updateCellByRowCol("line-height","value",{value:b["line-height"]||""},false,false);n.tg.updateCellByRowCol("opacity","value",{value:(parseFloat(b.opacity)||parseFloat(b.opacity)===0)?b.opacity:1},false,false);n.tg.updateCellByRowCol("transform","value",{value:b.transform||""},false,false);f.boxing().setTag(r.id)},events:{beforeShow:"_com_beforeShow",onDestroy:"_com_ondestroy"},_com_beforeShow:function(a,f){var c=this,d=[],e=c.properties.targetProfile.boxing(),b=function(g,j){window.SPA&&SPA.fe("onInitPropValueCell",["CS:"+c.tv.getTag(),j,g.value,"RAD.CustomDecoration",e,g,c.tg]);return g};d.push({id:"classname",cellStyle:"font-weight:bold;",cells:[{id:"class",caption:"$RAD.custom_dlg.classname"},b({value:""},"classname")]});d.push({id:"color",cells:[{id:"color",caption:"$RAD.custom_dlg.color"},b({type:"color"},"color")]});d.push({id:"background-color",cells:[{id:"background-color",caption:"$(RAD.custom_dlg.background$-color)"},b({type:"color"},"background-color")]});d.push({id:"background-image",cells:[{id:"background-image",caption:"$(RAD.custom_dlg.background$-image)"},b({type:CONF.getClientMode()=="singlepage"?"input":"popbox",event:function(m,g,j){var n=m.getSubNode("CELL",g._serialId),l=function(o){j.boxing().setUIValue("url("+CONF.adjustRelativePath(o)+")");n.focus()};if(window.SPA&&false===SPA.fe("beforeURISelectorPop",["CS:"+c.tv.getTag()+":background-image",g.value,l,"RAD.CustomDecoration",e,n.get(0),g,m.boxing(),j&&j.boxing()])){return}if(CONF.getClientMode()!="singlepage"){xui.ComFactory.getCom("RAD.ImageSelector",function(){this.setProperties({fromRegion:n.cssRegion(true),onOK:function(q,o){l(o)}});this.show()})}}},"background-image")]});d.push({id:"background-position",cells:[{id:"background-position",caption:"$(RAD.custom_dlg.background$-position)"},b({type:"combobox",editorListItems:CONF.designer_background_position},"background-position")]});d.push({id:"background-repeat",cells:[{id:"background-repeat",caption:"$(RAD.custom_dlg.background$-repeat)"},b({type:"combobox",editorListItems:CONF.designer_background_repeat},"background-repeat")]});d.push({id:"background-attachment",cells:[{id:"background-attachment",caption:"$(RAD.custom_dlg.background$-attachment)"},b({type:"combobox",editorListItems:CONF.designer_background_attachment},"background-attachment")]});d.push({id:"font-family",cells:[{id:"font-family",caption:"$(RAD.custom_dlg.font$-family)"},b({type:"helpinput",editorListItems:CONF.designer_data_fontfamily},"font-family")]});d.push({id:"font-size",cells:[{id:"font-size",caption:"$(RAD.custom_dlg.font$-size)"},b({type:"combobox",editorListItems:CONF.designer_data_fontsize},"font-size")]});d.push({id:"font-weight",cells:[{id:"font-weight",caption:"$(RAD.custom_dlg.font$-weight)"},b({type:"combobox",editorListItems:CONF.designer_data_fontweight},"font-weight")]});d.push({id:"font-style",cells:[{id:"font-style",caption:"$(RAD.custom_dlg.font$-style)"},b({type:"combobox",editorListItems:CONF.designer_data_fontstyle},"font-style")]});d.push({id:"border-top",cells:[{id:"border-top",caption:"$(RAD.custom_dlg.border$-top)"},b({type:"popbox"},"border-top")]});d.push({id:"border-right",cells:[{id:"border-right",caption:"$(RAD.custom_dlg.border$-right)"},b({type:"popbox"},"border-right")]});d.push({id:"border-bottom",cells:[{id:"border-bottom",caption:"$(RAD.custom_dlg.border$-bottom)"},b({type:"popbox"},"border-bottom")]});d.push({id:"border-left",cells:[{id:"border-left",caption:"$(RAD.custom_dlg.border$-left)"},b({type:"popbox"},"border-left")]});if(xui.Dom.css3Support("border-radius")){d.push({id:"border-radius",cells:[{id:"border-radius",caption:"$(RAD.custom_dlg.border$-radius)"},b({type:"popbox"},"border-radius")]})}d.push({id:"padding",cells:[{id:"padding",caption:"$RAD.custom_dlg.padding"},b({type:"popbox"},"padding")]});d.push({id:"margin",cells:[{id:"margin",caption:"$RAD.custom_dlg.margin"},b({type:"popbox"},"margin")]});d.push({id:"text-align",cells:[{id:"text-align",caption:"$(RAD.custom_dlg.text$-align)"},b({type:"combobox",editorListItems:CONF.designer_data_textalign},"text-align")]});d.push({id:"text-decoration",cells:[{id:"text-decoration",caption:"$(RAD.custom_dlg.text$-decoration)"},b({type:"combobox",editorListItems:CONF.designer_data_textdecoration},"text-decoration")]});if(xui.Dom.css3Support("text-shadow")){d.push({id:"text-shadow",cells:[{id:"text-shadow",caption:"$(RAD.custom_dlg.text$-shadow)"},b({type:"popbox"},"text-shadow")]})}if(xui.Dom.css3Support("box-shadow")){d.push({id:"box-shadow",cells:[{id:"box-shadow",caption:"$(RAD.custom_dlg.box$-shadow)"},b({type:"popbox"},"box-shadow")]})}if(xui.Dom.css3Support("gradient")){d.push({id:"$gradient",cells:[{id:"gradients",caption:"$RAD.custom_dlg.gradients"},b({type:"popbox",editorReadonly:true},"gradient")]})}if(xui.Dom.css3Support("transform")){d.push({id:"transform",cells:[{id:"transform",caption:"$RAD.custom_dlg.transform"},b({type:"popbox"},"transform")]})}d.push({id:"$zoom",cells:[{id:"zoom",caption:"$RAD.custom_dlg.zoom"},b({type:"spin",min:0.1,max:10,increment:0.1,precision:1},"zoom")]});d.push({id:"cursor",cells:[{id:"cursor",caption:"$RAD.custom_dlg.cursor"},b({type:"combobox",editorListItems:CONF.designer_data_cursor},"cursor")]});d.push({id:"overflow",cells:[{id:"overflow",caption:"$RAD.custom_dlg.overflow"},b({type:"combobox",editorListItems:CONF.designer_data_overflow},"overflow")]});d.push({id:"line-height",cells:[{id:"line-height",caption:"$(RAD.custom_dlg.line$-height)"},b({type:"combobox",editorListItems:[1,1.22,1.5,2]},"lien-height")]});if(xui.Dom.css3Support("opacity")){d.push({id:"opacity",cells:[{id:"opacity",caption:"$RAD.custom_dlg.opacity"},b({type:"progress",editorProperties:{min:0,max:1}},"opacity")]})}window.SPA&&SPA.fe("onInitEditorRows",["CS",null,c.properties.targetProfile.CS,"RAD.CustomDecoration",c.properties.targetProfile,d,c.tg]);c.tg.setRows(d)},_ctl_sbutton1_onclick:function(a){this.setTargetProfile(this.ctl_panel3.get(0))},_ctl_sbutton37_onclick:function(a,c,d,b){this.setTargetProfile(this.ctl_tabs2.get(0))},_com_ondestroy:function(a){if(this.$coverMark){this.$coverMark.remove()}if(this.$coverMarkTask){this.$coverMarkTask.abort()}},_dialog_beforeclose:function(a){this.dialog.getRoot().setBlurTrigger("RAD.CustomDecoration");a.boxing().hide();this.$coverMark.css("display","none");this.tv.setValue(null,true);this.fireEvent("onFinished");return false},_tg_beforeComboPop:function(c,m,d,j,g,a){var l=this,b=l.tv.getTagVar(),f=l.tv.getTag(),n;if(window.SPA&&false===SPA.fe("beforeEditorComboPop",["CS:"+f,m._row.id,m.value,function(e){d.boxing().setUIValue(e||"",true)},"RAD.CustomDecoration",l.properties.targetProfile.boxing(),j,c.getSubNode("CELL",m._serialId).get(0),m,l.tg,d&&d.boxing()])){return false}switch(m._row.id){case"border-top":case"border-right":case"border-bottom":case"border-left":case"border-radius":case"padding":case"margin":n="RAD.CustomBorder";break;case"text-shadow":n="RAD.CustomTextShadow";break;case"box-shadow":n="RAD.CustomBoxShadow";break;case"transform":n="RAD.CustomTransform";break;case"$gradient":n="RAD.CustomGradients";break}if(n){xui.ComFactory.getCom(n,function(){this.init(b,f,{pro:d,cell:m,isSvg:0,grid:l.tg});this.setEvents({onChange:function(o){switch(m._row.id){case"border-top":d.boxing().setUIValue(o.border["top"]||"",true);break;case"border-right":d.boxing().setUIValue(o.border["right"]||"",true);break;case"border-bottom":d.boxing().setUIValue(o.border["bottom"]||"",true);break;case"border-left":d.boxing().setUIValue(o.border["left"]||"",true);break;case"border-radius":case"padding":case"margin":d.boxing().setUIValue(o[m._row.id]||"",true);break;default:d.boxing().setUIValue(o?xui.isStr(o)?o:"[object]":"",true)}switch(m._row.id){case"border-top":case"border-right":case"border-bottom":case"border-left":case"border-radius":case"padding":case"margin":c.boxing().updateCellByRowCol("padding","value",{value:o.padding||""},false,true);c.boxing().updateCellByRowCol("margin","value",{value:o.margin||""},false,true);c.boxing().updateCellByRowCol("border-radius","value",{value:o["border-radius"]||""},false,true);c.boxing().updateCellByRowCol("border-left","value",{value:o.border["left"]||""},false,true);c.boxing().updateCellByRowCol("border-right","value",{value:o.border["right"]||""},false,true);c.boxing().updateCellByRowCol("border-top","value",{value:o.border["top"]||""},false,true);c.boxing().updateCellByRowCol("border-bottom","value",{value:o.border["bottom"]||""},false,true);break;default:c.boxing().updateCell(m,{value:o||""},false,true);if(xui.isHash(o)){c.boxing().updateCell(m,{caption:"[object]"},false,true)}if(xui.isNull(o)){c.boxing().updateCell(m,{caption:""},false,true)}}}});this.render();var e=this.mainPane.getRoot();e.popToTop(d.getRoot());e.setBlurTrigger(e.$xid,function(){e.setBlurTrigger(e.$xid);e.hide()});d.boxing().setPopWnd(this)})}},_tg_aftercellupdated:function(c,j,m){if("value" in m){var g=this,a=g.tg,b=g.tv.getTagVar(),e=g.tv.getTag();if(b&&e){var f="",d={},l=a.getCells(null,"value");xui.each(l,function(n){if(n._row.id=="classname"){if(xui.str.trim(n.value)!==""){f=xui.str.trim(n.value)}}else{var o="",q=n._row.id;if(q=="$gradient"){d[q]=n.value;if(!n.value){delete d[q]}}else{if(q=="$zoom"){if(parseFloat(n.value)!==1){o=parseFloat(n.value);d[q]=o;if(o==1){delete d[q]}}}else{if(q=="opacity"){if(parseFloat(n.value)!==1){o=parseFloat(n.value);d[q]=o;if(o==1){delete d[q]}}}else{if(xui.isStr(n.value)&&xui.str.trim(n.value)!==""){o=xui.str.trim(n.value);d[q]=o}}}}}});b.boxing().setCustomClass(e,f||null);b.boxing().setCustomStyle(e,xui.isEmpty(d)?null:d);b.boxing().reLayout();g.properties.page.resizer.rePosSize();g.fireEvent("onDirty")}}}}});xui.Class("RAD.CustomDecoration2","xui.Module",{Instance:{initialize:function(){this.autoDestroy=true;this.properties={}},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dialog").setLeft("17.5em").setTop("1.6666666666666667em").setWidth("39.166666666666664em").setHeight("37.5em").setShadow(false).setResizer(false).setMinBtn(false).setMaxBtn(false).setOverflow("visible").beforeClose("_dialog_beforeclose"));c.dialog.append(xui.create("xui.UI.Group").setHost(c,"grpNodes").setLeft("12.166666666666666em").setTop("0.25em").setWidth("26.083333333333332em").setHeight("17.3333em").setOverflow("hidden").setCaption("$(RAD.custom_dlg.Gradient Patterns)").setToggleBtn(false));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton6").setClassName("xui-predifined-css-1").setLeft("0.5833333333333334em").setTop("0.833333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton19").setClassName("xui-predifined-css-2").setLeft("5.583333333333333em").setTop("0.833333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton20").setClassName("xui-predifined-css-3").setLeft("10.583333333333334em").setTop("0.833333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton21").setClassName("xui-predifined-css-4").setLeft("15.666666666666666em").setTop("0.833333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton22").setClassName("xui-predifined-css-5").setLeft("20.666666666666668em").setTop("0.833333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton23").setClassName("xui-predifined-css-6").setLeft("0.5833333333333334em").setTop("3.83333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton24").setClassName("xui-predifined-css-7").setLeft("5.583333333333333em").setTop("3.83333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton25").setClassName("xui-predifined-css-8").setLeft("10.583333333333334em").setTop("3.83333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton26").setClassName("xui-predifined-css-9").setLeft("15.666666666666666em").setTop("3.83333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton27").setClassName("xui-predifined-css-10").setLeft("20.666666666666668em").setTop("3.83333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton28").setClassName("xui-predifined-css-11").setLeft("0.5833333333333334em").setTop("6.83333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton29").setClassName("xui-predifined-css-12").setLeft("5.583333333333333em").setTop("6.83333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton30").setClassName("xui-predifined-css-13").setLeft("10.583333333333334em").setTop("6.83333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton31").setClassName("xui-predifined-css-14").setLeft("15.666666666666666em").setTop("6.83333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton32").setClassName("xui-predifined-css-15").setLeft("20.666666666666668em").setTop("6.83333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton33").setClassName("xui-predifined-css-16").setLeft("0.5833333333333334em").setTop("9.83333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton34").setClassName("xui-predifined-css-17").setLeft("5.583333333333333em").setTop("9.83333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton35").setClassName("xui-predifined-css-18").setLeft("10.583333333333334em").setTop("9.83333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton36").setClassName("xui-predifined-css-19").setLeft("15.666666666666666em").setTop("9.83333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton37").setClassName("xui-predifined-css-20").setLeft("20.666666666666668em").setTop("9.83333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton38").setClassName("xui-predifined-css-21").setLeft("0.5833333333333334em").setTop("12.8333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton39").setClassName("xui-predifined-css-22").setLeft("5.583333333333333em").setTop("12.8333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton40").setClassName("xui-predifined-css-23").setLeft("10.583333333333334em").setTop("12.8333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton41").setClassName("xui-predifined-css-24").setLeft("15.666666666666666em").setTop("12.8333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.grpNodes.append(xui.create("xui.UI.HTMLButton").setHost(c,"ctl_htmlbutton42").setClassName("xui-predifined-css-25").setLeft("20.666666666666668em").setTop("12.8333em").setWidth("4.75em").setHeight("2.5em").setHtml("$RAD.custom_dlg.Text").onClick("_btnclick"));c.dialog.append(xui.create("xui.UI.Group").setHost(c,"ctl_group11").setLeft("0.3333333333333333em").setTop("0.25em").setWidth("11em").setHeight("17.3333em").setOverflow("hidden").setCaption("$(RAD.custom_dlg.Color Patterns)").setToggleBtn(false).setCustomStyle({PANEL:"padding:2px;"}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr1").setTagVar({clr1:"#4BA3CC",clr2:"#3289B2",clr3:"#3899C6 ",clr4:"#2D7A9E",boxshadow1:"#87C1DD",boxshadow2:"#297192"}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #3899C6","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#4ba3cc"},{pos:"100%",clr:"#3289B2"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr2").setTagVar({clr1:"#A5B8DA",clr2:"#7089B3",clr3:"#819bcb",clr4:"#536f9d",boxshadow1:"#87C1DD",boxshadow2:"#297192"}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #819bcb","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#A5B8DA"},{pos:"100%",clr:"#7089B3"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr3").setTagVar({clr1:"#ffd65e",clr2:"#febf04",clr3:"#ffd65e",clr4:"#ce9a01",boxshadow1:"#FFEC93",boxshadow2:"#B28C00"}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #ffc926","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#ffd65e"},{pos:"100%",clr:"#febf04"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr4").setTagVar({clr1:"#606c88",clr2:"#3f4c6b",clr3:"#4b546a",clr4:"#2c354b",boxshadow1:"#A7AEC2",boxshadow2:"#272742"}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #4b546a","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#606c88"},{pos:"100%",clr:"#3f4c6b"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr5").setTagVar({clr1:"#d5cea6",clr2:"#b7ad70",clr3:"#c5bb83",clr4:"#a29752",boxshadow1:"#E1E1B6",boxshadow2:"#8C8F42"}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #c5bb83","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#d5cea6"},{pos:"100%",clr:"#b7ad70"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr6").setTagVar({clr1:"#a90329",clr2:"#6d0019",clr3:"#77021d",clr4:"#3a000d",boxshadow1:"#D9D961",boxshadow2:"#000000"}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #77021d","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#a90329"},{pos:"100%",clr:"#6d0019"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr7").setTagVar({clr1:"#4ba614",clr2:"#008c00",clr3:"#36780f",clr4:"#005900",boxshadow1:"#9FD53E",boxshadow2:"#002F00"}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #36780f","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#4ba614"},{pos:"100%",clr:"#008c00"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr8").setTagVar({clr1:"#ff5db1",clr2:"#ef007c",clr3:"#ff2a98",clr4:"#bc0062",boxshadow1:"#FFBAE8",boxshadow2:"#880037"}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #ff2a98","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#ff5db1"},{pos:"100%",clr:"#ef007c"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span500").setTagVar({clr1:"#7d7e7d",clr2:"#0e0e0e",clr3:"#646464",clr4:"#282828",boxshadow1:"#C9C9CD",boxshadow2:"#121212"}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #819bcb","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#7d7e7d"},{pos:"100%",clr:"#0e0e0e"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span501").setTagVar({clr1:"#cef8ff",clr2:"#7fe0f8",clr3:"#9bf1ff",clr4:"#4fd4f5",boxshadow1:"#ffffff",boxshadow2:"#239397 "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #9bf1ff","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#cef8ff"},{pos:"100%",clr:"#7fe0f8"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span502").setTagVar({clr1:"#f2f9fe",clr2:"#d6f0fd",clr3:"#c3e3fa",clr4:"#a5defb",boxshadow1:"#ffffff",boxshadow2:"#6884FF "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #c3e3fa","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#f2f9fe"},{pos:"100%",clr:"#d6f0fd"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span503").setTagVar({clr1:"#fb83fa",clr2:"#e93cec",clr3:"#f952f8",clr4:"#dc16df",boxshadow1:"#FDD9FA",boxshadow2:"#5908C9 "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #f952f8","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#fb83fa"},{pos:"100%",clr:"#e93cec"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span504").setTagVar({clr1:"#3093c7",clr2:"#1c5a85",clr3:"#26759e",clr4:"#133d5b",boxshadow1:"#65B6EC",boxshadow2:"#04233A "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #26759e","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#3093c7"},{pos:"100%",clr:"#1c5a85"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span505").setTagVar({clr1:"#a9db80",clr2:"#96c56f",clr3:"#8ed058",clr4:"#7bb64b",boxshadow1:"#C9F0B6",boxshadow2:"#598F33 "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #8ed058","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#a9db80"},{pos:"100%",clr:"#96c56f"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span506").setTagVar({clr1:"#cef8ff",clr2:"#7fe0f8",clr3:"#9bf1ff",clr4:"#4fd4f5",boxshadow1:"#ffffff",boxshadow2:"#239397 "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #819bcb","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#A5B8DA"},{pos:"100%",clr:"#7089B3"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span507").setTagVar({clr1:"#b29af8",clr2:"#9174ed",clr3:"#8e6af5",clr4:"#6d47e7",boxshadow1:"#4E2B78",boxshadow2:"#239397 "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #8e6af5","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#b29af8"},{pos:"100%",clr:"#9174ed"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span508").setTagVar({clr1:"#f2f5f6",clr2:"#c8d7dc",clr3:"#d4dee1",clr4:"#a9c0c8",boxshadow1:"#ffffff",boxshadow2:"#699B9F "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #d4dee1","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#f2f5f6"},{pos:"100%",clr:"#c8d7dc"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span509").setTagVar({clr1:"#ffc579",clr2:"#fb9d23",clr3:"#ffaf46",clr4:"#e78404",boxshadow1:"#FFE8B6",boxshadow2:"#885D00 "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #ffaf46","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#ffc579"},{pos:"100%",clr:"#fb9d23"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span510").setTagVar({clr1:"#d3d3d3",clr2:"#707070",clr3:"#bababa",clr4:"#575757",boxshadow1:"#E8E8E8",boxshadow2:"#373737 "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #bababa","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#d3d3d3"},{pos:"100%",clr:"#707070"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span511").setTagVar({clr1:"#fcfac0",clr2:"#f6f283",clr3:"#faf68f",clr4:"#f3ed53",boxshadow1:"#FFFFE8",boxshadow2:"#C2CD3A "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #faf68f","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#fcfac0"},{pos:"100%",clr:"#f6f283"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span512").setTagVar({clr1:"#f4f5f5",clr2:"#dfdddd",clr3:"#d9dddd",clr4:"#c6c3c3",boxshadow1:"#ffffff",boxshadow2:"#8C8989 "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #d9dddd","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#f4f5f5"},{pos:"100%",clr:"#dfdddd"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span513").setTagVar({clr1:"#f7e3e3",clr2:"#ffd7d7",clr3:"#ecbbbb",clr4:"#ffa4a4",boxshadow1:"#ffffff",boxshadow2:"#887178 "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #ecbbbb","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#f7e3e3"},{pos:"100%",clr:"#ffd7d7"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span514").setTagVar({clr1:"#ff9a9a",clr2:"#ff4040",clr3:"#ff6767",clr4:"#ff0d0d",boxshadow1:"#FFC2D9",boxshadow2:"#AE0000 "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #ff6767","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#ff9a9a"},{pos:"100%",clr:"#ff4040"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span515").setTagVar({clr1:"#a9a588",clr2:"#8e865b",clr3:"#938e6b",clr4:"#6f6947",boxshadow1:"#D5C2B2",boxshadow2:"#42331C "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #938e6b","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#a9a588"},{pos:"100%",clr:"#8e865b"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span516").setTagVar({clr1:"#f62b2b",clr2:"#d20202",clr3:"#e40a0a",clr4:"#9f0202",boxshadow1:"#FF938C",boxshadow2:"#610000 "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #e40a0a","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#f62b2b"},{pos:"100%",clr:"#d20202"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span517").setTagVar({clr1:"#a67939",clr2:"#845108",clr3:"#805d2c",clr4:"#543305",boxshadow1:"#E1BA8C",boxshadow2:"#1F1800 "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #805d2c","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#a67939"},{pos:"100%",clr:"#845108"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span518").setTagVar({clr1:"#d2d2f9",clr2:"#a6a6f2",clr3:"#a5a5f3",clr4:"#7a7aeb",boxshadow1:"#ffffff",boxshadow2:"#273A8F "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #a5a5f3","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#d2d2f9"},{pos:"100%",clr:"#a6a6f2"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span519").setTagVar({clr1:"#49c0f0",clr2:"#2cafe3",clr3:"#1ab0ec",clr4:"#1a92c2",boxshadow1:"#8FECFF",boxshadow2:"#005D71 "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #1ab0ec","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#49c0f0"},{pos:"100%",clr:"#2cafe3"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span520").setTagVar({clr1:"#cedce7",clr2:"#596a72",clr3:"#acc4d6",clr4:"#434f55",boxshadow1:"#ffffff",boxshadow2:"#182F33 "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #acc4d6","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#cedce7"},{pos:"100%",clr:"#596a72"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span521").setTagVar({clr1:"#b6e026",clr2:"#abdc28",clr3:"#95b91a",clr4:"#8bb41d",boxshadow1:"#C9EC78",boxshadow2:"#4E550C "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #95b91a","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#b6e026"},{pos:"100%",clr:"#abdc28"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span522").setTagVar({clr1:"#eab92d",clr2:"#c79810",clr3:"#cf9f15",clr4:"#98740c",boxshadow1:"#F8D980",boxshadow2:"#524600 "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #cf9f15","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#eab92d"},{pos:"100%",clr:"#c79810"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span523").setTagVar({clr1:"#45484d",clr2:"#000000",clr3:"#9bf1ff",clr4:"#1a1a1a",boxshadow1:"#9F9F9B",boxshadow2:"#000 "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #819bcb","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#45484d"},{pos:"100%",clr:"#000000"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span524").setTagVar({clr1:"#6bbed2",clr2:"#76bdd1",clr3:"#6bbed2",clr4:"#50abc4",boxshadow1:"#C6E8F8",boxshadow2:"#275588 "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #6bbed2","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#6bbed2"},{pos:"100%",clr:"#76bdd1"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span525").setTagVar({clr1:"#6bbed2",clr2:"#23538a",clr3:"#82bbd1",clr4:"#193b61",boxshadow1:"#ffffff",boxshadow2:"#001F33 "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #82bbd1","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#6bbed2"},{pos:"100%",clr:"#23538a"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span760").setTagVar({clr1:"#e6e6e6",clr2:"#cccccc",clr3:"#a3a3a3",clr4:"#999",boxshadow1:"#ffffff",boxshadow2:"#444 "}).setWidth("1.6666666666666667em").setHeight("1.6666666666666667em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer",border:"1px solid #e6e6e6","border-radius":"6px","$gradient":{stops:[{pos:"0%",clr:"#e6e6e6"},{pos:"100%",clr:"#cccccc"}],type:"linear",orient:"T"}}}));c.dialog.append(xui.create("xui.UI.Block").setHost(c,"ctl_block3").setLeft("0.5em").setTop("20.833333333333332em").setWidth("37.5833em").setHeight("13.333333333333334em").setBorderType("inset").setBackground("#ffffff"));c.ctl_block3.append(xui.create("xui.UI.TreeGrid").setHost(c,"tg").setDirtyMark(false).setRowHandler(false).setColResizer(false).setColSortable(false).setHeader([{id:"key",caption:"$RAD.custom_dlg.Attribute",width:"7em",type:"label"},{id:"normal",caption:"$RAD.custom_dlg.normal",width:"7em",flexSize:true,type:"input",editable:true},{id:"hover",caption:"$RAD.custom_dlg.hover",width:"7em",flexSize:true,type:"input",editable:true},{id:"active",caption:"$RAD.custom_dlg.active",width:"7em",flexSize:true,type:"input",editable:true},{id:"focus",caption:"$RAD.custom_dlg.focus",width:"7em",flexSize:true,type:"input",editable:true}]).afterCellUpdated("_tg_aftercellupdated").beforeComboPop("_tg_beforeComboPop").setCustomStyle({SCROLL:{overflowX:"hidden",overflowY:"auto"}}));c.dialog.append(xui.create("xui.UI.Block").setHost(c,"xui_ui_block6").setLeft("0.8333333333333334em").setTop("19.166666666666668em").setWidth("36.666666666666664em").setHeight("0em").setZIndex(0));c.dialog.append(xui.create("xui.UI.StatusButtons").setHost(c,"xui_ui_statusbuttons3").setDirtyMark(false).setItems([{id:"normal",caption:"$RAD.custom_dlg.normal",disabled:true},{id:"hover",caption:"$RAD.custom_dlg.hover"},{id:"active",caption:"$RAD.custom_dlg.active"},{id:"focus",caption:"$RAD.custom_dlg.focus"}]).setDock("center").setLeft("4.083333333333333em").setTop("17.916666666666668em").setWidth("auto").setHeight("auto").setSelMode("multi").setBorderType("none").setLabelGap("0.3333333333333333em").setItemWidth("6em").setValue("active;focus;hover;normal").onChange("_xui_ui_statusbuttons3_onchange"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-25").setClassName("xui-predifined-css-25"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-12").setClassName("xui-predifined-css-12"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-24").setClassName("xui-predifined-css-24"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-7").setClassName("xui-predifined-css-7"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-5").setClassName("xui-predifined-css-5"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-3").setClassName("xui-predifined-css-3"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-10").setClassName("xui-predifined-css-10"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-13").setClassName("xui-predifined-css-13"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-1").setClassName("xui-predifined-css-1"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-8").setClassName("xui-predifined-css-8"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-2").setClassName("xui-predifined-css-2"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-15").setClassName("xui-predifined-css-15"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-22").setClassName("xui-predifined-css-22"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-11").setClassName("xui-predifined-css-11"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-18").setClassName("xui-predifined-css-18"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-20").setClassName("xui-predifined-css-20"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-14").setClassName("xui-predifined-css-14"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-16").setClassName("xui-predifined-css-16"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-21").setClassName("xui-predifined-css-21"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-19").setClassName("xui-predifined-css-19"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-4").setClassName("xui-predifined-css-4"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-6").setClassName("xui-predifined-css-6"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-23").setClassName("xui-predifined-css-23"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-9").setClassName("xui-predifined-css-9"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui-predifined-css-17").setClassName("xui-predifined-css-17"));return b},customAppend:function(c,a,e,d){var b=this,f=b.properties;b.setTargetProfile(f.targetProfile);xui("body").append(b.dialog);b.dialog.getRoot().popToTop(f.src,2).setBlurTrigger("RAD.CustomDecoration2",function(){b.dialog.close()});b.clr1.getRoot().onClick(true);b.dialog.activate();return true},_attr:["font-family","font-size","font-weight","font-style","color","background-color","background-image","background-position","background-repeat","background-attachment","border-top","border-right","border-bottom","border-left","border-radius","padding","margin","text-align","text-decoration","text-shadow","box-shadow","$gradient","cursor","overflow","line-height"],setTargetProfile:function(b){var g=this,e=["normal"],a=b.properties,d=a.normalStatus,j=a.hoverStatus,l=a.activeStatus,c=a.focusStatus;if(!xui.isEmpty(j)){e.push("hover")}if(!xui.isEmpty(l)){e.push("active")}if(c&&!xui.isEmpty(c)){e.push("focus")}g._targetPrf=b;if(b["xui.UIProfile"]){b.getRoot().css({left:"10px",top:"10px",visibility:"visible",display:"block"}).topZindex(true)}xui.arr.each(g._attr,function(m){g.tg.updateCellByRowCol(m,"normal",{value:d[m]||"",caption:xui.isHash(d[m])?"[object]":null},false,false);g.tg.updateCellByRowCol(m,"hover",{value:j[m]||"",caption:xui.isHash(j[m])?"[object]":null},false,false);g.tg.updateCellByRowCol(m,"active",{value:l[m]||"",caption:xui.isHash(l[m])?"[object]":null},false,false);if(c){g.tg.updateCellByRowCol(m,"focus",{value:c[m]||"",caption:xui.isHash(c[m])?"[object]":null},false,false)}});var f=(parseFloat(d.opacity)||parseFloat(d.opacity)===0)?d.opacity:1;g.tg.updateCellByRowCol("opacity","normal",{value:f},false,false);g.tg.updateCellByRowCol("opacity","hover",{value:f},false,false);g.tg.updateCellByRowCol("opacity","active",{value:f},false,false);g.tg.updateCellByRowCol("opacity","focus",{value:f},false,false);if(b._noFocusStatus){g.xui_ui_statusbuttons3.removeItems("focus")}g.xui_ui_statusbuttons3.setUIValue(e.join(";"),true);g.dialog.setCaption("$(RAD.custom_dlg."+(b._title||"CSS Box Editor")+")")},events:{onReady:"_com_onready",onDestroy:"_com_ondestroy"},_com_onready:function(b,e){var c=this,d=[],a;a={type:"color"};d.push({id:"color",cells:[{id:"color",caption:"$RAD.custom_dlg.color"},a,a,a,a]});d.push({id:"background-color",cells:[{id:"background-color",caption:"$(RAD.custom_dlg.background$-color)"},a,a,a,a]});a={type:CONF.getClientMode()=="singlepage"?"input":"popbox",event:function(l,f,g){var m=l.getSubNode("CELL",f._serialId),j=function(n){g.boxing().setUIValue("url("+CONF.adjustRelativePath(n)+")");m.focus()};if(window.SPA&&false===SPA.fe("beforeURISelectorPop",[f._col.id+"Status:background-image",f.value,j,"RAD.CustomDecoration2",c.properties.targetProfile.boxing(),m.get(0),f,l.boxing(),g&&g.boxing()])){return}if(CONF.getClientMode()!="singlepage"){xui.ComFactory.getCom("RAD.ImageSelector",function(){this.setProperties({fromRegion:m.cssRegion(true),onOK:function(o,n){j(n)}});this.show()})}}};d.push({id:"background-image",cells:[{id:"background-image",caption:"$(RAD.custom_dlg.background$-image)"},a,a,a,a]});a={type:"combobox",editorListItems:CONF.designer_background_position};d.push({id:"background-position",cells:[{id:"background-position",caption:"$(RAD.custom_dlg.background$-position)"},a,a,a,a]});a={type:"combobox",editorListItems:CONF.designer_background_repeat};d.push({id:"background-repeat",cells:[{id:"background-repeat",caption:"$(RAD.custom_dlg.background$-repeat)"},a,a,a,a]});a={type:"combobox",editorListItems:CONF.designer_background_attachment};d.push({id:"background-attachment",cells:[{id:"background-attachment",caption:"$(RAD.custom_dlg.background$-attachment)"},a,a,a,a]});a={type:"helpinput",editorListItems:CONF.designer_data_fontfamily};d.push({id:"font-family",cells:[{id:"font-family",caption:"$(RAD.custom_dlg.font$-family)"},a,a,a,a]});a={type:"combobox",editorListItems:CONF.designer_data_fontsize};d.push({id:"font-size",cells:[{id:"font-size",caption:"$(RAD.custom_dlg.font$-size)"},a,a,a,a]});a={type:"combobox",editorListItems:CONF.designer_data_fontweight};d.push({id:"font-weight",cells:[{id:"font-weight",caption:"$(RAD.custom_dlg.font$-weight)"},a,a,a,a]});a={type:"combobox",editorListItems:CONF.designer_data_fontstyle};d.push({id:"font-style",cells:[{id:"font-style",caption:"$(RAD.custom_dlg.font$-style)"},a,a,a,a]});a={type:"popbox"};d.push({id:"border-top",cells:[{id:"border-top",caption:"$(RAD.custom_dlg.border$-top)"},a,a,a,a]});d.push({id:"border-right",cells:[{id:"border-right",caption:"$(RAD.custom_dlg.border$-right)"},a,a,a,a]});d.push({id:"border-bottom",cells:[{id:"border-bottom",caption:"$(RAD.custom_dlg.border$-bottom)"},a,a,a,a]});d.push({id:"border-left",cells:[{id:"border-left",caption:"$(RAD.custom_dlg.border$-left)"},a,a,a,a]});if(xui.Dom.css3Support("border-radius")){d.push({id:"border-radius",cells:[{id:"border-radius",caption:"$(RAD.custom_dlg.border$-radius)"},a,a,a,a]})}d.push({id:"padding",cells:[{id:"padding",caption:"$RAD.custom_dlg.padding"},a,a,a,a]});d.push({id:"margin",cells:[{id:"margin",caption:"$RAD.custom_dlg.margin"},a,a,a,a]});a={type:"combobox",editorListItems:CONF.designer_data_textalign};d.push({id:"text-align",cells:[{id:"text-align",caption:"$(RAD.custom_dlg.text$-align)"},a,a,a,a]});a={type:"combobox",editorListItems:CONF.designer_data_textdecoration};d.push({id:"text-decoration",cells:[{id:"text-decoration",caption:"$(RAD.custom_dlg.text$-decoration)"},a,a,a,a]});if(xui.Dom.css3Support("text-shadow")){a={type:"popbox"};d.push({id:"text-shadow",cells:[{id:"text-shadow",caption:"$(RAD.custom_dlg.text$-shadow)"},a,a,a,a]})}if(xui.Dom.css3Support("box-shadow")){a={type:"popbox"};d.push({id:"box-shadow",cells:[{id:"box-shadow",caption:"$(RAD.custom_dlg.box$-shadow)"},a,a,a,a]})}if(xui.Dom.css3Support("gradient")){a={type:"cmdbox",editorReadonly:true};d.push({id:"$gradient",cells:[{id:"gradients",caption:"$RAD.custom_dlg.gradients"},a,a,a,a]})}a={type:"combobox",editorListItems:CONF.designer_data_cursor};d.push({id:"cursor",cells:[{id:"cursor",caption:"$RAD.custom_dlg.cursor"},a,a,a,a]});a={type:"combobox",editorListItems:CONF.designer_data_overflow};d.push({id:"overflow",cells:[{id:"overflow",caption:"$RAD.custom_dlg.overflow"},a,a,a,a]});a={type:"combobox",editorListItems:[1,1.22,1.5,2]};d.push({id:"line-height",cells:[{id:"line-height",caption:"$(RAD.custom_dlg.line$-height)"},a,a,a,a]});if(xui.Dom.css3Support("opacity")){a={value:1,type:"progress",editorProperties:{min:0,max:1}};d.push({id:"opacity",cells:[{id:"opacity",caption:"$RAD.custom_dlg.opacity"},a,a,a,a]})}c.tg.setRows(d)},_dialog_beforeclose:function(b){var a=this;a.dialog.getRoot().setBlurTrigger("RAD.CustomDecoration2");if(a._targetPrf){xui.arr.each(a._attr,function(c){a.tg.updateCellByRowCol(c,"normal",{value:""},false,false);a.tg.updateCellByRowCol(c,"hover",{value:""},false,false);a.tg.updateCellByRowCol(c,"active",{value:""},false,false);a.tg.updateCellByRowCol(c,"focus",{value:""},false,false)});a.tg.updateCellByRowCol("opacity","normal",{value:1},false,false);a.tg.updateCellByRowCol("opacity","hover",{value:1},false,false);a.tg.updateCellByRowCol("opacity","active",{value:1},false,false);a.tg.updateCellByRowCol("opacity","focus",{value:1},false,false);a.fireEvent("onFinished");if(a._targetPrf["xui.UIProfile"]){a._targetPrf.getRoot().css({left:xui.Dom.HIDE_VALUE,top:xui.Dom.HIDE_VALUE,visibility:"hidden",display:"none","z-index":0})}a._targetPrf=null;b.boxing().hide()}return false},_tg_beforeComboPop:function(f,o,g,m,l,a){var n=this,d=n._targetPrf,b=d.properties,c=o._col.id,j={},s=function(e){return xui.get(b,[c+"Status",e])||""},r,q;switch(o._row.id){case"border-top":case"border-right":case"border-bottom":case"border-left":case"border-radius":case"padding":case"margin":j.border={top:s("border-top")||s("border"),right:s("border-right")||s("border"),bottom:s("border-bottom")||s("border"),left:s("border-left")||s("border")};j["border-radius"]=s("border-radius");j.padding=s("padding");j.margin=s("margin");break;default:j=s(o._row.id)}switch(o._row.id){case"border-top":case"border-right":case"border-bottom":case"border-left":case"border-radius":case"padding":case"margin":r="RAD.CustomBorder";break;case"text-shadow":r="RAD.CustomTextShadow";break;case"box-shadow":r="RAD.CustomBoxShadow";break;case"$gradient":r="RAD.CustomGradients";break}if(r){xui.ComFactory.getCom(r,function(){this.init(d,j,{pro:g,cell:o,isSvg:0,grid:n.tg},2);this.setEvents({onChange:function(u){switch(o._row.id){case"border-top":g.boxing().setUIValue(u.border["top"]||"",true);break;case"border-right":g.boxing().setUIValue(u.border["right"]||"",true);break;case"border-bottom":g.boxing().setUIValue(u.border["bottom"]||"",true);break;case"border-left":g.boxing().setUIValue(u.border["left"]||"",true);break;case"border-radius":case"padding":case"margin":g.boxing().setUIValue(u[o._row.id]||"",true);break;default:if(xui.isHash(u)){g.boxing().setCaption("[object]",true)}else{if(xui.isNull(u)){g.boxing().setCaption(null,true)}}g.boxing().setUIValue(u?xui.isStr(u)?u:"[object]":"",true)}switch(o._row.id){case"border-top":case"border-right":case"border-bottom":case"border-left":case"border-radius":case"padding":case"margin":f.boxing().updateCellByRowCol("padding",c,{value:u.padding||""},false,true);f.boxing().updateCellByRowCol("margin",c,{value:u.margin||""},false,true);f.boxing().updateCellByRowCol("border-radius",c,{value:u["border-radius"]||""},false,true);f.boxing().updateCellByRowCol("border-left",c,{value:u.border["left"]||""},false,true);f.boxing().updateCellByRowCol("border-right",c,{value:u.border["right"]||""},false,true);f.boxing().updateCellByRowCol("border-top",c,{value:u.border["top"]||""},false,true);f.boxing().updateCellByRowCol("border-bottom",c,{value:u.border["bottom"]||""},false,true);break;default:if(xui.isHash(u)){f.boxing().updateCell(o,{caption:"[object]"},false,true)}else{if(xui.isNull(u)){f.boxing().updateCell(o,{caption:""},false,true)}}f.boxing().updateCell(o,{value:u||""},false,true)}}});this.render();var e=this.mainPane.getRoot();e.popToTop(g.getRoot());e.setBlurTrigger(e.$xid,function(){e.setBlurTrigger(e.$xid);e.hide()})})}},_tg_aftercellupdated:function(f,a,b){if("value" in b){var e=this,d=e.tg,c=a._col.id;hash={};xui.each(d.getCells(null,c),function(g){var j="";if(g._row.id=="$gradient"){hash[g._row.id]=g.value;if(!g.value){delete hash[g._row.id]}}else{if(g._row.id=="opacity"){if(parseFloat(g.value)!==1){j=parseFloat(g.value);hash[g._row.id]=j;if(j==1){delete hash[g._row.id]}}}else{if(xui.str.trim(g.value)!==""){j=xui.str.trim(g.value);hash[g._row.id]=j}}}});e._targetPrf.boxing()["set"+xui.str.initial(c)+"Status"](hash);e.fireEvent("onDirty")}},_clrpatternclicked:function(a){this._applyClrs(a.properties.tagVar)},_applyClrs:function(x){var r=this;var d=[{color:"{txtclr}",border:"solid {clr3} 1px","border-radius":"6px","box-shadow":"inset 0px 1px 0px {boxshadow1}","text-shadow":"{txtshadow}","$gradient":{stops:[{pos:"0%",clr:"{clr2}"},{pos:"100%",clr:"{clr3}"}],type:"linear",orient:"T"},cursor:"pointer"},{"$gradient":{stops:[{pos:"0%",clr:"{clr3}"},{pos:"100%",clr:"{clr4}"}],type:"linear",orient:"T"}},{"box-shadow":"inset 0px 1px 2px {boxshadow2}","background-image":"none","background-color":"{clr1}"},{}],b=[{color:"{txtclr}",border:"solid {clr3} 1px","border-radius":"6px","box-shadow":"inset 0px 1px 0px {boxshadow1}","text-shadow":"{txtshadow}","$gradient":{stops:[{pos:"0%",clr:"{clr1}"},{pos:"70%",clr:"{clr2}"}],type:"linear",orient:"T"},cursor:"pointer"},{"$gradient":{stops:[{pos:"3%",clr:"{clr3}"},{pos:"95%",clr:"{clr4}"}],type:"linear",orient:"T"}},{"box-shadow":"inset 0px 1px 2px {boxshadow2}","background-image":"none","background-color":"{clr1}"},{}],w=[{color:"{txtclr}",border:"solid {clr3} 1px","border-radius":"6px","box-shadow":"inset 0px 1px 0px {boxshadow1}","text-shadow":"{txtshadow}","$gradient":{stops:[{pos:"0%",clr:"{clr1}"},{pos:"50%",clr:"{clr2}"},{pos:"100%",clr:"{clr3}"}],type:"linear",orient:"T"},cursor:"pointer"},{"$gradient":{stops:[{pos:"0%",clr:"{clr3}"},{pos:"50%",clr:"{clr4}"},{pos:"100%",clr:"{boxshadow2}"}],type:"linear",orient:"T"}},{"box-shadow":"inset 0px 1px 2px {boxshadow2}","background-image":"none","background-color":"{clr1}"},{}],n=[{color:"{txtclr}",border:"solid {clr3} 1px","border-radius":"6px","box-shadow":"inset 0px 1px 0px {boxshadow1}","text-shadow":"{txtshadow}","$gradient":{stops:[{pos:"50%",clr:"{clr1}"},{pos:"51%",clr:"{clr2}"}],type:"linear",orient:"T"},cursor:"pointer"},{"$gradient":{stops:[{pos:"50%",clr:"{clr3}"},{pos:"51%",clr:"{clr4}"}],type:"linear",orient:"T"}},{"box-shadow":"inset 0px 1px 2px {boxshadow2}","background-image":"none","background-color":"{clr1}"},{}],a=[{color:"{txtclr}",border:"none","border-radius":"6px","text-shadow":"{txtshadow}","background-color":"{clr1}",cursor:"pointer"},{"background-color":"{clr2}"},{"background-color":"{clr4}"},{}];var f=[d,b,w,n,a];var u=["#eeeeee","#eeeeee","#eeeeee","#222222","#222222"];var m=["none","0 -1px 0 {boxshadow2}","0 1px 0 {boxshadow2}","0 1px 0 {boxshadow1}","0 -1px 0 {boxshadow1}"];var s=function(j){return j.replace("{clr1}",x.clr1).replace("{clr2}",x.clr2).replace("{clr3}",x.clr3).replace("{clr4}",x.clr4).replace("{boxshadow1}",x.boxshadow1).replace("{boxshadow2}",x.boxshadow2)};for(var l=1;l<=25;l++){var g=l%5||5,e=parseInt((l-1)/5,10),c,q=xui.clone(f[e]);if(!q[0]){continue}c=q[0];if(c.color){c.color=s(u[g-1])}c["text-shadow"]=c["text-shadow"]?s(m[g-1]):"";c["box-shadow"]=c["box-shadow"]?s(c["box-shadow"]):"none";if(c.border){c.border=s(c.border);c["border-top"]=c.border;c["border-right"]=c.border;c["border-bottom"]=c.border;c["border-left"]=c.border;delete c.border}if(c["background-color"]){c["background-color"]=s(c["background-color"])}if(c["background-image"]){c["background-image"]=s(c["background-image"])}if(c.$gradient){xui.arr.each(c.$gradient.stops,function(j,o){if(j.clr){j.clr=s(j.clr)}})}else{if(!c["background-image"]){c["background-image"]="none"}}if(c=q[1]){if(c.color){c.color=s(u[g-1])}if(c["text-shadow"]){c["text-shadow"]=s(m[g-1])}if(c["box-shadow"]){c["box-shadow"]=s(c["box-shadow"])}if(c.border){c.border=s(c.border);c["border-top"]=c.border;c["border-right"]=c.border;c["border-bottom"]=c.border;c["border-left"]=c.border;delete c.border}if(c["background-color"]){c["background-color"]=s(c["background-color"])}if(c["background-image"]){c["background-image"]=s(c["background-image"])}if(c.$gradient){xui.arr.each(c.$gradient.stops,function(j,o){if(j.clr){j.clr=s(j.clr)}})}else{if(!c["background-image"]){c["background-image"]="none"}}}if(c=q[2]){if(c.color){c.color=s(u[g-1])}if(c["text-shadow"]){c["text-shadow"]=s(m[g-1])}if(c["box-shadow"]){c["box-shadow"]=s(c["box-shadow"])}if(c.border){c.border=s(c.border);c["border-top"]=c.border;c["border-right"]=c.border;c["border-bottom"]=c.border;c["border-left"]=c.border;delete c.border}if(c["background-color"]){c["background-color"]=s(c["background-color"])}if(c["background-image"]){c["background-image"]=s(c["background-image"])}if(c.$gradient){xui.arr.each(c.$gradient.stops,function(j,o){if(j.clr){j.clr=s(j.clr)}})}else{if(!c["background-image"]){c["background-image"]="none"}}}if(c=q[3]){if(c.color){c.color=s(u[g-1])}if(c["text-shadow"]){c["text-shadow"]=s(m[g-1])}if(c["box-shadow"]){c["box-shadow"]=s(c["box-shadow"])}if(c.border){c.border=s(c.border);c["border-top"]=c.border;c["border-right"]=c.border;c["border-bottom"]=c.border;c["border-left"]=c.border;delete c.border}if(c["background-color"]){c["background-color"]=s(c["background-color"])}if(c["background-image"]){c["background-image"]=s(c["background-image"])}}r["xui-predifined-css-"+l].setNormalStatus(q[0]).setHoverStatus(q[1]).setActiveStatus(q[2]).setFocusStatus(q[3]||{})}},_btnclick:function(f,l,g){var d=this,j=d._targetPrf,c=j.boxing(),b=f.properties.className,a=d.xui_ui_statusbuttons3.getUIValue(true);c.setNormalStatus(xui.clone(d[b].getNormalStatus()));if(xui.arr.indexOf(a,"hover")!=-1){c.setHoverStatus(xui.clone(d[b].getHoverStatus()))}if(xui.arr.indexOf(a,"active")!=-1){c.setActiveStatus(xui.clone(d[b].getActiveStatus()))}if(xui.arr.indexOf(a,"focus")!=-1){c.setFocusStatus(xui.clone(d[b].getFocusStatus()))}d.setTargetProfile(j);d.fireEvent("onDirty")},_xui_ui_statusbuttons3_onchange:function(e,a,b,c,m){var l=this,d=l.tg,f=b.split(";"),j=l._targetPrf,g=j.boxing&&j.boxing();xui.arr.each(["normal","hover","active","focus"],function(n){d.showColumn(n,xui.arr.indexOf(f,n)!=-1)});if(g){if(xui.arr.indexOf(f,"hover")==-1){g.setHoverStatus({},true)}if(xui.arr.indexOf(f,"active")==-1){g.setActiveStatus({},true)}if(xui.arr.indexOf(f,"focus")==-1){g.setFocusStatus({},true)}}}}});xui.Class("RAD.SVGCustomDecoration","xui.Module",{Instance:{initialize:function(){this.autoDestroy=true;this.properties={}},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dialog").setLeft("13.125em").setTop("1.25em").setWidth("21.75em").setHeight("36.25em").setResizer(false).setCaption("$(RAD.custom_dlg.Custom Decoration)").setMinBtn(false).setMaxBtn(false).setOverflow("visible").beforeClose("_dialog_beforeclose"));c.dialog.append(xui.create("xui.UI.Group").setHost(c,"grpNodes").setLeft("0em").setTop("0.25em").setWidth("20.916666666666668em").setHeight("10.5em").setCaption("grpNodes").setToggleBtn(false));c.grpNodes.append(xui.create("xui.UI.TreeView").setHost(c,"tv").setDirtyMark(false).onItemSelected("_tv_onitemselected").setCustomStyle({BOX:"background-color:transparent;"}));c.dialog.append(xui.create("xui.UI.Block").setHost(c,"ctl_block3").setLeft("0em").setTop("12.75em").setWidth("20.916666666666668em").setHeight("20em").setBorderType("inset").setBackground("#fff"));c.ctl_block3.append(xui.create("xui.UI.TreeGrid").setHost(c,"tg").setDirtyMark(false).setRowHandler(false).setColSortable(false).setHeader([{id:"key",width:"7.5em",type:"label",caption:"$RAD.custom_dlg.Attribute"},{id:"value",editable:true,width:"11.166666666666666em",type:"input",caption:"$RAD.custom_dlg.Value"}]).afterCellUpdated("_tg_aftercellupdated").beforeComboPop("_tg_beforeComboPop").setCustomStyle({SCROLL:"overflow-x:hidden;overflow-y:auto;"}));c.dialog.append(xui.create("xui.UI.Input").setHost(c,"ctl_input1").setReadonly(true).setLeft("0em").setTop("10.833333333333334em").setWidth("20.916666666666668em").setHeight("1.8333333333333333em"));return b},customAppend:function(c,a,e,d){var b=this,f=b.properties;b.setTargetProfile(f.targetProfile);xui("body").append(b.dialog);b.dialog.getRoot().popToTop(xui(f.src),2).setBlurTrigger("RAD.SVGCustomDecoration",function(){b.dialog.close()});b.dialog.activate();return true},setTargetProfile:function(f){var e=this,b=[],a,d,j,g;e.$target=f;d=f.box.$tagName.KEY;b.push(a={id:"KEY",caption:"ROOT ["+d+"]",tagName:d,imageClass:"spafont spa-icon-domnode",sub:[]});j=f.properties.attr;if(j.KEY&&xui.isHash(j.KEY)){for(var c in j){if(c!=="KEY"){d=f.box.$tagName[c]||c.split("_")[0].toLowerCase();g={id:c,caption:c+" ["+d+"]",tagName:d,imageClass:"spafont spa-icon-domnode"};a.sub.push(g)}}}if(!a.sub.length){delete a.sub}e.grpNodes.setCaption(f.key.slice(f.key.lastIndexOf(".")+1)+" : "+f.alias+" $RAD.custom_dlg.Nodes");e.tv.setTagVar(f);e.tv.setItems(b);e.tg.setDisabled(true);e.ctl_input1.setValue("");e.tv.toggleNode("KEY",true,true);e.tv.fireItemClickEvent("KEY")},_tv_onitemselected:function(c,l,g){var j=this,n={href:1,target:1,"letter-spacing":1,blur:1,font:1},b=c.boxing().getTagVar(),o=[],m=function(q,e){if(q=="text"){if(e=="stroke"){return"none"}if(e=="fill"){return"#000"}}return Raphael._availableAttrs[e]};j.tg.removeAllRows().setDisabled(false);var a=b.getSubNode(l.id),f=b.boxing().getAttr(l.id);if(a=a.get(0)){var d="<"+a.tagName+" id='"+a.id+"' style='"+xui(a).attr("style")+"'>";j.ctl_input1.setValue(d).setTips(d.replace(/</,"&lt;"))}else{j.ctl_input1.setValue("").setTips("")}xui.each(xui.svg.$attr[l.tagName],function(q,e){if(n[e]){return}switch(l.tagName){case"text":if(e=="arrow-start"||e=="arrow-end"||e=="stroke-dasharray"||e=="stroke-linecap"||e=="stroke-linejoin"||e=="stroke-miterlimit"||e=="stroke-opacity"||e=="stroke-width"){return}if(b.box["xui.svg.absComb"]&&(e=="transform"||e=="text-anchor")){return}break;case"rect":case"circle":case"ellipse":case"image":if(e=="arrow-start"||e=="arrow-end"){return}break}var s=null,r=(e in f)?f[e]:m(l.tagName,e);switch(e){case"arrow-end":s={id:e,cells:[{id:e,caption:"$(RAD.custom_dlg.arrow$-end)"},{type:"popbox",value:r||""}]};break;case"arrow-start":s={id:e,cells:[{id:e,caption:"$(RAD.custom_dlg.arrow$-start)"},{type:"popbox",value:r||""}]};break;case"fill":s={id:e,cells:[{id:e,caption:"$RAD.custom_dlg."+e},{type:"popbox",value:r||""}]};break;case"stroke":s={id:e,cells:[{id:e,caption:"$RAD.custom_dlg."+e},{type:"color",value:r||""}]};break;case"font-family":s={id:e,cells:[{id:e,caption:"$(RAD.custom_dlg."+e.replace(/-/g,"$-")+")"},{type:"helpinput",editorListItems:CONF.designer_data_fontfamily,value:r||""}]};break;case"font-size":s={id:e,cells:[{id:e,caption:"$(RAD.custom_dlg."+e.replace(/-/g,"$-")+")"},{type:"combobox",editorListItems:CONF.designer_data_fontsize,value:r||""}]};break;case"font-style":s={id:e,cells:[{id:e,caption:"$(RAD.custom_dlg."+e.replace(/-/g,"$-")+")"},{type:"combobox",editorListItems:CONF.designer_data_fontstyle,value:r||""}]};break;case"font-weight":s={id:e,cells:[{id:e,caption:"$(RAD.custom_dlg."+e.replace(/-/g,"$-")+")"},{type:"combobox",editorListItems:CONF.designer_data_fontweight,value:r||""}]};break;case"opacity":case"stroke-opacity":case"fill-opacity":s={id:e,cells:[{id:e,caption:"$(RAD.custom_dlg."+e.replace(/-/g,"$-")+")"},{type:"progress",editorProperties:{min:0,max:1},value:(parseFloat(r)||parseFloat(r)===0)?r:1}]};break;case"src":s={id:e,cells:[{id:e,caption:"$RAD.custom_dlg."+e},{value:r||"",type:CONF.getClientMode()=="singlepage"?"input":"popbox",event:function(A,u,w){var B=A.getSubNode("CELL",u._serialId),x=function(C){w.boxing().setUIValue(CONF.adjustRelativePath(C));B.focus()};if(window.SPA&&false===SPA.fe("beforeURISelectorPop",["src",u.value,x,"RAD.SVGCustomDecoration",j.$target.boxing(),B.get(0),u,A.boxing(),w&&w.boxing()])){return}if(CONF.getClientMode()!="singlepage"){xui.ComFactory.getCom("RAD.ImageSelector",function(){this.setProperties({fromRegion:B.cssRegion(true),onOK:function(D,C){x(C)}});this.show()})}}}]};break;break;case"path":case"text":s={id:e,cells:[{id:e,caption:"$RAD.custom_dlg."+e},{type:"textarea",value:r||""}]};break;case"cx":case"cy":case"x":case"y":case"width":case"height":case"r":case"rx":case"ry":case"stroke-width":s={id:e,cells:[{id:e,caption:"$(RAD.custom_dlg."+e.replace(/-/g,"$-")+")"},{type:"spin",increment:1,precision:0,min:0,value:r||0}]};break;case"stroke-miterlimit":s={id:e,cells:[{id:e,caption:"$(RAD.custom_dlg.stroke$-miterlimit)"},{type:"spin",increment:1,precision:0,min:0,value:r||0}]};break;case"stroke-dasharray":s={id:e,cells:[{id:e,caption:"$(RAD.custom_dlg.stroke$-dasharray)"},{type:"combobox",editorListItems:CONF.designer_data_strokedasharray,value:r||""}]};break;case"stroke-linecap":s={id:e,cells:[{id:e,caption:"$(RAD.custom_dlg.stroke$-linecap)"},{type:"listbox",editorListItems:CONF.designer_data_strokelinecap,value:r||""}]};break;case"stroke-linejoin":s={id:e,cells:[{id:e,caption:"$(RAD.custom_dlg.stroke$-linejoin)"},{type:"listbox",editorListItems:CONF.designer_data_strokelinejoin,value:r||""}]};break;case"text-anchor":s={id:e,cells:[{id:e,caption:"$(RAD.custom_dlg.text$-anchor)"},{type:"listbox",editorListItems:CONF.designer_data_textalign}]};break;case"transform":s={id:e,cells:[{id:e,caption:"$RAD.custom_dlg."+e},{type:"popbox",value:r||""}]};break;case"cursor":s={id:e,cells:[{id:e,caption:"$RAD.custom_dlg."+e},{type:"combobox",editorListItems:CONF.designer_data_cursor,value:r||""}]};break;case"title":s={id:e,cells:[{id:e,caption:"$RAD.custom_dlg."+e},{type:"input",value:r||""}]};break}if(s){o.push(s)}});window.SPA&&SPA.fe("onInitEditorRows",["attr",l.tagName,j.$target.properties.attr,"RAD.SVGCustomDecoration",j.$target,o,j.tg]);if(window.SPA&&SPA.events.onInitPropValueCell){xui.arr.each(o,function(e){xui.arr.each(e.cells,function(q,r){window.SPA&&SPA.fe("onInitPropValueCell",["attr",l.tagName,q.value,"RAD.SVGCustomDecoration",j.$target,q,j.tg])})})}j.tg.setRows(o).setTag(l.tagName);c.boxing().setTag(l.id)},_ctl_sbutton1_onclick:function(a){this.setTargetProfile(this.ctl_panel3.get(0))},_ctl_sbutton37_onclick:function(a,c,d,b){this.setTargetProfile(this.ctl_tabs2.get(0))},_dialog_beforeclose:function(a){this.dialog.getRoot().setBlurTrigger("RAD.SVGCustomDecoration");a.boxing().hide();this.tv.setValue(null,true);this.fireEvent("onFinished");return false},_tg_beforeComboPop:function(c,n,m,j,g,a){var l=this,b=l.tv.getTagVar(),d=l.tv.getTag(),o,f;if(window.SPA&&false===SPA.fe("beforeEditorComboPop",["attr:"+d,n._row.id,n.value,function(e){editorprf.boxing().setUIValue(e||"",true)},"RAD.SVGCustomDecoration",l.properties.targetProfile.boxing(),j,c.getSubNode("CELL",n._serialId).get(0),n,l.tg,m&&m.boxing()])){return false}switch(n._row.id){case"arrow-start":o="RAD.CustomArrows";f=function(u){var s=this.properties.pro,r=l.tg,w=u[0]&&u[0].split("-"),q=u[1]&&u[1].split("-"),e;if(w[0]=="none"){u[0]="none"}e=r.getCellbyRowCol("arrow-start","value");if(e){r.updateCell(e,{value:u[0]},false,true)}if(q[0]=="none"){u[1]="none"}e=r.getCellbyRowCol("arrow-end","value");if(e){r.updateCell(e,{value:u[1]},false,true)}if(!s.destroyed){s.boxing().setValue(u[0],true)}};break;case"arrow-end":o="RAD.CustomArrows";f=function(u){var s=this.properties.pro,r=l.tg,w=u[0]&&u[0].split("-"),q=u[1]&&u[1].split("-"),e;if(w[0]=="none"){u[0]="none"}e=r.getCellbyRowCol("arrow-start","value");if(e){r.updateCell(e,{value:u[0]},false,true)}if(q[0]=="none"){u[1]="none"}e=r.getCellbyRowCol("arrow-end","value");if(e){r.updateCell(e,{value:u[1]},false,true)}if(!s.destroyed){s.boxing().setValue(u[1],true)}};break;case"transform":o="RAD.CustomTransform";f=function(r){var q=this.properties.pro,e=this.properties.cell;if(!q.destroyed){q.boxing().setValue(xui.isStr(r)?r:"[object]",true)}c.boxing().updateCell(e,{value:r},false,true)};break;case"fill":o="RAD.SVGCustomGradients";f=function(r){var q=this.properties.pro,e=this.properties.cell;if(!q.destroyed){q.boxing().setValue(xui.isStr(r)?r:"[object]",true)}c.boxing().updateCell(e,{value:r},false,true)};break}if(o){xui.ComFactory.getCom(o,function(){this.init(b,d,{pro:m,cell:n,grid:l.tg,isSvg:1});this.setEvents({onChange:f});this.render();var e=this.mainPane.getRoot();e.popToTop(m.getRoot());e.setBlurTrigger(e.$xid,function(){e.setBlurTrigger(e.$xid);e.hide()})})}},_tg_aftercellupdated:function(e,a,c){var j={path:1,text:1,cx:1,cy:1,x:1,y:1,width:1,height:1,r:1,rx:1,ry:1,"stroke-width":1};if("value" in c){var d=this,f=d.tv.getTagVar(),g={},b=d.tv.getTag();if(f&&b){g[a._row.id]=c.value;f.boxing().setAttr(b,g,false);d.fireEvent("onDirty",[j[a._row.id]])}}}}});xui.Class("RAD.CustomArrows","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"mainPane").setLeft("0.625em").setTop("1.25em").setWidth("41.833333333333336em").setHeight("28.666666666666668em").setShadow(false).setResizer(false).setCaption("$(RAD.custom_dlg.arrow.Custom Arrows)").setMinBtn(false).setMaxBtn(false).beforeClose("_mainPane_beforeclose"));c.mainPane.append(xui.create("xui.UI.Block").setHost(c,"bg").setDock("fill").setBorderType("inset"));c.bg.append(xui.create("xui.UI.Block").setHost(c,"ctl_block63").setDock("fill").setBorderType("none").setOverflow("hidden"));c.ctl_block63.append(xui.create("xui.UI.Panel").setHost(c,"ctl_panel3").setDock("none").setLeft("0.8333333333333334em").setTop("3.125em").setWidth("19.166666666666668em").setHeight("21.75em").setOverflow("hidden").setCaption("$(RAD.custom_dlg.arrow.Arrow Start)"));c.ctl_panel3.append(xui.create("xui.UI.Group").setHost(c,"ctl_group142").setLeft("0.6875em").setTop("0.6666666666666666em").setWidth("7.75em").setHeight("17.333333333333332em").setOverflow("hidden").setCaption("$RAD.custom_dlg.arrow.Type"));c.ctl_group142.append(xui.create("xui.UI.RadioBox").setHost(c,"ctl_type").setDirtyMark(false).setItems([{id:"none",caption:"$RAD.custom_dlg.arrow.none"},{id:"classic",caption:"$RAD.custom_dlg.arrow.classic"},{id:"block",caption:"$RAD.custom_dlg.arrow.block"},{id:"open",caption:"$RAD.custom_dlg.arrow.open"},{id:"oval",caption:"$RAD.custom_dlg.arrow.oval"},{id:"diamond",caption:"$RAD.custom_dlg.arrow.diamond"}]).setDock("fill").setLeft("0em").setTop("0em").setWidth("5.625em").setValue("none").afterUIValueSet("_ctl_afteruivalueset").setCustomStyle({ITEM:"display:block"}));c.ctl_panel3.append(xui.create("xui.UI.Group").setHost(c,"ctl_group143").setLeft("9.083333333333334em").setTop("0.6666666666666666em").setWidth("8.333333333333334em").setHeight("8.333333333333334em").setOverflow("hidden").setCaption("$RAD.custom_dlg.arrow.Width"));c.ctl_group143.append(xui.create("xui.UI.RadioBox").setHost(c,"ctl_width").setDirtyMark(false).setItems([{id:"narrow",caption:"$RAD.custom_dlg.arrow.narrow"},{id:"midium",caption:"$RAD.custom_dlg.arrow.midium"},{id:"wide",caption:"$RAD.custom_dlg.arrow.wide"}]).setDock("fill").setLeft("0em").setTop("0em").setWidth("5.625em").setHeight("5em").setValue("narrow").afterUIValueSet("_ctl_afteruivalueset").setCustomStyle({ITEM:"display:block"}));c.ctl_panel3.append(xui.create("xui.UI.Group").setHost(c,"ctl_group144").setLeft("9.083333333333334em").setTop("9.666666666666666em").setWidth("8.333333333333334em").setHeight("8.333333333333334em").setOverflow("hidden").setCaption("$RAD.custom_dlg.arrow.Length"));c.ctl_group144.append(xui.create("xui.UI.RadioBox").setHost(c,"ctl_length").setDirtyMark(false).setItems([{id:"short",caption:"$RAD.custom_dlg.arrow.short"},{id:"midium",caption:"$RAD.custom_dlg.arrow.midium"},{id:"long",caption:"$RAD.custom_dlg.arrow.long"}]).setDock("fill").setLeft("0em").setTop("0em").setWidth("5.625em").setHeight("5em").setValue("short").afterUIValueSet("_ctl_afteruivalueset").setCustomStyle({ITEM:"display:block"}));c.ctl_block63.append(xui.create("xui.UI.Panel").setHost(c,"ctl_panel4").setDock("none").setLeft("20.583333333333332em").setTop("3.125em").setWidth("19.416666666666668em").setHeight("21.75em").setOverflow("hidden").setCaption("$(RAD.custom_dlg.arrow.Arrow End)"));c.ctl_panel4.append(xui.create("xui.UI.Group").setHost(c,"ctl_gtype2").setLeft("0.6875em").setTop("0.6666666666666666em").setWidth("8.416666666666666em").setHeight("17.333333333333332em").setOverflow("hidden").setCaption("$RAD.custom_dlg.arrow.Type"));c.ctl_gtype2.append(xui.create("xui.UI.RadioBox").setHost(c,"ctl_type2").setDirtyMark(false).setItems([{id:"none",caption:"$RAD.custom_dlg.arrow.none"},{id:"classic",caption:"$RAD.custom_dlg.arrow.classic"},{id:"block",caption:"$RAD.custom_dlg.arrow.block"},{id:"open",caption:"$RAD.custom_dlg.arrow.open"},{id:"oval",caption:"$RAD.custom_dlg.arrow.oval"},{id:"diamond",caption:"$RAD.custom_dlg.arrow.diamond"}]).setDock("fill").setLeft("0em").setTop("0em").setWidth("5.625em").setValue("none").afterUIValueSet("_ctl_afteruivalueset").setCustomStyle({ITEM:"display:block"}));c.ctl_panel4.append(xui.create("xui.UI.Group").setHost(c,"ctl_group467").setLeft("9.583333333333334em").setTop("0.6666666666666666em").setWidth("8.333333333333334em").setHeight("8.333333333333334em").setOverflow("hidden").setCaption("$RAD.custom_dlg.arrow.Width"));c.ctl_group467.append(xui.create("xui.UI.RadioBox").setHost(c,"ctl_width2").setDirtyMark(false).setItems([{id:"narrow",caption:"$RAD.custom_dlg.arrow.narrow"},{id:"midium",caption:"$RAD.custom_dlg.arrow.midium"},{id:"wide",caption:"$RAD.custom_dlg.arrow.wide"}]).setDock("fill").setLeft("0em").setTop("0em").setWidth("6.25em").setHeight("5em").setValue("narrow").afterUIValueSet("_ctl_afteruivalueset").setCustomStyle({ITEM:"display:block"}));c.ctl_panel4.append(xui.create("xui.UI.Group").setHost(c,"ctl_group468").setLeft("9.583333333333334em").setTop("9.666666666666666em").setWidth("8.333333333333334em").setHeight("8.333333333333334em").setOverflow("hidden").setCaption("$RAD.custom_dlg.arrow.Length"));c.ctl_group468.append(xui.create("xui.UI.RadioBox").setHost(c,"ctl_length2").setDirtyMark(false).setItems([{id:"short",caption:"$RAD.custom_dlg.arrow.short"},{id:"midium",caption:"$RAD.custom_dlg.arrow.midium"},{id:"long",caption:"$RAD.custom_dlg.arrow.long"}]).setDock("fill").setLeft("0em").setTop("0em").setWidth("5.625em").setHeight("5em").setValue("short").afterUIValueSet("_ctl_afteruivalueset").setCustomStyle({ITEM:"display:block"}));c.ctl_block63.append(xui.create("xui.UI.Block").setHost(c,"ctl_block64").setLeft("5em").setTop("0.3333333333333333em").setWidth("30.833333333333332em").setHeight("2.25em").setBorderType("flat").setBackground("#fff").setOverflow("hidden"));c.ctl_block64.append(xui.create("xui.UI.SVGPaper").setHost(c,"ctl_svgpaper80").setLeft("0.625em").setTop("0.125em").setWidth("28.5em").setHeight("1.75em"));c.ctl_svgpaper80.append(xui.create("xui.svg.path").setHost(c,"ctl_line").setSvgTag("Shapes:Line").setAttr({path:"M,17,10L,327,10",stroke:"#bf852f","stroke-width":3}));return b},_getValues:function(){var d=this,b=d.ctl_type.getUIValue(),e=d.ctl_width.getUIValue(),g=d.ctl_length.getUIValue(),a=d.ctl_type2.getUIValue(),c=d.ctl_width2.getUIValue(),f=d.ctl_length2.getUIValue();return[b+"-"+e+"-"+g,a+"-"+c+"-"+f]},_ctl_afteruivalueset:function(c){var b=this,a=b._getValues();b.ctl_line.setAttr("KEY",{"arrow-start":a[0],"arrow-end":a[1]},false);b.fireEvent("onChange",[a])},init:function(d,f,b){var g=this,a=b.grid,l;xui.merge(g.properties,b,"all");l=a.getCellbyRowCol("arrow-start","value");if(l){var c=l.value&&l.value.split("-");g.ctl_type.setValue(c[0]||"none",true);g.ctl_width.setValue(c[1]||"narrow",true);g.ctl_length.setValue(c[2]||"short",true)}l=a.getCellbyRowCol("arrow-end","value");if(l){var e=l.value&&l.value.split("-");g.ctl_type2.setValue(e[0]||"none",true);g.ctl_width2.setValue(e[1]||"narrow",true);g.ctl_length2.setValue(e[2]||"short",true)}var j=g._getValues();g.ctl_line.setAttr("KEY",{"arrow-start":j[0],"arrow-end":j[1]},false)},_mainPane_beforeclose:function(a){a.boxing().hide();return false}}});xui.Class("RAD.CustomBorder","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"mainPane").setLeft("0.8333333333333334em").setTop("0.8333333333333334em").setWidth("40em").setHeight("30.833333333333332em").setCaption("$(RAD.custom_dlg.borderdlg.Custom padding, margin and border)").setMinBtn(false).setMaxBtn(false).setRestoreBtn(false).setOverflow("hidden"));c.mainPane.append(xui.create("xui.UI.Div").setHost(c,"xui_ui_div46").setLeft("28.25em").setTop("0.9166666666666666em").setHeight("2.5em").setCustomStyle({KEY:{"background-color":"#E9967A"}}));c.xui_ui_div46.append(xui.create("xui.UI.Span").setHost(c,"xui_ui_span1").setLeft("3.25em").setTop("0.6666666666666666em").setWidth("3.6666666666666665em").setHeight("1.5833333333333333em").setHtml("$(RAD.custom_dlg.borderdlg.Margin)"));c.mainPane.append(xui.create("xui.UI.Div").setHost(c,"xui_ui_div48").setLeft("28.25em").setTop("3.4166666666666665em").setHeight("2.5em").setCustomStyle({KEY:{"background-color":"#00FF00"}}));c.xui_ui_div48.append(xui.create("xui.UI.Span").setHost(c,"xui_ui_span92").setLeft("3.25em").setTop("0.6666666666666666em").setWidth("3.6666666666666665em").setHeight("1.5833333333333333em").setHtml("$(RAD.custom_dlg.borderdlg.Border)"));c.mainPane.append(xui.create("xui.UI.Div").setHost(c,"xui_ui_div47").setLeft("28.25em").setTop("5.916666666666667em").setHeight("2.5em").setCustomStyle({KEY:{"background-color":"#FFA07A"}}));c.xui_ui_div47.append(xui.create("xui.UI.Span").setHost(c,"xui_ui_span91").setLeft("3.25em").setTop("0.6666666666666666em").setWidth("3.6666666666666665em").setHeight("1.5833333333333333em").setHtml("$(RAD.custom_dlg.borderdlg.Padding)"));c.mainPane.append(xui.create("xui.UI.Div").setHost(c,"xui_ui_div_realo").setLeft("28.333333333333332em").setTop("10.083333333333334em").setWidth("auto").setHeight("auto").setCustomStyle({KEY:{background:"url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1IiBoZWlnaHQ9IjUiPgo8cmVjdCB3aWR0aD0iNSIgaGVpZ2h0PSI1IiBmaWxsPSIjZmZmIj48L3JlY3Q+CjxyZWN0IHdpZHRoPSIxIiBoZWlnaHQ9IjEiIGZpbGw9IiNjY2MiPjwvcmVjdD4KPC9zdmc+)"}}));c.xui_ui_div_realo.append(xui.create("xui.UI.Div").setHost(c,"xui_ui_div_real").setWidth("auto").setHeight("auto").setPosition("relative").setCustomStyle({KEY:{background:"url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNiIgaGVpZ2h0PSI2Ij4KPHJlY3Qgd2lkdGg9IjYiIGhlaWdodD0iNiIgZmlsbD0iI2VlZSI+PC9yZWN0Pgo8ZyBpZD0iYyI+CjxyZWN0IHdpZHRoPSIzIiBoZWlnaHQ9IjMiIGZpbGw9IiNlNmU2ZTYiPjwvcmVjdD4KPHJlY3QgeT0iMSIgd2lkdGg9IjMiIGhlaWdodD0iMiIgZmlsbD0iI2Q4ZDhkOCI+PC9yZWN0Pgo8L2c+Cjx1c2UgeGxpbms6aHJlZj0iI2MiIHg9IjMiIHk9IjMiPjwvdXNlPgo8L3N2Zz4=)"}}));c.xui_ui_div_real.append(xui.create("xui.UI.Div").setHost(c,"xui_ui_div_reali").setWidth("4em").setHeight("4em").setPosition("relative").setCustomStyle({KEY:{background:"url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCI+CjxyZWN0IHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0iI2ZmZiI+PC9yZWN0Pgo8cmVjdCB3aWR0aD0iMTAiIGhlaWdodD0iMTAiIGZpbGw9IiNjY2MiPjwvcmVjdD4KPHJlY3QgeD0iMTAiIHk9IjEwIiB3aWR0aD0iMTAiIGhlaWdodD0iMTAiIGZpbGw9IiNjY2MiPjwvcmVjdD4KPC9zdmc+)"}}));c.mainPane.append(xui.create("xui.UI.Button").setHost(c,"xui_ui_button10").setLeft("28.333333333333332em").setTop("23.33333333333333em").setWidth("10em").setHeight("2.5em").setCaption("$(RAD.Clear)").onClick("_xui_ui_button10_onclick"));c.mainPane.append(xui.create("xui.UI.Block").setHost(c,"xui_ui_block27").setLeft("0.08333333333333333em").setTop("0em").setWidth("26.5em").setHeight("26.666666666666668em").setBorderType("inset").setOverflow("hidden"));c.xui_ui_block27.append(xui.create("xui.UI.SVGPaper").setHost(c,"xui_ui_svgpaper1").setLeft("-0.08333333333333333em").setTop("0em").setWidth("26.666666666666668em").setHeight("26.666666666666668em").setCustomStyle({KEY:"background-color:transparent"}));c.xui_ui_svgpaper1.append(xui.create("xui.UI.Div").setHost(c,"xui_ui_div1").setLeft("0.8333333333333334em").setTop("0.8333333333333334em").setWidth("auto").setHeight("auto").setCustomStyle({KEY:{"background-color":"#E9967A"}}));c.xui_ui_div1.append(xui.create("xui.UI.Div").setHost(c,"xui_ui_div_demo").setWidth("auto").setHeight("auto").setPosition("relative").setCustomStyle({KEY:{"background-color":"#FFA07A",border:"solid #00ff00 30px",padding:"30px",margin:"30px"}}));c.xui_ui_div_demo.append(xui.create("xui.UI.Div").setHost(c,"xui_ui_div3").setPosition("relative").setCustomClass({KEY:"xui-uibar"}));c.xui_ui_block27.append(xui.create("xui.UI.Div").setHost(c,"xui_ui_block22").setLeft("0em").setTop("0em").setWidth("14.083333333333334em").setHeight("26.666666666666668em").setCustomStyle({KEY:{opacity:0.9}}));c.xui_ui_block22.append(xui.create("xui.UI.Span").setHost(c,"xui_ui_span110").setLeft("11.416666666666666em").setTop("12.583333333333334em").setWidth("3.3333333333333335em").setHtml("Matrix"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_radius_tl").setDirtyMark(false).setRotate(225).setLeft("0.75em").setTop("2.4166666666666665em").setWidth("5em").setHeight("1.8333333333333333em").setLabelSize("9.166666666666666em").setLabelPos("none").setLabelGap("0.4166666666666667em").setLabelCaption("$RAD.custom_dlg.borderdlg.Radius").setType("counter").setShowMode("compact").setPrecision(0).setIncrement(1).setMin(0).setMax(500).onChange("_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_radius_tr").setDirtyMark(false).setRotate(315).setLeft("20.75em").setTop("2.4166666666666665em").setWidth("5em").setLabelSize("9.166666666666666em").setLabelPos("none").setLabelGap("0.4166666666666667em").setLabelCaption("$RAD.custom_dlg.borderdlg.Radius").setType("counter").setShowMode("compact").setPrecision(0).setIncrement(1).setMin(0).setMax(500).onChange("_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_margin_t").setDirtyMark(false).setLeft("10.5em").setTop("1.1666666666666667em").setWidth("5em").setLabelSize("8em").setLabelPos("none").setType("counter").setShowMode("compact").setLabelCaption("$RAD.custom_dlg.borderdlg.Margin").setPrecision(0).setIncrement(1).setMin(-500).setMax(500).onChange("_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_border_t_s").setDirtyMark(false).setLeft("5.833333333333333em").setTop("3.6666666666666665em").setWidth("4.5em").setLabelSize("6.666666666666667em").setLabelPos("none").setLabelGap("0.4166666666666667em").setLabelCaption("$RAD.custom_dlg.borderdlg.Style").setLabelHAlign("").setHAlign("center").setType("listbox").setShowMode("compact").setValue("none").onChange("_border_t_s_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_border_t_c").setDirtyMark(false).setDisabled(true).setLeft("15.583333333333334em").setTop("3.6666666666666665em").setWidth("5em").setLabelSize("6.666666666666667em").setLabelPos("none").setLabelGap("0.4166666666666667em").setLabelCaption("$RAD.custom_dlg.borderdlg.Color").setType("color").setShowMode("compact").onChange("_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_border_t_w").setDirtyMark(false).setDisabled(true).setLeft("10.5em").setTop("3.6666666666666665em").setWidth("5em").setLabelSize("6.666666666666667em").setLabelPos("none").setLabelGap("0.4166666666666667em").setLabelCaption("$RAD.custom_dlg.borderdlg.Width").setType("counter").setShowMode("compact").setPrecision(0).setIncrement(1).setMin(0).setMax(500).onChange("_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_padding_t").setDirtyMark(false).setLeft("10.5em").setTop("6.166666666666667em").setLabelCaption("$RAD.custom_dlg.borderdlg.Padding").setWidth("5em").setLabelSize("8em").setLabelPos("none").setType("counter").setShowMode("compact").setPrecision(0).setIncrement(1).setMin(0).setMax(500).onChange("_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_padding_r").setDirtyMark(false).setRotate(90).setLeft("17em").setTop("12.166666666666666em").setLabelCaption("$RAD.custom_dlg.borderdlg.Padding").setWidth("5em").setLabelSize("8em").setLabelPos("none").setType("counter").setShowMode("compact").setPrecision(0).setIncrement(1).setMin(0).setMax(500).onChange("_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_padding_b").setDirtyMark(false).setLeft("10.333333333333334em").setTop("18.666666666666668em").setLabelCaption("$RAD.custom_dlg.borderdlg.Padding").setWidth("5em").setLabelSize("8em").setLabelPos("none").setType("counter").setShowMode("compact").setPrecision(0).setIncrement(1).setMin(0).setMax(500).onChange("_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_border_b_s").setDirtyMark(false).setLeft("5.75em").setTop("21.166666666666668em").setWidth("4.5em").setLabelSize("6.666666666666667em").setLabelPos("none").setLabelGap("0.4166666666666667em").setLabelCaption("$RAD.custom_dlg.borderdlg.Style").setHAlign("center").setType("listbox").setShowMode("compact").setValue("none").onChange("_border_b_s_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_margin_b").setDirtyMark(false).setLeft("10.416666666666666em").setTop("23.583333333333332em").setLabelCaption("$RAD.custom_dlg.borderdlg.Margin").setWidth("5em").setLabelSize("8em").setLabelPos("none").setType("counter").setShowMode("compact").setPrecision(0).setIncrement(1).setMin(-500).setMax(500).onChange("_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_border_r_s").setDirtyMark(false).setRotate(90).setLeft("19.75em").setTop("7.333333333333333em").setWidth("4.5em").setLabelSize("6.666666666666667em").setLabelPos("none").setLabelGap("0.4166666666666667em").setLabelCaption("$RAD.custom_dlg.borderdlg.Style").setHAlign("center").setType("listbox").setShowMode("compact").setValue("none").onChange("_border_r_s_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_border_r_c").setDirtyMark(false).setDisabled(true).setRotate(90).setLeft("19.5em").setTop("17.083333333333332em").setWidth("5em").setLabelSize("6.666666666666667em").setLabelPos("none").setLabelGap("0.4166666666666667em").setLabelCaption("$RAD.custom_dlg.borderdlg.Color").setType("color").setShowMode("compact").onChange("_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_border_r_w").setDirtyMark(false).setDisabled(true).setRotate(90).setLeft("19.5em").setTop("12.083333333333334em").setWidth("5em").setLabelSize("6.666666666666667em").setLabelPos("none").setLabelGap("0.4166666666666667em").setLabelCaption("$RAD.custom_dlg.borderdlg.Width").setType("counter").setShowMode("compact").setPrecision(0).setIncrement(1).setMin(0).setMax(500).onChange("_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_radius_br").setDirtyMark(false).setRotate(45).setLeft("20.75em").setTop("22.416666666666668em").setWidth("5em").setLabelSize("9.166666666666666em").setLabelPos("none").setLabelGap("0.4166666666666667em").setLabelCaption("$RAD.custom_dlg.borderdlg.Radius").setType("counter").setShowMode("compact").setPrecision(0).setIncrement(1).setMin(0).setMax(500).onChange("_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_radius_bl").setDirtyMark(false).setRotate(135).setLeft("0.75em").setTop("22.416666666666668em").setWidth("5em").setLabelSize("9.166666666666666em").setLabelPos("none").setLabelGap("0.4166666666666667em").setLabelCaption("$RAD.custom_dlg.borderdlg.Radius").setType("counter").setShowMode("compact").setPrecision(0).setIncrement(1).setMin(0).setMax(500).onChange("_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_margin_r").setDirtyMark(false).setRotate(90).setLeft("22em").setTop("12.083333333333334em").setLabelCaption("$RAD.custom_dlg.borderdlg.Margin").setWidth("5em").setLabelSize("8em").setLabelPos("none").setType("counter").setShowMode("compact").setPrecision(0).setIncrement(1).setMin(-500).setMax(500).onChange("_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_padding_l").setDirtyMark(false).setRotate(90).setLeft("4.5em").setTop("12.166666666666666em").setLabelCaption("$RAD.custom_dlg.borderdlg.Padding").setWidth("5em").setLabelSize("8em").setLabelPos("none").setLabelGap("auto").setType("counter").setShowMode("compact").setPrecision(0).setIncrement(1).setMin(0).setMax(500).onChange("_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_border_l_c").setDirtyMark(false).setDisabled(true).setRotate(90).setLeft("2em").setTop("17.25em").setWidth("5em").setLabelSize("6.666666666666667em").setLabelPos("none").setLabelGap("0.4166666666666667em").setLabelCaption("$RAD.custom_dlg.borderdlg.Color").setType("color").setShowMode("compact").onChange("_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_border_l_w").setDirtyMark(false).setDisabled(true).setRotate(90).setLeft("2em").setTop("12.25em").setWidth("5em").setLabelSize("6.666666666666667em").setLabelPos("none").setLabelGap("0.4166666666666667em").setLabelCaption("$RAD.custom_dlg.borderdlg.Width").setType("counter").setShowMode("compact").setPrecision(0).setIncrement(1).setMin(0).setMax(500).onChange("_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_margin_l").setDirtyMark(false).setRotate(90).setLeft("-0.5em").setTop("12.083333333333334em").setLabelCaption("$RAD.custom_dlg.borderdlg.Margin").setWidth("5em").setLabelSize("8em").setLabelPos("none").setType("counter").setShowMode("compact").setPrecision(0).setIncrement(1).setMin(-500).setMax(500).onChange("_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_border_l_s").setDirtyMark(false).setRotate(90).setLeft("2.25em").setTop("7.416666666666667em").setWidth("4.5em").setLabelSize("6.666666666666667em").setLabelPos("none").setLabelGap("0.4166666666666667em").setLabelCaption("$RAD.custom_dlg.borderdlg.Style").setHAlign("center").setType("listbox").setShowMode("compact").setValue("none").onChange("_border_l_s_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_border_b_c").setDirtyMark(false).setDisabled(true).setLeft("15.5em").setTop("21.166666666666668em").setWidth("5em").setLabelSize("6.666666666666667em").setLabelPos("none").setLabelGap("0.4166666666666667em").setLabelCaption("$RAD.custom_dlg.borderdlg.Color").setType("color").setShowMode("compact").onChange("_change"));c.xui_ui_block22.append(xui.create("xui.UI.ComboInput").setHost(c,"_border_b_w").setDirtyMark(false).setDisabled(true).setLeft("10.416666666666666em").setTop("21.166666666666668em").setWidth("5em").setLabelSize("6.666666666666667em").setLabelPos("none").setLabelGap("0.4166666666666667em").setLabelCaption("$RAD.custom_dlg.borderdlg.Width").setType("counter").setShowMode("compact").setPrecision(0).setIncrement(1).setMin(0).setMax(500).onChange("_change"));return b},init:function(d,e,j,c){var b=this,g,a;if(c==2){a=function(){return xui.CSS.$px.apply(xui.CSS,arguments)||""};g=xui(xui.$getGhostDiv());g.css({borderLeft:e.border&&e.border.left||0,borderTop:e.border&&e.border.top||0,borderRight:e.border&&e.border.right||0,borderBottom:e.border&&e.border.bottom||0,borderRadius:e["border-radius"]||0,margin:e.margin||0,padding:e.padding||0})}else{a=function(){return d.$px.apply(d,arguments)||""};g=d.getSubNode(e)}var f=function(l){l=l.replace(/(?:rgb\((\d+), ?(\d+), ?(\d+)\)([^,]*))+/g,function(n,m,r,q,o){return"#"+xui.UI.ColorPicker.rgb2hex(m,r,q)+o});l=l.replace(/(?:rgba\((\d+), ?(\d+), ?(\d+), ?([.\d]+)\)([^,]*))+/g,function(n,m,s,r,q,o){opacity=parseFloat(q)||1;return"#"+xui.UI.ColorPicker.rgb2hex(m,s,r)+o});return l};b._ignoreChange=1;b._border_t_s.setUIValue(g.css("borderTopStyle")||"none",true);b._border_t_w.resetValue(a(g.css("borderTopWidth")));b._border_t_c.resetValue(f(g.css("borderTopColor")));b._border_r_s.setUIValue(g.css("borderRightStyle")||"none",true);b._border_r_w.resetValue(a(g.css("borderRightWidth")));b._border_r_c.resetValue(f(g.css("borderRightColor")));b._border_b_s.setUIValue(g.css("borderBottomStyle")||"none",true);b._border_b_w.resetValue(a(g.css("borderBottomWidth")));b._border_b_c.resetValue(f(g.css("borderBottomColor")));b._border_l_s.setUIValue(g.css("borderLeftStyle")||"none",true);b._border_l_w.resetValue(a(g.css("borderLeftWidth")));b._border_l_c.resetValue(f(g.css("borderLeftColor")));b._padding_t.resetValue(a(g.css("paddingTop")));b._padding_r.resetValue(a(g.css("paddingRight")));b._padding_b.resetValue(a(g.css("paddingBottom")));b._padding_l.resetValue(a(g.css("paddingLeft")));b._margin_t.resetValue(a(g.css("marginTop")));b._margin_r.resetValue(a(g.css("marginRight")));b._margin_b.resetValue(a(g.css("marginBottom")));b._margin_l.resetValue(a(g.css("marginLeft")));b._radius_tl.resetValue(a(g.css("borderTopLeftRadius")));b._radius_tr.resetValue(a(g.css("borderTopRightRadius")));b._radius_bl.resetValue(a(g.css("borderBottomLeftRadius")));b._radius_br.resetValue(a(g.css("borderBottomRightRadius")));b._ignoreChange=0;b._change(false);g=null},events:{onReady:"_page_onready"},_page_onready:function(b,d){var c=this,a=[{id:"none",caption:"$RAD.custom_dlg.borderdlg.none"},{id:"solid",caption:"$RAD.custom_dlg.borderdlg.solid"},{id:"dashed",caption:"$RAD.custom_dlg.borderdlg.dashed"},{id:"dotted",caption:"$RAD.custom_dlg.borderdlg.dotted"},{id:"double",caption:"$RAD.custom_dlg.borderdlg.double"}];c._border_l_s.setItems(a);c._border_r_s.setItems(a);c._border_t_s.setItems(a);c._border_b_s.setItems(a)},_border_s_change:function(c,d){var f=this,a=c!="none",e;(e=f["_border_"+d+"_w"]).setDisabled(!a);if(a){if(!e.getUIValue()){e.setValue(1)}}else{e.resetValue(null)}(e=f["_border_"+d+"_c"]).setDisabled(!a);if(a){if(!e.getUIValue()){e.setValue("#000000")}}else{e.resetValue(null)}f._change()},_border_t_s_change:function(b,c,a){this._border_s_change(a,"t")},_border_b_s_change:function(b,c,a){this._border_s_change(a,"b")},_border_l_s_change:function(b,c,a){this._border_s_change(a,"l")},_border_r_s_change:function(b,c,a){this._border_s_change(a,"r")},_change:function(a){var b=this;if(b._ignoreChange){return}xui.resetRun("bs:"+b.$xid,function(){var m="",e=m,c=m,r=m,q=m,d=m,o=m,n=m,l,j,g,f;l=b._border_t_s.getUIValue();if(l!="none"){r=l+" "+(b._border_t_w.getUIValue()||0)+"px "+(b._border_t_c.getUIValue()||"")}j=b._border_r_s.getUIValue();if(j!="none"){c=j+" "+(b._border_r_w.getUIValue()||0)+"px "+(b._border_r_c.getUIValue()||"")}g=b._border_b_s.getUIValue();if(g!="none"){q=g+" "+(b._border_b_w.getUIValue()||0)+"px "+(b._border_b_c.getUIValue()||"")}f=b._border_l_s.getUIValue();if(f!="none"){e=f+" "+(b._border_l_w.getUIValue()||0)+"px "+(b._border_l_c.getUIValue()||"")}l=b._padding_t.getUIValue()||0;j=b._padding_r.getUIValue()||0;g=b._padding_b.getUIValue()||0;f=b._padding_l.getUIValue()||0;if(l||j||g||f){o=l+"px "+j+"px "+g+"px "+f+"px"}l=b._margin_t.getUIValue()||0;j=b._margin_r.getUIValue()||0;g=b._margin_b.getUIValue()||0;f=b._margin_l.getUIValue()||0;if(l||j||g||f){d=l+"px "+j+"px "+g+"px "+f+"px"}l=parseInt(b._radius_tl.getUIValue(),10)||0;j=parseInt(b._radius_tr.getUIValue(),10)||0;g=parseInt(b._radius_br.getUIValue(),10)||0;f=parseInt(b._radius_bl.getUIValue(),10)||0;if(l||j||g||f){n=l+"px "+j+"px "+g+"px "+f+"px"}if(a!==false){b.fireEvent("onChange",[{border:{left:e,top:r,right:c,bottom:q},margin:d,padding:o,"border-radius":n}])}b._preview(e,c,r,q,d,o,n)})},_preview:function(c,j,e,b,f,g,a){var d=this;d.xui_ui_div_real.getRoot().css({borderLeft:c||0,borderTop:e||0,borderRight:j||0,borderBottom:b||0,margin:f||0,padding:g||0,borderRadius:a||0})},_xui_ui_button10_onclick:function(b,d,f,c){var a=this;a.init(null,{},null,2);a._change(true)}}});xui.Class("RAD.GridBorder","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Block").setHost(c,"mainPane").setLeft("0.8333333333333334em").setTop("0.8333333333333334em").setWidth("19.166666666666668em").setHeight("12em").setShadow(true).setBorderType("flat").setOverflow("hidden"));c.mainPane.append(xui.create("xui.UI.ComboInput").setHost(c,"b_style").setDirtyMark(false).setLeft("0.8333333333333334em").setTop("0.8333333333333334em").setWidth("11.666666666666666em").setDisplay("none").setLabelSize("5em").setLabelGap("auto").setLabelCaption("$RAD.custom_dlg.borderdlg.Style").setLabelHAlign("").setHAlign("center").setType("listbox").setItems([{id:"solid",caption:"$RAD.custom_dlg.borderdlg.solid"},{id:"dashed",caption:"$RAD.custom_dlg.borderdlg.dashed"},{id:"dotted",caption:"$RAD.custom_dlg.borderdlg.dotted"},{id:"double",caption:"$RAD.custom_dlg.borderdlg.double"}]).setShowMode("compact").setValue("solid").afterPopShow("_afterPop"));c.mainPane.append(xui.create("xui.UI.ComboInput").setHost(c,"b_bold").setDirtyMark(false).setLeft("0.8333333333333334em").setTop("4.166666666666667em").setWidth("11.666666666666666em").setDisplay("none").setLabelSize("5em").setLabelGap("auto").setLabelCaption("$RAD.custom_dlg.borderdlg.Width").setLabelHAlign("left").setType("counter").setShowMode("compact").setPrecision(0).setIncrement(1).setMin(1).setMax(10).setValue(1));c.mainPane.append(xui.create("xui.UI.ComboInput").setHost(c,"b_color").setDirtyMark(false).setLeft("1.6666666666666667em").setTop("0.5em").setWidth("15.833333333333334em").setLabelSize("5em").setLabelGap("auto").setLabelCaption("$RAD.custom_dlg.borderdlg.Color").setLabelHAlign("left").setType("color").setShowMode("compact").setValue("#000000").afterPopShow("_afterPop"));c.mainPane.append(xui.create("xui.UI.Block").setHost(c,"xui_ui_block7").setLeft("0.8333333333333334em").setTop("2.8333333333333335em").setWidth("17.5em").setHeight("8.333333333333334em").setBorderType("flat"));c.xui_ui_block7.append(xui.create("xui.UI.HTMLButton").setHost(c,"btn_all").setClassName("xui-css-cyz").setLeft("0.8333333333333334em").setTop("0.5em").setWidth("3.25em").setHeight("3.25em").setCaption("all").onClick("_btn_all_onclick"));c.xui_ui_block7.append(xui.create("xui.UI.HTMLButton").setHost(c,"btn_inner").setClassName("xui-css-cyz").setLeft("9.166666666666666em").setTop("0.5em").setWidth("3.25em").setHeight("3.25em").setCaption("inner").onClick("_btn_inner_onclick"));c.xui_ui_block7.append(xui.create("xui.UI.HTMLButton").setHost(c,"btn_outer").setClassName("xui-css-cyz").setLeft("5em").setTop("0.5em").setWidth("3.25em").setHeight("3.25em").setCaption("outer").onClick("_btn_outer_onclick"));c.xui_ui_block7.append(xui.create("xui.UI.HTMLButton").setHost(c,"btn_none").setClassName("xui-css-cyz").setLeft("13.333333333333334em").setTop("0.5em").setWidth("3.25em").setHeight("3.25em").setCaption("none").onClick("_btn_none_onclick"));c.xui_ui_block7.append(xui.create("xui.UI.HTMLButton").setHost(c,"btn_left").setClassName("xui-css-cyz").setLeft("0.8333333333333334em").setTop("4.416666666666667em").setWidth("3.25em").setHeight("3.25em").setCaption("left").onClick("_btn_left_onclick"));c.xui_ui_block7.append(xui.create("xui.UI.HTMLButton").setHost(c,"btn_top").setClassName("xui-css-cyz").setLeft("9.166666666666666em").setTop("4.416666666666667em").setWidth("3.25em").setHeight("3.25em").setCaption("top").onClick("_btn_top_onclick"));c.xui_ui_block7.append(xui.create("xui.UI.HTMLButton").setHost(c,"btn_right").setClassName("xui-css-cyz").setLeft("5em").setTop("4.416666666666667em").setWidth("3.25em").setHeight("3.25em").setCaption("right").onClick("_btn_right_onclick"));c.xui_ui_block7.append(xui.create("xui.UI.HTMLButton").setHost(c,"btn_bottom").setClassName("xui-css-cyz").setLeft("13.333333333333334em").setTop("4.416666666666667em").setWidth("3.25em").setHeight("3.25em").setCaption("bottom").onClick("_btn_bottom_onclick"));a(xui.create("xui.UI.CSSBox").setHost(c,"xui_ui_cssbox1").setClassName("xui-css-cyz").setNormalStatus({color:"#222222","background-color":"#F4F5F5","background-image":"none","border-top":"none","border-right":"none","border-bottom":"none","border-left":"none","border-radius":"6px","text-shadow":"0 -1px 0 #ffffff","box-shadow":"none",cursor:"pointer"}));return b},events:{onReady:"_page_onready"},_afterPop:function(b,a){a.$parentPopMenu=b.$parentPopMenu},_page_onready:function(a,b){this.fillBtns()},fillBtns:function(){var b=this,a=function(f,d,c,l,j,g){var n="width:1em;height:1em;",e=":solid 1px #000000;",m=":solid 1px #ccc;";l="border-left"+(l?e:m);j="border-right"+(j?e:m);g="border-right"+(g?e:m);f="border-top"+(f?e:m);d="border-bottom"+(d?e:m);c="border-bottom"+(c?e:m);return'<table style="border-collapse:collapse"><tbody><tr><td style="'+n+l+j+f+d+'"></td><td style="'+n+g+f+d+'"></td></tr><tr style=""><td style="'+n+l+j+c+'"></td><td style="'+n+g+c+'"></td></tr></tbody></table>'};b.btn_all.setCaption(a(1,1,1,1,1,1));b.btn_outer.setCaption(a(1,0,1,1,0,1));b.btn_inner.setCaption(a(0,1,0,0,1,0));b.btn_none.setCaption(a());b.btn_left.setCaption(a(0,0,0,1,0,0));b.btn_right.setCaption(a(0,0,0,0,0,1));b.btn_top.setCaption(a(1));b.btn_bottom.setCaption(a(0,0,1,0,0,0))},_btn_all_onclick:function(a,b,c){this.selectBorder("all")},_btn_outer_onclick:function(a,b,c){this.selectBorder("outer")},_btn_inner_onclick:function(a,b,c){this.selectBorder("inner")},_btn_none_onclick:function(a,b,c){this.selectBorder("none")},_btn_left_onclick:function(a,b,c){this.selectBorder("left")},_btn_right_onclick:function(a,b,c){this.selectBorder("right")},_btn_top_onclick:function(a,b,c){this.selectBorder("top")},_btn_bottom_onclick:function(a,b,c){this.selectBorder("bottom")},selectBorder:function(e){var d=this,c=d.b_style.getUIValue(),b=d.b_bold.getUIValue(),a=d.b_color.getUIValue();d.fireEvent("onApplyBorder",[e,c,b,a],d)}}});xui.Class("RAD.CustomTextShadow","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"mainPane").setLeft("5.833333333333333em").setTop("3.1666666666666665em").setWidth("20em").setHeight("15.166666666666666em").setShadow(false).setResizer(false).setCaption("$(RAD.custom_dlg.shadow.Custom Text Shadow)").setMinBtn(false).setMaxBtn(false).beforeClose("_ctl_panel4_beforeclose"));c.mainPane.append(xui.create("xui.UI.Block").setHost(c,"bg").setDock("fill").setBorderType("inset"));c.bg.append(xui.create("xui.UI.ComboInput").setHost(c,"sd_clr").setDirtyMark(false).setLeft("1.5833333333333333em").setTop("0.8333333333333334em").setWidth("15.833333333333334em").setLabelSize("108px").setLabelCaption("$(RAD.custom_dlg.shadow.Shadow Color)").setType("color").onChange("_changed"));c.bg.append(xui.create("xui.UI.ComboInput").setHost(c,"sd_hl").setDirtyMark(false).setLeft("1.5833333333333333em").setTop("3.5em").setWidth("15.833333333333334em").setLabelSize("108px").setLabelCaption("$(RAD.custom_dlg.shadow.Horizontal Length)").setType("counter").setUnit("px").setPrecision(0).setIncrement(1).setMin(0).setMax(100).onChange("_changed"));c.bg.append(xui.create("xui.UI.ComboInput").setHost(c,"sd_vl").setDirtyMark(false).setLeft("1.5833333333333333em").setTop("6.416666666666667em").setWidth("15.833333333333334em").setLabelSize("108px").setLabelCaption("$(RAD.custom_dlg.shadow.Vertical Length)").setType("counter").setUnit("px").setPrecision(0).setIncrement(1).setMin(0).setMax(100).onChange("_changed"));c.bg.append(xui.create("xui.UI.ComboInput").setHost(c,"sd_br").setDirtyMark(false).setLeft("1.5833333333333333em").setTop("9.083333333333334em").setWidth("15.833333333333334em").setLabelSize("108px").setLabelCaption("$(RAD.custom_dlg.shadow.Blur Radius)").setType("counter").setUnit("px").setPrecision(0).setIncrement(1).setMin(0).setMax(100).onChange("_changed"));return b},_getValues:function(){var a=this;return{hl:parseInt(a.sd_hl.getValue()),vl:parseInt(a.sd_vl.getValue()),br:a.sd_br.getValue(),clr:a.sd_clr.getValue()}},_changed:function(a){xui.resetRun("textShadow",this.setBR,0,null,this)},setBR:function(){var b=this._getValues(),a;if(!(b.clr||parseInt(b.hl)||parseInt(b.vl)||parseInt(b.br))){a=""}else{a=b.hl+"px "+b.vl+"px "+b.br+"px "+b.clr}this.fireEvent("onChange",[a])},init:function(c,f,a,j){var l=this,b,d,n,o,g=1;xui.merge(l.properties,a,"all");var m=j==2?f:xui.get(c.CS,[f,"text-shadow"]);if(m){m=m.replace(/(?:rgb\((\d+), ?(\d+), ?(\d+)\)([^,]*))+/g,function(r,q,w,u,s){return"#"+xui.UI.ColorPicker.rgb2hex(q,w,u)+s});m=m.replace(/(?:rgba\((\d+), ?(\d+), ?(\d+), ?([.\d]+)\)([^,]*))+/g,function(r,q,x,w,u,s){g=parseFloat(u)||1;return"#"+xui.UI.ColorPicker.rgb2hex(q,x,w)+s});var e=/([\w]*)?\s*([-\.\d]+)(px)?\s*([-\.\d]+)(px)?\s*([-\.\d]+)(px)?\s*(\S*)?\s*([\w]*)?/.exec(m);if(e&&e.length){b=parseFloat(e[2]);d=parseFloat(e[4]);n=parseFloat(e[6]);o=e[1]||e[8]}}if(!o){b=d=n=0;o=""}l.sd_hl.setValue(b||0,true);l.sd_vl.setValue(d||0,true);l.sd_br.setValue(n||0,true);l.sd_clr.setValue(o||0,true)},_ctl_panel4_beforeclose:function(a){a.boxing().hide();return false}}});xui.Class("RAD.CustomEffects","xui.Module",{Instance:{customAppend:function(){var a=this,b=a.properties;a.setTargetProfile(b.targetProfile);a.dialog.showModal();return true},setTargetProfile:function(b){var a=this,e=b.properties,c=e.showEffects,d=e.hideEffects;a._resetEffects(c,"show");a._resetEffects(d,"hide")},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Gallery").setHost(c,"gallery").setShowEffects("Blur").setLeft("0em").setTop("0em").setWidth(430).setHeight(256).setSelMode("none").setItemWidth(84).setItemHeight(84).setImgWidth(80).setImgHeight(80).onItemSelected("_ctl_gallery_onitemselected").setCustomStyle({ITEMS:{"background-color":"#FFFFFF"}}));a(xui.create("xui.UI.Dialog").setHost(c,"dialog").setLeft("9.875em").setTop("1.75em").setWidth("33.916666666666664em").setHeight("23.416666666666668em").setCaption("$(RAD.designer.effects.Custom Effects)").setMinBtn(false).setMaxBtn(false).setRestoreBtn(false).setOverflow("hidden").beforeClose("_ctl_dialog_beforeclose"));c.dialog.append(xui.create("xui.UI.Block").setHost(c,"ctl_block192").setDock("fill").setDockMargin({left:0,top:0,right:0,bottom:34}).setBorderType("inset").setOverflow("hidden"));c.ctl_block192.append(xui.create("xui.UI.TreeGrid").setHost(c,"tg").setDirtyMark(false).setEditable(true).setGridHandlerCaption("$RAD.designer.effects.Attributes").setRowHandlerWidth("7.5em").setColSortable(false).setHeader([{id:"show",caption:"$(RAD.designer.effects.Show Effects)",width:"11.666666666666666em",type:"input"},{id:"hide",caption:"$(RAD.designer.effects.Hide Effects)",width:"11.666666666666666em",type:"input"}]).setActiveMode("none").setTreeMode("none").setValue(",").afterCellUpdated("_tg_aftercellupdated"));c.dialog.append(xui.create("xui.UI.Button").setHost(c,"ctl_button15").setLeft("18.25em").setTop("17.75em").setWidth("6.666666666666667em").setImageClass("spafont spa-icon-cancel").setCaption("$RAD.cancel").onClick("_btncancel_onclick"));c.dialog.append(xui.create("xui.UI.Button").setHost(c,"ctl_button16").setLeft("25.75em").setTop("17.75em").setWidth("6.666666666666667em").setImageClass("spafont spa-icon-ok").setCaption("$RAD.ok").onClick("_btnok_onclick"));c.dialog.append(xui.create("xui.UI.Button").setHost(c,"btn_prev").setTag("show").setLeft("0.375em").setTop("17.75em").setWidth("7.5em").setHeight("2.1666666666666665em").setZIndex(1003).setCaption("$(RAD.designer.effects.Preview Show)").onClick("_ctl_preview_onclick"));c.dialog.append(xui.create("xui.UI.Button").setHost(c,"ctl_next").setTag("hide").setLeft("8.333333333333334em").setTop("17.75em").setWidth("7.5em").setHeight("2.1666666666666665em").setZIndex(1003).setCaption("$(RAD.designer.effects.Preview Hide)").onClick("_ctl_preview_onclick"));a(xui.create("xui.UI.List").setHost(c,"ctl_list").setDirtyMark(false).setLeft("0.5em").setTop("13.625em").setWidth("9.375em").setHeight("auto").onItemSelected("_ctl_list20_onitemselected"));return b},_sbutton3_onclick:function(f,j,l,g){var d=this,b={},c=d.list2.getUIValue(),a=function(){if(d.cWidth.getUIValue()){b.width=[50,250]}if(d.cHeight.getUIValue()){b.height=[50,250]}if(d.cLeft.getUIValue()){b.left=[100,300]}if(d.cTop.getUIValue()){b.top=[100,300]}if(d.cOpacity.getUIValue()){b.opacity=[1,0.2]}if(d.cBackgroundColor.getUIValue()){b.backgroundColor=["#ffffff","#000000"]}if(d.cScrollTop.getUIValue()){b.scrollTop=[0,100]}if(d.cRotate.getUIValue()){b.rotate=[0,360]}if(d.cscaleX.getUIValue()){b.scaleX=[1,5]}if(d.cscaleY.getUIValue()){b.scaleY=[1,5]}if(d.ctranslateX.getUIValue()){b.translateX=[0,200]}if(d.ctranslateY.getUIValue()){b.translateY=[0,200]}if(d.cskewX.getUIValue()){b.skewX=[0,180]}if(d.cskewY.getUIValue()){b.skewY=[0,180]}if(!xui.isEmpty(b)&&c){var m={},n=d.divDemo,e=n.getRoot();xui.each(b,function(r,q){if(r[1]){m[q]=[r[1],r[0]]}else{m[q]=r}});e.animate(b,null,function(){xui.asyRun(function(){d.divDemo.refresh()},1000)},300,0,c).start()}};a()},events:{onReady:"_com_onready",onRender:"_com_onrender"},_com_onready:function(b,f){var c=this,e=c.tg;var d=[];d.push({id:"predefined",caption:"$RAD.designer.effects.Predefined",rowStyle:"font-weight:bold;text-align:center",firstCellStyle:"font-weight:bold",type:"label",cells:[{},{}]});d.push({id:"type",caption:"$RAD.designer.effects.Type",type:"label",height:80,rowStyle:"bold;text-align:center",cells:[{},{}]});d.push({id:"duration",caption:"$RAD.designer.effects.Duration(ms)",type:"spin",numberTpl:"* ms",editorProperties:{min:100,max:5000,increment:100,precision:0},cells:[{},{}]});d.push({id:"opacity",caption:"$RAD.designer.effects.Opacity",type:"spin",value:100,numberTpl:"* %",editorProperties:{min:0,max:100,increment:10,precision:0},cells:[{},{}]});d.push({id:"rotate",caption:"$RAD.designer.effects.Rotate",type:"spin",numberTpl:"* deg",editorProperties:{min:0,max:360,increment:10,precision:0},cells:[{},{}]});d.push({id:"scaleX",caption:"$(RAD.custom_dlg.trans.Scale X)",type:"spin",precision:2,increment:0.1,cells:[{},{}]});d.push({id:"scaleY",caption:"$(RAD.custom_dlg.trans.Scale Y)",type:"spin",precision:2,increment:0.1,cells:[{},{}]});d.push({id:"translateX",caption:"$(RAD.custom_dlg.trans.Translate X)",type:"spin",numberTpl:"* %",editorProperties:{min:-500,max:500,increment:10,precision:0},cells:[{},{}]});d.push({id:"translateY",caption:"$(RAD.custom_dlg.trans.Translate Y)",type:"spin",numberTpl:"* %",editorProperties:{min:-500,max:500,increment:10,precision:0},cells:[{},{}]});d.push({id:"skewX",caption:"$(RAD.custom_dlg.trans.Skew X)",type:"spin",numberTpl:"* deg",editorProperties:{min:0,max:360,increment:5,precision:0},cells:[{},{}]});d.push({id:"skewY",caption:"$(RAD.custom_dlg.trans.Skew Y)",type:"spin",numberTpl:"* deg",editorProperties:{min:0,max:360,increment:5,precision:0},cells:[{},{}]});e.setRows(d);var a=[{id:"None",caption:"$(RAD.designer.effects.None)"}];xui.each(xui.Dom.$preDefinedEffects,function(j,g){a.push({id:g,caption:"$(RAD.designer.effects."+g+")",data:j})});c.ctl_list.setItems(a);a=[{id:"none",name:"none",imgWidth:60,imgHeight:60,image:xui.ini.img_blank}];xui.each(xui.Dom.$AnimateEffects,function(g,j){a.push({id:j,name:j,image:xui.getPath("/RAD/img/","animate/"+j+".gif")})});c.gallery.setItems(a)},_ctl_preview_onclick:function(c,g,a,l){var j=this,m=c.properties.tag,d=j.dialog.getRoot(),f=j._collectEffects();if(m=="show"){var b=f[0]||xui.Dom._getEffects(f[2],1);if(b){d.css("visibility","hidden");xui.asyRun(function(){d.css("visibility","visible");d.animate(b.endpoints,null,null,b.duration,null,b.type).start()},800)}}if(m=="hide"){var b=f[1]||xui.Dom._getEffects(f[3],0);if(b){d.animate(b.endpoints,null,function(){xui.asyRun(function(){d.css({transform:"",opacity:"1",visibility:"visible"})},800)},b.duration,null,b.type).start()}}},_collectEffects:function(){var c=this,e=c.tg,d=e.getRows("data"),f={endpoints:{}},g={endpoints:{}},b,a;xui.arr.each(d,function(m){var j=m.cells,n=j[0].value,l=j[1].value;switch(m.id){case"predefined":if(n!="None"){b=n}if(l!="None"){a=l}break;case"type":if(n){f.type=n}if(l){g.type=l}break;case"duration":if(n){f.duration=n}if(l){g.duration=l}break;case"opacity":if(n||n===0){f.endpoints.opacity=[parseFloat(n)/100,1]}if(l||l===0){g.endpoints.opacity=[1,parseFloat(l)/100]}break;case"rotate":if(n||n===0){f.endpoints.rotate=[parseFloat(n),0]}if(l||l===0){g.endpoints.rotate=[0,parseFloat(l)]}break;case"scaleX":if(n||n===0){f.endpoints.scaleX=[parseFloat(n),1]}if(l||l===0){g.endpoints.scaleX=[1,parseFloat(l)]}break;case"scaleY":if(n||n===0){f.endpoints.scaleY=[parseFloat(n),1]}if(l||l===0){g.endpoints.scaleY=[1,parseFloat(l)]}break;case"translateX":if(n||n===0){f.endpoints.translateX=[parseFloat(n)+"%","0%"]}if(l||l===0){g.endpoints.translateX=["0%",parseFloat(l)+"%"]}break;case"translateY":if(n||n===0){f.endpoints.translateY=[parseFloat(n)+"%","0%"]}if(l||l===0){g.endpoints.translateY=["0%",parseFloat(l)+"%"]}break;case"skewX":if(n||n===0){f.endpoints.skewX=[parseFloat(n),0]}if(l||l===0){g.endpoints.skewX=[0,parseFloat(l)]}break;case"skewY":if(n||n===0){f.endpoints.skewY=[parseFloat(n),0]}if(l||l===0){g.endpoints.skewY=[0,parseFloat(l)]}break}});if(!f.type||!f.duration||!f.endpoints||xui.isEmpty(f.endpoints)){f=null}if(!g.type||!g.duration||!g.endpoints||xui.isEmpty(g.endpoints)){g=null}return[f,g,b,a]},_ctl_dialog_beforeclose:function(a){a.boxing().hide();return false},_resetEffects:function(a,d){var l=this,c=l.tg,f=d=="show"?0:1,m={},e,b="None",j=function(n){return n||n===0?n:""};if(xui.isStr(a)){var g=xui.Dom.$preDefinedEffects[a];if(g){b=a;a=g[f]}}c.updateCellByRowCol("predefined",d,{value:b,caption:"$(RAD.designer.effects."+b+")"},false,false);e=a&&a.endpoints;c.updateCellByRowCol("type",d,{value:a&&a.type||""},false,true);c.updateCellByRowCol("duration",d,{value:j(a&&a.duration||"")});c.updateCellByRowCol("opacity",d,{value:j(e&&e.opacity&&parseInt(e.opacity[f]*100,10))});c.updateCellByRowCol("rotate",d,{value:j(e&&e.rotate&&e.rotate[f])});c.updateCellByRowCol("scaleX",d,{value:j(e&&e.scaleX&&e.scaleX[f])});c.updateCellByRowCol("scaleY",d,{value:j(e&&e.scaleY&&e.scaleY[f])});c.updateCellByRowCol("translateX",d,{value:j(e&&e.translateX&&e.translateX[f])});c.updateCellByRowCol("translateY",d,{value:j(e&&e.translateY&&e.translateY[f])});c.updateCellByRowCol("skewX",d,{value:j(e&&e.skewY&&e.skewY[f])});c.updateCellByRowCol("skewY",d,{value:j(e&&e.skewY&&e.skewY[f])})},_tg_aftercellupdated:function(c,g,l,d){if(!("value" in l)){return}var e=this,f=c.boxing(),a=e.tg,b=f.getColByCell(g),j=f.getRowbyCell(g);switch(j.id){case"predefined":e._resetEffects(l.value,b.id);break;case"type":a.getSubNodeInGrid("CELL","type",b.id).css("background",(g.value&&g.value!="none")?("url("+xui.getPath("/RAD/img/animate/",g.value+".gif")+") center center no-repeat "):"transparent");if(g.value=="none"){e._resetEffects({},b.id)}break;default:a.updateCellByRowCol("predefined",b.id,{value:"None",caption:"$(RAD.designer.effects.None)"},false,false)}},_btncancel_onclick:function(a,c,d,b){this.dialog.close()},_btnok_onclick:function(c,g,j,d){var b=this,l=b.properties,f=l.targetProfile,a=b._collectEffects();f.boxing().setShowEffects(a[2]||a[0]||"").setHideEffects(a[3]||a[1]||"");b.fireEvent("onDirty");b.fireEvent("onFinished");this.dialog.close()},_ctl_gallery_onitemselected:function(a,b){a.boxing().hide();this.tg.updateCellByRowCol("type",a.properties.tag,{value:b.id},false,true)},_ctl_list20_onitemselected:function(b,c,d,f,a){b.boxing().hide();this.tg.updateCellByRowCol("predefined",b.properties.tag,{value:c.id,caption:c.caption},false,true)},_com_onrender:function(a,b){a.tg.getSubNodeInGrid("CELL","type","show").hoverPop(a.gallery,"12",function(){a.gallery.setUIValue(null,true);a.gallery.setTag("show")},null,null,"$asdfa");a.tg.getSubNodeInGrid("CELL","type","hide").hoverPop(a.gallery,"12",function(){a.gallery.setUIValue(null,true);a.gallery.setTag("hide")},null,null,"$asdfa");a.tg.getSubNodeInGrid("CELL","predefined","show").hoverPop(a.ctl_list,"12",function(){a.ctl_list.setUIValue(null,true);a.ctl_list.setTag("show")},null,null,"$asdfb");a.tg.getSubNodeInGrid("CELL","predefined","hide").hoverPop(a.ctl_list,"12",function(){a.ctl_list.setUIValue(null,true);a.ctl_list.setTag("hide")},null,null,"$asdfb")}}});xui.Class("RAD.ActionsEditor","xui.Module",{Instance:{CAPMAP:{actiongroup:{"none:none":"None","other:callback":"Function Calls","other:var":"Assignment","other:msg":"Message","other:url":"System Functions",page:"Page",control:"Control",module:"Module"},action:{none:"None","anim apply":"Apply the animation to",setQueryData:"Set Query Data",setProperties:"Modify Properties",invoke:"Invoke",destroy:"Destroy",updateValue:"Update Value",resetValue:"Reset Value",clearValue:"Clear Value",getDirtied:"Get Dirtied",updateDataFromUI:"Update Data from UI",updateDataToUI:"Update Data to UI",start:"Start",suspend:"Suspend",animate:"Animate",activate:"Activate",disable:"Disable",enable:"Enable",hideItems:"Hide Items",showItems:"Show Items",busy:"Lock Screen",free:"Unlock Screen",show:"Show",hide:"Hide",popUp:"Pop to Front",setFormValues:"Fill Form",checkValid:"Form Validation",isDirtied:"Determine dirtied",setData:"Set Data",showModule2:"showModule2",getDate:"Get Data",checkRequired:"Check Required",formSubmit:"Submit Form",getFormValues:"Get form values",formReset:"Reset Form",formClear:"Clear Form",updateFormValues:"Update Form",getUIValue:"Get value",setUIValue:"Set value",setCaption:"Set caption",activeItem:"Activate Item",fireClickEvent:"Click it",fireItemClickEvent:"Click Item",dumpContainer:"Dump Container",setToggle:"Expand or Folding",toggleNode:"Expand or Folding",getHotRow:"Get hot row",isCellDirtied:"Is cell dirtied",updateCellValue:"Remove cell dirty",isRowDirtied:"Is row dirtied",updateRowValue:"Remove row dirty",updateHotRow:"Update hot row",getRowMap:"Get Cells Data",getHeaderByCell:"Get column by cell",getRowbyCell:"Get row by cell",resetCellValue:"Reset cell value",updateGridValue:"Remove grid dirty",toggleRow:"Expand or Folding",insertItems:"Add Items",updateItem:"Update Item",removeItems:"Remove Items",clearItems:"Clear Items",updateCellByRowCol2:"Update Cell",triggerFormulas:"Calculate grid formulas",setActiveRow:"Active Row",sortColumn:"Sort column",showColumn:"Show column",getActiveRow:"Get active row",autoRowHeight:"Auto row height",getCellbyRowCol:"Get cell",editCellbyRowCol:"To edit cell",focusCellbyRowCol:"Focus cell",getActiveCell:"Get active cell",setActiveCell:"Set active cell",getEditor:"Get editor",getEditCell:"Get cell in edit",offEditor:"Off editor",updateEditor:"Update editor",getRawData:"Get mapped rows",setRawData:"Set mapped rows",insertRows:"Add Rows",updateRow:"Update Row",setRowMap:"Update Cells",removeRows:"Remove Rows",removeAllRows:"Clear Rows",insertCol:"Add Column",updateHeader:"Update Header",removeCols:"Remove Columns",setHeader:"Clear All",editItem:"Edit Item",close:"Close Window",close2:"Close Dialog",showModal:"show modal","open----_self":"Open in Currrent Window","open----_blank":"Open to New Window",mailTo:"Send Email",selectFile:"Select File from Local Disk",readText:"Read Text form URL",readJSON:"Read JSON form URL",temp:"to Temp Object",global:"to Global Object",constant:"Constant",page:"to Page Object","page.properties":"to Page Properties",call:"Call Function",set:"Set Function Global Reference",setCookies:"Set Cookies",setFI:"Set Fragment Identifier",message:"Open Float Message",pop:"Open Message Dialog",alert:"Open Alert Dialog",confirm:"Open Confirm Dialog",prompt:"Open Prompt Dialog",log:"Log to Console",echo:"Echo to Debug Window",setProfiles:"Fill profile",setData:"Fill data",setValue:"Fill value",open:"Open in New Window",show2:"Switch to the page",initData:"initData",reloadParent:"reloadParent",postMessage:"Post Message to",broadcast:"Broadcast Message",getHooks:"Get hook",setHooks:"Set hook",notifyHooks:"Notify hook",callFunction:"Call function",fireEvent:"Fire event",setTotalCount:"Set total count",getPage:"Get page",setPage:"Set page",getTotalPages:"get total page number",getJSONData:"Get JSON Data",setJSONData:"Set JSON Data",getXMLData:"Get XML Data",setXMLData:"Set XML Data",updateData:"Update Data",setTheme:"Set Theme",fillData:"Fill Data",refreshChart:"Refresh Chart",setSrc:"Set media source",play:"Play",pause:"Pause",connect:"Connect",disconnect:"Disconnect",subscribe:"Subscribe",unsubscribe:"Unsubscribe",publish:"Publish"}},customAppend:function(m,a,c,g){var j=this,d=j.CAPMAP.actiongroup,b=j.properties;j.propFilter.setValue("",true);j._hiddenDiv=xui.Dom.getEmptyDiv();j._hiddenDiv.html(" ");var f=function(n){n.id=xui.getClassName(n.id);if(!n.type){n.group=true}n._type="page";delete n.tips;n.sub=true};if(xui.get(b.parent,["_cls"])){xui.filter(b.pages,function(n){return n.id!=SPA.currentPage})}xui.arr.each(b.pages,f);var e=[{id:"none:none",caption:"$RAD.action."+d["none:none"],imageClass:"xui-icon-none",cat:"none",_type:"none"},{id:"other:msg",caption:"$(RAD.action."+d["other:msg"]+")",mageClass:"xui-icon-info",_type:"other"},{id:"other:var",caption:"$(RAD.action."+d["other:var"]+")",imageClass:"spafont spa-icon-var",_type:"other"},{id:"other:callback",caption:"$(RAD.action."+d["other:callback"]+")",imageClass:"spafont spa-icon-function",_type:"other"},{id:"other:url",caption:"$(RAD.action."+d["other:url"]+")",imageClass:"xui-icon-dialog",_type:"other"},{type:"split"}];if(xui.get(b.parent,["_cls"])){e.push({id:SPA.currentPage?xui.getClassName(SPA.currentPage):(b.className||"App"),caption:"$(RAD.action."+d.page+")",value:SPA.currentPage||"CurPage",imageClass:"spafont spa-icon-page",sub:b.controls,_type:"page"})}j._tagVar=null;e.push({id:"group:pages",caption:"$(RAD.action.Other Pages)",group:true,sub:true});j.tb_cat.setItems(e).setUIValue(null);j.dialog.setCaption("$(RAD.action.Actions Editor)  "+(b._cap?(" : "+b._cap):""));var l=[{_iscon:1,id:"none",caption:"$RAD.action.None",imageClass:"xui-icon-none"}],f=function(o,n){if(n&&n.length){xui.arr.each(n,function(x){var u=x["0"];if(u.behavior&&u.behavior.PanelKeys&&u.behavior.PanelKeys.length){var q=xui.copy(o);var s={};q.push(u.alias);xui.arr.each(q,function(A){s["parent:"+A]=1});if(u.properties.items){var w=[];xui.arr.each(u.properties.items,function(A){var B=xui.copy(s);B.id="{page."+u.alias+"."+A.id+"}";B.con="{page."+u.alias+"}";B.consub=A.id;B.caption=A.caption||A.id;B._iscon=1;w.push(B)});var r=xui.copy(s);r.id="{page."+u.alias+".[key]}";r.con="{page."+u.alias+"}";r.consub="[key]";r._iscon=1;r.caption="$(RAD.action.Other sub$-container)";w.push(r);s.id="{page."+u.alias+"}";s.caption=x.caption;s.image=x.image;s.imagePos=x.imagePos;s.group=true;s._iscon=1;s.sub=w}else{s.id=s.con="{page."+u.alias+"}";s.consub=null;s.caption=x.caption;s.image=x.image;s.imagePos=x.imagePos;s._iscon=1}l.push(s);if(x.sub){f(q,x.sub)}}})}};f([],b.controls);j._panelitems=l;j._initctrls(true,true);j.btn_ok.activate();j.dialog.showModal(null,null,null,function(){var o=[];if(b.actionConf){if(xui.isArr(b.actionConf)||xui.isHash(b.actionConf)){var n=xui.isArr(b.actionConf)?b.actionConf:b.actionConf.actions,q=xui.isHash(b.actionConf)?b.actionConf["return"]:null;if(n){xui.arr.each(n,function(u,r){if(xui.isHash(u)){var s={id:r+"",caption:u.desc||"",imageClass:"spafont spa-icon-action",tagVar:xui.clone(u,true)};if(s.tagVar&&("params" in s.tagVar)){s.tagVar.args=s.tagVar.params;delete s.tagVar.params}o.push(s)}else{}});j.tb_actions.setItems(o);if(o.length){j._enablectrls();j.tb_actions.setUIValue(null);xui.asyRun(function(){if(j.tb_actions){j.tb_actions.setUIValue(o[b._selected||0].id)}})}j.btn_ok.activate()}if(q){j.xui_returns.setValue(q,true)}}else{}}if(!o.length){j.addAction(xui.getRes("RAD.action.Action")+" 1")}j.markDirty(0)});j._targetshadow=j._targetshadow2=null;return true},markDirty:function(a){var b=this;if(!a||!b._initvalue){b._dirty=a}},_initctrls:function(c,a){var b=this;if(c){b.tb_actions.clearItems()}b.tb_actions.setUIValue(null).setDisabled(true);b.ctl_grpp.setHtml("",true);b._initvalue=1;if(a){b.xui_returns.setValue("",true)}b.i_conl1.setValue("",true).setDisabled(true);b.ctl_symbol1.setValue("defined",true).setDisabled(true);b.i_conr1.setValue("",true).setDisabled(true);b.i_conl2.setValue("",true).setDisabled(true);b.ctl_symbol2.setValue("defined",true).setDisabled(true);b.i_conr2.setValue("",true).setDisabled(true);b.i_conl3.setValue("",true).setDisabled(true);b.ctl_symbol3.setValue("defined",true).setDisabled(true);b.i_conr3.setValue("",true).setDisabled(true);b.add_pos.setValue("before",true).setDisabled(true);b.add_target.setValue("",true).setDisabled(true);b.log_v1.setValue("",true).setDisabled(false);b.log_v2.setValue("",true).setDisabled(false);b.log_v3.setValue("",true).setDisabled(false);b.log_v4.setValue("",true).setDisabled(false);b.log_v5.setValue("",true).setDisabled(false);b.tb_mixsub.setValue("",true).setDisabled(true);b.tb_consub.setValue("",true).setDisabled(true);b.ctl_animate.setValue("blinkAlert",true).setDisabled(true);b.ctl_animate.setTagVar(null).setInputReadonly(false,true).setCommandBtn("none",true);b.ctl_varfrom.setValue("",true).setDisabled(true);b.ctl_varfrom.setTagVar(null).setInputReadonly(false,true).setCommandBtn("none",true);b.ctl_varfrompath.setValue("",true).setTagVar(null);b.ctl_varto.setValue("",true).setDisabled(true);b.ctl_adjust.setValue("",true).setDisabled(true);b.cb_asy.setValue(false).setDisabled(true);b.spin_asy.setValue(0).setDisabled(true);b.cb_false.setValue(false).setDisabled(true);b.tb_cat.setDisabled(true);b.tb_action.setDisabled(true);b.tb_cat.setValue("none:none",true);b.cb_setid.setValue("").setDisabled(true);b.cb_setvalue.setValue("").setDisabled(true);b.cb_callid.setValue("").setDisabled(true);b.grid_params.removeAllRows();b.cb_callreturnto.setValue("none").setDisabled(true);b.cb_callreturn.setValue("").setDisabled(true);b.conf_return_exp.setHtml("");b._initvalue=0},_enablectrls:function(){var a=this;a.tb_actions.setDisabled(false);a.i_conl1.setDisabled(false);a.ctl_symbol1.setDisabled(false);a.i_conr1.setDisabled(true);a.i_conl2.setDisabled(false);a.ctl_symbol2.setDisabled(false);a.i_conr2.setDisabled(true);a.i_conl3.setDisabled(false);a.ctl_symbol3.setDisabled(false);a.i_conr3.setDisabled(true);a.add_pos.setDisabled(false);a.log_v1.setDisabled(false);a.log_v2.setDisabled(false);a.log_v3.setDisabled(false);a.log_v4.setDisabled(false);a.log_v5.setDisabled(false);a.add_target.setDisabled(false);a.ctl_animate.setDisabled(false);a.ctl_varfrom.setDisabled(false);a.ctl_varfrompath.setDisabled(false);a.ctl_varto.setDisabled(false);a.ctl_adjust.setDisabled(false);a.tb_mixsub.setDisabled(false);a.tb_consub.setDisabled(false);a.cb_asy.setDisabled(false);a.cb_false.setDisabled(false);a.tb_cat.setDisabled(false);a.tb_action.setDisabled(false);a.cb_setid.setDisabled(false);a.cb_setvalue.setDisabled(false);a.cb_callid.setDisabled(false);a.cb_callreturnto.setDisabled(false);a.cb_callreturn.setDisabled(false)},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dialog").setLeft("0em").setTop("0em").setWidth("70em").setHeight("40em").setZIndex(1004).setCaption("$(RAD.action.Actions Editor)").setImageClass("spafont spa-icon-action").setMinBtn(false).beforeClose("_beforeclose"));c.dialog.append(xui.create("xui.UI.Block").setHost(c,"ctl_block18").setDock("fill").setBorderType("none"));c.ctl_block18.append(xui.create("xui.UI.Layout").setHost(c,"ctl_layout11").setItems([{id:"before",pos:"before",size:130,min:10,locked:false,folded:false,hidden:false,cmd:false},{id:"main",size:642,min:10},{id:"after",pos:"after",size:29,min:10,locked:false,folded:false,hidden:true,cmd:false}]).setType("horizontal").setCustomClass({PANEL:"xui-uibg-bar"}));c.ctl_layout11.append(xui.create("xui.UI.Panel").setHost(c,"ctl_panel16").setCaption("$(RAD.action.Actions List)").setBorderType("none").setNoFrame(true),"before");c.ctl_panel16.append(xui.create("xui.UI.TreeView").setHost(c,"tb_actions").setIniFold(false).setDropKeys("_tb_action_configure").setDragKey("_tb_action_configure").onChange("_tb_actions_onchange").beforeEditApply("_tb_beforeapply").onDblclick("_tb_actions_ondblclick").afterDrop("_tb_action_drop"));c.ctl_panel16.append(xui.create("xui.UI.Block").setHost(c,"ctl_block66").setDock("top").setDockMargin({left:-3,top:0,right:-3,bottom:0}).setHeight("2.4166666666666665em").setBorderType("ridge").setOverflow("hidden"));c.ctl_block66.append(xui.create("xui.UI.ToolBar").setHost(c,"toolbar").setItems([{id:"grp1",sub:[{id:"add",caption:"",imageClass:"xui-uicmd-add",tips:"$(RAD.action.Add Action)"},{id:"remove",caption:"",imageClass:"xui-icon-minus",tips:"$(RAD.action.Remove Action)"},{id:"edit",imageClass:"spafont spa-icon-edit",caption:"",tips:"$(RAD.action.Edit Item)"}],caption:"grp1"},{id:"grp2",sub:[{id:"clear",imageClass:"spafont spa-icon-clear",caption:"",tips:"$(RAD.action.Clear All)"}],caption:"grp2"}]).setHandler(false).setHAlign("center").onClick("_toolbar_onclick").setCustomStyle({ITEMS:"border-width:0 "}));c.ctl_panel16.append(xui.create("xui.UI.Block").setHost(c,"xui_ui_block32").setDock("bottom").setLeft("5em").setTop("31.666666666666668em").setHeight("4.333333333333333em").setBorderType("none"));c.xui_ui_block32.append(xui.create("xui.UI.Input").setHost(c,"xui_returns").setTag(1).setDirtyMark(false).setDock("width").setDockMargin({left:6,top:0,right:6,bottom:0}).setLeft("0.75em").setTop("0.25em").setWidth("6.583333333333333em").setHeight("3.8333333333333335em").setLabelSize("1.8em").setLabelPos("top").setLabelCaption("$(RAD.action.Return value)").setLabelHAlign("left").onChange("_i_rtn_onchange"));c.ctl_layout11.append(xui.create("xui.UI.Group").setHost(c,"ctl_group1").setDock("width").setDockMargin({left:10,top:0,right:100,bottom:0}).setTop("0.4166666666666667em").setHeight("8.25em").setOverflow("hidden").setCaption("$(RAD.action.Action Conditions)").setToggleBtn(false),"main");c.ctl_group1.append(xui.create("xui.UI.Div").setHost(c,"pan_condition").setDock("width").setLeft("0.8333333333333334em").setTop("0em").setWidth("40em").setHeight("2.1666666666666665em").setOverflow("hidden"));c.pan_condition.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel1").setLeft("0.75em").setTop("0.375em").setWidth("2.6666666666666665em").setCaption("$RAD.action.If"));c.pan_condition.append(xui.create("xui.UI.ComboInput").setHost(c,"i_conl1").setTag(1).setDirtyMark(false).setLeft("4.25em").setTop("0.125em").setWidth("19.666666666666668em").setType("none").onChange("_i_conl_onchange"));c.pan_condition.append(xui.create("xui.UI.ComboInput").setHost(c,"i_conr1").setTag(1).setDirtyMark(false).setDock("width").setDockMargin({right:12,top:undefined,left:undefined,bottom:undefined}).setDockStretch("rearward").setLeft("31.416666666666668em").setTop("0.125em").setWidth("8em").setType("none").onChange("_i_conr_onchange"));c.pan_condition.append(xui.create("xui.UI.ComboInput").setHost(c,"ctl_symbol1").setTag(1).setDirtyMark(false).setLeft("24.25em").setTop("0.125em").setWidth("7em").setType("listbox").setDropListWidth(160).setItems([{id:"defined",caption:"$(RAD.action.symbol.defined)"},{id:"undefined",caption:"$(RAD.action.symbol.undefined)"},{id:"empty",caption:"$(RAD.action.symbol.Is empty)"},{id:"non-empty",caption:"$(RAD.action.symbol.Is not empty)"},{id:"=",caption:"$(RAD.action.symbol.is)"},{id:"!=",caption:"$(RAD.action.symbol.is not)"},{id:">",caption:"$(RAD.action.symbol.>)"},{id:"<",caption:"$(RAD.action.symbol.<)"},{id:">=",caption:"$(RAD.action.symbol.>=)"},{id:"<=",caption:"$(RAD.action.symbol.<=)"},{id:"include",caption:"$(RAD.action.symbol.Contains)"},{id:"exclude",caption:"$(RAD.action.symbol.Does't Contain)"},{id:"start",caption:"$(RAD.action.symbol.Starts With)"},{id:"end",caption:"$(RAD.action.symbol.Ends With)"},{id:"objhaskey",caption:"$(RAD.action.symbol.Object contains key)"},{id:"objnokey",caption:"$(RAD.action.symbol.Object no key)"},{id:"arrhasvalue",caption:"$(RAD.action.symbol.Array contains value)"},{id:"arrnovalue",caption:"$(RAD.action.symbol.Array no value)"},{id:"objarrhaskey",caption:"$(RAD.action.symbol.Items contains id)"},{id:"objarrnokey",caption:"$(RAD.action.symbol.Items no id)"}]).setValue("defined").onChange("_ctl_symbol_onchange"));c.ctl_group1.append(xui.create("xui.UI.Div").setHost(c,"ctl_pane39").setDock("width").setLeft("0.8333333333333334em").setTop("2.1666666666666665em").setWidth("40em").setHeight("2.1666666666666665em").setOverflow("hidden"));c.ctl_pane39.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel41").setLeft("0.75em").setTop("0.375em").setWidth("2.6666666666666665em").setCaption("$(RAD.action.And)"));c.ctl_pane39.append(xui.create("xui.UI.ComboInput").setHost(c,"i_conl2").setTag(2).setDirtyMark(false).setLeft("4.25em").setTop("0.125em").setWidth("19.666666666666668em").setType("none").onChange("_i_conl_onchange"));c.ctl_pane39.append(xui.create("xui.UI.ComboInput").setHost(c,"i_conr2").setTag(2).setDirtyMark(false).setDock("width").setDockMargin({right:12,top:undefined,left:undefined,bottom:undefined}).setDockStretch("rearward").setLeft("31.416666666666668em").setTop("0.125em").setWidth("8em").setType("none").onChange("_i_conr_onchange"));c.ctl_pane39.append(xui.create("xui.UI.ComboInput").setHost(c,"ctl_symbol2").setTag(2).setDirtyMark(false).setLeft("24.25em").setTop("0.125em").setWidth("7em").setType("listbox").setDropListWidth(160).setItems([{id:"defined",caption:"$(RAD.action.symbol.defined)"},{id:"undefined",caption:"$(RAD.action.symbol.undefined)"},{id:"empty",caption:"$(RAD.action.symbol.Is empty)"},{id:"non-empty",caption:"$(RAD.action.symbol.Is not empty)"},{id:"=",caption:"$(RAD.action.symbol.is)"},{id:"!=",caption:"$(RAD.action.symbol.is not)"},{id:">",caption:"$(RAD.action.symbol.>)"},{id:"<",caption:"$(RAD.action.symbol.<)"},{id:">=",caption:"$(RAD.action.symbol.>=)"},{id:"<=",caption:"$(RAD.action.symbol.<=)"},{id:"include",caption:"$(RAD.action.symbol.Contains)"},{id:"exclude",caption:"$(RAD.action.symbol.Does't Contain)"},{id:"start",caption:"$(RAD.action.symbol.Starts With)"},{id:"end",caption:"$(RAD.action.symbol.Ends With)"},{id:"objhaskey",caption:"$(RAD.action.symbol.Object contains key)"},{id:"objnokey",caption:"$(RAD.action.symbol.Object no key)"},{id:"arrhasvalue",caption:"$(RAD.action.symbol.Array contains value)"},{id:"arrnovalue",caption:"$(RAD.action.symbol.Array no value)"},{id:"objarrhaskey",caption:"$(RAD.action.symbol.Items contains id)"},{id:"objarrnokey",caption:"$(RAD.action.symbol.Items no id)"}]).setValue("defined").onChange("_ctl_symbol_onchange"));c.ctl_group1.append(xui.create("xui.UI.Div").setHost(c,"ctl_pane41").setDock("width").setLeft("0.8333333333333334em").setTop("4.25em").setWidth("40em").setHeight("2.1666666666666665em").setOverflow("hidden"));c.ctl_pane41.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel42").setLeft("0.75em").setTop("0.375em").setWidth("2.6666666666666665em").setCaption("$(RAD.action.And)"));c.ctl_pane41.append(xui.create("xui.UI.ComboInput").setHost(c,"i_conl3").setTag(3).setDirtyMark(false).setLeft("4.25em").setTop("0.125em").setWidth("19.666666666666668em").setType("none").onChange("_i_conl_onchange"));c.ctl_pane41.append(xui.create("xui.UI.ComboInput").setHost(c,"i_conr3").setTag(3).setDirtyMark(false).setDock("width").setDockMargin({right:12,top:undefined,left:undefined,bottom:undefined}).setDockStretch("rearward").setLeft("31.416666666666668em").setTop("0.125em").setWidth("8em").setType("none").onChange("_i_conr_onchange"));c.ctl_pane41.append(xui.create("xui.UI.ComboInput").setHost(c,"ctl_symbol3").setTag(3).setDirtyMark(false).setLeft("24.25em").setTop("0.125em").setWidth("7em").setType("listbox").setDropListWidth(160).setItems([{id:"defined",caption:"$(RAD.action.symbol.defined)"},{id:"undefined",caption:"$(RAD.action.symbol.undefined)"},{id:"empty",caption:"$(RAD.action.symbol.Is empty)"},{id:"non-empty",caption:"$(RAD.action.symbol.Is not empty)"},{id:"=",caption:"$(RAD.action.symbol.is)"},{id:"!=",caption:"$(RAD.action.symbol.is not)"},{id:">",caption:"$(RAD.action.symbol.>)"},{id:"<",caption:"$(RAD.action.symbol.<)"},{id:">=",caption:"$(RAD.action.symbol.>=)"},{id:"<=",caption:"$(RAD.action.symbol.<=)"},{id:"include",caption:"$(RAD.action.symbol.Contains)"},{id:"exclude",caption:"$(RAD.action.symbol.Does't Contain)"},{id:"start",caption:"$(RAD.action.symbol.Starts With)"},{id:"end",caption:"$(RAD.action.symbol.Ends With)"},{id:"objhaskey",caption:"$(RAD.action.symbol.Object contains key)"},{id:"objnokey",caption:"$(RAD.action.symbol.Object no key)"},{id:"arrhasvalue",caption:"$(RAD.action.symbol.Array contains value)"},{id:"arrnovalue",caption:"$(RAD.action.symbol.Array no value)"},{id:"objarrhaskey",caption:"$(RAD.action.symbol.Items contains id)"},{id:"objarrnokey",caption:"$(RAD.action.symbol.Items no id)"}]).setValue("defined").onChange("_ctl_symbol_onchange"));c.ctl_layout11.append(xui.create("xui.UI.Block").setHost(c,"ctl_block14").setDock("fill").setDockMargin({left:0,top:110,right:0,bottom:0}).setBorderType("none"),"main");c.ctl_block14.append(xui.create("xui.UI.Div").setHost(c,"ctl_pane17").setDock("fill"));c.ctl_pane17.append(xui.create("xui.UI.Layout").setHost(c,"ctl_layout8").setItems([{id:"before",size:200,min:10,locked:false,folded:false,hidden:false,cmd:false,pos:"before"},{id:"main",size:492,min:10},{id:"after",size:80,min:10,locked:false,folded:false,hidden:true,cmd:false,pos:"after"}]).setType("horizontal").setCustomClass({PANEL:"xui-uibg-bar"}));c.ctl_layout8.append(xui.create("xui.UI.Panel").setHost(c,"ctl_panel7").setCaption("1.$(RAD.action.Select category/target)").setBorderType("none").setNoFrame(true),"before");c.ctl_panel7.append(xui.create("xui.UI.TreeView").setHost(c,"tb_cat").setIniFold(false).onChange("_tb_cat_onchange").onGetContent("_treebarprj_onGetContent"));c.ctl_panel7.append(xui.create("xui.UI.Block").setHost(c,"blk_target").setDock("top").setDockMargin({left:-3,top:0,right:-3,bottom:0}).setHeight("2.25em").setBorderType("ridge").setOverflow("hidden").setCustomStyle({PANEL:"white-space: nowrap;"}));c.blk_target.append(xui.create("xui.UI.Label").setHost(c,"lbl_target").setLeft("0.625em").setTop("0.3125em").setWidth("7.6875em").setCaption("").setHAlign("left").setCustomStyle({KEY:{overflow:"visible"}}));c.ctl_layout8.append(xui.create("xui.UI.Layout").setHost(c,"ctl_layout17").setItems([{id:"before",size:180,min:10,locked:false,folded:false,hidden:false,cmd:false,pos:"before"},{id:"main",size:372,min:10},{id:"after",size:29,min:10,locked:false,folded:false,hidden:true,cmd:false,pos:"after"}]).setType("horizontal").setCustomClass({PANEL:"xui-uibg-bar"}),"main");c.ctl_layout17.append(xui.create("xui.UI.Panel").setHost(c,"ctl_panel8").setCaption("2.$(RAD.action.Select action)").setBorderType("none").setNoFrame(true),"before");c.ctl_panel8.append(xui.create("xui.UI.TreeView").setHost(c,"tb_action").setIniFold(false).onChange("_tb_action_onchange"));c.ctl_panel8.append(xui.create("xui.UI.Block").setHost(c,"ctl_action").setDock("top").setDockMargin({left:-3,top:0,right:-3,bottom:0}).setHeight("2.25em").setBorderType("ridge").setOverflow("hidden").setCustomStyle({PANEL:"white-space: nowrap;"}));c.ctl_action.append(xui.create("xui.UI.Label").setHost(c,"lbl_action").setLeft("0.75em").setTop("0.3125em").setWidth("5.5625em").setCaption("").setHAlign("left").setCustomStyle({KEY:{overflow:"visible"}}));c.ctl_layout17.append(xui.create("xui.UI.Panel").setHost(c,"ctl_panel9").setPanelBgClr("#FFFFFF").setCaption("3.$(RAD.action.Configure action)").setBorderType("none").setNoFrame(true),"main");c.ctl_panel9.append(xui.create("xui.UI.Block").setHost(c,"ctl_block103").setDock("top").setDockMargin({left:-3,top:0,right:-3,bottom:0}).setHeight("2.25em").setZIndex(5).setBorderType("ridge").setOverflow("hidden"));c.ctl_block103.append(xui.create("xui.UI.CheckBox").setHost(c,"cb_asy").setDirtyMark(false).setLeft("0.9375em").setTop("0.08333333333333333em").setWidth("7.333333333333333em").setHeight("1.5833333333333333em").setCaption("$RAD.action.Async").onChange("_cb_asy_onchange"));c.ctl_block103.append(xui.create("xui.UI.ComboInput").setHost(c,"spin_asy").setDirtyMark(false).setLeft("8.25em").setTop("0.08333333333333333em").setWidth("5.833333333333333em").setHeight("1.75em").setType("spin").setPrecision(0).setIncrement(100).setValue(0).onChange("_spin_asy_onchange"));c.ctl_block103.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel25").setLeft("14.25em").setTop("0.3333333333333333em").setHeight("1.0833333333333333em").setCaption("$RAD.action.ms"));c.ctl_block103.append(xui.create("xui.UI.CheckBox").setHost(c,"cb_false").setDirtyMark(false).setLeft("17.333333333333332em").setTop("0.08333333333333333em").setWidth("23.333333333333332em").setHeight("1.5833333333333333em").setCaption("$(RAD.action.Abort subsequent execution)").onChange("_false_change"));c.ctl_panel9.append(xui.create("xui.UI.Block").setHost(c,"ctl_block33").setDock("fill").setDockMargin({left:-3,top:-3,right:0,bottom:0}).setZIndex(4).setBorderType("inset"));c.ctl_block33.append(xui.create("xui.UI.Tabs").setHost(c,"tab_conf").setItems([{id:"none",caption:"none"},{id:"selfile",caption:"selfile"},{id:"page",caption:"page"},{id:"fmsg",caption:"fmsg"},{id:"datatransfer",caption:"datatransfer"},{id:"url",caption:"url"},{id:"prop",caption:"prop"},{id:"json",caption:"json"},{id:"con",caption:"con"},{id:"msg",caption:"msg"},{id:"data",caption:"data"},{id:"switch",caption:"switch"},{id:"var",caption:"var"},{id:"mix",caption:"mix"},{id:"setcb",caption:"setcb"},{id:"callcb",caption:"callcb"},{id:"log",caption:"log"},{id:"animate",caption:"animate"}]).setNoHandler(true).setValue("callcb"));c.tab_conf.append(xui.create("xui.UI.Span").setHost(c,"ctl_span1").setLeft("15.416666666666666em").setTop("11.083333333333334em").setWidth("1.625em").setHtml("px"),"fmsg");c.tab_conf.append(xui.create("xui.UI.Span").setHost(c,"ctl_span2").setLeft("15.416666666666666em").setTop("13.75em").setWidth("2.25em").setHtml("$RAD.action.ms"),"fmsg");c.tab_conf.append(xui.create("xui.UI.Panel").setHost(c,"ctl_tocon").setCaption("$(RAD.action.Select Target Node)"),"con");c.ctl_tocon.append(xui.create("xui.UI.TreeView").setHost(c,"tb_con").setIniFold(false).onChange("_tb_con_onchange"));c.tab_conf.append(xui.create("xui.UI.Span").setHost(c,"msg_inputm").setLeft("0.9166666666666666em").setTop("11.583333333333334em").setWidth("24.25em").setHeight("1.3333333333333333em").setHtml("$(RAD.action.msg.Notice: The prompt input will be set to {temp$.okData})"),"msg");c.tab_conf.append(xui.create("xui.UI.Span").setHost(c,"msg_m").setDock("bottom").setDockMargin({left:10,top:0,right:10,bottom:2}).setHeight("auto").setHtml("<div style='color:red;'> $(RAD.action.msg.Asynchronous action causes the later actions to be blocked until it succeeds or fails) </div>"),"msg");c.tab_conf.append(xui.create("xui.UI.Panel").setHost(c,"ctl_panel29").setCaption("$(RAD.action.Select Target Node)"),"mix");c.ctl_panel29.append(xui.create("xui.UI.TreeView").setHost(c,"add_target").setIniFold(false).onChange("_add_target_onchange"));c.tab_conf.append(xui.create("xui.UI.Group").setHost(c,"ctl_group35").setDock("bottom").setDockMargin({left:6,top:4,right:4,bottom:8}).setHeight("5.333333333333333em").setOverflow("hidden").setCaption("$(RAD.action.Set return value to)").setToggleBtn(false),"callcb");c.ctl_group35.append(xui.create("xui.UI.Span").setHost(c,"conf_return_exp").setDock("bottom").setDockMargin({left:10,top:0,right:12,bottom:2}).setHeight("auto").setHtml('<font color="#ff0000">&nbsp;</font>').setCustomStyle({KEY:{color:"#FF0000","text-align":"right"}}));c.ctl_group35.append(xui.create("xui.UI.Input").setHost(c,"cb_callreturn").setTagVar("none").setDirtyMark(false).setDock("width").setDockMargin({left:140,top:0,right:4,bottom:0}).setTop("0.1875em").setZIndex(1002).setLabelSize("6.666666666666667em").setLabelCaption("$(RAD.action.Key)").onChange("_cb_callreturn_onchange"));c.ctl_group35.append(xui.create("xui.UI.ComboInput").setHost(c,"cb_callreturnto").setDirtyMark(false).setLeft("1em").setTop("0.25em").setType("listbox").setItems([{id:"none",caption:"$(RAD.action.Doesn't set at all)"},{id:"temp",caption:"$(RAD.action.to Temp Object)",image:""},{id:"global",caption:"$(RAD.action.to Global Object)",image:""},{id:"page",caption:"$(RAD.action.to Page Object)",image:"",disabled:false},{id:"page.properties",caption:"$(RAD.action.to Page Properties)",image:""}]).setValue("none").onChange("_cb_callreturnto_onchange"));c.tab_conf.append(xui.create("xui.UI.Group").setHost(c,"ctl_grpp").setDock("width").setDockMargin({right:12,top:undefined,left:undefined,bottom:undefined}).setDockStretch("rearward").setLeft("1.25em").setTop("8.583333333333334em").setWidth("25.25em").setHeight("auto").setCaption("$RAD.action.Parameters").setToggleBtn(false),"setcb");c.tab_conf.append(xui.create("xui.UI.Span").setHost(c,"msg_m2").setDock("bottom").setDockMargin({left:0,top:0,right:10,bottom:2}).setHeight("1.1666666666666667em").setHtml("<div style='color:red;text-align:right'> $(RAD.action.msg.Asynchronous action: the later actions will be blocked until it succeeds or fails. 'Stop' will not prevent next actions, but can stop the follow up process for 'beforeXXX' event.) </div>"),"datatransfer");c.tab_conf.append(xui.create("xui.UI.Group").setHost(c,"xui_ui_g21").setDock("fill").setDockMargin({left:0,top:42,right:0,bottom:0}).setCaption("$RAD.action.Parameters").setToggleBtn(false),"url");c.xui_ui_g21.append(xui.create("xui.Module.JSONEditor","xui.Module").setHost(c,"_jsoneditor2").setProperties({multiLineValue:false}).setEvents({onEdit:"_jsonedit",onchange:"_jsoneditorchanged2"}));c.tab_conf.append(xui.create("xui.UI.Span").setHost(c,"xui_var_right").setDock("bottom").setDockMargin({left:10,top:0,right:10,bottom:2}).setHeight("auto").setHtml("DataAdjustment( ValueSource[ValuePath] )").setCustomStyle({KEY:{"text-align":"right"}}),"var");c.tab_conf.append(xui.create("xui.UI.Span").setHost(c,"conf_var_left").setDock("bottom").setDockMargin({left:10,top:0,right:10,bottom:2}).setHeight("auto").setHtml('<font color="#ff0000">&nbsp;</font>').setCustomStyle({KEY:{color:"#FF0000"}}),"var");c.tab_conf.append(xui.create("xui.UI.ComboInput").setHost(c,"propFilter").setTagVar("none").setDirtyMark(false).setDock("top").setDockMargin({left:4,top:4,right:4,bottom:4}).setTips("$(RAD.designer.tool.Filter) ").setHeight("2em").setDynCheck(true).setType("input").setImageClass("xui-icon-filter").setUnit("Show All").setUnits("Show All;Modified Only").setCommandBtn("delete").onChange("_propFilter_onchange").onCommand("_propFilter_oncmd").afterUnitUpdated("_propFilter_unit"),"prop");c.tab_conf.append(xui.create("xui.UI.TreeGrid").setHost(c,"profileGrid").setDirtyMark(false).setSelMode("multibycheckbox").setEditable(true).setRowHandler(false).setColSortable(false).setHeader([{id:"key",caption:"$RAD.designer.gridcol1",width:"10em",type:"label"},{id:"value",caption:"$RAD.designer.gridcol2",width:"10em",type:"input",flexSize:1},{id:"value2",caption:"$(RAD.designer.Variable)",width:"10em",type:"input",flexSize:1}]).setRowOptions({rowRenderer:function(d,e){if(e.group){d.getSubNode("MARK",e._serialId).css("display","none")}}}).setTreeMode("infirstcell").setValue("").onShowTips("$tg_tips").onRowSelected("$profilegrid__rowsel").beforeRowActive(function(){return false}).beforeCellUpdated("$profilegrid_beforecellvalueset").afterCellUpdated("$tg_cellupd").onDblclickRow("$tg_dblclick").onBeginEdit("$tg_beginedit").setCustomStyle({HFMARK:"display:none"}),"prop");c.tab_conf.append(xui.create("xui.UI.Input").setHost(c,"url_address").setDirtyMark(false).setDock("width").setDockMargin({right:12,top:undefined,left:undefined,bottom:undefined}).setDockStretch("rearward").setLeft("0.5em").setTop("0.9375em").setWidth("26.166666666666668em").setLabelSize("6.666666666666667em").setLabelCaption("$RAD.action.url.Address").onChange("_url_address_onchange"),"url");c.tab_conf.append(xui.create("xui.UI.Input").setHost(c,"fileurl_address").setDirtyMark(false).setDock("width").setDockMargin({right:12}).setDockStretch("rearward").setLeft("0.5em").setTop("0.9375em").setWidth("26.166666666666668em").setLabelSize("6.666666666666667em").setLabelCaption("$(RAD.action.url.File URL)").onChange("_url_address_onchange"),"datatransfer");c.tab_conf.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel57").setLeft("0.5em").setTop("4em").setCaption("$(RAD.action.msg.Notice: The result will be set to {temp$.okData}, and the error will be set to {temp$.koData})").setHAlign("left"),"datatransfer");c.tab_conf.append(xui.create("xui.Module.JSONEditor","xui.Module").setHost(c,"_jsoneditor").setProperties({multiLineValue:false}).setEvents({onEdit:"_jsonedit",onchange:"_jsoneditorchanged"}),"json");c.tab_conf.append(xui.create("xui.UI.Input").setHost(c,"msg_cap").setDirtyMark(false).setDock("width").setDockMargin({right:12}).setDockStretch("rearward").setLeft("0.5em").setTop("0.9375em").setWidth("25.333333333333332em").setLabelSize("6.666666666666667em").setLabelCaption("$RAD.action.fmsg.Title").onChange("_msg_cap_onchange"),"fmsg");c.tab_conf.append(xui.create("xui.UI.Input").setHost(c,"msg_body").setDirtyMark(false).setDock("width").setDockMargin({right:12}).setDockStretch("rearward").setLeft("0.5em").setTop("3.25em").setWidth("25.333333333333332em").setHeight("6.875em").setLabelSize("6.666666666666667em").setLabelCaption("$RAD.action.fmsg.Body").setMultiLines(true).onChange("_msg_body_onchange"),"fmsg");c.tab_conf.append(xui.create("xui.UI.ComboInput").setHost(c,"msg_width").setDirtyMark(false).setDock("width").setDockMargin({right:12}).setDockStretch("rearward").setLeft("0.5em").setTop("10.75em").setWidth("14.333333333333334em").setHeight("1.8333333333333333em").setLabelSize("6.666666666666667em").setLabelCaption("$RAD.action.fmsg.Width").setType("spin").setPrecision(0).setIncrement(100).setMin(0).setMax(10000).onChange("_msg_width_onchange"),"fmsg");c.tab_conf.append(xui.create("xui.UI.ComboInput").setHost(c,"msg_duration").setDirtyMark(false).setDock("width").setDockMargin({right:12}).setDockStretch("rearward").setLeft("0.5em").setTop("13.333333333333334em").setWidth("14.416666666666666em").setHeight("1.8333333333333333em").setLabelSize("6.666666666666667em").setLabelCaption("$RAD.action.fmsg.Duration").setType("spin").setPrecision(0).setIncrement(100).setMin(0).setMax(10000).onChange("_msg_duration_onchange"),"fmsg");c.tab_conf.append(xui.create("xui.UI.Block").setHost(c,"ctl_blockcon").setDock("bottom").setHeight("2.75em").setOverflow("hidden"),"con");c.ctl_blockcon.append(xui.create("xui.UI.Input").setHost(c,"tb_consub").setDirtyMark(false).setDock("width").setDockMargin({right:12}).setDockStretch("rearward").setLeft("0.625em").setTop("0.25em").setWidth("21.75em").setLabelSize("10em").setLabelCaption("$(RAD.action.Selected Node) :").onChange("_tb_consub_onchange"));c.ctl_blockcon.append(xui.create("xui.UI.RadioBox").setHost(c,"toggle_value").setDirtyMark(false).setItems([{id:"expand",caption:"$RAD.action.Expand"},{id:"folding",caption:"$RAD.action.Folding"}]).setLeft("13.75em").setTop("0.08333333333333333em").setWidth("0em").setHeight("2.4166666666666665em").setValue("expand").onChange("_toggle_value_onchange"));c.tab_conf.append(xui.create("xui.UI.CheckBox").setHost(c,"ctl_cache").setDirtyMark(false).setLeft("1.875em").setTop("0.9375em").setCaption("$(RAD.action.Cache Page)").onChange("_ctl_cache_onchange"),"switch");c.tab_conf.append(xui.create("xui.UI.Input").setHost(c,"msg_title").setDirtyMark(false).setDock("width").setDockMargin({right:12,top:undefined,left:undefined,bottom:undefined}).setDockStretch("rearward").setLeft("0.5em").setTop("0.9375em").setWidth("24.5em").setLabelSize("6.666666666666667em").setLabelCaption("$RAD.action.msg.Title").onChange("_msg_title_onchange"),"msg");c.tab_conf.append(xui.create("xui.UI.Input").setHost(c,"msg_message").setDirtyMark(false).setDock("width").setDockMargin({right:12,top:undefined,left:undefined,bottom:undefined}).setDockStretch("rearward").setLeft("0.5em").setTop("3.25em").setWidth("24.5em").setHeight("3.6666666666666665em").setLabelSize("6.666666666666667em").setLabelCaption("$RAD.action.msg.Message").setMultiLines(true).onChange("_msg_message_onchange"),"msg");c.tab_conf.append(xui.create("xui.UI.Input").setHost(c,"msg_input").setDirtyMark(false).setDock("width").setDockMargin({right:12,top:undefined,left:undefined,bottom:undefined}).setDockStretch("rearward").setLeft("0.5em").setTop("7.416666666666667em").setWidth("24.5em").setHeight("3.6666666666666665em").setLabelSize("6.666666666666667em").setLabelCaption("$(RAD.action.msg.Default Input)").setMultiLines(true).onChange("_msg_input_onchange"),"msg");c.tab_conf.append(xui.create("xui.UI.ComboInput").setHost(c,"data_source").setDirtyMark(false).setDock("width").setDockMargin({right:12,top:undefined,left:undefined,bottom:undefined}).setDockStretch("rearward").setLeft("0.5em").setTop("0.9375em").setWidth("25.333333333333332em").setLabelSize("8.333333333333334em").setLabelCaption("$(RAD.action.Data Source)").setType("helpinput").onChange("_ds_onchange").beforeComboPop("_data_source_beforecombopop"),"data");c.tab_conf.append(xui.create("xui.UI.Block").setHost(c,"blk_itempos").setDock("bottom").setDockOrder(3).setHeight("9em").setOverflow("hidden"),"mix");c.blk_itempos.append(xui.create("xui.UI.RadioBox").setHost(c,"add_pos").setDirtyMark(false).setItems([{id:"last",caption:"$(RAD.action.To the last)"},{id:"first",caption:"$(RAD.action.To the top)"},{id:"before",caption:"$(RAD.action.Before the selected node)"},{id:"after",caption:"$(RAD.action.After the selected node)"},{id:"curbefore",caption:"$(RAD.action.Before the current node)"},{id:"curafter",caption:"$(RAD.action.After the current node)"},{id:"sublast",caption:"$(RAD.action.To the last of selected node)"},{id:"subfirst",caption:"$(RAD.action.To the first of selected node)"},{id:"cursubfirst",caption:"$(RAD.action.To the first of current node)"},{id:"cursublast",caption:"$(RAD.action.To the last of current node)"}]).setDock("fill").setLeft("0.4375em").setTop("0.125em").setWidth("auto").setHeight("11.5em").setValue("last").onChange("_tb_mixsub_onchange"));c.tab_conf.append(xui.create("xui.UI.Block").setHost(c,"ctl_block143").setDock("bottom").setHeight("2.5833333333333335em").setOverflow("hidden"),"mix");c.ctl_block143.append(xui.create("xui.UI.ComboInput").setHost(c,"ctl_itemvar").setTag("purevar").setDirtyMark(false).setDock("width").setDockMargin({right:12,top:undefined,left:undefined,bottom:undefined}).setDockStretch("rearward").setLeft("0.75em").setTop("0.4166666666666667em").setWidth("25em").setHeight("1.8333333333333333em").setZIndex(1002).setLabelSize("4em").setLabelCaption("$(RAD.action.Data)").setType("none").onChange("_ctl_itemvar_onchange").onCommand("_ctl_varfrom_cmd"));c.tab_conf.append(xui.create("xui.UI.Input").setHost(c,"ctl_varto").setTagVar("none").setDirtyMark(false).setDock("width").setDockMargin({right:12,top:undefined,left:undefined,bottom:undefined}).setDockStretch("rearward").setLeft("1.125em").setTop("1.25em").setWidth("25.5em").setZIndex(1002).setLabelSize("10em").setLabelCaption("$(RAD.action.Key)").setValueFormat("^[\\w]*$").onChange("_ctl_varto_onchange"),"var");c.tab_conf.append(xui.create("xui.UI.ComboInput").setHost(c,"ctl_varfrom").setTag("purevar").setDirtyMark(false).setDock("width").setDockMargin({right:12,top:undefined,left:undefined,bottom:undefined}).setDockStretch("rearward").setLeft("1.125em").setTop("3.8333333333333335em").setWidth("25.5em").setHeight("1.8333333333333333em").setZIndex(1002).setLabelSize("10em").setLabelCaption("$(RAD.action.Value Source)").setType("helpinput").onChange("_ctl_varfrom_onchange").onCommand("_ctl_varfrom_cmd").beforeComboPop("_data_source_beforecombopop"),"var");c.tab_conf.append(xui.create("xui.UI.ComboInput").setHost(c,"ctl_animate").setDirtyMark(false).setDock("width").setDockMargin({right:12}).setDockStretch("rearward").setLeft("1.125em").setTop("1.25em").setWidth("25.5em").setHeight("1.8333333333333333em").setZIndex(1002).setLabelSize("8em").setLabelCaption("$(RAD.action.Animate Setting)").setType("listbox").beforeUIValueSet("_animate_buis").onChange("_ctl_animate_onchange").onCommand("_ctl_varfrom_cmd").beforeComboPop("_animate_beforecombopop"),"animate");c.tab_conf.append(xui.create("xui.UI.ComboInput").setHost(c,"ctl_varfrompath").setTag("purevar").setDirtyMark(false).setDock("width").setDockMargin({right:12,top:undefined,left:undefined,bottom:undefined}).setDockStretch("rearward").setLeft("1.125em").setTop("6.333333333333333em").setWidth("25.5em").setHeight("1.8333333333333333em").setZIndex(1002).setLabelSize("10em").setLabelCaption("$(RAD.action.Value Path)").setType("input").onChange("_ctl_varfrompath_onchange").onCommand("_ctl_varfrompath_cmd"),"var");c.tab_conf.append(xui.create("xui.UI.ComboInput").setHost(c,"ctl_adjust").setTagVar("adjustdata").setDirtyMark(false).setDock("width").setDockMargin({right:12,top:undefined,left:undefined,bottom:undefined}).setDockStretch("rearward").setLeft("1.125em").setTop("8.833333333333334em").setWidth("25.5em").setHeight("1.8333333333333333em").setLabelSize("10em").setLabelCaption("$(RAD.action.Data Adjustment)").setType("helpinput").setItems([{id:"serialize",caption:"$RAD.action.Serialize"},{id:"stringify",caption:"$RAD.action.Stringify"},{id:"unserialize",caption:"$RAD.action.Unserialize"},{id:"urlDecode",caption:"$RAD.action.urlDecode"},{id:"urlEncode",caption:"$RAD.action.urlEncode"}]).onChange("_ctl_adjust_onchange"),"var");c.tab_conf.append(xui.create("xui.UI.ComboInput").setHost(c,"log_v1").setDirtyMark(false).setDock("width").setDockMargin({right:12}).setDockStretch("rearward").setLeft("1.25em").setTop("1.0833333333333333em").setWidth("24.583333333333332em").setZIndex(1002).setLabelSize("6.666666666666667em").setLabelCaption("$(RAD.action.Parameter) 1").setType("input").onChange("_log_v1_onchange").onCommand("_ctl_varfrom_cmd"),"log");c.tab_conf.append(xui.create("xui.UI.ComboInput").setHost(c,"log_v2").setDirtyMark(false).setDock("width").setDockMargin({right:12}).setDockStretch("rearward").setLeft("1.25em").setTop("3.6666666666666665em").setWidth("24.583333333333332em").setZIndex(1002).setLabelSize("6.666666666666667em").setLabelCaption("$(RAD.action.Parameter) 2").setType("input").onChange("_log_v2_onchange").onCommand("_ctl_varfrom_cmd"),"log");c.tab_conf.append(xui.create("xui.UI.ComboInput").setHost(c,"log_v3").setDirtyMark(false).setDock("width").setDockMargin({right:12}).setDockStretch("rearward").setLeft("1.25em").setTop("6.166666666666667em").setWidth("24.583333333333332em").setZIndex(1002).setLabelSize("6.666666666666667em").setLabelCaption("$(RAD.action.Parameter) 3").setType("input").onChange("_log_v3_onchange").onCommand("_ctl_varfrom_cmd"),"log");c.tab_conf.append(xui.create("xui.UI.ComboInput").setHost(c,"log_v4").setDirtyMark(false).setDock("width").setDockMargin({right:12}).setDockStretch("rearward").setLeft("1.25em").setTop("8.666666666666666em").setWidth("24.583333333333332em").setZIndex(1002).setLabelSize("6.666666666666667em").setLabelCaption("$(RAD.action.Parameter) 4").setType("input").onChange("_log_v4_onchange").onCommand("_ctl_varfrom_cmd"),"log");c.tab_conf.append(xui.create("xui.UI.ComboInput").setHost(c,"log_v5").setDirtyMark(false).setDock("width").setDockMargin({right:12}).setDockStretch("rearward").setLeft("1.25em").setTop("11.166666666666666em").setWidth("24.583333333333332em").setZIndex(1002).setLabelSize("6.666666666666667em").setLabelCaption("$(RAD.action.Parameter)  5").setType("input").onChange("_log_v5_onchange"),"log");c.tab_conf.append(xui.create("xui.UI.Block").setHost(c,"ctl_group13").setDock("fill").setDockMargin({left:6,top:54,right:4,bottom:4}).setBorderType("flat").setOverflow("hidden"),"callcb");c.ctl_group13.append(xui.create("xui.UI.TreeGrid").setHost(c,"grid_params").setDirtyMark(false).setRowHandler(false).setColSortable(false).setHeader([{id:"key",caption:"$RAD.action.Parameter",width:"14em",type:"label"},{id:"value",caption:"$RAD.action.Value",width:"10em",type:"input",editable:true,flexSize:true,editMode:"inline"}]).setTreeMode("none").afterCellUpdated("_grid_params_aftercellupdated").onBeginEdit("_grid_params_onbe"));c.tab_conf.append(xui.create("xui.UI.Input").setHost(c,"cb_callid").setTagVar("callback").setDirtyMark(false).setDock("width").setDockMargin({left:6,top:0,right:4,bottom:0}).setTop("0.375em").setHeight("3.6666666666666665em").setZIndex(1002).setLabelSize("1.8333333333333333em").setLabelPos("top").setLabelCaption("$(RAD.action.Function Expression, or Global Reference Key)").setLabelHAlign("left").onChange("_cb_callid_onchange"),"callcb");c.tab_conf.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel55").setLeft("1.75em").setTop("0.9375em").setCaption("$(RAD.action.No configuration items)").setHAlign("left"),"none");c.tab_conf.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel56").setLeft("1.75em").setTop("0.9375em").setCaption("$(RAD.action.msg.Notice: The local file object will be set to {temp$.okData})").setHAlign("left"),"selfile");c.tab_conf.append(xui.create("xui.UI.Input").setHost(c,"cb_setid").setTagVar("none").setDirtyMark(false).setDock("width").setDockMargin({right:12,top:undefined,left:undefined,bottom:undefined}).setDockStretch("rearward").setLeft("1.25em").setTop("0.625em").setWidth("25.416666666666668em").setHeight("3.75em").setZIndex(1002).setLabelSize("1.8333333333333333em").setLabelPos("top").setLabelCaption("$(RAD.action.Global Reference Key)").setLabelHAlign("left").onChange("_cb_setid_onchange"),"setcb");c.tab_conf.append(xui.create("xui.UI.Input").setHost(c,"cb_setvalue").setTagVar("callback").setDirtyMark(false).setDock("width").setDockMargin({right:12,top:undefined,left:undefined,bottom:undefined}).setDockStretch("rearward").setLeft("1.25em").setTop("4.333333333333333em").setWidth("25.416666666666668em").setHeight("3.6666666666666665em").setZIndex(1002).setLabelSize("1.8333333333333333em").setLabelPos("top").setLabelCaption("$(RAD.action.Target Function Expression)").setLabelHAlign("left").onChange("_cb_setvalue_onchange"),"setcb");c.tab_conf.append(xui.create("xui.UI.Block").setHost(c,"xui_block_mix").setDock("bottom").setHeight("2.5833333333333335em").setOverflow("hidden"),"mix");c.xui_block_mix.append(xui.create("xui.UI.Input").setHost(c,"tb_mixsub").setDirtyMark(false).setDock("width").setDockMargin({right:12,top:undefined,left:undefined,bottom:undefined}).setDockStretch("rearward").setLeft("0.75em").setTop("0.25em").setWidth("25em").setLabelSize("10em").setLabelCaption("$(RAD.action.Selected Node) :").onChange("_tb_mixsub_onchange"));c.ctl_layout11.append(xui.create("xui.UI.Block").setHost(c,"ctl_block37").setTop("0.6666666666666666em").setWidth("8.166666666666666em").setHeight("8.416666666666666em").setRight("0em").setBorderType("none").setBackground("transparent").setOverflow("hidden"),"main");c.ctl_block37.append(xui.create("xui.UI.Button").setHost(c,"ctl_button23").setLeft("0.625em").setTop("5.166666666666667em").setWidth("6.833333333333333em").setHeight("2.5em").setImageClass("spafont spa-icon-cancel").setCaption("$RAD.cancel").onClick("_btncancel_onclick"));c.ctl_block37.append(xui.create("xui.UI.Button").setHost(c,"btn_ok").setDefaultFocus(true).setLeft("0.6875em").setTop("0.9166666666666666em").setWidth("6.833333333333333em").setHeight("2.5em").setImageClass("spafont spa-icon-ok").setCaption("$RAD.ok").onClick("_btnonok_onclick"));a(xui.create("xui.UI.Block").setHost(c,"blk_float").setLeft("0em").setTop("31.25em").setWidth("40em").setHeight("20em").setZIndex(1002).setVisibility("visible").setShadow(true).setResizer(true).setBorderType("flat"));c.blk_float.append(xui.create("xui.UI.TreeView").setHost(c,"tv_var").setAnimCollapse(false).setSingleOpen(true).onChange("_tv_var_onchange").onClick("_tv_var_onclick").onCmd("_tv_fun_opt").onGetContent("_tv_var_ongetcontent").onItemSelected("_tv_var_onsel"));c.blk_float.append(xui.create("xui.UI.Icon").setHost(c,"xui_ui_icon1").setTop("0em").setRight("0em").setImageClass("xui-uicmd-close").setIconFontSize("2em").setCustomStyle({KEY:{margin:0}}).onClick("_xui_closefloat"));a(xui.create("xui.UI.Block").setHost(c,"blk_float2").setLeft("25.625em").setTop("31.25em").setWidth("40em").setHeight("20em").setVisibility("visible").setShadow(true).setResizer(true).setBorderType("flat"));c.blk_float2.append(xui.create("xui.UI.TreeView").setHost(c,"tv_fun").setAnimCollapse(false).setSingleOpen(true).onChange("_tv_var_onchange").onClick("_tv_var_onclick").onCmd("_tv_fun_opt").onGetContent("_tv_fun_ongetcontent").onItemSelected("_tv_var_onsel"));c.blk_float2.append(xui.create("xui.UI.Icon").setHost(c,"xui_ui_icon2").setTop("0em").setRight("0em").setImageClass("xui-uicmd-close").setIconFontSize("2em").setCustomStyle({KEY:{margin:0}}).onClick("_xui_closefloat"));return b},_treebarprj_onGetContent:function(a,b,c){buildComponent=function(d){xui.arr.each(d,function(e){if(e.sub){e.sub=buildComponent(e.sub)}if(e.key&&CONF.mapWidgets[e.key]){var f=CONF.mapWidgets[e.key];e.imageClass=CONF.mapWidgets[e.key].imageClass}});return d};if(b.id=="group:pages"){xui.Ajax(CONF.getAllClasses,{projectName:b.projectName?b.projectName:SPA.curProjectName,className:SPA.currentClassName,draggable:"false"},function(d){var f=d;if(!f||f.error){xui.message("No module in this project!");c(false)}else{var e=[];xui.arr.each(f.data,function(l,j){var g=[];if(l.sub&&xui.isArr(l.sub)){xui.arr.each(l.sub,function(m){if(m.id!=SPA.currentClassName){g.push(m)}})}e.push({id:l.id,cls:l.cls,key:"jds.localModule",path:l.location,draggable:false,sub:g,projectName:l.projectName,imageClass:"fa fa-th-large",name:l.caption,iniProp:l.iniProp,caption:l.className})});c(e)}},function(d){c(false)},0,{asy:false}).start()}else{xui.Ajax(CONF.getAllComponentsByClass,{className:b.className,draggable:"false",projectName:b.projectName?b.projectName:SPA.curProjectName},function(d){var f=d;if(f&&!f.error){var e={sub:buildComponent(f.data)};c(e.sub)}else{xui.message(xui.get(f,["error","errdes"])||f||"no response!")}},function(d){c(false)},0,{asy:true}).start()}},_buildsubtree:function(e){if(!e["0"]){if(e.key&&e.key!="xui.Module"){var c=xui.create(e.key).setAlias(e.alias).setProperties(e.properties);e["0"]=c.n0;e._type="control"}else{if(e.className&&e.className!=SPA.currentClassName){e._type="otherModuleCall"}else{if(e.id&&e.id==SPA.currentClassName){e._type="page"}}}}var a,b={imageClass:"spafont spa-icon-action2",className:e.className},g=this.CAPMAP.action;switch(e._type){case"none":a=[{id:"none",caption:"$RAD.action."+g.none,imageClass:"xui-icon-none",cat:"none"}];break;case"control":if(e["0"].key=="xui.MQTT"){a=[{id:"none",caption:"$RAD.action."+g.none,imageClass:"xui-icon-none",cat:"none"},{id:"setProperties",cat:"prop",caption:"$(RAD.action."+g.setProperties+")"},{id:"connect",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.connect()}",caption:"$(RAD.action."+g.connect+")","0":e["0"]},{id:"disconnect",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.disconnect()}",caption:"$(RAD.action."+g.disconnect+")","0":e["0"]},{id:"subscribe",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.subscribe()}",caption:"$(RAD.action."+g.subscribe+")","0":e["0"]},{id:"unsubscribe",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.unsubscribe()}",caption:"$(RAD.action."+g.unsubscribe+")","0":e["0"]},{id:"publish",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.publish()}",caption:"$(RAD.action."+g.publish+")","0":e["0"]},{type:"split"},{id:"destroy",cat:"none",caption:"$(RAD.action."+g.destroy+")"}]}else{if(e["0"].key=="xui.APICaller"){a=[{id:"none",caption:"$RAD.action."+g.none,imageClass:"xui-icon-none",cat:"none"},{id:"setProperties",cat:"prop",caption:"$(RAD.action."+g.setProperties+")"},{id:"setQueryData",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.setQueryData()}",caption:"$(RAD.action."+g.setQueryData+")"},{id:"invoke",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.invoke()}",caption:"$(RAD.action."+g.invoke+")"},{type:"split"},{id:"destroy",cat:"none",caption:"$(RAD.action."+g.destroy+")"}]}else{if(e["0"].key=="xui.DataBinder"){a=[{id:"none",caption:"$RAD.action."+g.none,imageClass:"xui-icon-none",cat:"none"},{id:"setProperties",cat:"prop",caption:"$(RAD.action."+g.setProperties+")"},{id:"updateValue",cat:"none",caption:"$(RAD.action."+g.updateValue+")"},{id:"resetValue",cat:"none",caption:"$(RAD.action."+g.resetValue+")"},{id:"clearValue",cat:"none",caption:"$(RAD.action."+g.clearValue+")"},{id:"updateDataFromUI",cat:"none",caption:"$(RAD.action."+g.updateDataFromUI+")"},{id:"updateDataToUI",cat:"none",caption:"$(RAD.action."+g.updateDataToUI+")"},{id:"getDirtied",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.getDirtied()}",caption:"$(RAD.action."+g.getDirtied+")","0":e["0"]},{type:"split"},{id:"checkValid",cat:"con",args:[],caption:"$(RAD.action."+g.checkValid+")","0":e[0]},{id:"checkRequired",cat:"con",args:[],caption:"$(RAD.action."+g.checkRequired+")","0":e[0]},{id:"isDirtied",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.isDirtied()}",caption:"$(RAD.action."+g.isDirtied+")","0":e["0"]},{id:"getData",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.getData()}",caption:"$(RAD.action."+g.getDate+")","0":e["0"]},{id:"setData",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.setData()}",caption:"$(RAD.action."+g.setData+")","0":e["0"]},{type:"split"},{id:"destroy",cat:"none",caption:"$(RAD.action."+g.destroy+")"}]}else{if(e["0"].key=="xui.UI.CSSBox"){a=[{id:"none",caption:"$RAD.action."+g.none,imageClass:"xui-icon-none",cat:"none"},{id:"destroy",cat:"none",caption:"$(RAD.action."+g.destroy+")"}]}else{if(e["0"].key=="xui.AnimBinder"){a=[{id:"none",caption:"$RAD.action."+g.none,imageClass:"xui-icon-none",cat:"none"},{id:"setProperties",cat:"prop",caption:"$(RAD.action."+g.setProperties+")"},{id:"apply",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.apply()}",caption:"$(RAD.action."+g["anim apply"]+")","0":e["0"]},{type:"split"},{id:"destroy",cat:"none",caption:"$(RAD.action."+g.destroy+")"}]}else{if(e["0"].box["xui.UI.Audio"]){a=[{id:"none",caption:"$RAD.action."+g.none,imageClass:"xui-icon-none",cat:"none"},{id:"setProperties",cat:"prop",caption:"$(RAD.action."+g.setProperties+")"},{type:"split"},{id:"busy",cat:"none",args:[],caption:"$(RAD.action."+g.busy+")"},{id:"free",cat:"none",args:[],caption:"$(RAD.action."+g.free+")"},{type:"split"},{id:"setSrc",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.setSrc()}",caption:"$(RAD.action."+g.setSrc+")"},{id:"play",cat:"none",caption:"$(RAD.action."+g.play+")"},{id:"pause",cat:"none",caption:"$(RAD.action."+g.pause+")"},{type:"split"},{id:"destroy",cat:"none",caption:"$(RAD.action."+g.destroy+")"}]}else{if(e["0"].box["xui.UI.FileUpload"]){a=[{id:"none",caption:"$RAD.action."+g.none,imageClass:"xui-icon-none",cat:"none"},{id:"setProperties",cat:"prop",caption:"$(RAD.action."+g.setProperties+")"},{id:"setUploadUrl",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.setUploadUrl()}",caption:"$RAD.action.esd.setUploadUrl"},{id:"setQueryData",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.setQueryData()}",caption:"$RAD.action.esd.setQueryData"},{type:"split"},{id:"destroy",cat:"none",caption:"$(RAD.action."+g.destroy+")"}]}else{if(e["0"].key=="xui.Timer"){a=[{id:"none",caption:"$RAD.action."+g.none,imageClass:"xui-icon-none",cat:"none"},{id:"setProperties",cat:"prop",caption:"$(RAD.action."+g.setProperties+")"},{id:"start",cat:"none",caption:"$(RAD.action."+g.start+")"},{id:"suspend",cat:"none",caption:"$(RAD.action."+g.suspend+")"},{type:"split"},{id:"destroy",cat:"none",caption:"$(RAD.action."+g.destroy+")"}]}else{if(e["0"].key=="xui.MessageService"){a=[{id:"none",caption:"$RAD.action."+g.none,imageClass:"xui-icon-none",cat:"none"},{id:"setProperties",cat:"prop",caption:"$(RAD.action."+g.setProperties+")"},{id:"broadcast",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.broadcast()}",caption:"$(RAD.action."+g.broadcast+")","0":e["0"]},{type:"split"},{id:"destroy",cat:"none",caption:"$(RAD.action."+g.destroy+")"}]}else{a=[{id:"none",caption:"$RAD.action."+g.none,imageClass:"xui-icon-none",cat:"none"},{id:"animate",caption:"$RAD.action."+g.animate,cat:"animate"}];var f=e["0"];if(f.boxing().activate){a.push({id:"activate",cat:"none",caption:"$(RAD.action."+g.activate+")"})}a.push({type:"split"});Array.prototype.push.apply(a,[{id:"setProperties",cat:"prop",caption:"$(RAD.action."+g.setProperties+")"},{id:"popUp",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.popUp()}",caption:"$(RAD.action."+g.popUp+")","0":e["0"]},{id:"disable",cat:"none",caption:"$(RAD.action."+g.disable+")"},{id:"enable",cat:"none",caption:"$(RAD.action."+g.enable+")"},{id:"show",cat:"con",caption:"$(RAD.action."+g.show+")"},{id:"hide",cat:"none",caption:"$(RAD.action."+g.hide+")"}]);if(f.box["xui.UI.FusionChartsXT"]){a.push({type:"split"});a.push({id:"getJSONData",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.getJSONData()}",caption:"$(RAD.action."+g.getJSONData+")","0":e["0"]});a.push({id:"setJSONData",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.setJSONData()}",caption:"$(RAD.action."+g.setJSONData+")","0":e["0"]});a.push({id:"getXMLData",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.getXMLData()}",caption:"$(RAD.action."+g.getXMLData+")","0":e["0"]});a.push({id:"setXMLData",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.setXMLData()}",caption:"$(RAD.action."+g.setXMLData+")","0":e["0"]});a.push({id:"updateData",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.updateData()}",caption:"$(RAD.action."+g.updateData+")","0":e["0"]});a.push({id:"fillData",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.fillData()}",caption:"$(RAD.action."+g.fillData+")","0":e["0"]});a.push({id:"setTheme",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.setTheme()}",caption:"$(RAD.action."+g.setTheme+")","0":e["0"]});a.push({id:"refreshChart",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.refreshChart()}",caption:"$(RAD.action."+g.refreshChart+")","0":e["0"]})}if(f.box["xui.absValue"]){a.push({type:"split"});a.push({id:"getUIValue",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.getUIValue()}",caption:"$(RAD.action."+g.getUIValue+")","0":e["0"]});a.push({id:"setUIValue",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.setUIValue()}",caption:"$(RAD.action."+g.setUIValue+")","0":e["0"]})}if(f.boxing().setCaption&&("caption" in f.properties)){a.push({id:"setCaption",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.setCaption()}",caption:"$(RAD.action."+g.setCaption+")","0":e["0"]})}if(f.boxing().hideItems){a.push({id:"hideItems",cat:"con",caption:"$(RAD.action."+g.hideItems+")","0":e["0"]});a.push({id:"showItems",cat:"con",caption:"$(RAD.action."+g.showItems+")","0":e["0"]})}if(f.behavior&&f.behavior.PanelKeys&&f.behavior.PanelKeys.length){a.push({type:"split"});a.push({id:"busy",cat:"none",args:[],caption:"$(RAD.action."+g.busy+")"});a.push({id:"free",cat:"none",args:[],caption:"$(RAD.action."+g.free+")"});a.push({type:"split"});a.push({id:"setFormValues",cat:"mix",args:[],caption:"$(RAD.action."+g.setFormValues+")","0":e[0]});a.push({id:"checkValid",cat:"con",args:[],caption:"$(RAD.action."+g.checkValid+")","0":e[0]});a.push({id:"checkRequired",cat:"con",args:[],caption:"$(RAD.action."+g.checkRequired+")","0":e[0]});a.push({id:"isDirtied",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.isDirtied()}",caption:"$(RAD.action."+g.isDirtied+")","0":e["0"]});a.push({id:"getFormValues",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.getFormValues()}",caption:"$(RAD.action."+g.getFormValues+")","0":e["0"]});a.push({id:"formSubmit",cat:"con",args:[],caption:"$(RAD.action."+g.formSubmit+")","0":e[0]});a.push({id:"setChildren",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.setChildren()}",caption:"动态装载组件","0":e[0]});a.push({id:"formReset",cat:"con",args:[],caption:"$(RAD.action."+g.formReset+")","0":e[0]});a.push({id:"updateFormValues",cat:"con",args:[],caption:"$(RAD.action."+g.updateFormValues+")","0":e[0]});a.push({id:"formClear",cat:"con",args:[],caption:"$(RAD.action."+g.formClear+")","0":e[0]})}if(f.boxing().fireClickEvent){a.push({type:"split"});a.push({id:"fireClickEvent",cat:"none",caption:"$(RAD.action."+g.fireClickEvent+")"})}if(f.boxing().fireItemClickEvent){a.push({type:"split"});a.push({id:"fireItemClickEvent",cat:"con",caption:"$(RAD.action."+g.fireItemClickEvent+")","0":e["0"]})}if(f.boxing().dumpContainer){a.push({id:"dumpContainer",cat:"con",caption:"$(RAD.action."+g.dumpContainer+")","0":e["0"]})}if("toggle" in f.properties){a.push({type:"split"});a.push({id:"setToggle",cat:"con",_toggle:true,caption:"$(RAD.action."+g.setToggle+")"})}else{if(f.box["xui.UI.Dialog"]){a.push({type:"split"});a.push({id:"close",cat:"none",caption:"$(RAD.action."+g.close2+")"});a.push({id:"showModal",cat:"none",caption:"$(RAD.action."+g.showModal+")"})}else{if(f.box["xui.UI.PageBar"]){a.push({type:"split"});a.push({id:"getPage",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.getPage()}",caption:"$(RAD.action."+g.getPage+")","0":e["0"]});a.push({id:"getTotalPages",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.getTotalPages()}",caption:"$(RAD.action."+g.getTotalPages+")","0":e["0"]});a.push({id:"buindAPI",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.buindAPI()}",caption:"$(RAD.action.esd.buindAPI)","0":e["0"]});a.push({id:"setPage",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.setPage()}",caption:"$(RAD.action."+g.setPage+")","0":e["0"]});a.push({id:"setTotalCount",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.setTotalCount()}",caption:"$(RAD.action."+g.setTotalCount+")","0":e["0"]})}else{if(f.box["xui.UI.TreeBar"]){a.push({type:"split"});a.push({id:"toggleNode",cat:"con",_toggle:true,hassub:1,caption:"$(RAD.action."+g.toggleNode+")","0":e["0"]})}}}}if((f.properties.items&&!f.box["xui.UI.ComboInput"])||((f.properties.type=="helpinput"||f.properties.type=="combobox"||f.properties.type=="listbox")&&f.box["xui.UI.ComboInput"])){a.push({type:"split"});if(!f.box["xui.UI.ComboInput"]){if(f.boxing().setValue){a.push({id:"setValue",cat:"con",caption:"$(RAD.action."+g.activeItem+")","0":e["0"]})}}if(f.key!="xui.UI.ToolBar"&&f.key!="xui.UI.Layout"){a.push({id:"insertItems",cat:"mix",caption:"$(RAD.action."+g.insertItems+")","0":e["0"]})}a.push({id:"updateItem",cat:"mix",caption:"$(RAD.action."+g.updateItem+")","0":e["0"]});if(f.key!="xui.UI.ToolBar"&&f.key!="xui.UI.Layout"){a.push({id:"removeItems",cat:"con",caption:"$(RAD.action."+g.removeItems+")","0":e["0"]})}a.push({id:"clearItems",cat:"none",caption:"$(RAD.action."+g.clearItems+")"})}else{if(f.box["xui.UI.TreeGrid"]){a.push({type:"split"});a.push({id:"isDirtied",cat:"none",caption:"$(RAD.action."+g.isDirtied+")","0":e["0"]});a.push({id:"updateGridValue",cat:"none",caption:"$(RAD.action."+g.updateGridValue+")","0":e["0"]});a.push({id:"toggleRow",cat:"con",_toggle:true,hassub:1,caption:"$(RAD.action."+g.toggleRow+")","0":e["0"]});a.push({id:"triggerFormulas",cat:"none",caption:"$(RAD.action."+g.triggerFormulas+")"});a.push({type:"split"});a.push({id:"isCellDirtied",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.isCellDirtied()}",caption:"$(RAD.action."+g.isCellDirtied+")","0":e["0"]});a.push({id:"updateCellValue",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.updateCellValue()}",caption:"$(RAD.action."+g.updateCellValue+")","0":e["0"]});a.push({id:"focusCellbyRowCol",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.focusCellbyRowCol()}",caption:"$(RAD.action."+g.focusCellbyRowCol+")","0":e["0"]});a.push({id:"getCellbyRowCol",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.getCellbyRowCol()}",caption:"$(RAD.action."+g.getCellbyRowCol+")","0":e["0"]});a.push({id:"getActiveCell",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.getActiveCell()}",caption:"$(RAD.action."+g.getActiveCell+")","0":e["0"]});a.push({id:"setActiveCell",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.setActiveCell()}",caption:"$(RAD.action."+g.setActiveCell+")","0":e["0"]});a.push({id:"updateCellByRowCol2",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.updateCellByRowCol2()}",caption:"$(RAD.action."+g.updateCellByRowCol2+")","0":e["0"]});a.push({id:"updateCellValue",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.updateCellValue()}",caption:"$(RAD.action."+g.updateCellValue+")","0":e["0"]});a.push({id:"resetCellValue",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.resetCellValue()}",caption:"$(RAD.action."+g.resetCellValue+")","0":e["0"]});a.push({type:"split"});a.push({id:"isRowDirtied",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.isRowDirtied()}",caption:"$(RAD.action."+g.isRowDirtied+")","0":e["0"]});a.push({id:"updateRowValue",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.updateRowValue()}",caption:"$(RAD.action."+g.updateRowValue+")","0":e["0"]});a.push({id:"editCellbyRowCol",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.editCellbyRowCol()}",caption:"$(RAD.action."+g.editCellbyRowCol+")","0":e["0"]});a.push({id:"getEditor",cat:"none",caption:"$(RAD.action."+g.getEditor+")","0":e["0"]});a.push({id:"getEditCell",cat:"none",caption:"$(RAD.action."+g.getEditCell+")"});a.push({id:"updateEditor",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.updateEditor()}",caption:"$(RAD.action."+g.updateEditor+")","0":e["0"]});a.push({id:"offEditor",cat:"none",caption:"$(RAD.action."+g.offEditor+")","0":e["0"]});a.push({type:"split"});a.push({id:"getRowbyCell",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.getRowbyCell()}",caption:"$(RAD.action."+g.getRowbyCell+")","0":e["0"]});a.push({id:"getActiveRow",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.getActiveRow()}",caption:"$(RAD.action."+g.getActiveRow+")","0":e["0"]});a.push({id:"autoRowHeight",cat:"none",caption:"$(RAD.action."+g.autoRowHeight+")","0":e["0"]});a.push({id:"setActiveRow",cat:"mix",caption:"$(RAD.action."+g.setActiveRow+")","0":e["0"]});a.push({id:"getRawData",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.getRawData()}",caption:"$(RAD.action."+g.getRawData+")","0":e["0"]});a.push({id:"setRawData",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.setRawData()}",caption:"$(RAD.action."+g.setRawData+")","0":e["0"]});a.push({id:"insertRows",cat:"mix",caption:"$(RAD.action."+g.insertRows+")","0":e["0"]});a.push({id:"updateRow",cat:"mix",caption:"$(RAD.action."+g.updateRow+")","0":e["0"]});a.push({id:"setRowMap",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.setRowMap()}",caption:"$(RAD.action."+g.setRowMap+")","0":e["0"]});a.push({id:"getRowMap",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.getRowMap()}",caption:"$(RAD.action."+g.getRowMap+")","0":e["0"]});a.push({id:"getHotRow",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.getHotRow()}",caption:"$(RAD.action."+g.getHotRow+")","0":e["0"]});a.push({id:"updateHotRow",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.updateHotRow()}",caption:"$(RAD.action."+g.updateHotRow+")","0":e["0"]});a.push({id:"removeRows",cat:"con",caption:"$(RAD.action."+g.removeRows+")","0":e["0"]});a.push({id:"removeAllRows",cat:"none",caption:"$(RAD.action."+g.removeAllRows+")"});a.push({type:"split"});a.push({id:"getHeaderByCell",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.getHeaderByCell()}",caption:"$(RAD.action."+g.getHeaderByCell+")","0":e["0"]});a.push({id:"sortColumn",cat:"mix",caption:"$(RAD.action."+g.sortColumn+")","0":e["0"]});a.push({id:"showColumn",cat:"mix",caption:"$(RAD.action."+g.showColumn+")","0":e["0"]});a.push({id:"updateHeader",cat:"mix",caption:"$(RAD.action."+g.updateHeader+")","0":e["0"]});a.push({id:"removeCols",cat:"mix",caption:"$(RAD.action."+g.removeCols+")","0":e["0"]});a.push({id:"setHeader",cat:"none",caption:"$(RAD.action."+g.setHeader+")"})}}if(f.boxing().editItem){a.push({id:"editItem",cat:"con",caption:"$(RAD.action."+g.editItem+")","0":e["0"]})}a.push({type:"split"},{id:"destroy",cat:"none",caption:"$(RAD.action."+g.destroy+")"})}}}}}}}}}break;case"other":if(e.id=="other:url"){a=[{id:"none",caption:"$RAD.action."+g.none,imageClass:"xui-icon-none",cat:"none"},{id:"showModule2",caption:"$RAD.action.esd.showModule2",redirection:"other:callback:call",_tpl:"{xui.showModule2()}",cat:"callcb",},{id:"close",cat:"none",caption:"$(RAD.action."+g.close+")"},{id:"open----_self",cat:"url",caption:"$(RAD.action."+g["open----_self"]+")"},{id:"open----_blank",cat:"url",caption:"$(RAD.action."+g["open----_blank"]+")"},{id:"mailTo",cat:"url",caption:"$(RAD.action."+g.mailTo+")"},{type:"split"},{id:"selectFile",cat:"selfile",caption:"$(RAD.action."+g.selectFile+")"},{id:"readText",cat:"datatransfer",caption:"$(RAD.action."+g.readText+")"},{id:"readJSON",cat:"datatransfer",caption:"$(RAD.action."+g.readJSON+")"}]}else{if(e.id=="other:var"){a=[{id:"none",caption:"$RAD.action."+g.none,imageClass:"xui-icon-none",cat:"none"},{id:"temp",cat:"var",args:[],caption:"$(RAD.action."+g.temp+")"},{id:"global",cat:"var",args:[],caption:"$(RAD.action."+g.global+")"},{id:"page",cat:"var",args:[],caption:"$(RAD.action."+g.page+")"},{id:"page.properties",cat:"var",args:[],caption:"$(RAD.action."+g["page.properties"]+")"}]}else{if(e.id=="other:callback"){a=[{id:"none",caption:"$RAD.action."+g.none,imageClass:"xui-icon-none",cat:"none"},{id:"call",cat:"callcb",args:[],caption:"$(RAD.action."+g.call+")"},{id:"set",cat:"setcb",args:[],caption:"$(RAD.action."+g.set+")"},{id:"xxx",type:"split"},{id:"setCookies",cat:"json",caption:"$(RAD.action."+g.setCookies+")"},{id:"setFI",cat:"json",caption:"$(RAD.action."+g.setFI+")"}]}else{if(e.id=="other:msg"){a=[{id:"none",caption:"$RAD.action."+g.none,imageClass:"xui-icon-none",cat:"none"},{id:"log",cat:"log",caption:"$(RAD.action."+g.log+")"},{id:"echo",cat:"log",caption:"$(RAD.action."+g.echo+")"},{type:"split"},{id:"message",cat:"fmsg",args:[],caption:"$(RAD.action."+g.message+")"},{id:"pop",cat:"msg",args:[],caption:"$(RAD.action."+g.pop+")"},{id:"alert",cat:"msg",args:[],caption:"$(RAD.action."+g.alert+")"},{id:"confirm",cat:"msg",args:[],caption:"$(RAD.action."+g.confirm+")"},{id:"prompt",cat:"msg",args:[],caption:"$(RAD.action."+g.prompt+")"},{type:"split"},{id:"busy",cat:"none",args:[],caption:"$(RAD.action."+g.busy+")"},{id:"free",cat:"none",args:[],caption:"$(RAD.action."+g.free+")"}]}}}}break;case"module":a=[{id:"popUp",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.popUp()}",caption:"$(RAD.action."+g.popUp+")"},{id:"show",cat:"con",caption:"$(RAD.action."+g.show+")"},{id:"hide",cat:"none",caption:"$(RAD.action."+g.hide+")"},{type:"split"},{id:"postMessage",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.postMessage()}",caption:"$(RAD.action."+g.postMessage+")"},{id:"setHooks",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.setHooks()}",caption:"$(RAD.action."+g.setHooks+")"},{id:"notifyHooks",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.notifyHooks()}",caption:"$(RAD.action."+g.notifyHooks+")"},{id:"callFunction",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.callFunction()}",caption:"$(RAD.action."+g.callFunction+")"},{id:"fireEvent",cat:"callcb",redirection:"other:callback:call",_tpl:"{page.*.fireEvent()}",caption:"$(RAD.action."+g.fireEvent+")"},{type:"split"},{id:"setProperties",cat:"json",caption:"$(RAD.action."+g.setProperties+")"},{id:"setProfiles",cat:"data",caption:"$(RAD.action."+g.setProfiles+")"},{id:"initData",cat:"none",caption:"$(RAD.action.esd.initData)"},{id:"reloadParent",cat:"none",caption:"$(RAD.action.esd.reloadParent)"},{id:"setData",cat:"data",caption:"$(RAD.action."+g.setData+")"},{id:"setValue",cat:"data",caption:"$(RAD.action."+g.setValue+")"},{id:"destroy",cat:"none",caption:"$(RAD.action."+g.destroy+")"}];a.unshift({id:"none",caption:"$RAD.action."+g.none,imageClass:"xui-icon-none",cat:"none"});break;case"otherModuleCall":a=[{id:"open",cat:"none",caption:"$(RAD.action."+g.open+")"},{id:"show2",cat:"callcb",redirection:"page",_tpl:"{page.show2()}",caption:"$(RAD.action."+g.show2+")"},{id:"initData",cat:"callcb",redirection:"page",_tpl:"{page.initData()}",caption:"$(RAD.action.esd.initData)"},{id:"popUp",cat:"callcb",redirection:"page::",_tpl:"{page.popUp()}",caption:"$(RAD.action."+g.popUp+")"},{id:"show",cat:"con",caption:"$(RAD.action."+g.show+")"},{id:"hide",cat:"none",caption:"$(RAD.action."+g.hide+")"},{id:"destroy",cat:"none",caption:"$(RAD.action."+g.destroy+")"},{type:"split"},{id:"postMessage",cat:"callcb",redirection:"page::",_tpl:"{page.postMessage()}",caption:"$(RAD.action."+g.postMessage+")"},{id:"setHooks",cat:"callcb",redirection:"page::",_tpl:"{page.setHooks()}",caption:"$(RAD.action."+g.setHooks+")"},{id:"notifyHooks",cat:"callcb",redirection:"page::",_tpl:"{page.notifyHooks()}",caption:"$(RAD.action."+g.notifyHooks+")"},{id:"callFunction",cat:"callcb",caption:"$(RAD.action."+g.callFunction+")"},{id:"fireEvent",cat:"callcb",redirection:"page::",_tpl:"{page.fireEvent()}",caption:"$(RAD.action."+g.fireEvent+")"},{type:"split"},{id:"setProperties",cat:"json",caption:"$(RAD.action."+g.setProperties+")"},{id:"setProfiles",cat:"data",caption:"$(RAD.action."+g.setProfiles+")"},{id:"setData",cat:"data",caption:"$(RAD.action."+g.setData+")"},{id:"setValue",cat:"data",caption:"$(RAD.action."+g.setValue+")"}];if(SPA.currentPage==e.id){a.shift()}a.unshift({id:"none",caption:"$RAD.action."+g.none,imageClass:"xui-icon-none",cat:"none"});break;case"page":a=[{id:"open",cat:"none",caption:"$(RAD.action."+g.open+")"},{id:"checkValid",cat:"callcb",redirection:"page",_tpl:"{page.checkValid()}",caption:"验证数据"},{id:"show2",cat:"callcb",redirection:"page",_tpl:"{page.show2()}",caption:"$(RAD.action."+g.show2+")"},{id:"initData",cat:"callcb",redirection:"page",_tpl:"{page.initData()}",caption:"$(RAD.action.esd.initData)"},{id:"reloadParent",cat:"callcb",redirection:"page",_tpl:"{page.reloadParent()}",caption:"$(RAD.action.esd.reloadParent)"},{id:"popUp",cat:"callcb",redirection:"page::",_tpl:"{page.popUp()}",caption:"$(RAD.action."+g.popUp+")"},{id:"show",cat:"con",caption:"$(RAD.action."+g.show+")"},{id:"hide",cat:"none",caption:"$(RAD.action."+g.hide+")"},{id:"destroy",cat:"none",caption:"$(RAD.action."+g.destroy+")"},{type:"split"},{id:"postMessage",cat:"callcb",redirection:"page::",_tpl:"{page.postMessage()}",caption:"$(RAD.action."+g.postMessage+")"},{id:"setHooks",cat:"callcb",redirection:"page::",_tpl:"{page.setHooks()}",caption:"$(RAD.action."+g.setHooks+")"},{id:"notifyHooks",cat:"callcb",redirection:"page::",_tpl:"{page.notifyHooks()}",caption:"$(RAD.action."+g.notifyHooks+")"},{id:"callFunction",cat:"callcb",caption:"$(RAD.action."+g.callFunction+")"},{id:"fireEvent",cat:"callcb",redirection:"page::",_tpl:"{page.fireEvent()}",caption:"$(RAD.action."+g.fireEvent+")"},{type:"split"},{id:"setProperties",cat:"json",caption:"$(RAD.action."+g.setProperties+")"},{id:"setProfiles",cat:"data",caption:"$(RAD.action."+g.setProfiles+")"},{id:"setData",cat:"data",caption:"$(RAD.action."+g.setData+")"},{id:"setValue",cat:"data",caption:"$(RAD.action."+g.setValue+")"}];if(SPA.currentPage==e.id){a.shift()}a.unshift({id:"none",caption:"$RAD.action."+g.none,imageClass:"xui-icon-none",cat:"none"});break;default:}var d=xui.get(CONF,["CustomActions",e._type,e.id.split(":")[1],"items"]);if(d){xui.arr.insertAny(a,d)}xui.arr.each(a,function(j){xui.merge(j,b)});this.tb_action.setItems(a);return a},_beforeclose:function(){var a=this;a.blk_float.hide();var b=a.blk_float.getTag();if(b){b.getSubNode("INPUT").blur()}if(a._hiddenDiv){a._hiddenDiv.html("");a._hiddenDiv=null}if(a._dirty){xui.confirm(xui.getRes("RAD.notsave"),xui.getRes("RAD.notsave2"),function(){a.dialog.hide()})}else{a.dialog.hide()}return false},_tb_action_drop:function(b,f,g,a,d,c){if(d._new){b.boxing().setUIValue(d._new.id,true)}this.markDirty(1)},_tb_actions_onchange:function(e,a,b){if(!b){return}var f=this,l,c,g="none:none",j=e.getItemByItemId(b),d=j.tagVar;f._enablectrls();f._initvalue=1;f._tagVar=d;if("timeout" in d){f.spin_asy.setUIValue(parseInt(d.timeout,10)||0);f.cb_asy.setUIValue(true)}else{f.cb_asy.setUIValue(false)}if(("return" in d)&&d["return"]===false){f.cb_false.setUIValue(true)}else{f.cb_false.setUIValue(false)}if((l=d.target)){if(d.type=="none"){g="none:"+l}else{if(d.type=="page"){g=l}else{if(d.type=="other"){g="other:"+l}else{g=l}}}}f.i_conl1.setValue("",true);f.i_conr1.setValue("",true);f.ctl_symbol1.setValue("defined",true);f.i_conl2.setValue("",true);f.i_conr2.setValue("",true);f.ctl_symbol2.setValue("defined",true);f.i_conl3.setValue("",true);f.i_conr3.setValue("",true);f.ctl_symbol3.setValue("defined",true);if((l=d.conditions)){if((c=l[0])){if(c.left){f.i_conl1.setValue(c.left,true)}if(c.symbol){f.ctl_symbol1.setUIValue(c.symbol,true)}if(c.right){f.i_conr1.setValue(c.right,true)}}if((c=l[1])){if(c.left){f.i_conl2.setValue(c.left,true)}if(c.symbol){f.ctl_symbol2.setUIValue(c.symbol,true)}if(c.right){f.i_conr2.setValue(c.right,true)}}if((c=l[2])){if(c.left){f.i_conl3.setValue(c.left,true)}if(c.symbol){f.ctl_symbol3.setUIValue(c.symbol,true)}if(c.right){f.i_conr3.setValue(c.right,true)}}}j.className=d.className;if(d.type=="page"){f.tb_cat.setUIValue(g,true)}else{if(d.className&&d.className!=SPA.currentClassName){if(f.tb_cat.getItemByItemId(g)){f.tb_cat.setUIValue(g)}else{xui.getModule(d.className);f.tb_cat.toggleNode(d.className,true,true,true,function(){this.setUIValue(g)})}}else{f.tb_cat.setUIValue(f.tb_cat.getItemByItemId(g)?g:"none:none",true)}}f._initvalue=0},_tb_con_onchange:function(d,a,c){var n=this,e=n._tagVar,j=c.split(d.properties.valueSeparator),b=j[0],o=d.getItemByItemId(b);if(e){e.args=e.args||[];if(o){if(o._iscon){if(!c){return}if(o&&c!="none"){if(o.con){e.args[0]=o.con}if(o.consub){if(o.consub!="[key]"){n.tb_consub.setReadonly(true);n.tb_consub.setUIValue(o.consub,true)}else{n.tb_consub.setReadonly(false);n.tb_consub.setUIValue("",true)}}else{n.tb_consub.setUIValue("");n.tb_consub.setReadonly(true)}}}else{var m;for(var g=0,f=j.length;g<f;g++){if(j[g]=="[key]"||!d.getItemByItemId(j[g])){m=true;break}}if(!m){n.tb_consub.setReadonly(true);n.tb_consub.setUIValue(c=="[key]"?"":c,true)}else{n.tb_consub.setReadonly(false);n.tb_consub.setUIValue(c=="[key]"?"":c,true)}}}else{n.tb_consub.setUIValue("").setReadonly(true);e.args=[]}n.markDirty(1)}},_add_target_onchange:function(d,b,f,e,a){var c=this;c.tb_mixsub.setReadonly(f!=="[key]",true);c.tb_mixsub.setUIValue(f=="[key]"?"":f,true)},_tb_mixsub_onchange:function(e,b,c,d,o){var m=this,f=m._tagVar,l=m.add_pos.getUIValue(),a=m.tb_mixsub.getUIValue(),n=m.add_target.getTagVar(),g=n.hasSub,j;if(f){j=f.args=f.args||[];if(n.insert){if(g){switch(l){case"before":j[1]="";j[2]=a;j[3]=true;m.xui_block_mix.setDisplay("").adjustDock();break;case"after":j[1]="";j[2]=a;j[3]=false;m.xui_block_mix.setDisplay("").adjustDock();break;case"first":j[1]="";j[2]="";j[3]=true;m.tb_mixsub.setValue("",true);m.add_target.setValue("",true);m.xui_block_mix.setDisplay("none").getParent().adjustDock(true);break;case"last":j[1]="";j[2]="";j[3]=false;m.tb_mixsub.setValue("",true);m.add_target.setValue("",true);m.xui_block_mix.setDisplay("none").getParent().adjustDock(true);break;case"curbefore":j[1]="";j[2]=true;j[3]=true;m.xui_block_mix.setDisplay("none").getParent().adjustDock(true);break;case"curafter":j[1]="";j[2]=true;j[3]=false;m.xui_block_mix.setDisplay("none").getParent().adjustDock(true);break;case"subfirst":j[1]=a;j[2]="";j[3]=true;m.xui_block_mix.setDisplay("").adjustDock();break;case"sublast":j[1]=a;j[2]="";j[3]=false;m.xui_block_mix.setDisplay("").adjustDock();break;case"cursubfirst":j[1]=true;j[2]="";j[3]=true;m.xui_block_mix.setDisplay("none").getParent().adjustDock(true);break;case"cursublast":j[1]=true;j[2]="";j[3]=false;m.xui_block_mix.setDisplay("none").getParent().adjustDock(true);break}}else{switch(l){case"before":j[1]=a;j[2]=true;m.xui_block_mix.setDisplay("").adjustDock();break;case"after":j[1]=a;j[2]=false;m.xui_block_mix.setDisplay("").adjustDock();break;case"first":j[1]="";j[2]=true;m.tb_mixsub.setValue("",true);m.add_target.setValue("",true);m.xui_block_mix.setDisplay("none").getParent().adjustDock(true);break;case"last":j[1]="";j[2]=false;m.tb_mixsub.setValue("",true);m.add_target.setValue("",true);m.xui_block_mix.setDisplay("none").getParent().adjustDock(true);case"curbefore":j[1]=true;j[2]=true;m.xui_block_mix.setDisplay("none").getParent().adjustDock(true);m.tb_mixsub.setValue("",true);m.add_target.setValue("",true);break;case"curafter":j[1]=true;j[2]=false;m.xui_block_mix.setDisplay("none").getParent().adjustDock(true);m.tb_mixsub.setValue("",true);m.add_target.setValue("",true);break;break}}}else{j[0]=a}m.markDirty(1)}},_tb_consub_onchange:function(e,b,f,g,a){var d=this,c=d._tagVar,a=e.properties.tag;if(c){c.args=c.args||[];if(a=="con"){c.args[1]=f||null}else{c.args[0]=f||null}d.markDirty(1)}},_toggle_value_onchange:function(d,a,e){var c=this,b=c._tagVar;if(b){b.args=b.args||[];b.args[d.properties.tag?1:0]=e=="expand";c.markDirty(1)}},_cb_setid_onchange:function(e,b,g,f,a){var d=this,c=d._tagVar;if(c){c.args=c.args||[];c.args[0]=g;d.markDirty(1)}},_cb_setvalue_onchange:function(e,a,b,c,A){var u=this,f=u._tagVar;if(f){f.args=f.args||[];f.args[1]=b;u.markDirty(1);u.ctl_grpp.setHtml("",true);var x=b,d,s,o=u.getScope();if(/^\s*\{[\w][\w\.\s*]+[\w]\s*(\[[\d\s]+\])?(\(\s*\))?\s*\}\s*$/.test(b)){x=b.split(/\s*\.\s*/);if(x.length===1){d=b.replace(/[{}()\s]/g,"");x="{window}"}else{d=x.pop().replace(/[()}\s]/g,"");x=x.join(".")+"}"}x=xui.adjustVar(x,o);if(x&&xui.isFun(x[d])){s=1}}if(s){if(x.$key){path=x.$key;if(!x.$xuiclass$){path+=".prototype"}path+="."+d}else{path=b.replace(/[{\s}]/g,"")}var w=RAD.EditorTool.getDoc(path,false,true);var r=w&&w.$paras;if(!r&&xui.str.trim(xui.fun.body(x[d]))!="[native code]"){r=xui.fun.args(x[d])}if(r&&r.length){for(var q=0,n,g=r.length;q<g;q++){n=r[q].indexOf("[");if(n!=-1){r[q]="<strong>"+r[q].substr(0,n)+"</strong>"+r[q].substr(n,r[q].length)}}u.ctl_grpp.setHtml("<ol style='padding-left:20px;margin: 8px;line-height: 20px;'><li>"+r.join("</li><li>")+"</li></ol>",true)}}}},_cb_callid_onchange:function(e,q,j,c,C){var E=this,s=E._tagVar;if(s){if(!j){s.args=[];E.grid_params.removeAllRows();return}s.args=s.args||[];s.args[0]=j;E.markDirty(1);var n=j,a,u,d,o=E.getScope();if(/^\s*\{[\w][\w\.\s*]+[\w]\s*(\[[\d\s]+\])?(\(\s*\))?\s*\}\s*$/.test(j)){n=j.split(/\s*\.\s*/);if(n.length===1){u=j.replace(/[{}()\s]/g,"");n="{window}"}else{u=n.pop().replace(/[()}\s]/g,"");n=n.join(".")+"}"}if(s.className&&xui.getModule(s.className)){n=xui.adjustVar(a=n,{page:xui.getModule(s.className)})}else{n=xui.adjustVar(a=n,o)}if(!xui.isDefined(n)){d=xui.str.trim(xui.fun.body(u))=="[native code]"?"nvative":"external"}else{if(n&&n[u]){if(xui.isFun(n[u])){d=xui.str.trim(xui.fun.body(n[u]))=="[native code]"?"native":"function"}else{if(n[u].args&&xui.isArr(n[u].args)&&n[u].args.length){n=n[u].args;d="pusedo"}else{d="unknow"}}}}}else{s.args=[];E.grid_params.removeAllRows();return}var g=E.grid_params.getRows(),A=g.length,B=10,r;if(d=="function"){if(n.$key){r=n.$key;if(!n.$xuiclass$){r+=".prototype"}r+="."+u}else{r=j.replace(/[{\s}]/g,"")}var D=RAD.EditorTool.getDoc(r,false,true);var b=D&&D.$paras;if(!b){b=xui.fun.args(n[u])}if(b&&b.length){var f=b.length;if(A>f){for(var x=A;x>=f;x--){E.grid_params.removeRows(""+(x+3))}}else{if(A<f){for(var x=A,w=f;x<w;x++){E.grid_params.insertRows([{id:""+(x+3),cells:["",""]}])}}}for(var x=0,w=f;x<w;x++){E.grid_params.updateCellByRowCol(""+(x+3),"key",b[x],false,false)}return}}else{if(d=="pusedo"){var b=n;var f=b.length;if(A>f){for(var x=A;x>=f;x--){E.grid_params.removeRows(""+(x+3))}}else{if(A<f){for(var x=A,w=f;x<w;x++){E.grid_params.insertRows([{id:""+(x+3),cells:["",""]}])}}}for(var x=0,w=f;x<w;x++){E.grid_params.updateCellByRowCol(""+(x+3),"key",b[x].id+" : "+b[x].type+(b[x].des?", "+b[x].des:""),false,false)}return}}if(A<B){for(var x=A,w=B;x<w;x++){E.grid_params.insertRows([{id:""+(x+3),cells:["",""]}])}}for(var x=0,w=B;x<w;x++){E.grid_params.updateCellByRowCol(""+(x+3),"key"," "+xui.getRes("$RAD.action.Parameter")+" "+(x+1),false,false)}}},_cb_callreturnto_onchange:function(f,b,j,g,a){var e=this,c=e._tagVar;if(c){c.args=c.args||[];c.args[1]=j;e.markDirty(1);var d=c.args;e.conf_return_exp.setHtml(d[1]&&d[1]!="none"?"${"+(d[1]+".")+(d[2]?d[2]:"?")+"}":"")}},_cb_callreturn_onchange:function(f,b,j,g,a){var e=this,c=e._tagVar;if(c){c.args=c.args||[];c.args[2]=j;e.markDirty(1);var d=c.args;e.conf_return_exp.setHtml(d[1]&&d[1]!="none"?"${"+(d[1]+".")+(d[2]?d[2]:"?")+"}":"")}},_tb_cat_onchange:function(d,b,c){if(!c){return}var f=this,l,g="none",j=d.getItemByItemId(c);if(j){f.lbl_target.setCaption((j&&j.caption||"").split("<br />")[0]);var e=f._buildsubtree(j);if(e&&e.length){g=e[0].id}var a;if(f._tagVar){if(j.className&&j.className!=SPA.currentClassName){f._tagVar.className=j.className}if(j.euClassName&&j.euClassName!=SPA.currentClassName){f._tagVar.euClassName=j.euClassName}else{}f._tagVar.type=j._type;l=j.id;if(j._type=="none"){l=l.replace("none:","")}if(j._type=="page"||j._type=="module"){}else{if(j._type=="other"){l=l.replace("other:","")}}if(b&&b!="none:none"){}f._tagVar.target=l;if(xui.arr.subIndexOf(e,"id",f._tagVar.method)!=-1){g=f._tagVar.method}f.markDirty(1)}}f.tb_action.setUIValue(f.tb_action.getItemByItemId(g)?g:"none",true)},_tb_action_onchange:function(e,d,V){if(!V){return}var ab=this,u=ab.properties,m=u.parent,U=ab._tagVar,H="none",D=e.getItemByItemId(V);if(U&&!ab._initvalue&&d){U.args=xui.isSet(D.args)?xui.copy(D.args):[];delete U.onOK;delete U.onKO;delete U.adjust;delete U.redirection}ab.markDirty(1);ab._targetshadow=ab._targetshadow2=null;var X,C=ab.tab_conf.getUIValue();if(D){if(ab.tab_conf.getItemByItemId(D.cat)){X=D.cat}else{if(D.customUI){D.customUI(ab,ab.tab_conf);X=D.cat}}}if(!X){X="none"}ab.tab_conf.setUIValue(X,true);if(U&&!ab._initvalue&&X!=C){U.args=xui.isSet(D.args)?xui.copy(D.args):U.args}if(D){ab.lbl_action.setCaption(D&&D.caption||"");if(U){U.method=D.id;delete U.onOK;delete U.onKO}ab.add_target.setTagVar(null,true);switch(D.cat){case"animate":U.onOK=1;var R=xui.get(U,["args",0])||"blinkAlert";ab.iniPureValue(ab.ctl_animate,R);break;case"selfile":if(D.id=="selectFile"){U.onOK=0}break;case"fmsg":ab.msg_body.setUIValue(xui.get(U,["args",0])||"");ab.msg_cap.setUIValue(xui.get(U,["args",1])||"");ab.msg_width.setUIValue(xui.get(U,["args",2])||200);ab.msg_duration.setUIValue(xui.get(U,["args",3])||5000);break;case"log":ab.log_v1.setValue(xui.get(U,["args",0])||"");ab.log_v2.setValue(xui.get(U,["args",1])||"");ab.log_v3.setValue(xui.get(U,["args",2])||"");ab.log_v4.setValue(xui.get(U,["args",3])||"");ab.log_v5.setValue(xui.get(U,["args",4])||"");break;case"msg":ab.msg_title.setUIValue(xui.get(U,["args",0])||"");ab.msg_message.setUIValue(xui.get(U,["args",1])||"");if(D.id=="alert"||D.id=="confirm"){ab.msg_m.setDisplay("");U.onOK=2;if(D.id=="confirm"){U.onKO=3;U.okFlag="_confirm_yes";U.koFlag="_confirm_no"}}else{if(D.id=="prompt"){ab.msg_m.setDisplay("");U.onOK=3;U.onKO=4;U.okFlag="_prompt_ok";U.koFlag="_prompt_cancel"}else{ab.msg_m.setDisplay("none")}}if(D.id=="prompt"){ab.msg_input.setDisplay("");ab.msg_inputm.setDisplay("");ab.msg_input.setUIValue(xui.get(U,["args",2])||"")}else{ab.msg_input.setDisplay("none");ab.msg_inputm.setDisplay("none")}break;case"url":ab.url_address.setUIValue(xui.get(U,["args",0])||"");ab._jsoneditor2.render();ab._jsoneditor2.setValue(xui.get(U,["args",1])||{});break;case"datatransfer":if(D.id=="invoke"){ab.fileurl_address.setDisplay("none");ab.ctl_slabel57.setTop(".5em");U.onOK=0;U.onKO=1;U.okFlag="_DI_succeed";U.koFlag="_DI_fail"}else{ab.ctl_slabel57.setTop("4em");ab.fileurl_address.setDisplay("").setUIValue(xui.get(U,["args",0])||"");if(D.id=="readText"){U.onOK=1;U.onKO=2;U.okFlag="_DI_succeed";U.koFlag="_DI_fail"}else{if(D.id=="readJSON"){U.onOK=1;U.onKO=2;U.okFlag="_DI_succeed";U.koFlag="_DI_fail"}}}break;case"mix":var O=D["0"],u=O.properties,ag=U.method,B=O.box["xui.UI.TreeBar"]||(O.box["xui.UI.TreeGrid"]&&ag=="insertRows"),g=ag=="insertItems"||ag=="insertRows"||ag=="insertCol",o=ag=="setFormValues",G=/^(update|set)/.test(ag),ai=(ag=="insertRows"||ag=="updateRow"||ag=="setActiveRow"||ag=="updateCellByRowCol2")?"rows":(ag=="insertCol"||ag=="updateHeader"||ag=="removeCols"||ag=="showColumn"||ag=="sortColumn")?"header":"items",Z=u[ai],x;if(ag=="updateCellByRowCol2"){x=[];var W=function(w,l,s){xui.arr.each(w,function(al,aj){if(al.id==xui.UI.TreeGrid._temprowid){return}var ak=[];l.push({id:s+":"+aj,caption:xui.getRes("RAD.action.Row $0",s+aj),group:true,sub:ak});xui.arr.each(u.header,function(an,am){ak.push({id:s+aj+":"+am,row:aj,col:am,caption:xui.getRes("RAD.action.Row $0",s+aj)+"  , "+xui.getRes("RAD.action.Column $0",am)})})})};W(u.rows,x,"")}else{x=xui.clone(Z,true);xui.filter(x,function(l){if(l.id==xui.UI.TreeGrid._temprowid){return false}return true})}if(!x||!x.length){x=[]}if(ag=="setFormValues"){}else{x.push({id:"[key]",caption:"$(RAD.action.Other sub$-item (Empty means current$))"})}ab.add_target.setItems(x);ab.add_target.setTagVar({hasSub:B,insert:g,update:G,specialUpdate:o,clsN:O.box.KEY,keyN:ai});ab.blk_itempos.setDisplay(g?"":"none",true).setDockIgnore(!g,true);if(B){ab.add_pos.showItems(["subfirst","sublast","cursubfirst","cursublast"])}else{ab.add_pos.showItems(["subfirst","sublast","cursubfirst","cursublast"],false)}var af,R;if(g){R=xui.get(U,["args",0])||"";if(B){var K=xui.get(U,["args",1])||"",j=xui.get(U,["args",2])||"",J=xui.get(U,["args",3]),E;if(K){if(K===true){E=J?"cursubfirst":"cursublast";ab.xui_block_mix.setDisplay("none").getParent().adjustDock(true);ab.add_target.setValue("[key]",true);ab.add_pos.setValue(E,true)}else{E=J?"subfirst":"sublast";ab.xui_block_mix.setDisplay("").adjustDock();ab.tb_mixsub.setReadonly(K!="[key]"&&!!ab.add_target.getItemByItemId(K),true);ab.tb_mixsub.setValue(K,true);if(ab.add_target.getItemByItemId(K)){ab.add_target.setValue(K,true)}else{ab.add_target.setValue("[key]",true)}ab.add_pos.setValue(E,true)}}else{if(j){if(j===true){E=J?"curbefore":"curafter";ab.xui_block_mix.setDisplay("none").getParent().adjustDock(true)}else{E=J?"before":"after";ab.xui_block_mix.setDisplay("").adjustDock();ab.tb_mixsub.setReadonly(j!="[key]"&&!!ab.add_target.getItemByItemId(j),true)}}else{E=J?"first":"last";ab.xui_block_mix.setDisplay("none").getParent().adjustDock(true)}ab.tb_mixsub.setValue(j,true);if(ab.add_target.getItemByItemId(j)){ab.add_target.setValue(j,true)}else{ab.add_target.setValue("[key]",true)}ab.add_pos.setUIValue(E,true)}}else{var j=xui.get(U,["args",1])||"",J=xui.get(U,["args",2]),E;if(j){if(j===true){E=J?"curbefore":"curafter";ab.xui_block_mix.setDisplay("none").getParent().adjustDock(true)}else{E=J?"before":"after";ab.xui_block_mix.setDisplay("").adjustDock();ab.tb_mixsub.setReadonly(j!="[key]"&&!!ab.add_target.getItemByItemId(j),true)}}else{E=J?"first":"last";ab.xui_block_mix.setDisplay("none").getParent().adjustDock(true)}ab.tb_mixsub.setValue(j,true);if(ab.add_target.getItemByItemId(j)){ab.add_target.setValue(j,true)}else{ab.add_target.setValue("[key]",true)}ab.add_pos.setUIValue(E,true)}}else{if(o){R=xui.get(U,["args",0])||"";af=null}else{R=xui.get(U,["args",1])||"";af=xui.get(U,["args",0])||""}if(ab.add_target.getItemByItemId(af)){ab.add_target.setValue(af,true);ab.tb_mixsub.setValue(af,true);ab.xui_block_mix.setDisplay("").adjustDock();ab.tb_mixsub.setReadonly(af!="[key]",true)}else{if(af){ab.add_target.setValue("[key]",true);ab.tb_mixsub.setValue(af,true);ab.xui_block_mix.setDisplay("").adjustDock();ab.tb_mixsub.setReadonly(false,true)}else{if(x.length){ab.add_target.setUIValue(af,true);af=x[0].id;ab.tb_mixsub.setUIValue(af=="[key]"?"":af,true);ab.xui_block_mix.setDisplay("").adjustDock();ab.tb_mixsub.setReadonly(true,true)}else{ab.xui_block_mix.setDisplay("none").getParent().adjustDock(true);ab.tb_mixsub.setReadonly(false,false)}}}}ab.iniPureValue(ab.ctl_itemvar,R);break;case"con":ab.tb_con.setSelMode("single");ab.ctl_blockcon.setDisplay("block");ab.ctl_tocon.setDisplay("block");switch(U.method){case"showItems":case"hideItems":case"setValue":case"fireItemClickEvent":case"editItem":case"removeItems":case"setActiveRow":case"removeRows":case"removeCols ":case"dumpContainer":case"isDirtied":case"checkValid":case"checkRequired":case"getFormValues":case"formSubmit":case"formReset":case"formClear":case"updateFormValues":ab.tb_consub.setTag("fireitem");if(U.method!="setValue"&&U.method!="fireItemClickEvent"&&U.method!="editItem"&&U.method!="checkValid"&&U.method!="isDirtied"&&U.method!="checkRequired"&&U.method!="getFormValues"&&U.method!="formSubmit"&&U.method!="formReset"&&U.method!="formClear"&&U.method!="updateFormValues"){ab.tb_con.setSelMode("multibycheckbox")}ab.toggle_value.setDisplay("none");var Z=D["0"].properties[U.method=="removeRows"||U.method=="setActiveRow"?"rows":U.method=="removeCols"?"header":"items"],x=[];if(Z&&xui.isArr(Z)){x=xui.clone(Z,true);x.push({id:"[key]",caption:"$(RAD.action.Other sub$-item (Empty means current$))"})}else{ab.ctl_blockcon.setDisplay("none");ab.ctl_tocon.setDisplay("none")}ab.tb_con.setItems(x,true);break;case"setToggle":case"toggleNode":case"toggleRow":ab.tb_consub.setTag("toggle");ab.toggle_value.setDisplay("");ab.toggle_value.setTag(D.hassub);if(D.hassub){var x=xui.clone(D["0"].properties.items||D["0"].properties.rows,function(l,s){if(l&&l.group){delete l.group}return(s=="sub"&&typeof(l[0])=="object")||(typeof(l)=="object"?!!l.sub:(s+"").charAt(0)!="_")});x.push({id:"[key]",caption:"$(RAD.action.Other sub$-item (Empty means current$))"});ab.tb_con.setItems(x);ab.tb_consub.setDisplay("")}else{ab.tb_con.setItems([]);ab.tb_consub.setDisplay("none")}break;case"show":var I=xui.get(U,["args",0]);ab.tb_consub.setTag("con");ab.toggle_value.setDisplay("none");ab.tb_con.setItems(xui.clone(ab._panelitems));var F=ab.tb_con.getItems();for(var ac=0,Y=F.length;ac<Y;ac++){if(F[ac].id!="none"&&(((xui.getClassName(SPA.currentPage)==U.target)||F[ac]["parent:"+U.target]))){ab.tb_con.showItems(F[ac].id,false)}else{ab.tb_con.showItems(F[ac].id)}}break}switch(U.method){case"setValue":case"fireItemClickEvent":case"editItem":var I=xui.get(U,["args",0])||"";if(ab.tb_con.getItemByItemId(I)){ab.tb_consub.setReadonly(true,true);ab.tb_con.setValue(I)}else{ab.tb_con.setValue("[key]");ab.tb_consub.setReadonly(false,true)}ab.tb_consub.setUIValue(I=="[key]"?"":I,true);break;case"showItems":case"hideItems":case"removeItems":case"setActiveRow":case"removeRows":case"removeCols ":case"dumpContainer":var I=xui.get(U,["args",0])||"";var q=(I+"").split(";"),b;for(var ac=0,Y=q.length;ac<Y;ac++){if(!ab.tb_con.getItemByItemId(q[ac])){b=true;break}}if(b){ab.tb_con.setValue("[key]",true);ab.tb_consub.setReadonly(false,true)}else{ab.tb_con.setValue(I,true);ab.tb_consub.setReadonly(true,true)}ab.tb_consub.setValue(I,true);break;case"setToggle":case"toggleNode":case"toggleRow":if(!D.hassub){ab.toggle_value.setUIValue(xui.get(U,["args",0])?"expand":"folding",true);ab.tb_con.setValue("",true);ab.tb_consub.setValue("",true)}else{ab.toggle_value.setUIValue(xui.get(U,["args",1])?"expand":"folding",true);var I=xui.get(U,["args",0])||"";if(!ab.tb_con.getItemByItemId(I)){ab.tb_con.setValue("[key]",true);ab.tb_consub.setReadonly(false,true)}else{ab.tb_con.setValue(I,true);ab.tb_consub.setReadonly(true,true)}ab.tb_consub.setValue(I,true)}break;case"show":var I=xui.get(U,["args",0])||"";var ad=xui.get(U,["args",1])||"";if(ad){var S=I.replace("}","."+ad+"}");if(ab.tb_con.getItemByItemId(S)){ab.tb_con.setValue(S,true);ab.tb_consub.setReadonly(true,true)}else{ab.tb_con.setValue(I.replace("}",".[key]}"),true);ab.tb_consub.setReadonly(false,true)}ab.tb_consub.setValue(ad,true)}else{ab.tb_con.setValue(I,true);ab.tb_consub.setValue("",true)}break}break;case"json":if(!U.args){U.args=[]}if(!xui.isHash(U.args[0])){U.args[0]={}}ab._jsoneditor.render();ab._jsoneditor.setValue(U.args[0]);break;case"prop":var Q=U.target,a=m.getByAlias(Q,true);if(!U.args){U.args=[]}if(!xui.isHash(U.args[0])){U.args[0]={}}if(!xui.isHash(U.args[1])){U.args[1]={}}var n=a.boxing().clone().get(0),c={properties:{}};ab._hiddenDiv.html("");if(n.box["xui.UI"]){ab._hiddenDiv.append(n)}var f=U.args[0],L=U.args[1],P=ab.profileGrid,q=[];for(var ac in f){if(ac=="CC"){n.CC=xui.clone(f.CC);if(xui.arr.indexOf(q,"CS")==-1){q.push("CS")}}else{if(ac=="CS"){n.CS=xui.clone(f.CS);if(xui.arr.indexOf(q,"CS")==-1){q.push("CS")}}else{n.properties[ac]=typeof(f[ac])=="object"?xui.clone(f[ac]):f[ac];if(xui.arr.indexOf(q,ac)==-1){q.push("properties:"+ac)}}}}for(var ac in L){if(ac=="CC"){c.CC=xui.clone(f.CC);if(xui.arr.indexOf(q,"CS")==-1){q.push("CS")}}else{if(ac=="CS"){c.CS=xui.clone(f.CS);if(xui.arr.indexOf(q,"CS")==-1){q.push("CS")}}else{c.properties[ac]=typeof(f[ac])=="object"?xui.clone(f[ac]):f[ac];if(xui.arr.indexOf(q,ac)==-1){q.push("properties:"+ac)}}}}ab._targetshadow=n;ab._targetshadow2=c;P.get(0).$widget=n.boxing();var ae=m._buildPropRows(n,null,null,true,P),r;xui.arr.each(ae,function(l){l.iniFold=false;xui.arr.each(l.sub,function(s){s.rulerWidth=".5em";s.cells[1]._ov=s.cells[1].value;s.cells[2]={value:""};if(L&&(r=L[s.id.replace("properties:","")])){s.cells[2].value=r;if(/^\s*\{([\S]+)\}\s*$/.test(r)){s.cells[2]._$caption="$"+r}}})});P.setRows(ae);P.setValue(q);this._propFilter_();break;case"data":ab.data_source.setUIValue((xui.get(U,["args",0])||""));break;case"switch":var N=xui.get(U,["args",0]);ab.ctl_cache.setUIValue(N!==false,true);break;case"var":ab.ctl_varto.setUIValue(xui.get(U,["args",0])||"");var R=xui.get(U,["args",1])||"",A=xui.get(U,["args",2])||"";ab.iniPureValue(ab.ctl_varfrom,R);ab.ctl_varfrompath.setValue(A,true).setTagVar(A||null);ab.ctl_adjust.setUIValue(xui.get(U,["adjust"])||"");var T="${"+U.method+"."+(xui.get(U,["args",0])||"?")+"} = ";ab.conf_var_left.setHtml(T);break;case"setcb":ab.cb_setid.setUIValue(xui.get(U,["args",0])||"");ab.cb_setvalue.setUIValue(xui.get(U,["args",1])||"");break;case"callcb":if(D.redirection&&D._tpl){var Q=U.target;if(Q.indexOf(".")>-1){Q=Q.split(".")[Q.split(".").length-1]}var R=D._tpl.replace("*",Q);ab.cb_callid.setUIValue(R,true);ab.cb_callid.setDisabled(true);U.redirection=D.redirection}else{ab.cb_callid.setDisabled(false);ab.cb_callid.setUIValue(xui.get(U,["args",0])||"",true);if(D.redirection){U.redirection=D.redirection}else{delete U.redirection}}var M=xui.get(U,["args",1])||"none",aa=ab.cb_callreturnto.getItems();if(xui.arr.subIndexOf(aa,"id",M)==-1){M="none"}ab.cb_callreturnto.setUIValue(M);ab.cb_callreturn.setUIValue(xui.get(U,["args",2])||"");var ah=U.args;ab.conf_return_exp.setHtml(ah[1]&&ah[1]!="none"?"${"+(ah[1]+".")+(ah[2]?ah[2]:"?")+"}":"");var Y=ab.grid_params.getRows().length;if(!Y){Y=10}for(var ac=0;ac<Y;ac++){ab.grid_params.updateCellByRowCol(""+(ac+3),"value",{value:U.args[ac+3]},false,false)}ab.grid_params.offEditor(true);break;default:if(D.initUI){D.initUI(ab,U)}break}}},_toolbar_onclick:function(c,j,r,l,a){var n=this,f=n.tb_actions,m=f.getItems(),q=f.getUIValue(),s=f.getItemByItemId(q);switch(j.id){case"add":var g=m.length+1,b=xui.adjustRes("$RAD.action.Action");while(xui.arr.subIndexOf(m,"caption",b+" "+g)!==-1){g++}var d=n.addAction(b+" "+g);f.editItem(d.id);break;case"edit":if(q){f.editItem(q)}break;case"remove":var o=f.getUIValue();if(!o){return}xui.confirm("$RAD.Remove",xui.adjustRes("$(RAD.Are You Sure to remove this row)?"),function(){f.removeItems(o);var e=f.getItems();if(e&&e.length){f.setUIValue(e[0].id)}else{n._initctrls()}n.markDirty(1)});break;case"clear":xui.confirm("$RAD.Remove",xui.adjustRes("$(RAD.Are You Sure to remove all)?"),function(){n._initctrls(true);n.markDirty(1)});break;default:}},_tb_beforeapply:function(e,f,b,d){var a=e.properties.items,c=xui.arr.subIndexOf(a,"caption",b);if(c!=-1&&a[c]!=f){xui.alert(xui.adjustRes("$RAD.Message"),xui.adjustRes("$(RAD.action.This Action Name exists alerady)"),function(){d.activate()});return false}if(!xui.str.trim(b)){xui.alert(xui.adjustRes("$RAD.Message"),xui.adjustRes("$(RAD.action.Specify Action Description please)"),function(){d.activate()});return false}f.tagVar.desc=b;this.markDirty(1)},addAction:function(e){var b=this,a=b.tb_actions.getItems();if(xui.arr.subIndexOf(a,"caption",e)!=-1){xui.alert(xui.adjustRes("$(RAD.action.This Action Name exists alerady)"));return false}if(!xui.str.trim(e)){xui.alert(xui.adjustRes("$RAD.Message"),xui.adjustRes("$(RAD.action.Specify Action Description please)"));return false}var d={desc:e,type:"none",target:"none",args:[]};var f=xui.stamp()+"",c={id:f,caption:e,imageClass:"spafont spa-icon-action",tagVar:d};b.tb_actions.insertItems([c]);b._enablectrls();b.markDirty(1);b.tb_actions.setUIValue(f,true);return c},_url_address_onchange:function(c,a,d){var b=this;b._tagVar.args[0]=d;b.markDirty(1)},_msg_title_onchange:function(c,a,d){var b=this;b._tagVar.args[0]=d;b.markDirty(1)},_msg_message_onchange:function(c,a,d){var b=this;b._tagVar.args[1]=d;b.markDirty(1)},_msg_input_onchange:function(c,a,d){var b=this;b._tagVar.args[2]=d;b.markDirty(1)},_msg_cap_onchange:function(c,a,d){var b=this;b._tagVar.args[1]=d;b.markDirty(1)},_msg_body_onchange:function(c,a,d){var b=this;b._tagVar.args[0]=d;b.markDirty(1)},_msg_duration_onchange:function(c,a,d){var b=this;b._tagVar.args[3]=d;b.markDirty(1)},_msg_width_onchange:function(c,a,d){var b=this;b._tagVar.args[2]=d;b.markDirty(1)},_ds_onchange:function(c,a,d){var b=this;b._tagVar.args[0]=d||"";b.markDirty(1)},_ctl_cache_onchange:function(c,a,d){var b=this;b._tagVar.args[0]=!!d;b.markDirty(1)},_ctl_symbol_onchange:function(f,c,j,g,a){if(c==j){return}var e=this,d=e._tagVar,a=f.properties.tag;if(d){if(!d.conditions){d.conditions=[]}if(!d.conditions[a-1]){d.conditions[a-1]={left:"",symbol:"defined",right:""}}var b=d.conditions[a-1];b.symbol=j;e.markDirty(1);if(j=="defined"||j=="undefined"||j=="empty"||j=="non-empty"){e["i_conr"+a].setUIValue("",true);e["i_conr"+a].setDisabled(true,true)}else{e["i_conr"+a].setDisabled(false,true)}}},_grid_params_onbe:function(c,a,b){b.setTag("purevar");this.iniPureValue(b,a.value);this._enhanceInputs(b.reBoxing("xui.UI.Input"))},_grid_params_aftercellupdated:function(e,a,b,f){var d=this,c=d._tagVar;if(c){c.args=c.args||[]}if("value" in a){c.args[parseInt(a._row.id,10)]=a.tagVar||a.value;d.markDirty(1)}},_cb_asy_onchange:function(d,a,e){var c=this,b=c._tagVar;c.spin_asy.setDisabled(!e);if(b){if(e){b.timeout=c.spin_asy.getUIValue()}else{c.spin_asy.setUIValue(0,true);delete b.timeout}c.markDirty(1)}},_spin_asy_onchange:function(d,a,e){var c=this,b=c._tagVar;if(b){b.timeout=e||0;c.markDirty(1)}},_jsoneditorchanged:function(b){var c=this,a=c._tagVar;if(a){a.args[0]=b.getValue(true);c.markDirty(1)}},_jsoneditorchanged2:function(b){var c=this,a=c._tagVar;if(a){a.args[1]=b.getValue(true);c.markDirty(1)}},_false_change:function(d,a,e){var c=this,b=c._tagVar;if(b){if(e){b["return"]=false}else{if(b["return"]===false){delete b["return"]}}c.markDirty(1)}},$tg_tips:function(){var b=this,c=b.properties,a=c.parent;return a.$tg_tips.apply(a,arguments)},markProperty:function(n,m,g,l){var j=this,a=j.profileGrid,b=n=="CS"?"CS":n=="CC"?"CS":("properties:"+n),e=j._tagVar,f=e.args||[],d,c;if(!xui.isHash(f[0])){f[0]={}}if(!xui.isHash(f[1])){f[1]={}}d=f[0];c=f[1];if(xui.isSet(g)){if(b=="CS"){j._targetshadow2[n]=g}else{j._targetshadow2.properties[n]=g}}else{if(xui.isSet(m)){if(b=="CS"){j._targetshadow[n]=m;delete j._targetshadow2[n]}else{j._targetshadow.properties[n]=m;delete j._targetshadow2.properties[n]}}}if(l){delete d[n];delete c[n];if(xui.isSet(g)){c[n]=g}else{if(xui.isSet(m)){d[n]=xui.clone(m,true)}}j.markDirty(1)}},$profilegrid__rowsel:function(c,n,f,a,j){var l=this,b=n.id,d=l._targetshadow,g=l._targetshadow2;if(b=="CS"){l.markProperty("CC",j==-1?null:d.CC,j==-1?null:g.CC,true);l.markProperty("CS",j==-1?null:d.CS,j==-1?null:g.CS,true)}else{var m=b.replace("properties:","");l.markProperty(m,j==-1?null:d.properties[m],j==-1?null:g.properties[m],true)}},_propFilter_oncmd:function(){var a=this.propFilter;if(a.getUnit()!="Show All"){a.setUnit("Show All")}else{a.resetValue("")}this._propFilter_()},_propFilter_unit:function(b,c){var a=this.propFilter;if(c=="Show All"){a.setInputReadonly(false)}else{a.resetValue("").setInputReadonly(true)}this._propFilter_()},_propFilter_onchange:function(b,a,c){xui.resetRun("_propFilter_2",this._propFilter_,500,[],this)},_propFilter_:function(d){var c=this,d=c.propFilter.getUIValue(),b=c.propFilter.getUnit(),a=function(){return new RegExp(":\\w*"+d||"","i")};this.profileGrid.doFilter(b!="Show All"||d?function(l,j,f){var e=arguments.callee,g;if(l=="begin"){if(b=="Show All"){if(!e._$reg){e._$reg=a(d)}}}else{if(l=="end"){if(j!="prepareItem"){}}else{if(b!="Show All"){g=l.group||l.sub?false:!l._selected}else{if(d){g=l.group||l.sub?false:!e._$reg.test(l.id)}}if(j!="prepareItem"&&l.id&&l.sub&&!l._checked){f.boxing().toggleRow(l.id,true,false,true)}return g}}}:null)},$profilegrid_beforecellvalueset:function(c,q,d,f,b){var l=this,r=q._row;if(q._col.id=="value"){if(b&&b._ext){xui.each(b._ext,function(u,s){l.markProperty(s,u,null,!!r._selected)})}else{if(!("value" in d)&&!("unit" in d)){return}var j=c.$widget,g,a,o,m;m=d.value;if((g=q._row.id.split(":")).length>1){type=g[0];o=g[1]}else{o=q._row.id}if(o=="width"&&(xui.get(j.get(0),["parent","properties","conDockRelative"])||xui.get(j.get(0),["parent","properties","conLayoutColumns"]))){return false}else{var e=q.unit=="em"?4:0;if(j.get(0).box.$DataModel[o].$spaceunit){if("value" in d){d.value=String((m=="auto")?m:(parseFloat(m)===0?0+(d.unit||q.unit||""):parseFloat(m)?parseFloat(m):"auto"))}d.precision=e;if(m!==d.value||d.unit!==q.unit||d.precision!==e){c.boxing().updateCell(q,d)}m=d.value=="auto"?"auto":q.value+q.unit}}var n=r.id.replace("properties:","");l.markProperty(n,m,null,!!r._selected)}}else{if(q._col.id=="value2"){if(!("value" in d)&&!("unit" in d)){return}var j=c.$widget,g,a,o,m;m=d.value;if((g=q._row.id.split(":")).length>1){type=g[0];o=g[1]}else{o=q._row.id}if(o=="width"&&(xui.get(j.get(0),["parent","properties","conDockRelative"])||xui.get(j.get(0),["parent","properties","conLayoutColumns"]))){return false}if(/^\s*\{([\S]+)\}\s*$/.test(m)){d._$caption="$"+m}var n=r.id.replace("properties:","");l.markProperty(n,null,m||null,!!m)}}},$tg_cellupd:function(e,b){var d=this,c=e.boxing(),a;if(!b._row._selected){a=c.getUIValue(true);a.push(b._row.id);c.setValue(a);c.onRowSelected(e,b._row,null,null,1)}else{if(b._col.id=="value"){a=c.getUIValue(true);if(b.value===b._ov){xui.arr.removeValue(a,b._row.id)}c.setValue(a);c.onRowSelected(e,b._row,null,null,0)}else{if(b._col.id=="value2"){a=c.getUIValue(true);if(!b.value){xui.arr.removeValue(a,b._row.id)}c.setValue(a);c.onRowSelected(e,b._row,null,null,0)}}}if(b._col.id=="value"){c.updateCell(b._row.cells[2],{value:""},false,false)}else{if(b._col.id=="value2"){c.updateCell(b._row.cells[1],{value:b._row.cells[1]._ov},false,false)}}},$tg_beginedit:function(d,a,c,b){if(a._col.id=="value2"){this._enhanceInputs(c.reBoxing("xui.UI.Input"))}},$tg_dblclick:function(){var b=this,c=b.properties,a=c.parent;a.$tg_dblclick.apply(b,arguments)},_animate_buis:function(c,b,a){if(a=="[customize]"){return false}},_animate_beforecombopop:function(d,j,f,g){if(d.properties.items.length){return}var c=this,b=d.boxing();var a=[];xui.each(xui.Dom.$preDefinedAnims,function(e,l){a.push(l)});b.setItems(a)},_data_source_beforecombopop:function(c,g,d,f){var b=this,a=c.boxing();xui.Dom.busy();xui.asyRun(function(){xui.Ajax(CONF.openFolderService,{path:SPA.curProjectPath+"/data",hashCode:xui.id(),curProjectPath:SPA.curProjectPath},function(e){var l=e;if(l&&!l.error){var j=[];l.data.files=xui.arr.stableSort(l.data.files,function(m,n){return m.layer>n.layer?-1:m.layer<n.layer?1:m.location>n.location?1:-1});xui.arr.each(l.data.files,function(m){if(m.type===1&&/.+\.(js|json|txt)$/.test(m.location)){m=m.location.replace(SPA.curProjectPath+"/","");j.push({id:"[data]"+m,caption:m})}});a.setItems(j);a.expand()}xui.Dom.free()},function(e){xui.Dom.free()})})},_btncancel_onclick:function(b,d,f,c){var a=this;a.markDirty(0);a.tab_conf.setValue("none",true);a.dialog.close()},_btnonok_onclick:function(c,g,a,m){var l=this,b=l.properties,j=l.tb_actions.getItems(),o=[],d=[];l._tagVar=null;if(l._dirty){if(b.actionConf){if(xui.isFun(b.actionConf)||xui.isStr(b.actionConf)){d.push(b.actionConf)}else{var f=xui.isArr(b.actionConf)?b.actionConf:b.actionConf.actions;xui.arr.each(f,function(s,e){if(xui.isStr(s)||xui.isFun(s)){d.push(s)}})}}if(j.length){xui.arr.each(j,function(x){if(x.tagVar&&!x.tagVar._ignore&&(("return" in x.tagVar)||(x.tagVar.target!="none"&&x.tagVar.method!="none"))){var w=x.tagVar;if(w.type=="other"&&w.target=="var"&&(!w.args||!w.args[0])){return}if(w.type=="control"&&w.method=="setProperties"&&(!w.args||(!w.args[0]&&!w.args[1])||(xui.isEmpty(w.args[0])&&xui.isEmpty(w.args[1])))){return}if(w.type=="control"&&w.method=="setProperties"){xui.filter(w.args[0],function(A){return !w.args[1][A]})}var s=w.conditions;w.conditions=[];xui.arr.each(s,function(A){if(!A){return}if(A.symbol=="defined"||A.symbol=="undefined"||A.symbol=="exists"||A.symbol=="non-exists"||A.symbol=="empty"||A.symbol=="non-empty"){if(A.left){w.conditions.push(A)}}else{if(A.left&&A.right){w.conditions.push(A)}}});if(!w.conditions.length){delete w.conditions}w.desc=x.caption;if(w.target.indexOf(".")==-1){if(w.redirection&&xui.str.startWith("otherModuleCall",w.redirection)){delete w.redirection}delete w.className;if(type=="page"||type=="otherModuleCall"){w.type="control"}}else{if(w.className&&w.className!=SPA.currentClassName){var u=w.target;if(u!=w.className){var e=u.split(".")[u.split(".").length-1];u=w.className+"##"+e;w.redirection="otherModuleCall:"+u+":"+w.method;w.type="otherModuleCall"}else{w.type="page"}}else{if(w&&xui.str.startWith("otherModuleCall:")){delete w.redirection}}}o.push(w)}})}var n=-1;if(b.argsvar&&o.length){n=xui.arr.indexOf(b.argsvar,"e");if(-1!=n){o[0].event=n}else{delete o[0].event}}xui.arr.insertAny(o,d,-1);var r={},q=l.xui_returns.getUIValue();if(q){r["return"]=q}if(o.length){if(q){r.actions=o}else{r=o}}l.fireEvent("onDirty",[b.target,b._eventkey,xui.isEmpty(r)?null:r])}l.markDirty(0);l._targetshadow=null;l.tab_conf.setValue("none",true);l.dialog.close()},_tv_var_onclick:function(a,b){if(a.boxing().getUIValue()==b.id){this._tv_var_onchange(a,"",b.id,false,"click")}},_tv_var_onchange:function(d,b,c,n,o){if(!c||b==c){return}var j=this,m=d.boxing(),g=m.getTag(),r=d.getItemByItemId(c);if(r.realValue){c=r.realValue}if(g&&(g=g.boxing())){var e=c;if(e=="hash"||e=="array"||e=="function"){var l="#"+xui.adjustRes(r.caption)+"#",q=e=="function"?"spafont spa-icon-function":e=="array"?"spafont spa-icon-hash":" ",f=e=="function"?"function(){\n//code here\n}":e=="array"?"[\n//\n]":"{\n//\n}";j._editMixData(g,e,f,l,q);xui().setBlurTrigger("-action-float-inxuib",true);return}g.setUIValue(c);if(o=="click"){xui.asyRun(function(){var u=g.getSubNode("INPUT"),w,s=0,a=0;if(c=="{}"){s=a=1}else{if(/\(\'[^']*\'\)/.test(c)){s=c.indexOf("'")+1;a=c.lastIndexOf("'")}else{if(/\(\"[^"]*\"\)/.test(c)){s=c.indexOf('"')+1;a=c.lastIndexOf('"')}else{w=c.lastIndexOf("}");if(w!=-1){s=a=w}}}}g.get(0).$ignoreFocus=1;u.caret(s,a);delete g.get(0).$ignoreFocus})}}},_getFunCap:function(b){var a=[];if(xui.isHash(b)){doc=b}else{doc=RAD.EditorTool.getDoc(b,false,true)}if(doc){if(doc.$paras&&doc.$paras.length){xui.arr.each(doc.$paras,function(c){if(c=/([\w]+)[^:]+:\s*([\w/.]+[\w])/.exec(c)){a.push(c[1]+'<span style="color:#888">/*'+c[2]+"*/</span>")}else{a.push("?")}})}return"("+a.join(", ")+" ) "+(doc.$desc?(": "+doc.$desc):"")}else{return"( )"}},_tiggerNavTreeCur:function(){},_autoNavTree:function(d,q,g){var C=this,B=d=="callback"||d=="adjustdata"?C.tv_fun:C.tv_var,x,w=[];var r=function(D){var l=(D||"").split("(");if(l.length==2){return l[0]+"()}"}return D};delete C._potentialStep;q=xui.str.trim(q||"");if(q.charAt(0)=="{"){var a=q.replace(/[{}]/g,"").split("."),e,c,m="";for(var u=0,s=a.length;u<s;u++){m+=(m?".":"")+a[u];e="{"+m+"}";if(g){var n=B.getItems();if(!n||!n[0]){if(d=="callback"||d=="adjustdata"){C._buildVarTree2(d=="adjustdata")}else{C._buildVarTree(C.tv_var.get(0))}}var f=B.get(0).queryItems(n,function(D,l){return D.id==e},1,1),x;if(f&&f[0]){x=f[0];if(x.sub===true){if(d=="callback"||d=="adjustdata"){C._tv_fun_ongetcontent(B.get(0),x,function(l){x.sub=l})}else{n.sub=C._tv_var_ongetcontent(B.get(0),x,function(l){x.sub=l})}}if(x.id!="[key]"){w.push(xui.adjustRes(x.caption))}}else{w.push(a[u])}}else{if(x=B.getItemByItemId(e)){if(x.pid){var A=B.getItemByItemId(x.pid);if(!x._checked){B.toggleNode(x.pid,true,false)}}if(x.sub&&!x._checked){B.toggleNode(e,true,false);if(u==s-1&&!x.group){if(r(B.getUIValue())!==r(e)){B.setValue(r(C._potentialStep=e),true)}}}else{if(r(B.getUIValue())!==r(e)){B.setValue(r(C._potentialStep=e),true)}}if(x.id!="[key]"){w.push(xui.adjustRes(x.caption))}}else{w.push(a[u]);var j,x;c=e.replace(/\.([^.]+)\}$/,"}");e=e.replace(/\}$/,"");if(x=B.getItemByItemId(c)){if(x.sub){xui.arr.each(x.sub,function(l){if(xui.str.startWith(r(l.id),r(e))){if(r(B.getUIValue())!==r(l.id)){B.setValue(r(C._potentialStep=l.id),true)}j=1}})}}if(!j){if(r(B.getUIValue())!==r(e)){var o=r(c),b;if(B.getItemByItemId(b=o.replace("}",".}"))){B.setValue(C._potentialStep=b,true);j=1}if(B.getItemByItemId(b=o.replace(".}","}"))){B.setValue(C._potentialStep=b,true);j=1}if(!j){B.setValue(C._potentialStep="{}",true);j=1}}if(!j){if(r(B.getUIValue())!==r(c)){var o=r(c);if(B.getItemByItemId(o)){B.setValue(C._potentialStep=o,true)}else{B.setValue(C._potentialStep="{}",true)}}}}}}}}else{if(!g){}}return w},_buildGlobalfuns:function(){var b=[],a="spafont spa-icon-function";if(xui.get(SPA,["curProjectConfig","$GlobalFunctions"])){xui.each(SPA.curProjectConfig.$GlobalFunctions,function(e,c){if(c.charAt(0)=="$"||c.charAt(0)=="!"){return}var d=[];xui.arr.each(e.params,function(f){d.push(f.id+(f.type?("<span style='color:#888'>/*"+f.type+"*/</span>"):""))});b.push({id:"{functions."+c+"}",caption:c+"( "+d.join(", ")+" )"+(e.desc?(" : "+e.desc):""),imageClass:a})})}b.push({id:"{functions.}",caption:"$(RAD.action.fun.[key])",imageClass:a});return b},_buildConstantData:function(c){var b=[],a="spafont spa-icon-manual";if(xui.get(SPA,["curProjectConfig","$ConstantData"])){xui.each(SPA.curProjectConfig.$ConstantData,function(e,d){if(d.charAt(0)=="$"||d.charAt(0)=="!"){return}b.push({id:"{constant."+d+"}",caption:d,imageClass:a})})}b.push({id:"{constant.}",caption:"$(RAD.action."+c+".[key])",imageClass:a});return b},_buildGlobalData:function(c){var b=[],a=c=="var"?"spafont spa-icon-manual":"spafont spa-icon-function";if(xui.get(SPA,["curProjectConfig","$GlobalData"])){xui.each(SPA.curProjectConfig.$GlobalData,function(e,d){if(d.charAt(0)=="$"||d.charAt(0)=="!"){return}b.push({id:"{global."+d+"}",caption:d,imageClass:a})})}b.push({id:"{global.}",caption:"$(RAD.action."+c+".[key])",imageClass:a});return b},_buildVarTree3:function(e){var l=this,g=l.tv_fun,a=l.properties,m=a.controls,d=l.getScope(),n="spafont spa-icon-manual",f="spafont spa-icon-function",j=[{id:"{}",caption:"$(RAD.action.fun.Input Function)",imageClass:n}];xui.arr.each(["getProperties","triggerExcelFormulas"],function(o){if(l._ignoreFuns1[o]){return}if(o.charAt(0)=="_"||o.charAt(0)=="$"){return}j.push({id:"{page."+(e?e+".":"")+o+"()}",caption:o+l._getFunCap("xui.Module.prototype."+o),imageClass:f})});xui.arr.each(["getProperties","triggerExcelFormulas"],function(o){if(l._ignoreFuns1[o]){return}if(o.charAt(0)=="_"||o.charAt(0)=="$"){return}j.push({id:"{page."+(e?e+".":"")+o+"()}",caption:o+l._getFunCap("xui.Module.prototype."+o),imageClass:f})});if(e){j.push({type:"split"});var c=function(q,u,r){var o=(q+"").split("("),s;o.shift();s=o.join("(");s.replace(/\s*((\w)+)(\s*\/\*[^*]*\*+([^\/][^*]*\*+)*\/)?|(\s*\/\/[^\n]*)|(\)[\s\S]*)/g,function(C,x,w,D,B,A){if(C.charAt(0)!=")"){A=D?D.replace(/^\s*\/\*/,"").replace(/\s*\*\/\s*$/,"").replace(/\s*[\n\r]+\s*\*\s*/g," ").replace(/^\s*/,""):"";C=A.split(/[^\w\.]+/);B=C[0];u.push({ori:B||"Object",type:(B||"Object")+".prototype"});r.push(x+" : "+A)}})};var b=xui.get(d,["page",e,"Class","$Functions"]);if(b){xui.each(b,function(u,r){var s=[],q=[];c(u,s,q);j.push({id:"{page."+e+"."+r+"()}",caption:r+l._getFunCap({$paras:q,$desc:""}),imageClass:f})})}}g.setItems(j).setUIValue("")},_buildVarTree2:function(q){var o=this,m=o.tv_fun,b=o.properties,r=b.controls,j=o.getScope(),s="spafont spa-icon-manual",l="spafont spa-icon-function",n=[{id:"{}",caption:"$(RAD.action.fun.Input Function)",imageClass:s}];var g=function(u){xui.arr.each(u,function(x){var w=xui.copy(x);w.id="{page."+x.id+"}";w.__=x["0"].key;w.group=true;w.sub=true;e.push(w);if(x.sub){g(x.sub)}})},d=function(){var u=[];xui.arr.each(b.args,function(x,w){if(b.argsdoc&&(x=="callback"||x=="callback"||/[\w\s]+\:\s*(Function)/.test(b.argsdoc[w]||""))){u.push({id:"{args["+w+"]()}",caption:b.argsdoc&&b.argsdoc[w]||x,imageClass:l})}});if(u.length){n.push({id:"{args}",caption:"$(RAD.action.fun.in Parameters)",group:true,sub:u})}};d();var f=[],e=[],c={},a=[];g(r);xui.each(xui.Module.prototype,function(w,u){if(o._ignoreFuns1[u]){return}if(u.charAt(0)=="_"||u.charAt(0)=="$"){return}if(typeof w=="function"){if(!w.$xuiclass$){c[u]=1;e.push({id:"{page."+u+"()}",caption:u+o._getFunCap("xui.Module.prototype."+u),imageClass:l})}}});if(xui.get(b.parent,["_cls","Instance"])){xui.each(b.parent._cls.Instance,function(w,u){if(o._ignoreFuns1[u]){return}if(u.charAt(0)=="_"||u.charAt(0)=="$"){return}if(typeof w=="function"){if(!w.$xuiclass$&&!c[u]){e.push({id:"{page."+u+"()}",caption:u+o._getFunCap("xui.Module.prototype."+u),imageClass:l})}}})}xui.arr.stableSort(e,function(u,w){if(u.__){if(!w.__){return -1}else{return 0}}else{if(w.__){return 1}else{return u.id.toLowerCase()>w.id.toLowerCase()?1:u.id.toLowerCase()<w.id.toLowerCase()?-1:0}}});if(xui.get(b.parent,["_cls","Instance","functions"])){xui.each(b.parent._cls.Instance.functions,function(x,u){var w=[];xui.arr.each(x.params,function(A){w.push(A.id+(A.type?("<span style='color:#888'>/*"+A.type+"*/</span>"):""))});a.push({id:"{page.functions."+u+"}",caption:u+"( "+w.join(", ")+" )"+(x.desc?(" : "+x.desc):""),imageClass:l})})}a.push({id:"{functions.}",caption:"$(RAD.action.fun.[key])",imageClass:l});Array.prototype.push.apply(n,[{id:"{page.functions}",caption:"$(RAD.action.fun.Module Function Collection)",group:true,iniFold:false,sub:a},{id:"{functions}",caption:"$(RAD.action.fun.Global Function Collection)",group:true,sub:o._buildGlobalfuns()},{id:"{temp}",caption:"$(RAD.action.fun.in Temp Object)",group:true,sub:[{id:"{temp.}",caption:"$(RAD.action.fun.[key])",imageClass:s}]},{id:"{global}",caption:"$(RAD.action.fun.in Global Object)",group:true,sub:o._buildGlobalData("fun")}]);if(xui.get(b.parent,["_cls"])){n.push({id:"{page}",caption:"$(RAD.action.fun.in Current Page)",group:true,sub:e})}if(!q){n.push({id:"{xui}",caption:"$(RAD.action.fun.in xui Namespace)",group:true,sub:true})}m.setItems(n).setUIValue("")},_buildVarTree:function(x){var I=this,G=I.tv_var,E=I.CAPMAP.action,m=x.alias,f=m=="ctl_itemvar"&&I.add_target.getTagVar(),H="spafont spa-icon-manual",D="spafont spa-icon-function",a="spafont spa-icon-array",s="spafont spa-icon-hash",B="spafont spa-icon-var";var b=[],u=[],A=[],d=[],C=[],e=[{id:"{page.getProfile()}",caption:"$(RAD.designer.tool.Profile Map)",tagCmds:[{buttonType:"text",tagCmdsAlign:"left",caption:"",itemClass:"xuicon xui-icon-question"}],idn:"xui.Module.prototype.getProfile",imageClass:s},{id:"{page.getData()}",caption:"$(RAD.designer.tool.Data Map)",tagCmds:[{buttonType:"text",tagCmdsAlign:"left",caption:"",itemClass:"xuicon xui-icon-question"}],idn:"xui.Module.prototype.getData",imageClass:s},{id:"{page.getValue()}",caption:"$(RAD.designer.tool.Value Map)",tagCmds:[{buttonType:"text",tagCmdsAlign:"left",caption:"",itemClass:"xuicon xui-icon-question"}],idn:"xui.Module.prototype.getValue",imageClass:s},{id:"{page.properties}",caption:"$(RAD.action.var.Page Properties)",imageClass:s,tagCmds:[{buttonType:"text",tagCmdsAlign:"left",caption:"",itemClass:"xuicon xui-icon-question"}],idn:"xui.Module.prototype.getProperties",sub:d}];var c=I.properties,F=c.target,w=xui.get(c.cls,["Instance","properties"])||{},j=c.controls,r=function(J){xui.arr.each(J,function(L){var K=xui.copy(L);K.id="{page."+L.id+"}";K.__=L["0"].key;K.sub=true;e.push(K);if(L.sub){r(L.sub)}})},q=function(J){for(var L in J){var K=J[L];d.push({id:"{page.properties."+L+"}",caption:L,imageClass:xui.isArr(K)?a:xui.isHash(K)?s:B,sub:(xui.isArr(K)||xui.isHash(K))?true:null})}d.push({id:"{page.properties.}",caption:"$(RAD.action.var.[key])",imageClass:H})},o=function(J){for(var K in J){var M=[],L=J[K];xui.arr.each(L.params,function(N){M.push(N.id+(N.type?("<span style='color:#888'>/*"+N.type+"*/</span>"):""))});C.push({id:"{page.functions."+K+"}",caption:K+"( "+M.join(", ")+" )"+(L.desc?(" : "+L.desc):""),imageClass:D})}C.push({id:"{page.functions.}",caption:"$(RAD.action.var.[key])",imageClass:D})},n=function(){var K=c.argsvar||[],J;xui.arr.each(c.args,function(M,L){b.push({id:"{args["+L+"]}",caption:c.argsdoc&&c.argsdoc[L]||M,imageClass:xui.isArr(J)?a:xui.isHash(J)?s:B,_paramName:K[L]=="e"?"keyboard":null,sub:K[L]=="e"?true:K[L]=="curProfile"?[{id:"{args["+L+"].boxing()}",caption:"$(RAD.action.var.Current Control)",imageClass:s,__:F?F.key:null,referer:F?"{page."+F.alias+"}":"",sub:true}]:(xui.isArr(K[L])||xui.isHash(K[L])||xui.isObj(K[L]))?true:null})})};r(j);q(w);n();var l=[{id:"{}",caption:"$(RAD.action.var.Input Var)",imageClass:H},{id:"{getCookies()}",hidden:!!f,realValue:'{getCookies("key")}',caption:"$(RAD.action.var.Get Cookies)",imageClass:H},{id:"{getFI()}",hidden:!!f,realValue:'{getFI("key")}',caption:"$(RAD.action.var.Get Fragment Identifier)",imageClass:H},{id:"{native}",caption:"$(RAD.action.var.Native Var)",hidden:!!f,group:true,sub:[{pid:"{native}",id:"{true}",caption:"true",imageClass:B},{pid:"{native}",id:"{false}",caption:"false",imageClass:B},{pid:"{native}",id:"{NaN}",caption:"NaN",imageClass:B},{pid:"{native}",id:"{null}",caption:"null",imageClass:B},{pid:"{native}",id:"{undefined}",caption:"undefined",imageClass:B},{pid:"{native}",id:"{}",caption:"$(RAD.action.var.Empty String)",imageClass:B},{pid:"{native}",id:"{-0.00}",caption:"$(RAD.action.var.Number)",imageClass:B}]},{id:"{args}",caption:"$(RAD.action.var.Parameters)",group:true,iniFold:false,tagCmds:[{buttonType:"text",tagCmdsAlign:"left",caption:"",itemClass:"xuicon xui-icon-question"}],idn:F?F.key+".prototype."+c._eventkey:"",sub:b},{id:"{temp}",caption:"$(RAD.action.var.Temp)",group:true,sub:[{id:"{temp.okData}",caption:"$(RAD.action.var.Returned data)",imageClass:B},{id:"{temp.koData}",caption:"$(RAD.action.var.Failure message)",imageClass:B},{type:"split"},{id:"{temp._confirm_yes}",caption:"$(RAD.action.var.Select [yes] in confirm dialog)",imageClass:B},{id:"{temp._confirm_no}",caption:"$(RAD.action.var.Select [no] in confirm dialog)",imageClass:B},{type:"split"},{id:"{temp._prompt_ok}",caption:"$(RAD.action.var.Select [ok] in prompt dialog)",imageClass:B},{id:"{temp._prompt_cancel}",caption:"$(RAD.action.var.Select [cancel] in prompt dialog)",imageClass:B},{type:"split"},{id:"{temp._DI_succeed}",caption:"$(RAD.action.var.Data interaction succeeded)",imageClass:B},{id:"{temp._DI_fail}",caption:"$(RAD.action.var.Data interaction failed)",imageClass:B},{type:"split"},{id:"{temp.}",caption:"$(RAD.action.var.[key])",imageClass:H}]},{id:"{global}",caption:"$(RAD.action.var.Global)",group:true,sub:I._buildGlobalData("var")},{id:"{constant}",caption:"$(RAD.action.var.Constant)",group:true,sub:I._buildConstantData("var")}];if(xui.get(c.parent,["_cls"])){l.push({id:"{page}",caption:"$(RAD.action.Current Page)",imageClass:"spafont spa-icon-page",sub:e})}if(x.properties.tag=="purevar"){var f=I.add_target.getTagVar(),g=[];if(!(f&&f.insert)){g.push({id:"hash",caption:"$(RAD.action.var.Hash Var)",imageClass:s})}if(!(f&&(f.update||f.specialUpdate))){g.push({id:"array",caption:"$(RAD.action.var.Array Var)",imageClass:a})}if(!f){g.push({id:"function",caption:"$(RAD.action.var.Function Var)",imageClass:D})}xui.arr.insertAny(l,g,1)}G.setItems(l).setUIValue("")},_log_v5_onchange:function(e,b,g,f,a){var d=this,c=d._tagVar;if(c){c.args=c.args||[];c.args[4]=g;d.markDirty(1)}},_log_v4_onchange:function(e,b,g,f,a){var d=this,c=d._tagVar;if(c){c.args=c.args||[];c.args[3]=g;d.markDirty(1)}},_log_v3_onchange:function(e,b,g,f,a){var d=this,c=d._tagVar;if(c){c.args=c.args||[];c.args[2]=g;d.markDirty(1)}},_log_v2_onchange:function(e,b,g,f,a){var d=this,c=d._tagVar;if(c){c.args=c.args||[];c.args[1]=g;d.markDirty(1)}},_log_v1_onchange:function(e,b,g,f,a){var d=this,c=d._tagVar;if(c){c.args=c.args||[];c.args[0]=g;d.markDirty(1)}},_i_rtn_onchange:function(b,a,c){if(a==c){return}this._dirty=true},_i_conl_onchange:function(f,c,j,g,a){if(c==j){return}var e=this,d=e._tagVar,a=f.properties.tag;var d=e._tagVar;if(d){if(!d.conditions){d.conditions=[]}if(!d.conditions[a-1]){d.conditions[a-1]={left:"",symbol:"defined",right:""}}var b=d.conditions[a-1];b.left=j;e.markDirty(1)}},_i_conr_onchange:function(f,c,j,g,a){if(c==j){return}var e=this,d=e._tagVar,a=f.properties.tag;var d=e._tagVar;if(d){if(!d.conditions){d.conditions=[]}if(!d.conditions[a-1]){d.conditions[a-1]={left:"",symbol:"defined",right:""}}var b=d.conditions[a-1];b.right=j;e.markDirty(1)}},_ctl_adjust_onchange:function(e,b,g,f,a){if(b==g){return}var d=this,c=d._tagVar;if(c){c.adjust=g}},_ctl_varto_onchange:function(f,b,j,g,a){if(b==j){return}var e=this,c=e._tagVar;if(c){c.args=c.args||[];c.args[0]=j;var d="${"+c.method+"."+(j||"?")+"} = ";e.conf_var_left.setHtml(d);e.markDirty(1)}},_ctl_varfrom_cmd:function(a){a.boxing().setTagVar(null,true);a.boxing().setCommandBtn("none",true).setInputReadonly(false,true).setUIValue("",true);xui.asyRun(function(){a.boxing().activate()})},_ctl_varfrompath_cmd:function(a){a.boxing().setTagVar(null,true);a.boxing().setCommandBtn("none",true).setInputReadonly(false,true).setUIValue("",true);xui.asyRun(function(){a.boxing().activate()})},_ctl_animate_onchange:function(e,b,g,f,a){var d=this,c=d._tagVar;if(c){c.args=c.args||[];c.args[0]=e.properties.tagVar||g;d.markDirty(1);if(xui.isStr(c.args[0])){e.boxing().animate(c.args[0])}}},_ctl_itemvar_onchange:function(e,a,c,d,l){var g=this,b=g.properties,f=g._tagVar,j=g.add_target.getTagVar();if(f){f.args=f.args||[];if(j.insert||j.specialUpdate){f.args[0]=e.properties.tagVar||c}else{f.args[1]=e.properties.tagVar||c}g.markDirty(1)}},_ctl_varfrom_onchange:function(e,b,g,f,a){var d=this,c=d._tagVar;if(c){c.args=c.args||[];c.args[1]=e.properties.tagVar||g;d.markDirty(1)}},_ctl_varfrompath_onchange:function(e,b,g,f,a){var d=this,c=d._tagVar;if(c){c.args=c.args||[];c.args[2]=e.properties.tagVar||g;d.markDirty(1)}},_tv_var_onsel:function(a,b){if(b.sub&&!b._checked){a.boxing().toggleNode(b.id,true,false)}},getScope:function(b){var a=this,d=a.properties,c={};return{xui:xui,page:xui.get(d.parent,["_cls"])?xui.merge(xui.merge(xui.merge(c,d.parent._cls.Instance,"without"),d.parent.$host,"without"),xui.Module.prototype,"without"):{},prop:xui.get(d.cls,["Instance","properties"])||{},args:d.argsvar||[],functions:SPA.curProjectConfig&&SPA.curProjectConfig.$GlobalFunctions,constant:SPA.curProjectConfig&&SPA.curProjectConfig.$ConstantData,global:SPA.curProjectConfig&&SPA.curProjectConfig.$GlobalData}},_ignoreFuns1:{upper:1,Before:1,After:1,Constructor:1,constructor:1,Initialize:1},_ignoreFuns2:{addTemplateKeys:1,getTemplateKeys:1,buildCSSText:1,cacheData:1,getCachedData:1,setAppearance:1,getAppearance:1,getTemplate:1,setTemplate:1,pickAlias:1,plugIn:1,getBehavior:1,setBehavior:1,setDataModel:1,setEventHandlers:1,pickAlias:1,pack:1,plugIn:1},_tv_fun_opt:function(a,b){if(b.idn){CONF.openAPI(b.idn)}},_tv_fun_ongetcontent:function(b,r,o){var l=this,f=l.tv_var,s="spafont spa-icon-manual",e="spafont spa-icon-function",c="spafont spa-icon-array",g="spafont spa-icon-hash",m="spafont spa-icon-var",a=r.id,q=a.replace(/[{}]/g,""),d=/^\s*\{([\w]+)/.exec(a),n=d&&d[1],j=[];if(!n){o(j)}switch(n){case"xui":xui.each(xui.SC(q),function(x,u){var A=q+"."+u;if(A=="xui.Locale"||A=="xui.ini"||A=="xui.browser"||A=="xui.pseudocode"){return}if(l._ignoreFuns1[u]){return}if(x&&x.$abstract){return}if(l._ignoreFuns2[u]&&(A.indexOf("xui.CSSBox")===0||A.indexOf("xui.Timer")===0||A.indexOf("xui.AnimBinder")===0||A.indexOf("xui.MessageService")===0||A.indexOf("xui.DataBinder")===0||A.indexOf("xui.APICaller")===0||A.indexOf("xui.UI")===0||A.indexOf("xui.svg")===0)){return}if(u.charAt(0)=="_"||u.charAt(0)=="$"){return}if(typeof x=="function"){var w=xui.get(RAD.EditorTool.getDoc(A,false,true),"$desc")||"";if(x.$xuiclass$){j.push({id:"{"+A+"}",caption:u+(w?(" : "+w):""),tagCmds:[{buttonType:"text",tagCmdsAlign:"left",caption:"",itemClass:"xuicon xui-icon-question"}],idn:A,group:true,sub:true})}else{j.push({id:"{"+A+"()}",caption:u+l._getFunCap(A),tagCmds:[{buttonType:"text",tagCmdsAlign:"left",caption:"",itemClass:"xuicon xui-icon-question"}],idn:A,imageClass:e})}}else{if(xui.isHash(x)){j.push({id:"{"+A+"}",tagCmds:[{buttonType:"text",tagCmdsAlign:"left",caption:"",itemClass:"xuicon xui-icon-question"}],idn:A,caption:u,group:true,sub:true})}}});xui.arr.stableSort(j,function(u,w){if(u.group){if(!w.group){return 1}else{return u.id.toLowerCase()>w.id.toLowerCase()?1:u.id.toLowerCase()<w.id.toLowerCase()?-1:0}}else{if(w.group){return -1}else{return u.id.toLowerCase()>w.id.toLowerCase()?1:u.id.toLowerCase()<w.id.toLowerCase()?-1:0}}});break;default:if(r.__){xui.each(r["0"].boxing(),function(w,u){var x=r.__+".prototype."+u;if(u.charAt(0)=="_"||u.charAt(0)=="$"){return}if(typeof w=="function"){if(u=="toHtml"||u=="size"||u=="get"||u=="merge"||u=="each"||u=="host"||u=="render"||u=="renderOnto"){return}if(w.$event$){return}j.push({id:"{"+q+"."+u+"()}",caption:u+l._getFunCap(x),tagCmds:[{buttonType:"text",tagCmdsAlign:"left",caption:"",itemClass:"xuicon xui-icon-question"}],idn:x,imageClass:e})}})}}xui.arr.stableSort(j,function(u,w){if(u.group){if(!w.group){return -1}else{return u.id.toLowerCase()>w.id.toLowerCase()?1:u.id.toLowerCase()<w.id.toLowerCase()?-1:0}}else{if(w.group){return 1}return u.id.toLowerCase()>w.id.toLowerCase()?1:u.id.toLowerCase()<w.id.toLowerCase()?-1:0}});o(j)},_tv_var_ongetcontent:function(f,A,g){var F=this,d=F.properties,j=d.argsdoc,c=d.args,C=F.tv_var,E="spafont spa-icon-manual",a="spafont spa-icon-array",s="spafont spa-icon-hash",B="spafont spa-icon-var",q=[];var b=F.getScope();var m=xui.adjustVar(A.referer||A.id,b),o;if(A._paramName=="keyboard"){q=[{id:"{"+A.id.replace(/[{}]/g,"")+".key}",caption:"$(RAD.action.var.Keyboard Code)",imageClass:B},{id:"{"+A.id.replace(/[{}]/g,"")+".ctrlKey}",caption:"$(RAD.action.var.Ctrl Key)",imageClass:B},{id:"{"+A.id.replace(/[{}]/g,"")+".shiftKey}",caption:"$(RAD.action.var.Shift key)",imageClass:B},{id:"{"+A.id.replace(/[{}]/g,"")+".altKey}",caption:"$(RAD.action.var.Alt Key)",imageClass:B}];if(A._paramName=="keyboard"){Array.prototype.unshift.apply(q,[{id:"{"+A.id.replace(/[{}]/g,"")+".button}",caption:"$(RAD.action.var.Mouse Button)",imageClass:B},{id:"{"+A.id.replace(/[{}]/g,"")+".pageX}",caption:"$(RAD.action.var.Cursor PageX)",imageClass:B},{id:"{"+A.id.replace(/[{}]/g,"")+".pageY}",caption:"$(RAD.action.var.Cursor PageY)",imageClass:B}])}}else{if(xui.isArr(m)){for(var w=0,r=m.length;w<r;w++){o=m[w];q.push({id:"{"+A.id.replace(/[{}]/g,"")+"."+w+"}",caption:(xui.isArr(m[w])||xui.isHash(m[w]))?w:m[w],imageClass:xui.isArr(o)?a:xui.isHash(o)?s:B,sub:(xui.isArr(o)||xui.isHash(o))?true:null})}q.push({id:"{"+A.id.replace(/[{}]/g,"")+".length}",caption:"$(RAD.action.var.Array Length)",imageClass:E})}else{if(xui.isHash(m)){for(var w in m){o=m[w];q.push({id:"{"+A.id.replace(/[{}]/g,"")+"."+w+"}",caption:A.id.indexOf("{args[")===0?m[w]:w,imageClass:xui.isArr(o)?a:xui.isHash(o)?s:B,sub:(xui.isArr(o)||xui.isHash(o))?true:null})}q.push({id:"{"+A.id.replace(/[{}]/g,"")+".}",caption:"$(RAD.action.var.[key])",imageClass:E})}else{if(A.__){var u=m,e={getAlias:true,getProperties:true,serialize:true,isDestroyed:true,busy:true,free:true,reLayout:true,hide:true,show:true,refresh:true,adjustDock:true,isDirtied:true,checkValid:true,checkRequired:true,getUIValue:true,getData:true,setData:true,resetValue:true,clearValue:true,updateValue:true,updateDataFromUI:true,updateDataToUI:true,play:true,pause:true},n=function(l){return e[l]?l:"get"+xui.str.initial(l)};m=m.get(0).properties;m=xui.copy(m);if(u.Class["xui.absObj"]){xui.merge(m,{getAlias:true,getProperties:true,selectedItem:true,getCaptionValue:true,serialize:true})}if(u.Class["xui.UI"]){xui.merge(m,{isDestroyed:true,busy:true,free:true,reLayout:true,hide:true,show:true,refresh:true,adjustDock:true})}if(u.Class["xui.DataBinder"]){xui.merge(m,{isDirtied:true,checkValid:true,checkRequired:true,getUIValue:true,getData:true,setData:true,resetValue:true,clearValue:true,updateValue:true,updateDataFromUI:true,updateDataToUI:true})}else{if(u.Class["xui.UI.Audio"]){xui.merge(m,{play:true,pause:true})}else{if(u.Class["xui.UI.FusionChartsXT"]){xui.merge(m,{ChartAttribute:{},updateData:true,setTheme:true,fillData:true,refreshChart:true})}else{if(u.Class["xui.absContainer"]){xui.merge(m,{formValues:{},addPanel:true,removePanel:true,getPanelPara:true,dumpContainer:true,getPanelChildren:true,getFormValues:true,setFormValues:true,getFormElements:true,isDirtied:true,checkValid:true,checkRequired:true,formClear:true,formReset:true,updateFormValues:true,formSubmit:true})}else{if(u.Class["xui.UI.TreeGrid"]){xui.merge(m,{isDirtied:true,sortColumn:true,showColumn:true,getActiveRow:true,setActiveRow:true,updateRow:true,autoRowHeight:true,getCellbyRowCol:true,editCellbyRowCol:true,focusCellbyRowCol:true,getActiveCell:true,setActiveCell:true,updateCellByRowCol2:true,getEditor:true,updateEditor:true,getEditCell:true,offEditor:true})}}}}}for(var w in m){if(w.charAt(0)=="$"||w.charAt(0)=="_"){continue}o=m[w];var x=A.__+".prototype."+n(w);var D={id:"{"+A.id.replace(/[{}]/g,"")+"."+n(w)+"()}",caption:n(w)+F._getFunCap(x),tagCmds:[{buttonType:"text",tagCmdsAlign:"left",caption:"",itemClass:"xuicon xui-icon-question"}],idn:x,imageClass:xui.isArr(o)?a:xui.isHash(o)?s:B,sub:(xui.isArr(o)||xui.isHash(o))?true:null};if(A.referer){D.referer="{"+A.referer.replace(/[{}]/g,"")+"."+n(w)+"()}"}q.push(D)}xui.arr.stableSort(q,function(l,G){return l.id>G.id?1:l.id==G.id?0:-1})}}}}return q},_tb_actions_ondblclick:function(a,b,c,d){a.boxing().editItem(b.id)},events:{onReady:"_onready"},_onready:function(){var a=this.getAllComponents().reBoxing("xui.UI.Input");xui.filter(a._nodes,function(b){if(b.alias=="propFilter"){return false}if(b.alias=="ctl_animate"){return false}});this._enhanceInputs(a)},_editMixData:function(l,g,j,o,s,d){var n=this,r=n.add_target.getTagVar();if(l.getAlias()=="ctl_itemvar"&&r.keyN){var b=n.properties,q=b.parent,a=l.getRoot().xid(),c=n._tagVar,e=q.getByAlias(c.target,true);if(r.insert){var f=xui.get(c,["args",0])||[];q._showMixedEditor(e,e.key,"tagVar",r.keyN,f,a,function(A){var x=n._tagVar;if(x){x.args=x.args||[];if(A&&A.length){delete x._ignore}else{x._ignore=1}l.setTagVar(A,true);l.setInputReadonly(true).setCommandBtn("delete");l.setUIValue(o,true)}})}else{var f=xui.get(c,["args",1])||{};q._showEditor(e,e.key,r.keyN,f,a,function(A){var x=n._tagVar;if(x){x.args=x.args||[];if(A&&!xui.isEmpty(A)){delete x._ignore}else{x._ignore=1}l.setTagVar(A,true);l.setInputReadonly(true).setCommandBtn("delete");l.setUIValue(o,true)}},c.method=="updateCellByRowCol2"?CONF.widgets_itemsProp.rows["xui.UI.TreeGrid"].subheader:null)}}else{var u=xui.Coder.formatText(j),m=g=="function"?"funEditor":"jsonEditor",w=function(x){var A=g=="function"?xui.unserialize("function("+xui.fun.args(x).join(", ")+"){"+xui.fun.body(x)+"}"):xui.unserialize(x);l.setTagVar(A,true);l.setInputReadonly(true).setCommandBtn("delete");l.setUIValue(o,true)};if(window.SPA&&false===SPA.fe("beforeObjectEditorPop",[m,null,u,w,"RAD.ActionsEditor",l,d&&d.getSubNode("BOX").get(0),null,null,d&&d.boxing()])){return}xui.getModule(m,function(){this.setProperties({caption:o,imageClass:s,text:u,onOK:function(x){w(x.properties.result.code)}},true);this.show(function(A,x){})})}},iniPureValue:function(a,c){if(xui.isObj(c)){a.setTagVar(c);var b=b="#"+xui.adjustRes("$(RAD.action.var."+(typeof c=="function"?"Function":xui.isArr(c)?"Array":"Hash")+" Var)")+"#";a.setInputReadonly(true).setCommandBtn("delete");a.setValue(b,true)}else{a.setTagVar(null);a.setInputReadonly(false,true).setCommandBtn("none",true);a.setValue(c,true)}},_jsonedit:function(b,a){if(b=="value"){this._enhanceInputs(a,true)}},_enhanceInputs:function(a,d){var e=this,g=function(m){var l=m.properties.tagVar;if(m.properties.multiLines){return false}if(m.properties.inputReadonly){return 0}if(l=="none"){return false}switch(m.properties.type){case"file":case"spin":case"currency":case"number":case"listbox":return false}return true},c=function(o,m,r,q,l){if(!g(o)){return}var n=o.properties.tagVar;if(m!=r){e._autoNavTree(n,r)}},b=function(q,r,u){if(!g(q)){return true}var o=q.properties.tagVar;var n=q.boxing(),m=n.getUIValue();if(m&&/^\s*\{([\S]+)\}\s*$/.test(m)){var l=e._autoNavTree(o,m,true),s=xui.adjustRes("$(RAD.action.Var Path is)")+"&nbsp;<b>:</b>&nbsp;<span style='text-decoration: underline;'>"+l.join("</span>&nbsp;<b>&gt;</b>&nbsp;<span style='text-decoration: underline;'>")+"</span>";xui.Tips.show(u,"<div style='line-height:20px;'>"+s+"</div>")}else{if(m){xui.Tips.show(u,m)}}return false},f=function(l){if(l.properties.disabled||l.properties.readonly){return false}var s=g(l);if(s===0){var o=l.properties.tagVar,n=l.alias,q=l.boxing();if(!o||typeof(o)=="string"){return}var m=typeof o,u=l.properties.value,w=m=="function"?"spafont spa-icon-function":m=="array"?"spafont spa-icon-hash":" ";o=xui.serialize(o);e._editMixData(q,m,o,u,w,l);return}if(!g(l)){return}if(l.alias=="cb_callid"&&"callFunction"==e.tb_action.getUIValue()&&("module"==e._tagVar.type||"page"==e._tagVar.type)){if((!e.tv_fun.getTag()||l.alias!=e.tv_fun.getTag().alias)&&l.getSubNode("BOX").get(0).offsetWidth){e._buildVarTree3("module"==e._tagVar.type?e._tagVar.target:null);e.tv_fun.setTag(l);e._helperPop=e.tv_fun;e.blk_float2.getRoot().popToTop(l.getSubNode("BOX")).setBlurTrigger("-action-float-inxuib",function(){e._helperPop=null;e.tv_fun.setTag(null);e.blk_float2.hide();l.getSubNode("INPUT").blur()},xui([e.blk_float2.getRoot().xid(),l.getSubNode("BOX").xid()]));e._autoNavTree(r,l.boxing().getUIValue())}}else{var r=l.properties.tagVar;if(r=="callback"||r=="adjustdata"){if((!e.tv_fun.getTag()||l.alias!=e.tv_fun.getTag().alias)&&l.getSubNode("BOX").get(0).offsetWidth){e._buildVarTree2(r=="adjustdata");e.tv_fun.setTag(l);e._helperPop=e.tv_fun;e.blk_float2.getRoot().popToTop(l.getSubNode("BOX")).setBlurTrigger("-action-float-inxuib",function(){e._helperPop=null;e.tv_fun.setTag(null);e.blk_float2.hide();l.getSubNode("INPUT").blur()},xui([e.blk_float2.getRoot().xid(),l.getSubNode("BOX").xid()]));e._autoNavTree(r,l.boxing().getUIValue())}}else{if((!e.tv_var.getTag()||l.alias!=e.tv_var.getTag().alias)&&l.getSubNode("BOX").get(0).offsetWidth){e._buildVarTree(l);e.tv_var.setTag(l);e._helperPop=e.tv_var;e.blk_float.getRoot().popToTop(l.getSubNode("BOX")).setBlurTrigger("-action-float-inxuib",function(){e.tv_var.setTag(null);e._helperPop=null;e.blk_float.hide();l.getSubNode("INPUT").blur()},xui([e.blk_float.getRoot().xid(),l.getSubNode("BOX").xid()]));e._autoNavTree(r,l.boxing().getUIValue())}}}xui.asyRun(function(){var B=l.boxing().getUIValue();var C=l.getSubNode("INPUT"),D,A=0,x=0;if(B=="{}"){A=x=1}else{if(/\(\'[^']*\'\)/.test(B)){A=B.indexOf("'")+1;x=B.lastIndexOf("'")}else{if(/\(\"[^"]*\"\)/.test(B)){A=B.indexOf('"')+1;x=B.lastIndexOf('"')}else{D=B.lastIndexOf("}");if(D!=-1){A=x=D}}}}l.$ignoreFocus=1;C.focus();C.caret(A,x);delete l.$ignoreFocus});return false},j=function(m,l){if(e._potentialStep&&(l.key=="tab")){m.boxing().setUIValue(e._potentialStep,true);return false}else{if(l.key=="up"||l.key=="esc"){e._xui_closefloat(m);return false}else{if(l.key=="down"){f(m)}}}};if(!d){a.setDynCheck(true,true)}a.onShowTips(b).beforeFocus(f)._onChange(c).onHotKeydown(j).each(function(m){if(m.properties.multiLines){return}if(m.properties.tagVar=="none"){return}switch(m.properties.type){case"file":case"spin":case"currency":case"number":case"listbox":return}var l=m.properties.tagVar=="callback"||m.properties.tagVar=="adjustdata";m.boxing().setCustomStyle({INPUT:"background-color:"+(l?"#00FFFF":"#FFF8DC")+";color:"+(l?"#000000":"#000000")})});e.grid_params.updateHeader("value",{editorProperties:{dynCheck:true},editorCS:{INPUT:"background-color:#FFF8DC"},editorEvents:{onShowTips:b,beforeFocus:f,_onChange:c,onHotKeydown:j,onCommand:function(l){l.boxing().setTagVar(null,true);l.boxing().setCommandBtn("none",true).setInputReadonly(false,true).setUIValue("",true);xui.asyRun(function(){l.boxing().activate()})}}})},_xui_closefloat:function(b,d,c){var a=this;if(a._helperPop==a.tv_fun){a.tv_fun.setTag(null);a.blk_float2.hide()}else{a.tv_var.setTag(null);a.blk_float.hide()}a._helperPop=null}}});xui.Class("RAD.CustomBoxShadow","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"mainPane").setLeft("5.833333333333333em").setTop("3.3333333333333335em").setWidth("18.333333333333332em").setHeight("20em").setShadow(false).setResizer(false).setCaption("$(RAD.custom_dlg.shadow.Custom Box Shadow)").setMinBtn(false).setMaxBtn(false).beforeClose("_ctl_panel4_beforeclose"));c.mainPane.append(xui.create("xui.UI.Block").setHost(c,"bg").setDock("fill").setBorderType("inset").setOverflow("hidden"));c.bg.append(xui.create("xui.UI.ComboInput").setHost(c,"sd_clr").setDirtyMark(false).setLeft("0.75em").setTop("3.3333333333333335em").setWidth("15.833333333333334em").setLabelSize(100).setLabelGap("5.333333333333333px").setLabelCaption("$(RAD.custom_dlg.shadow.Shadow Color)").setType("color").afterUIValueSet("_t_sd_afteruivalueset"));c.bg.append(xui.create("xui.UI.CheckBox").setHost(c,"c_inset").setDirtyMark(false).setLeft("9.083333333333334em").setTop("0.8333333333333334em").setWidth("7.5em").setCaption("$RAD.custom_dlg.shadow.Inset").afterValueSet("_t_sd_afteruivalueset"));c.bg.append(xui.create("xui.UI.ComboInput").setHost(c,"sd_hl").setDirtyMark(false).setLeft("0.75em").setTop("6em").setWidth("15.833333333333334em").setLabelSize(100).setLabelGap("5.333333333333333px").setLabelCaption("$(RAD.custom_dlg.shadow.Horizontal Length)").setType("counter").setUnit("px").setPrecision(0).setIncrement(1).setMin(0).setMax(100).onChange("_sd_hl_onchange"));c.bg.append(xui.create("xui.UI.ComboInput").setHost(c,"sd_vl").setDirtyMark(false).setLeft("0.75em").setTop("8.916666666666666em").setWidth("15.833333333333334em").setLabelSize(100).setLabelGap("5.333333333333333px").setLabelCaption("$(RAD.custom_dlg.shadow.Vertical Length)").setType("counter").setUnit("px").setPrecision(0).setIncrement(1).setMin(0).setMax(100).onChange("_sd_vl_onchange"));c.bg.append(xui.create("xui.UI.ComboInput").setHost(c,"sd_br").setDirtyMark(false).setLeft("0.75em").setTop("11.583333333333334em").setWidth("15.833333333333334em").setLabelSize(100).setLabelGap("5.333333333333333px").setLabelCaption("$(RAD.custom_dlg.shadow.Blur Radius)").setType("counter").setUnit("px").setPrecision(0).setIncrement(1).setMin(0).setMax(100).onChange("_sd_br_onchange"));c.bg.append(xui.create("xui.UI.ComboInput").setHost(c,"sd_sr").setDirtyMark(false).setLeft("0.75em").setTop("14.166666666666666em").setWidth("15.833333333333334em").setLabelSize(100).setLabelGap("5.333333333333333px").setLabelCaption("$(RAD.custom_dlg.shadow.Spread Radius)").setType("counter").setUnit("px").setPrecision(0).setIncrement(1).setMin(0).setMax(100).onChange("_sd_sr_onchange"));return b},_getValues:function(){var a=this;return{hl:parseInt(a.sd_hl.getValue()),vl:parseInt(a.sd_vl.getValue()),br:a.sd_br.getValue(),sr:a.sd_sr.getValue(),clr:a.sd_clr.getValue(),inset:a.c_inset.getValue()}},_t_sd_afteruivalueset:function(a){xui.resetRun("boxShadow",this.setBR,0,null,this)},setBR:function(){var b=this._getValues(),a;if(!(b.clr||parseInt(b.hl)||parseInt(b.vl)||parseInt(b.br)||parseInt(b.sr))){a=""}else{a=(b.inset?("inset "):"")+b.hl+"px "+b.vl+"px "+b.br+"px "+b.sr+"px "+b.clr}this.fireEvent("onChange",[a])},init:function(f,g,b,m){var n=this;xui.merge(n.properties,b,"all");var o=((m==2?g:xui.get(f.CS,[g,"box-shadow"]))||"").toLowerCase(),c,l,d,e,q,a,s,j=1,r;if(o){o=o.replace(/(?:rgb\((\d+), ?(\d+), ?(\d+)\)([^,]*))+/g,function(w,u,B,A,x){return"#"+xui.UI.ColorPicker.rgb2hex(u,B,A)+x});o=o.replace(/(?:rgba\((\d+), ?(\d+), ?(\d+), ?([.\d]+)\)([^,]*))+/g,function(w,u,C,B,A,x){j=parseFloat(A)||1;return"#"+xui.UI.ColorPicker.rgb2hex(u,C,B)+x});xui.arr.each(o.split(/\s/),function(u){if(/#/.test(u)){s=u}else{if("inset"==u){r="inset"}else{if(!xui.isDefined(d)){d=parseFloat(u)||0}else{if(!xui.isDefined(e)){e=parseFloat(u)||0}else{if(!xui.isDefined(q)){q=parseFloat(u)||0}else{if(!xui.isDefined(a)){a=parseFloat(u)||0}}}}}}})}if(!s){d=e=q=a=0;s=r=""}n.c_inset.setValue(r=="inset");n.sd_hl.setValue(d||0,true);n.sd_vl.setValue(e||0,true);n.sd_br.setValue(q||0,true);n.sd_sr.setValue(a||0,true);n.sd_clr.setValue(s||0,true)},_ctl_panel4_beforeclose:function(a){a.boxing().hide();return false},_sd_hl_onchange:function(a){this._t_sd_afteruivalueset(a)},_sd_vl_onchange:function(a){this._t_sd_afteruivalueset(a)},_sd_br_onchange:function(a){this._t_sd_afteruivalueset(a)},_sd_sr_onchange:function(a){this._t_sd_afteruivalueset(a)}}});xui.Class("RAD.CustomTransform","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"mainPane").setLeft("3.125em").setTop("0em").setWidth("32.666666666666664em").setHeight("14.916666666666666em").setShadow(false).setResizer(false).setCaption("$(RAD.custom_dlg.trans.Custom Transform)").setMinBtn(false).setMaxBtn(false).setOverflow("hidden").beforeClose("_ctl_panel4_beforeclose"));c.mainPane.append(xui.create("xui.UI.Block").setHost(c,"bg").setDock("fill").setBorderType("inset").setOverflow("hidden"));c.bg.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel4").setLeft("0.9166666666666666em").setTop("6.25em").setWidth("5.25em").setCaption("$(RAD.custom_dlg.trans.Scale X)").setHAlign("left"));c.bg.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel63").setLeft("16.916666666666668em").setTop("6.25em").setWidth("5.25em").setCaption("$(RAD.custom_dlg.trans.Scale Y)").setHAlign("left"));c.bg.append(xui.create("xui.UI.Label").setHost(c,"ctl_lblSkewX").setLeft("0.9166666666666666em").setTop("8.75em").setWidth("5.25em").setCaption("$(RAD.custom_dlg.trans.Skew X)").setHAlign("left"));c.bg.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel6").setLeft("0.9166666666666666em").setTop("3.75em").setWidth("5.25em").setCaption("$(RAD.custom_dlg.trans.Translate X)").setHAlign("left"));c.bg.append(xui.create("xui.UI.Slider").setHost(c,"t_Rotate").setDirtyMark(false).setLeft("6.666666666666667em").setTop("0.8333333333333334em").setWidth("25em").setHeight("1.875em").setSteps(360).setIsRange(false).setValue("0").afterUIValueSet("_t_cs_afteruivalueset"));c.bg.append(xui.create("xui.UI.Slider").setHost(c,"t_ScaleY").setDirtyMark(false).setLeft("22.25em").setTop("5.916666666666667em").setWidth("9.375em").setHeight("1.875em").setSteps(200).setIsRange(false).setValue("0").afterUIValueSet("_t_cs_afteruivalueset"));c.bg.append(xui.create("xui.UI.Slider").setHost(c,"t_ScaleX").setDirtyMark(false).setLeft("6.583333333333333em").setTop("5.916666666666667em").setWidth("9.375em").setHeight("1.875em").setSteps(200).setIsRange(false).setValue("0").afterUIValueSet("_t_cs_afteruivalueset"));c.bg.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel3").setLeft("0.9166666666666666em").setTop("1.25em").setWidth("5.25em").setCaption("$(RAD.custom_dlg.trans.Rotate)").setHAlign("left"));c.bg.append(xui.create("xui.UI.Label").setHost(c,"ctl_lblSkewY").setLeft("16.916666666666668em").setTop("8.75em").setWidth("5.25em").setCaption("$(RAD.custom_dlg.trans.Skew Y)").setHAlign("left"));c.bg.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel65").setLeft("16.916666666666668em").setTop("3.75em").setWidth("5.25em").setCaption("$(RAD.custom_dlg.trans.Translate Y)").setHAlign("left"));c.bg.append(xui.create("xui.UI.Slider").setHost(c,"t_SkewX").setDirtyMark(false).setLeft("6.583333333333333em").setTop("8.416666666666666em").setWidth("9.375em").setHeight("1.875em").setSteps(360).setIsRange(false).setValue("0").afterUIValueSet("_t_cs_afteruivalueset"));c.bg.append(xui.create("xui.UI.Slider").setHost(c,"t_SkewY").setDirtyMark(false).setLeft("22.25em").setTop("8.416666666666666em").setWidth("9.375em").setHeight("1.875em").setSteps(360).setIsRange(false).setValue("0").afterUIValueSet("_t_cs_afteruivalueset"));c.bg.append(xui.create("xui.UI.Slider").setHost(c,"t_TransY").setDirtyMark(false).setLeft("22.25em").setTop("3.3333333333333335em").setWidth("9.375em").setHeight("1.875em").setSteps(200).setIsRange(false).setValue("0").afterUIValueSet("_t_cs_afteruivalueset"));c.bg.append(xui.create("xui.UI.Slider").setHost(c,"t_TransX").setDirtyMark(false).setLeft("6.583333333333333em").setTop("3.3333333333333335em").setWidth("9.375em").setHeight("1.875em").setSteps(200).setIsRange(false).setValue("4").afterUIValueSet("_t_cs_afteruivalueset"));return b},_getValues:function(){var a=this;return{rotate:parseInt(a.t_Rotate.getValue()),scale:[parseInt(a.t_ScaleX.getValue())/100,parseInt(a.t_ScaleY.getValue())/100],skew:[parseInt(a.t_SkewX.getValue())-180,parseInt(a.t_SkewY.getValue())-180],translate:[parseInt(a.t_TransX.getValue())-100,parseInt(a.t_TransY.getValue())-100]}},_t_cs_afteruivalueset:function(a){xui.resetRun("border_transform",this.setBR,0,null,this)},setBR:function(){var c=this,d=c.properties,d;var b=this._getValues(),a;if(d.isSvg){if(!(parseInt(c.t_Rotate.getValue())||parseInt(c.t_ScaleX.getValue(100))||parseInt(c.t_ScaleY.getValue(100))||parseInt(c.t_TransX.getValue())||parseInt(c.t_TransY.getValue()))){a=""}else{a="r"+b.rotate+"s"+b.scale.join(",")+"t"+b.translate.join(",");a=a.replace("t0,0","").replace("s1,1","").replace("r0","")}}else{if(!(parseInt(c.t_Rotate.getValue())||parseInt(c.t_ScaleX.getValue(100))||parseInt(c.t_ScaleY.getValue(100))||parseInt(c.t_SkewX.getValue())||parseInt(c.t_SkewY.getValue())||parseInt(c.t_TransX.getValue())||parseInt(c.t_TransY.getValue()))){a=""}else{a=((b.translate[0]||b.translate[1])?("translate("+b.translate.join("px,")+"px) "):"")+(b.rotate?("rotate("+b.rotate+"deg) "):"")+((b.scale[0]!=1||b.scale[1]!=1)?("scale("+b.scale.join(",")+") "):"")+((b.skew[0]||b.skew[1])?("skew("+b.skew.join("deg,")+"deg)"):"")}}this.fireEvent("onChange",[a])},init:function(m,f,c,d){var x=this;xui.merge(x.properties,c,"all");if(c.isSvg){x.ctl_lblSkewX.setDisplay("none",true);x.ctl_lblSkewY.setDisplay("none",true);x.t_SkewX.setDisplay("none",true);x.t_SkewY.setDisplay("none",true);var g=c.cell.value||"",a=Raphael.parseTransformString(g),r=0,l=100,j=100,u=100,s=100;xui.arr.each(a,function(A){switch(A[0]){case"r":r=xui.isSet(A[1])?A[1]:0;break;case"s":l=(xui.isSet(A[1])?A[1]:0)*100;j=(xui.isSet(A[2])?A[2]:0)*100;break;case"t":u=(xui.isSet(A[1])?A[1]:0)+100;s=(xui.isSet(A[2])?A[2]:0)+100;break}});x.t_Rotate.setValue(r);x.t_ScaleX.setValue(l);x.t_ScaleY.setValue(j);x.t_TransX.setValue(u);x.t_TransY.setValue(s)}else{var g=d==2?f:xui.get(m.CS,[f,"transform"]),a=[null,0,1,1,0,0,0,0];if(g){var n=(g||"").match(/[A-z]+\([^\)]+/g)||[];for(var q=0;q<n.length;q++){var w=n[q].split("("),e=w[0],o=w[1],b;switch(e){case"rotate":a[1]=parseFloat(o);break;case"scale":b=o.split(",");a[2]=parseFloat(b[0]);a[3]=parseFloat(b[1]);break;case"scaleX":a[2]=parseFloat(b);break;case"scaleY":a[3]=parseFloat(o);break;case"skew":b=o.split(",");a[4]=parseFloat(b[0]);a[5]=parseFloat(b[1]);break;case"skewX":a[4]=parseFloat(o);break;case"skewY":a[5]=parseFloat(o);break;case"translate":b=o.split(",");a[6]=parseFloat(b[0]);a[7]=parseFloat(b[1]);break;case"translateX":a[6]=parseFloat(o);break;case"translateY":a[7]=parseFloat(o);break}}}x.ctl_lblSkewX.setDisplay("",true);x.ctl_lblSkewY.setDisplay("",true);x.t_SkewX.setDisplay("",true);x.t_SkewY.setDisplay("",true);a[1]=parseFloat(a[1]);a[2]=100*parseFloat(a[2]);a[3]=100*parseFloat(a[3]);a[4]=180+parseInt(a[4]);a[5]=180+parseInt(a[5]);a[6]=100+parseInt(a[6]);a[7]=100+parseInt(a[7]);x.t_Rotate.setValue(a[1]);x.t_ScaleX.setValue(a[2]);x.t_ScaleY.setValue(a[3]);x.t_SkewX.setValue(a[4]);x.t_SkewY.setValue(a[5]);x.t_TransX.setValue(a[6]);x.t_TransY.setValue(a[7])}},_ctl_panel4_beforeclose:function(a){a.boxing().hide();return false}}});xui.Class("RAD.CustomGradients","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"mainPane").setLeft("4.375em").setTop("1.875em").setWidth("30.583333333333332em").setHeight("24.416666666666668em").setShadow(false).setResizer(false).setCaption("$(RAD.custom_dlg.gradlg.Custom Gradients)").setMinBtn(false).setMaxBtn(false).beforeClose("_ctl_panel4_beforeclose"));c.mainPane.append(xui.create("xui.UI.Block").setHost(c,"bg").setDock("fill").setBorderType("inset").setOverflow("hidden"));c.bg.append(xui.create("xui.UI.Group").setHost(c,"ctl_group11").setLeft("0.8333333333333334em").setTop("0.125em").setWidth("27.5em").setHeight("5.25em").setOverflow("hidden").setCaption("$(RAD.custom_dlg.Color Patterns)").setCustomStyle({PANEL:"padding:2px;"}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr1").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#4ba3cc"},{pos:"50%",clr:"#3289B2"},{pos:"100%",clr:"#3899C6"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr2").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#A5B8DA"},{pos:"50%",clr:"#7089B3"},{pos:"100%",clr:"#819bcb"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr3").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#ffd65e"},{pos:"50%",clr:"#febf04"},{pos:"100%",clr:"#ffc926"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr4").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#606c88"},{pos:"50%",clr:"#3f4c6b"},{pos:"100%",clr:"#4b546a"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr5").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#d5cea6"},{pos:"50%",clr:"#b7ad70"},{pos:"100%",clr:"#c5bb83"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr6").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#a90329"},{pos:"50%",clr:"#6d0019"},{pos:"100%",clr:"#77021d"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr7").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#4ba614"},{pos:"50%",clr:"#008c00"},{pos:"100%",clr:"#36780f"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr8").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#ff5db1"},{pos:"50%",clr:"#ef007c"},{pos:"100%",clr:"#ff2a98"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span500").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#7d7e7d"},{pos:"50%",clr:"#0e0e0e"},{pos:"100%",clr:"#819bcb"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span501").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#cef8ff"},{pos:"50%",clr:"#7fe0f8"},{pos:"100%",clr:"#9bf1ff"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span502").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#f2f9fe"},{pos:"50%",clr:"#d6f0fd"},{pos:"100%",clr:"#c3e3fa"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span503").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#fb83fa"},{pos:"50%",clr:"#e93cec"},{pos:"100%",clr:"#f952f8"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span504").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#3093c7"},{pos:"50%",clr:"#1c5a85"},{pos:"100%",clr:"#26759e"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span505").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#a9db80"},{pos:"50%",clr:"#96c56f"},{pos:"100%",clr:"#8ed058"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span506").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#A5B8DA"},{pos:"50%",clr:"#7089B3"},{pos:"100%",clr:"#819bcb"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span507").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#b29af8"},{pos:"50%",clr:"#9174ed"},{pos:"100%",clr:"#8e6af5"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span508").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#f2f5f6"},{pos:"50%",clr:"#c8d7dc"},{pos:"100%",clr:"#d4dee1"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span509").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#ffc579"},{pos:"50%",clr:"#fb9d23"},{pos:"100%",clr:"#ffaf46"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span510").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#d3d3d3"},{pos:"50%",clr:"#707070"},{pos:"100%",clr:"#bababa"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span511").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#fcfac0"},{pos:"50%",clr:"#f6f283"},{pos:"100%",clr:"#faf68f"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span512").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#f4f5f5"},{pos:"50%",clr:"#dfdddd"},{pos:"100%",clr:"#d9dddd"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span513").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#f7e3e3"},{pos:"50%",clr:"#ffd7d7"},{pos:"100%",clr:"#ecbbbb"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span514").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#ff9a9a"},{pos:"50%",clr:"#ff4040"},{pos:"100%",clr:"#ff6767"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span515").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#a9a588"},{pos:"50%",clr:"#8e865b"},{pos:"100%",clr:"#938e6b"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span516").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#f62b2b"},{pos:"50%",clr:"#d20202"},{pos:"100%",clr:"#e40a0a"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span517").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#a67939"},{pos:"50%",clr:"#845108"},{pos:"100%",clr:"#805d2c"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span518").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#d2d2f9"},{pos:"50%",clr:"#a6a6f2"},{pos:"100%",clr:"#a5a5f3"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span519").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#49c0f0"},{pos:"50%",clr:"#2cafe3"},{pos:"100%",clr:"#1ab0ec"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span520").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#cedce7"},{pos:"50%",clr:"#596a72"},{pos:"100%",clr:"#acc4d6"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span521").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#b6e026"},{pos:"50%",clr:"#abdc28"},{pos:"100%",clr:"#95b91a"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span522").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#eab92d"},{pos:"50%",clr:"#c79810"},{pos:"100%",clr:"#cf9f15"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span523").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#45484d"},{pos:"50%",clr:"#000"},{pos:"100%",clr:"#819bcb"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span524").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#6bbed2"},{pos:"50%",clr:"#76bdd1"},{pos:"100%",clr:"#6bbed2"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span525").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#6bbed2"},{pos:"50%",clr:"#23538a"},{pos:"100%",clr:"#82bbd1"}],type:"linear",orient:"T"}}}));c.bg.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel26").setLeft("2.3333333333333335em").setTop("6.5em").setWidth("4em").setHeight("0.875em").setCaption("$RAD.custom_dlg.gradlg.Orientation").setHAlign("left"));c.bg.append(xui.create("xui.UI.ComboInput").setHost(c,"t_otype").setDirtyMark(false).setLeft("7.416666666666667em").setTop("6.25em").setWidth("13.416666666666666em").setType("listbox").setItems([{id:"linear-LT",caption:"$(RAD.custom_dlg.gradlg.Linear $- from LeftTop)"},{id:"linear-T",caption:"$(RAD.custom_dlg.gradlg.Linear $- from Top)"},{id:"linear-RT",caption:"$(RAD.custom_dlg.gradlg.Linear $- from RightTop)"},{id:"linear-R",caption:"$(RAD.custom_dlg.gradlg.Linear $- from Right)"},{id:"linear-RB",caption:"$(RAD.custom_dlg.gradlg.Linear $- from RightBottom)"},{id:"linear-B",caption:"$(RAD.custom_dlg.gradlg.Linear $- from Bottom)"},{id:"linear-LB",caption:"$(RAD.custom_dlg.gradlg.Linear $- from LeftBottom)"},{id:"linear-L",caption:"$(RAD.custom_dlg.gradlg.Linear $- from Left)"},{id:"radial-C",caption:"$(RAD.custom_dlg.gradlg.Radial $- at Center)"},{id:"radial-LT",caption:"$(RAD.custom_dlg.gradlg.Radial $- at LeftTop)"},{id:"radial-T",caption:"$(RAD.custom_dlg.gradlg.Radial $- at Top)"},{id:"radial-RT",caption:"$(RAD.custom_dlg.gradlg.Radial $- at RightTop)"},{id:"radial-R",caption:"$(RAD.custom_dlg.gradlg.Radial $- at Right)"},{id:"radial-RB",caption:"$(RAD.custom_dlg.gradlg.Radial $- at RightBottom)"},{id:"radial-B",caption:"$(RAD.custom_dlg.gradlg.Radial $- at Bottom)"},{id:"radial-LB",caption:"$(RAD.custom_dlg.gradlg.Radial $- at LeftBottom)"},{id:"radial-L",caption:"$(RAD.custom_dlg.gradlg.Radial $- at Left)"}]).setValue("linear-T").afterUIValueSet("_t_sd_afteruivalueset"));c.bg.append(xui.create("xui.UI.Block").setHost(c,"ctl_block3").setLeft("1.25em").setTop("8.75em").setWidth("27.333333333333332em").setHeight("1.5833333333333333em").setBorderType("inset").setOverflow("hidden"));c.ctl_block3.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel5").setLeft("23.25em").setTop("0.1875em").setCaption("$RAD.custom_dlg.gradlg.Opacity"));c.ctl_block3.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel4").setLeft("18.125em").setTop("0.1875em").setCaption("$RAD.custom_dlg.gradlg.Color"));c.ctl_block3.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel3").setLeft("9.875em").setTop("0.1875em").setCaption("$RAD.custom_dlg.gradlg.Offset"));c.ctl_block3.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel6").setLeft("1.875em").setTop("0.125em").setCaption("$RAD.custom_dlg.gradlg.Stops"));c.bg.append(xui.create("xui.UI.Block").setHost(c,"ctl_block7").setLeft("1.25em").setTop("10.333333333333334em").setWidth("27.333333333333332em").setBorderType("inset").setOverflow("hidden"));c.ctl_block7.append(xui.create("xui.UI.Slider").setHost(c,"g_step1").setDirtyMark(false).setDisabled(true).setLeft("5.583333333333333em").setTop("0.4166666666666667em").setWidth("10.166666666666666em").setHeight("1.875em").setSteps(100).setIsRange(false).setValue("0").afterUIValueSet("_t_sd_afteruivalueset"));c.ctl_block7.append(xui.create("xui.UI.ComboInput").setHost(c,"g_step1clr").setDirtyMark(false).setDisabled(true).setLeft("15.833333333333334em").setTop("0.4166666666666667em").setWidth("6.583333333333333em").setType("color").afterUIValueSet("_t_sd_afteruivalueset"));c.ctl_block7.append(xui.create("xui.UI.Slider").setHost(c,"g_step2").setDirtyMark(false).setDisabled(true).setLeft("5.583333333333333em").setTop("2.8333333333333335em").setWidth("10.166666666666666em").setHeight("1.875em").setSteps(100).setIsRange(false).setValue("0").afterUIValueSet("_t_sd_afteruivalueset"));c.ctl_block7.append(xui.create("xui.UI.ComboInput").setHost(c,"g_step2clr").setDirtyMark(false).setDisabled(true).setLeft("15.833333333333334em").setTop("2.8333333333333335em").setWidth("6.583333333333333em").setType("color").afterUIValueSet("_t_sd_afteruivalueset"));c.ctl_block7.append(xui.create("xui.UI.Slider").setHost(c,"g_step3").setDirtyMark(false).setDisabled(true).setLeft("5.583333333333333em").setTop("5.166666666666667em").setWidth("10.166666666666666em").setHeight("1.875em").setSteps(100).setIsRange(false).setValue("0").afterUIValueSet("_t_sd_afteruivalueset"));c.ctl_block7.append(xui.create("xui.UI.ComboInput").setHost(c,"g_step3clr").setDirtyMark(false).setDisabled(true).setLeft("15.833333333333334em").setTop("5.166666666666667em").setWidth("6.583333333333333em").setType("color").afterUIValueSet("_t_sd_afteruivalueset"));c.ctl_block7.append(xui.create("xui.UI.CheckBox").setHost(c,"c_step1").setDirtyMark(false).setLeft("0.5em").setTop("0.5em").setCaption("$(RAD.custom_dlg.gradlg.Stop 1)").afterValueSet("_c_step1_aftervalueset"));c.ctl_block7.append(xui.create("xui.UI.CheckBox").setHost(c,"c_step2").setDirtyMark(false).setLeft("0.5em").setTop("2.9166666666666665em").setCaption("$(RAD.custom_dlg.gradlg.Stop 2)").afterValueSet("_c_step2_aftervalueset"));c.ctl_block7.append(xui.create("xui.UI.CheckBox").setHost(c,"c_step3").setDirtyMark(false).setLeft("0.5em").setTop("5.25em").setCaption("$(RAD.custom_dlg.gradlg.Stop 3)").afterValueSet("_c_step3_aftervalueset"));c.ctl_block7.append(xui.create("xui.UI.Slider").setHost(c,"g_step4").setDirtyMark(false).setDisabled(true).setLeft("5.583333333333333em").setTop("7.583333333333333em").setWidth("10.166666666666666em").setHeight("1.875em").setSteps(100).setIsRange(false).setValue("0").afterUIValueSet("_t_sd_afteruivalueset"));c.ctl_block7.append(xui.create("xui.UI.ComboInput").setHost(c,"g_step4clr").setDirtyMark(false).setDisabled(true).setLeft("15.833333333333334em").setTop("7.583333333333333em").setWidth("6.583333333333333em").setType("color").afterUIValueSet("_t_sd_afteruivalueset"));c.ctl_block7.append(xui.create("xui.UI.CheckBox").setHost(c,"c_step4").setDirtyMark(false).setLeft("0.5em").setTop("7.666666666666667em").setCaption("$(RAD.custom_dlg.gradlg.Stop 4)").afterValueSet("_c_step4_aftervalueset"));c.ctl_block7.append(xui.create("xui.UI.ComboInput").setHost(c,"g_step1o").setDirtyMark(false).setDisabled(true).setLeft("22.5em").setTop("0.4166666666666667em").setWidth("4.333333333333333em").setType("spin").setIncrement(0.1).setMin(0).setMax(1).setValue(1).afterUIValueSet("_t_sd_afteruivalueset"));c.ctl_block7.append(xui.create("xui.UI.ComboInput").setHost(c,"g_step2o").setDirtyMark(false).setLeft("22.5em").setTop("2.8333333333333335em").setWidth("4.333333333333333em").setType("spin").setIncrement(0.1).setMin(0).setMax(1).setValue(1).afterUIValueSet("_t_sd_afteruivalueset"));c.ctl_block7.append(xui.create("xui.UI.ComboInput").setHost(c,"g_step3o").setDirtyMark(false).setLeft("22.5em").setTop("5.166666666666667em").setWidth("4.333333333333333em").setType("spin").setIncrement(0.1).setMin(0).setMax(1).setValue(1).afterUIValueSet("_t_sd_afteruivalueset"));c.ctl_block7.append(xui.create("xui.UI.ComboInput").setHost(c,"g_step4o").setDirtyMark(false).setLeft("22.5em").setTop("7.583333333333333em").setWidth("4.333333333333333em").setType("spin").setIncrement(0.1).setMin(0).setMax(1).setValue(0).afterUIValueSet("_t_sd_afteruivalueset"));c.bg.append(xui.create("xui.UI.Button").setHost(c,"xui_ui_button8").setLeft("22.5em").setTop("6.166666666666667em").setWidth("5.833333333333333em").setCaption("$(RAD.Clear)").onClick("_xui_ui_button8_onclick"));return b},_getValues:function(){var d=this,a=[],c,b;if(d.c_step1.getValue()){c={pos:d.g_step1.getValue()+"%",clr:d.g_step1clr.getValue()||"#ffffff"};b=d.g_step1o.getValue();if(parseInt(b*100)!=100){c.opacity=b}a.push(c)}if(d.c_step2.getValue()){c={pos:d.g_step2.getValue()+"%",clr:d.g_step2clr.getValue()||"#ffffff"};b=d.g_step2o.getValue();if(parseInt(b*100)!=100){c.opacity=b}a.push(c)}if(d.c_step3.getValue()){c={pos:d.g_step3.getValue()+"%",clr:d.g_step3clr.getValue()||"#ffffff"};b=d.g_step3o.getValue();if(parseInt(b*100)!=100){c.opacity=b}a.push(c)}if(d.c_step4.getValue()){c={pos:d.g_step4.getValue()+"%",clr:d.g_step4clr.getValue()||"#ffffff"};b=d.g_step4o.getValue();if(parseInt(b*100)!=100){c.opacity=b}a.push(c)}if(a.length){xui.arr.stableSort(a,function(e,f){return parseFloat(e.pos)>parseFloat(f.pos)?1:parseFloat(e.pos)==parseFloat(f.pos)?0:-1})}return a},_t_sd_afteruivalueset:function(a){xui.resetRun("Gradients",this.setTS,0,null,this)},setTS:function(){if(this._in_init){return}var a=this,b=a.t_otype.getValue();xui.resetRun("cgradies:"+this.$xid,function(){var c={stops:a._getValues()};b=b.split("-");c.type=b[0];c.orient=b[1];if(c.stops.length<=0){c=null}a.fireEvent("onChange",[c])})},init:function(e,d,g,c){var b=this;xui.merge(b.properties,g,"all");b._in_init=1;var a=c==2?d:xui.get(e.CS,[d,"$gradient"]),c,f;if(!a){a={}}if(!a.type){a.type="linear"}if(!a.orient){a.orient="T"}if(!a.point){a.point="left"}if(!a.stops){a.stops=[]}c=a.type+"-"+a.orient;b.t_otype.setValue(c);if(a.stops.length>0){b.c_step1.setValue(true,true);b.g_step1.setValue(a.stops[0].pos||0);b.g_step1clr.setValue(a.stops[0].clr||"");f=a.stops[0].opacity;b.g_step1o.setValue((f||f===0)?f:1)}else{b.c_step1.setValue(false,true);b.g_step1.setValue(0);b.g_step1clr.setValue("");b.g_step1o.setValue(1)}if(a.stops.length>1){b.c_step2.setValue(true,true);b.g_step2.setValue(a.stops[1].pos||0);b.g_step2clr.setValue(a.stops[1].clr||"");f=a.stops[1].opacity;b.g_step2o.setValue((f||f===0)?f:1)}else{b.c_step2.setValue(false,true);b.g_step2.setValue(0);b.g_step2clr.setValue("");b.g_step2o.setValue(1)}if(a.stops.length>2){b.c_step3.setValue(true,true);b.g_step3.setValue(a.stops[2].pos||0);b.g_step3clr.setValue(a.stops[2].clr||"");f=a.stops[2].opacity;b.g_step3o.setValue((f||f===0)?f:1)}else{b.c_step3.setValue(false,true);b.g_step3.setValue(0);b.g_step3clr.setValue("");b.g_step3o.setValue(1)}if(a.stops.length>3){b.c_step4.setValue(true,true);b.g_step4.setValue(a.stops[3].pos||0);b.g_step4clr.setValue(a.stops[3].clr||"");f=a.stops[3].opacity;b.g_step4o.setValue((f||f===0)?f:1)}else{b.c_step4.setValue(false,true);b.g_step4.setValue(0);b.g_step4clr.setValue("");b.g_step4o.setValue(1)}delete b._in_init},_ctl_panel4_beforeclose:function(a){a.boxing().hide();return false},_c_step1_aftervalueset:function(c,a,d){var b=this;b.g_step1.setValue(0).setDisabled(!d);b.g_step1clr.setValue("").setDisabled(!d);b.g_step1o.setValue("1").setDisabled(!d);b.setTS()},_c_step2_aftervalueset:function(c,a,d){var b=this;b.g_step2.setValue(0).setDisabled(!d);b.g_step2clr.setValue("").setDisabled(!d);b.g_step2o.setValue("1").setDisabled(!d);b.setTS()},_c_step3_aftervalueset:function(c,a,d){var b=this;b.g_step3.setValue(0).setDisabled(!d);b.g_step3clr.setValue("").setDisabled(!d);b.g_step3o.setValue("1").setDisabled(!d);b.setTS()},_c_step4_aftervalueset:function(c,a,d){var b=this;b.g_step4.setValue(0).setDisabled(!d);b.g_step4clr.setValue("").setDisabled(!d);b.g_step4o.setValue("1").setDisabled(!d);b.setTS()},_clrpatternclicked:function(d,j,g){var c=this,b=d.CS.KEY,a=b.$gradient,f=a.stops;c.c_step4.setValue(false,true);c.g_step4.setValue(0);c.g_step4clr.setValue("");c.g_step4o.setValue(1);c.c_step1.setValue(true,true);c.g_step1.setValue(parseInt(f[0].pos,10)||0);c.g_step1clr.setValue(f[0].clr||"");c.g_step1o.setValue(1);c.c_step2.setValue(true,true);c.g_step2.setValue(parseInt(f[1].pos,10)||0);c.g_step2clr.setValue(f[1].clr||"");c.g_step2o.setValue(1);c.c_step3.setValue(true,true);c.g_step3.setValue(parseInt(f[2].pos,10)||0);c.g_step3clr.setValue(f[2].clr||"");c.g_step3o.setValue(1)},_xui_ui_button8_onclick:function(c,f,g,d){var b=this,a=c.boxing();b.c_step4.setUIValue(false,true);b.c_step3.setUIValue(false,true);b.c_step2.setUIValue(false,true);b.c_step1.setUIValue(false,true)}}});xui.Class("RAD.SVGCustomGradients","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"mainPane").setLeft("4.375em").setTop("1.875em").setWidth("32.25em").setHeight("28.083333333333332em").setShadow(false).setResizer(false).setCaption("$(RAD.custom_dlg.gradlg.Custom Fill)").setMinBtn(false).setMaxBtn(false).setOverflow("hidden").beforeClose("_ctl_panel4_beforeclose"));c.mainPane.append(xui.create("xui.UI.Block").setHost(c,"bg").setDock("fill").setBorderType("inset").setOverflow("hidden"));c.bg.append(xui.create("xui.UI.Group").setHost(c,"ctl_group11").setLeft("1.6666666666666667em").setTop("0.75em").setWidth("28.333333333333332em").setHeight("4.916666666666667em").setOverflow("hidden").setCaption("$(RAD.custom_dlg.Color Patterns)").setToggleBtn(false).setCustomStyle({PANEL:"padding:2px;"}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr1").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#4ba3cc"},{pos:"50%",clr:"#3289B2"},{pos:"100%",clr:"#3899C6"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr2").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#A5B8DA"},{pos:"50%",clr:"#7089B3"},{pos:"100%",clr:"#819bcb"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr3").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#ffd65e"},{pos:"50%",clr:"#febf04"},{pos:"100%",clr:"#ffc926"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr4").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#606c88"},{pos:"50%",clr:"#3f4c6b"},{pos:"100%",clr:"#4b546a"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr5").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#d5cea6"},{pos:"50%",clr:"#b7ad70"},{pos:"100%",clr:"#c5bb83"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr6").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#a90329"},{pos:"50%",clr:"#6d0019"},{pos:"100%",clr:"#77021d"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr7").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#4ba614"},{pos:"50%",clr:"#008c00"},{pos:"100%",clr:"#36780f"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"clr8").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#ff5db1"},{pos:"50%",clr:"#ef007c"},{pos:"100%",clr:"#ff2a98"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span500").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#7d7e7d"},{pos:"50%",clr:"#0e0e0e"},{pos:"100%",clr:"#819bcb"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span501").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#cef8ff"},{pos:"50%",clr:"#7fe0f8"},{pos:"100%",clr:"#9bf1ff"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span502").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#f2f9fe"},{pos:"50%",clr:"#d6f0fd"},{pos:"100%",clr:"#c3e3fa"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span503").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#fb83fa"},{pos:"50%",clr:"#e93cec"},{pos:"100%",clr:"#f952f8"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span504").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#3093c7"},{pos:"50%",clr:"#1c5a85"},{pos:"100%",clr:"#26759e"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span505").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#a9db80"},{pos:"50%",clr:"#96c56f"},{pos:"100%",clr:"#8ed058"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span506").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#A5B8DA"},{pos:"50%",clr:"#7089B3"},{pos:"100%",clr:"#819bcb"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span507").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#b29af8"},{pos:"50%",clr:"#9174ed"},{pos:"100%",clr:"#8e6af5"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span508").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#f2f5f6"},{pos:"50%",clr:"#c8d7dc"},{pos:"100%",clr:"#d4dee1"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span509").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#ffc579"},{pos:"50%",clr:"#fb9d23"},{pos:"100%",clr:"#ffaf46"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span510").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#d3d3d3"},{pos:"50%",clr:"#707070"},{pos:"100%",clr:"#bababa"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span511").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#fcfac0"},{pos:"50%",clr:"#f6f283"},{pos:"100%",clr:"#faf68f"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span512").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#f4f5f5"},{pos:"50%",clr:"#dfdddd"},{pos:"100%",clr:"#d9dddd"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span513").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#f7e3e3"},{pos:"50%",clr:"#ffd7d7"},{pos:"100%",clr:"#ecbbbb"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span514").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#ff9a9a"},{pos:"50%",clr:"#ff4040"},{pos:"100%",clr:"#ff6767"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span515").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#a9a588"},{pos:"50%",clr:"#8e865b"},{pos:"100%",clr:"#938e6b"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span516").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#f62b2b"},{pos:"50%",clr:"#d20202"},{pos:"100%",clr:"#e40a0a"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span517").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#a67939"},{pos:"50%",clr:"#845108"},{pos:"100%",clr:"#805d2c"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span518").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#d2d2f9"},{pos:"50%",clr:"#a6a6f2"},{pos:"100%",clr:"#a5a5f3"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span519").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#49c0f0"},{pos:"50%",clr:"#2cafe3"},{pos:"100%",clr:"#1ab0ec"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span520").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#cedce7"},{pos:"50%",clr:"#596a72"},{pos:"100%",clr:"#acc4d6"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span521").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#b6e026"},{pos:"50%",clr:"#abdc28"},{pos:"100%",clr:"#95b91a"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span522").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#eab92d"},{pos:"50%",clr:"#c79810"},{pos:"100%",clr:"#cf9f15"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span523").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#45484d"},{pos:"50%",clr:"#000"},{pos:"100%",clr:"#819bcb"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span524").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#6bbed2"},{pos:"50%",clr:"#76bdd1"},{pos:"100%",clr:"#6bbed2"}],type:"linear",orient:"T"}}}));c.ctl_group11.append(xui.create("xui.UI.Span").setHost(c,"ctl_span525").setWidth("1.25em").setHeight("1.25em").setPosition("relative").onClick("_clrpatternclicked").setCustomStyle({KEY:{margin:"2px",cursor:"pointer","border-radius":"2px","$gradient":{stops:[{pos:"0%",clr:"#6bbed2"},{pos:"50%",clr:"#23538a"},{pos:"100%",clr:"#82bbd1"}],type:"linear",orient:"T"}}}));c.bg.append(xui.create("xui.UI.Block").setHost(c,"ctl_block7").setLeft("0.5em").setTop("14.75em").setWidth("29.5em").setHeight("9.166666666666666em").setBorderType("inset").setOverflow("hidden"));c.ctl_block7.append(xui.create("xui.UI.Slider").setHost(c,"g_step1").setDirtyMark(false).setDisabled(true).setLeft("5.833333333333333em").setTop("0.4166666666666667em").setWidth("14.375em").setHeight("1.875em").setSteps(100).setIsRange(false).setValue("0").afterUIValueSet("_t_sd_afteruivalueset"));c.ctl_block7.append(xui.create("xui.UI.ComboInput").setHost(c,"g_step1clr").setDirtyMark(false).setDisabled(true).setLeft("20.833333333333332em").setTop("0.4166666666666667em").setWidth("7.5em").setType("color").afterUIValueSet("_t_sd_afteruivalueset"));c.ctl_block7.append(xui.create("xui.UI.Slider").setHost(c,"g_step2").setDirtyMark(false).setDisabled(true).setLeft("5.833333333333333em").setTop("2.5em").setWidth("14.375em").setHeight("1.875em").setSteps(100).setIsRange(false).setValue("0").afterUIValueSet("_t_sd_afteruivalueset"));c.ctl_block7.append(xui.create("xui.UI.ComboInput").setHost(c,"g_step2clr").setDirtyMark(false).setDisabled(true).setLeft("20.833333333333332em").setTop("2.5em").setWidth("7.5em").setType("color").afterUIValueSet("_t_sd_afteruivalueset"));c.ctl_block7.append(xui.create("xui.UI.Slider").setHost(c,"g_step3").setDirtyMark(false).setDisabled(true).setLeft("5.833333333333333em").setTop("4.583333333333333em").setWidth("14.375em").setHeight("1.875em").setSteps(100).setIsRange(false).setValue("0").afterUIValueSet("_t_sd_afteruivalueset"));c.ctl_block7.append(xui.create("xui.UI.ComboInput").setHost(c,"g_step3clr").setDirtyMark(false).setDisabled(true).setLeft("20.833333333333332em").setTop("4.583333333333333em").setWidth("7.5em").setType("color").afterUIValueSet("_t_sd_afteruivalueset"));c.ctl_block7.append(xui.create("xui.UI.CheckBox").setHost(c,"c_step1").setDirtyMark(false).setLeft("0.625em").setTop("0.5em").setCaption("$(RAD.custom_dlg.gradlg.Stop 1)").afterUIValueSet("_c_step1_afterUIValueSet"));c.ctl_block7.append(xui.create("xui.UI.CheckBox").setHost(c,"c_step2").setDirtyMark(false).setLeft("0.625em").setTop("2.5833333333333335em").setCaption("$(RAD.custom_dlg.gradlg.Stop 2)").afterUIValueSet("_c_step2_afterUIValueSet"));c.ctl_block7.append(xui.create("xui.UI.CheckBox").setHost(c,"c_step3").setDirtyMark(false).setLeft("0.625em").setTop("4.75em").setCaption("$(RAD.custom_dlg.gradlg.Stop 3)").afterUIValueSet("_c_step3_afterUIValueSet"));c.ctl_block7.append(xui.create("xui.UI.Slider").setHost(c,"g_step4").setDirtyMark(false).setDisabled(true).setLeft("5.833333333333333em").setTop("6.75em").setWidth("14.375em").setHeight("1.875em").setSteps(100).setIsRange(false).setValue("0").afterUIValueSet("_t_sd_afteruivalueset"));c.ctl_block7.append(xui.create("xui.UI.ComboInput").setHost(c,"g_step4clr").setDirtyMark(false).setDisabled(true).setLeft("20.833333333333332em").setTop("6.75em").setWidth("7.5em").setType("color").afterUIValueSet("_t_sd_afteruivalueset"));c.ctl_block7.append(xui.create("xui.UI.CheckBox").setHost(c,"c_step4").setDirtyMark(false).setLeft("0.625em").setTop("6.916666666666667em").setCaption("$(RAD.custom_dlg.gradlg.Stop 4)").afterUIValueSet("_c_step4_afterUIValueSet"));c.bg.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel473").setLeft("23.083333333333332em").setTop("11em").setCaption("$(RAD.custom_dlg.gradlg.Y$-axis)"));c.bg.append(xui.create("xui.UI.CheckBox").setHost(c,"ctl_l").setDirtyMark(false).setLeft("1.3333333333333333em").setTop("8.666666666666666em").setCaption("$(RAD.custom_dlg.gradlg.Linear Gradient Angle)").beforeUIValueSet("_ctl_l_before"));c.bg.append(xui.create("xui.UI.CheckBox").setHost(c,"ctl_r").setDirtyMark(false).setLeft("1.3333333333333333em").setTop("10.75em").setCaption("$(RAD.custom_dlg.gradlg.Radial Gradient Point)").beforeUIValueSet("_ctl_r_before"));c.bg.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel472").setLeft("15em").setTop("11em").setCaption("$(RAD.custom_dlg.gradlg.X$-axis)"));c.bg.append(xui.create("xui.UI.Block").setHost(c,"ctl_block3").setLeft("0.5em").setTop("13.166666666666666em").setWidth("29.5em").setHeight("1.5833333333333333em").setBorderType("inset").setOverflow("hidden"));c.ctl_block3.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel4").setLeft("22.5em").setTop("0.1875em").setCaption("$(RAD.custom_dlg.gradlg.Color)"));c.ctl_block3.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel3").setLeft("11.583333333333334em").setTop("0.1875em").setCaption("$(RAD.custom_dlg.gradlg.Offset)"));c.ctl_block3.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel6").setLeft("2.5833333333333335em").setTop("0.125em").setCaption("$(RAD.custom_dlg.gradlg.Stops)"));c.bg.append(xui.create("xui.UI.ComboInput").setHost(c,"ctl_rx").setDirtyMark(false).setLeft("18.333333333333332em").setTop("10.75em").setWidth("3.75em").setType("spin").setNumberTpl("*%").setPrecision(0).setIncrement(1).setMin(0).setMax(100).setValue(0).afterUIValueSet("_t_sd_afteruivalueset"));c.bg.append(xui.create("xui.UI.Slider").setHost(c,"ctl_lv").setDirtyMark(false).setDisabled(true).setLeft("13.333333333333334em").setTop("8.583333333333334em").setWidth("16.875em").setHeight("1.875em").setSteps(360).setIsRange(false).setValue("0").afterUIValueSet("_t_sd_afteruivalueset"));c.bg.append(xui.create("xui.UI.CheckBox").setHost(c,"ctl_c").setDirtyMark(false).setLeft("1.3333333333333333em").setTop("6.583333333333333em").setCaption("$(RAD.custom_dlg.gradlg.Fill Solid Color Only)").beforeUIValueSet("_ctl_c_before"));c.bg.append(xui.create("xui.UI.ComboInput").setHost(c,"ctl_cv").setDirtyMark(false).setDisabled(true).setLeft("13.333333333333334em").setTop("6.666666666666667em").setWidth("16.666666666666668em").setType("color").afterUIValueSet("_ctl_cv_afteruivalueset"));c.bg.append(xui.create("xui.UI.ComboInput").setHost(c,"ctl_ry").setDirtyMark(false).setLeft("26em").setTop("10.75em").setWidth("3.75em").setType("spin").setNumberTpl("*%").setPrecision(0).setIncrement(1).setMin(0).setMax(100).setValue(0).afterUIValueSet("_t_sd_afteruivalueset"));return b},_getValues:function(){var d=this,a=[],c,b;if(d.c_step1.getValue()){c={pos:d.g_step1.getValue(),clr:d.g_step1clr.getValue()||"#ffffff"};a.push(c)}if(d.c_step2.getValue()){c={pos:d.g_step2.getValue(),clr:d.g_step2clr.getValue()||"#ffffff"};a.push(c)}if(d.c_step3.getValue()){c={pos:d.g_step3.getValue(),clr:d.g_step3clr.getValue()||"#ffffff"};a.push(c)}if(d.c_step4.getValue()){c={pos:d.g_step4.getValue(),clr:d.g_step4clr.getValue()||"#ffffff"};a.push(c)}if(a.length){xui.arr.stableSort(a,function(e,f){return parseFloat(e.pos)>parseFloat(f.pos)?1:parseFloat(e.pos)==parseFloat(f.pos)?0:-1})}return a},_t_sd_afteruivalueset:function(a){xui.resetRun("Gradients",this.setTS,0,null,this)},setTS:function(){var b=this,a=b._type,c=b._getValues(),d;if(c.length<=0){v=""}else{if(a=="l"){d=b.ctl_lv.getUIValue()+"-"}else{d="r("+xui.toFixedNumber(b.ctl_rx.getUIValue()/100,2)+","+xui.toFixedNumber(b.ctl_ry.getUIValue()/100,2)+")"}v=d;xui.arr.each(c,function(f,e){v+=(e?"-":"")+f.clr+":"+f.pos})}b.fireEvent("onChange",[b._v_gradient=v||"none"])},init:function(d,f,a){var g=this;xui.merge(g.properties,a,"all");var l=a.cell.value,e,b,j,n,c=a.grid.getTag(),m;g._noRadio=c!=="circle"&&c!=="ellipse";g.ctl_r.setDisabled(g._noRadio);if(!l||l=="none"||l.charAt(0)=="#"||l=="transparent"){if(l=="none"){l=""}g.ctl_cv.setValue(l||"",true);g._setType("c",false)}else{if((!g._noRadio)&&l.charAt(0)=="r"){l=/r\(([0-9.]+)\s*\,\s*([0-9.]+)\)(.+)/.exec(l);if(l){b=l[1];j=l[2];if(l[3]){n=l[3].split("-")}if(n&&n.length){m=[];xui.arr.each(n,function(q,o){q=q.split(":");m.push({pos:xui.isSet(q[1])?q[1]:(o===n.length-1?100:0),clr:q[0]})})}}if(!m||!m.length){b=j=0}g.ctl_rx.setValue(b,true);g.ctl_ry.setValue(j,true);g._setType("r",false)}else{l=/([0-9]+)-(.*)/.exec(l);if(l){e=l[1]||0;if(l[2]){n=l[2].split("-")}if(n&&n.length){m=[];xui.arr.each(n,function(q,o){q=q.split(":");m.push({pos:xui.isSet(q[1])?q[1]:(o===n.length-1?100:0),clr:q[0]})})}}if(!m||!m.length){e=0}g.ctl_lv.setValue(e,true);g._setType("l",false)}if(m){if(m.length>0){g.c_step1.setValue(true,true);g.g_step1.setDisabled(false).setValue(m[0].pos||0,true);g.g_step1clr.setDisabled(false).setValue(m[0].clr||"",true)}else{g.c_step1.setValue(false,true);g.g_step1.setValue(0,true);g.g_step1clr.setValue("",true)}if(m.length>1){g.c_step2.setValue(true,true);g.g_step2.setDisabled(false).setValue(m[1].pos||0,true);g.g_step2clr.setDisabled(false).setValue(m[1].clr||"",true)}else{g.c_step2.setValue(false,true);g.g_step2.setValue(0,true);g.g_step2clr.setValue("",true)}if(m.length>2){g.c_step3.setValue(true,true);g.g_step3.setDisabled(false).setValue(m[2].pos||0,true);g.g_step3clr.setDisabled(false).setValue(m[2].clr||"",true)}else{g.c_step3.setValue(false,true);g.g_step3.setValue(0,true);g.g_step3clr.setValue("",true)}if(m.length>3){g.c_step4.setValue(true,true);g.g_step4.setDisabled(false).setValue(m[3].pos||0,true);g.g_step4clr.setDisabled(false).setValue(m[3].clr||"",true)}else{g.c_step4.setValue(false,true);g.g_step4.setValue(0,true);g.g_step4clr.setValue("",true)}}}},_ctl_panel4_beforeclose:function(a){a.boxing().hide();return false},_c_step1_afterUIValueSet:function(c,a,d){var b=this;b.g_step1.setValue(0).setDisabled(!d);b.g_step1clr.setValue("").setDisabled(!d);b.setTS()},_c_step2_afterUIValueSet:function(c,a,d){var b=this;b.g_step2.setValue(0).setDisabled(!d);b.g_step2clr.setValue("").setDisabled(!d);b.setTS()},_c_step3_afterUIValueSet:function(c,a,d){var b=this;b.g_step3.setValue(0).setDisabled(!d);b.g_step3clr.setValue("").setDisabled(!d);b.setTS()},_c_step4_afterUIValueSet:function(c,a,d){var b=this;b.g_step4.setValue(0).setDisabled(!d);b.g_step4clr.setValue("").setDisabled(!d);b.setTS()},_setType:function(d,b){var c=this;switch(d){case"c":c.ctl_c.setValue(true,true);c.ctl_l.setValue(false,true);c.ctl_r.setValue(false,true);c.ctl_cv.setDisabled(false);c.ctl_lv.setValue(0,true).setDisabled(true);c.ctl_rx.setValue(0,true).setDisabled(true);c.ctl_ry.setValue(0,true).setDisabled(true);for(var a=1;a<5;a++){c["c_step"+a].setValue(false,true).setDisabled(true);c["g_step"+a].setValue(0,true).setDisabled(true);c["g_step"+a+"clr"].setValue("",true).setDisabled(true)}c._type="c";c._v_gradient="none";if(false!==b){c.fireEvent("onChange",[c._v_color||"none"])}break;case"l":c.ctl_c.setValue(false,true);c.ctl_l.setValue(true,true);c.ctl_r.setValue(false,true);c.ctl_cv.setValue("",true).setDisabled(true);c.ctl_lv.setDisabled(false);c.ctl_rx.setValue(0,true).setDisabled(true);c.ctl_ry.setValue(0,true).setDisabled(true);if(c._type!="r"){for(var a=1;a<5;a++){c["c_step"+a].setValue(false,true).setDisabled(false);c["g_step"+a].setValue(0,true).setDisabled(true);c["g_step"+a+"clr"].setValue("",true).setDisabled(true)}}c._type="l";c._v_color="none";if(false!==b){c.setTS()}break;case"r":c.ctl_c.setValue(false,true);c.ctl_l.setValue(false,true);c.ctl_r.setValue(true,true);c.ctl_cv.setValue("",true).setDisabled(true);c.ctl_lv.setValue(0,true).setDisabled(true);c.ctl_rx.setDisabled(false);c.ctl_ry.setDisabled(false);if(c._type!="l"){for(var a=1;a<5;a++){c["c_step"+a].setValue(false,true).setDisabled(false);c["g_step"+a].setValue(0,true).setDisabled(true);c["g_step"+a+"clr"].setValue("",true).setDisabled(true)}}c._type="r";c._v_color="none";if(false!==b){c.setTS()}break}},_ctl_c_before:function(b,a,c){if(c){this._setType("c")}else{return false}},_ctl_l_before:function(b,a,c){if(c){this._setType("l")}else{return false}},_ctl_r_before:function(b,a,c){if(c){this._setType("r")}else{return false}},_ctl_cv_afteruivalueset:function(c,a,d){var b=this;b.fireEvent("onChange",[b._v_color=d||"none"])},_clrpatternclicked:function(d,j,g){var c=this,b=d.CS.KEY,a=b.$gradient,f=a.stops;if(c.ctl_c.getValue()){c.ctl_cv.setUIValue(f[0].clr)}else{c.c_step4.setUIValue(false,true);c.g_step4.setUIValue(0);c.g_step4clr.setUIValue("");c.c_step1.setUIValue(true,true);c.g_step1.setUIValue(parseInt(f[0].pos,10)||0);c.g_step1clr.setUIValue(f[0].clr||"");c.c_step2.setUIValue(true,true);c.g_step2.setUIValue(parseInt(f[1].pos,10)||0);c.g_step2clr.setUIValue(f[1].clr||"");c.c_step3.setUIValue(true,true);c.g_step3.setUIValue(parseInt(f[2].pos,10)||0);c.g_step3clr.setUIValue(f[2].clr||"")}}}});xui.Class("RAD.ChartCustomSetting","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dialog").setLeft("0.8333333333333334em").setTop("0.8333333333333334em").setWidth("45em").setHeight("30.833333333333332em").setShadow(false).setResizer(false).setCaption("$(RAD.fc.Chart Configure)").setMinBtn(false).setMaxBtn(false).beforeClose("_dialog_beforeclose"));c.dialog.append(xui.create("xui.UI.Span").setHost(c,"btn_del").setClassName("xuicon xui-uicmd-close").setTips("$(RAD.fc.Remove the row)").setTop("0.125em").setWidth("height").setDisplay("none").onClick("_remove_clicked").setCustomStyle({KEY:{"font-size":"1.5em",cursor:"pointer"}}));c.dialog.append(xui.create("xui.UI.Block").setHost(c,"ctl_block1").setDock("fill").setBorderType("inset"));c.ctl_block1.append(xui.create("xui.UI.Tabs").setHost(c,"tabs").setItems([{id:"chart",caption:"$RAD.fc.grps.Chart"},{id:"data",caption:"$(RAD.fc.grps.Data Set)"},{id:"data2",caption:"$(RAD.fc.grps.Data Set)"},{id:"vsl",caption:"$(RAD.fc.grps.Vertical Lines)"},{id:"tl",caption:"$(RAD.fc.grps.Trend Lines)"},{id:"vl",caption:"$(RAD.fc.grps.Vertical Trend Lines)"},{id:"ann",caption:"$(RAD.fc.grps.Annotations)"}]).setValue("chart").onIniPanelView("_tabs_oninipanelview"));c.tabs.append(xui.create("xui.UI.TreeGrid").setHost(c,"gridSet").setShowDirtyMark(false).setRowNumbered(true).setEditable(true).setRowHandlerWidth("1.5em").setHeader({}).setGrpCols({}).setRows({}).setTreeMode("none").setHotRowMode("show").setDropKeys("single s").setDragKey("single s").beforeHotRowAdded("_gridSet_beforehotrowadded").afterCellUpdated("_cellupdated").onRowHover("_grid_onmousehover").onDrop("_grid_ondrop").onStartDrag("_grid_onstartdrag"),"data");c.tabs.append(xui.create("xui.UI.TreeGrid").setHost(c,"gridSet2").setShowDirtyMark(false).setTips("$(RAD.fc.Click to configure categories)").setEditable(true).setGridHandlerCaption("$RAD.fc.Categories").setHeaderHeight("1.5em").setColSortable(false).setColMovable(true).setHeader({}).setGrpCols({}).setRows({}).setActiveMode("none").setTreeMode("none").setDropKeys("multi s").setDragKey("multi s").beforeRender("_gridset2_bcr").onRender("_gridset2_oncr").afterCellUpdated("_cellupdated2").onClickHeader("_gridSet2_onclickheader").onClickRowHandler("_gridSet2_onclickrh").onClickGridHandler("_gridSet2_onclickgh").beforeComboPop("_gridSet2_pop").onDropTest("_gridset2_dtest").onDrop("_grid_ondrop").onStartDrag("_gridset2_bds").onGetDragData("_gridset2_dragdata").setCustomStyle({FCELL:"border-left:0;border-top:0;cursor:pointer;",HCELL:"cursor:pointer;",FHCELL:"cursor:pointer;"}),"data2");c.tabs.append(xui.create("xui.UI.TreeGrid").setHost(c,"gridVSL").setShowDirtyMark(false).setRowNumbered(true).setEditable(true).setRowHandlerWidth("1.5em").setHeader({}).setGrpCols({}).setRows({}).setTreeMode("none").setHotRowMode("show").beforeHotRowAdded("_gridVSL_beforehotrowadded").afterCellUpdated("_cellupdated").onRowHover("_grid_onmousehover"),"vsl");c.tabs.append(xui.create("xui.UI.TreeGrid").setHost(c,"gridVL").setShowDirtyMark(false).setRowNumbered(true).setEditable(true).setRowHandlerWidth("1.5em").setHeader({}).setGrpCols({}).setRows({}).setTreeMode("none").setHotRowMode("show").beforeHotRowAdded("_gridTrend_beforehotrowadded").afterCellUpdated("_cellupdated").onRowHover("_grid_onmousehover").onStartDrag("_grid_onstartdrag"),"vl");c.tabs.append(xui.create("xui.UI.TreeGrid").setHost(c,"gridTL").setShowDirtyMark(false).setRowNumbered(true).setEditable(true).setRowHandlerWidth("1.5em").setHeader({}).setGrpCols({}).setRows({}).setTreeMode("none").setHotRowMode("show").beforeHotRowAdded("_gridTrend_beforehotrowadded").afterCellUpdated("_cellupdated").onRowHover("_grid_onmousehover").onStartDrag("_grid_onstartdrag"),"tl");c.tabs.append(xui.create("xui.UI.Layout").setHost(c,"ctl_layout3").setItems([{id:"before",pos:"before",min:10,size:213,locked:false,folded:false,hidden:false,cmd:false},{id:"main",min:10,size:80}]).setType("horizontal"),"chart");c.ctl_layout3.append(xui.create("xui.UI.Block").setHost(c,"ctl_block4").setDock("fill").setBorderType("none"),"before");c.ctl_block4.append(xui.create("xui.UI.TreeView").setHost(c,"tv1").setShowDirtyMark(false).setIniFold(false).onItemSelected("_tv1_onitemselected"));c.ctl_block4.append(xui.create("xui.UI.Block").setHost(c,"ctl_block87").setDock("top").setHeight("1.5833333333333333em").setHtml('<div style="text-align: center;"><b>$(RAD.fc.Attributes Type)</b></div>'));c.ctl_layout3.append(xui.create("xui.UI.TreeGrid").setHost(c,"propGrid1").setShowDirtyMark(false).setEditable(true).setRowHandler(false).setColSortable(false).setHeader([{id:"name",caption:"$RAD.fc.Attribute",width:"13.583333333333334em",type:"label"},{id:"value",caption:"$RAD.fc.Value",width:"13.583333333333334em",type:"input"}]).afterCellUpdated("_propGrid1_aftercellupdated"),"main");c.ctl_layout3.append(xui.create("xui.UI.Block").setHost(c,"ctl_block85").setDock("top").setHeight("1.5833333333333333em").setHtml('<div style="text-align: center;"><b>$(RAD.fc.Attributes Editor)</b></div>'),"main");c.tabs.append(xui.create("xui.UI.Layout").setHost(c,"ctl_layout4").setItems([{id:"before",pos:"before",min:10,size:213,locked:false,folded:false,hidden:false,cmd:false},{id:"main",min:10,size:80}]).setType("horizontal"),"ann");c.ctl_layout4.append(xui.create("xui.UI.Block").setHost(c,"ctl_block5").setDock("fill").setBorderType("none"),"before");c.ctl_block5.append(xui.create("xui.UI.TreeView").setHost(c,"tvann").setShowDirtyMark(false).setIniFold(false).beforeClick("_tvann_beforeclick").onCmd("_tvann_oncmd").onItemSelected("_tvann_onitemselected"));c.ctl_block5.append(xui.create("xui.UI.Block").setHost(c,"ctl_block88").setDock("top").setHeight("1.6666666666666667em").setHtml('<div style="text-align: center;"><b>$(RAD.fc.grps.Annotations)</b></div>'));c.ctl_layout4.append(xui.create("xui.UI.TreeGrid").setHost(c,"annGrid").setShowDirtyMark(false).setEditable(true).setRowHandler(false).setColSortable(false).setHeader([{id:"name",caption:"$RAD.fc.Attribute",width:"13.583333333333334em",type:"label"},{id:"value",caption:"$RAD.fc.Value",width:"13.583333333333334em",type:"input"}]).setGrpCols({}).setRows({}).afterCellUpdated("_anngrid_aftercellupdated"),"main");c.ctl_layout4.append(xui.create("xui.UI.Block").setHost(c,"ctl_block89").setDock("top").setHeight("1.6666666666666667em").setHtml('<div style="text-align: center;"><b>$(RAD.fc.Attributes Editor)</b></div>'),"main");c.ctl_block1.append(xui.create("xui.UI.Button").setHost(c,"btnapply").setTop("0.25em").setWidth("5.25em").setHeight("2.1666666666666665em").setRight("0.5em").setCaption("$RAD.fc.Apply").onClick("_apply"));a(xui.create("xui.UI.PopMenu").setHost(c,"popType").setItems([{id:"text",caption:"$(RAD.fc.svgType.text)"},{id:"image",caption:"$(RAD.fc.svgType.image)"},{id:"line",caption:"$(RAD.fc.svgType.line)"},{id:"rectangle",caption:"$(RAD.fc.svgType.rectangle)"},{id:"circle",caption:"$(RAD.fc.svgType.circle)"},{id:"arc",caption:"$(RAD.fc.svgType.arc)"},{id:"polygon",caption:"$(RAD.fc.svgType.polygon)"},{id:"undefined",caption:"undefined"},{id:"path",caption:"$(RAD.fc.svgType.path)"}]).onMenuSelected("_poptype_clk"));return b},customAppend:function(b,a,d,c){return this._init()},_init:function(e){var l=this,a=l.properties,g=e?(a.targetProfile=e):a.targetProfile,d=xui.clone(g.boxing().getJSONData(),true),b={HLED:1,VLED:1,Cylinder:1,Thermometer:1},c={Pie2D:1,Pie3D:1,Doughnut2D:1,Doughnut3D:1,Funnel:1,Pyramid:1,Radar:1,Cylinder:1,Thermometer:1},f={HLED:1,VLED:1,HLinearGauge:1,AngularGauge:1},j={HLinearGauge:1,AngularGauge:1};l._dirty=false;l.btnapply.setDisplay("none");l._chartType=g.properties.chartType;l.DATA=d;l._mutiser=!!FCCONF.attrCat[l._chartType]["dataset"];l._xyPlot=l._chartType=="Scatter"||l._chartType=="Bubble";l.tabs.resetPanelView(true,false,false);l.tabs.updateItem("tl",{hidden:l.noTL=c[l._chartType]});l.tabs.updateItem("vl",{hidden:l.noVL=!FCCONF.attrCat[l._chartType]["Vertical Trend Lines"]&&!FCCONF.attrCat[l._chartType]["Trend Point"]});l.tabs.updateItem("vsl",{hidden:l.noVSL=!FCCONF.attrCat[l._chartType]["Vertical data separator lines"]});l.tabs.updateItem("data",{hidden:l.noData=l._mutiser||b[l._chartType]});l.tabs.updateItem("data2",{hidden:l.noData2=!l._mutiser||b[l._chartType]});if(!l.noTL){if(f[l._chartType]){l._TL_Type="colorrange";l.tabs.updateItem("tl",{caption:"$(RAD.fc.grps.Color Range)"})}else{l._TL_Type="trendlines";l.tabs.updateItem("tl",{caption:"$(RAD.fc.grps.Trend Lines)"})}}if(!l.noVL){if(j[l._chartType]){l._VL_Type="trendpoints";l.tabs.updateItem("vl",{caption:"$(RAD.fc.grps.Trend Point)"})}else{l._VL_Type="vtrendlines";l.tabs.updateItem("vl",{caption:"$(RAD.fc.grps.Vertical Trend Lines)"})}}if(!l.noData){if(l._chartType=="HLinearGauge"){l._Data_Type="pointer";l.tabs.updateItem("data",{caption:"$(RAD.fc.grps.Pointers)"})}else{if(l._chartType=="AngularGauge"){l._Data_Type="dial";l.tabs.updateItem("data",{caption:"$(RAD.fc.grps.Dials)"})}else{l._Data_Type="data";l.tabs.updateItem("data",{caption:"$(RAD.fc.grps.Data Set)"})}}}var m=FCCONF.attrCat[l._chartType].chart;xui.arr.each(m,function(q,n){if(!q.caption){q.caption="$(RAD.fc.grps2."+q.id+")";xui.arr.each(q.sub,function(o){o.caption="$(RAD.fc.cats."+o.id.replace(/([)-])/g,"$$$1")+")"})}});l.tv1.setItems(m);xui("body").append(l.dialog);l.dialog.getRoot().popToTop(xui(a.src),2).setBlurTrigger("RAD.ChartCustomSetting",function(){l.dialog.close()});l.tabs.setValue("chart",true);l.tv1.fireItemClickEvent("Titles (Axis) Names");l.dialog.activate();return true},_dialog_beforeclose:function(b){var a=this;a.DATA=a._chartType=null;b.boxing().hide();a.gridSet.removeAllRows().setHeader([]);a.gridSet2.removeAllRows().setHeader([]);a.gridTL.removeAllRows().setHeader([]);a.gridVL.removeAllRows().setHeader([]);a.gridVSL.removeAllRows().setHeader([]);a.tabs.setValue("chart",true);a.fireEvent("onFinished");return false},_tvann_oncmd:function(d,c,a){var b=this;xui.confirm("$RAD.Remove?",xui.getRes("RAD.fc.Are You Sure to remove this "+c.type)+"?",function(){d.boxing().removeItems(c.id);d.boxing().fireItemClickEvent("root");b._change()})},_tvann_beforeclick:function(d,c,f,g){var b=this,a=d.boxing(),j="n_"+xui.stamp();if(c.type=="label1"){a.insertItems({type:"group",caption:"$(RAD.fc.Annotation Group)",tagCmds:[{id:"Remove",type:"text",caption:"&times;",tips:"$(RAD.fc.Remove Annotation Group)"}],$data:{},sub:[{type:"label2",itemStyle:"font-style: italic;cursor:pointer;",image:"{xui.ini.img_bg}",caption:"$(RAD.fc.[ + Annotation Item])"}]},c._pid,c.id,true);a.fireItemClickEvent(j);b._change();return false}if(c.type=="label2"){b.popType.pop(xui.Event.getPos(f));b.popType.setTag(c);return false}},_poptype_clk:function(d,f,g){var c=this,b=c.tvann,j="n_"+xui.stamp(),e=d.boxing().getTag(),a=f.id;b.insertItems({id:j,type:"item",subtype:a,caption:"$(RAD.fc.Annotation Item) - "+f.caption,tagCmds:[{id:"Remove",type:"item",type:"text",caption:"&times;",tips:"$(RAD.fc.Remove Annotation Item)"}],$data:{type:a}},e._pid,e.id,true);b.fireItemClickEvent(j);c._change()},_tvann_onitemselected:function(c,d,j,l,b){var a=this,g,f=d.$data||(d.$data={});switch(d.type){case"root":g=a._buildTG1("annotations",f,FCCONF.annotations.annotation);break;case"group":g=a._buildTG1("annotations",f,FCCONF.annotations.group);break;case"item":g=a._buildTG1("annotations",f,FCCONF.annotations[d.subtype]);break}a.annGrid.setRows(g,true);a.annGrid.get(0).$data=f},_tv1_onitemselected:function(c,d,g,j,b){var a=this,f;if(d.root){f=a._buildTG1(d.id,a.DATA,d.prop);xui.arr.each(f,function(e){e.root=true})}else{f=a._buildTG1(d.id,a.DATA.chart,d.prop)}a.propGrid1.setRows(f,true)},_buildTG1:function(a,b,m){var e=this,l=function(r,o,q){var n=q[r.toLowerCase()];return o=="checkbox"?(n==="1"):n},f=function(o){var q=[],n;xui.arr.each(o,function(s,r){if(xui.isHash(s)){n=s;n.value=l(s.id,s.type,b)}else{s=n={id:s,value:"[Not Configured]",caption:"$(RAD.fc.[Not Configured])"}}q.push({id:s.id,caption:"$RAD.fc.keys."+s.id,tips:s.id,cells:[{id:"name",caption:"$RAD.fc.keys."+s.id?"$RAD.fc.keys."+s.id:s.id},n]})});return q};var d=[],c=FCCONF.gridAttr,j,g;xui.arr.each(m,function(n){if(g=xui.get(c,[a,n])){j=xui.copy(g);j.id=n}else{if(g=c[n]){j=xui.copy(g);j.id=n}else{j=n}}d.push(j)});return f(d)},_getV:function(a){return a.value===false?"0":a.value===true?"1":((a.value+"").replace(/^#/,""))},_anngrid_aftercellupdated:function(d,a,b,f){var c=this,e=d.$data;if("value" in a){if(!xui.isSet(a.value)||a.value===""){delete e[a.id.toLowerCase()]}else{if(xui.isStr(a.value)&&a.value.charAt(0)=="#"){a.value=a.value.replace("#","")}e[a.id.toLowerCase()]=c._getV(a)}c._change()}},_propGrid1_aftercellupdated:function(e,a,b,f){var d=this;if("value" in a){var c=a._row.root;if(!xui.isSet(a.value)||a.value===""){if(c){delete d.DATA[a.id.toLowerCase()]}else{delete d.DATA.chart[a.id.toLowerCase()]}}else{if(xui.isStr(a.value)&&a.value.charAt(0)=="#"){a.value=a.value.replace("#","")}if(c){d.DATA[a.id.toLowerCase()]=d._getV(a)}else{d.DATA.chart[a.id.toLowerCase()]=d._getV(a)}}if(!f){d._change()}}},_change:function(){var a=this;a._dirty=true;a.btnapply.setDisplay("");a.fireEvent("onChange")},_cellupdated2:function(d,a,b,e){var c=this;if("value" in a){if(xui.isStr(a.value)&&a.value.charAt(0)=="#"){a.value=a.value.replace("#","")}if(!a.DATA){a.DATA={}}a.DATA.value=a.value;if(!e){c._change()}}},_apply:function(){var D=this,d=D.properties,m=d.targetProfile,B=D.tvann,x=D.gridTL,l=D.gridVL,q=D.gridVSL,g,u,C;if(D.DATA){var a=[];u=x.getHeader("min");if(u.length){xui.arr.each(x.getRows(),function(E){if(xui.UI.TreeGrid.isHotRow(E)){return}C={};xui.arr.each(E.cells,function(F,G){if(F.needCollect){C[u[G].toLowerCase()]=D._getV(F)}});a.push(C)});if(D._TL_Type=="colorrange"){xui.set(D.DATA,["colorrange","color"],a)}else{xui.set(D.DATA,["trendlines"],[{line:a}])}}a=[];u=l.getHeader("min");if(u.length){xui.arr.each(l.getRows(),function(E){if(xui.UI.TreeGrid.isHotRow(E)){return}C={};xui.arr.each(E.cells,function(F,G){if(F.needCollect){C[u[G].toLowerCase()]=D._getV(F)}});a.push(C)});if(D._VL_Type=="trendpoints"){xui.set(D.DATA,["trendpoints","point"],a)}else{xui.set(D.DATA,["vtrendlines"],[{line:a}])}}if(D._mutiser){u=D.gridSet2.getHeader();g=D.gridSet2.getRows();var A=[],c=q.getHeader("min"),b=q.getRows();if((D.noVSL||c.length)&&(u.length||g.length)){var o={category:[]};xui.arr.each(u,function(E){o.category.push(E.DATA)});if(c&&c.length){xui.arr.each(b,function(F){if(xui.UI.TreeGrid.isHotRow(F)){return}var E=F.cells[0].value;C={vline:"1"};xui.arr.each(F.cells,function(G,H){if(G.needCollect){C[c[H].toLowerCase()]=D._getV(G)}});xui.arr.insertAny(o.category,C,E)},null,false)}xui.merge(o,D.gridSet2.getTagVar(),"all");D.DATA.categories=[o];var e=[],j,r;xui.arr.each(g,function(F,E){if(F.type=="label"||F.type=="label2"){return}if(F.sub){j={dataset:[]};xui.arr.each(F.sub,function(H,G){if(H.type=="label"||H.type=="label2"){return}r={data:[]};if(!xui.isEmpty(H.DATA)){xui.merge(r,H.DATA,"all")}xui.arr.each(H.cells,function(I,J){r.data.push(I.DATA||{})});j.dataset.push(r)});if(F.lineset){xui.set(D.DATA,["lineset"],j.dataset)}else{e.push(j)}}else{j={data:[]};if(!xui.isEmpty(F.DATA)){xui.merge(j,F.DATA,"all")}if(D._xyPlot){j.data=F.DATA2}else{xui.arr.each(F.cells,function(G,H){j.data.push(G.DATA||{})})}e.push(j)}});xui.set(D.DATA,["dataset"],e)}}else{u=D.gridSet.getHeader("min");g=D.gridSet.getRows();var A=[],c=q.getHeader("min"),b=q.getRows();if((D.noVSL||c.length)&&(u.length||g.length)){xui.arr.each(g,function(F,E){if(xui.UI.TreeGrid.isHotRow(F)){return}C={};xui.arr.each(F.cells,function(G,H){if(G.needCollect){C[u[H].toLowerCase()]=D._getV(G)}});A.push(C)});if(D._Data_Type=="pointer"){xui.set(D.DATA,["pointer","pointer"],A)}else{if(D._Data_Type=="dial"){xui.set(D.DATA,["dials","dial"],A)}else{xui.set(D.DATA,["data"],A);if(c&&c.length){xui.arr.each(b,function(F){if(xui.UI.TreeGrid.isHotRow(F)){return}var E=F.cells[0].value;C={vline:"1"};xui.arr.each(F.cells,function(G,H){if(G.needCollect){C[c[H].toLowerCase()]=D._getV(G)}});xui.arr.insertAny(D.DATA.data,C,E)},null,false)}}}}}var n=B.getItems();if(xui.get(n,[0,"sub"])){var f,w,s={groups:[]};xui.arr.each(n[0].sub,function(E){if(E.sub&&E.sub.length){f={items:[]};xui.arr.each(E.sub,function(F){w=F.$data;if(!xui.isEmpty(w)){f.items.push(w)}});if(f.items.length){xui.merge(f,E.$data,"without");s.groups.push(f)}}});if(s.groups.length){xui.merge(s,n[0].$data,"without");D.DATA.annotations=xui.clone(s,true)}else{delete D.DATA.annotations}}m.boxing().setJSONData(D.DATA,true);D.fireEvent("onDirty")}D._dirty=false;D.btnapply.setDisplay("none")},_buildGrid:function(g,d,a,j){var l=this,b=FCCONF.attrCat[l._chartType],f=FCCONF.gridAttr,e=[],c;if(j){e.push({id:"location",caption:"$(RAD.fc.[Location])",type:"spin",precision:0,increment:1,min:0,max:1000})}xui.arr.each(b[g],function(o){var n;if(n=xui.get(f,[g,o])){c=xui.copy(n);c.id=o;c.caption="$RAD.fc.keys."+c.id}else{if(n=f[o]){c=xui.copy(n);c.id=o;c.caption="$RAD.fc.keys."+c.id}else{c={id:o,caption:"$(RAD.fc.[Not Configured])"}}}e.push(c)});if(a){l[a].setHeader(e)}if(d){var m=[];xui.arr.each(d,function(n,q){if(j){if(n.vline=="1"||n.vline=="true"){var o=[];xui.arr.each(e,function(r){if(r.id=="location"){o.push({value:q})}else{var s=r.id.toLowerCase();o.push({value:s in n?(r.type=="checkbox"?n[s]==="1"?true:false:n[s]):"",needCollect:s in n})}});m.push({cells:o})}}else{if(n.vline!=="1"&&n.vline!=="true"){var o=[];xui.arr.each(e,function(r,s){s=r.id.toLowerCase();o.push({value:s in n?(r.type=="checkbox"?n[s]==="1"?true:false:n[s]):"",needCollect:s in n})});m.push({cells:o})}}});if(m.length){if(a){l[a].setRows(m)}}}if(a){l[a].addHotRow(e[0])}return{header:e,rows:m}},_tabs_oninipanelview:function(d,q){var n=this;switch(q.id){case"data2":if(d._ining2){return}var f=[],r=[],s=[];var g=n.DATA.categories?n.DATA.categories[0]:{category:[]};n.gridSet2.setTagVar(xui.clone(g,function(w,u){return"category"!=u}));xui.arr.each(g.category,function(u,w){if(u.vline!=="1"&&u.vline!=="true"){f.push({id:u.label+xui.stamp(),caption:"$(RAD.fc.keys."+u.label+")",type:"popbox",tips:"$(RAD.fc.Click to configure category)",DATA:xui.clone(u)})}});if(n._xyPlot){xui.arr.each(n.DATA.dataset,function(w,u){s.push({caption:w.seriesname,group:true,xyPlot:1,firstCellClass:"xui-treegrid-hcell",tips:"$(RAD.fc.Click to configure dataset)",DATA:xui.clone(w,function(A,x){return"data"!=x}),DATA2:xui.clone(w.data)})});s.push({type:"label",xyPlot:1,group:true,cellStyle:"font-weight:normal;font-style: italic;",caption:"$(RAD.fc.[ + Dataset])",tips:"$(RAD.fc.Add dataset)"});n.gridSet2.setTreeMode("inhandler").setRowHandlerWidth(100)}else{var c;xui.arr.each(n.DATA.dataset,function(x,u){r=[];if(x.dataset){c=1;var w=[];s.push({caption:"$(RAD.fc.Dataset group)",group:true,tips:"$(RAD.fc.Dataset group)",dragkey:"group",sub:w});xui.arr.each(x.dataset,function(B,A){r=[];xui.arr.each(B.data,function(D,C){r.push({value:D.value,DATA:xui.clone(D)})});w.push({caption:B.seriesname,cells:r,firstCellClass:"xui-treegrid-hcell",tips:"$(RAD.fc.Click to configure dataset)",dragkey:"dataset",DATA:xui.clone(B,function(D,C){return"data"!=C})})});w.push({type:"label",group:true,cellStyle:"font-weight:normal;font-style: italic;",caption:"$(RAD.fc.[ + Dataset])",tips:"$(RAD.fc.Add dataset)"})}else{xui.arr.each(x.data,function(B,A){r.push({value:B.value,DATA:xui.clone(B)})});s.push({caption:x.seriesname,cells:r,firstCellClass:"xui-treegrid-hcell",tips:"$(RAD.fc.Click to configure dataset)",dragkey:"datset",DATA:xui.clone(x,function(B,A){return"data"!=A})})}});if(c){if(n._chartType=="MSStackedColumn2DLineDY"){var b=[];xui.arr.insertAny(s,{caption:"$(RAD.fc.Lineset group)",group:true,tips:"$(RAD.fc.Lineset group)",lineset:true,sub:b},0);xui.arr.each(n.DATA.lineset,function(w,u){r=[];xui.arr.each(w.data,function(A,x){r.push({value:A.value,DATA:xui.clone(A),special:"line"})});b.push({caption:w.seriesname,cells:r,firstCellClass:"xui-treegrid-hcell",tips:"$(RAD.fc.Click to configure lineset)",dragkey:"lineset",DATA:xui.clone(w,function(A,x){return"data"!=x}),special:"lineset",spceialcell:"line"})});b.push({type:"label",group:true,cellStyle:"font-weight:normal;font-style: italic;",caption:"$(RAD.fc.[ + Lineset])",tips:"$(RAD.fc.Add lineset)"})}s.push({type:"label2",group:true,cellStyle:"font-weight:normal;font-style: italic;",caption:"$(RAD.fc.[ + Group])",tips:"$(RAD.fc.Add dataset group)"});n.gridSet2.setTreeMode("inhandler").setRowHandlerWidth(150)}else{s.push({type:"label",group:true,cellStyle:"font-weight:normal;font-style: italic;",caption:"$(RAD.fc.[ + Dataset])",tips:"$(RAD.fc.Add dataset)"});n.gridSet2.setTreeMode("inhandler").setRowHandlerWidth(100)}if(FCCONF.attrCat[n._chartType]["Vertical data separator lines"]){d._ining2=1;d.boxing().iniPanelView("vsl");delete d._ining2}}n.gridSet2.setHeader(f).setRows(s);break;case"data":if(d._ining2){return}var l,e;if(n._Data_Type=="pointer"){l="pointer";e=xui.get(n.DATA,["pointers","pointer"])}else{if(n._Data_Type=="dial"){l="dial";e=xui.get(n.DATA,["dials","dial"])}else{l="set";e=xui.get(n.DATA,["data"])}}n._buildGrid(l,e,"gridSet");if(FCCONF.attrCat[n._chartType]["Vertical data separator lines"]){d._ining2=1;d.boxing().iniPanelView("vsl");delete d._ining2}break;case"vsl":if(d._ining){return}if(n._mutiser){n._buildGrid("Vertical data separator lines",xui.get(n.DATA,["categories",0,"category"]),"gridVSL",true)}else{n._buildGrid("Vertical data separator lines",xui.get(n.DATA,["data"]),"gridVSL",true)}d._ining=1;d.boxing().iniPanelView(n._mutiser?"data2":"data");delete d._ining;break;case"tl":if(n._TL_Type=="colorrange"){n._buildGrid("Color Range",xui.get(n.DATA,["colorrange","color"]),"gridTL")}else{n._buildGrid("Trend Lines",xui.get(n.DATA,["trendlines",0,"line"]),"gridTL")}break;case"vl":if(n._VL_Type=="trendpoints"){n._buildGrid("Trend Point",xui.get(n.DATA,["trendpoints","point"]),"gridVL")}else{n._buildGrid("Vertical Trend Lines",xui.get(n.DATA,["vtrendlines",0,"line"]),"gridVL")}break;case"ann":var a=n.DATA.annotations,j;if(!xui.get(a,["groups",0,"items",0])){j=[{id:"root",type:"root",caption:"$(RAD.fc.Annotations)",$data:{},sub:[{type:"group",caption:"$(RAD.fc.Annotation Group)",tagCmds:[{id:"Remove",type:"group",type:"text",caption:"&times;",tips:"$(RAD.fc.Remove Annotation Group)"}],$data:{},sub:[{type:"item",subtype:"text",caption:"$(RAD.fc.Annotation Item) - $(RAD.fc.svgType.text) ",tagCmds:[{id:"Remove",type:"text",caption:"&times;",tips:"$(RAD.fc.Remove Annotation Item)"}],$data:{type:"text"}},{type:"label2",itemStyle:"font-style: italic;cursor:pointer;",image:"{xui.ini.img_bg}",caption:"$(RAD.fc.[ + Annotation Item])"}]},{type:"label1",itemStyle:"font-style: italic;cursor:pointer;",image:"{xui.ini.img_bg}",caption:"$(RAD.fc.[ + Annotation Group])"}]}]}else{var m={id:"root",type:"root",caption:"$(RAD.fc.Annotations)",$data:{},sub:[]},o,q;j=[m];xui.merge(m.$data,a);delete m.$data.groups;xui.arr.each(a.groups,function(u){o={type:"group",caption:"$(RAD.fc.Annotation Group)",tagCmds:[{id:"Remove",type:"group",type:"text",caption:"&times;",tips:"$(RAD.fc.Remove Annotation Group)"}],$data:{},sub:[]};xui.merge(o.$data,u);delete o.$data.items;m.sub.push(o);xui.arr.each(u.items,function(w){q={type:"item",subtype:w.type,caption:"$(RAD.fc.Annotation Item) - $(RAD.fc.svgType."+w.type+") ",tagCmds:[{id:"Remove",type:"text",caption:"&times;",tips:"$(RAD.fc.Remove Annotation Item)"}],$data:{}};xui.merge(q.$data,w);o.sub.push(q)});o.sub.push({type:"label2",itemStyle:"font-style: italic;cursor:pointer;",image:"{xui.ini.img_bg}",caption:"$(RAD.fc.[ + Annotation Item])"})});m.sub.push({type:"label1",itemStyle:"font-style: italic;cursor:pointer;",image:"{xui.ini.img_bg}",caption:"$(RAD.fc.[ + Annotation Group])"})}n.tvann.setItems(j).fireItemClickEvent("root",true);break;default:}},_gridSet_beforehotrowadded:function(d,a){if(a){var c=this,b=d.boxing();if(!a[d.properties.header[0].id]){return false}else{c._change();return true}}},_gridVSL_beforehotrowadded:function(d,a){var c=this,b=d.boxing();if(xui.isNumb(a[d.properties.header[0].id])){c._change();return true}else{return false}},_gridTrend_beforehotrowadded:function(e,b){var d=this,c=e.boxing(),a=b[e.properties.header[0].id];if(a||a===0){d._change();return true}else{return false}},_cellupdated:function(d,a,b,e){var c=this;if("value" in a){if(xui.isStr(a.value)&&a.value.charAt(0)=="#"){a.value=a.value.replace("#","")}}a.needCollect=1;if(!e){c._change()}},_grid_onstartdrag:function(c){var b=this,a=b.btn_del;a.setDisplay("none");b.dialog.append(a);delete b._curgrid;delete b._currowid},_grid_onmousehover:function(f,l,d,g,j){if(f.box.isHotRow(l)){return}var c=this,b=f.boxing(),a=c.btn_del;xui.resetRun("TL_DEL",function(){if(d){var e=b.getSubNode("SCROLL22").get(0);a.setLeft(e.scrollLeft+e.clientWidth-20);xui(j).append(a);a.setDisplay("");c._curgrid=b;c._currowid=l.id}else{a.setDisplay("none");c.dialog.append(a);delete c._curgrid;delete c._currowid}})},_remove_clicked:function(g,f){var c=this,b=c.btn_del;if(c._curgrid&&c._currowid){var d=c._curgrid,a=c._currowid;var j=xui.Event.getPos(f);xui.confirm("$RAD.Remove?",xui.getRes("RAD.Are You Sure to remove this row")+"?",function(){b.setDisplay("none");c.dialog.append(b);d.removeRows([a]);delete c._curgrid;delete c._currowid;c._change()},null,null,null,c.dialog.getRoot().cssRegion())}},_gridSet2_onclickheader:function(c,a,d,f){var b=this,g="category";xui.ComFactory.getCom("RAD.PropEditor",function(){this.setProperties({targetProfile:b.properties.targetProfile,propKey:"JSONData.*",fc:1,realData:a.DATA,uiData:b._buildTG1(g,a.DATA,FCCONF.attrCat[b._chartType][g]),labelId:"label",src:f});this.setEvents({onLabelChanged:function(e){c.boxing().updateColumn(a.id,{caption:e})},onChanged:function(){b._change()}});this.show()})},_gridSet2_onclickgh:function(b,c,d){var a=this,f="categories";xui.ComFactory.getCom("RAD.PropEditor",function(){this.setProperties({targetProfile:a.properties.targetProfile,propKey:"JSONData.*",fc:1,realData:b.properties.tagVar,uiData:a._buildTG1(f,b.properties.tagVar,FCCONF.attrCat[a._chartType][f]),src:d});this.setEvents({onChanged:function(){a._change()}});this.show()})},_gridSet2_onclickrh:function(d,j,f,g){var c=this;if(j.type=="label"){if(j.xyPlot){d.boxing().insertRows([{caption:"[dataset]",xyPlot:1,group:1,firstCellClass:"xui-treegrid-hcell",tips:"$(RAD.fc.Click to configure dataset)",DATA:{seriesname:"[dataset]"}}],null,j.id,true);c._change()}else{var a=[];xui.arr.each(d.boxing().getHeader(),function(e){a.push({value:0,special:j.lineset?"line":null,DATA:{value:0}})});d.boxing().insertRows([{caption:"[dataset]",firstCellClass:"xui-treegrid-hcell",tips:"$(RAD.fc.Click to configure "+(j.lineset?"lineset":"dataset")+")",special:j.lineset?"lineset":null,spceialcell:j.lineset?"line":null,cells:a,DATA:{seriesname:j.lineset?"[lineset]":"[dataset]"}}],null,j.id,true);c._change()}}else{if(j.type=="label2"){var b=[];b.push({type:"label",group:true,caption:"[ + Dataset]",tips:"$(RAD.fc.Add dataset)"});d.boxing().insertRows([{caption:"Dataset group",group:true,tips:"$(RAD.fc.Dataset group)",datagroup:1,sub:b}],null,j.id,true);c._change()}else{if(!j.group||j.xyPlot){var c=this,l=j.special||"dataset";xui.ComFactory.getCom("RAD.PropEditor",function(){this.setProperties({targetProfile:c.properties.targetProfile,propKey:"JSONData.*",fc:1,realData:j.DATA,uiData:c._buildTG1(l,j.DATA,FCCONF.attrCat[c._chartType][l]),labelId:"seriesName",src:g});this.setEvents({onLabelChanged:function(e){d.boxing().updateRow(j.id,{caption:e})},onChanged:function(){c._change()}});this.show()})}}}},_gridSet2_pop:function(d,b,a,l,f,g){var c=this,j=b.special||b._row.spceialcell||"set";if(!b.DATA){b.DATA={}}xui.ComFactory.getCom("RAD.PropEditor",function(){this.setProperties({targetProfile:c.properties.targetProfile,propKey:"JSONData.*",fc:1,realData:b.DATA,uiData:c._buildTG1(j,b.DATA,FCCONF.attrCat[c._chartType][j]),labelId:"value",src:g});this.setEvents({onLabelChanged:function(e){a.boxing().setUIValue(e)},onChanged:function(){c._change()}});this.show()})},_gridset2_bcr:function(b,c){var a=this;b.boxing().setRowOptions({rowRenderer:function(d,e){if(e.type!="label"&&e.type!="label2"&&!e.lineset){d.getSubNode("FCELL",e._serialId).first().prepend(new xui.UI.Span({position:"relative",className:"xuicon xui-uicmd-close",width:"auto",height:"auto",right:0,bottom:0,tips:"$(RAD.fc.Remove this dataset)"},{beforeHoverEffect:function(g,j,l,m,f){xui(m).css({border:f=="mouseover"?"solid 1px #ccc":"",padding:f=="mouseover"?"":"1px"})},onClick:function(g,f){var j=xui.Event.getPos(f);xui.confirm("$RAD.Remove?",xui.getRes("RAD.fc.Are You Sure to remove this dataset")+"?",function(){d.boxing().removeRows([e.id]);a._change()});xui.Event.stopBubble(f)}},null,null,{KEY:"padding:1px;cursor:pointer;"}));if(e.xyPlot){d.getSubNode("LCELL",e._serialId).append(new xui.UI.SButton({position:"relative",imageClass:"xui-uicmd-opt",caption:" $(RAD.fc.Data Configuration)"},{onClick:function(f,g,j){xui.ComFactory.getCom("RAD.MixPropEditor",function(){var l=a._buildGrid("set",e.DATA2);this.setProperties({targetProfile:a.properties.targetProfile,propKey:"xyPlot",uiHeader:l.header,uiRows:l.rows,fc:1,src:j});this.setEvents({onChanged:function(m){e.DATA2=m;a._change()}});this.show()})}}))}}}}).setColOptions({colRenderer:function(e,d){e.getSubNode("HCELLA",d._serialId).append(new xui.UI.Span({className:"xuicon xui-uicmd-close",left:"auto",top:"auto",width:"auto",height:"auto",right:0,bottom:0,tips:"$(RAD.fc.Remove this category)"},{beforeHoverEffect:function(g,j,l,m,f){xui(m).css({border:f=="mouseover"?"solid 1px #ccc":"",padding:f=="mouseover"?"":"1px"})},onClick:function(g,f){var j=xui.Event.getPos(f);xui.confirm("$RAD.Remove?",xui.getRes("RAD.fc.Are You Sure to remove this category")+"?",function(){e.boxing().removeCols([d.id]);a._change()},null,null,null,a.dialog.getRoot().cssRegion());xui.Event.stopBubble(f)}},null,null,{KEY:"padding:1px;cursor:pointer"}))}})},_gridset2_oncr:function(b,c){var a=this;b.boxing().getSubNode("FHCELL").first().append(new xui.UI.Span({className:"xuicon xui-uicmd-add",left:"auto",top:"auto",width:"auto",height:"auto",right:0,bottom:0,tips:"$(RAD.fc.Add category)"},{beforeHoverEffect:function(f,g,j,l,d){xui(l).css({border:d=="mouseover"?"solid 1px #ccc":"",padding:d=="mouseover"?"":"1px"})},onClick:function(f,d){var g=xui.id()+xui.stamp();b.boxing().insertCol({id:g,type:"popbox",caption:"[category]",tips:"$(RAD.fc.Click to cofigure category)",DATA:{label:"[category]"}});a._change();xui.asyRun(function(){if(!b||b.destroyed){return}var e=b.getSubNode("HCELLA",true);if(e=e.get(e.size()-1)){e.scrollIntoView()}});xui.Event.stopBubble(d)}},null,null,{KEY:"padding:1px;cursor:pointer"}))},_gridset2_bds:function(a,b,d){var c=a.boxing().getRowByDom(d);if(c&&(c.type=="label"||c.type=="label2"||c.lineset)){return false}},_gridset2_dragdata:function(a,b,d){var c=a.boxing().getRowByDom(d);return c.dragkey||"normal"},_gridset2_dtest:function(a,b,d){if(a.getKey(d).split("-")[1]!=="CELLS"){return false}var f=xui.DragDrop.getProfile(),c=a.boxing().getRowByDom(d);if(xui.get(f,["dragData","data"])!==c.dragkey){return false}},_grid_ondrop:function(b){var a=this;a._change();return false}}});xui.Class("RAD.PropEditor","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dialog").setLeft("10em").setTop("2.5em").setWidth("21.666666666666668em").setHeight("22.5em").setShadow(false).setResizer(false).setCaption("$(RAD.designer.attreditor.Attributes Editor)").setMinBtn(false).setMaxBtn(false).beforeClose("_dialog_beforeclose"));c.dialog.append(xui.create("xui.UI.Block").setHost(c,"ctl_block1").setDock("fill").setBorderType("inset"));c.ctl_block1.append(xui.create("xui.UI.TreeGrid").setHost(c,"grid").setShowDirtyMark(false).setEditable(true).setRowHandler(false).setColSortable(false).setHeader([{id:"name",caption:"$RAD.designer.attreditor.Attribute",width:"13.583333333333334em",type:"label"},{id:"value",caption:"$RAD.designer.attreditor.Value",flexSize:true,width:"10.666666666666666em",type:"input"}]).setTreeMode("none").afterCellUpdated("_grid_aftercellupdated").beforeComboPop("_grid_beforepop"));return b},customAppend:function(c,a,g,f){var b=this,j=b.properties,e=j.targetProfile.boxing();b.DATA=j.realData||{};window.SPA&&SPA.fe("onInitEditorRows",[j.propKey,"",j.realData,"RAD.PropEditor",e,j.uiData,b.grid]);if(window.SPA&&SPA.events.onInitPropValueCell){xui.arr.each(j.uiData,function(l){xui.arr.each(l.cells,function(m,n){window.SPA&&SPA.fe("onInitPropValueCell",[j.propKey,j.uiHeader[n].id,m.value,"RAD.PropEditor",e,m,b.grid])})})}b.grid.setRows(j.uiData,true);var d=function(){xui.Event.keyboardHook("esc");b.dialog.close()};xui("body").append(b.dialog);b.dialog.getRoot().popToTop(xui(j.src)).setBlurTrigger("RAD.PropEditor",d);xui.Event.keyboardHook("esc",0,0,0,d);b.dialog.activate();b._dirty=0;return true},_grid_aftercellupdated:function(d,a,b,e){var c=this;if("value" in a){if(c.properties.fc){if(!xui.isSet(a.value)||a.value===""){delete c.DATA[a.id.toLowerCase()]}else{if(xui.isStr(a.value)&&a.value.charAt(0)=="#"){a.value=a.value.replace("#","")}c.DATA[a.id.toLowerCase()]=a.value===false?"0":a.value===true?"1":a.value}}else{if(!xui.isSet(a.value)||a.value===""){delete c.DATA[a.id]}else{c.DATA[a.id]=a.value}}}var f=c.properties.labelId;if(f&&a._row.id===f){c.fireEvent("onLabelChanged",[a.value])}c._dirty=1},_grid_beforepop:function(c,m,d,j,f,a){var l=this,g=b.targetProfile.boxing(),b=l.properties;if(window.SPA&&false===SPA.fe("beforeEditorComboPop",[b.propKey,m._col.id,m.value,function(e){d.boxing().setUIValue(e||"",true)},"RAD.PropEditor",g,j,c.getSubNode("CELL",m._serialId).get(0),m,c.boxing(),d&&d.boxing()])){return false}},_dialog_beforeclose:function(b){var a=this;if(a._dirty){a.fireEvent("onChanged",[a.DATA])}a.DATA=null;b.boxing().hide();a.grid.removeAllRows();a._dirty=0;return false}}});xui.Class("RAD.MixPropEditor","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dialog").setLeft("10em").setTop("2.5em").setWidth("44.166666666666664em").setHeight("22.5em").setShadow(false).setResizer(false).setCaption("$(RAD.designer.attreditor.Attributes Editor)").setMinBtn(false).onHotKeydown("_dialog_onhotkeydown").beforeClose("_dialog_beforeclose"));c.dialog.append(xui.create("xui.UI.Block").setHost(c,"ctl_block1").setDock("fill").setBorderType("inset"));c.ctl_block1.append(xui.create("xui.UI.TreeGrid").setHost(c,"grid").setShowDirtyMark(false).setRowNumbered(true).setEditable(true).setRowHandlerWidth("6em").setTagCmds([{id:"del1",location:"left",itemClass:"xuicon xui-uicmd-close",pos:"header",tips:"Clear all rows"},{id:"del2",location:"left",pos:"row",itemClass:"xuicon xui-uicmd-close",tips:"Remove the current row"}]).setTreeMode("none").setHotRowMode("show").setDropKeys("haha").setDragKey("haha").onInitHotRow("_grid_oninithotrow").beforeHotRowAdded("_gridTrend_beforehotrowadded").afterHotRowAdded("_gridTrend_afterHotRowAdded").onCmd("_grid_ontagcmd").beforeCellUpdated("_grid_beforecellupdated").afterCellUpdated("_grid_aftercellupdated").onClickCell("_grid_onclickcell").beforeComboPop("_grid_beforepop").onCommand("_grid_oncommand").onDrop("_grid_ondrop"));c.ctl_block1.append(xui.create("xui.UI.Block").setHost(c,"ctl_block4").setDock("bottom").setHeight("3.0833333333333335em"));c.ctl_block4.append(xui.create("xui.UI.Div").setHost(c,"xui_ui_div19").setTop("0em").setWidth("17.416666666666668em").setHeight("2.9166666666666665em").setRight("0em"));c.xui_ui_div19.append(xui.create("xui.UI.Button").setHost(c,"ctl_ba").setLeft("0em").setTop("0.5833333333333334em").setWidth("6.583333333333333em").setHeight("2em").setCaption("$RAD.designer.attreditor.Apply").onClick("_ctl_ba_onclick"));c.xui_ui_div19.append(xui.create("xui.UI.Button").setHost(c,"ctl_bc").setLeft("8.083333333333334em").setTop("0.5833333333333334em").setWidth("6.583333333333333em").setHeight("2em").setCaption("$RAD.designer.attreditor.Cancel").onClick("_ctl_bc_onclick"));c.ctl_block4.append(xui.create("xui.UI.Button").setHost(c,"xui_ui_button7").setLeft("1.5833333333333333em").setTop("0.5em").setWidth("6.583333333333333em").setHeight("2em").setCaption("[JSON]").onClick("_xui_ui_button7_onclick"));return b},customAppend:function(c,a,f,e){var b=this,g=b.properties;target=g.targetProfile.boxing();if(g.subheader&&g.subheader.length){g.uiHeader.push({id:"[sub]",caption:"$(RAD.designer.attreditor.[sub])",type:"button",cellRenderer:function(){return xui.getRes("RAD.designer.attreditor."+g.innerKey)}})}window.SPA&&SPA.fe("onInitEditorRows",[g.propKey,g.propN,g.uiRows,"RAD.MixPropEditor",target,g.uiRows,b.grid]);if(window.SPA&&SPA.events.onInitPropValueCell){xui.arr.each(g.uiRows,function(j){xui.arr.each(j.cells,function(l,m){window.SPA&&SPA.fe("onInitPropValueCell",[g.propKey,g.uiHeader[m].id,l.value,"RAD.MixPropEditor",target,l,b.grid])})})}b.grid.get(0)._targetProfile=g.targetProfile;b.grid.get(0)._targetPropKey=g.propKey;b.grid.setHeader(g.uiHeader,true);b.grid.setRows(g.uiRows,true);b._dirty=0;var d=function(){b.dialog.close()};xui("body").append(b.dialog);b.dialog.getRoot().popToTop(xui(g.src),null,null,function(){if(g.fixedRows){b.grid.setHotRowMode("none")}else{b.grid.setHotRowMode("show");b.grid.addHotRow()}}).setBlurTrigger("RAD.MixPropEditor"+b.$xid,d);if(g.treeMode){b.grid.setTreeMode("infirstcell").setRowHandlerWidth("6em")}else{b.grid.setTreeMode("none").setRowHandlerWidth("4em")}b.dialog.activate();return true},_grid_beforecellupdated:function(g,a,b,j){var f=this;if("value" in b&&f.properties.uniqueKey&&f.properties.uniqueKey===a._col.id){var e=g.boxing(),d=a._col.id,c=true;xui.each(e.getCells(null,d,true),function(l){if(a!==l&&l.value===b.value){return c=false}});if(!c){xui.message(xui.adjustRes("$(RAD.msg.$0 '$1' already exists-"+d+"-"+b.value+")"));return false}}},_grid_oninithotrow:function(d){var e=d.properties.header,b=[];for(var c=0,a=e.length;c<a;c++){b.push({})}if(e[e.length-1].id=="[sub]"){b[e.length-1].disabled=true}return b},_grid_aftercellupdated:function(d,a,b,e){var c=this;if("value" in b){if(c.properties.fc){if(xui.isStr(a.value)&&a.value.charAt(0)=="#"){a.value=a.value.replace("#","")}}}a.needCollect=1;c._dirty=1},_grid_ondrop:function(b){var a=this;a._dirty=1;return false},_grid_oncommand:function(e,b,a,f,d){var c=b._col.tagVar;if(c){if(c.prop=="imageClass"){xui.getModule("RAD.SelFontAwesome",function(j,g){g.render(true);g.getRoot().popToTop(f).setBlurTrigger("design:pop:SelFontAwesome",function(){g.destroy()});this.setEvents("onSel",function(l){if(a){a.boxing().setUIValue(l)}else{e.boxing().updateCell(b,{value:l})}})})}}},_grid_ontagcmd:function(b,g,d,c,f){if(d!="del1"&&d!="del2"){return}var a=this;xui.confirm("$RAD.Remove?",xui.getRes(g?"RAD.Are You Sure to remove this row":"Are You Sure to remove all")+"?",function(){if(g){b.boxing().removeRows([g.id])}else{b.boxing().removeAllRows()}a._dirty=1},null,null,null,a.dialog.getRoot().cssRegion())},_grid_beforepop:function(c,a,b,j,d,f){var g=this.properties;if(window.SPA&&false===SPA.fe("beforeEditorComboPop",[g.propKey,a._col.id,a.value,function(e){b.boxing().setUIValue(e||"",true)},"RAD.MixPropEditor",g.targetProfile.boxing(),j,c.getSubNode("CELL",a._serialId).get(0),a,c.boxing(),b&&b.boxing()])){return false}},_gridTrend_afterHotRowAdded:function(e,f){var d=this,g=d.properties;if(g.headerSize){var b=[];for(var c=0,a=g.headerSize;c<a;c++){b.push({value:""})}f._innerData=b}xui.arr.each(f.cells,function(j){if(j.value){j.needCollect=1}})},_gridTrend_beforehotrowadded:function(d,a,f){var c=this,g=c.properties,b=d.boxing(),e=a[d.properties.header[0].id];if(xui.isSet(e)&&e!==""){if(c.properties.treeMode){f.sub=[]}xui.arr.each(f.cells,function(j){delete j.disabled});c._dirty=1;return true}else{return false}},_dialog_beforeclose:function(b){var a=this;a.dialog.getRoot().setBlurTrigger("RAD.MixPropEditor"+a.$xid);if(!a._noSave){a._apply()}a.dialog.hide();a.grid.removeAllRows();a.grid.get(0)._id=new xui.id();xui(a.properties.src).focus();return false},collectData:function(c,d,a){var b=this;if(!a){a=[]}xui.arr.each(c,function(e){if(xui.UI.TreeGrid.isHotRow(e)){return}data={};xui.arr.each(e.cells,function(f,g){if(f.needCollect){if(b.properties.fc){data[d[g].toLowerCase()]=f.value===false?"0":f.value===true?"1":(f.value+"")}else{data[d[g]]=f.obj||f.value}}});if(e._innerData&&b.properties.innerKey){data[b.properties.innerKey]=xui.clone(e._innerData,function(g,f){return(f+"").charAt(0)!="_"})}a.push(data);if(e.sub&&e.sub.length){data.sub=[];b.collectData(e.sub,d,data.sub)}});return a},_apply:function(){var b=this;if(b._dirty){var a=b.grid,c=a.getHeader("min");rows=b.collectData(a.getRows(),c);b._dirty=0;b._noSave=1;b.fireEvent("onChanged",[rows,c]);delete b._noSave}},_ctl_ba_onclick:function(b,d,f,c){var a=this;a._apply();a._noSave=1;a.dialog.close();delete a._noSave},_ctl_bc_onclick:function(b,d,f,c){var a=this;a._noSave=1;a.dialog.close();delete a._noSave},_grid_onclickcell:function(c,j,f,a){var g=this,b=g.properties;if(j._col.id=="[sub]"){if(c.box.isHotRow(j._row)){return}if(!j._row._innerData){j._row._innerData=new Array(b.fixedRows)}var m=[],l,d;xui.arr.each(j._row._innerData,function(n,e){l={cells:[]};xui.arr.each(b.subheader,function(q,o){var r=(q.id||q)+"";d={};if(xui.isHash(n)&&(r in n)){if(typeof n[r]=="object"||typeof n[r]=="function"){d.obj=n[r]}else{d.value=n[r]}d.needCollect=1}else{if(r=="id"){d.value=n;d.needCollect=1}}l.cells.push(d)});m.push(l)});xui.ComFactory.newCom("RAD.MixPropEditor",function(){this.setProperties({targetProfile:b.targetProfile,propKey:b.propKey+"[sub]",uiHeader:b.subheader,uiRows:m,treeMode:false,fixedRows:b.subFixedRows,uniqueKey:b.uniqueKey,src:a}).setEvents({onChanged:function(e){j._row._innerData=e;xui(a).focus();g._dirty=1}});this.show()})}},_dialog_onhotkeydown:function(c,a,d,f){var b=this;if(a.key=="esc"){b.dialog.close()}},_xui_ui_button7_onclick:function(c,g,j,f){var b=this,a=b.grid,l=a.getHeader("min"),d=b.collectData(a.getRows(),l);xui.ModuleFactory.getCom("jsonEditor",function(){this.setProperties({caption:"Object Code",imageClass:"spafont spa-icon-hash",text:d,onOK:function(o,e){b._dirty=1;var n=[],q,m;xui.arr.each(o.properties.object,function(r){n.push(q=[]);xui.each(r,function(u,s){if(-1!=(m=xui.arr.indexOf(l,s))){q[m]={needCollect:1,value:u}}})});b.grid.setRows(n)}});this.show()})}}});xui.Class("RAD.RegisterForm","xui.Module",{Instance:{customAppend:function(){var a=this;if(a.properties.registered){a.ctl_sbutton9.setCaption("$RAD.Close");a.ctl_input2.setDisabled(true);a.ctl_sbutton5.setDisabled(true);xui.alert(xui.adjustRes("$(RAD.designer.license.You'v registered already)!"))}if(!a.properties.autoClose){a.dlg.showModal()}else{a.dlg.show();a.dlg.getRoot().setBlurTrigger("$registerWnd",function(){if(!a.isDestroyed()){a.dlg.close()}})}return true},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dlg").setLeft("11.75em").setTop("1.75em").setWidth("31.5em").setHeight("15.25em").setResizer(false).setCaption("$(RAD.designer.license.EUSUI License Statements)").setMinBtn(false).setMaxBtn(false).setCloseBtn(false).setOverflow("hidden").onHotKeydown("_dlg_onhotkeydown"));c.dlg.append(xui.create("xui.UI.Button").setHost(c,"ctl_sbutton9").setDefaultFocus(true).setLeft("1.25em").setTop("9.083333333333334em").setWidth("27.916666666666668em").setHeight("2.25em").setCaption("$(RAD.designer.license.Continue Free Trial)").onClick("_ctl_sbutton9_onclick").setCustomStyle({CAPTION:{"font-size":"14pt","font-weight":"bold"}}));c.dlg.append(xui.create("xui.UI.Block").setHost(c,"ctl_block171").setLeft("0.5625em").setTop("0.1875em").setWidth("30em").setHeight("8.083333333333334em").setBorderType("groove").setOverflow("hidden"));c.ctl_block171.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel1").setLeft("0.75em").setTop("0.25em").setWidth("28.333333333333332em").setHeight("1.25em").setBottom("0em").setCaption("$RAD.designer.msg.annoncement1").setHAlign("left"));c.ctl_block171.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel37").setLeft("0.75em").setTop("2.0833333333333335em").setWidth("28.333333333333332em").setHeight("3em").setBottom("0em").setCaption("$RAD.designer.msg.annoncement2").setHAlign("left"));c.ctl_block171.append(xui.create("xui.UI.Button").setHost(c,"ctl_sbutton5").setLeft("19.1875em").setTop("5.333333333333333em").setWidth("9.916666666666666em").setCaption("$(RAD.designer.license.Register the license)").onClick("_ctl_sbutton5_onclick"));c.ctl_block171.append(xui.create("xui.UI.ComboInput").setHost(c,"ctl_input2").setDirtyMark(false).setLeft("0.3125em").setTop("5.333333333333333em").setWidth("18.5em").setLabelSize(130).setLabelCaption("$(RAD.designer.license.Enter License Code)").setType("none"));return b},_ctl_sbutton5_onclick:function(b,f,g,d){var a=this,c=a.ctl_input2.getUIValue();c=xui.str.trim(c);if(!c){return}a.dlg.busy(xui.adjustRes("$(RAD.designer.license.Try to register) ..."));this.fireEvent("onOK",[c,function(e){SPA.statusBar.setHtml(e);a.dlg.free();xui.alert(xui.adjustRes("$(RAD.designer.license.Congratulations, you have successfully registered)!"));if(!a.isDestroyed()){a.dlg.close()}},function(e){a.dlg.free();xui.alert(e)}])},_ctl_sbutton9_onclick:function(a,c,d,b){if(!this.isDestroyed()){this.dlg.close()}},_dlg_onhotkeydown:function(b,a,c,d){if(a.key=="esc"){if(!this.isDestroyed()){this.dlg.close()}}}}});xui.Class("RAD.DownloadNW","xui.Module",{Instance:{customAppend:function(e){var d=this,j=d.properties,c=j.url,b=j.dest,f=j.entryName,g=j.callback,a=b+"/temp_"+c.split("/").pop();d.btn_cancel.setDisabled(false);d._downloadres=NWUtil.download(c,a,function(l){if(d.progressbar){d.progressbar.setValue(l,true)}},function(n){var r=require("fs");if(r.existsSync(a)){d.btn_cancel.setDisabled(true);d.ctl_slabel5.setCaption("$(RAD.download.Extracting)...");var x=require("path"),m=x.extname(a);if(m==".zip"){var o=require("extract-zip"),l=[];o(a,{dir:b,onEntry:function(A){l.push({mode:A.externalFileAttributes>>>16,path:A.fileName})}},function(A){if(A){xui.alert(A.message);d.destroy()}l.forEach(function(B){r.chmodSync(x.join(b,B.path),B.mode)});r.unlinkSync(a);if(r.existsSync(b+"/"+f)){g(b+"/"+f)}else{xui.alert(f+" donesnt in the package!")}d.destroy()})}else{if(m==".gz"){var w=require("zlib"),s=require("tar-fs"),u=w.createGunzip(),q=/^win/.test(process.platform);r.createReadStream(a).pipe(w.createGunzip()).pipe(s.extract(b,{umask:(q?false:0)})).on("finish",function(A){if(!A){r.unlinkSync(a);if(r.existsSync(b+"/"+f)){g(b+"/"+f)}else{xui.alert(f+" donesnt in the package!")}d.destroy()}else{xui.alert(A.message);d.destroy()}})}else{xui.alert("Target is not a zip or gzip file!");d.destroy()}}}else{xui.alert("Download failed!");d.destroy()}},function(l){xui.message(xui.adjustRes(l));d.destroy()});d.ctl_slabel5.setCaption(f+" $(RAD.download.will be download to) : ");d.ctl_slabel6.setCaption(b);d.dlg.showModal()},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dlg").setLeft("5.833333333333333em").setTop("2.5em").setWidth("51em").setHeight("10.833333333333334em").setResizer(false).setCaption("$(RAD.download.Before the first deploy for this platform, we need to download the corresponding packager)...").setMinBtn(false).setMaxBtn(false).setRestoreBtn(false).setCloseBtn(false).setOverflow("hidden"));c.dlg.append(xui.create("xui.UI.ProgressBar").setHost(c,"progressbar").setLeft("0.625em").setTop("4.25em").setWidth("36em").setHeight("2em"));c.dlg.append(xui.create("xui.UI.Button").setHost(c,"btn_cancel").setLeft("38.333333333333336em").setTop("4.166666666666667em").setWidth("10.166666666666666em").setCaption("$(RAD.download.Cancel Download)").onClick("_btn_cancel_onclick"));c.dlg.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel5").setLeft("0.625em").setTop("0.5em").setWidth("48.5em").setHeight("1.1875em").setCaption("").setHAlign("left"));c.dlg.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel6").setLeft("0.625em").setTop("2em").setWidth("48.5em").setHeight("1.1666666666666667em").setCaption("").setHAlign("left"));return b},_btn_cancel_onclick:function(b,c,d){var a=this;a._downloadres.abort();xui.alert(xui.adjustRes("$(RAD.download.In order to deploy the application, you have to try it again later)."));a.destroy()}},Static:{viewStyles:{}}});xui.Class("RAD.CustomPackage","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"ctl_dialog").setLeft("8.5em").setTop("1.8333333333333333em").setWidth("28.166666666666668em").setHeight("21.416666666666668em").setCaption("$(RAD.nwpackage.Build Options)").setMinBtn(false).setMaxBtn(false).setOverflow("hidden").beforeClose("_ctl_dialog_beforeclose"));c.ctl_dialog.append(xui.create("xui.UI.Group").setHost(c,"ctl_group1").setLeft("0.625em").setTop("7.416666666666667em").setWidth("11.833333333333334em").setOverflow("hidden").setCaption("$RAD.nwpackage.Appearance").setToggleBtn(false));c.ctl_group1.append(xui.create("xui.UI.RadioBox").setHost(c,"ctl_lappearance").setDirtyMark(false).setDock("fill").setLeft("0.625em").setTop("0em").setWidth("6.25em").setHeight("6.25em").setSelMode("multi").setItemRow(true).setCheckBox(true).setValue(""));c.ctl_dialog.append(xui.create("xui.UI.Group").setHost(c,"ctl_group3").setLeft("13.333333333333334em").setTop("0.625em").setWidth("13.25em").setHeight("13.416666666666666em").setOverflow("hidden").setCaption("$(RAD.nwpackage.Locale files)").setToggleBtn(false));c.ctl_group3.append(xui.create("xui.UI.RadioBox").setHost(c,"ctl_llocale").setDirtyMark(false).setItems([{id:"en.js",caption:"$RAD.nwpackage.English",disabled:true},{id:"ru.js",caption:"$RAD.nwpackage.Russian",image:""},{id:"ja.js",caption:"$RAD.nwpackage.Japanese "},{id:"cn.js",caption:"$(RAD.nwpackage.Simplified Chinese)"},{id:"tw.js",caption:"$(RAD.nwpackage.Traditional Chinese)",image:""}]).setDock("fill").setLeft("0.5625em").setTop("0.375em").setWidth("11.916666666666666em").setHeight("10.5em").setSelMode("multi").setItemRow(true).setCheckBox(true).setValue("en.js"));c.ctl_dialog.append(xui.create("xui.UI.Group").setHost(c,"ctl_group4").setLeft("0.625em").setTop("0.625em").setWidth("11.833333333333334em").setHeight("5.916666666666667em").setOverflow("hidden").setCaption("$(RAD.nwpackage.XUI core)").setToggleBtn(false));c.ctl_group4.append(xui.create("xui.UI.RadioBox").setHost(c,"ctl_llib").setDirtyMark(false).setItems([{id:"xui-all.js",caption:"xui lib",image:"",disabled:true}]).setDock("fill").setLeft("0.625em").setTop("0.375em").setWidth("6.25em").setHeight("3.375em").setSelMode("multi").setItemRow(true).setCheckBox(true).setValue("xui-all.js"));c.ctl_dialog.append(xui.create("xui.UI.Button").setHost(c,"ctl_ok").setLeft("19.75em").setTop("15.75em").setWidth("4.375em").setCaption("$inline.ok").onClick("_ctl_ok_onclick"));c.ctl_dialog.append(xui.create("xui.UI.Button").setHost(c,"ctl_cancel").setLeft("14.166666666666666em").setTop("15.75em").setWidth("4.375em").setCaption("$inline.cancel").onClick("_ctl_cancel_onclick"));return b},customAppend:function(){var f=this;var d=SPA.curProjectPath+"/.settings/project.json",c=CONF.getStatus(d),a=["en.js"];c=c.Compile||{};if(c.lib){f.ctl_llib.setValue(c.lib)}if(c.appearance){f.ctl_lappearance.setValue(c.appearance)}if(c.locale){for(var e=0,b=c.locale.length,g;e<b;e++){g=c.locale[e];if(!xui.str.endWith(g,".js")){g=g+".js"}if(xui.arr.indexOf(a,g)==-1){a.push(g)}}}else{if(CONF.dftPackageLang){for(var e=0,b=CONF.dftPackageLang.length,g;e<b;e++){g=CONF.dftPackageLang[e];if(!xui.str.endWith(g,".js")){g=g+".js"}if(xui.arr.indexOf(a,g)==-1){a.push(g)}}}}f.ctl_llocale.setValue(a);f.ctl_dialog.showModal();return true},_ctl_cancel_onclick:function(a,c,d,b){this.ctl_dialog.close()},_ctl_ok_onclick:function(f,j,l,g){var d=this,c={Compile:{lib:d.ctl_llib.getValue(true),appearance:d.ctl_lappearance.getValue(true),locale:d.ctl_llocale.getValue(true)}};var b=SPA.curProjectPath+"/.settings/project.json";var a=CONF.getStatus(b);xui.merge(a,c,"all");CONF.saveStatus(a,b);d.fireEvent("onOK",[c.Compile.lib,c.Compile.appearance,c.Compile.locale]);d._ok=1;d.ctl_dialog.close()},_ctl_dialog_beforeclose:function(a){if(!this._ok){this.fireEvent("onCancel")}},events:{onReady:"_onReady"},_onReady:function(b,c){var a=[];xui.arr.each(CONF.designer_themes2,function(d){if(!d){return}a.push({id:d,caption:xui.str.initial(d),disabled:d=="default"})});this.ctl_lappearance.setItems(a).setValue("default",true)}}});xui.Class("RAD.CustomNWPackage","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"ctl_dialog").setLeft("7.5em").setTop("5.625em").setWidth("39.166666666666664em").setHeight("22.583333333333332em").setCaption("$(RAD.nwpackage.Build Options)").setMinBtn(false).setMaxBtn(false).setOverflow("hidden"));c.ctl_dialog.append(xui.create("xui.UI.Group").setHost(c,"ctl_group1").setLeft("12.5em").setTop("10em").setWidth("11.666666666666666em").setHeight("8.333333333333334em").setOverflow("hidden").setCaption("$RAD.nwpackage.Appearance").setToggleBtn(false));c.ctl_group1.append(xui.create("xui.UI.RadioBox").setHost(c,"ctl_lappearance").setDirtyMark(false).setDock("fill").setLeft("0.625em").setTop("0em").setWidth("6.25em").setHeight("6.25em").setSelMode("multi").setItemRow(true).setCheckBox(true).setValue(""));c.ctl_dialog.append(xui.create("xui.UI.Group").setHost(c,"ctl_group3").setLeft("25em").setTop("2.5em").setWidth("12.416666666666666em").setHeight("13.333333333333334em").setOverflow("hidden").setCaption("$(RAD.nwpackage.Locale files)").setToggleBtn(false));c.ctl_group3.append(xui.create("xui.UI.RadioBox").setHost(c,"ctl_llocale").setDirtyMark(false).setItems([{id:"en.js",caption:"$RAD.nwpackage.English",disabled:true},{id:"ru.js",caption:"$RAD.nwpackage.Russian",image:""},{id:"ja.js",caption:"$RAD.nwpackage.Japanese "},{id:"cn.js",caption:"$(RAD.nwpackage.Simplified Chinese)"},{id:"tw.js",caption:"$(RAD.nwpackage.Traditional Chinese)",image:""}]).setDock("fill").setLeft("0.5625em").setTop("0.375em").setHeight("8.375em").setSelMode("multi").setItemRow(true).setCheckBox(true).setValue("en.js"));c.ctl_dialog.append(xui.create("xui.UI.Group").setHost(c,"ctl_group4").setLeft("12.5em").setTop("2.5em").setWidth("11.666666666666666em").setHeight("6.666666666666667em").setOverflow("hidden").setCaption("$(RAD.nwpackage.XUI core)").setToggleBtn(false));c.ctl_group4.append(xui.create("xui.UI.RadioBox").setHost(c,"ctl_llib").setDirtyMark(false).setItems([{id:"xui-all.js",caption:"xui lib",image:"",disabled:true}]).setDock("fill").setLeft("0.625em").setTop("0.375em").setWidth("6.25em").setHeight("3.375em").setSelMode("multi").setItemRow(true).setCheckBox(true).setValue("xui-all.js"));c.ctl_dialog.append(xui.create("xui.UI.Group").setHost(c,"ctl_group8").setLeft("0.625em").setTop("2.5em").setWidth("11.25em").setHeight("15.833333333333334em").setOverflow("hidden").setCaption("$(RAD.nwpackage.Node modules)").setToggleBtn(false));c.ctl_group8.append(xui.create("xui.UI.RadioBox").setHost(c,"ctl_lmodule").setDirtyMark(false).setLeft("0.5625em").setTop("0.375em").setHeight("11.5em").setSelMode("multi").setItemRow(true).setCheckBox(true).setValue(""));c.ctl_dialog.append(xui.create("xui.UI.Button").setHost(c,"ctl_ok").setLeft("31.5em").setTop("16.666666666666668em").setWidth("4.375em").setCaption("$inline.ok").onClick("_ctl_ok_onclick"));c.ctl_dialog.append(xui.create("xui.UI.Button").setHost(c,"ctl_cancel").setLeft("25.833333333333332em").setTop("16.666666666666668em").setWidth("4.375em").setCaption("$inline.cancel").onClick("_ctl_cancel_onclick"));c.ctl_dialog.append(xui.create("xui.UI.Input").setHost(c,"ctl_name").setDirtyMark(false).setLeft("0.625em").setTop("0.25em").setWidth("36.75em").setLabelSize(150).setLabelCaption("$(RAD.nwpackage.Executable file name)"));return b},customAppend:function(){var c=this,b=SPA.curProjectPath+"/.settings/project.json",a=CONF.getStatus(b);a=a.Compile||{};c.ctl_lmodule.setItems(this.properties.nodeModules||[]);c.ctl_name.setValue(a.exefile||SPA.curProjectName);if(a.lib){c.ctl_llib.setValue(a.lib)}if(a.appearance){c.ctl_lappearance.setValue(a.appearance)}if(a.locale){c.ctl_llocale.setValue(a.locale)}if(a.module){c.ctl_lmodule.setValue(a.module)}c.ctl_dialog.showModal();return true},_ctl_cancel_onclick:function(a,c,d,b){this.ctl_dialog.close()},_ctl_ok_onclick:function(d,g,a,m){var l=this,c=xui.str.trim(l.ctl_name.getUIValue());if(!CONF.fileNames.test(c)){xui.message(xui.getRes("RAD.addfile.invalidName"));return}var j={Compile:{exefile:c,lib:l.ctl_llib.getValue(true),appearance:l.ctl_lappearance.getValue(true),locale:l.ctl_llocale.getValue(true),module:l.ctl_lmodule.getValue(true)}},b=SPA.curProjectPath+"/.settings/project.json";NWUtil.ensureConfigAndIcon(SPA.curProjectPath);var f=CONF.getStatus(b);xui.merge(f,j,"all");CONF.saveStatus(f,b);l.fireEvent("onOK",[j.Compile.exefile,j.Compile.lib,j.Compile.appearance,j.Compile.locale,j.Compile.module]);l.ctl_dialog.close()},events:{onReady:"_onReady"},_onReady:function(b,c){var a=[];xui.arr.each(CONF.designer_themes2,function(d){if(!d){return}a.push({id:d,caption:xui.str.initial(d),disabled:d=="default"})});this.ctl_lappearance.setItems(a).setValue("default",true)}}});xui.Class("PhoneGapBuild","xui.Module",{Static:{token:null,api:null,maxRetryTimes:10,url:"/apps",platforms:["ios","android","winphone"],tryToSignIn:function(g,b,f,e){var a=require("phonegap-build-api"),c={};var d=PhoneGapBuild;if(b&&f){c.username=b;c.password=f}else{if(d.token){c.token=d.token}else{if(e!==false){xui.ComFactory.newCom("PhoneGapBuild.SignIn",function(){this._callback=g;this.show()})}return}}process.env.NODE_TLS_REJECT_UNAUTHORIZED="0";a.auth(c,function(l,j){if(l){if(e!==false){xui.ComFactory.newCom("PhoneGapBuild.SignIn",function(){this._callback=g;this.show()})}}else{d.token=j.token;d.api=j}g(l,j)})},getApps:function(e,d){var c=PhoneGapBuild,a=require("phonegap-build-api"),b={};d("Getting existing applications in phonegap build ...");c.api.get(c.url,function(g,f){if(g){xui.alert(g.message)}else{d("Got "+f.apps.length+" existing applications.");e(f)}})},getAppBuildStatus:function(b,c,l,g,d,a){var e=PhoneGapBuild,j=arguments.callee;if(!a){a=e.maxRetryTimes}var f=e.url+"/"+b;l("Getting status of "+f+" ...");e.api.get(f,function(u,s){if(u){l(f+" returns error : "+u.message);xui.tryF(d);return}var r;for(var o=0,m;m=c[o++];){var q=f+"/"+m,n=s.status[m];if(n==="error"){l(q+" raises error : "+s.error[m])}else{if(n==="pending"){l(q+" is pending.");r=true}else{if(n==="complete"){l(q+" is OK.")}else{l(q+" is "+n+". ")}}}}g(s);if(r){if((a++)<=e.maxRetryTimes){xui.setTimeout(function(){j.apply(e,[b,c,l,g,d,a])},5000)}else{l(url+" returns error : retried "+e.maxRetryTimes+" time.");xui.tryF(d)}}else{xui.tryF(d)}})},build:function(b,f,c,n,l,e,m,j){var g=PhoneGapBuild,a=CONF.mapServerPath("_phonegap.zip"),d="EUSUI Application";xui.showCom("RAD.CustomPackage",function(){this.setEvents("onOK",function(s,q,o){var r={files_lib:s,files_appearance:q,files_locale:o};xui.merge(r,f);NWUtil.ensureConfigAndIcon(f.path,function(){var w=NWUtil.zipSimple(r),u=require("fs"),x=b?{form:{file:a}}:{form:{data:{title:d,create_method:"file"},file:a}};w.addLocalFile(f.path+"/.settings/phonegap/config.xml");if(u.existsSync(f.path+"/.settings/phonegap/res/")){w.addLocalFolder(f.path+"/.settings/phonegap/res/","res/")}w.toBuffer(function(A){n("Uploading package ...");u.writeFileSync(a,A);g.api[b?"put":"post"](b?(g.url+"/"+b):g.url,x,function(D,B){if(u.existsSync(a)){u.unlink(a)}if(D){n("Failed to upload: "+D.message);e();if(/limit reached/.test(D.message)){xui.alert(xui.adjustRes("$(RAD.phonegap.Private app limit reached, maybe you need to delete an app first!<br/> Or upload current project to an existing App)"))}return}xui.tryF(m);n("Uploaded!");n("Building...");var C={form:{data:{platforms:g.platforms}}};g.api.post(g.url+"/"+B.id+"/build",C,function(F,E){if(F){n("Build error: "+F.message);e();return}n("Download checking ...");g.getAppBuildStatus(B.id,c,n,l,e,1)})})})},n)});this.setEvents("onCancel",j)})}},Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"ctl_dialog").setLeft("0em").setTop("0em").setWidth("56.583333333333336em").setHeight("49.916666666666664em").setResizer(false).setCaption("$(RAD.phonegap.XUI PhoneGap Builder)").setImageClass("spafont spa-icon-phonegap").setMinBtn(false));c.ctl_dialog.append(xui.create("xui.UI.Block").setHost(c,"ctl_block10").setDock("fill").setBorderType("inset"));c.ctl_block10.append(xui.create("xui.UI.Block").setHost(c,"ctl_block11").setDock("top").setHeight("4.083333333333333em"));c.ctl_block11.append(xui.create("xui.UI.Button").setHost(c,"ctl_btn_new").setDock("width").setDockMargin({left:10,top:0,right:10,bottom:0}).setTop("0.375em").setHeight("3.25em").setImageClass("spafont spa-icon-setup").setCaption("$(RAD.phonegap.Add the current project to build$.phonegap  as a new private application, and build it)").onClick("_ctl_btn_new_onclick").setCustomStyle({ICON:{"font-size":"2em"}}));c.ctl_block10.append(xui.create("xui.UI.Layout").setHost(c,"ctl_layout4").setItems([{id:"before",pos:"before",size:180,min:10,locked:false,folded:false,hidden:false,cmd:false},{id:"main",size:80,min:10},{id:"after",pos:"after",size:180,min:10,locked:false,folded:false,hidden:false,cmd:true}]).setCustomStyle({PANEL:{}}).setCustomClass({PANEL:"loading"}));c.ctl_layout4.append(xui.create("xui.UI.Panel").setHost(c,"ctl_log").setZIndex(1).setOverflow("overflow-x:hidden;overflow-y:auto;").setCaption("$RAD.phonegap.Log").setCustomStyle({PANEL:{"background-color":"#FFFFFF"}}),"after");c.ctl_log.append(xui.create("xui.UI.Div").setHost(c,"ctl_div71").setDomId("phonegap_log_div").setDock("fill"));c.ctl_layout4.append(xui.create("xui.UI.Panel").setHost(c,"ctl_list").setZIndex(1).setCaption("$(RAD.phonegap.Existing Applications in Build$.PhoneGap)").setRefreshBtn(true).onRefresh("_refreshList").setCustomStyle({PANEL:{}}).setCustomClass({PANEL:"loading"}),"before");c.ctl_list.append(xui.create("xui.UI.TreeGrid").setHost(c,"ctl_tglist").setSelMode("single").setRowNumbered(true).setRowHandlerWidth("1.25em").setHeader([{id:"appid",caption:"$(RAD.phonegap.App ID)",width:"5em",type:"input"},{id:"name",caption:"$(RAD.phonegap.Title)",width:"10em",type:"input"},{id:"package",caption:"$(RAD.phonegap.Package)",width:"6.666666666666667em",type:"input"},{id:"version",caption:"$(RAD.phonegap.Version)",width:"6.666666666666667em",type:"input"},{id:"phonegap_version",caption:"$(RAD.phonegap.Phonegap Version)",width:"6.666666666666667em",type:"input"},{id:"description",caption:"$(RAD.phonegap.Description)",width:"6.666666666666667em",type:"input",flexSize:true}]).setTreeMode("none").afterUIValueSet("_ctl_tglist_afteruivalueset"));c.ctl_list.append(xui.create("xui.UI.Block").setHost(c,"ctl_block312").setDock("bottom").setHeight("3.5em").setBorderType("none").setOverflow("hidden"));c.ctl_block312.append(xui.create("xui.UI.Button").setHost(c,"ctl_update").setDisabled(true).setTop("0.3125em").setWidth("28em").setHeight("2.9166666666666665em").setRight("0.625em").setZIndex(2).setImageClass("xui-icon-upload").setCaption("$(RAD.phonegap.Upload current project to the selected existing App)").onClick("_ctl_btn_update_onclick").setCustomStyle({ICON:{"font-size":"2em"}}));c.ctl_block312.append(xui.create("xui.UI.Button").setHost(c,"ctl_delete").setDisabled(true).setLeft("0.625em").setTop("0.3125em").setWidth("19.25em").setHeight("2.9166666666666665em").setImageClass("xui-uicmd-delete").setCaption("$(RAD.phonegap.Delete the selected existing App)").onClick("_ctl_btn_config_onclick").setCustomStyle({ICON:{"font-size":"2em"}}));c.ctl_layout4.append(xui.create("xui.UI.Panel").setHost(c,"ctl_builds").setZIndex(1).setCaption("$(RAD.phonegap.Build results)").setRefreshBtn(true).onRefresh("_onrefreshBuild"),"main");c.ctl_builds.append(xui.create("xui.UI.Block").setHost(c,"ctl_block313").setDock("fill").setBorderType("none"));c.ctl_block313.append(xui.create("xui.UI.Block").setHost(c,"ctl_result").setDock("fill").setBorderType("none").setBackground("#fff").setCustomStyle({PANEL:"text-align:center;padding-top:16px;"}));c.ctl_block313.append(xui.create("xui.UI.Block").setHost(c,"ctl_block1233").setDock("bottom").setHeight("2em"));c.ctl_block1233.append(xui.create("xui.UI.Link").setHost(c,"ctl_link181").setTop("0.3333333333333333em").setRight("0.625em").setCaption("$(RAD.phonegap.Please go to build$.phonegap website to do advanced build)").onClick("_ctl_link181_onclick"));return b},customAppend:function(c,a,e,d){var b=this;PhoneGapBuild.tryToSignIn(function(g,f){if(!g){b.ctl_dialog.showModal();b._refreshList()}});return true},onMessage:function(c){var b=this,a=xui("phonegap_log_div");a.prepend("<div>"+xui.Date.format(new Date,"yyyy-mm-dd hh:nn:ss")+" : "+c+"</div>")},_refreshList:function(){var a=this;a.ctl_dialog.busy(xui.adjustRes("$(RAD.phonegap.Loading)..."));PhoneGapBuild.getApps(function(c){a.ctl_dialog.free();var b=[];xui.arr.each(c.apps,function(d){b.push({id:d.id,title:d.title,cells:[d.id,d.title,d["package"],d.version,d.phonegap_version,d.description]})});a.ctl_tglist.setRows(b);a.ctl_result.setHtml("",true)},a.onMessage)},_ctl_tglist_afteruivalueset:function(c,a,d){var b=this;b._refreshBuild(d)},_onrefreshBuild:function(){var a=this;if(!a._selectedApp){xui.alert(xui.adjustRes("$(RAD.phonegap.Select An Application please)!"));return}a._refreshBuild(a._selectedApp)},_refreshBuild:function(a){var b=this;b.ctl_dialog.busy(xui.adjustRes("$(RAD.phonegap.Working)..."));PhoneGapBuild.getAppBuildStatus(a,PhoneGapBuild.platforms,b.onMessage,function(e){b.ctl_dialog.free();b._selectedApp=a;b.ctl_delete.setDisabled(false);b.ctl_update.setDisabled(false);b.ctl_result.setHtml("",true);var c=xui.getPath("img/","pg_platform-icons.png"),f={ios:"0 -32px",android:"-32px -32px",winphone:"-64px -32px",blackberry:"-96px -32px",webos:"-128px -32px",symbian:"-160px -32px"},d={ios:"app.ipa",android:"app.apk",winphone:"app.xap",blackberry:"app",webos:"app",symbian:"app"};xui.each(e.download,function(l,j){var g=new xui.UI.Button({image:c,imagePos:f[j],caption:"$(RAD.phonegap.Download) "+j.replace(/./,function(m){return m.toUpperCase()})+" $(RAD.phonegap.App) ",position:"relative"},{onClick:function(){var m=d[j];NWUtil.popSaveAsDlg(m,"*."+m.split(".")[1],function(q){var n=require("fs");var o=n.createWriteStream(q);o.on("finish",function(){b.ctl_dialog.free();xui.alert(xui.adjustRes("$(RAD.phonegap.File has been successfully downloaded to) ")+'"'+q+'".')});o.on("error",function(r){xui.alert(r.message);b.ctl_dialog.free()});b.ctl_dialog.busy(xui.adjustRes("$RAD.phonegap.Downloading ... "));PhoneGapBuild.api.get(PhoneGapBuild.url+"/"+e.id+"/"+j).pipe(o)})}});g.setCustomStyle({ICON:{"vertical-align":"middle",width:"32px",height:"32px"}});b.ctl_result.append(g);b.ctl_result.append("<span>&nbsp;&nbsp;&nbsp;&nbsp;</span>")})})},_ctl_btn_rebuildall_onclick:function(b,d,f,c){var a=this;if(!a._selectedApp){xui.alert(xui.adjustRes("$(RAD.phonegap.Select An Application please)!"));return}},_ctl_btn_update_onclick:function(b,d,f,c){var a=this,g;if(!a._selectedApp){xui.alert(("$(RAD.phonegap.Select An Application please)!"));return}a.ctl_dialog.busy(xui.adjustRes("$(RAD.phonegap.Working)..."));PhoneGapBuild.build(a._selectedApp,a.properties,PhoneGapBuild.platforms,a.onMessage,function(e){a.ctl_result.setHtml("",true);g=e},function(){if(g){var e={title:g.title,cells:[g.id,g.title,g["package"],g.version,g.phonegap_version,g.description]};a.ctl_tglist.updateRow(a._selectedApp,e);a.ctl_tglist.setUIValue(g.id,true);a.ctl_dialog.free()}},function(){a.ctl_dialog.busy(xui.adjustRes("$(RAD.phonegap.Working)..."))},function(){a.ctl_dialog.free()})},_ctl_btn_config_onclick:function(b,d,f,c){var a=this;xui.confirm(xui.getRes("RAD.delfile.confirmdel"),xui.getRes("RAD.delfile.confirmdel3"),function(){a.ctl_dialog.busy(xui.adjustRes("$(RAD.phonegap.Working)..."));PhoneGapBuild.api.del(PhoneGapBuild.url+"/"+a._selectedApp,function(j,g){if(j){a.onMessage(j.msg)}else{xui.alert(xui.adjustRes("$RAD.phonegap.Deleted"));a.ctl_tglist.removeRows([a._selectedApp]);delete a._selectedApp;a.ctl_delete.setDisabled(true);a.ctl_update.setDisabled(true);a.ctl_result.removeChildren(null,true)}a.ctl_dialog.free()})})},_ctl_btn_new_onclick:function(b,d,f,c){var a=this,g;a.ctl_dialog.busy(xui.adjustRes("$(RAD.phonegap.Working)..."));PhoneGapBuild.build(null,a.properties,PhoneGapBuild.platforms,a.onMessage,function(e){a.ctl_result.setHtml("",true);g=e},function(){if(g){var e={id:g.id,title:g.title,cells:[g.id,g.title,g["package"],g.version,g.phonegap_version,g.description]};a.ctl_tglist.insertRows([e]);a.ctl_tglist.setUIValue(g.id)}a.ctl_dialog.free()},function(){a.ctl_dialog.busy(xui.adjustRes("$(RAD.phonegap.Working)..."))},function(){a.ctl_dialog.free()})},_ctl_link181_onclick:function(a,b){nw.Shell.openExternal("http://build.phonegap.com/")}}});xui.Class("PhoneGapBuild.SignIn","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"ctl_dialog").setLeft("10.625em").setTop("3.125em").setWidth("27.583333333333332em").setHeight("18.5em").setResizer(false).setCaption("$(RAD.phonegap.Build$.PhoneGap Sign In)").setMinBtn(false).setMaxBtn(false).setOverflow("hidden"));c.ctl_dialog.append(xui.create("xui.UI.ComboInput").setHost(c,"ctl_usr").setDirtyMark(false).setLeft("0.8333333333333334em").setTop("0.75em").setWidth("24.333333333333332em").setHeight("2.1666666666666665em").setLabelSize(120).setLabelCaption("$(RAD.phonegap.Email/AdobeId)").setType("input").setValue("phonegap_freeplan@ESDUI.com"));c.ctl_dialog.append(xui.create("xui.UI.ComboInput").setHost(c,"ctl_pwd").setDirtyMark(false).setLeft("0.8333333333333334em").setTop("3.4166666666666665em").setWidth("24.333333333333332em").setHeight("2.1666666666666665em").setLabelSize(120).setLabelCaption("$RAD.phonegap.password").setType("password").setValue("123456abcd"));c.ctl_dialog.append(xui.create("xui.UI.Button").setHost(c,"ctl_signin").setLeft("10.666666666666666em").setTop("6.583333333333333em").setWidth("14.333333333333334em").setHeight("3em").setImageClass("spafont spa-icon-login").setCaption("$(RAD.phonegap.Sign In)").onClick("_ctl_signin_onclick").setCustomStyle({ICON:{"font-size":"2em"}}));c.ctl_dialog.append(xui.create("xui.UI.Block").setHost(c,"ctl_block1").setDock("width").setDockMargin({left:6,top:0,right:6,bottom:0}).setTop("10.75em").setHeight("3em").setHtml('<div style="padding:4px"><font color="FF0000"><b>Strongly recommended to use your own account.</b><br>You can <font color="FF0000">create account at http://build.phonegap.com.</font></font></div>').setBorderType("groove").setOverflow("hidden"));c.ctl_dialog.append(xui.create("xui.UI.Link").setHost(c,"ctl_link177").setLeft("7.916666666666667em").setTop("14.083333333333334em").setCaption("$(RAD.phonegap.You can use build$.phonegap website too)").onClick("_ctl_link1_onclick"));return b},customAppend:function(c,a,e,d){var b=this;this.ctl_dialog.showModal();return true},_ctl_signin_onclick:function(c,g,j,d){var b=this,a=b.ctl_dialog,l=b.ctl_usr.getValue(),f=b.ctl_pwd.getValue();a.busy(xui.adjustRes("$(RAD.phonegap.Try to sign in)..."));PhoneGapBuild.tryToSignIn(function(n,m){a.free("");if(!n){xui.tryF(b._callback);b.destroy()}else{xui.alert(n.message)}},l,f,false)},showManul:function(){xui.ComFactory.getCom("MobileInstruction",function(){this.dlg.showModal()})},_ctl_link1_onclick:function(a,b){this.showManul()}}});xui.Class("RAD.MobileInstruction","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dlg").setLeft("8.125em").setTop("5em").setWidth("46em").setHeight("29.916666666666668em").setResizer(false).setCaption("Mobile Deploy Instruction").setMinBtn(false).setMaxBtn(false).setOverflow("hidden").beforeClose("_dlg_beforeclose"));c.dlg.append(xui.create("xui.UI.Div").setHost(c,"ctl_div11").setLeft("0.8125em").setTop("0.3125em").setWidth("43.916666666666664em").setHeight("22.75em").onRender("_ondivr").setCustomStyle({KEY:"background-color:#FFFFF0;border:solid 1px #ababab;overflow:auto;"}));c.dlg.append(xui.create("xui.UI.Button").setHost(c,"ctl_sbutton5").setLeft("19.916666666666668em").setTop("23.833333333333332em").setWidth("8.125em").setHeight("2.5em").setCaption("O K").onClick("_ctl_sbutton5_onclick"));return b},_ctl_sbutton5_onclick:function(a,c,d,b){this.dlg.close()},_dlg_beforeclose:function(a){this.dlg.hide();return false},_ondivr:function(a){a.boxing().setHtml('<font face="Arial"><br>&nbsp; <font size="2">Instruction for Mobile Application Deploy:<br></font></font><ol><li><font face="Arial" size="2"><b>Create </b>"Web deploy package"(zip file) from the EUSUI RAD Studio;<br><img src="'+xui.getPath("img/","BuildWeb.png")+'"></font></li><li><font face="Arial" size="2"><b>Upload </b>the zip file to <a target="_blank" href="https://build.phonegap.com/">PhoneGap</a>;</font></li><li><font face="Arial" size="2"><b>Build </b>it in PhoneGap;<br><img src="'+xui.getPath("img/","PhoneGap.png")+'"></font></li><li><font face="Arial" size="2"><b>Download </b>output files from PhoneGap\'s "Public Page"(like <a target="_blank" href="https://build.phonegap.com/apps/359497/share">this</a>)</font></li></ol>')}}});xui.Class("RAD.SwitchWorkspace","xui.Module",{Instance:{customAppend:function(){var a=this,b=a.dialog;b.show(a.parent,true)},iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"dialog").setLeft("3.125em").setTop("1.875em").setWidth("32.666666666666664em").setHeight("18.833333333333332em").setCaption("$(RAD.ws.Move/Switch Workspace)").setMinBtn(false).setMaxBtn(false).setOverflow("visible").onHotKeydown("_dialog_onhotkey").beforeClose("_dialog_beforeclose"));c.dialog.append(xui.create("xui.UI.Div").setHost(c,"ctl_pane68").setDock("bottom").setHeight("3.5em").setOverflow("visible"));c.ctl_pane68.append(xui.create("xui.UI.Button").setHost(c,"btnCancel").setTop("0.75em").setWidth("7em").setRight("10em").setZIndex("1").setImageClass("spafont spa-icon-cancel").setCaption("$RAD.cancel").onClick("_btncancel_onclick"));c.ctl_pane68.append(xui.create("xui.UI.Button").setHost(c,"btnOK").setTop("0.75em").setWidth("8em").setRight("1em").setZIndex("1").setImageClass("spafont spa-icon-ok").setCaption("$RAD.ok").onClick("_btnok_onclick"));c.dialog.append(xui.create("xui.UI.Group").setHost(c,"ctl_group1").setLeft("0.625em").setTop("3.3333333333333335em").setWidth("31em").setHeight("8.333333333333334em").setOverflow("hidden").setCaption("$(RAD.ws.Select target folder)").setToggleBtn(false));c.ctl_group1.append(xui.create("xui.UI.ComboInput").setHost(c,"ctl_comboinput14").setDirtyMark(false).setLeft("9.083333333333334em").setTop("4.75em").setWidth("20.833333333333332em").setType("popbox").setCachePopWnd(false).setInputReadonly(true).beforeComboPop("_beforepopshow"));c.ctl_group1.append(xui.create("xui.UI.RadioBox").setHost(c,"ctl_radiobox4").setDirtyMark(false).setItems([{id:"move",caption:"$RAD.ws.Move"},{id:"switch",caption:"$RAD.ws.Switch"}]).setLeft("0.375em").setTop("0.0625em").setWidth("28.666666666666668em").setHeight("2.5em").afterUIValueSet("_ctl_radiobox4_afteruivalueset"));c.ctl_group1.append(xui.create("xui.UI.Label").setHost(c,"ctl_tips").setLeft("1.25em").setTop("2.5em").setWidth("28.666666666666668em").setHeight("2.1875em").setCaption("").setHAlign("left").setCustomStyle({KEY:{color:"#544444","text-decoration":"underline"}}));c.ctl_group1.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel8").setLeft("0.1875em").setTop("5.083333333333333em").setWidth("8.083333333333334em").setHeight("1em").setCaption("$(RAD.ws.Target Folder)"));c.dialog.append(xui.create("xui.UI.Label").setHost(c,"ctl_slabel1").setLeft("1.6666666666666667em").setTop("0.5em").setWidth("28.166666666666668em").setHeight("2.8333333333333335em").setCaption("$(RAD.ws.ESDUI stores your projects in a  folder, called XUIWorkspace$. Choose a folder to move/switch your XUIWorkspace to).").setHAlign("left"));return b},init:function(){this.ctl_radiobox4.setUIValue("switch",true);this.ctl_comboinput14.setUIValue(CONF.wsPath,true)},_beforepopshow:function(a,c){var b=a.boxing();NWUtil.popSaveAsDlg("","",function(d){d=d.replace(/\\/g,"/");b.setValue(d,true)},true);return false},_btncancel_onclick:function(){this.dialog.close()},_btnok_onclick:function(){var c=this,d=c.ctl_comboinput14.getUIValue(),a=c.ctl_radiobox4.getUIValue();if(d==CONF.wsPath){return}NWUtil.moveWorksapceTo(d,a,function(){c.dialog.close();xui.alert(xui.adjustRes("$(RAD.ws.Your XUIWorkSpace has been $0 to '$1' successfully-"+(a?"moved":"switched")+"-"+d+")!"))},function(b){xui.alert(xui.get(b,["error","errdes"])||b||"no response!")})},_dialog_beforeclose:function(a){this.dialog.hide();return false},_dialog_onhotkey:function(b,a){if(a.key=="esc"){b.boxing().close()}},_ctl_radiobox4_afteruivalueset:function(b,a,c){if(c=="move"){this.ctl_tips.setCaption("$(RAD.ws.Switch XUI Workspace to following target folder, move all project files into it, and remove the old XUI Workspace folder).")}else{this.ctl_tips.setCaption("$(RAD.ws.Switch XUI Workspace to following target folder only, don't move any project files, don't remove the old XUI Workspace)")}}}});xui.Class("RAD.SelRenderMode","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"mainDlg").setLeft("13.125em").setTop("0.625em").setHeight("20.166666666666668em").setResizer(false).setCaption("$RAD.pageEditor.modeDlgCap").setMinBtn(false).setMaxBtn(false).setOverflow("hidden"));c.mainDlg.append(xui.create("xui.UI.List").setHost(c,"modeList").setDirtyMark(false).setLeft("0.1875em").setTop("0.3125em").setWidth("23.916666666666668em").setHeight("13.75em").setBorderType("inset").setValue("a").onDblclick("_modelist_ondblclick").setCustomStyle({EXTRA:"float:right;display:inline;"}));c.mainDlg.append(xui.create("xui.UI.Button").setHost(c,"ctl_sbutton5").setLeft("13.25em").setTop("14.5em").setWidth("5.166666666666667em").setHeight("2.1666666666666665em").setCaption("$RAD.ok").onClick("_ctl_sbutton5_onclick"));c.mainDlg.append(xui.create("xui.UI.Button").setHost(c,"ctl_sbutton26").setLeft("5.75em").setTop("14.5em").setWidth("5.166666666666667em").setHeight("2.1666666666666665em").setCaption("$RAD.cancel").onClick("_ctl_sbutton26_onclick"));return b},events:{onReady:"_com_onready"},_com_onready:function(b,c){var a=[];xui.arr.each(CodeMirror.modeInfo,function(e,d){a.push({id:e.mime+":"+e.mode,mode:e.mode,mime:e.mime,name:e.name,caption:e.name,ext:"<i style='color:#0000ff;'>"+e.mime+"&nbsp;&nbsp;&nbsp;</i>"})});this.modeList.setItems(a).setValue(null,true)},_ctl_sbutton26_onclick:function(b,d,f,c){var a=this;a.fireEvent("onSel",[null]);a.mainDlg.close()},_ctl_sbutton5_onclick:function(c,g,j,f){var b=this,a=b.modeList.getUIValue(),d=b.modeList.getItemByItemId(a);b.fireEvent("onSel",[d]);b.mainDlg.close()},_modelist_ondblclick:function(a,b,c,d){this._ctl_sbutton5_onclick()}}});xui.Class("RAD.ThemeRoller","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"xui_ui_dialog41").setLeft("0.8333333333333334em").setTop("0.8333333333333334em").setWidth("19.166666666666668em").setHeight("45em").setCaption("EUSUI Theme Roller").setMinBtn(false).setMaxBtn(false).setRestoreBtn(false));c.xui_ui_dialog41.append(xui.create("xui.UI.Block").setHost(c,"_themeBlcok").setDock("top").setLeft("7.5em").setHeight("2.9166666666666665em").setBorderType("none").setOverflow("hidden"));c._themeBlcok.append(xui.create("xui.UI.ComboInput").setHost(c,"_theme").setDirtyMark(false).setLeft("0.25em").setTop("0.5em").setWidth("17.166666666666668em").setHeight("2.08333em").setLabelSize("8em").setLabelGap("0.3333333333333333em").setLabelCaption("Base Theme").setType("listbox").setParentID("xui_config_block").setItems([{id:"default",caption:"default"},{id:"army",caption:"army"},{id:"classic",caption:"classic"},{id:"darkblue",caption:"darkblue"},{id:"electricity",caption:"electricity"},{id:"lightblue",caption:"lightblue"},{id:"moonify",caption:"moonify"},{id:"orange",caption:"orange"},{id:"pink",caption:"pink"},{id:"red",caption:"red"},{id:"vista",caption:"vista"},{id:"webflat",caption:"webflat"}]).setValue("default").afterUIValueSet("_theme_afteruivalueset"));c.xui_ui_dialog41.append(xui.create("xui.UI.Block").setHost(c,"xui_ui_panel3").setDock("fill").setBorderType("inset"));c.xui_ui_panel3.append(xui.create("xui.UI.Div").setHost(c,"_paneBottom").setDock("fill").setOverflow("overflow-y:auto"));c._paneBottom.append(xui.create("xui.UI.FoldingTabs").setHost(c,"_tabs").setShowDirtyMark(false).setSelMode("multi").setOverflow("hidden").beforePagePop("__tabs_beforepagepop").setCustomStyle({PANEL:"line-height:2.2em"}));return b},customAppend:function(b,a,d,c){return false},events:{onRender:"_page_onrender"},_page_onrender:function(a,b){a._prepare(a)},setTargetContainer:function(a,b){this._themeRoller=a;if(b){if(this._theme.getItemByItemId(b)){this._theme.setUIValue(b)}}},fireChangeEvent:function(a){this.fireEvent("onChange",[a,this._dirty1,this._theme.getUIValue()])},_prepare:function(c){var d=this,e=".xui-uicon-main, .xui-uicon-maini, .xui-uibar-tdl, .xui-uibar-tdm, .xui-uibar-tdr, .xui-uibar-tdlt, .xui-uibar-tdmt, .xui-uibar-tdrt{background-image:none !important;}.xui-tabs-item{background-image:none !important;}.xui-hcell, .xui-treegrid-fhcell, .xui-treegrid-hcell, .xui-treegrid-hscell, .xui-treegrid-header1, .xui-treegrid-header2{background-image:none !important;}.xui-uiborder-box{ border-width:1px;}",b=[{id:"Font Setting",setting:[{id:"Font Family",map:[{clsname:".xui-ui-ctrl",stylename:"font-family"}]},{id:"Font Weight",map:[{clsname:".xui-ui-ctrl",stylename:"font-weight"}]},{id:"Font Size",map:[{clsname:".xui-ui-ctrl",stylename:"font-size"}]},{id:"Font Color",status:["default","readonly","disabled","highlight"],map:[{clsname:".xui-ui-ctrl",stylename:"color"}]},{id:"FontIcon Color",status:["default","hover","active","checked"],map:[{clsname:".xuicon",stylename:"color"}]}],template:".xui-ui-ctrl, .xui-ui-reset{    color:[Font Color];    font-family:[Font Family];    font-size:[Font Size];    font-weight:[Font Weight];}.xui-title-node{    font-size:1.1667em;}.xuifont, .xuicon{    font-size:1.3333333333333333em;    color:[FontIcon Color];}.xuifont-hover, .xuicon-hover{    color:[FontIcon Color>hover];}.xuifont-active, .xuicon-active{    color:[FontIcon Color>active];}.xuifont-checked, .xuicon-checked{    color:[FontIcon Color>checked];}.xui-node-readonly, input[readonly], textarea[readonly], input:read-only, textarea:read-only,.xui-ui-readonly, .xui-ui-readonly .xui-node,.xui-ui-itemreadonly, .xui-ui-itemreadonly .xui-node{    color:  [Font Color>readonly] !important;}.xui-node-disabled,button:disabled, a:disabled, input:disabled, textarea:disabled, .xui-ui-disabled, .xui-ui-disabled .xui-node,.xui-ui-itemdisabled, .xui-ui-itemdisabled .xui-node,.xui-uicell-disabled, .xui-uicell-disabled .xui-node{   color: [Font Color>disabled] !important;}.xui-ui-ctrl-highlight, .xui-node-highlight, .xui-uibar-checked, .xui-uibar-expand, .xui-uimenu-hover, .xui-uimenu-active{    color: [Font Color>highlight];}.xui-uitembg-checked{    color: [Font Color>highlight];}.xui-uicell-checked,.xui-treegrid-cell-checked, .xui-treegrid-cells1-checked, .xui-treegrid-cells2-checked{    color: [Font Color>highlight];}"},{id:"Background Setting",setting:[{id:"Base Background",map:[{clsname:".xui-uibase",stylename:"background-color"}]},{id:"Bar Background",status:["default","hover","active","focus"],map:[{clsname:".xui-uibar",stylename:"background-color"}]}],template:".xui-uibase{    background-color:[Base Background];}.xui-uicontainer{    background-color:[Base Background];}.xui-uibar{    background-color:[Bar Background];}.xui-uibar-hover{    background-color:[Bar Background>hover];}.xui-uibar-active, .xui-uibar-checked, .xui-uibar-expand, .xui-uimenu-hover, .xui-uimenu-active{    background-color:[Bar Background>active];}.xui-uibar-focus, .xui-uibar-top-focus .xui-uibar-tdl, .xui-uibar-top-focus .xui-uibar-tdm, .xui-uibar-top-focus .xui-uibar-tdr{  background-color:[Bar Background>focus];}"},{id:"Border Setting",setting:[{id:"Border Style",map:[{clsname:".xui-uiborder-flat",stylename:"border-left-style"}]},{id:"Border Width",map:[{clsname:".xui-uiborder-flat",stylename:"border-left-width"}]},{id:"Border Color",status:["inset","outset","light","dark"],map:[{clsname:".xui-uiborder-flat",stylename:"border-color"},{clsname:".xui-uiborder-l",stylename:"border-left-color"},{clsname:".xui-uiborder-light",stylename:"border-color"},{clsname:".xui-uiborder-dark",stylename:"border-color"}]}],template:".xui-uiborder-box{    border-width: [Border Width];}.xui-uiborder-l{    border-left-style: [Border Style];    border-left-width: [Border Width];    border-left-color: [Border Color>outset];}.xui-uiborder-t{    border-top-style: [Border Style];    border-top-width: [Border Width];    border-top-color: [Border Color>outset];}.xui-uiborder-r{    border-right-style: [Border Style];    border-right-width: [Border Width];    border-right-color: [Border Color];}.xui-uiborder-b, .xui-uitem-split{    border-bottom-style: [Border Style];    border-bottom-width: [Border Width];    border-bottom-color: [Border Color];}.xui-uiborder-flat{    border-style: [Border Style];    border-width: [Border Width];    border-color: [Border Color];}.xui-uiborder-outset{    border-style: [Border Style];    border-width: [Border Width];    border-color: [Border Color>outset] [Border Color] [Border Color] [Border Color>outset];}.xui-uiborder-inset, .xui-uiborder-hidden-active, .xui-uiborder-hidden-checked{    border-style: [Border Style];    border-width: [Border Width];    border-color: [Border Color] [Border Color>outset] [Border Color>outset] [Border Color];}.xui-uiborder-nob{    border-bottom-width:0;    border-bottom-style:none;}.xui-uiborder-hidden-active, .xui-uiborder-hidden-checked{    background-color:[Border Color>light];} .xui-uiborder-dark, .xui-uiborder-flat-hover, .xui-tabs-item{    border-color:[Border Color]; } .xui-uiborder-light, .xui-uiborder-hidden-hover{    border-color:[Border Color>light];}"},{id:"Gradients Bar",setting:[{id:"Gradients Bar",map:[{clsname:".xui-uigradient",stylename:"Gradients Bar"}]}],template:".xui-uigradient{[normalStatus]}.xui-uigradient-hover, .xui-uigradient:hover{[hoverStatus]}.xui-uigradient-active, .xui-uigradient-checked,  .xui-uigradient-expand, .xui-uigradient:active, .xui-uigradient-active:hover, .xui-uigradient-checked:hover, .xui-uigradient-expand:hover{[activeStatus]}"},{id:"List Setting",setting:[{id:"Item Background",status:["default","hover","active","checked"],map:[{clsname:".xui-uitembg",stylename:"background-color"}]},{id:"Item Border Color",status:["default","hover","active","checked"],map:[{clsname:".xui-uitembg",stylename:"border-left-color"}]}],template:".xui-uitembg{    background-image:none;     background-color: [Item Background];    border-color: [Item Border Color];}.xui-uitembg-hover{    background-color: [Item Background>hover];    border-color: [Item Border Color>hover];}.xui-uitembg-active{    background-color: [Item Background>active];    border-color: [Item Border Color>active];}.xui-uitembg-checked{    background-color: [Item Background>checked];    border-color: [Item Border Color>checked];}"},{id:"Grid Setting",setting:[{id:"Row Background",status:["default","alt","hover","active","checked","hot"],map:[{clsname:".xui-treegrid-cells1",stylename:"background-color"}]},{id:"Cell Hover Background",map:[{clsname:".xui-uicell-hover",stylename:"background-color"}]}],template:".xui-uicell,.xui-treegrid-cells1, .xui-treegrid-cells2{        background-color: [Row Background];}.xui-uicell-alt,.xui-treegrid-cells1-alt, .xui-treegrid-cells2-alt{        background-color: [Row Background>alt];}.xui-treegrid-cells1-hover, .xui-treegrid-cells2-hover{    background-color: [Row Background>hover];}.xui-treegrid-cells1-active, .xui-treegrid-cells2-active, .xui-treegrid-cell-active, .xui-treegrid-cell-active .xui-treegrid-cella{    background-color: [Row Background>active];}.xui-treegrid-cells1-hot, .xui-treegrid-cells2-hot{    background-color: [Row Background>hot];}.xui-uicell-checked, .xui-treegrid-cell-checked, .xui-treegrid-cells1-checked, .xui-treegrid-cells2-checked{    background-color: [Row Background>checked];}.xui-uicell-hover,.xui-treegrid-cell-hover{    background-color:[Cell Hover Background];}"},{id:"Corner Setting",setting:[{id:"Normal Radius",map:[{clsname:".xui-uiborder-radius",stylename:"border-top-left-radius"}]},{id:"Large Radius",map:[{clsname:".xui-uiborder-radius-big",stylename:"border-top-left-radius"}]}],template:".xui-uiborder-radius{     border-radius: [Normal Radius];    -moz-border-radius: [Normal Radius];    -webkit-border-radius: [Normal Radius];    -o-border-radius: [Normal Radius];    -ms-border-radius: [Normal Radius];    -khtml-border-radius: [Normal Radius];}.xui-uiborder-radius-tl{    border-top-left-radius: [Normal Radius];    -moz-border-top-left-radius: [Normal Radius];    -webkit-border-top-left-radius: [Normal Radius];    -o-border-top-left-radius: [Normal Radius];    -ms-border-top-left-radius: [Normal Radius];     -khtml-border-top-left-radius: [Normal Radius];}.xui-uiborder-radius-tr{    border-top-right-radius: [Normal Radius];    -moz-border-top-right-radius: [Normal Radius];    -webkit-border-top-right-radius: [Normal Radius];    -o-border-top-right-radius: [Normal Radius];    -ms-border-top-right-radius: [Normal Radius];    -khtml-border-top-right-radius: [Normal Radius];}.xui-uiborder-radius-bl{    border-bottom-left-radius: [Normal Radius];    -moz-border-bottom-left-radius: [Normal Radius];    -webkit-border-bottom-left-radius: [Normal Radius];    -o-border-bottom-left-radius: [Normal Radius];    -ms-border-bottom-left-radius: [Normal Radius];    -khtml-border-bottom-left-radius: [Normal Radius];}.xui-uiborder-radius-br{    border-bottom-right-radius: [Normal Radius];    -moz-border-bottom-right-radius: [Normal Radius];    -webkit-border-bottom-right-radius: [Normal Radius];    -o-border-bottom-right-radius: [Normal Radius];    -ms-border-bottom-right-radius: [Normal Radius];    -khtml-border-bottom-right-radius: [Normal Radius];}.xui-uiborder-radius-big{    border-radius: [Large Radius];    -moz-border-radius: [Large Radius];    -webkit-border-radius: [Large Radius];    -o-border-radius: [Large Radius];    -ms-border-radius: [Large Radius];    -khtml-border-radius: [Large Radius];}.xui-uiborder-radius-big-tl{    border-top-left-radius: [Large Radius];    -moz-border-top-left-radius: [Large Radius];    -webkit-border-top-left-radius: [Large Radius];    -o-border-top-left-radius: [Large Radius];    -ms-border-top-left-radius: [Large Radius];     -khtml-border-top-left-radius: [Large Radius];}.xui-uiborder-radius-big-tr{    border-top-right-radius: [Large Radius];    -moz-border-top-right-radius: [Large Radius];    -webkit-border-top-right-radius: [Large Radius];    -o-border-top-right-radius: [Large Radius];    -ms-border-top-right-radius: [Large Radius];    -khtml-border-top-right-radius: [Large Radius];}.xui-uiborder-radius-big-bl{    border-bottom-left-radius: [Large Radius];    -moz-border-bottom-left-radius: [Large Radius];    -webkit-border-bottom-left-radius: [Large Radius];    -o-border-bottom-left-radius: [Large Radius];    -ms-border-bottom-left-radius: [Large Radius];    -khtml-border-bottom-left-radius: [Large Radius];}.xui-uiborder-radius-big-br{    border-bottom-right-radius: [Large Radius];    -moz-border-bottom-right-radius: [Large Radius];    -webkit-border-bottom-right-radius: [Large Radius];    -o-border-bottom-right-radius: [Large Radius];    -ms-border-bottom-right-radius: [Large Radius];    -khtml-border-bottom-right-radius: [Large Radius];}"},{id:"Shadow Setting",setting:[{id:"Dialog Shadow",map:[{clsname:".xui-ui-shadow",stylename:"box-shadow"}]},{id:"Input Shadow",map:[{clsname:".xui-ui-shadow-input",stylename:"box-shadow"}]}],template:".xui-ui-shadow{    -moz-box-shadow: [Dialog Shadow];    -webkit-box-shadow: [Dialog Shadow];    box-shadow: [Dialog Shadow];}.xui-ui-shadow-r{    -moz-box-shadow: [Dialog Shadow];    -webkit-box-shadow: [Dialog Shadow];    box-shadow: [Dialog Shadow];}.xui-ui-shadow-b{    -moz-box-shadow: [Dialog Shadow];    -webkit-box-shadow: [Dialog Shadow];    box-shadow: [Dialog Shadow];}.xui-ui-shadow-input{    -moz-box-shadow: [Input Shadow];    -webkit-box-shadow: [Input Shadow];    box-shadow: [Input Shadow];}"},{id:"Focus Outline",setting:[{id:"Outline Style",map:[{clsname:".xui-showfocus:focus",stylename:"outline-style"}]},{id:"Outline Width",map:[{clsname:".xui-showfocus:focus",stylename:"outline-width"}]}],template:".xui-showfocus:focus {    outline-width: [Outline Width];    outline-style: [Outline Style];}"},{id:"Modal Screen for Overlays",setting:[{id:"Overlay Background",map:[{clsname:".xui-cover",stylename:"background-color"}]},{id:"Overlay Opacity",map:[{clsname:".xui-cover",stylename:"opacity"}]}],template:".xui-cover, .xui-cover-modal{    background-color: [Overlay Background];    opacity: [Overlay Opacity];}"},{id:"Custom CSS",popBtn:true}];var a=[],f={};xui.arr.each(b,function(j,g){if(j.setting){a.push("\n\n/*"+j.id+"*/\n"+j.template);f[j.id]=g}});d._prev=e;d._conf_arr=a;d._conf_index_map=f;d._setting={};c._tabs.setItems(b).setUIValue("Font Setting");d._cssscope="";xui.arr.each(d._tabs.getItems(),function(g){if(g.template){d._cssscope+=g.template.replace(/(\/\*[^*]*\*+([^\/][^*]*\*+)*\/)/g,"").replace(/\,([^\s])/g,", $1").replace(/\s+/g," ")}d.__tabs_oninipanelview(d._tabs,g)})},__tabs_oninipanelview:function(d,c){var b=this,e,a;if(c.setting){xui.arr.each(c.setting,function(f){a=f.id;if(f.status){e=new xui.UI.Group({position:"relative",caption:a,width:"15em",height:"auto",overflow:"hidden"});e.setCustomStyle({KEY:"margin:0.25em 0;padding-left:1em;",PANEL:"line-height:2.2em"});xui.arr.each(f.status,function(j,g){e.append(b._createEditor(c,f,j,g,j))});d.append(e,c.id);e.getRoot().setInlineBlock()}else{d.append(b._createEditor(c,f,a,0),c.id)}})}else{if(c.id=="Custom CSS"){b._cstomCSS=new xui.UI.Input({position:"relative",width:"15em",height:"20em",multiLines:true,dirtyMark:false});b._cstomCSS.onChange(function(){b._refreshTheme()});d.append(b._cstomCSS,c.id)}}},_createEditor:function(s,g,x,e,l){var A=this,u=g.map[e||0],w="\\["+g.id+((l&&l!="default"&&l!="inset")?(">"+l):"")+"\\]",b=new xui.UI.ComboInput({position:"relative",dirtyMark:false,labelSize:l?"7em":"8em",width:l?"14em":"15em",labelCaption:x}),j,m=u?null:l;if(!u){u=g.map[0]}j=xui.CSS.$getCSSValue(xui.UI._getThemePrevId(A._themeRoller.get(0))+" "+u.clsname+(m?("-"+m):""),u.stylename);if(!j&&u.pclsname){j=xui.CSS.$getCSSValue(xui.UI._getThemePrevId(A._themeRoller.get(0))+" "+u.pclsname+(m?("-"+m):""),u.stylename)}if(!j){j=xui.CSS.$getCSSValue(u.clsname+(m?("-"+m):""),u.stylename)}if(!j&&u.pclsname){j=xui.CSS.$getCSSValue(u.pclsname+(m?("-"+m):""),u.stylename)}b.setValue(j);xui.set(A._setting,[s.id,w],b.getValue());switch(u.stylename){case"box-shadow":b.setType("popbox").beforeComboPop(function(B,E,C,D){xui.ModuleFactory.getModule("RAD.CustomBoxShadow",function(){this.init(B,B.boxing().getUIValue(),{},2);this.setEvents({onChange:function(G){B.boxing().setUIValue(G)}});this.render();var F=this.mainPane.getRoot();F.popToTop(B.getRoot());F.setBlurTrigger(F.$xid,function(){F.setBlurTrigger(F.$xid);F.hide();B.boxing().setPopWnd(null)});B.boxing().setPopWnd(this)})});break;case"Gradients Bar":var c,n={},f={},o={},r,q,d;d=[];c=".xui-uigradient";r=xui.CSS.$getCSSValue(xui.UI._getThemePrevId(A._themeRoller.get(0))+" "+c+(m?("-"+m):""));q=xui.CSS.$getCSSValue(c+(m?("-"+m):""));Array.prototype.push.apply(d,r);Array.prototype.push.apply(d,q);if(d&&d.length){d=d.reverse();xui.arr.each(d,function(B){xui.arr.each((B.style.cssText||B.style.rules||"").split(/\s*;\s*/),function(D,C){D=D.split(/\s*:\s*/);if(D[0]){if(D[0]=="background"&&D[1]=="none"){n["background-image"]=D[1]}else{n[D[0]]=D[1]}}})})}d=[];c=".xui-uigradient-hover";r=xui.CSS.$getCSSValue(xui.UI._getThemePrevId(A._themeRoller.get(0))+" "+c+(m?("-"+m):""));q=xui.CSS.$getCSSValue(c+(m?("-"+m):""));Array.prototype.push.apply(d,r);Array.prototype.push.apply(d,q);if(d&&d.length){d=d.reverse();xui.arr.each(d,function(B){xui.arr.each((B.style.cssText||B.style.rules||"").split(/\s*;\s*/),function(D,C){D=D.split(/\s*:\s*/);if(D[0]){if(D[0]=="background"&&D[1]=="none"){f["background-image"]=D[1]}else{f[D[0]]=D[1]}}})})}d=[];c=".xui-uigradient-active";r=xui.CSS.$getCSSValue(xui.UI._getThemePrevId(A._themeRoller.get(0))+" "+c+(m?("-"+m):""));q=xui.CSS.$getCSSValue(c+(m?("-"+m):""));Array.prototype.push.apply(d,r);Array.prototype.push.apply(d,q);if(d&&d.length){d=d.reverse();xui.arr.each(d,function(B){xui.arr.each((B.style.cssText||B.style.rules||"").split(/\s*;\s*/),function(D,C){D=D.split(/\s*:\s*/);if(D[0]){if(D[0]=="background"&&D[1]=="none"){o["background-image"]=D[1]}else{o[D[0]]=D[1]}}})})}xui.filter(f,function(C,B){return n[B]!==C});xui.filter(o,function(C,B){return n[B]!==C});xui.each([n,f,o],function(B){xui.each(B,function(H,F){B[F]=H=H.replace(/(?:rgb\((\d+), ?(\d+), ?(\d+)\)([^,]*))+/g,function(J,I,M,L,K){return"#"+xui.UI.ColorPicker.rgb2hex(I,M,L)+K});B[F]=H=H.replace(/(?:rgba\((\d+), ?(\d+), ?(\d+), ?([.\d]+)\)([^,]*))+/g,function(J,I,N,M,L,K){return"#"+xui.UI.ColorPicker.rgb2hex(I,N,M)+":"+L+K});if(F=="background"||F=="background-image"){if(/gradient\([^)]+\)/.test(H)){var E=/-moz-/.test(H),G;if(/\blinear\b/.test(H)){G={stops:[]},H=H.replace(/[^(]+\(([^)]+)\)/,"$1");G.type="liner";var D=H.split(/,\s*/);xui.each(D,function(J,I){switch(J){case"left top":if(D[I+1]=="right bottom"){G.orient="LT"}else{if(D[I+1]=="left bottom"){G.orient="T"}else{if(D[I+1]=="right top"){G.orient="L"}}}break;case"right top":if(D[I+1]=="left top"){G.orient="R"}else{if(D[I+1]=="left bottom"){G.orient="RT"}}break;case"left bottom":if(D[I+1]=="right top"){G.orient="LB"}else{if(D[I+1]=="left top"){G.orient="B"}}break;case"right bottom":if(D[I+1]=="left top"){G.orient="RB"}break;case"45deg":G.orient="LB";break;case"-45deg":G.orient=E?"LT":"RB";case"135deg":G.orient=E?"RB":"LT";break;case"-135deg":G.orient="RT";break;case"to bottom":case"top":G.orient="T";break;case"to right":case"left":G.orient="L";break;case"to left":case"right":G.orient="R";break;case"to top":case"bottom":G.orient="B";break;default:I=J.split(" ");if(/^#[0-f]{6}$/.test(I[0])){G.stops.push({pos:I[1],clr:I[0].split(":")[0],opacity:I[0].split(":")[1]||1})}}})}else{if(/\bradial\b/.test(H)||/\bcircle\b/.test(H)){G={stops:[]};H=H.replace(/[^(]+\(([^)]+)\)/,"$1");G.type="radial";var C=H.split(/,\s*/);xui.each(D,function(J,I){switch(J){case"center center":G.orient="C";break;case"left top":G.orient="LT";break;case"right top":G.orient="RT";break;case"left bottom":G.orient="LB";break;case"right bottom":G.orient="RB";break;case"top":case"center top":G.orient="T";break;case"left":case"left center":G.orient="L";break;case"right":case"right center":G.orient="R";break;case"bottom":case"center bottom":G.orient="B";break;default:I=J.split(" ");if(/^#[0-f]{6}/.test(I[0])){G.stops.push({pos:I[1],clr:I[0].split(":")[0],opacity:I[0].split(":")[1]||1})}}})}}if(G){B.$gradient=G}}}})});delete n.background;delete n["background-image"];delete f.background;delete f["background-image"];delete o.background;delete o["background-image"];var a={normalStatus:n,hoverStatus:f,activeStatus:o};b.setType("button").setCaption("Normal | Hover | Active").setLabelSize(0).onClick(function(B,E,C,D){xui.ModuleFactory.getModule("RAD.CustomDecoration2",function(){this.setProperties({targetProfile:{_noFocusStatus:true,_title:"Gradients Bar Setting",properties:a,boxing:function(){return{setNormalStatus:function(F){a.normalStatus=F;A._updateGradient(a)},setHoverStatus:function(F){a.hoverStatus=F;A._updateGradient(a)},setActiveStatus:function(F){a.activeStatus=F;A._updateGradient(a)},setFocusStatus:function(F){}}}},src:B.getRoot()});this.setEvents({onFinished:function(){var G=xui.clone(B.properties.normalStatus,true),F=xui.clone(B.properties.hoverStatus,true),H=xui.clone(B.properties.activeStatus,true)}});this.show()})});return b;case"font-family":b.setType("listbox").setItems([{caption:"<span style='font-family:arial,helvetica,clean,sans-serif'>Arial</span>",id:"arial,helvetica,clean,sans-serif"},{caption:"<span style='font-family:'arial black',avant garde'>Arial Black</span>",id:"'arial black',avant garde"},{caption:"<span style='font-family:'comic sans ms',cursive'>Comic Sans MS</span>",id:"'comic sans ms',cursive"},{caption:"<span style='font-family:'courier new',courier,monospace'>Courier New</span>",id:"'courier new',courier,monospace"},{caption:"<span style='font-family:georgia,serif'>Georgia</span>",id:"georgia,serif"},{caption:"<span style='font-family:'PT Sans', Tahoma'>PT Sans</span>",id:"'PT Sans', Tahoma"},{caption:"<span style='font-family:impact,chicago'>impact</span>",id:"impact,chicago"},{caption:"<span style='font-family:'lucida sans unicode','lucida grande',sans-serif'>Lucida Sans Unicode</span>",id:"'lucida sans unicode','lucida grande',sans-serif"},{caption:"<span style='font-family:tahoma,geneva,sans-serif'>Tahoma</span>",id:"tahoma,geneva,sans-serif"},{caption:"<span style='font-family:'times new roman',times,serif'>Times New Roman</span>",id:"'times new roman',times,serif"},{caption:"<span style='font-family:'trebuchet ms',helvetica,sans-serif'>Trebuchet MS</span>",id:"'trebuchet ms',helvetica,sans-serif"},{caption:"<span style='font-family:verdana,geneva,sans-serif'>Verdana</span>",id:"verdana,geneva,sans-serif"},{caption:"<span style='font-family:Roboto, Arial'>Roboto</span>",id:"Roboto, Arial"}]);break;case"font-size":b.setType("listbox").setItems([".75rem","1rem","1.25rem","1.5rem","2rem","3rem","4rem"]);break;case"font-weight":b.setType("listbox").setItems(["normal","bolder","bold","lighter","600","700","800","900","1000"]);break;case"border-left-width":case"outline-width":b.setType("listbox").setItems(["0","1px","2px","3px","4px","5px"]);break;case"border-left-style":case"outline-style":b.setType("listbox").setItems(["solid","dashed","dotted","double","groove","hidden","inset","none","outset","ridge"]);break;case"opacity":b.setType("spin").setMin(0).setMax(1).setIncrement(0.1);break;default:if(xui.str.endWith(u.stylename,"color")){b.setType("color")}else{if(xui.str.endWith(u.stylename,"radius")){b.setType("listbox").setItems(["0","1px","2px","3px","4px","5px","6px","7px","8px","9px","10px"])}}}b.onChange(function(C,B,D){A._onchange(s,g,C,D,l)});return b},_updateGradient:function(e){var d=this,b=function(m,f,j){if(m.$gradient&&m.$gradient.stops&&m.$gradient.stops.length){delete m["background-image"];delete m.background}var n=f?["background-image:none"]:[];var l=function(){var g=this.arr=[];Object.defineProperty(this,"backgroundImage",{set:function(o){g.push("background-image: "+o)}})};xui.each(m,function(o,g){switch(g){case"box-shadow":n.push("-moz-box-shadow: "+o);n.push("-webkit-box-shadow: "+o);n.push("box-shadow: "+o);break;case"$gradient":if(o&&o.stops&&o.stops.length){n.push("filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='"+o.stops[0].clr+"', endColorstr='"+(o.stops[1]||o.stops[0]).clr+"')");n.push("-ms-filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='"+o.stops[0].clr+"', endColorstr='"+(o.stops[1]||o.stops[0]).clr+"')");var r=new l(),q={nodeType:1,style:r};xui.Dom.$setGradients(q,o,{gek:1,ver:100,cssTag1:"-moz-"});xui.Dom.$setGradients(q,o,{opr:1,ver:100,cssTag1:"-o-"});xui.Dom.$setGradients(q,o,{isWebKit:1,isChrome:1,isSafari:1,ver:100,cssTag1:"-webkit-"});xui.arr.removeDuplicate(r.arr);if(r.arr.length){xui.arr.insertAny(n,r.arr);if(j){j.length=r.arr.length}}}break;default:n.push(g+": "+o)}});return"    "+n.join(";\n")+";"},c,a={};if((c=e.normalStatus)){xui.set(d._setting,["Gradients Bar","\\[normalStatus\\]"],b(c,true,a))}if((c=e.hoverStatus)){xui.set(d._setting,["Gradients Bar","\\[hoverStatus\\]"],b(c,!a.length))}if((c=e.activeStatus)){xui.set(d._setting,["Gradients Bar","\\[activeStatus\\]"],b(c,!a.length))}d._refreshTheme()},_onchange:function(e,g,d,f,a){var c=this,b="\\["+g.id+((a&&a!="default"&&a!="inset")?(">"+a):"")+"\\]";xui.set(c._setting,[e.id,b],f);c._refreshTheme();if("Font Size"==g.id){xui.CSS.adjustFont()}},_refreshTheme:function(){var a=this;a._dirty1=true;a.fireChangeEvent(a._buildTheme())},_buildTheme:function(){var d=this,a=xui.copy(d._conf_arr),c,b;xui.each(d._setting,function(e,f){c=d._conf_index_map[f];xui.each(e,function(j,g){if(g){a[c]=a[c].replace(new RegExp(g,"g"),j)}})});a=a.join("\n").replace(/([},])\s*(\.)/g,function(f,e,g){return e+"\n"+g}).replace(/([{;])\s*(.)/g,function(f,e,g){return e+"\n"+g}).split("\n");xui.filter(a,function(e){return !(/\:\s*\[/.test(e)||/\]\s*\;/.test(e)||/\:\s*;/.test(e))});b=a.join("");b=b.replace(/[^}]+\{\s*\}/g,"");return(d._prev+b+(d._cstomCSS?"\n\n"+d._cstomCSS.getValue():"")).replace(/(\/\*[^*]*\*+([^\/][^*]*\*+)*\/)/g,"\n\n$1\n").replace(/([},])\s*(\.)/g,function(f,e,g){return e+"\n"+g}).replace(/([{;])\s*(.)/g,function(f,e,g){return e+"\n"+(g=="}"?"":"    ")+g}).replace(/\{\s+;\s*\}/g,"{}")},_theme_afteruivalueset:function(c,a,d){var b=this;b._setting={};b.fireChangeEvent("");delete b._cstomCSS;xui.busy("id","Loading theme ...",true);xui.getFileAsync(xui.getPath("xui.appearance."+d,"/theme.css"),function(g){b._dirty1=false;g=g.replace(/\.setting-uikey\{[^}]+\}/,"");b.fireChangeEvent(b._prev+g);b._tabs.resetPanelView(true,true,true);xui.arr.each(b._tabs.getItems(),function(n){b.__tabs_oninipanelview(b._tabs,n)});g=xui.replace(g,[[/(\/\*[^*]*\*+([^\/][^*]*\*+)*\/)/,""],[/\{[^}]*\}/,"$0"],[/\s+/," "],[/\,([^\s])/,", $1"]]);var f=[],e=[],l={},m=b._cssscope.split(/\s*\{[^}]*\}\s*/);g.replace(/\s*\{[^}]*\}\s*/g,function(n){f.push(n)});e=g.split(/\s*\{[^}]*\}\s*/);xui.arr.each(m,function(q,n){m[n]=xui.str.trim(q)});xui.arr.each(e,function(q,n){e[n]=xui.str.trim(q)});xui.arr.each(f,function(q,n){l[e[n]]=q});l=xui.filter(l,function(o,n){return xui.arr.indexOf(m,n)==-1});var j=[];xui.each(l,function(q,n){j.push(n+q+"\n")});b._cstomCSS.setValue(j.join("\n"));xui.CSS.adjustFont();xui.free("id")})},__tabs_beforepagepop:function(c,d,a,f,j){var b=this,g=xui.prompt("Custom CSS","CSS Code",b._cstomCSS.getUIValue(),function(e){xui.Coder.formatText(b._cstomCSS.setValue(e,true),"css")},0,0,0,0,0,0,0,true);g.setStatus("max");return false}}});xui.Class("RAD.SelFontAwesome","xui.Module",{Instance:{iniComponents:function(){var d=this,c=[],a=function(e){c.push(e.get(0))};a(xui.create("xui.UI.Dialog").setHost(d,"xui_ui_dialog2").setLeft("1.6666666666666667em").setTop("1.6666666666666667em").setWidth("62.5em").setHeight("31.666666666666668em").setCaption("图标选择").setMinBtn(false));d.xui_ui_dialog2.append(xui.create("xui.UI.Block").setHost(d,"xui_ui_panel9").setDock("left").setWidth("13.25em").setZIndex(1).setLeft("undefinedem").setRight("undefinedem").setBottom("undefinedem"));d.xui_ui_panel9.append(xui.create("xui.UI.TreeView").setHost(d,"xui_ui_lst").setDirtyMark(false).setIniFold(false).setSingleOpen(true).setValue("allicon").setDock("fill").setTop("0em").setWidth("18.166666666666666em").onChange("_xui_ui_lst_onchange"));d.xui_ui_panel9.append((new xui.UI.ToolBar()).setHost(d,"servicetool").setHandler(false).onClick("_toolbar_onclick"));var b=[{id:"any",sub:[{id:"refresh",imageClass:"xui-refresh",caption:"刷新",tips:"$RAD.tool2.refresh"},{id:"import",imageClass:"xui-uicmd-add",caption:"导入",tips:"$RAD.esdmenu.localicon"}]}];d.servicetool.setItems(b);d.xui_ui_panel9.append(xui.create("xui.UI.Block").setHost(d,"xui_ui_block4").setDock("top").setLeft("0em").setHeight("2.8333333333333335em").setBorderType("none").setTop("undefinedem").setRight("undefinedem").setBottom("undefinedem"));d.xui_ui_block4.append(xui.create("xui.UI.ComboInput").setHost(d,"xui_ui_comboinput33").setDock("width").setLeft("0em").setTop("0.25em").setHeight("2.3333333333333335em").setDynCheck(true).setType("input").setImageClass("xui-icon-filter").setCommandBtn("delete").onChange("_xui_ui_comboinput33_onchange"));d.xui_ui_dialog2.append(xui.create("xui.UI.Div").setHost(d,"xui_ui_div15").setDock("fill").setLeft("23.333333333333332em").setTop("0.8333333333333334em"));d.xui_ui_div15.append(xui.create("xui.UI.Gallery").setHost(d,"xui_ui_gallery1").setDirtyMark(false).setDock("fill").setIconFontSize("2em").setLeft("22.5em").setColumns(6).setTop("8.333333333333334em").setBorderType("none").setValue("a").onItemSelected("_xui_ui_gallery1_onitemselected"));d.xui_ui_div15.append(xui.create("xui.UI.Block").setHost(d,"xui_ui_block4").setDock("bottom").setLeft("13.333333333333334em").setHeight("2.8333333333333335em").setOverflow("hidden").setTop("undefinedem").setRight("undefinedem").setBottom("undefinedem"));d.xui_ui_block4.append(xui.create("xui.UI.StatusButtons").setHost(d,"xui_ui_statusbuttons2").setDirtyMark(false).setItems([{id:"normal",caption:"normal",imageClass:"fa fa fa-shield"},{id:"fa-rotate-90",caption:"Rotate 90",imageClass:"fa fa fa-shield fa-rotate-90"},{id:"fa-rotate-180",caption:"Rotate 180",imageClass:"fa fa fa-shield fa-rotate-180"},{id:"fa-rotate-270",caption:"Rotate 270",imageClass:"fa fa fa-shield fa-rotate-270"},{id:"fa-flip-horizontal",caption:"Flip Horizontal",imageClass:"fa fa fa-shield fa-flip-horizontal"},{id:"fa-flip-vertical",caption:"Flip Vertical",imageClass:"fa fa fa-shield fa-flip-vertical"}]).setDock("width").setLeft("0.16666666666666666em").setTop("0.08333333333333333em").setWidth("39.916666666666664em").setHeight("3.25em").setBorderType("none").setItemMargin("2px 4px").setConnected(true).setValue("normal").onItemSelected("_xui_ui_statusbuttons2_onitemselected"));return c},events:{onReady:"_page_onready",onRender:"_page_onrender"},_reload:function(){var a=this;a._db={};addTodb=function(b){if(b.glyphs){xui.each(b.glyphs,function(c){c.code=b.font_family+" "+b.css_prefix_text});a._db[b.id]=b.glyphs}xui.each(b.sub,function(c){addTodb(c)})};a.xui_ui_statusbuttons2.setValue("normal");xui.Ajax(CONF.getSelFontServcie,{projectName:SPA.curProjectName},function(b){a.xui_ui_lst.setItems(b.data);xui.each(b.data,function(c){addTodb(c)});a._refreshIcons(b.data[0].id,a._rotateType)},function(b){},null,null,{method:"POST"}).start()},_page_onready:function(a,b){this._reload()},_toolbar_onclick:function(b,c,f,d,g){var a=this;switch(c.id){case"import":xui.showModule("RAD.resource.FontTree",function(){this.setEvents("onOk",function(l,j,e){a._reload();xui.message("添加成功，您需要刷新浏览器以便于更改！")});this.setData({projectName:SPA.curProjectName});this.show();this.initData();this._fireEvent("afterShow")});break;case"refresh":a._reload();break}},_page_onrender:function(a,b){this.xui_ui_lst.fireItemClickEvent("allicon")},_xui_ui_lst_onchange:function(c,b,e,d,a){this._refreshIcons(e,this._rotateType)},_xui_ui_lst_onchange:function(c,b,e,d,a){this._refreshIcons(e,this._rotateType)},_refreshIcons:function(d,c){var b=this;var a=[];xui.arr.each(b._db[d],function(e){var f={comment:e.name,imageClass:e.code+e.font_class,caption:"",code:e.code};a.push(f)});b.xui_ui_gallery1.setItems(a)},_xui_ui_statusbuttons2_onitemselected:function(c,d,f,g,b){var a=this;a.xui_ui_gallery1.getSubNode("ICON",true).removeClass("fa-rotate-90 fa-rotate-180 fa-rotate-270 fa-flip-vertical fa-flip-horizontal");if((a._rotateType=d.id=="normal"?"":" "+d.id)){a.xui_ui_gallery1.getSubNode("ICON",true).addClass(a._rotateType)}},_xui_ui_gallery1_onitemselected:function(d,f,g,j,c){var b=this,a=d.boxing();b.fireEvent("onSel",[f.imageClass]);b.destroy()},_xui_ui_comboinput33_onchange:function(e,b,g,f,a){var d=this,c=e.boxing();xui.resetRun(d.$xid+":_xui_ui_comboinput33_onchange",function(){d.xui_ui_lst.setUIValue(null);d.xui_ui_lst.setDisabled(true);var l=[];if(g){xui.each(d._db,function(m){xui.arr.each(m,function(n){if(n.code.indexOf(g)!=-1||n.unicode.indexOf(g)!=-1||n.name.indexOf(g)!=-1||n.font_class.indexOf(g)!=-1){l.push(n)}})});var j=[];xui.arr.each(l,function(m){var n={comment:m.name,imageClass:m.code+m.font_class,caption:"",code:m.code};j.push(n)});d.xui_ui_gallery1.setItems(j)}else{d._setEmpty()}},500)},_setEmpty:function(){var a=this;a.xui_ui_comboinput33.setValue(null,true);a.xui_ui_lst.setDisabled(false);a.xui_ui_lst.fireItemClickEvent("allicon")}}});xui.Class("RAD.ProjectSetting","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"xui_ui_dialog10").setLeft("5em").setTop("0.8333333333333334em").setWidth("56.666666666666664em").setHeight("31.666666666666668em").setZIndex(1002).setCaption("$(RAD.menu.Project Setting)").setMinBtn(false).setMaxBtn(false).setModal(true));c.xui_ui_dialog10.append(xui.create("xui.UI.Block").setHost(c,"xui_ui_block11").setDock("bottom").setLeft("30em").setTop("0em").setHeight("3em").setRight("0em").setBottom("0em").setBorderType("flat"));c.xui_ui_block11.append(xui.create("xui.UI.Button").setHost(c,"_btn_tocode").setDirtyMark(false).setLeft("0.75em").setTop("0.4166666666666667em").setWidth("7.5em").setCaption("$(RAD.projectSet.Code View)").onClick("__btn_tocode_onclick"));c.xui_ui_block11.append(xui.create("xui.UI.Button").setHost(c,"_btn_ok").setDirtyMark(false).setLeft("45.75em").setTop("0.4166666666666667em").setWidth("6.583333333333333em").setCaption("$(RAD.ok)").onClick("__btn_ok_onclick"));c.xui_ui_block11.append(xui.create("xui.UI.Button").setHost(c,"_btn_cancel").setDirtyMark(false).setLeft("35.75em").setTop("0.4166666666666667em").setWidth("6.583333333333333em").setCaption("$(RAD.cancel)").onClick("__btn_cancel_onclick"));c.xui_ui_dialog10.append(xui.create("xui.UI.Tabs").setHost(c,"xui_ui_tabs2").setItems([{id:"a",caption:"$(RAD.builder.Basic Setting)",imageClass:""},{id:"b",caption:"$(RAD.builder.Font Icons)"},{id:"e",caption:"$(RAD.designer.Constants)"},{id:"c",caption:"$(RAD.designer.Global Functions)"},{id:"d",caption:"$(RAD.designer.Global Data)"}]).setLeft("0em").setTop("0em").setValue("a").onIniPanelView("_xui_ui_tabs2_oninipanelview"));c.xui_ui_tabs2.append(xui.create("xui.UI.Group").setHost(c,"xui_ui_group6").setLeft("15.333333333333334em").setTop("1.1666666666666667em").setWidth("14.166666666666666em").setHeight("20em").setCaption("$(RAD.designer.conf.canvas.theme)").setToggleBtn(false),"a");c.xui_ui_group6.append(xui.create("xui.UI.RadioBox").setHost(c,"ctl_lappearance").setDirtyMark(false).setDock("fill").setItemRow(true));c.xui_ui_tabs2.append(xui.create("xui.UI.Group").setHost(c,"xui_ui_group16").setLeft("30.333333333333332em").setTop("1.1666666666666667em").setWidth("24.166666666666668em").setHeight("20em").setOverflow("hidden").setCaption("$(RAD.builder.Page Background)").setToggleBtn(false),"a");c.xui_ui_group16.append(xui.create("xui.UI.ComboInput").setHost(c,"_bg_clr").setDirtyMark(false).setLeft("0.8333333333333334em").setTop("0.8333333333333334em").setWidth("22.416666666666668em").setHeight("1.8333333333333333em").setLabelSize("12em").setLabelCaption("$(RAD.custom_dlg.background$-color)").setType("color"));c.xui_ui_group16.append(xui.create("xui.UI.ComboInput").setHost(c,"_bg_image").setDirtyMark(false).setLeft("0.75em").setTop("4.166666666666667em").setWidth("22.416666666666668em").setHeight("1.8333333333333333em").setLabelSize("12em").setLabelCaption("$(RAD.custom_dlg.background$-image)").setType("popbox").beforeComboPop("__bg_image_beforepopshow"));c.xui_ui_group16.append(xui.create("xui.UI.ComboInput").setHost(c,"_bg_position").setDirtyMark(false).setLeft("0.75em").setTop("7.5em").setWidth("22.416666666666668em").setHeight("1.8333333333333333em").setLabelSize("12em").setLabelCaption("$(RAD.custom_dlg.background$-position)"));c.xui_ui_group16.append(xui.create("xui.UI.ComboInput").setHost(c,"_bg_repeat").setDirtyMark(false).setLeft("0.75em").setTop("10.833333333333334em").setWidth("22.416666666666668em").setHeight("1.8333333333333333em").setLabelSize("12em").setLabelCaption("$(RAD.custom_dlg.background$-repeat)"));c.xui_ui_group16.append(xui.create("xui.UI.ComboInput").setHost(c,"_bg_attachment").setDirtyMark(false).setLeft("0.75em").setTop("14.166666666666666em").setWidth("22.416666666666668em").setHeight("1.8333333333333333em").setLabelSize("12em").setLabelCaption("$(RAD.custom_dlg.background$-attachment)"));c.xui_ui_tabs2.append(xui.create("xui.UI.Group").setHost(c,"xui_ui_group3").setLeft("0.8333333333333334em").setTop("1.1666666666666667em").setWidth("13.666666666666666em").setHeight("20em").setOverflow("hidden").setCaption("$(RAD.designer.conf.canvas.Design View)").setToggleBtn(false),"a");c.xui_ui_group3.append(xui.create("xui.UI.ComboInput").setHost(c,"_viewsize").setDirtyMark(false).setLeft("0.75em").setTop("5.833333333333333em").setWidth("11.666666666666666em").setHeight("4.083333333333333em").setTabindex(-1).setLabelSize("2em").setLabelPos("top").setLabelCaption("$(RAD.designer.conf.canvas.View Size) (px × px)").setLabelHAlign("left").beforeUIValueSet("__viewsize_beforeuivalueset"));c.xui_ui_group3.append(xui.create("xui.UI.CheckBox").setHost(c,"_touchDevice").setDirtyMark(false).setLeft("0.5833333333333334em").setTop("15.833333333333334em").setWidth("11.833333333333334em").setCaption("$(RAD.designer.conf.canvas.Mobile App)"));c.xui_ui_group3.append(xui.create("xui.UI.ComboInput").setHost(c,"_SpaceUnit").setDirtyMark(false).setLeft("0.75em").setTop("0.8333333333333334em").setWidth("11.666666666666666em").setHeight("4.083333333333333em").setLabelSize("2em").setLabelPos("top").setLabelCaption("$(RAD.designer.conf.canvas.Space Unit)").setLabelHAlign("left").setType("listbox").setItems([{id:"em",caption:"em"},{id:"px",caption:"px"}]));c.xui_ui_group3.append(xui.create("xui.UI.ComboInput").setHost(c,"_zoom").setDirtyMark(false).setLeft("0.75em").setTop("10.833333333333334em").setWidth("11.666666666666666em").setHeight("4.083333333333333em").setLabelSize("2em").setLabelPos("top").setLabelCaption("$RAD.designer.conf.canvas.zoom").setLabelHAlign("left"));c.xui_ui_tabs2.append(xui.create("xui.UI.TreeGrid").setHost(c,"xui_ui_treegrid3").setDirtyMark(false).setLeft("0em").setTop("0em").setEditable(true).setRowHandlerWidth("2.5em").setHeader([{id:"id",caption:"ID",width:"8em",type:"input"},{id:"href",caption:"href",width:"18em",type:"input"},{id:"integrity",caption:"integrity",width:"18em",flexSize:true,type:"input"},{id:"disabled",caption:"disabled",width:"6em",type:"checkbox"}]).setTagCmds([{id:"del",type:"text",location:"left",itemClass:"xuicon xui-uicmd-close"}]).setHotRowMode("show").beforeHotRowAdded("_xui_ui_treegrid3_beforehotrowadded").onCmd("_xui_ui_treegrid3_oncmd"),"b");return b},events:{onReady:"_page_onready",onDestroy:"_destroy"},iniExModules:function(a){var b=this;xui.newModule("RAD.FunctionsEditor",function(){var c=this;c.setProperties({type:"golbal",page:{},functions:SPA.curProjectConfig.$GlobalFunctions||{}});b.xui_ui_tabs2.append(c.xui_main,"c");b._funseditor=c});xui.newModule("xui.Module.JSONEditor",function(){var c=this;c.setEvents({onchange:function(d){b._dataDirty=1}}).setValue(SPA.curProjectConfig.$GlobalData||{});b.xui_ui_tabs2.append(c,"d");b._dataseditor=c});xui.newModule("xui.Module.JSONEditor",function(){var c=this;c.setProperties({keyCaption:"Constant Name",valueCaption:"Constant Value",multiLineValue:false,notree:true});c.setEvents({onchange:function(d){b._constDirty=1}}).setValue(SPA.curProjectConfig.$ConstantData||{});b.xui_ui_tabs2.append(c,"e");b._constanteditor=c})},_destroy:function(){var a=this;a._funseditor.destroy();a._dataseditor.destroy();a._constanteditor.destroy()},_page_onready:function(b,c){var j=this,g=[];delete j._funsDirty;delete j._dataDirty;delete j._constDirty;j._viewsize.setItems(["480 × 800","480 × 854","540 × 960","640 × 960","640 × 1136","720 × 1280","750 × 1334","1080 × 1920","800 × 1280","800 × 600","1024 × 768","1280 × 768","1280 × 1024","1360 × 768"]);j._zoom.setItems(CONF.designer_zoom);j.xui_ui_tabs2.setUIValue("a");xui.arr.each(CONF.designer_themes2,function(q){if(!q){return}g.push({id:q,caption:xui.str.initial(q)})});j.ctl_lappearance.setItems(g).setValue("default",true);j._bg_position.setItems(CONF.designer_background_position);j._bg_repeat.setItems(CONF.designer_background_repeat);j._bg_attachment.setItems(CONF.designer_background_attachment);var e=SPA.curProjectConfig,m,n;if((m=e.$PageAppearance)){if(m.theme){j.ctl_lappearance.setValue(m.theme,true)}if(m.zoom){j._zoom.setValue(m.zoom,true)}if(m.background&&xui.isHash(m.background)){n=m.background;j._bg_clr.setValue(n["background-color"]||"",true);j._bg_image.setValue(n["background-image"]||"",true);j._bg_position.setValue(n["background-position"]||"",true);j._bg_repeat.setValue(n["background-repeat"]||"",true);j._bg_attachment.setValue(n["background-attachment"]||"",true)}}if((m=e.$FontIconsCDN)){var o=[];xui.each(m,function(r,q){o.push([q,r.href,r.integrity,!!r.disabled])});j.xui_ui_treegrid3.setRows(o)}var l=xui.SpaceUnit,f=false,d=800,a=600;if((m=e.$DevEnv)){l=m.SpaceUnit||xui.SpaceUnit;if((m=m.designViewConf)){if(m.touchDevice){f=true}if(m.width){d=parseInt(m.width,10)||800}if(m.height){a=parseInt(m.height,10)||600}}}j._viewsize.resetValue(d+" × "+a);j._touchDevice.resetValue(f);j._SpaceUnit.resetValue(l)},__bg_image_beforepopshow:function(d,e,c){var b=this,a=d.boxing();xui.ModuleFactory.getCom("RAD.ImageSelector",function(){this.setProperties({onOK:function(g,f){if(f&&SPA.curProjectPath){f=f.replace(/\\/g,"/").replace(SPA.curProjectPath.replace(/\\/g,"/")+"/","{/}")}a.setUIValue("url("+f+")");a.activate(true)}});this.show()})},__btn_cancel_onclick:function(b,d,f,c){var a=this;a.xui_ui_dialog10.close()},_refreshProjectConfig:function(m,f){var e=this,l="xuiconf.js",c,g,d,b,a={"background-image":"url("+xui.getPath("/RAD/img/designer/","bg.gif")+")","background-position":"left top","background-repeat":"repeat","background-color":"","background-attachment":""},j=function(x){x=xui.replace(x,[[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"$0"],[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[/\/\*[^*]*\*+([^\/][^*]*\*+)*\//,""]]);d=x.split(/\s*\/\/ \[\[Page Appearance\s*\n|\n\s*\/\/ \]\]Page Appearance\s*/);if(d.length==3){c=d[1];g=null;try{b=/^\s*xui\.ini\.\$PageAppearance\s*\=\s*/;if(b.test(c)){c=xui.replace(c,[[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"$0"],[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[b,""],[/;\s*$/,""],[/\/\/[^\n]*/,""]]);g=xui.unserialize(c)}}catch(w){xui.alert(w+"<br><br>File => "+l+"<br><br>at : xui.ini.$PageAppearance = ...");return}if(typeof g==="object"&&g!==null){e.curProjectConfig.$PageAppearance=g;if(g.theme){e.tabsMain.setSandboxTheme(g.theme,true,'[class~="xui-designer-inner-control"]')}if(g.background&&xui.isHash(g.background)){var u=xui.clone(a);xui.each(g.background,function(B,A){u[A]=xui.adjustRes(B)});xui.CSS.addStyleSheet(xui.UI.buildCSSText({".xui-designer-root .xui-designer-canvas":u}),"xui.UI.design",null,true)}}}d=x.split(/\s*\/\/ \[\[Font Icons CDN\s*\n|\n\s*\/\/ \]\]Font Icons CDN\s*/);if(d.length==3){c=d[1];g=null;try{b=/^\s*xui\.ini\.\$FontIconsCDN\s*\=\s*/;if(b.test(c)){c=xui.replace(c,[[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"$0"],[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[b,""],[/;\s*$/,""],[/\/\/[^\n]*/,""]]);g=xui.unserialize(c)}}catch(w){xui.alert(w+"<br><br>File => "+l+"<br><br>at : xui.ini.$FontIconsCDN = ...");return}if(typeof g==="object"&&g!==null){e.curProjectConfig.$FontIconsCDN=g;xui.each(g,function(C,B){if(C.href){var A={crossorigin:"anonymous"};xui.merge(A,C,function(D,E){return E!=="href"});xui.CSS.includeLink(xui.adjustRes(C.href),"xui_app_fscdn-"+B,false,A)}})}}d=x.split(/\s*\/\/ \[\[Element Style\s*\n|\n\s*\/\/ \]\]Element Style\s*/);if(d.length==3){c=d[1];g=null;try{b=/^\s*xui\.ini\.\$ElementStyle\s*\=\s*/;if(b.test(c)){c=xui.replace(c,[[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"$0"],[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[b,""],[/;\s*$/,""],[/\/\/[^\n]*/,""]]);g=xui.unserialize(c)}}catch(w){xui.alert(w+"<br><br>File => "+l+"<br><br>at : xui.ini.$ElementStyle = ...");return}if(typeof g==="object"&&g!==null){e.curProjectConfig.$ElementStyle=g;xui.CSS.setStyleRules(".xui-desinger-canvas .xui-custom",g,true)}}d=x.split(/\s*\/\/ \[\[Default Prop\s*\n|\n\s*\/\/ \]\]Default Prop\s*/);if(d.length==3){c=d[1];g=null;try{b=/^\s*xui\.ini\.\$DefaultProp\s*\=\s*/;if(b.test(c)){c=xui.replace(c,[[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"$0"],[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[b,""],[/;\s*$/,""],[/\/\/[^\n]*/,""]]);g=xui.unserialize(c)}}catch(w){xui.alert(w+"<br><br>File => "+l+"<br><br>at : xui.ini.$DefaultProp = ...");return}if(typeof g==="object"&&g!==null){e.curProjectConfig.$DefaultProp=g;var s={},o;xui.each(g,function(B,A){if(/^xui\.UI\./.test(A)&&xui.isHash(B)&&(o=xui.get(window,A.split(".")))){o.__resetDftProp_in_Desinger=B}else{s[A]=B}});if(!xui.isEmpty(s)){xui.UI.__resetDftProp_in_Desinger=s}}}d=x.split(/\s*\/\/ \[\[Develop Env Setting\s*\n|\n\s*\/\/ \]\]Develop Env Setting\s*/);if(d.length==3){c=d[1];g=null;try{b=/^\s*xui\.ini\.\$DevEnv\s*\=\s*/;if(b.test(c)){c=xui.replace(c,[[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"$0"],[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[b,""],[/;\s*$/,""],[/\/\/[^\n]*/,""]]);g=xui.unserialize(c)}}catch(w){xui.alert(w+"<br><br>File => "+l+"<br><br>at : xui.ini.$DevEnv = ...");return}if(typeof g==="object"&&g!==null){e.curProjectConfig.$DevEnv=g;var q={},r,n;if((q.width=xui.get(g,["designViewConf","width"]))&&(q.height=xui.get(g,["designViewConf","height"]))){xui.each(RAD.Designer.getAllInstance(),function(A){if(A.canvas){A.setViewSize(q);if(A._cls){xui.asyRun(function(){if(A._cls){A.refreshView(A._cls)}},100)}}})}if(r=xui.get(g,["designViewConf","touchDevice"])){xui.each(RAD.Designer.getAllInstance(),function(A){if(A.canvas){A.setMobileFrame(r)}})}if(n=xui.get(g,["SpaceUnit"])){xui.each(RAD.Designer.getAllInstance(),function(A){if(A.canvas){if(A._cls){xui.asyRun(function(){if(A._cls){A.refreshView(A._cls)}},100)}}})}}}d=x.split(/\s*\/\/ \[\[Global Functions\s*\n|\n\s*\/\/ \]\]Global Functions\s*/);if(d.length==3){c=d[1];g=null;try{b=/^\s*xui\.\$cache\.functions\s*\=\s*/;if(b.test(c)){c=xui.replace(c,[[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"$0"],[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[b,""],[/;\s*$/,""],[/\/\/[^\n]*/,""]]);g=xui.unserialize(c)}}catch(w){xui.alert(w+"<br><br>File => "+l+"<br><br>at : xui.$cache.functions = ...");return}if(typeof g==="object"&&g!==null){e.curProjectConfig.$GlobalFunctions=g}}d=x.split(/\s*\/\/ \[\[Global Data\s*\n|\n\s*\/\/ \]\]Global Data\s*/);if(d.length==3){c=d[1];g=null;try{b=/^\s*xui\.\$cache\.data\s*\=\s*/;if(b.test(c)){c=xui.replace(c,[[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"$0"],[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[b,""],[/;\s*$/,""],[/\/\/[^\n]*/,""]]);g=xui.unserialize(c)}}catch(w){xui.alert(w+"<br><br>File => "+l+"<br><br>at : xui.$cache.data = ...");return}if(typeof g==="object"&&g!==null){e.curProjectConfig.$GlobalData=g}}d=x.split(/\s*\/\/ \[\[Constant Data\s*\n|\n\s*\/\/ \]\]Constant Data\s*/);if(d.length==3){c=d[1];g=null;try{b=/^\s*xui\.constant\s*\=\s*/;if(b.test(c)){c=xui.replace(c,[[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"$0"],[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[b,""],[/;\s*$/,""],[/\/\/[^\n]*/,""]]);g=xui.unserialize(c)}}catch(w){xui.alert(w+"<br><br>File => "+l+"<br><br>at : xui.constant = ...");return}if(typeof g==="object"&&g!==null){e.curProjectConfig.$ConstantData=g}}};e.curProjectConfig={};if(xui.isSet(m)){e._resetPrjEnv();j(m||"");xui.tryF(f)}else{xui.Ajax(CONF.getProjectConfigService,{projectName:SPA.curProjectName},function(n){e._resetPrjEnv();j(n||"");xui.tryF(f)},function(n){e._resetPrjEnv();xui.tryF(f);xui.alert("Missing file : '"+l+"'.")},null,{rspType:"text",method:"POST"}).start()}return e.curProjectConfig},__btn_ok_onclick:function(c,A,f,w){var B=this,r=[],s="xuiconf.js",x={background:{}},b=x.background,a,q,o,m,j,g,u,n,d=function(G,D,E,H,e,F,C){G=xui.replace(G,[[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"$0"],[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[/\/\*[^*]*\*+([^\/][^*]*\*+)*\//,""],[/(\r\n|\r)/,"\n"]]);D=D||"";E=E||"";H=H||"";e=e||"";F=F||"";C=C||"";a=G.split(/\s*\/\/ \[\[Page Appearance|\n\s*\/\/ \]\]Page Appearance\s*/);if(a.length==3){G=a[0]+"\n\n// [[Page Appearance\n"+D+"\n// ]]Page Appearance\n"+a[2]}else{G+="\n\n// [[Page Appearance\n"+D+"\n// ]]Page Appearance\n"}a=G.split(/\s*\/\/ \[\[Font Icons CDN|\n\s*\/\/ \]\]Font Icons CDN\s*/);if(a.length==3){G=a[0]+"\n\n// [[Font Icons CDN\n"+E+"\n// ]]Font Icons CDN\n"+a[2]}else{G+="\n\n// [[Font Icons CDN\n"+E+"\n// ]]Font Icons CDN\n"}a=G.split(/\s*\/\/ \[\[Develop Env Setting|\n\s*\/\/ \]\]Develop Env Setting\s*/);if(a.length==3){G=a[0]+"\n\n// [[Develop Env Setting\n"+H+"\n// ]]Develop Env Setting\n"+a[2]}else{G+="\n\n// [[Develop Env Setting\n"+H+"\n// ]]Develop Env Setting\n"}if(e){a=G.split(/\s*\/\/ \[\[Global Functions|\n\s*\/\/ \]\]Global Functions\s*/);if(a.length==3){G=a[0]+"\n\n// [[Global Functions\n"+e+"\n// ]]Global Functions\n"+a[2]}else{G+="\n\n// [[Global Functions\n"+e+"\n// ]]Global Functions\n"}}if(F){a=G.split(/\s*\/\/ \[\[Global Data|\n\s*\/\/ \]\]Global Data\s*/);if(a.length==3){G=a[0]+"\n\n// [[Global Data\n"+F+"\n// ]]Global Data\n"+a[2]}else{G+="\n\n// [[Global Data\n"+F+"\n// ]]Global Data\n"}}if(C){a=G.split(/\s*\/\/ \[\[Constant Data|\n\s*\/\/ \]\]Constant Data\s*/);if(a.length==3){G=a[0]+"\n\n// [[Constant Data\n"+C+"\n// ]]Constant Data\n"+a[2]}else{G+="\n\n// [[Constant Data\n"+C+"\n// ]]Constant Data\n"}}CONF.saveFiles([{id:s,paras:{projectName:SPA.curProjectName,hashCode:xui.id(),curProjectPath:SPA.curProjectPath,path:s,fileType:"EUFile",content:G,jscontent:G},onSuccess:function(){B.xui_ui_dialog10.close();SPA.refreshProjectConfig(G);SPA.closeFile(s)},onFail:function(I){xui.message(I)}}])};x.theme=B.ctl_lappearance.getUIValue();x.zoom=B._zoom.getUIValue()||"";if(!x.zoom||parseFloat(x.zoom)=="1"){delete x.zoom}if((n=B._bg_clr.getUIValue())){b["background-color"]=n}if((n=B._bg_image.getUIValue())){b["background-image"]=n}if((n=B._bg_position.getUIValue())){b["background-position"]=n}if((n=B._bg_repeat.getUIValue())){b["background-repeat"]=n}if((n=B._bg_attachment.getUIValue())){b["background-attachment"]=n}if(xui.isEmpty(b)){delete x.background}q="xui.ini.$PageAppearance = "+xui.Coder.formatText(xui.stringify(x),"js");q=q.replace(/\}\s*$/,"};");var l=B.xui_ui_treegrid3.getRows("min");if(l&&l.length){xui.filter(l,function(e){return !!(e[0]&&e[1])})}if(l&&l.length){x={};xui.arr.each(l,function(e){x[e[0]]={};x[e[0]].href=e[1];x[e[0]].integrity=e[2];x[e[0]].disabled=!!e[3]});o="xui.ini.$FontIconsCDN = "+xui.Coder.formatText(xui.stringify(x),"js");o=o.replace(/\}\s*$/,"};")}x={designViewConf:{}};if(B._touchDevice.getUIValue()){x.designViewConf.touchDevice=true}if((n=B._SpaceUnit.getUIValue())&&n!=xui.SpaceUnit){x.SpaceUnit=n}if((n=B._viewsize.getUIValue())){if((n=B._viewsize_reg.exec(n))){x.designViewConf.width=parseInt(n[1],10);x.designViewConf.height=parseInt(n[2],10)}}m="xui.ini.$DevEnv = "+xui.Coder.formatText(xui.stringify(x),"js");m=m.replace(/\}\s*$/,"};");if(B._funsDirty){SPA.curProjectConfig.$GlobalFunctions=B._funseditor.fireData(true);j="xui.$cache.functions ="+xui.stringify(SPA.curProjectConfig.$GlobalFunctions);j=j.replace(/\}\s*$/,"};")}if(B._dataDirty){SPA.curProjectConfig.$GlobalData=B._dataseditor.getValue(true);g="xui.$cache.data = "+xui.Coder.formatText(xui.stringify(SPA.curProjectConfig.$GlobalData),"js");g=g.replace(/\}\s*$/,"};")}if(B._constDirty){SPA.curProjectConfig.$ConstantData=B._constanteditor.getValue(true);u="xui.constant = "+xui.Coder.formatText(xui.stringify(SPA.curProjectConfig.$ConstantData),"js");u=u.replace(/\}\s*$/,"};")}CONF.getLocalFile("xuiconf.js?"+xui.rand(),function(e){d(e||"",q,o,m,j,g,u)},function(C){d("",q,o,m,j,g,u)})},__btn_tocode_onclick:function(b,d,f,c){var a=this;a.xui_ui_dialog10.close();SPA.openFile("xuiconf.js")},_xui_ui_treegrid3_beforehotrowadded:function(b,a){if(a.id&&a.href){return true}return null},_xui_ui_treegrid3_oncmd:function(c,j,f,d,g){var b=this,a=c.boxing();if(j){a.removeRows(j.id)}else{a.removeAllRows()}},_viewsize_reg:/\s*([\d][\d]*)[^\d]+([\d][\d]*)\s*/,__viewsize_beforeuivalueset:function(f,c,j,g,b){var e=this,d=f.boxing(),a;if((a=e._viewsize_reg.exec(j))){return a[1]+" × "+a[2]}return false},_xui_ui_tabs2_oninipanelview:function(b,c){var a=this;if(c.id=="c"){a._funsDirty=1}}}});xui.Class("RAD.APIConfig","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"xui_ui_dialog2").setLeft("0em").setTop("0em").setWidth("66.667em").setHeight("43.333333333333336em").setCaption("$(RAD.api_dlg.Web API Caller)").setMinBtn(false).setMinWidth(780).setMinHeight(450).setModal(true).setConDockPadding({left:4,top:0,right:4,bottom:0}).setConDockSpacing({width:0,height:6}).beforeClose("_xui_ui_dialog2_beforeclose"));c.xui_ui_dialog2.append(xui.create("xui.UI.Div").setHost(c,"xui_ui_pane23").setDock("top").setWidth("8.334em").setHeight("2.8334em").setOverflow("hidden"));c.xui_ui_pane23.append(xui.create("xui.UI.ComboInput").setHost(c,"xui_url").setDirtyMark(false).setDock("width").setDockMargin({left:0,top:0,right:260,bottom:0}).setDockMinW("33.334em").setLeft("7em").setTop("0.75em").setWidth("16em").setHeight("1.75em").setLabelSize("8.334em").setLabelGap("0.334em").setLabelCaption("远程RUL:").setType("helpinput").setImageClass("xui-icon-filter").setCommandBtn("pop").onHotKeypress("_ctl_xui_url_onhotkey").onChange("_ctl_xui_url_onchange").onCommand("_ctl_xui_url_oncommand").beforePopShow("_ctl_xui_url_beforshow"));c.xui_ui_pane23.append(xui.create("xui.UI.CheckBox").setHost(c,"xui_asyn").setDirtyMark(false).setTop("0.91667em").setRight("0.5em").setCaption("$(RAD.api_dlg.Asynchronous)").setValue(true));c.xui_ui_pane23.append(xui.create("xui.UI.CheckBox").setHost(c,"autoRun").setDirtyMark(false).setTop("0.91667em").setRight("7.5em").setCaption("自动运行").setValue(false));c.xui_ui_pane23.append(xui.create("xui.UI.CheckBox").setHost(c,"isAllform").setDirtyMark(false).setTop("0.91667em").setRight("15em").setCaption("级联").setValue(false));c.xui_ui_dialog2.append(xui.create("xui.UI.Div").setHost(c,"xui_ui_paneleft").setDock("left").setTop("5.8334em").setWidth("19.1667em").setHeight("32.5em"));c.xui_ui_paneleft.append(xui.create("xui.UI.Div").setHost(c,"xui_ui_pane272").setDock("top").setDockIgnoreFlexFill(true).setLeft("0em").setWidth("20em").setPosition(true).setConDockPadding({left:4,top:4,right:4,bottom:4}).setConDockSpacing({width:0,height:4}));c.xui_ui_pane272.append(xui.create("xui.UI.ComboInput").setHost(c,"xui_reqtype").setDirtyMark(false).setLeft("0em").setTop("2.5em").setWidth("18.334em").setLabelSize("8.334em").setLabelGap("0.334em").setLabelCaption("$(RAD.api_dlg.Request Type)").setType("listbox").setItems([{id:"FORM",caption:"FORM"},{id:"JSON",caption:"JSON"},{id:"XML",caption:"XML"},{id:"SOAP",caption:"SOAP"}]).setValue("FORM"));c.xui_ui_pane272.append(xui.create("xui.UI.ComboInput").setHost(c,"xui_rsptype").setDirtyMark(false).setLeft("0em").setTop("5em").setWidth("18.334em").setLabelSize("8.334em").setLabelGap("0.334em").setLabelCaption("$(RAD.api_dlg.Response Type)").setType("listbox").setItems([{id:"JSON",caption:"JSON"},{id:"TEXT",caption:"TEXT"},{id:"XML",caption:"XML"},{id:"SOAP",caption:"SOAP"}]).setValue("JSON"));c.xui_ui_pane272.append(xui.create("xui.UI.ComboInput").setHost(c,"xui_method").setDirtyMark(false).setLeft("0em").setTop("7.5em").setWidth("18.334em").setLabelSize("8.334em").setLabelGap("0.334em").setLabelCaption("$(RAD.api_dlg.Query Method)").setType("listbox").setItems([{id:"auto",caption:"auto"},{id:"GET",caption:"GET"},{id:"POST",caption:"POST"},{id:"PUT",caption:"PUT"},{id:"DELETE",caption:"DELETE"}]).setValue("auto"));c.xui_ui_pane272.append(xui.create("xui.UI.ComboInput").setHost(c,"xui_proxytype").setDirtyMark(false).setLeft("0em").setTop("0em").setWidth("18.334em").setLabelSize("8.334em").setLabelGap("0.334em").setLabelCaption("$(RAD.api_dlg.Proxy Type)").setType("listbox").setItems([{id:"auto",caption:"auto"},{id:"AJAX",caption:"AJAX"},{id:"JSONP",caption:"JSONP"},{id:"XDMI",caption:"XDMI"}]).setValue("auto").afterValueSet("_xui_ui_comboinput207_aftervalueset"));c.xui_ui_paneleft.append(xui.create("xui.UI.Stacks").setHost(c,"xui_ui_foldingtabs1").setItems([{id:"a",caption:"$(RAD.api_dlg.Authorization)"},{id:"b",caption:"$(RAD.api_dlg.Request Header)"},{id:"c",caption:"$(RAD.api_dlg.Cookies Smulation)"},{id:"d",caption:"$(RAD.api_dlg.Other Query Options)"}]).setDockMargin({left:0,top:120,right:0,bottom:0}).setWidth("18.91667em").setHeight("25.5em").setValue("a"));c.xui_ui_foldingtabs1.append(xui.create("xui.Module.JSONEditor","xui.Module").setHost(c,"m_header").setProperties({keyCaption:"$(RAD.api_dlg.Key)",valueCaption:"$(RAD.api_dlg.Value)",multiLineValue:false,notree:true}),"b");c.xui_ui_foldingtabs1.append(xui.create("xui.Module.JSONEditor","xui.Module").setHost(c,"m_cookies").setProperties({keyCaption:"$(RAD.api_dlg.Key)",valueCaption:"$(RAD.api_dlg.Value)",multiLineValue:false,notree:true}),"c");c.xui_ui_foldingtabs1.append(xui.create("xui.Module.JSONEditor","xui.Module").setHost(c,"m_options").setProperties({keyCaption:"$(RAD.api_dlg.Key)",valueCaption:"$(RAD.api_dlg.Value)",multiLineValue:false,notree:true}),"d");c.xui_ui_foldingtabs1.append(xui.create("xui.UI.ComboInput").setHost(c,"xui_token").setDirtyMark(false).setLeft("0em").setTop("0.8334em").setWidth("18.334em").setLabelSize("8.334em").setLabelGap("0.334em").setLabelCaption("$(RAD.api_dlg.OAuth2Token)").setType("input"),"a");c.xui_ui_foldingtabs1.append(xui.create("xui.UI.ComboInput").setHost(c,"xui_username").setDirtyMark(false).setLeft("0em").setTop("3.334em").setWidth("18.334em").setLabelSize("8.334em").setLabelGap("0.334em").setLabelCaption("$(RAD.api_dlg.User Name)").setType("input"),"a");c.xui_ui_foldingtabs1.append(xui.create("xui.UI.ComboInput").setHost(c,"xui_password").setDirtyMark(false).setLeft("0em").setTop("5.8334em").setWidth("18.334em").setLabelSize("8.334em").setLabelGap("0.334em").setLabelCaption("$(RAD.api_dlg.Password)").setType("input"),"a");c.xui_ui_dialog2.append(xui.create("xui.UI.Div").setHost(c,"xui_ui_pane22").setDock("fill").setDockMargin({left:6,top:0,right:0,bottom:0}).setLeft("25.833333333333332em").setTop("9.1667em").setWidth("12.1667em").setHeight("12.91667em").setConDockPadding({left:0,top:0,right:0,bottom:2}).setConDockSpacing({width:0,height:4}));c.xui_ui_pane22.append(xui.create("xui.UI.HTMLButton").setHost(c,"xui_ui_htmlbutton3").setDock("bottom").setDockOrder(3).setDockMargin({left:6,top:2,right:6,bottom:2}).setWidth("11em").setHeight("1.8334em").setHtml("$(RAD.api_dlg.Test the Web API)").onClick("_xui_ui_htmlbutton3_onclick"));c.xui_ui_pane22.append(xui.create("xui.UI.Layout").setHost(c,"xui_ui_layout7").setItems([{id:"before",size:100,min:10,locked:false,folded:false,hidden:false,cmd:false,pos:"before"},{id:"main",size:120,min:10}]).setLeft("0em").setTop("0em").setFlexSize(true).setTransparent(true));c.xui_ui_layout7.append(xui.create("xui.UI.Group").setHost(c,"xui_ui_group7").setDock("fill").setDockOrder(2).setLeft("5.8334em").setWidth("8.334em").setHeight("15em").setConDockPadding({left:4,top:4,right:4,bottom:4}).setConDockSpacing({width:4,height:0}).setCaption("$(RAD.api_dlg.Request Data Setting)").setToggleBtn(false),"before");c.xui_ui_group7.append(xui.create("xui.UI.Div").setHost(c,"xui_ui_pane15").setDock("left").setTop("0.8334em").setWidth("26em").setHeight("8.334em").setConDockSpacing({width:0,height:4}).setConDockFlexFill("height"));c.xui_ui_pane15.append(xui.create("xui.UI.Stacks").setHost(c,"xui_ui_foldingtabs11").setItems([{id:"b",caption:"$(RAD.api_dlg.Request Datasource)",height:180},{id:"c",caption:"$(RAD.api_dlg.Request Parameters)",height:170,imageClass:""}]).setLeft("9.58334em").setTop("0em").setWidth("8.41667em").setHeight("21em").setValue("b"));c.xui_ui_foldingtabs11.append(xui.create("xui.UI.TreeGrid").setHost(c,"xui_reqds").setDirtyMark(false).setShowDirtyMark(false).setLeft("0em").setTop("0em").setSelMode("multibycheckbox").setEditable(true).setRowHandlerWidth("4em").setColSortable(false).setHeader([{id:"source",caption:"$(RAD.api_dlg.Datasource)",width:"6.667em",type:"label"},{id:"path",caption:"$(RAD.api_dlg.To Data Path)",width:"6.667em",flexSize:true,type:"input",editable:true},{id:"desc",caption:"参数用途",width:"6.667em",flexSize:true,type:"input",editable:false}]).setGrpCols({}).setRows({}).setTreeMode("none").setValue("").onChange("_xui_reqds_onchange").onRowSelected("_ontrows").beforeRowActive("_tg_beforerowactive").beforeCellUpdated("_acu").afterCellUpdated("_xui_reqds_bcellupdated").setCustomClass({HFMARK:"xui-uicmd-none"}),"b");c.xui_ui_foldingtabs11.append(xui.create("xui.Module.JSONEditor","xui.Module").setHost(c,"m_reqparams").setProperties({keyCaption:"$(RAD.api_dlg.Key)",valueCaption:"$(RAD.api_dlg.Value)",multiLineValue:false}).setEvents({onchange:"_m_reqparams_onchange"}),"c");c.xui_ui_group7.append(xui.create("xui.UI.Panel").setHost(c,"xui_ui_panel44").setLeft("19.58334em").setTop("0.8334em").setWidth("24.5em").setHeight("17.083333333333332em").setConDockSpacing({width:0,height:4}).setCaption("$(RAD.api_dlg.Request Data)").setBorderType("none").setNoFrame(true).setCustomClass({INFO:"xui-uicmd-land"}));c.xui_ui_panel44.append(xui.create("xui.UI.Input").setHost(c,"xui_reqtext").setDisabled(true).setDock("fill").setLeft("6.667em").setTop("4.1667em").setHeight("10em").setLabelGap("0.334em").setMultiLines(true));c.xui_ui_layout7.append(xui.create("xui.UI.Group").setHost(c,"xui_ui_group10").setDock("fill").setLeft("6.667em").setWidth("8.334em").setHeight("19.1667em").setConDockPadding({left:4,top:4,right:4,bottom:4}).setConDockSpacing({width:4,height:0}).setCaption("$(RAD.api_dlg.Response Data Setting)").setToggleBtn(false),"main");c.xui_ui_group10.append(xui.create("xui.UI.Panel").setHost(c,"xui_ui_panel45").setDock("left").setTop("1.667em").setWidth("30em").setHeight("17.08333em").setCaption("$(RAD.api_dlg.Response to Target)").setBorderType("flat").setNoFrame(true).setCustomClass({INFO:"xui-uicmd-land"}));c.xui_ui_panel45.append(xui.create("xui.UI.TreeGrid").setHost(c,"xui_rsptarget").setDirtyMark(false).setShowDirtyMark(false).setLeft("0em").setTop("0em").setSelMode("multibycheckbox").setEditable(true).setRowHandlerWidth("5em").setColSortable(false).setHeader([{id:"name",caption:"组件名称",width:"10em",flexSize:true,type:"label",editable:true},{id:"path",caption:"映射地址",width:"10em",flexSize:true,type:"input"},{id:"type",caption:"组件类型",width:"8em",flexSize:true,type:"label",editable:false}]).setValue("").onRowSelected("_ontrows2").beforeRowActive("_tg_beforerowactive").beforeCellUpdated("_acu").setCustomClass({HFMARK:"xui-uicmd-none"}));c.xui_ui_group10.append(xui.create("xui.UI.Panel").setHost(c,"xui_ui_panel17").setLeft("20.41667em").setTop("1.667em").setWidth("24.5em").setHeight("17.08333em").setConDockSpacing({width:0,height:4}).setCaption("$(RAD.api_dlg.Response Callback)").setNoFrame(true));c.xui_ui_panel17.append(xui.create("xui.UI.TreeGrid").setHost(c,"xui_rspfun").setDirtyMark(false).setShowDirtyMark(false).setLeft("0em").setTop("0em").setSelMode("multibycheckbox").setEditable(true).setRowHandlerWidth("2em").setColSortable(false).setHeader([{id:"type",caption:"$(RAD.api_dlg.Callback Type)",flexSize:true,width:"6em",type:"label"},{id:"source",flexSize:true,caption:"$(RAD.api_dlg.Callback)",width:"12em",type:"label"}]).setTreeMode("none").setValue("").onRowSelected("_ontrows").beforeRowActive("_tg_beforerowactive").setCustomClass({HFMARK:"xui-uicmd-none"}));return b},events:{onReady:"_onready"},_onready:function(){if(CONF.getClientMode()!="project"){this.xui_url.setType("none")}},_ctl_xui_url_onhotkey:function(b,a,c,d){if(a[0]=="/"){this._reSetValue(b)}},_ctl_xui_url_beforshow:function(b){var a=this,c=a.xui_url.getValue();if(c&&c==""){this._reSetValue(b)}},_reSetValue:function(e,f){var d=this,j=d.properties;var d=this,b=e.boxing(),c=SPA.curProjectConfig.$ConstantData;var a=[];d._filter=".*"+f+".*";xui.Dom.busy();var g="";if(SPA.curProjectConfig.$ConstantData&&SPA.curProjectConfig.$ConstantData.apipath){g=SPA.curProjectConfig.$ConstantData.apipath}xui.Ajax(CONF.getAPIService,{path:g,pattern:d._filter},function(l){var n=l.data;if(n&&!n.error){xui.arr.each(n,function(q){a.push({id:q.id,caption:q.caption,disabled:q.disabled,properties:q.properties,getProperties:function(){return this.properties}})})}if(!n||n.length==0){a.push({id:f,caption:"没有发现匹配的API!",})}try{b.expand()}catch(m){}b.setItems(a);xui.Dom.free()},function(l){b.setItems(a);xui.Dom.free()},null,{method:"post"}).start()},_ctl_xui_url_onchange:function(c,a,e){var b=this;var d=c.boxing().getItemByItemId(e);if(d){this.setDataToEditor(d,b._host)}else{this._reSetValue(c,e)}},_ctl_xui_url_oncommand:function(b,e){var a=this,f=this.getDataFromEditor(),d=f.queryArgs;b.boxing().setValue("/LOCALESD/executeCMD",true);var c=d.expression;xui.getModule("RAD.expression.ExpressionTemp",function(){this.setData({projectName:SPA.curProjectName,className:SPA.currentClassName});this.setDataToEditor(a._host,a._cls,f);this.setEvents("onDestroy",function(){a.m_reqparams.setProperties("value",f.queryArgs);a.updateRequestData(f.queryArgs)});this.show();this.initData();this._fireEvent("afterShow")})},setDataToEditor:function(d,l,n){var e=this,a=d.getProperties(),c,f,g,j,b;e._oldprop=a;e._host=l;e.cls=n;e.xui_url.setValue(a.queryURL);if(!a.queryAsync&&(a.queryAsync==false||a.queryAsync=="false")){e.xui_asyn.setValue(false)}else{e.xui_asyn.setValue(true)}e.autoRun.setValue(a.autoRun);e.isAllform.setValue(a.isAllform);e.xui_method.setValue(a.queryMethod);e.xui_username.setValue(a.queryUserName);e.xui_password.setValue(a.queryPassword);e.xui_reqtype.setValue(a.requestType);e.xui_rsptype.setValue(a.responseType);e.xui_proxytype.setValue(a.proxyType);e.xui_token.setValue(a.oAuth2Token);(function(){c=[];f={};g=[];xui.arr.each(a.requestDataSource,function(m){f[m.type+"-"+m.name]=m.path;if(m.type=="spa"){b="spa-"+m.name;g.push(b);c.push({id:b,bindertype:"spa",cells:[m.name,m.path,"SPA参数"]})}});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.DataBinder"]){return}j=m.getName();b="databinder-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"databinder",cells:[j,f[b]||"","自定义"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.UI.PageBar"]){return}j=m.getAlias();b="pagebar-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"pagebar",cells:[j,f[b]||"","分页参数"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.UI.TreeView"]){return}j=m.getAlias();b="treeview-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"treeview",cells:[j,f[b]||"","当前选中行"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.UI.FusionChartsXT"]){return}j=m.getAlias();b="fchart-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"fchart",cells:[j,f[b]||"","当前选中"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.UI.Gallery"]){return}j=m.getAlias();b="gallery-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"gallery",cells:[j,f[b]||"","当前选中"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.Module"]){return}j=m.getName();b="module-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"module",cells:[j,f[b]||j,"子模块"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.UI.TreeGrid"]){return}j=m.getAlias();b="treegrid-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"treegrid",cells:[j,f[b]||"","所有选中行ID"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.UI.TreeGrid"]){return}j=m.getAlias();b="treegrid-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"treegrid",cells:[j,f[b]||"","所有选中行ID"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.UI.TreeGrid"]){return}j=m.getAlias();b="treegridrow-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"treegridrow",cells:[j,f[b]||"","当前选中行"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.absContainer"]||m.getFormElements().isEmpty()){return}j=m.getAlias();b="form-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"form",cells:[j,f[b]||"","表单数据"]})});e.xui_reqds.setRows(c).setValue(g.join(";"))}());(function(){c=[];f={};g=[];xui.arr.each(a.responseDataTarget,function(L){f[L.type+"-"+(L.name||"")]=L.path});if(b in f){g.push(b)}xui.each(l,function(L){if(!L||!L.Class||!L.Class["xui.DataBinder"]){return}j=L.getName();b="databinder-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"databinder",cells:["数据绑定",j,f[b]||""]})});var u=[],E=false;xui.each(l,function(L){if(!L||!L.Class||!L.Class["xui.absContainer"]||L.getFormElements().isEmpty()){return}j=L.getAlias();b="form-"+j;if(b in f){g.push(b);E=true}u.push({id:b,bindertype:"form",cells:[j,f[b]||"data","表单"]})});if(u.length>0){c.push({id:"allform",bindertype:"form",iniFold:!E,cells:["<b>表单</b>"],sub:u})}var q=[],m=false;xui.each(l,function(L){if(!L||!L.Class||!L.Class["xui.UI.TreeGrid"]){return}j=L.getAlias();b="treegrid-"+j;if(b in f){g.push(b);m=true}q.push({id:b,bindertype:"treegrid",cells:[j,f[b]||"data","Grid"]})});xui.each(l,function(L){if(!L||!L.Class||!L.Class["xui.UI.Gallery"]){return}j=L.getAlias();b="gallery-"+j;if(b in f){g.push(b)}q.push({id:b,bindertype:"gallery",cells:[j,f[b]||"data","Gallery"]})});xui.each(l,function(L){if(!L||!L.Class||!L.Class["xui.UI.PageBar"]){return}j=L.getAlias();b="pagebar-"+j;if(b in f){g.push(b)}q.push({id:b,bindertype:"pagebar",cells:[j,f[b]||"size","设置最大记录数"]})});if(q.length>0){c.push({id:"grid",iniFold:!m,bindertype:"grid",cells:["<b>Grid列表</b>"],sub:q})}var B=[],s=false;xui.each(l,function(L){if(!L||!L.Class||!L.Class["xui.UI.Tabs"]||!L.Class["xui.UI.Tabs"]){return}j=L.getAlias();b="tabs-"+j;if(b in f){g.push(b);s=true}B.push({id:b,bindertype:"tabs",cells:[j,f[b]||"data","动态Tabs"]})});if(B.length>0){c.push({id:"tabs",iniFold:!s,bindertype:"tabs",cells:["<b>Tabs导航</b>"],sub:B})}var x=[],H=false;xui.each(l,function(L){if(!L||!L.Class||!L.Class["xui.UI.TreeView"]){return}j=L.getAlias();b="treeview-"+j;if(b in f){g.push(b);H=true}x.push({id:b,bindertype:"treeview",cells:[j,f[b]||"data","绑定树形"]})});if(x.length>0){c.push({id:"treeview",iniFold:!H,bindertype:"treeview",cells:["<b>Tree树形</b>"],sub:x})}var I=[],F=false;xui.each(l,function(L){if(!L||!L.Class||!L.Class["xui.UI.FusionChartsXT"]){return}j=L.getAlias();b="fchart-"+j;I.push({id:b,bindertype:"fchart",cells:[j,f[b]||"data","绑定统计图"]});if(b in f){g.push(b);F=true}var M="fcharttrendlines-"+j;I.push({id:M,bindertype:"fcharttrendlines",cells:[j,f[M]||"data","分析线"]});if(M in f){g.push(M);F=true}M="fchartdataset-"+j;I.push({id:M,bindertype:"fchartdataset",cells:[j,f[M]||"data","数据集合"]});if(M in f){g.push(M);F=true}M="fchartcategories-"+j;I.push({id:M,bindertype:"fchartcategories",cells:[j,f[M]||"data","数据分类"]});if(M in f){g.push(M);F=true}});if(I.length>0){c.push({id:"fchart",iniFold:!F,bindertype:"fchart",cells:["<b>统计图</b>"],sub:I})}var D=[],J=false;xui.each(l,function(L){if(!L||!L.Class||!L.Class["xui.UI.SVGPaper"]){return}j=L.getAlias();b="svgpagper-"+j;if(b in f){g.push(b);J=true}D.push({id:b,bindertype:"svgpaper",cells:[j,f[b]||"data","SVG图形"]})});if(D.length>0){c.push({id:"svgpagper",iniFold:!J,bindertype:"svgpagper",cells:["<b>SVG图形</b>"],sub:D})}var w=[],o=false;xui.each(l,function(L){if(!L||!L.Class||!L.Class["xui.absList"]){return}j=L.getAlias();b="list-"+j;if(b in f){g.push(b);o=true}w.push({id:b,bindertype:"list",cells:[j,f[b]||"data","List字典表"]})});if(w.length>0){c.push({id:"list",iniFold:!o,bindertype:"list",cells:["<b>List字典表</b>"],sub:w})}var G=[],C=false;xui.each(l,function(L){if(!L||!L.Class||!L.Class["xui.UI.Dialog"]){return}j=L.getAlias();b="component-"+j;if(b in f){g.push(b)}G.push({id:b,bindertype:"component",cells:[j,f[b]||"data","Dialog"]})});xui.each(l,function(L){if(!L||!L.Class||!L.Class["xui.UI.Block"]){return}j=L.getAlias();b="component-"+j;if(b in f){g.push(b);C=true}G.push({id:b,bindertype:"component",cells:[j,f[b]||"data","Block"]})});if(G.length>0){c.push({id:"component",iniFold:!C,bindertype:"component",cells:["<b>动态重绘</b>"],sub:G})}xui.each(l,function(L){if(!L||!L.Class||!L.Class["xui.Module"]){return}j=L.getName();b="module-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"module",cells:[j,"模块",f[b]||"data."+j]})});var A=[],K=false;xui.each(l,function(L){if(!L||!L.Class||!L.Class["xui.absContainer"]||L.getFormElements().isEmpty()){return}j=L.getAlias();b="expression-"+j;if(b in f){g.push(b);K=true}A.push({id:b,bindertype:"expression",cells:[j,L.key,f[b]||"data"]})});if(A.length>0){c.push({id:"expression",iniFold:!K,bindertype:"expression",cells:["<b>表达式</b>"],sub:A})}var r=[];b="log-console.log";r.push({id:b,bindertype:"log",cells:["console.log",f[b]||""]});if(b in f){g.push(b)}b="alert-alert";r.push({id:b,bindertype:"alert",cells:["alert",f[b]||""]});if(r.length>0){c.push({id:"log",bindertype:"log",cells:["","","本地功能"],sub:r})}e.xui_rsptarget.setRows(c).setValue(g.join(";"))}());(function(){c=[];f={};g=[];xui.arr.each(a.responseCallback,function(m){f[m.type+"-"+(m.name||"")]=m.type});if(n&&n.Instance&&n.Instance.functions){xui.each(n.Instance.functions,function(m,o){j=o;b="host-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"host",cells:["page",j]})})}xui.each(SPA.curProjectConfig.$GlobalFunctions,function(m,o){j=o;b="global-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"global",cells:["global",j]})});e.xui_rspfun.setRows(c).setValue(g.join(";"))}());e.m_reqparams.setProperties("value",a.queryArgs);e.m_cookies.setProperties("value",a.fakeCookies);if(a.queryHeader&&!xui.isEmpty(a.queryHeader)){e.m_header.setProperties("value",a.queryHeader)}e.m_options.setProperties("value",a.queryOptions);e.updateRequestData(a.queryArgs,a.requestDataSource)},getDataFromEditor:function(){var d=this,c=d._oldprop,e={requestDataSource:c.requestDataSource,responseDataTarget:c.responseDataTarget,responseCallback:c.responseCallback},a,b;e.queryURL=d.xui_url.getValue();e.queryAsync=d.xui_asyn.getValue();e.autoRun=d.autoRun.getValue();e.queryMethod=d.xui_method.getValue();e.queryUserName=d.xui_username.getValue();e.queryPassword=d.xui_password.getValue();e.isAllform=d.isAllform.getValue();e.proxyType=d.xui_proxytype.getValue();e.requestType=d.xui_reqtype.getValue();e.responseType=d.xui_rsptype.getValue();e.oAuth2Token=d.xui_token.getValue();if(d.xui_reqds.getRootNode()){a=[];xui.arr.each(d.xui_reqds.getRows(),function(f){if(f._selected){a.push({type:f.bindertype,name:f.cells[0].value,path:f.cells[1].value})}});e.requestDataSource=a}if(d.xui_rsptarget.getRootNode()){a=[];xui.arr.each(d.xui_rsptarget.getRows(),function(f){if(f.sub&&f.sub.length>0){xui.arr.each(f.sub,function(g){if(g._selected){a.push({type:g.bindertype,name:g.cells[0].value,path:g.bindertype=="log"||g.bindertype=="alert"?"":g.cells[1].value})}})}else{if(f._selected){a.push({type:f.bindertype,name:f.cells[0].value,path:f.bindertype=="log"||f.bindertype=="alert"?"":f.cells[1].value})}}});e.responseDataTarget=a}if(d.xui_rspfun.getRootNode()){a=[];xui.arr.each(d.xui_rspfun.getRows(),function(f){if(f._selected){a.push({type:f.bindertype,name:f.cells[1].value})}});e.responseCallback=a}b=d.m_reqparams.getValue(true);e.queryArgs=b||{};b=d.m_cookies.getValue(true);e.fakeCookies=b||{};b=d.m_header.getValue(true);e.queryHeader=b||{};b=d.m_options.getValue(true);if(b&&b.header&&xui.isHash(b.header)){xui.merge(e.queryHeader,b.header);delete b.header}e.queryOptions=b||{};return e},updateRequestData:function(c,f){var g=this;c=c?xui.clone(c):g.m_reqparams.getValue(true);f=f||[];if(!f.length){xui.arr.each(g.xui_reqds.getRows(),function(q){if(q._selected){f.push({type:q.bindertype,name:q.cells[0].value,path:q.cells[1].value})}})}if(f&&f.length){for(var d in f){var b=f[d],m,l,n;switch(b.type){case"databinder":if((m=g._host[b.name])&&m.Class["xui.DataBinder"]){if(!m.updateDataFromUI()){return}else{n=(b.path||"").split(".");if(xui.isHash(l=xui.get(c,n))){xui.merge(l,m.getData())}else{xui.set(c,b.path.split("."),m.getData())}}}break;case"pagebar":if(m=g._host[b.name]){var e={pageSize:m.getPageCount(),pageIndex:m.getPage()};if(xui.isHash(l=xui.get(c,n))){xui.merge(l,e)}else{xui.set(c,n,e)}}break;case"sTagVar":if(g.sTagVar){var j={};xui.each(g.sTagVar,function(q,o){j["s"+o]=q});xui.set(c,n,j)}break;case"treegrid":if(m=g._host[b.name]){n=(b.path||m.getUidColumn()).split(".");xui.set(c,n,m.getUIValue())}break;case"treegridrow":if(m=g._host[b.name]){n=(b.path||m.getUidColumn()).split(".");if(m.getActiveRow("map")){xui.set(c,n,m.getActiveRow("map")[m.getUidColumn()])}}break;case"treeview":if(m=g._host[b.name]){n=(b.path||"").split(".");xui.set(c,n,m.getUIValue());xui.set(c,n+"Caption",m.getUICationValue())}break;case"fchart":if(m=g._host[b.name]){n=(b.path||"").split(".");xui.set(c,n,m.getUIValue());xui.set(c,n+"Caption",m.getUICationValue())}break;case"fchartcategories":if(m=g._host[b.name]){n=(b.path||"").split(".");xui.set(c,n,m.getUIValue());xui.set(c,n+"Caption",m.getUICationValue())}break;case"fchartdataset":if(m=g._host[b.name]){n=(b.path||"").split(".");xui.set(c,n,m.getUIValue());xui.set(c,n+"Caption",m.getUICationValue())}break;case"fcharttrendlines":if(m=g._host[b.name]){n=(b.path||"").split(".");xui.set(c,n,m.getUIValue());xui.set(c,n+"Caption",m.getUICationValue())}break;case"form":if((m=g._host[b.name])&&m.Class["xui.absContainer"]&&m.getFormElements().size()&&m.getRootNode()){n=(b.path||"").split(".");if(xui.isHash(l=xui.get(c,n))){xui.merge(l,m.getFormValues())}else{xui.set(c,n,m.getFormValues())}}break;case"module":if((m=g._host[b.name])&&m.Class["xui.Module"]){n=(b.path||b.name).split(".");xui.set(c,n,m.getValue(true))}break}}}var a=xui.stringify(c);if(xui.Coder){a=xui.Coder.formatText(a)}g.xui_reqtext.setValue(a)},_m_reqparams_onchange:function(a){this.updateRequestData()},_xui_reqds_onchange:function(){this.updateRequestData()},_xui_reqds_bcellupdated:function(){this.updateRequestData()},_xui_ui_htmlbutton3_onclick:function(){var c=this,e=c.getDataFromEditor();var a=e.queryURL||"";if(/\s*\{xui\.constant\.[\w]+\}\s*/.test(a)){a=xui.adjustVar(a,{xui:{constant:SPA.curProjectConfig.$ConstantData}})}e.queryURL=a;if(!e.queryURL){xui.alert(xui.adjustRes("$inline.required"),xui.adjustRes(c.xui_url.getLabelCaption()),function(){c.xui_url.activate()});return}delete e.responseDataTarget;delete e.responseCallback;var b=new xui.APICaller(),d=function(g,f){console.log(g,f);if(xui.isObj(f)){f=xui.stringify(f);if(xui.Coder){f="Response Object:\n\r\n\r"+xui.Coder.formatText(f)}}b.destroy();window.alert(f)};b.setHost(c._host);b.setProperties(e);b.invoke(function(f){d("Response Sucessful",f)},function(f){d("Response Error",f)})},_xui_ui_dialog2_beforeclose:function(b){var a=this,c=a.getDataFromEditor();a.fireEvent("onchange",[c]);delete a._oldprop},_ontrows:function(b,f,c,d,a){this.updateRequestData()},_ontrows2:function(b,f,c,d,a){this.updateRequestData()},_acu:function(e,b,d){if(!b._row._selected&&d.value){var c=e.boxing();var a=c.getValue(true);a.push(b._row.id);xui.arr.removeDuplicate(a);xui.arr.removeValue(a,"");c.setValue((a&&a.length)?a.join(";"):null)}this.updateRequestData()},_tg_beforerowactive:function(){return false},_xui_ui_comboinput207_aftervalueset:function(d,a,b,c,n){var j=this,g=j.xui_reqtype.getValue(),e=j.xui_method.getValue(),f="FORM,JSON,XML,SOAP".split(","),l="auto,GET,POST,PUT,DELETE".split(",");switch(b){case"JSONP":f.pop();f.pop();l.pop();l.pop();l.pop();j.xui_reqtype.setItems(f);j.xui_method.setItems(l);if(g=="XML"||g=="SOAP"){j.xui_reqds.setValue("FORM")}if(e=="POST"||g=="PUB"||g=="DELETE"){j.xui_method.setValue("auto")}break;case"XDMI":f.pop();f.pop();l.pop();l.pop();j.xui_reqtype.setItems(f);j.xui_method.setItems(l);if(g=="XML"||g=="SOAP"){j.xui_reqds.setValue("FORM")}if(g=="PUB"||g=="DELETE"){j.xui_method.setValue("auto")}break;default:j.xui_reqtype.setItems(f);j.xui_method.setItems(l)}}}});xui.Class("RAD.FunctionsEditor","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"xui_dlg").setLeft("0.8333333333333334em").setTop("0.8333333333333334em").setWidth("50em").setHeight("24.166666666666668em").setCaption("$(RAD.designer.Functions Configuration)").setMinBtn(false).setModal(true).beforeClose("_xui_dlg_beforeclose"));c.xui_dlg.append(xui.create("xui.UI.Block").setHost(c,"xui_main").setDock("fill").setLeft("35.833333333333336em").setTop("0.8333333333333334em").setBorderType("inset"));c.xui_main.append(xui.create("xui.UI.TreeGrid").setHost(c,"xui_tg_funs").setDirtyMark(false).setShowDirtyMark(false).setLeft("0em").setTop("0em").setRowNumbered(true).setEditable(true).setRowHandler(false).setHeader([{id:"id",caption:"id",width:"6em",type:"input"},{id:"desc",caption:"desc",width:"10em",type:"input"},{id:"params",caption:"parameters",width:"8em",type:"label",cellStyle:"cursor:pointer"},{id:"actions",caption:"actions",width:"8em",type:"label",cellStyle:"cursor:pointer"},{id:"function",caption:"function",flexSize:true,width:"10em",type:"label"}]).setTagCmds([{id:"add",imageClass:"xuicon xui-uicmd-add",tips:"Add a function",location:"right",pos:"header"},{id:"delete",imageClass:"xuicon xui-uicmd-close",tips:"Delete this function",location:"right",pos:"row"}]).setActiveMode("none").setHotRowMode("hide").beforeIniEditor("_xui_ui_treegrid3_beforeeditor").onInitHotRow("_xui_tg_funs_oninithotrow").beforeHotRowAdded("_xui_ui_treegrid3_beforehotrowadded").onCmd("_xui_ui_treegrid3_oncmd").onClickCell("_xui_tg_funs_onclickcell"));a(xui.create("xui.UI.Block").setHost(c,"xui_div_args").setLeft("0.8333333333333334em").setTop("25.833333333333332em").setWidth("35em").setHeight("12.5em").setTabindex(10).setShadow(true).setBorderType("flat"));c.xui_div_args.append(xui.create("xui.UI.TreeGrid").setHost(c,"xui_tg_args").setDirtyMark(false).setShowDirtyMark(false).setDockMargin({left:0,top:0,right:0,bottom:36}).setLeft("0em").setTop("0em").setRowNumbered(true).setEditable(true).setRowHandlerWidth("2em").setRowHandler(false).setHeader([{id:"id",caption:"id",width:"6em",type:"input"},{id:"type",caption:"type",width:"10em",type:"listbox",cellStyle:"",editorListItems:[{id:"String",caption:"$(RAD.action.var.String)"},{id:"Number",caption:"$(RAD.action.var.Number)"},{id:"Boolean",caption:"$(RAD.action.var.Boolean)"},{id:"Hash",caption:"$(RAD.action.var.Hash)"},{id:"Array",caption:"$(RAD.action.var.Array)"},{id:"Object",caption:"$(RAD.action.var.Object)"},{id:"Function",caption:"$(RAD.action.var.Function)"},{id:"Event",caption:"$(RAD.action.var.Event)"}]},{id:"desc",caption:"desc",flexSize:true,width:"10em",type:"input"}]).setTagCmds([{id:"add",itemClass:"xuicon xui-uicmd-add",tips:"Add a function",pos:"header"},{id:"delete",itemClass:"xuicon xui-uicmd-close",tips:"Delete this function",pos:"row"}]).setActiveMode("none").setHotRowMode("hide").onInitHotRow("_xui_tg_args_oninithotrow").beforeHotRowAdded("_xui_ui_treegrid3_beforehotrowadded").onCmd("_xui_ui_treegrid3_oncmd").beforeIniEditor("_xui_ui_treegrid3_beforeeditor"));c.xui_div_args.append(xui.create("xui.UI.Button").setHost(c,"xui_ui_button14").setLeft("13.333333333333334em").setTop("9.833333333333334em").setWidth("7.5em").setImageClass("spafont spa-icon-cancel").setCaption("Cancel").onClick("_xui_ui_button14_onclick"));c.xui_div_args.append(xui.create("xui.UI.Button").setHost(c,"xui_ui_button15").setLeft("24.166666666666668em").setTop("9.833333333333334em").setWidth("7.5em").setImageClass("spafont spa-icon-ok").setCaption("OK").onClick("_xui_ui_button15_onclick"));return b},_xui_ui_treegrid3_oncmd:function(c,j,f,d,g){var b=this,a=c.boxing();if(f=="add"){a.addHotRow("id")}else{if(f=="delete"){a.removeRows(j.id)}}},_xui_ui_treegrid3_beforeeditor:function(f,a,b,d,e){if(a._col.id!="id"){var c=a._row.cells[0];if(!c.value){xui.asyRun(function(){if(a._row){f.boxing().focusCell(c)}});return false}}},_xui_ui_treegrid3_beforehotrowadded:function(b,d,j){var f=this,g=b.boxing(),a=d.id,m=g.getRows();if(!a){return false}for(var e=0,c=m.length;e<c-1;e++){if(m[e].cells[0].value==a){xui.message("The id must be an unique string.");return false}}return true},_xui_tg_funs_oninithotrow:function(a){return["","","( )",{caption:this._makeActionCap()},{caption:this._makeFunCap()}]},_xui_tg_args_oninithotrow:function(a){return["",{value:"String",caption:"$(RAD.action.var.String)"},""]},_makeActionCap:function(a){return"&lt;"+(xui.isArr(a)?a.length:0)+" "+xui.adjustRes("$RAD.designer.actions")+">"},_makeFunCap:function(a){return"&lt;"+xui.adjustRes("$RAD.action."+(a?"Function":"None"))+">"},_makeParamCap:function(f){var c=this,e,d=[];for(var b=0,a=f.length;b<a;b++){d.push(f[b].id)}return"( "+d.join(", ")+" )"},_xui_ui_button14_onclick:function(b,d,f,c){var a=this;a.xui_div_args.getRoot().hide()},events:{onReady:"_page_onready",onModulePropChange:"_onModulePropChange"},_page_onready:function(a,b){a.xui_div_args.setVisibility("hidden")},_onModulePropChange:function(b){var d=b.properties;if(!("type" in d)){return}var c=d.type=="page"?"page":"global",a=[];b._initFuns(c,d.functions)},_initFuns:function(type,functions){var ns=this,cells,funs=[];ns.xui_tg_funs.removeAllRows();if(type=="page"){ns.xui_dlg.setCaption("$(RAD.designer.Module Functions)")}if(functions&&xui.isHash(functions)&&!xui.isEmpty(functions)){xui.each(functions,function(v,k){cells=[];cells[0]=k;cells[1]=v.desc||"";cells[2]={tagVar:xui.clone(v.params),value:ns._makeParamCap(v.params)};var fun=null;xui.arr.each(v.actions,function(o){if(o.script){eval("var cfun="+o.script);fun=cfun;return false}});xui.arr.each(v.actions,function(o){if(typeof o=="function"){fun=o;return false}});var actions=v&&xui.clone(v.actions,function(o,i){return typeof o!="function"});cells[3]={tagVar:{actions:actions,"return":v&&v["return"]},value:ns._makeActionCap(actions)};cells[4]={tagVar:fun,value:ns._makeFunCap(fun)};funs.push(cells)})}ns.xui_tg_funs.insertRows(funs);ns.xui_tg_args.updateGridValue()},_getArgsVar:function(a){var b;switch(a){case"String":b="";break;case"Number":b="";break;case"Boolean":b="";break;case"Hash":b={};break;case"Array":b=[];break;case"Object":b={};break;case"Function":b="";break;case"Event":b="e";break}return b},_xui_tg_funs_onclickcell:function(b,a,A,g){var E=this,o=b.boxing(),f=o.getColByCell(a),q=E.xui_tg_args;if(f.id!="id"){var u=a._row.cells[0];if(!u.value){xui.asyRun(function(){if(a._row){b.boxing().focusCell(u)}});return false}}if(f.id=="params"){E._cell_in_pop=a;var c=E.xui_div_args,w=c.getRoot(),j=[];q.removeAllRows();if(a.tagVar&&xui.isArr(a.tagVar)&&a.tagVar.length){xui.arr.each(a.tagVar,function(e){j.push([e.id,e.type||"String",e.desc||""])})}q.setRows(j);w.pop(g)}else{if(f.id=="actions"){var r=a.tagVar,B=a._row.cells[2].tagVar,d=E.properties.page,s=true;xui.showCom("RAD.ActionsEditor",function(){var I=this.properties={};I.parent=d;I.actionConf=r;I.cls=d._cls;I.className=d._className;if(CONF.getClientMode()=="project"&&SPA.treebarCls){I.pages=xui.clone(SPA.treebarCls.getItems(),true)}var F=[];if(I.cls){var G=function(M,L){var N=L.properties,J=L.key.split(".").pop(),K;if(M=="module"){K=L.getAlias()+" ( "+L.key+" )"}else{K=L.alias+" ( "+J+" )";if(N.name||N.desc){K+=" <br />[ "+(N.name||"")+(N.name?" - ":"")+(N.desc||"")+" ]"}if(N.caption||N.labelCaption){K+=" [ "+(N.caption||N.labelCaption)+" ]"}}return K};var H={},e=function(L,N,K){var T=arguments.callee,P=(L["xui.Module"]||(L.moduleClass&&L.moduleXid))?"module":"control";L=(P=="module"&&!L["xui.Module"])?xui.Module.getInstance(L.moduleClass,L.moduleXid):L;var Q=G(P,L),S=P=="module"?{imageClass:"xuicon spafont spa-icon-page"}:K[L.box.KEY],M,O;var R={id:L.alias,caption:Q,image:S&&S.image||"",imagePos:S&&S.imagePos||"",imageClass:S&&S.imageClass||"","0":L,_type:P};N.push(R);if(P=="module"){return}if(L.children&&L.children.length){var J=[];R.sub=J;xui.arr.each(L.children,function(U){T.call(null,U[0],J,K)})}};e(d.canvas.get(0),F,CONF.mapWidgets);if(!F[0].sub){F[0].sub=[]}xui.each(d.$host,function(J,L){if(L=="$inDesign"||!J["xui.absBox"]||!J.n0){return}var O=J.get(0),Q=CONF.mapWidgets,P,K;if(O["xui.Module"]?O.getUIComponents().isEmpty():O.box["xui.UI"]?O.box.$initRootHidden:true){if(-1==xui.arr.subIndexOf(F[0].sub,"id",O.alias)){var N=O["xui.Module"]?"module":"control",K=N=="module"?{imageClass:"xuicon spafont spa-icon-page"}:Q[O.box.KEY],M,P={id:O.alias,caption:G(N,O),image:K&&K.image||"",imagePos:K&&K.imagePos||"",imageClass:K&&K.imageClass||"","0":O,_type:N};F[0].sub.push(P)}}});I.controls=F[0].sub||[]}I.argsdoc=[];I.args=[];I.argsvar=[];xui.arr.each(B,function(J){I.args.push(J.id);I.argsdoc.push(J.id+" : "+J.type+(J.desc?", "+J.desc:""));I.argsvar.push(E._getArgsVar(J.type))});this.setEvents({onDirty:function(M,K,J){var L={tagVar:{}};if(J){if(xui.isArr(J)){L.tagVar.actions=J}else{L.tagVar=J}}else{L.tagVar=J}L.caption=E._makeActionCap(L.tagVar&&L.tagVar.actions);o.updateCell(a,L)}})})}else{if(f.id=="function"){var D=a.tagVar,l=(D?xui.fun.body(D):"").replace(/^(\s*\n)*/,"").replace(/(\n\s*)*$/,""),C=a._row.cells[0].value,x=a._row.cells[1].value,B=a._row.cells[2].tagVar,n=[],m;xui.arr.each(B,function(e){n.push(e.id+"/*"+e.type+(e.desc?": "+e.desc:"")+"*/")});m=("// "+C+(x?": "+x:"")+"\n")+("// [this]: "+(E.properties.type=="page"?"the module":"global")+"\n")+"function("+n.join(", ")+"){\n"+l+"\n}";xui.getModule("funEditor",function(){this.host=E;this.setProperties({imageClass:"spafont spa-icon-function",caption:"FUNCTION => "+C,text:m,head_readonly:3,tail_readonly:1,onOK:function(G){var e=G.properties.result.code;if(xui.fun.body(e).replace(/\s/g,"")==""){e=null}var F={tagVar:e?xui.unserialize(e):null,caption:E._makeFunCap(e)};o.updateCell(a,F)}},true);this.show()})}}}},_xui_ui_button15_onclick:function(f,o,a,s){var r=this,c=r.xui_tg_funs,b=r.xui_tg_args,g=r._cell_in_pop,w=b.getRows("data"),u,d,q=[],m=[];for(var n=0,j=w.length;n<j;n++){u=w[n].cells;if(u[0].value){d={id:u[0].value,type:u[1].value,desc:u[2].value||""};q.push(d.id);m.push(d)}}c.updateCell(g,{value:r._makeParamCap(m),tagVar:m},false,false);delete r._cell_in_pop;r.xui_div_args.getRoot().hide()},_xui_dlg_beforeclose:function(a){this.fireData()},fireData:function(b){var g=this,a=g.xui_tg_funs,j,d={};if(b||g.xui_tg_funs.isDirtied()){var l=g.xui_tg_funs.getRows(),c,f,e;if(l.length){xui.arr.each(l,function(n,m){j=n.cells;c=xui.get(j[3],["tagVar","actions"]);f=j[4].tagVar;if(!c&&!f){return}if(!c){c=[]}c.push(f);e=j[3].tagVar&&j[3].tagVar["return"];if(c&&xui.isArr(c)&&c.length){d[j[0].value]={desc:j[1].value,params:xui.clone(j[2].tagVar)||[],actions:xui.clone(c)||{}};if(!f&&xui.isSet(e)){d[j[0].value]["return"]=e}}})}g.fireEvent("onOK",[d])}return d}}});xui.Class("RAD.InteractionMap","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"xui_ui_dialog1").setLeft("0em").setTop("0em").setWidth("66.66666666666667em").setHeight("37.5em").setCaption("$(RAD.inter.Interaction Map)").setMinBtn(false).setModal(true).beforeClose("_close"));c.xui_ui_dialog1.append(xui.create("xui.UI.Block").setHost(c,"xui_ui_block2").setDock("fill").setLeft("16.666666666666668em").setTop("4.166666666666667em").setBorderType("inset"));c.xui_ui_block2.append(xui.create("xui.UI.TreeGrid").setHost(c,"grid").setDisableHoverEffect("CELL").setLeft("0em").setTop("0em").setRowHandler(false).setColSortable(false).setHeader([{id:"name",caption:"$(RAD.inter.Name)",flexSize:true,width:"10em",type:"label"},{id:"cat",caption:"$(RAD.inter.Category)",flexSize:true,width:"10em",type:"label"},{id:"action",caption:"$(RAD.inter.Action)",flexSize:true,width:"10em",type:"label"},{id:"cond",caption:"$(RAD.inter.Conditions)",width:"6em",type:"label",cellStyle:"text-align:center"},{id:"asyn",caption:"$(RAD.inter.Asyn)",width:"4em",type:"checkbox"},{id:"stop",caption:"$(RAD.inter.Abort)",width:"4em",type:"checkbox"}]).setTagCmds([{id:"add",itemClass:"xuicon xui-uicmd-add",tips:"Add an event handler"}]).setActiveMode("none").setTreeMode("infirstcell").onCmd("_grid_oncmd"));return b},refreshInterMap:function(g){var l=this;if(g){l._page=g}g=l._page;var j=[],b=CONF.mapWidgets,m,e=function(s){var u=s.properties,r=s["xui.Module"]?"module":"control",o=s.key.split(".").pop(),q;if(r=="module"){q=s.getAlias()+" ( "+s.key+" )"}else{q=s.alias+" ( "+o+" )";if(u.name||u.desc){q+=" <span style='color:#888;font-style: italic;font-weight:normal;'>[ "+(u.name||"")+(u.name?" - ":"")+(u.desc||"")+" ]</span>"}if(u.caption||u.labelCaption||u.html){q+=" <span style='color:#888;font-style: italic;font-weight:normal;'>[ "+(u.caption||u.labelCaption||u.html).substr(0,10)+" ]</span>"}}return q},c=function(w,r,q,o){var s=[];if(!q){return false}if(q.actions){q=q.actions}if(!xui.isArr(q)){q=[q]}xui.arr.each(q,function(x,B){if(x){var A=xui.isStr(x),D=RAD.ActionsEditor.prototype.CAPMAP,E=D.actiongroup,C=D.action;s.push({id:w+":"+B,caption:A?("<span style='font-weight: normal;' class='xuicon spafont spa-icon-function'></span> "+x+" [code ] "):null,group:A,cells:A?null:[" <span style='font-weight: normal;' class='xuicon spafont spa-icon-action'></span> "+(x.desc||""),"$(RAD.action."+E[x.type=="page"?"page":x.type=="control"?"control":x.type=="module"?"module":x.type=="other"?(x.type+":"+x.target):"-"]+")"+(x.type=="control"||x.type=="module"?(" - "+x.target):""),"$(RAD.action."+C[x.method]+")",x.conditions&&x.conditions.length||"",("timeout" in x),x["return"]===false],tagCmds:A?l._actionCmds2:l._actionCmds})}});if(s.length){var u=r.charAt(0)=="b"?"$(RAD.designer.eventbfrtag)":r.charAt(0)=="a"?"$(RAD.designer.eventafttag)":"$(RAD.designer.eventontag)";return{id:w,caption:" "+u+"<span style='font-weight: normal;' class='xuicon spafont  spa-icon-arr'></span>"+RAD.EditorTool.getEventName(o,r,true)+" - <span style='color:#888;font-style: italic;font-weight:normal;'>"+(xui.get(RAD.EditorTool.getDoc(o+".prototype."+r,null,true),["$desc"])||"").split(".")[0]+"</span>",group:true,rowClass:"xui-treegrid-cells1-alt",iniFold:false,tagCmds:l._eventCmds,sub:s}}else{return null}},n=[],a,f=l.grid.getSubNode("SCROLL22"),d=f.get(0)&&f.scrollTop();a=[];xui.each(xui.get(g._cls,["Instance","events"]),function(r,q){if(q=c("-page:"+q,q,r,"xui.Module")){a.push(q)}});if(a.length){n.push({group:true,rowClass:"xui-treegrid-cells1-alt",iniFold:false,id:"-page",caption:"<span style='font-weight: normal;' class='xuicon spafont spa-icon-page'></span> $(RAD.action.var.Current Page) ( "+g._className+" )",tagVar:g,tagCmds:l._pageCmds,sub:a})}xui.each(g.$host,function(q,s){if(s=="$inDesign"||!q["xui.absBox"]||!q.n0){return}var u=q.get(0),o=u.key.split(".").pop(),r=b[u.box.KEY];a=[];xui.each(u.getEvents(),function(x,w){if(!x){return}if(w=c(u.alias+":"+w,w,x,u.box.KEY)){a.push(w)}});if(a.length){n.push({group:true,rowClass:"xui-treegrid-cells1-alt",iniFold:false,id:u.alias,caption:"<span class='"+(r&&r.imageClass||"")+"'></span> "+e(u),tagVar:u,tagCmds:l._pageCmds,sub:a})}});l.grid.setRows(n);if(d){l.grid.getSubNode("SCROLL22").scrollTop(d)}},events:{onReady:"_page_onready"},_page_onready:function(a,c){var b=this;b._pageCmds=[{id:"add1",itemClass:"xuicon xui-uicmd-add",tips:"Add an event handler"}];b._eventCmds=[{id:"edit2",itemClass:"xuicon xui-uicmd-popbox",tips:"Edit this event handler"},{id:"remove2",itemClass:"xuicon xui-uicmd-close",tips:"Remove this event handler"}];b._actionCmds=[{id:"edit3",itemClass:"xuicon xui-uicmd-select",tips:"Edit this action"},{id:"remove3",itemClass:"xuicon xui-uicmd-close",tips:"Remove this action"}];b._actionCmds2=[{id:"none",itemClass:"xuicon xui-icon-placeholder"},{id:"remove3",itemClass:"xuicon xui-uicmd-close",tips:"Remove this action"}]},_close:function(){this._page._refreshProfileGrid(null,null,true)},_grid_oncmd:function(c,w,n,l,a){var o=this,m=o._page,b=c.boxing(),r=RAD.Designer.prototype.$showActionEditor,g=w?w.id.split(":"):["-page",null,0],q=g[0]==="-page",j=(q?o._page.canvas:o._page.$host[g[0]]).get(0),f=g[1],u="$(RAD.action."+(q?"Page":j["xui.Module"]?"Module":"Control")+" Action) => "+(q?"":j.alias+" - ")+RAD.EditorTool.getEventName(q?"xui.Module":j.key,f,true),d=g[2];var s=function(){o.refreshInterMap()};if(w){switch(n){case"add1":xui.getModule("RAD.EventPicker",function(e){this.refreshList(m,q?"-page":j.alias);this.setEvents({onSel:function(A,x){q=A==="-page";j=(q?o._page.canvas:o._page.$host[A]).get(0);u="$(RAD.action."+(q?"Page":j["xui.Module"]?"Module":"Control")+" Action) => "+(q?"":j.alias+" - ")+RAD.EditorTool.getEventName(q?"xui.Module":j.key,x,true);r(m,j,x,u,null,null,s,c,null)}});this.show()});break;case"edit2":r(m,j,f,u,null,null,s,c,null);break;case"remove2":xui.confirm(xui.getRes("RAD.designer.confirmdel"),xui.getRes("RAD.action.Do you wanna delete the event handler")+"?",function(){if(q){var e=xui.get(m._cls,["Instance","events"]);if(!e){xui.set(m._cls,["Instance","events"],e={})}delete e[f];m._canvaseventdirty=true}else{if(j["xui.Module"]){j.events[f]=null;m._dirty=1}else{j[f]=null;m._dirty=1}}b.removeRows(w)});break;case"edit3":r(m,j,f,u,d,null,s,c,null);break;case"remove3":xui.confirm(xui.getRes("RAD.designer.confirmdel"),xui.getRes("RAD.action.Do you wanna delete the action")+"?",function(){var e;if(q){var x=xui.get(m._cls,["Instance","events"]);if(!x){xui.set(m._cls,["Instance","events"],x={})}e=x[f];var A=e.actions?e.actions:e;xui.arr.removeFrom(A,d);m._canvaseventdirty=true}else{if(j["xui.Module"]){e=j.events[f];var A=e.actions?e.actions:e;xui.arr.removeFrom(A,d);m._dirty=1}else{e=j[f];var A=e.actions?e.actions:e;xui.arr.removeFrom(A,d);m._dirty=1}}b.removeRows(w)});break}}else{switch(n){case"add":xui.getModule("RAD.EventPicker",function(e){this.refreshList(m,"-page");this.setEvents({onSel:function(A,x){q=A==="-page";j=(q?o._page.canvas:o._page.$host[A]).get(0);u="$(RAD.action."+(q?"Page":j["xui.Module"]?"Module":"Control")+" Action) => "+(q?"":j.alias+" - ")+RAD.EditorTool.getEventName(q?"xui.Module":j.key,x,true);r(m,j,x,u,null,null,s,c,null)}});this.show()})}}}}});xui.Class("RAD.AnimationConf","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"xui_ui_dialog1").setLeft("0em").setTop("0em").setWidth("66.66666666666667em").setHeight("46.666666666666664em").setCaption("Animation editor").setMinBtn(false).setModal(true));c.xui_ui_dialog1.append(xui.create("xui.UI.Panel").setHost(c,"xui_ui_panel3").setDock("right").setLeft("40.833333333333336em").setTop("8.333333333333334em").setWidth("18.75em").setCaption("Frame Setting").setBorderType("none"));c.xui_ui_panel3.append(xui.create("xui.UI.Block").setHost(c,"xui_ui_block35").setDock("top").setLeft("2.5em").setTop("4.166666666666667em").setHeight("8.25em").setBorderType("none").setOverflow("hidden"));c.xui_ui_block35.append(xui.create("xui.UI.ComboInput").setHost(c,"c_type").setName("type").setShowDirtyMark(false).setLeft("0.8333333333333334em").setTop("0.8333333333333334em").setWidth("16.583333333333332em").setLabelSize("6em").setLabelCaption("Type").setType("listbox").setItems([{id:"a",caption:"item 1",imageClass:"xui-icon-number1"},{id:"b",caption:"item 2",imageClass:"xui-icon-number2"},{id:"c",caption:"item 3",imageClass:"xui-icon-number3"},{id:"d",caption:"item 4",imageClass:"xui-icon-number4",disabled:true}]).setValue("liner").onChange("_c_onchange"));c.xui_ui_block35.append(xui.create("xui.UI.ComboInput").setHost(c,"c_duration").setName("duration").setShowDirtyMark(false).setLeft("0.75em").setTop("3.3333333333333335em").setWidth("16.666666666666668em").setLabelSize("6em").setLabelCaption("Duration").setType("spin").setUnit("ms").setPrecision(0).setIncrement(100).setMin(100).setMax(600000).setValue(200).onChange("_c_onchange"));c.xui_ui_block35.append(xui.create("xui.UI.ComboInput").setHost(c,"c_times").setName("times").setShowDirtyMark(false).setLeft("0.75em").setTop("5.833333333333333em").setLabelSize("6em").setLabelCaption("Times").setType("spin").setPrecision(0).setIncrement(1).setMin(1).setMax(99).setValue(1).onChange("_c_onchange"));c.xui_ui_block35.append(xui.create("xui.UI.CheckBox").setHost(c,"c_restore").setName("restore").setShowDirtyMark(false).setLeft("11.166666666666666em").setTop("5.916666666666667em").setWidth("6.25em").setCaption("Restore").onChange("_c_onchange"));c.xui_ui_panel3.append(xui.create("xui.UI.TreeGrid").setHost(c,"c_grid").setShowDirtyMark(false).setLeft("0em").setTop("0em").setEditable(true).setRowHandler(false).setHeader([{id:"key",caption:"Property",type:"label",width:"8em"},{id:"value",caption:"Value",type:"input",flexSize:true,width:"8em"}]).setActiveMode("none").afterCellUpdated("_c_grid_aftercellupdated"));c.xui_ui_dialog1.append(xui.create("xui.UI.Block").setHost(c,"xui_ui_block2").setDock("fill").setDockMargin({left:0,top:0,right:0,bottom:-1}).setLeft("12.5em").setTop("15.833333333333334em").setBorderType("inset").setBackground("#FFFFFF"));c.xui_ui_block2.append(xui.create("xui.UI.Div").setHost(c,"xui_ui_div13").setDock("origin").setLeft("20em").setTop("7.5em").setWidth("6em").setHeight("6em").setOverflow("visible").setCustomStyle({KEY:{"background-color":"#FAFAD2",opacity:0}}));c.xui_ui_div13.append(xui.create("xui.UI.Div").setHost(c,"c_demo").setClassName("xui-uibar").setLeft("0em").setTop("0em").setWidth("6em").setHeight("6em").setSelectable(false).setHtml('<div style="text-align: center;">&lt; l i n e 1 &gt;</div><div style="text-align: center;">&lt; l i n e 2 &gt;</div><div style="text-align: center;">&lt; l i n e 3 &gt;</div><div style="text-align: center;">&lt; l i n e 4 &gt;</div><div style="text-align: center;">&lt; l i n e 5 &gt;</div>'));c.xui_ui_dialog1.append(xui.create("xui.UI.Block").setHost(c,"xui_ui_block14").setDock("bottom").setDockOrder(2).setLeft("44.583333333333336em").setTop("3.75em").setHeight("4.5em").setBorderType("inset").setBackground("#FFFFF0"));c.xui_ui_block14.append(xui.create("xui.UI.Icon").setHost(c,"xui_ui_icon1").setTips("Add a frame").setTop("0.75em").setWidth("3.8333333333333335em").setHeight("3.3333333333333335em").setRight("0em").setImageClass("xui-uicmd-add").setIconFontSize("3em").onClick("_xui_ui_icon1_onclick").setCustomStyle({KEY:{cursor:"pointer"}}));c.xui_ui_block14.append(xui.create("xui.UI.Icon").setHost(c,"c_play").setTips("Play the animation").setLeft("0em").setTop("0.75em").setWidth("3.8333333333333335em").setHeight("3.3333333333333335em").setImageClass("xui-uicmd-toggle").setIconFontSize("3em").onClick("_c_play_onclick").setCustomStyle({KEY:{cursor:"pointer"}}));c.xui_ui_block14.append(xui.create("xui.UI.Gallery").setHost(c,"c_gallery").setShowDirtyMark(false).setItems([{id:"frame1",caption:"",imageClass:"xui-icon-number1",flagText:"",flagClass:"",flagStyle:""}]).setDock("bottom").setDockMargin({left:50,top:0,right:50,bottom:0}).setLeft("10.833333333333334em").setTop("23.333333333333332em").setHeight("4.333333333333333em").setBorderType("none").setIconOnly(true).setIconFontSize("2.5em ").setValue("").onItemSelected("_c_gallery_onitemselected").onFlagClick("_c_gallery_onflagclick").setCustomStyle({ITEMS:{overflow:"overflow-x:auto;overflow-y:hidden"}}));c.xui_ui_dialog1.append(xui.create("xui.UI.Block").setHost(c,"xui_ui_block18").setDock("bottom").setLeft("52.5em").setTop("0em").setHeight("3em").setBorderType("none").setOverflow("hidden"));c.xui_ui_block18.append(xui.create("xui.UI.Button").setHost(c,"ctl_ba").setLeft("6.583333333333333em").setTop("0.6666666666666666em").setWidth("6.583333333333333em").setHeight("2em").setCaption("$RAD.designer.attreditor.Apply").onClick("_ctl_ba_onclick"));c.xui_ui_block18.append(xui.create("xui.UI.Button").setHost(c,"ctl_bc").setLeft("19.083333333333332em").setTop("0.6666666666666666em").setWidth("6.583333333333333em").setHeight("2em").setCaption("$RAD.designer.attreditor.Cancel").onClick("_ctl_bc_onclick"));return b},_c_gallery_onflagclick:function(f,g,j,l){var d=this,c=f.boxing(),a=c.getSelectedItem(),b=f.properties.items;if(g.id==a.id){c.fireItemClickEvent(b[0].id)}c.removeItems(g.id);d._dirty=1;xui.arr.each(b,function(m,e){if(e<1){return}c.updateItem(m.id,{imageClass:"xui-icon-number"+(e+1)})})},setUItoForm:function(b){var a=this;if(b){a.c_duration.setUIValue(b.duration||200,true).setDisabled(false);a.c_restore.setUIValue(b.restore||false,true).setDisabled(false);a.c_times.setUIValue(b.times||1,true).setDisabled(false);a.c_type.setUIValue(b.type||"liner",true).setDisabled(false)}else{a.c_duration.setValue("",true).setDisabled(true);a.c_restore.setValue(false,true).setDisabled(true);a.c_times.setValue("",true).setDisabled(true);a.c_type.setValue("",true).setDisabled(true)}},getDefaultStatus:function(){return{}},addFrame:function(){var d=this,c=d.c_gallery,a=c.getItems(),b=a.length+1,f="frame"+xui.rand(),e;e=xui.clone(a[a.length-1]._frame);e=xui.merge(e,{type:"liner",times:1,duration:200,restore:false});c.insertItems([{id:f,caption:"",imageClass:"xui-icon-number"+b,flagClass:"xuicon xui-uicmd-close",flagStyle:"margin:0; cursor: default;",_frame:e}]);c.fireItemClickEvent(f)},_c_gallery_onitemselected:function(b,c){var a=this,e=a.c_grid;a._currentFrame=c._frame;a.setUItoForm(c.id=="frame1"?null:c._frame);var d=xui.clone(a._dft_rows);xui.arr.each(b.properties.items,function(f){xui.arr.each(d,function(g){if(g.id in f._frame.status){g.cells[1].value=f._frame.status[g.id]}});if(f==c){return false}});e.setRows(d);xui.arr.each(d,function(f){a.resetDemo(f.id,f.cells[1].value,f.cells[1].unit)})},_xui_ui_icon1_onclick:function(c,f,d){var b=this,a=c.boxing();if(b.c_gallery.getItems().length>=9){xui.alert("It allowes 9 frames only")}else{b.addFrame();b._dirty=1}},_ctl_bc_onclick:function(a,c,d,b){this.xui_ui_dialog1.close()},getAnimFrames:function(){var b=this,a=[];xui.each(b.c_gallery.getItems(),function(c){a.push(c._frame)});return a},_ctl_ba_onclick:function(c,f,g,d){var b=this,a=b.getAnimFrames();b.fireEvent("onchange",[a]);b.xui_ui_dialog1.close()},events:{onRender:"_page_onrender",onReady:"_page_onready"},_dft_rows:[{id:"left",cells:[{id:"left",caption:"$(RAD.custom_dlg.left)"},{type:"spin",unit:"em",editorProperties:{precision:1,increment:1,units:"px;em"}}]},{id:"top",cells:[{id:"top",caption:"$(RAD.custom_dlg.top)"},{type:"spin",unit:"em",editorProperties:{precision:1,increment:1,units:"px;em"}}]},{id:"width",cells:[{id:"width",caption:"$(RAD.custom_dlg.width)"},{type:"spin",unit:"em",editorProperties:{precision:1,increment:1,units:"px;em"}}]},{id:"height",cells:[{id:"height",caption:"$(RAD.custom_dlg.height)"},{type:"spin",unit:"em",editorProperties:{precision:1,increment:1,units:"px;em"}}]},{id:"opacity",cells:[{id:"opacity",caption:"$RAD.custom_dlg.opacity"},{type:"progress",value:1,editorProperties:{min:0,max:1}}]},{id:"rotate",cells:[{id:"rotate",caption:"$(RAD.custom_dlg.rotate)"},{type:"spin",unit:"deg",editorProperties:{precision:0,increment:1,min:0,max:360}}]},{id:"translateX",cells:[{id:"translateX",caption:"$(RAD.custom_dlg.translateX)"},{type:"spin",editorProperties:{precision:1,increment:1}}]},{id:"translateY",cells:[{id:"translateY",caption:"$(RAD.custom_dlg.translateY)"},{type:"spin",editorProperties:{precision:1,increment:1}}]},{id:"scaleX",cells:[{id:"scaleX",value:1,caption:"$(RAD.custom_dlg.scaleX)"},{type:"spin",editorProperties:{precision:1,increment:0.1}}]},{id:"scaleY",cells:[{id:"scaleY",value:1,caption:"$(RAD.custom_dlg.scaleY)"},{type:"spin",editorProperties:{precision:1,increment:0.1}}]},{id:"skewX",cells:[{id:"skewX",caption:"$(RAD.custom_dlg.skewX)"},{type:"spin",unit:"deg",editorProperties:{precision:0,increment:1,min:-180,max:180}}]},{id:"skewY",cells:[{id:"skewY",caption:"$(RAD.custom_dlg.skewY)"},{type:"spin",unit:"deg",editorProperties:{precision:0,increment:1,min:-180,max:180}}]},{id:"color",cells:[{id:"color",caption:"$RAD.custom_dlg.color"},{type:"color"}]},{id:"fontSize",cells:[{id:"fontSize",caption:"$(RAD.custom_dlg.font$-size)"},{type:"spin",unit:"em",editorProperties:{min:0,max:10,precision:0,increment:1,units:"em;px;pt"}}]},{id:"lineHeight",cells:[{id:"lineHeight",caption:"$(RAD.custom_dlg.line$-height)"},{type:"spin",editorProperties:{min:0,max:10,precision:1,increment:0.1}}]},{id:"backgroundColor",cells:[{id:"backgroundColor",caption:"$(RAD.custom_dlg.background$-color)"},{type:"color"}]},{id:"backgroundPositionX",cells:[{id:"backgroundPositionX",caption:"$(RAD.custom_dlg.background$-position$-x)"},{type:"spin",unit:"%",editorProperties:{precision:1,increment:1,units:"px;em;%"}}]},{id:"backgroundPositionY",cells:[{id:"backgroundPositionY",caption:"$(RAD.custom_dlg.background$-position$-y)"},{type:"spin",unit:"%",editorProperties:{precision:1,increment:1,units:"px;em;%"}}]}],_page_onready:function(){var a=this;a.c_type.setItems((function(c){var b=[];xui.each(c,function(e,d){b.push({id:d,tips:'<img width=80 height=80 src="/RAD/img/animate/'+d+'.gif" /> '})});return b})(xui.Dom.$AnimateEffects))},_page_onrender:function(b,e){var d=this;var g=this.properties,f=g.frames;var c=d._initedRegion={};c.left=d.c_demo.getLeft();c.top=d.c_demo.getTop();c.right=d.c_demo.getRight();c.bottom=d.c_demo.getBottom();c.width=d.c_demo.getWidth();c.height=d.c_demo.getHeight();if(!f||f.length===0||(f.length===1&&!f[0].status)){f=[{status:d.getDefaultStatus()}]}var a=[];xui.arr.each(f,function(l,j){l.status=l.status||{};j+=1;if(j===1){l={status:l.status};a.push({id:"frame"+j,imageClass:"xui-icon-number"+j,flagStyle:"margin:0; cursor: default;",_frame:l})}else{a.push({id:"frame"+j,imageClass:"xui-icon-number"+j,flagClass:"xuicon xui-uicmd-close",flagStyle:"margin:0; cursor: default;",_frame:l})}});d.c_gallery.setItems(a);d.c_gallery.selectItem("frame1")},_c_onchange:function(d,b,f,e,a){var c=this;c._currentFrame[d.properties.name]=f},_c_grid_aftercellupdated:function(d,a,b,g){var c=this,f=c._currentFrame.status,e=a._row.id;c.resetStatus(f,e,a.value,a.unit);c.resetDemo(e,a.value,a.unit)},resetStatus:function(a,b,d,c){switch(b){case"left":case"top":case"right":case"bottom":case"width":case"height":case"rotate":case"skewX":case"skewY":case"fontSize":case"backgroundPositionX":case"backgroundPositionY":if(xui.isEmpty(d)){delete a[b]}else{a[b]=xui.isSet(d)?(d+(c||"")):null}break;case"opacity":case"translateX":case"translateY":case"scaleX":case"scaleY":case"lineHeight":case"color":case"backgroundColor":if(xui.isEmpty(d)){delete a[b]}else{a[b]=d}break}},_map:{left:1,right:1,top:1,bottom:1,width:1,height:1},_get:function(d,e,b,a){var c=this;return(c._map[b]&&e&&xui.isFun(e[a="get"+xui.str.initial(b)]))?c._initedRegion[b]:d[b]?d[b]():d.css(b)},_set:function(d,f,b,e,a){var c=this;return(c._map[b]&&f&&xui.isFun(f[a="set"+xui.str.initial(b)]))?f[a](e):d[b]?d[b](e):d.css(b,e)},resetDemo:function(a,f,d){var b=this;f=xui.isSet(f)?(f+(d||"")):"";var c=b.c_demo.getRoot(),e=b.c_demo;f=b._map[a]?(f||b._get(c,e,a)):f;return b._set(c,e,a,f)},_c_play_onclick:function(c,f,d){var b=this,a=b.c_gallery.getItems();xui.Dom.busy("temp_animation");b.c_gallery.selectItem(a[0].id);xui.asyRun(function(){var g=new xui.AnimBinder(),e=0;g.setFrames(b.getAnimFrames());g.beforeFrame(function(j,l){b.c_gallery.setUIValue(a[++e].id,true)});g.onEnd(function(){var j=(a[a.length-1]._frame.restore?1:0);b.c_gallery.selectItem(a[a.length-1-j].id);b._c_gallery_onitemselected(b.c_gallery.get(0),a[a.length-1-j]);xui.Dom.free("temp_animation")});g.apply(b.c_demo.getRoot())},200)}}});xui.Class("RAD.EventPicker","xui.Module",{Instance:{iniComponents:function(){var c=this,b=[],a=function(d){b.push(d.get(0))};a(xui.create("xui.UI.Dialog").setHost(c,"xui_ui_dialog1").setLeft("0em").setTop("0em").setWidth("59.166666666666664em").setHeight("33.333333333333336em").setCaption("$(RAD.inter.Event Picker)").setMinBtn(false).setMaxBtn(false).setModal(true).beforeClose("_close"));c.xui_ui_dialog1.append(xui.create("xui.UI.Block").setHost(c,"xui_ui_block2").setDock("fill").setLeft("16.666666666666668em").setTop("4.166666666666667em").setBorderType("inset"));c.xui_ui_block2.append(xui.create("xui.UI.Layout").setHost(c,"xui_ui_layout3").setItems([{id:"before",size:80,min:10,locked:false,folded:false,hidden:false,cmd:false,pos:"before"},{id:"main",size:120,min:10},{id:"after",size:80,min:10,locked:false,folded:false,hidden:true,cmd:false,pos:"after"}]).setLeft("0em").setTop("0em").setType("horizontal").setFlexSize(true));c.xui_ui_layout3.append(xui.create("xui.UI.List").setHost(c,"list_all").setDirtyMark(false).setDock("fill").setLeft("3.3333333333333335em").setTop("1.6666666666666667em").setWidth("26.666666666666668em").setBorderType("none").setLabelSize("8.333333333333334em").setLabelPos("none").onItemSelected("_list_all_onitemselected"),"before");c.xui_ui_layout3.append(xui.create("xui.UI.TreeBar").setHost(c,"event_all").setDirtyMark(false).setLeft("0em").setTop("0em").setSelMode("none").onItemSelected("_event_all_onitemselected"),"main");c.xui_ui_layout3.append(xui.create("xui.UI.ComboInput").setHost(c,"filter1").setDirtyMark(false).setDock("top").setDockMargin({left:0,top:0,right:0,bottom:4}).setTips("$(RAD.designer.tool.Filter) ").setHeight("4.25em").setDynCheck(true).setLabelSize("2em").setLabelPos("top").setLabelCaption("$(RAD.inter.Select the target Modue or Control)").setLabelHAlign("center").setType("input").setImageClass("xui-icon-filter").setCommandBtn("delete").onChange("_propFilter_onchange").onCommand("_propFilter_oncmd").setCustomClass({KEY:"xui-uibar"}),"before");c.xui_ui_layout3.append(xui.create("xui.UI.ComboInput").setHost(c,"filter2").setDirtyMark(false).setDock("top").setDockMargin({left:0,top:0,right:0,bottom:4}).setTips("$(RAD.designer.tool.Filter) ").setHeight("4.25em").setDynCheck(true).setLabelSize("2em").setLabelPos("top").setLabelCaption("$(RAD.inter.Pick the target event)").setLabelHAlign("center").setType("input").setImageClass("xui-icon-filter").setCommandBtn("delete").onChange("_propFilter2_onchange").onCommand("_propFilter2_oncmd").setCustomClass({KEY:"xui-uibar"}),"main");return b},events:{onRender:"_onrender"},_onrender:function(){var a=this;if(a._alias){a.list_all.selectItem(a._alias)}},refreshList:function(f,d){var e=this;e._alias=d;var b=[],g={},c=function(n){var o=n.properties,m=(n["xui.Module"]||n.moduleClass)?"module":"control",j=n.key.split(".").pop(),l;if(m=="module"){l="$(RAD.action.Module) - "+n.getAlias()+" ( "+n.key+" )"}else{l="$(RAD.action.Control) - "+n.alias+" ( "+j+" )";if(o.name||o.desc){l+=" <br />[ "+(o.name||"")+(o.name?" - ":"")+(o.desc||"")+" ]"}if(o.caption||o.labelCaption){l+=" [ "+(o.caption||o.labelCaption)+" ]"}}return l},a=function(l,n,j,m){if((f.$inplaceEditor&&f.$inplaceEditor.get(0))==l){return}var q=l.moduleClass?"module":"control",r=q=="module"?"xui.Module":l.box.KEY,o;++m;if(q=="module"){l=l.getModule(true);if(g[o=l.KEY+"["+l.$xid+"]"]){return}g[o]=1}var w=arguments.callee,u=j[r],s={id:m==1?"-page":l.alias,type:q,target:m==1?(new xui.Module):l,itemStyle:"padding-left:"+(m-1)*2+"em;",imageClass:m==1?"xuicon spafont spa-icon-page":u&&u.imageClass||"",tag:m==1?"page":c(l).replace(/\<[^>]+\>/g,""),caption:m==1?"$(RAD.action.var.Current Page)":c(l)};n.push(s);if(q=="module"){return}if(l.children&&l.children.length){xui.arr.each(l.children,function(x){w.call(null,x[0],n,j,m)})}};a(f.canvas.get(0),b,CONF.mapWidgets,0);e.list_all.setItems(b)},_propFilter_oncmd:function(){this._propFilter1_("")},_propFilter_onchange:function(b,a,c){xui.resetRun("_propFilter1_",this._propFilter1_,500,[c],this)},_propFilter1_:function(b){var a=this.list_all.getValue();this.list_all.doFilter(b?function(d){if(a==d.id){return false}var c=new RegExp(b||"","i");return !c.test(d.tag)}:null)},_propFilter2_oncmd:function(){this._propFilter2_("")},_propFilter2_onchange:function(b,a,c){xui.resetRun("_propFilter2_",this._propFilter2_,500,[c],this)},_propFilter2_:function(a){this.event_all.doFilter(a?function(c){var b=new RegExp(a||"","i");return !b.test(c.caption)}:null)},_list_all_onitemselected:function(c,r,f,b,j){var l=this,o=c.boxing(),g=r.target,n=r.id=="-page",d=[];xui.each(n?xui.Module.$EventHandlers:g.box.$EventHandlers,function(u,e){if(e.charAt(0)=="_"){return}if(CONF.widgets_hiddenEvents[e]){return}if(xui.get(CONF.widgets_hiddenEvents,[g.box.KEY,e])){return}if(CONF.widgets_hiddenEvents_filter&&false===CONF.widgets_hiddenEvents_filter(g.box.KEY,e)){return}var s=e.charAt(0)=="b"?"$(RAD.designer.eventbfrtag)":e.charAt(0)=="a"?"$(RAD.designer.eventafttag)":"$(RAD.designer.eventontag)",a=RAD.EditorTool.getEventName(n?"xui.Module":g.key,e,true);d.push({id:e,caption:s+a+" - <span style='color:#888;font-style: italic;font-weight:normal;'>"+(xui.get(RAD.EditorTool.getDoc(g.box.KEY+".prototype."+e,null,true),["$desc"])||"").split(".")[0]+"</span>"})});var q=[],m;xui.arr.each(CONF.widgets_events_cat,function(a){m=[];xui.arr.each(a.items,function(s,e){if((e=xui.arr.subIndexOf(d,"id",s))!=-1){m.push(d[e]);d[e]=null}});if(m.length){q.push({id:"sub:"+a.id,caption:"<span style='font-weight:normal'>$(RAD.designer.conf.propcat."+a.id+")</span>",group:true,iniFold:false,cellStyle:"font-weight:normal",sub:m})}});xui.filter(d,function(a){return !!a});if(d.length){xui.arr.stableSort(d,function(a,e){return a.id>e.id?1:-1});q.push({id:"sub:featured",caption:"<span style='font-weight:normal'>$(RAD.designer.conf.propcat.Featured Events)</span>",group:true,iniFold:false,sub:d});if(q.length>=2){var m=q[q.length-1];q[q.length-1]=q[q.length-2];q[q.length-2]=m}}l.event_all.setItems(q)},_event_all_onitemselected:function(b,m,c,a,d){var f=this,j=b.boxing(),l=f.list_all.getValue(),g=m.id;f.fireEvent("onSel",[l,g]);f.xui_ui_dialog1.close()}}});xui.Class("RAD.VersionManager","xui.Module",{Instance:{Dependencies:[],Required:[],properties:{},initialize:function(){},iniComponents:function(){var d=this,c=[],b={},a=function(e){c.push(e.get(0))};xui.merge(b,this.properties);a(xui.create("xui.APICaller").setHost(d,"api_3").setName("api_3").setQueryURL(CONF.getAllFileVersionService).setQueryMethod("POST").setRequestDataSource([]).setResponseDataTarget([]).setResponseCallback([]).setQueryArgs({projectName:SPA.curProjectName,pageSize:20,path:SPA.tabsMain.getItemByItemId(SPA.tabsMain.getUIValue()).id,pageIndex:1}).setProxyType("AJAX").onData([{desc:"动作 1",type:"control",target:"xui_ui_treegrid10",args:[],method:"removeAllRows"},{desc:"动作 2",type:"control",target:"xui_ui_treegrid10",args:["{args[1].data}","","",false],method:"insertRows"},{desc:"动作 3",type:"control",target:"xui_ui_pagebar4",args:["{page.xui_ui_pagebar4.setTotalCount()}",undefined,undefined,"{args[1].size}"],method:"setTotalCount",redirection:"other:callback:call"}]));a(xui.create("xui.APICaller").setHost(d,"api_2").setName("api_2").setQueryURL(CONF.delFileVersionService).setRequestDataSource([]).setResponseDataTarget([]).setResponseCallback([]).setQueryArgs({paths:""}).onData([{desc:"动作 1",type:"control",target:"api_3",args:[],method:"invoke",onOK:0,onKO:1,okFlag:"_DI_succeed",koFlag:"_DI_fail"}]));a(xui.create("xui.UI.Dialog").setHost(d,"xui_ui_panel11").setLeft("12.5em").setTop("4.166666666666667em").setWidth("54.166666666666664em").setHeight("30.833333333333332em").setCaption("点击左侧图标下载或编辑"));d.xui_ui_panel11.append(xui.create("xui.UI.PageBar").setHost(d,"xui_ui_pagebar4").setDock("bottom").setLeft("21.666666666666668em").setTop("78.33333333333333em").setCaption("页码自定义").setTextTpl("[*]").onPageSet([{desc:"动作 4",type:"control",target:"api_3",args:["{page.api_3.setQueryData()}",undefined,undefined,"{page.properties.path}","path"],method:"setQueryData",redirection:"other:callback:call",conditions:[{left:"{page.properties}",symbol:"objhaskey",right:"path"}]},{desc:"动作 1",type:"control",target:"api_3",args:["{page.api_3.setQueryData()}",undefined,undefined,"{page.xui_ui_pagebar4.getPageCount()}","pageSize"],method:"setQueryData",redirection:"other:callback:call"},{desc:"动作 2",type:"control",target:"api_3",args:["{page.api_3.setQueryData()}",undefined,undefined,"{args[1]}","pageIndex"],method:"setQueryData",redirection:"other:callback:call"},{desc:"动作 3",type:"control",target:"api_3",args:[function(){if(resumeFun){resumeFun("okData",arguments,fun.okFlag)}},function(){if(resumeFun){resumeFun("koData",arguments,fun.koFlag)}}],method:"invoke",onOK:0,onKO:1,okFlag:"_DI_succeed",koFlag:"_DI_fail"}]));d.xui_ui_panel11.append(xui.create("xui.UI.TreeGrid").setHost(d,"xui_ui_treegrid10").setLeft("0em").setTop("0em").setRowHeight("4em").setGridHandlerCaption("常用操作").setRowHandlerWidth("8em").setHeader([{id:"versionID",caption:"版本ID",type:"label",width:"8em",hidden:true},{id:"fileName",caption:"文件名称",type:"label",flexSize:true,width:"12em"},{id:"index",caption:"版本号",type:"label",width:"3em"},{id:"createTime",caption:"创建时间",type:"datetime",width:"12em"},{id:"length",caption:"文件大小",type:"label",width:"4em"},{id:"personName",caption:"上传人",type:"label",width:"6em"},{id:"fileId",caption:"文件ID",type:"label",width:"8em",hidden:true,colResizer:false},{id:"hash",caption:"HASH",type:"label",hidden:true,width:"8em"},{id:"path",caption:"VFS路径",hidden:true,type:"label",width:"8em"},{id:"name",caption:"版本名称",type:"label",hidden:true,width:"8em"}]).setUidColumn("versionID").setTagCmds([{id:"delete",type:"button",location:"left",itemClass:"fa fa-close",tips:"删除",tag:"row"},{id:"download",type:"button",location:"left",itemClass:"fa fa-cloud-download",tips:"下载",tag:"row"},{id:"edit",type:"button",location:"left",itemClass:"fa fa-external-link",tips:"编辑",tag:"row"}]).setValue("").onCmd([{desc:"动作 1",type:"control",target:"api_2",args:["{page.api_2.setQueryData()}",undefined,undefined,"{args[1].versionID}","paths"],method:"setQueryData",conditions:[{left:"{args[2]}",symbol:"=",right:"delete"}],redirection:"other:callback:call"},{desc:"动作 2",type:"control",target:"api_2",args:[],method:"invoke",okFlag:"_DI_succeed",koFlag:"_DI_fail",conditions:[{left:"{args[2]}",symbol:"=",right:"delete"}],"return":false,onOK:0,onKO:1},{desc:"动作 4",type:"other",target:"callback",args:["{page.functions.downloadfile}",undefined,undefined,"{args[1].path}"],method:"call",conditions:[{left:"{args[2]}",symbol:"=",right:"download"}]},"_xui_ui_treegrid10_oncmd"]).onDblclickRow([{desc:"动作 1",type:"other",target:"callback",args:["{page.functions.downloadfile}",undefined,undefined,"{args[1].path}"],method:"call"}]).onCommand([]));return c},customAppend:function(b,a,d,c){return false},functions:{downloadfile:{desc:"下载文件",params:[{id:"path",type:"String",desc:"文件地址"}],actions:[function(c){var a="/vfs/download?path="+c+"&tiem="+new Date();var b=xui.create("xui.UI.Div").setLeft("0").setTop("0").setWidth("0").setHeight("0").setIframeAutoLoad(a).show()}]}},events:{onRender:[{desc:"动作 1",type:"control",target:"xui_ui_panel11",args:[{},{caption:"{page.properties.path}"}],method:"setProperties"}]},_xui_ui_treegrid10_oncmd:function(c,l,g,f,j){var b=this,a=c.boxing();switch(g){case"edit":var d=SPA.tabsMain.getItemByItemId(SPA.tabsMain.getUIValue());d.value=l.path;d.name=l.fileName;SPA._openfile(d,l.path);break;default:}}}});xui.Class("RAD.expression.JavaEditor",["xui.UI.Widget","xui.absValue"],{Instance:{activate:function(){var a=this.get(0);if(a.$cm){a.$cm.focus()}if(a.$cm){a.$cm.doc.setCursor(a.readonly_head||0+1,0)}return this},getCM:function(){return this.get(0).$cm},resetEditorStyle:function(e,b,d,a){this.addCMTheme(e);var c=this.get(0);if(!a){a=c.$cm}if(a){a.setOption("theme",e);a.setOption("lineWrapping",!!d);var f=a.getWrapperElement();if(f){f.style.fontSize=b+"px"}}},showModeSelDlg:function(d){var c=this,a=c.getCM(),b=c.get(0),e=function(f){if(!f||f.mode==="none"){if(!b.$initialized){b.$initialized=true}if(b.onRendered){b.boxing().onRendered(b,true)}}else{a.setOption("mode",f.mime||f.mode);CodeMirror.autoLoadMode(a,f.mode);if(b.onCodeModeSet){b.boxing().onCodeModeSet(b,f)}}b=a=null};xui.ModuleFactory.newCom("RAD.expression.SelRenderMode",function(){this.setEvents("onSel",e);this.mainDlg.showModal();this.modeList.setValue(d.mime+":"+d.mode)})},addCMTheme:function(b){var a=this.get(0);var c="cm-theme-"+b;if(b!="default"&&!xui.CSS.get("id",c)){xui.CSS.includeLink("codemirror5/theme/"+b+".css",false,c)}},clearHistory:function(){var a=this.get(0).$cm;if(a){a.clearHistory()}},reindent:function(){var a=this.get(0).$cm,e=a.doc;if(e.somethingSelected()){var f=e.getCursor("start"),d=e.getCursor("end");for(var c=f.line,b=d.line;c<=b;c++){a.indentLine(c)}}else{var f=e.firstLine(),d=e.lastLine();for(var c=f,b=d;c<=b;c++){a.indentLine(c)}}},callEditor:function(c,b,a){var d=this.get(0).$cm;if(a){d=d.doc}return d[c].apply(d,b||[])},searchCode:function(c){var b=this.get(0),a=b.$cm;if(a){var d=a.getSearchCursor(c,a.hasFocus()?a.doc.getCursor():{pos:0,line:0},true);if(d.findNext()){a.focus();a.doc.setSelection(d.from(),d.to())}}},locateTo:function(m,l,f){var j=this,c=this.get(0),n=c.$cm,d,b,a,e;if(n){d=RAD.ClassTool.getClassStruct2(n.doc.getValue());if(m){if(l&&(m=="Static"||m=="Instance")){b=xui.get(d,["sub",m,"sub",l])}else{b=xui.get(d,["sub",m])}}if(b){if(f){n.doc.setSelection(n.doc.posFromIndex(b.from),n.doc.posFromIndex(b.to))}else{var g=n.doc.posFromIndex(b.from);n.focus();n.doc.setCursor(g);n.scrollIntoView(g)}return true}}return false},focusLine:function(b){var d=this,c=this.get(0),a=c.$cm,e={line:b,ch:0};if(a){a.focus();a.doc.setCursor(e);a.scrollIntoView(e)}},getLine:function(l,j,f){var g=this,c=this.get(0),m=c.$cm,d,b,a,e;if(m){d=RAD.ClassTool.getClassStruct2(m.doc.getValue());if(l){if(j&&(l=="Static"||l=="Instance")){b=xui.get(d,["sub",l,"sub",j])}else{b=xui.get(d,["sub",l])}}if(b){return m.doc.posFromIndex(b.from)}}return null},addCodeInto:function(n,m,a,f,e){e=e||"";var l=this,b=this.get(0),o=b.$cm;if(o){var d=RAD.ClassTool.getClassStructWithScope(o.getValue()),g=xui.get(d,["sub",n,"sub",m]),c;if(g){o.doc.replaceRange(a,o.doc.posFromIndex(g.from),o.doc.posFromIndex(g.to))}else{if(e){e+="\n"}g=xui.get(d,["sub",n]);if(!g){c=xui.get(d,["sub",d.arr[d.arr.length-1]]);if(c){a=",\n"+e+n+":{\n"+m+":"+(f?"function()":"")+a+"\n}"}else{a=n+":{\n"+e+m+":"+(f?"function()":"")+a+"\n}\n";c=d;c.to--}}else{c=xui.get(g,["sub",g.arr[g.arr.length-1]]);if(c){a=",\n"+e+m+":"+(f?"function()":"")+a}else{a=e+m+":"+(f?"function()":"")+a+"\n";c=g;c.to--}}var j=o.doc.posFromIndex(c.to);o.doc.replaceRange(a,j,j);o.doc.setSelection(j,o.doc.posFromIndex(c.to+a.length));l.reindent()}}},showJumpToWnd:function(b){var a=this,c=xui.use(b).offset();xui.ComFactory.getCom("RAD.JumpTo",function(){this.setEvents({onOK:function(d){try{a.callEditor("focus");a.callEditor("setCursor",[d-1,0],true)}catch(f){}}});this.show(null,null,null,null,c.left,c.top)})},showFindWnd:function(){var a=this,b=a.getCM().getSelection();xui.ComFactory.getCom("RAD.FAndR",function(){this._editor=a;this._init=b;this.show(null,a.getRoot(),null,null,0,0)})},getBlockInfo:function(e,d){var c=this,b=this.get(0),a=b.$cm;return a&&xui.get(RAD.ClassTool.getClassStructWithScope(a.getValue()),["sub",e,"sub",d])},_refreshCM:function(){if(this.get(0).$cm){this.get(0).$cm.refresh()}},_setCtrlValue:function(a){if(!xui.isSet(a)){a=""}return this.each(function(b){if(b.$cm&&b.$cm.getValue()!=a){b.$cm.doc.setValue(a);if(b.$tm1){b.$tm1.clear()}if(b.$tm2){b.$tm2.clear()}delete b.$tm1;delete b.$tm2;delete b.readonly_head;delete b.readonly_tail}})},_getCtrlValue:function(){var a=this.get(0);if(a.$cm){return a.$cm.doc.getValue()}else{return a.properties.$UIvalue}},setReadonlyLines:function(b,a){var c=this.get(0),e=c.$cm.doc;if(c.$tm1){c.$tm1.clear()}if(c.$tm2){c.$tm2.clear()}if(b){c.$tm1=e.markText({line:0,ch:0},{line:b,ch:0},{atomic:true,readOnly:true,css:"background-color:#ccc;"})}if(a){var d=e.lastLine();c.$tm2=e.markText({line:d-a},{line:d},{atomic:true,readOnly:true,css:"background-color:#ccc;"})}c.readonly_head=b;c.readonly_tail=a}},Initialize:function(){var a=this.getTemplate();xui.merge(a.FRAME.BORDER,{BOX:{tagName:"div"}},"all");this.setTemplate(a);this.__trim=function(b){if(/[^\s\uFEFF\xA0]/.test(b)){return xui.str.trim(b)}else{return b}}},Static:{$tempsandbox:"_$temp_for_xui_sandbox",$tempsandbox2:"_$temp_for_xui_sandbox2",$temppool:"_$temp_for_xui_pool",Appearances:{BOX:{width:"100%",height:"100%",left:0,top:0,position:"absolute",background:"#fff"}},Behaviors:{},DataModel:{left:0,top:0,width:200,height:200,position:"absolute",codeType:{ini:"java",action:function(a){CodeMirror.findModeByExtension(codeTypecodeType)}},readonly:{ini:false,action:function(a){if(this.$cm){this.$cm.setOption("readOnly",!!a)}}}},EventHandlers:{onValueChanged:function(b,a){},onRendered:function(a){},onGetHelpInfo:function(b,a){},onCodeModeSet:function(a,b){},onSaveCommand:function(){}},RenderTrigger:function(){var b=this.box.$temppool,a=this.$xid;this.box._loadEditor(this);this.destroyTrigger=function(){this.$cm.clearGutter();this.$cm.clearHistory();delete this.$cm;delete this.$tm1;delete this.$tm2;delete this.$editor;if(this.$popList){this.$popList.destroy()}if(this.$popHelp){this.$popHelp.destroy()}if(this.$popCustom){this.$popCustom.destroy()}if(window[b]){delete window[b][a]}}},clearSandbox:function(a){for(var b=1,d;b<9;b++){d=a+b;if(d&&document.getElementById(d)){document.body.removeChild(document.getElementById(d));try{delete frames[d]}catch(c){}}}},purge:function(){var a=this,b;if((b=window[a.$temppool])&&b.Instance&&b.Instance._ctrlpool){xui.each(b.Instance._ctrlpool,function(d,c){if(d&&!d.destroyed){if(d.destroy){d.destroy()}if(d.boxing&&d.boxing()){d.boxing().destroy()}}});xui.breakO(b.Instance)}},_alias:1,evalInSandbox:function(code,funScope,name,subCacheKey,purge,beforeCode,afterCode,cleanFun){if(name&&document.getElementById(name)){document.body.removeChild(document.getElementById(name));try{delete frames[name]}catch(e){}}var ns=this,iframe=document.createElement("iframe"),result,wnd,line,errmsg,type;ns.purge();if(name){iframe.name=name;iframe.id=name}iframe.src="about:blank";iframe.style.display="none";document.body.appendChild(iframe);wnd=frames[frames.length-1];wnd.document.open();wnd.document.write('<meta http-equiv="content-type" content="text/html; charset=utf-8" />');wnd.document.write("<script>\n");if(beforeCode){wnd.document.write(beforeCode)}wnd.document.write("global=process=Buffer=require=module=exports=root=null;\nwindow.xui=parent.xui;\nwindow.Class=function(){return xui.Class.apply(xui,arguments);};\nwindow.CONF={mixed_prop: xui.clone(parent.CONF.mixed_prop) };\n"+(CONF.SandBoxExtCode||"")+"window.__cache={};window.__getThis=function(pname,type){\n      if(__cache[pname+':'+type])return __cache[pname+':'+type];\n      var obj=type==1?function(){}:{};\n      if(pname){\n          if(xui.isArr(pname)){\n              xui.each(pname,function(cls){\n                  cls=xui.SC(cls);\n                  obj=xui.merge(obj, type==1?(cls||xui.Module):(cls?(new cls):(new xui.Module)),'all',true)\n              });\n          }else{\n              pname=xui.SC(pname);\n              obj=xui.merge(obj, type==1?(pname||xui.Module):(pname?(new pname):(new xui.Module)),'all',true)\n          }\n      }\n      if(window['"+ns.$temppool+"'] && window['"+ns.$temppool+"']['"+subCacheKey+"']){\n          obj=xui.merge(obj, window['"+ns.$temppool+"']['"+subCacheKey+"'][type==1?'Static':'Instance'],'all')\n      }\n      return __cache[pname+':'+type]=obj;\n  };\nwindow['"+ns.$temppool+"']=parent['"+ns.$temppool+"'];\nparent['"+ns.$tempsandbox+"']=/*@cc_on !@*/0?this:{eval:function(s){return (function(){var b=arguments.callee;return window.eval.call(window,s)})()}};\nparent['"+ns.$tempsandbox2+"']={getErrLine:function(s,cb){window.onerror=function(){cb.apply(null,arguments);return true;};var n=document.createElement('script');n.type='text/javascript';if(/*@cc_on !@*/0){n.text=s;}else{n.appendChild(document.createTextNode(s));};document.body.appendChild(n);window.onerror=null;}};\ntry{top=parent=null;}catch(e){}");if(afterCode){wnd.document.write(afterCode)}wnd.document.write("<\/script><body><span id='abc'></span></body>");wnd.document.close();var bak=xui.Dom.pack,bak1=xui.absProfile.prototype.$link,bak11=xui.absObj.$pickAlias,bak12=xui.UIProfile.prototype.setDomId,bak2=xui.require,bak3=xui.$cache,bak4=xui.asyRun,bak5=xui.resetRun,bak6=xui.exec,bak7=xui.pseudocode._callFunctions;try{xui.Dom.pack=function(){var o=new xui.Dom(false),d=document.getElementById("abc");o._nodes=[d];return o};xui.absProfile.prototype.$link=function(){return this};xui.Class.$instanceCreated=function(instance){instance.$inDesign=1};xui.absObj.$pickAlias=function(){return ns._alias++};xui.UIProfile.prototype.setDomId=function(){return this};xui.require=function(){};xui.$cache={};xui.each(bak3,function(o,i){xui.$cache[i]=xui.isArr(o)?[]:{}});xui.asyRun=xui.resetRun=xui.exec=xui.pseudocode._callFunctions=function(){};result=window[ns.$tempsandbox].eval(code);if(funScope){if(typeof(result)=="function"){result.call(funScope)}}type=(result===wnd||result===wnd.content)?"window":result===wnd.console?"console":result===wnd.history?"history":result===wnd.screen?"screen":result===wnd.location?"location":result===wnd.navigator?"navigator":result===wnd.document?"document":null;if(xui.browser.newie||(xui.browser.ie&&xui.browser.ver>=9)){var fun=function(hash){for(var i in hash){if(xui.isFun(hash[i])){hash[i]._____string=hash[i]+""}else{if(xui.isHash(hash[i])){fun(hash[i])}else{if(xui.isArr(hash[i])){fun(hash[i])}}}}};if(type===null&&(xui.isHash(result)||xui.isArr(result))){fun(result)}}}catch(e){if(xui.isSet(e.line||e.lineNumber)){line=e.line||e.lineNumber}else{var base=0;if(xui.browser.ie){window[ns.$tempsandbox2].getErrLine("var _a={;",function(a,b,c){base=c-1;return true})}window[ns.$tempsandbox2].getErrLine(code,function(a,b,c){line=c-base;return true})}errmsg=((e.name?e.name+" : ":"")+(e.description||e.message||"")+(line?"\n line : "+line:""));if(!xui.isSet(line)&&/.*at line ([\d]+).*/.test(errmsg)){line=errmsg.replace(/.*at line ([\d]+).*/,"$1")}}finally{if(purge){ns.purge()}delete xui.Class.$instanceCreated;xui.Dom.pack=bak;xui.absProfile.prototype.$link=bak1;xui.absObj.$pickAlias=bak11;xui.UIProfile.prototype.setDomId=bak12;xui.require=bak2;xui.$cache=bak3;xui.asyRun=bak4;xui.resetRun=bak5;xui.exec=bak6;xui.pseudocode._callFunctions=bak7;if(cleanFun){cleanFun(wnd,iframe)}wnd.CONF=wnd.Class=wnd.xui=wnd[ns.$temppool]=wnd.__getThis=wnd.__cache=null;if(CONF.ClearSandBoxExtCode){CONF.ClearSandBoxExtCode(wnd)}window[ns.$tempsandbox]=null;window[ns.$tempsandbox2]=null;var rsl={ok:result,type:type,ko:errmsg,line:line};ns=bak=result=line=errmsg=type=null;if(!name){document.body.removeChild(iframe)}iframe=null;return rsl}},_buildItem:function(j,d,c,g,b,f,a,e){return{id:j,caption:b||j,value:f||j,tag:(a||(d=="property"?"b":d=="function"?"c":d=="class"?"d":d=="event"?"e":"a"))+":"+j.toLowerCase(),path:(c?(c+"."):"")+j,itemStyle:e,imageClass:!d?null:(d=="property"?(xui.isSet(g)&&xui.isHash(g))?"spafont spa-icon-hash":(xui.isSet(g)&&xui.isArr(g))?"spafont spa-icon-array":"spafont spa-icon-var":d=="var"?"spafont spa-icon-var":d=="event"?"spafont spa-icon-action":d=="function"?"spafont spa-icon-function":d=="class"?"spafont spa-icon-class":"spafont spa-icon-prop")}},_intellcache:{},_enumKeys:function(r,x,A,s){if(!xui.isObj(r)||xui.isArr(r)){return[]}A=A!==false;var u=this,b=r.$xui$,a,m,q=[];for(var g in r){if("prototype"==g||"constructor"==g){continue}if(b){if("upper"==g||"After"==g||"Before"==g||"Instance"==g||"Static"==g||"Constructor"==g){continue}}try{if(g.charAt(0)!="_"&&g.charAt(0)!="$"&&/^[\w_]+$/.test(g)){a=r[g];if(A&&(a&&a.$abstract)){continue}m=typeof a=="function"&&(!(a&&a.$xui$)||a.$asFunction);if(s&&(!r.hasOwnProperty(g)||!r.propertyIsEnumerable(g))){continue}var w=g;if(m){if(A){var j=xui.fun.args(a);var f=false;if(xui.str.endWith(x,".prototype")){f=true}var B=RAD.ClassTool.getArgsFromAPI(x.replace(".prototype",""),g,f);if(B){j=[];for(var d=0,c=B.length;d<c;d++){j[d]=B[d]&&B[d].name}}w=g+"("+j.join(", ")+")"}else{w=g+"( )"}}q.push(u._buildItem(g,(typeof a=="function")?(a&&a.$xui$&&!a.$asFunction)?"class":(a&&a.$event$)?"event":"function":"property",x,a,w,w))}}catch(n){console.log(n)}}return q},_getIntellisenseList:function(key,cachedata){if(!key){return null}cachedata=cachedata!==false;var ns=this,cache=ns._intellcache,buildItem=ns._buildItem;if(cachedata&&cache[key]){return cache[key]}var list=[];if(key==ns.$temppool){return[]}switch(key){case" variables ":list=[buildItem("xui",0,0,0,0,0,2,"font-weight:bold;color:#ff0000;"),buildItem("xui()",0,0,0,"xui()","xui()",2,"font-weight:bold;color:#ff0000;"),buildItem("top",0,0,0,0,0,3,"font-weight:bold;"),buildItem("parent",0,0,0,0,0,3,"font-weight:bold;"),buildItem("window",0,0,0,0,0,3,"font-weight:bold;"),buildItem("document",0,0,0,0,0,3,"font-weight:bold;"),buildItem("navigator",0,0,0,0,0,3,"font-weight:bold;"),buildItem("history",0,0,0,0,0,3,"font-weight:bold;"),buildItem("location",0,0,0,0,0,3,"font-weight:bold;"),buildItem("screen",0,0,0,0,0,3,"font-weight:bold;"),buildItem("Math",0,0,0,0,0,3,"font-weight:bold;"),buildItem("Number",0,0,0,0,0,3,"font-weight:bold;"),buildItem("console",0,0,0,0,0,3,"font-weight:bold;"),buildItem("if  ",0,0,0,"if...","if(){\n\n}",5),buildItem("ifelse",0,0,0,"if...else...","if(){\n\n}else{\n\n}",5),buildItem("while",0,0,0,"while...","while(){\n\n};",5),buildItem("do  ",0,0,0,"do...while","do{\n\n}while();",5),buildItem("try  ",0,0,0,"try...catch...finally","try{\n\n}catch(e){\n\n}finally{\n\n}",5),buildItem("for  ",0,0,0,"for...","for(;;;){\n\n}",5),buildItem("forin  ",0,0,0,"for...in","for( in ){\n\n}",5),buildItem("function",0,0,0,"function...","function(){\n\n}",5),buildItem("switch",0,0,0,"switch...","switch(){\n  case : \n\n  break;\n  case : \n\n  break;\ndefault: \n\n}",5),buildItem("with",0,0,0,"with...","with(){\n\n}",5),buildItem("return",0,0,0,"return","return ",4),buildItem("break",0,0,0,"break","break;",4),buildItem("continue",0,0,0,"continue","continue;",4),buildItem("throw",0,0,0,"throw","throw ",4),buildItem("new ",0,0,0,"new","new ",4),buildItem("delete",0,0,0,"delete","delete ",4),buildItem("arguments",0,0,0,"arguments","arguments",4),buildItem("var",0,0,0,"var","var ",4),buildItem("case",0,0,0,"case","case :",4),buildItem("default",0,0,0,"default","default :",4),buildItem("typeof",0,0,0,"typeof","typeof ",4),buildItem("instanceof",0,0,0,"instanceof","instanceof ",4),buildItem("void",0,0,0,"void","void",4),buildItem("true",0,0,0,"true","true",4),buildItem("false",0,0,0,"false","false",4),buildItem("null",0,0,0,"null","null",4),buildItem("NaN",0,0,0,"NaN","NaN",4),buildItem("undefined",0,0,0,"undefined","undefined",4),buildItem("Infinity",0,0,0,"Infinity","Infinity",4),buildItem("decodeURI()","function"),buildItem("decodeURIComponent()","function"),buildItem("encodeURI()","function"),buildItem("encodeURIComponent()","function"),buildItem("escape()","function"),buildItem("eval()","function"),buildItem("isFinite()","function"),buildItem("parseFloat()","function"),buildItem("parseInt()","function"),buildItem("unescape()","function"),buildItem("Number()","function"),buildItem("String()","function")];break;case"new":list=[buildItem("String","class",0,0,0,"String();",1),buildItem("Object","class",0,0,0,"Object();",1),buildItem("Array","class",0,0,0,"Array();",1),buildItem("RegExp","class",0,0,0,"RegExp();",1),buildItem("Boolean","class",0,0,0,"Boolean();",1),buildItem("Number","class",0,0,0,"Number();",1),buildItem("Date","class",0,0,0,"Date();",1),buildItem("xui.Dom","class",0,0,0,"xui.Dom();",2),buildItem("xui.UIProfile","class",0,0,0,"xui.UIProfile();",2),buildItem("xui.Module","class",0,0,0,"xui.Module();",2),buildItem("xui.Template","class",0,0,0,"xui.Template();",2),buildItem("xui.UI","class",0,0,0,"xui.UI();",2),buildItem("xui.DataBinder","class",0,0,0,"xui.DataBinder();",2)];break;case"history":case"screen":break;case"console":list=[buildItem("log()","function",key)];break;case"Math":list=[buildItem("E","property",key),buildItem("LN2","property",key),buildItem("LN10","property",key),buildItem("LOG2E","property",key),buildItem("LOG10E","property",key),buildItem("PI","property",key),buildItem("SQRT1_2","property",key),buildItem("SQRT2","property",key),buildItem("abs(x)","function",key),buildItem("acos(x)","function",key),buildItem("asin(x)","function",key),buildItem("atan(x)","function",key),buildItem("atan2(y,x)","function",key),buildItem("ceil(x)","function",key),buildItem("cos(x)","function",key),buildItem("exp(x)","function",key),buildItem("floor(x)","function",key),buildItem("log(x)","function",key),buildItem("max(x,y,z,...,n)","function",key),buildItem("min(x,y,z,...,n)","function",key),buildItem("pow(x,y)","function",key),buildItem("random()","function",key),buildItem("round(x)","function",key),buildItem("sin(x)","function",key),buildItem("sqrt(x)","function",key),buildItem("tan(x)","function",key)];break;case"Number":list=[buildItem("MAX_VALUE","property",key),buildItem("MIN_VALUE","property",key),buildItem("NEGATIVE_INFINITY","property",key),buildItem("POSITIVE_INFINITY","property",key)];break;case"Array.prototype":list=[buildItem("length","property",key),buildItem("concat()","function",key),buildItem("join()","function",key),buildItem("pop()","function",key),buildItem("push()","function",key),buildItem("reverse()","function",key),buildItem("shift()","function",key),buildItem("sort()","function",key),buildItem("concat()","function",key),buildItem("splice()","function",key),buildItem("toString()","function",key),buildItem("unshift()","function",key)];break;case"Date.prototype":list=[buildItem("getDate()","function",key),buildItem("getDay()","function",key),buildItem("getFullYear()","function",key),buildItem("getHours()","function",key),buildItem("getMilliseconds()","function",key),buildItem("getMinutes()","function",key),buildItem("getMonth()","function",key),buildItem("getTime()","function",key),buildItem("getSeconds()","function",key),buildItem("getTimezoneOffset()","function",key),buildItem("getUTCDate()","function",key),buildItem("getUTCDay()","function",key),buildItem("getUTCFullYear()","function",key),buildItem("getUTCHours()","function",key),buildItem("getUTCMilliseconds()","function",key),buildItem("getUTCMinutes()","function",key),buildItem("getUTCMonth()","function",key),buildItem("getUTCSeconds()","function",key),buildItem("getYear()","function",key),buildItem("parse()","function",key),buildItem("setDate()","function",key),buildItem("setFullYear()","function",key),buildItem("setHours()","function",key),buildItem("setMilliseconds()","function",key),buildItem("setMinutes()","function",key),buildItem("setMonth()","function",key),buildItem("setSeconds()","function",key),buildItem("setTime()","function",key),buildItem("setUTCDate()","function",key),buildItem("setUTCFullYear()","function",key),buildItem("setUTCHours()","function",key),buildItem("setUTCMilliseconds()","function",key),buildItem("setUTCMinutes()","function",key),buildItem("setUTCSeconds()","function",key),buildItem("setUTCMonth()","function",key),buildItem("setYear()","function",key),buildItem("toDateString()","function",key),buildItem("toGMTString()","function",key),buildItem("toLocaleDateString()","function",key),buildItem("toLocaleTimeString()","function",key),buildItem("toLocaleString()","function",key),buildItem("toString()","function",key),buildItem("toUTCString()","function",key),buildItem("toTimeString()","function",key),buildItem("UTC()","function",key)];break;case"String.prototype":list=[buildItem("length","property",key),buildItem("charAt()","function",key),buildItem("charCodeAt()","function",key),buildItem("concat()","function",key),buildItem("fromCharCode()","function",key),buildItem("indexOf()","function",key),buildItem("lastIndexOf()","function",key),buildItem("match()","function",key),buildItem("replace()","function",key),buildItem("search()","function",key),buildItem("slice()","function",key),buildItem("split()","function",key),buildItem("substr()","function",key),buildItem("substring()","function",key),buildItem("toLowerCase()","function",key),buildItem("toUpperCase()","function",key)];break;case"Object.prototype":list=[buildItem("toString()","function",key,0,0,0,"z"),buildItem("toLocaleString()","function",key,0,0,0,"z"),buildItem("hasOwnProperty(key)","function",key,0,0,0,"z"),buildItem("propertyIsEnumerable(key)","function",key,0,0,0,"z"),buildItem("isPrototypeOf(obj)","function",key,0,0,0,"z")];break;default:if(/\.prototype$/.test(key)){var bak=xui.Dom.pack,bak1=xui.absProfile.prototype.$link,bak11=xui.absObj.$pickAlias;xui.Dom.pack=function(){var o=new xui.Dom(false),d=document.getElementById("abc");o._nodes=[d];return o};xui.absProfile.prototype.$link=function(){return this};xui.absObj.$pickAlias=function(){return ns._alias++};try{var target=eval("new "+key.replace(/\.prototype$/,""));list=ns._enumKeys(target,key)}catch(e){}finally{xui.Dom.pack=bak;xui.absProfile.prototype.$link=bak1;xui.absObj.$pickAlias=bak11}}if(!list.length){var target=xui.get(window,key.split("."));list=ns._enumKeys(target,key);cachedata=false}}if(cachedata){cache[key]=list}return list},_getFromFunctionExp:function(b){var a;if(/toString\([^)]*\)$/.test(b)){a="String.prototype"}else{if(/^\s*\(?\s*new\s+([\wxui.]+)\s*\(?\s*[^)]*\)?\s*\)?(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/.test(b)){b=b.replace(/^\s*\(?\s*new\s+([\wxui.]+)\s*\(?\s*[^)]*\)?\s*\)?(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/,"$1");a=b+".prototype"}else{if(/.*\.reBoxing\(([^)]*)\)(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/.test(b)){b=b.replace(/.*\.reBoxing\(([^)]*)\)(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/,"$1");if(b){a=b.replace(/[\'\"]/g,"")+".prototype"}else{a="xui.Dom.prototype"}}else{if(b.indexOf("xui.alert(")==0||b.indexOf("xui.prompt(")==0||b.indexOf("xui.pop(")==0||b.indexOf("xui.confirm(")==0){a="xui.UI.Dialog.prototype"}else{if(b.indexOf("xui(")==0||b.indexOf("xui.use(")==0){a="xui.Dom.prototype"}else{if(b.indexOf("xui.Thread(")==0||b.indexOf("xui.Ajax(")==0||b.indexOf("xui.SAjax(")==0||b.indexOf("xui.IAjax(")==0||b.indexOf("xui.JSONP(")==0||b.indexOf("xui.XDMI(")==0){a="xui.Thread.prototype"}else{if(/.*\.(getRoot|getSubNode|getSubNodes)\s*\(\s*[^\)]*\)\s*$/.test(b)){a="xui.Dom.prototype"}else{if(/.*\.getElementById\s*\(\s*[^\)]*\)\s*$/.test(b)){a="Element.prototype"}}}}}}}}return a},_getFromObject:function(a){if(!xui.isSet(a)){return null}else{if(a===xui.str){return"xui.str"}else{if(a===xui.arr){return"xui.arr"}else{if(a===xui){return"xui"}else{if(a.$xui$){if(typeof a=="function"){return a.KEY}else{return a.KEY+".prototype"}}else{if(xui.isArr(a)){return"Array.prototype"}else{if(xui.isDate(a)){return"Date.prototype"}else{if(xui.isReg(a)){return"RegExp.prototype"}else{if(xui.isNumb(a)){return"Number.prototype"}else{if(xui.isStr(a)){return"String.prototype"}else{if(xui.isBool(a)){return"Boolean.prototype"}else{if(xui.isFun(a)){return"Function.prototype"}else{if(xui.isObj(a)){return"Object.prototype"}}}}}}}}}}}}}},_findVars:function(d,a,b){var j=this,m=d.$editor,f=[];if(m&&a){var l=m.win.document,g=function(u){return u.tagName=="BR"||u.tagName=="br"},s=function(u){return u.tagName=="B"||u.tagName=="b"},c=l.body.firstChild,r="",q,e,o=[],n;n=f;n.push(["this",""]);while((c=c.nextSibling)&&c!=a){if(s(c)&&c._uid&&c.id.charAt(0)=="b"){if(!b||b.indexOf(c.id)!==0){c=l.getElementById("e"+c.id.slice(1))}else{r=c._uid;xui.arr.each(o,function(u){u[1]=r});f=f.concat(o)}o=[];n=f}q=j.__trim(c.className);e=j.__trim(c.currentText);if(q=="js-keyword"&&e=="function"){while((c=c.nextSibling)&&c!=a&&(g(c)||j.__trim(c.className)=="whitespace"||j.__trim(c.className)=="js-comment")){}q=j.__trim(c.className);e=j.__trim(c.currentText);if(q=="js-variabledef"){n.push([e,r])}n=o;n.push(["this",r])}if(q=="js-variabledef"){n.push([e,r])}}}return f},_$key:function(a){ns=this;list=[ns._buildItem("$currPerson",0,0,0,"$currPerson","$currPerson",5),ns._buildItem("$currPerson.name",0,0,0,"name","name",5)];if(a=="$"){xui.Ajax("/admin/el/searchKey",function(b){var c=b;if(!c||c.error){xui.message("No module in this project!")}else{xui.arr.each(c.data,function(e){var d=ns._buildItem(e.id,0,0,0,e.desc,e.expression,5);list.push(d)})}},null,null,{method:"post",asy:false}).start()}if(xui.str.startWith(a,"$")&&xui.str.endWith(a,".")){xui.Ajax("/admin/el/searchMethod",{key:a},function(b){var c=b;if(!c||c.error){xui.message("No module in this project!")}else{xui.arr.each(c.data,function(e){var d=ns._buildItem(e.id,0,0,0,e.desc,e.lastStr,5);list.push(d)})}},null,null,{method:"post",asy:false}).start()}return list},_reSetStyle:function(){var a=this;xui.ModuleFactory.newModule("RAD.EditorTheme",function(){this.show();this.initData();this.setEvents("onOK",function(e,b,c){var d=CONF.getStatus();d.editorTheme=e;d.editorFontSize=b;d.lineWrapping=c;CONF.saveStatus(d);a.resetEditorStyle(e,b,c)})})},_getIntellisense:function(d,D,g,A){var E=this,s=RAD.ClassTool._this;if(xui.str.startWith(D,"$")){type="$"}else{if(D.indexOf("new ")==0){type="new"}else{if(D.charAt(D.length-1)=="."){type="properties";D=D.slice(0,-1)}else{if(D.indexOf(".")!=-1){type="properties";D=D.slice(0,D.lastIndexOf("."))}else{type="var"}}}if(type=="properties"){if(D.indexOf("(")!=-1){type="function"}}}var C,a,B=[],r,j,u=[];switch(type){case"new":r=type;break;case"$":B=this._$key(D);break;case"function":type=E._getFromFunctionExp(D);if(type){r=type;break}case"properties":if(D=="arguments"||D=="arguments.callee"){r=D;break}else{var c=[],l=[],a=d.$cm.getValue(),q=RAD.ClassTool.getContextAssignments(a,g),n=RAD.ClassTool.getClassStructWithScope(a,g,E.$temppool,d.$xid);c.push("(function(){try{\n");c.push("var "+s+"=window;\n");l.push(s);var f=false,e=false,x=q.vars.length;for(var w=0;w<x;w++){c.push("var "+q.vars[w]+"=undefined;\n");l.push(q.vars[w])}for(var w=-1;w<x;w++){if(q.scopeS==-1||w>=q.scopeS){if(!f){f=true;var m;if(q.secondKey&&q.secondType=="function"){m=xui.get(n,["sub",q.firstKey,"sub",q.secondKey])}else{if(q.firstKey&&q.firstType=="function"){m=xui.get(n,["sub",q.firstKey])}}if(m){c.push("try{"+s+"="+m._this+"}catch(e){};\n");xui.arr.each(m.argsv,function(o,F){if(!m.args||!m.args[F]){return false}if(o.code){c.push("try{"+m.args[F]+"="+o.code+"}catch(e){};\n");l.push(m.args[F])}else{if(/\.prototype$/.test(o.type)){c.push("try{"+m.args[F]+"="+o.type.replace(/(.+)(\.prototype)$/,"new $1();")+"}catch(e){};\n");l.push(m.args[F])}else{c.push("try{"+m.args[F]+"="+o.type+"}catch(e){};\n");l.push(m.args[F])}}})}}}if(q.scopeS!=-1&&w>=q.scopeE){if(!e){e=true;c.push("try{"+s+"=window;}catch(e){};\n")}}if(w>=0){c.push("try{"+q.vars[w]+"="+q.code[w]+";}catch(e){};\n");l.push(q.vars[w])}}if(q.scopeS!=-1&&q.outscope){if(!e){c.push("try{"+s+"={};}catch(e){};\n")}}c.push("return ("+D+");\n}catch(e){}finally{\n");xui.arr.removeValue(l,D);c.push(l.join("=")+"=null;\n");c.push("}\n}).call({});\n");j=c.join("").replace(/\bthis\b/g,s)}break;case"var":r=" variables ";var b=RAD.ClassTool.getContextVars_fast(d.$cm,g);if(b["this"]){u.push(E._buildItem("this",0,0,0,0,0,1,"color:#ff0000;"));delete b["this"]}if(b["arguments"]){u.push(E._buildItem("arguments",0,0,0,0,0,1,"color:#ff0000;"));delete b["arguments"]}xui.each(b,function(G,F){u.push(E._buildItem(F,"var",0,0,0,0,1,"color:#666;"))});break}if(u&&u.length){if(!A){Array.prototype.push.apply(B,u)}}if(j){result=E.evalInSandbox(j,false,null,d.$xid);if(xui.isSet(result.ok)){if(result.type){r=result.type}else{r=E._getFromObject(result.ok);if(!A){Array.prototype.push.apply(B,E._enumKeys(result.ok,r,true,true))}}}}if(r){if(!A){Array.prototype.push.apply(B,E._getIntellisenseList(r))}}if(B.length){B=xui.arr.removeDuplicate(B,"id");xui.arr.stableSort(B,function(o,F){return o.tag>F.tag?1:o.tag==F.tag?0:-1})}return[r,B,D]},_loadEditor:function(l){var O=this,F=RAD.ClassTool._this;var B=false,u=null,g=null,n="CodeEditor.showSuggetion.resetRun",o="CodeEditor.adjustSuggetion.resetRun",b="",N=false,L;var P=function(V){var Q=/\s+/g,U=[],T="",Y=l.$cm,W=Y.doc.posFromIndex(V),aa=W.line,R=Y.getTokenAt(W),S=function(ac){if(ac.start===0){W.line--;if(W.line===0){return null}var ab=Y.doc.getLine(W.line);if(ab){W.ch=ab.length}else{return null}}else{W.ch=ac.start}return Y.getTokenAt(W)};if(!(R.type===null&&R.string==".")){T=O.__trim(R.string);R=S(R)}if(R&&(R.type===null&&R.string==".")){do{if(R.type===null&&R.string=="."){while(R=S(R)){if(!(!R||R.type=="comment"||R.type=="tab"||(R.type===null&&/^\s+$/.test(R.string)))){break}}if(R){var Z="";if(R.type===null&&R.string===")"){var X=0;do{if(R.type===null&&R.string===")"){X++}if(R.type===null&&R.string==="("){X--}if(R.string){Z=R.string+Z}}while((R=S(R))&&X!==0)}if(R){if(R.type=="property"||R.type=="variable"||R.type=="variable-2"||R.type=="xuiglobal"||(R.type=="keyword"&&R.string=="this")){U.push(R.string.replace(Q,"")+Z)}else{if(Z){U.push(Z)}else{break}}}}}else{break}}while(R=S(R))}else{if(R&&(R.type==null&&R.string===" ")){while(R=S(R)){if(!(!R||R.type=="comment"||(R.type==null&&R.string===" "))){break}}if(R.type=="keyword"&&R.string=="new"){T="new "+T}}}return(U.length?(U.reverse().join(".")+"."):"")+T};var e=function(){var S=this,R=[],Q=function(T){R.push(T.get(0))};Q((new xui.UI.Pane).setHost(S,"$popList").setLeft(10).setTop(10).setWidth(300).setHeight(180));S.$popList.append((new xui.UI.List).setHost(S,"$lstsug").setTheme("codemirror").setDirtyMark(false).setTop(18).setWidth(300).setHeight(162).setItemRow(true).setDisableHoverEffect(true));S.$popList.append((new xui.UI.Block).setHost(S,"block1").setLeft(0).setTop(0).setWidth(300).setHeight(24).setBorderType("flat"));S.block1.append((new xui.UI.Label).setHost(S,"$objType").setLeft(6).setTop(2).setWidth(252).setCaption("").setHAlign("left").setCustomStyle({KEY:"font-weight:bold;"}));Q((new xui.UI.Block).setHost(S,"$popHelp").setLeft(410).setTop(10).setWidth(300).setHeight(180).setBorderType("flat").setOverflow("hidden").setBackground("#FFF8DC"));S.$popHelp.append((new xui.UI.Div).setHost(S,"$divhelp").setTheme("codemirror").setLeft(-1).setTop(19).setWidth(300).setHeight(160).setCustomStyle({KEY:"overflow:auto; padding:4px;"}));S.$popHelp.append((new xui.UI.Block).setHost(S,"block3").setLeft(-1).setTop(-1).setWidth(300).setHeight(20).setBorderType("flat"));S.block3.append((new xui.UI.Link).setHost(S,"$linkAPI").setLeft("auto").setRight(2).setTop(1).setCaption("$RAD.JSEditor.clickapi"));S.block3.append((new xui.UI.Label).setHost(S,"$lblTips").setLeft(6).setTop(2).setWidth(133).setCaption("").setHAlign("left"));return R};var K={moveFocus:function(T){var V=l.$lstsug,Q=V.get(0).properties.items,S=Q.length,U=V.getUIValue(),R=xui.arr.subIndexOf(Q,"id",U);if(T===true){R=0}else{if(T===false){R=S-1}else{R+=T;if(R<0){R=0}if(R>S-1){R=S-1}}}if(Q[R]){V.setUIValue(Q[R].id,true)}},close:function(){f()},pick:function(){var U=l.$lstsug,Q=U.get(0).properties.items,S=Q.length,T=U.getUIValue(),R=xui.arr.subIndexOf(Q,"id",T);if(Q[R]){a(Q[R].value||Q[R].caption)}f()}};var C={Up:function(){K.moveFocus(-1)},Down:function(){K.moveFocus(1)},PageUp:function(){K.moveFocus(-8,true)},PageDown:function(){K.moveFocus(8,true)},Home:function(){K.moveFocus(true)},End:function(){K.moveFocus(false)},Enter:function(){K.pick()},Tab:function(){K.pick()},Esc:function(){K.close()}};var c=function(af,V,S,Q){var X=l.box._getIntellisense(l,af,V),W=X[0],ac=this,Y=X[1];Q=Q||af||"";if(!W&&!(Y&&Y.length)){f();return}if(!S){var ag=false,aa=Q.toLowerCase();xui.arr.each(Y,function(ah){if(xui.str.startWith(ah.id.toLowerCase(),aa)){ag=true;return false}});if(!ag){return}}var ad=r.cursorCoords(true,"page"),R=ad.left,ab=ad.top;if(!l.$popList){e.call(l);xui("body").append(l.$popList.setDisplay("none"));xui("body").append(l.$popHelp.setDisplay("none"));l.$divhelp.getRoot().setSelectable(true);l.$linkAPI.onClick(function(ah){CONF.openAPI(ah.properties.tag)});var T=true,U=function(){xui.resetRun("codemirror:aaa",function(){if(T&&l.$popCustom){l.$popCustom.setDisplay("none")}})};l.$lstsug.afterUIValueSet(function(aj,ai,ah){D(aj.getItemByItemId(ah))}).onClick(function(ah,ai){a(ai.value||ai.caption);f()})}if((Y&&Y.length)||S){B=S?1:true;if(Y&&Y.length){l.$lstsug.setItems(Y)}var Z=function(){f()},ae=xui([l.$popList.getRootNode(),l.$popHelp.getRootNode(),l.getSubNode("BOX").get(0)]);l.$popList.getRoot().popToTop({region:{left:R,top:ab,width:2,height:16}},1).setBlurTrigger(n,Z,ae);xui.Event.keyboardHook("esc",0,0,0,Z);l.$popList.setDisplay("");L=X[2]||null;if(Y&&Y.length){d(R,ab,Q,"",true,true)}}l.$objType.setCaption(W||"none");l.$cm.removeKeyMap(C);l.$cm.addKeyMap(C)};var f=function(){xui.Event.keyboardHook("esc",0,0,0);l.$cm.removeKeyMap(C);xui.resetRun(n);xui.resetRun(o);u=null;g=null;B=false;N=false;if(l.$popList){l.$objType.setCaption("");l.$lstsug.setItems([]).setUIValue(null);l.$popList.setDisplay("none");l.$lblTips.setCaption("");l.$divhelp.setHtml("");l.$popHelp.setDisplay("none");if(l.$popCustom){l.$popCustom.setDisplay("none")}b=null}};var d=function(S,Y,V,U,R,Q){if(!l.$lstsug){return}var T=l.$lstsug.get(0),X=T.properties.items,W=function(){if(R&&!B){return}var Z;if(U){V+=U}if(!xui.isSet(b)||V!==b){b=V;xui.arr.each(X,function(aa){if(xui.str.startWith(aa.id.toLowerCase(),b.toLowerCase())){Z=aa.id;return false}});while(!Z&&V.length){V=V.substring(0,V.length-1);if(!V){break}xui.arr.each(X,function(aa){if(xui.str.startWith(aa.id.toLowerCase(),V.toLowerCase())){Z=aa.id;return false}})}if(!Z){Z=X[0].id}}if(!T.properties.$UIvalue&&!Z&&T.properties.items&&T.properties.items.length){Z=T.properties.items[0].id}if(Z){T.boxing().setUIValue(Z)}else{f();return}l.$popList.getRoot().popToTop({region:{left:S,top:Y,width:2,height:16}},1);if(l.$popHelp&&l.$popHelp.getDisplay()!="none"){l.$popHelp.getRoot().popToTop(l.$popList.getRoot(),2)}};if(!Q){W()}else{xui.resetRun(o,W,100)}};var A=function(Q,R){if(!l.$popHelp){return}if(l.$popList.getDisplay()!="none"){l.$linkAPI.setTag(Q);l.$lblTips.setCaption(Q);l.$divhelp.setHtml(R);l.$popHelp.getRoot().popToTop(l.$popList.getRoot(),2);l.$popHelp.setDisplay("")}};var M=function(Q,R){if(!l.$popHelp){return}l.$linkAPI.setTag(null);l.$lblTips.setCaption("");l.$divhelp.setHtml("");l.$popHelp.setDisplay("none")};var E=function(R){if(!l.$popHelp){return}var Q=P(R);var S=l.onGetHelpInfo&&l.boxing().onGetHelpInfo(l,Q.key);if(S){A(Q.key,S)}else{M()}};var D=function(Q){if(!l.$popHelp){return}if(!Q){return}var R=l.onGetHelpInfo&&l.boxing().onGetHelpInfo(l,Q.path);if(R){A(Q.path,R)}else{M()}};var s=function(R,S,T,Q){u=g=null;N=true;xui.resetRun(n,function(){var U=P(R);if(!U){f()}else{N=false;if(U!=T){c(U,R,true,T)}}},100);u=S;g=Q};var H=function(R,Q,S){xui.resetRun(n,function(){c(R,Q)});u=S};var q=function(R,Q,S){var W=g||u;if(W&&W.line==S.line&&W.start==S.start){var V=r.cursorCoords(true,"page"),U=V.left,T=V.top;d(U,T,R,"",true)}u=S};var a=function(S){var R=l.$cm,T=u;R.replaceRange(S,{line:T.line,ch:T.start},{line:T.line,ch:T.end});var Q=T.line,U;S.replace(/\n/g,function(){R.indentLine(++Q);U=1});R.setCursor({line:T.line+(U?1:0),ch:T.start+S.length});R.execCommand("indentAuto")};var G=l.properties.codeType,x=CONF.getRenderMode(l.properties.codeType);if(!x){x=CONF.getRenderMode("txt")}var m={value:l.properties.value||"",smartIndent:true,indentUnit:4,tabSize:4,indentWithTabs:false,mode:x.mime,keyMap:"sublime",matchBrackets:true,continueComments:"Enter",autoCloseBrackets:true,lineNumbers:true,lint:(G=="js"||G=="json"||G=="css"||G=="html")?true:false,readOnly:l.properties.readonly,styleActiveLine:true,lineWrapping:false,flattenSpans:false,highlightSelectionMatches:{showToken:/^[$\w]\w*/},foldGutter:true,gutters:["CodeMirror-lint-markers","CodeMirror-linenumbers","CodeMirror-foldgutter"],extraKeys:{Ctrl:function(){f()},"Ctrl-Q":function(Q){Q.foldCode(Q.getCursor())},"Ctrl-S":function(){f();if(l.onSaveCommand){l.boxing().onSaveCommand(l)}},"Ctrl-F":function(Q){f();RAD.EditorTool.showFindWnd(l.boxing(),{left:0,top:0},Q.getSelection())},Tab:function(Q){if(Q.doc.somethingSelected()){return CodeMirror.Pass}var R=Array(Q.getOption("indentUnit")+1).join(" ");Q.replaceSelection(R,"end","+input")},"Ctrl-D":function(Q){Q.execCommand("deleteLine")}}};var w=CONF.getStatus(),I=w.editorTheme,j=w.editorFontSize,J=w.lineWrapping;if(I){l.boxing().addCMTheme(I);m.theme=I}if(xui.isSet(J)){m.lineWrapping=!!J}var r=l.$cm=new CodeMirror(function(Q){l.getSubNode("BOX").append(Q);if(j){Q.style.fontSize=j+"px"}},m);CodeMirror.modeURL="/plugins/codemirror5/mode/%N/%N.js";CodeMirror.autoLoadMode(r,x.mode);if(l.onCodeModeSet){xui.asyRun(function(){if(!l.box){return}l.boxing().onCodeModeSet(l,x)})}if(x.mode=="null"){if(!l.$initialized){l.$initialized=true}if(l.onRendered){l.boxing().onRendered(l,true)}}else{r.on("rendered",function(Q,R){if(!l.$initialized){l.$initialized=true}if(l.onRendered){l.boxing().onRendered(l,R)}})}r.on("change",function(Q,V){if(l.$initialized&&l.onValueChanged){l.boxing().onValueChanged(l,Q.doc.getValue()!=l.properties.value)}var U;if(V.origin=="+input"){if(V.text[0]){if(V.text[0]=="."){V.to.ch++;var R=Q.getTokenAt(V.to),T=R.type;if(T!==null){return}var X=Q.getCursor();s(Q.doc.indexFromPos(X),{start:++R.start,end:++R.end,line:X.line});U=true}else{if(V.text[0]!==" "){V.to.ch++;var R=Q.getTokenAt(V.to),T=R.type;if(T=="variable"||T=="variable-2"||T=="keyword"||T=="property"){var X=Q.getCursor();if(X.line==V.to.line&&X.ch>=R.start&&X.ch<=R.end){if(B){q(R.string,Q.doc.indexFromPos(X),{start:R.start,end:R.end,line:X.line})}else{if(T=="property"){var S=Q.getTokenAt({line:V.to.line,ch:V.to.ch-R.string.length});if(S.type!==null||S.string!=="."){return}s(Q.doc.indexFromPos(X)-V.text.length-1,null,R.string,{start:++S.start,end:++S.end,line:X.line})}else{H(R.string,Q.doc.indexFromPos(X),{start:R.start,end:R.end,line:X.line})}}U=true}}}}}}else{if(V.origin=="+delete"){if(B){var R=Q.getTokenAt(V.to),T=R.type,W=R.string;if(B===true){if(T=="variable"||T=="variable-2"||T=="keyword"){var X=Q.getCursor();if(X.line==V.to.line&&X.ch>=R.start&&X.ch<=R.end){q(R.string,Q.doc.indexFromPos(X),{start:R.start,end:R.end,line:X.line});U=true}}}else{if(B===1){if(T=="property"){var X=Q.getCursor();q(R.string,Q.doc.indexFromPos(X),{start:R.start,end:R.end,line:X.line});U=true}else{if(T===null&&W=="."){var X=Q.getCursor();s(Q.doc.indexFromPos(X),{start:++R.start,end:++R.end,line:X.line});U=true}}}}}}}if(!U){f()}});r.on("blur",function(){});r.on("keypress",function(Q,R){if(N&&xui.Event.getKey(R)[0]!="."){f()}});r.on("keydown",function(Q,R){if(N&&xui.Event.getKey(R)[0]!="."){f()}});r.on("cursorActivity",function(Q){if(!Q.hasFocus()){return}if(u){var S=Q.getCursor(),R=u;if(S.line!==R.line||S.ch<R.start||S.ch>R.end){f()}}xui.resetRun("cm_showtips",function(){var V=Q.state.matchHighlighter;if(V){if(V.overlay&&V.style=="matchhighlight"&&Q.doc.somethingSelected()){var W=Q.getCursor(),U=Q.doc.getSelection(),T=Q.getTokenAt(W);if(U===T.string){s(Q.doc.indexFromPos(W),{start:T.start,end:T.end,line:W.line},T.string)}}}},200)})},_onresize:function(d,c,a){var b=arguments.callee.upper.apply(this,arguments);d.getSubNode("BOX").cssSize(b);if(d.$cm){d.$cm.setSize(d.$px(b.width),d.$px(b.height))}}}});xui.Class("RAD.expression.CodeEditor",["xui.UI.Widget","xui.absValue"],{Instance:{activate:function(){var a=this.get(0);if(a.$cm){a.$cm.focus()}if(a.$cm){a.$cm.doc.setCursor(a.readonly_head||0+1,0)}return this},getCM:function(){return this.get(0).$cm},resetEditorStyle:function(e,b,d,a){this.addCMTheme(e);var c=this.get(0);if(!a){a=c.$cm}if(a){a.setOption("theme",e);a.setOption("lineWrapping",!!d);var f=a.getWrapperElement();if(f){f.style.fontSize=b+"px"}}},showModeSelDlg:function(d){var c=this,a=c.getCM(),b=c.get(0),e=function(f){if(!f||f.mode==="none"){if(!b.$initialized){b.$initialized=true}if(b.onRendered){b.boxing().onRendered(b,true)}}else{a.setOption("mode",f.mime||f.mode);CodeMirror.autoLoadMode(a,f.mode);if(b.onCodeModeSet){b.boxing().onCodeModeSet(b,f)}}b=a=null};xui.ModuleFactory.newCom("RAD.expression.SelRenderMode",function(){this.setEvents("onSel",e);this.mainDlg.showModal();this.modeList.setValue(d.mime+":"+d.mode)})},addCMTheme:function(b){var a=this.get(0);var c="cm-theme-"+b;if(b!="default"&&!xui.CSS.get("id",c)){xui.CSS.includeLink("codemirror5/theme/"+b+".css",false,c)}},clearHistory:function(){var a=this.get(0).$cm;if(a){a.clearHistory()}},reindent:function(){var a=this.get(0).$cm,e=a.doc;if(e.somethingSelected()){var f=e.getCursor("start"),d=e.getCursor("end");for(var c=f.line,b=d.line;c<=b;c++){a.indentLine(c)}}else{var f=e.firstLine(),d=e.lastLine();for(var c=f,b=d;c<=b;c++){a.indentLine(c)}}},callEditor:function(c,b,a){var d=this.get(0).$cm;if(a){d=d.doc}return d[c].apply(d,b||[])},searchCode:function(c){var b=this.get(0),a=b.$cm;if(a){var d=a.getSearchCursor(c,a.hasFocus()?a.doc.getCursor():{pos:0,line:0},true);if(d.findNext()){a.focus();a.doc.setSelection(d.from(),d.to())}}},locateTo:function(m,l,f){var j=this,c=this.get(0),n=c.$cm,d,b,a,e;if(n){d=RAD.ClassTool.getClassStruct2(n.doc.getValue());if(m){if(l&&(m=="Static"||m=="Instance")){b=xui.get(d,["sub",m,"sub",l])}else{b=xui.get(d,["sub",m])}}if(b){if(f){n.doc.setSelection(n.doc.posFromIndex(b.from),n.doc.posFromIndex(b.to))}else{var g=n.doc.posFromIndex(b.from);n.focus();n.doc.setCursor(g);n.scrollIntoView(g)}return true}}return false},focusLine:function(b){var d=this,c=this.get(0),a=c.$cm,e={line:b,ch:0};if(a){a.focus();a.doc.setCursor(e);a.scrollIntoView(e)}},getLine:function(l,j,f){var g=this,c=this.get(0),m=c.$cm,d,b,a,e;if(m){d=RAD.ClassTool.getClassStruct2(m.doc.getValue());if(l){if(j&&(l=="Static"||l=="Instance")){b=xui.get(d,["sub",l,"sub",j])}else{b=xui.get(d,["sub",l])}}if(b){return m.doc.posFromIndex(b.from)}}return null},addCodeInto:function(n,m,a,f,e){e=e||"";var l=this,b=this.get(0),o=b.$cm;if(o){var d=RAD.ClassTool.getClassStructWithScope(o.getValue()),g=xui.get(d,["sub",n,"sub",m]),c;if(g){o.doc.replaceRange(a,o.doc.posFromIndex(g.from),o.doc.posFromIndex(g.to))}else{if(e){e+="\n"}g=xui.get(d,["sub",n]);if(!g){c=xui.get(d,["sub",d.arr[d.arr.length-1]]);if(c){a=",\n"+e+n+":{\n"+m+":"+(f?"function()":"")+a+"\n}"}else{a=n+":{\n"+e+m+":"+(f?"function()":"")+a+"\n}\n";c=d;c.to--}}else{c=xui.get(g,["sub",g.arr[g.arr.length-1]]);if(c){a=",\n"+e+m+":"+(f?"function()":"")+a}else{a=e+m+":"+(f?"function()":"")+a+"\n";c=g;c.to--}}var j=o.doc.posFromIndex(c.to);o.doc.replaceRange(a,j,j);o.doc.setSelection(j,o.doc.posFromIndex(c.to+a.length));l.reindent()}}},getBlockInfo:function(e,d){var c=this,b=this.get(0),a=b.$cm;return a&&xui.get(RAD.ClassTool.getClassStructWithScope(a.getValue()),["sub",e,"sub",d])},_refreshCM:function(){if(this.get(0).$cm){this.get(0).$cm.refresh()}},_setCtrlValue:function(a){if(!xui.isSet(a)){a=""}return this.each(function(b){if(b.$cm&&b.$cm.getValue()!=a){b.$cm.doc.setValue(a);if(b.$tm1){b.$tm1.clear()}if(b.$tm2){b.$tm2.clear()}delete b.$tm1;delete b.$tm2;delete b.readonly_head;delete b.readonly_tail}})},_getCtrlValue:function(){var a=this.get(0);if(a.$cm){return a.$cm.doc.getValue()}else{return a.properties.$UIvalue}},setReadonlyLines:function(b,a){var c=this.get(0),e=c.$cm.doc;if(c.$tm1){c.$tm1.clear()}if(c.$tm2){c.$tm2.clear()}if(b){c.$tm1=e.markText({line:0,ch:0},{line:b,ch:0},{atomic:true,readOnly:true,css:"background-color:#ccc;"})}if(a){var d=e.lastLine();c.$tm2=e.markText({line:d-a},{line:d},{atomic:true,readOnly:true,css:"background-color:#ccc;"})}c.readonly_head=b;c.readonly_tail=a}},Initialize:function(){var a=this.getTemplate();xui.merge(a.FRAME.BORDER,{BOX:{tagName:"div"}},"all");this.setTemplate(a);this.__trim=function(b){if(/[^\s\uFEFF\xA0]/.test(b)){return xui.str.trim(b)}else{return b}}},Static:{$tempsandbox:"_$temp_for_xui_sandbox",$tempsandbox2:"_$temp_for_xui_sandbox2",$temppool:"_$temp_for_xui_pool",Appearances:{BOX:{width:"100%",height:"100%",left:0,top:0,position:"absolute",background:"#fff"}},Behaviors:{},DataModel:{left:0,top:0,width:200,height:200,position:"absolute",codeType:{ini:"js",action:function(a){if(this.$cm){var b=CONF.getRenderMode(a);if(!b){b=CONF.getRenderMode("txt")}this.$cm.setOption("mode",b.mime||b.mode);if(this.onCodeModeSet){this.boxing().onCodeModeSet(this,b)}}}},readonly:{ini:false,action:function(a){if(this.$cm){this.$cm.setOption("readOnly",!!a)}}}},EventHandlers:{onValueChanged:function(b,a){},onRendered:function(a){},onGetHelpInfo:function(b,a){},onCodeModeSet:function(a,b){},onSaveCommand:function(){}},RenderTrigger:function(){var b=this.box.$temppool,a=this.$xid;this.box._loadEditor(this);this.destroyTrigger=function(){this.$cm.clearGutter();this.$cm.clearHistory();delete this.$cm;delete this.$tm1;delete this.$tm2;delete this.$editor;if(this.$popList){this.$popList.destroy()}if(this.$popHelp){this.$popHelp.destroy()}if(this.$popCustom){this.$popCustom.destroy()}if(window[b]){delete window[b][a]}}},clearSandbox:function(a){for(var b=1,d;b<9;b++){d=a+b;if(d&&document.getElementById(d)){document.body.removeChild(document.getElementById(d));try{delete frames[d]}catch(c){}}}},purge:function(){var a=this,b;if((b=window[a.$temppool])&&b.Instance&&b.Instance._ctrlpool){xui.each(b.Instance._ctrlpool,function(d,c){if(d&&!d.destroyed){if(d.destroy){d.destroy()}if(d.boxing&&d.boxing()){d.boxing().destroy()}}});xui.breakO(b.Instance)}},_alias:1,evalInSandbox:function(code,funScope,name,subCacheKey,purge,beforeCode,afterCode,cleanFun){if(name&&document.getElementById(name)){document.body.removeChild(document.getElementById(name));try{delete frames[name]}catch(e){}}var ns=this,iframe=document.createElement("iframe"),result,wnd,line,errmsg,type;ns.purge();if(name){iframe.name=name;iframe.id=name}iframe.src="about:blank";iframe.style.display="none";document.body.appendChild(iframe);wnd=frames[frames.length-1];wnd.document.open();wnd.document.write('<meta http-equiv="content-type" content="text/html; charset=utf-8" />');wnd.document.write("<script>\n");if(beforeCode){wnd.document.write(beforeCode)}wnd.document.write("global=process=Buffer=require=module=exports=root=null;\nwindow.xui=parent.xui;\nwindow.Class=function(){return xui.Class.apply(xui,arguments);};\nwindow.CONF={mixed_prop: xui.clone(parent.CONF.mixed_prop) };\n"+(CONF.SandBoxExtCode||"")+"window.__cache={};window.__getThis=function(pname,type){\n      if(__cache[pname+':'+type])return __cache[pname+':'+type];\n      var obj=type==1?function(){}:{};\n      if(pname){\n          if(xui.isArr(pname)){\n              xui.each(pname,function(cls){\n                  cls=xui.SC(cls);\n                  obj=xui.merge(obj, type==1?(cls||xui.Module):(cls?(new cls):(new xui.Module)),'all',true)\n              });\n          }else{\n              pname=xui.SC(pname);\n              obj=xui.merge(obj, type==1?(pname||xui.Module):(pname?(new pname):(new xui.Module)),'all',true)\n          }\n      }\n      if(window['"+ns.$temppool+"'] && window['"+ns.$temppool+"']['"+subCacheKey+"']){\n          obj=xui.merge(obj, window['"+ns.$temppool+"']['"+subCacheKey+"'][type==1?'Static':'Instance'],'all')\n      }\n      return __cache[pname+':'+type]=obj;\n  };\nwindow['"+ns.$temppool+"']=parent['"+ns.$temppool+"'];\nparent['"+ns.$tempsandbox+"']=/*@cc_on !@*/0?this:{eval:function(s){return (function(){var b=arguments.callee;return window.eval.call(window,s)})()}};\nparent['"+ns.$tempsandbox2+"']={getErrLine:function(s,cb){window.onerror=function(){cb.apply(null,arguments);return true;};var n=document.createElement('script');n.type='text/javascript';if(/*@cc_on !@*/0){n.text=s;}else{n.appendChild(document.createTextNode(s));};document.body.appendChild(n);window.onerror=null;}};\ntry{top=parent=null;}catch(e){}");if(afterCode){wnd.document.write(afterCode)}wnd.document.write("<\/script><body><span id='abc'></span></body>");wnd.document.close();var bak=xui.Dom.pack,bak1=xui.absProfile.prototype.$link,bak11=xui.absObj.$pickAlias,bak12=xui.UIProfile.prototype.setDomId,bak2=xui.require,bak3=xui.$cache,bak4=xui.asyRun,bak5=xui.resetRun,bak6=xui.exec,bak7=xui.pseudocode._callFunctions;try{xui.Dom.pack=function(){var o=new xui.Dom(false),d=document.getElementById("abc");o._nodes=[d];return o};xui.absProfile.prototype.$link=function(){return this};xui.Class.$instanceCreated=function(instance){instance.$inDesign=1};xui.absObj.$pickAlias=function(){return ns._alias++};xui.UIProfile.prototype.setDomId=function(){return this};xui.require=function(){};xui.$cache={};xui.each(bak3,function(o,i){xui.$cache[i]=xui.isArr(o)?[]:{}});xui.asyRun=xui.resetRun=xui.exec=xui.pseudocode._callFunctions=function(){};result=window[ns.$tempsandbox].eval(code);if(funScope){if(typeof(result)=="function"){result.call(funScope)}}type=(result===wnd||result===wnd.content)?"window":result===wnd.console?"console":result===wnd.history?"history":result===wnd.screen?"screen":result===wnd.location?"location":result===wnd.navigator?"navigator":result===wnd.document?"document":null;if(xui.browser.newie||(xui.browser.ie&&xui.browser.ver>=9)){var fun=function(hash){for(var i in hash){if(xui.isFun(hash[i])){hash[i]._____string=hash[i]+""}else{if(xui.isHash(hash[i])){fun(hash[i])}else{if(xui.isArr(hash[i])){fun(hash[i])}}}}};if(type===null&&(xui.isHash(result)||xui.isArr(result))){fun(result)}}}catch(e){if(xui.isSet(e.line||e.lineNumber)){line=e.line||e.lineNumber}else{var base=0;if(xui.browser.ie){window[ns.$tempsandbox2].getErrLine("var _a={;",function(a,b,c){base=c-1;return true})}window[ns.$tempsandbox2].getErrLine(code,function(a,b,c){line=c-base;return true})}errmsg=((e.name?e.name+" : ":"")+(e.description||e.message||"")+(line?"\n line : "+line:""));if(!xui.isSet(line)&&/.*at line ([\d]+).*/.test(errmsg)){line=errmsg.replace(/.*at line ([\d]+).*/,"$1")}}finally{if(purge){ns.purge()}delete xui.Class.$instanceCreated;xui.Dom.pack=bak;xui.absProfile.prototype.$link=bak1;xui.absObj.$pickAlias=bak11;xui.UIProfile.prototype.setDomId=bak12;xui.require=bak2;xui.$cache=bak3;xui.asyRun=bak4;xui.resetRun=bak5;xui.exec=bak6;xui.pseudocode._callFunctions=bak7;if(cleanFun){cleanFun(wnd,iframe)}wnd.CONF=wnd.Class=wnd.xui=wnd[ns.$temppool]=wnd.__getThis=wnd.__cache=null;if(CONF.ClearSandBoxExtCode){CONF.ClearSandBoxExtCode(wnd)}window[ns.$tempsandbox]=null;window[ns.$tempsandbox2]=null;var rsl={ok:result,type:type,ko:errmsg,line:line};ns=bak=result=line=errmsg=type=null;if(!name){document.body.removeChild(iframe)}iframe=null;return rsl}},_buildItem:function(j,d,c,g,b,f,a,e){return{id:j,caption:b||j,value:f||j,tag:(a||(d=="property"?"b":d=="function"?"c":d=="class"?"d":d=="event"?"e":"a"))+":"+j.toLowerCase(),path:(c?(c+"."):"")+j,itemStyle:e,imageClass:!d?null:(d=="property"?(xui.isSet(g)&&xui.isHash(g))?"spafont spa-icon-hash":(xui.isSet(g)&&xui.isArr(g))?"spafont spa-icon-array":"spafont spa-icon-var":d=="var"?"spafont spa-icon-var":d=="event"?"spafont spa-icon-action":d=="function"?"spafont spa-icon-function":d=="class"?"spafont spa-icon-class":"spafont spa-icon-prop")}},_intellcache:{},_enumKeys:function(r,x,A,s){if(!xui.isObj(r)||xui.isArr(r)){return[]}A=A!==false;var u=this,b=r.$xui$,a,m,q=[];for(var g in r){if("prototype"==g||"constructor"==g){continue}if(b){if("upper"==g||"After"==g||"Before"==g||"Instance"==g||"Static"==g||"Constructor"==g){continue}}try{if(g.charAt(0)!="_"&&g.charAt(0)!="$"&&/^[\w_]+$/.test(g)){a=r[g];if(A&&(a&&a.$abstract)){continue}m=typeof a=="function"&&(!(a&&a.$xui$)||a.$asFunction);if(s&&(!r.hasOwnProperty(g)||!r.propertyIsEnumerable(g))){continue}var w=g;if(m){if(A){var j=xui.fun.args(a);var f=false;if(xui.str.endWith(x,".prototype")){f=true}var B=RAD.ClassTool.getArgsFromAPI(x.replace(".prototype",""),g,f);if(B){j=[];for(var d=0,c=B.length;d<c;d++){j[d]=B[d]&&B[d].name}}w=g+"("+j.join(", ")+")"}else{w=g+"( )"}}q.push(u._buildItem(g,(typeof a=="function")?(a&&a.$xui$&&!a.$asFunction)?"class":(a&&a.$event$)?"event":"function":"property",x,a,w,w))}}catch(n){console.log(n)}}return q},_getIntellisenseList:function(key,cachedata){if(!key){return null}cachedata=cachedata!==false;var ns=this,cache=ns._intellcache,buildItem=ns._buildItem;if(cachedata&&cache[key]){return cache[key]}var list=[];if(key==ns.$temppool){return[]}switch(key){case" variables ":list=[buildItem("xui",0,0,0,0,0,2,"font-weight:bold;color:#ff0000;"),buildItem("xui()",0,0,0,"xui()","xui()",2,"font-weight:bold;color:#ff0000;"),buildItem("top",0,0,0,0,0,3,"font-weight:bold;"),buildItem("parent",0,0,0,0,0,3,"font-weight:bold;"),buildItem("window",0,0,0,0,0,3,"font-weight:bold;"),buildItem("document",0,0,0,0,0,3,"font-weight:bold;"),buildItem("navigator",0,0,0,0,0,3,"font-weight:bold;"),buildItem("history",0,0,0,0,0,3,"font-weight:bold;"),buildItem("location",0,0,0,0,0,3,"font-weight:bold;"),buildItem("screen",0,0,0,0,0,3,"font-weight:bold;"),buildItem("Math",0,0,0,0,0,3,"font-weight:bold;"),buildItem("Number",0,0,0,0,0,3,"font-weight:bold;"),buildItem("console",0,0,0,0,0,3,"font-weight:bold;"),buildItem("if  ",0,0,0,"if...","if(){\n\n}",5),buildItem("ifelse",0,0,0,"if...else...","if(){\n\n}else{\n\n}",5),buildItem("while",0,0,0,"while...","while(){\n\n};",5),buildItem("do  ",0,0,0,"do...while","do{\n\n}while();",5),buildItem("try  ",0,0,0,"try...catch...finally","try{\n\n}catch(e){\n\n}finally{\n\n}",5),buildItem("for  ",0,0,0,"for...","for(;;;){\n\n}",5),buildItem("forin  ",0,0,0,"for...in","for( in ){\n\n}",5),buildItem("function",0,0,0,"function...","function(){\n\n}",5),buildItem("switch",0,0,0,"switch...","switch(){\n  case : \n\n  break;\n  case : \n\n  break;\ndefault: \n\n}",5),buildItem("with",0,0,0,"with...","with(){\n\n}",5),buildItem("return",0,0,0,"return","return ",4),buildItem("break",0,0,0,"break","break;",4),buildItem("continue",0,0,0,"continue","continue;",4),buildItem("throw",0,0,0,"throw","throw ",4),buildItem("new ",0,0,0,"new","new ",4),buildItem("delete",0,0,0,"delete","delete ",4),buildItem("arguments",0,0,0,"arguments","arguments",4),buildItem("var",0,0,0,"var","var ",4),buildItem("case",0,0,0,"case","case :",4),buildItem("default",0,0,0,"default","default :",4),buildItem("typeof",0,0,0,"typeof","typeof ",4),buildItem("instanceof",0,0,0,"instanceof","instanceof ",4),buildItem("void",0,0,0,"void","void",4),buildItem("true",0,0,0,"true","true",4),buildItem("false",0,0,0,"false","false",4),buildItem("null",0,0,0,"null","null",4),buildItem("NaN",0,0,0,"NaN","NaN",4),buildItem("undefined",0,0,0,"undefined","undefined",4),buildItem("Infinity",0,0,0,"Infinity","Infinity",4),buildItem("decodeURI()","function"),buildItem("decodeURIComponent()","function"),buildItem("encodeURI()","function"),buildItem("encodeURIComponent()","function"),buildItem("escape()","function"),buildItem("eval()","function"),buildItem("isFinite()","function"),buildItem("parseFloat()","function"),buildItem("parseInt()","function"),buildItem("unescape()","function"),buildItem("Number()","function"),buildItem("String()","function"),buildItem("keySet[",0,0,0,"PK[0]","PK[0]",5),buildItem("PK",0,0,0,"PK['0']","PK['0']",4,"font-weight:bold;"),buildItem("absField",0,0,0,"absField()","absField(filed1,filed2,value,units)",5)];break;case"new":list=[buildItem("String","class",0,0,0,"String();",1),buildItem("Object","class",0,0,0,"Object();",1),buildItem("Array","class",0,0,0,"Array();",1),buildItem("RegExp","class",0,0,0,"RegExp();",1),buildItem("Boolean","class",0,0,0,"Boolean();",1),buildItem("Number","class",0,0,0,"Number();",1),buildItem("Date","class",0,0,0,"Date();",1),buildItem("xui.Dom","class",0,0,0,"xui.Dom();",2),buildItem("xui.UIProfile","class",0,0,0,"xui.UIProfile();",2),buildItem("xui.Module","class",0,0,0,"xui.Module();",2),buildItem("xui.Template","class",0,0,0,"xui.Template();",2),buildItem("xui.UI","class",0,0,0,"xui.UI();",2),buildItem("xui.DataBinder","class",0,0,0,"xui.DataBinder();",2)];for(var i in xui.UI){if(i!="upper"&&xui.UI[i].$xui$){list.push(buildItem("xui.UI."+i,"class",0,0,0," xui.UI."+i+"();",2))}}break;case"history":case"screen":break;case"PK[":buildItem("PK['0']",0,0,0,"PK['0']","PK[0]",5);break;case"console":list=[buildItem("log()","function",key)];break;case"arguments":list=[buildItem("callee","property",key),buildItem("length","property",key)];break;case"arguments.callee":list=[buildItem("caller","property",key),buildItem("length","property",key),buildItem("call()","function",key),buildItem("apply()","function",key)];break;case"top":case"parent":case"window":var iframe=document.createElement("iframe");iframe.style.display="none";document.body.appendChild(iframe);var target=frames[frames.length-1];list=ns._enumKeys(target,key,false);document.body.removeChild(iframe);break;case"document":var iframe=document.createElement("iframe");iframe.style.display="none";document.body.appendChild(iframe);var target=frames[frames.length-1];list=ns._enumKeys(target.document,key,false);document.body.removeChild(iframe);break;case"Element.prototype":var iframe=document.createElement("iframe");iframe.style.display="none";document.body.appendChild(iframe);var target=frames[frames.length-1];target.document.write("<span>a</span>");list=ns._enumKeys(target.document.body.firstChild,key,false);document.body.removeChild(iframe);break;case"Math":list=[buildItem("E","property",key),buildItem("LN2","property",key),buildItem("LN10","property",key),buildItem("LOG2E","property",key),buildItem("LOG10E","property",key),buildItem("PI","property",key),buildItem("SQRT1_2","property",key),buildItem("SQRT2","property",key),buildItem("abs(x)","function",key),buildItem("acos(x)","function",key),buildItem("asin(x)","function",key),buildItem("atan(x)","function",key),buildItem("atan2(y,x)","function",key),buildItem("ceil(x)","function",key),buildItem("cos(x)","function",key),buildItem("exp(x)","function",key),buildItem("floor(x)","function",key),buildItem("log(x)","function",key),buildItem("max(x,y,z,...,n)","function",key),buildItem("min(x,y,z,...,n)","function",key),buildItem("pow(x,y)","function",key),buildItem("random()","function",key),buildItem("round(x)","function",key),buildItem("sin(x)","function",key),buildItem("sqrt(x)","function",key),buildItem("tan(x)","function",key)];break;case"Number":list=[buildItem("MAX_VALUE","property",key),buildItem("MIN_VALUE","property",key),buildItem("NEGATIVE_INFINITY","property",key),buildItem("POSITIVE_INFINITY","property",key)];break;case"Array.prototype":list=[buildItem("length","property",key),buildItem("concat()","function",key),buildItem("join()","function",key),buildItem("pop()","function",key),buildItem("push()","function",key),buildItem("reverse()","function",key),buildItem("shift()","function",key),buildItem("sort()","function",key),buildItem("concat()","function",key),buildItem("splice()","function",key),buildItem("toString()","function",key),buildItem("unshift()","function",key)];break;case"Date.prototype":list=[buildItem("getDate()","function",key),buildItem("getDay()","function",key),buildItem("getFullYear()","function",key),buildItem("getHours()","function",key),buildItem("getMilliseconds()","function",key),buildItem("getMinutes()","function",key),buildItem("getMonth()","function",key),buildItem("getTime()","function",key),buildItem("getSeconds()","function",key),buildItem("getTimezoneOffset()","function",key),buildItem("getUTCDate()","function",key),buildItem("getUTCDay()","function",key),buildItem("getUTCFullYear()","function",key),buildItem("getUTCHours()","function",key),buildItem("getUTCMilliseconds()","function",key),buildItem("getUTCMinutes()","function",key),buildItem("getUTCMonth()","function",key),buildItem("getUTCSeconds()","function",key),buildItem("getYear()","function",key),buildItem("parse()","function",key),buildItem("setDate()","function",key),buildItem("setFullYear()","function",key),buildItem("setHours()","function",key),buildItem("setMilliseconds()","function",key),buildItem("setMinutes()","function",key),buildItem("setMonth()","function",key),buildItem("setSeconds()","function",key),buildItem("setTime()","function",key),buildItem("setUTCDate()","function",key),buildItem("setUTCFullYear()","function",key),buildItem("setUTCHours()","function",key),buildItem("setUTCMilliseconds()","function",key),buildItem("setUTCMinutes()","function",key),buildItem("setUTCSeconds()","function",key),buildItem("setUTCMonth()","function",key),buildItem("setYear()","function",key),buildItem("toDateString()","function",key),buildItem("toGMTString()","function",key),buildItem("toLocaleDateString()","function",key),buildItem("toLocaleTimeString()","function",key),buildItem("toLocaleString()","function",key),buildItem("toString()","function",key),buildItem("toUTCString()","function",key),buildItem("toTimeString()","function",key),buildItem("UTC()","function",key)];break;case"Number.prototype":list=[buildItem("toExponential()","function",key),buildItem("toFixed()","function",key),buildItem("toPrecision()","function",key),buildItem("toString()","function",key)];break;case"Boolean.prototype":list=[buildItem("toString()","function",key)];break;case"Function.prototype":list=[buildItem("toString()","function",key),buildItem("call()","function",key),buildItem("apply()","function",key)];break;case"RegExp.prototype":list=[buildItem("global","property",key),buildItem("ignoreCase","property",key),buildItem("multiline","property",key),buildItem("lastIndex","property",key),buildItem("source","property",key),buildItem("compile()","function",key),buildItem("exec()","function",key),buildItem("test()","function",key)];break;case"String.prototype":list=[buildItem("length","property",key),buildItem("charAt()","function",key),buildItem("charCodeAt()","function",key),buildItem("concat()","function",key),buildItem("fromCharCode()","function",key),buildItem("indexOf()","function",key),buildItem("lastIndexOf()","function",key),buildItem("match()","function",key),buildItem("replace()","function",key),buildItem("search()","function",key),buildItem("slice()","function",key),buildItem("split()","function",key),buildItem("substr()","function",key),buildItem("substring()","function",key),buildItem("toLowerCase()","function",key),buildItem("toUpperCase()","function",key)];break;case"Object.prototype":list=[buildItem("toString()","function",key,0,0,0,"z"),buildItem("toLocaleString()","function",key,0,0,0,"z"),buildItem("hasOwnProperty(key)","function",key,0,0,0,"z"),buildItem("propertyIsEnumerable(key)","function",key,0,0,0,"z"),buildItem("isPrototypeOf(obj)","function",key,0,0,0,"z")];break;default:if(/\.prototype$/.test(key)){var bak=xui.Dom.pack,bak1=xui.absProfile.prototype.$link,bak11=xui.absObj.$pickAlias;xui.Dom.pack=function(){var o=new xui.Dom(false),d=document.getElementById("abc");o._nodes=[d];return o};xui.absProfile.prototype.$link=function(){return this};xui.absObj.$pickAlias=function(){return ns._alias++};try{var target=eval("new "+key.replace(/\.prototype$/,""));list=ns._enumKeys(target,key)}catch(e){}finally{xui.Dom.pack=bak;xui.absProfile.prototype.$link=bak1;xui.absObj.$pickAlias=bak11}}if(!list.length){var target=xui.get(window,key.split("."));list=ns._enumKeys(target,key);cachedata=false}}if(cachedata){cache[key]=list}return list},_getFromFunctionExp:function(b){var a;if(/toString\([^)]*\)$/.test(b)){a="String.prototype"}else{if(/^\s*\(?\s*new\s+([\wxui.]+)\s*\(?\s*[^)]*\)?\s*\)?(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/.test(b)){b=b.replace(/^\s*\(?\s*new\s+([\wxui.]+)\s*\(?\s*[^)]*\)?\s*\)?(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/,"$1");a=b+".prototype"}else{if(/.*\.reBoxing\(([^)]*)\)(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/.test(b)){b=b.replace(/.*\.reBoxing\(([^)]*)\)(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/,"$1");if(b){a=b.replace(/[\'\"]/g,"")+".prototype"}else{a="xui.Dom.prototype"}}else{if(b.indexOf("xui.alert(")==0||b.indexOf("xui.prompt(")==0||b.indexOf("xui.pop(")==0||b.indexOf("xui.confirm(")==0){a="xui.UI.Dialog.prototype"}else{if(b.indexOf("xui(")==0||b.indexOf("xui.use(")==0){a="xui.Dom.prototype"}else{if(b.indexOf("xui.Thread(")==0||b.indexOf("xui.Ajax(")==0||b.indexOf("xui.SAjax(")==0||b.indexOf("xui.IAjax(")==0||b.indexOf("xui.JSONP(")==0||b.indexOf("xui.XDMI(")==0){a="xui.Thread.prototype"}else{if(/.*\.(getRoot|getSubNode|getSubNodes)\s*\(\s*[^\)]*\)\s*$/.test(b)){a="xui.Dom.prototype"}else{if(/.*\.getElementById\s*\(\s*[^\)]*\)\s*$/.test(b)){a="Element.prototype"}}}}}}}}return a},_getFromObject:function(a){if(!xui.isSet(a)){return null}else{if(a===xui.str){return"xui.str"}else{if(a===xui.arr){return"xui.arr"}else{if(a===xui){return"xui"}else{if(a.$xui$){if(typeof a=="function"){return a.KEY}else{return a.KEY+".prototype"}}else{if(xui.isArr(a)){return"Array.prototype"}else{if(xui.isDate(a)){return"Date.prototype"}else{if(xui.isReg(a)){return"RegExp.prototype"}else{if(xui.isNumb(a)){return"Number.prototype"}else{if(xui.isStr(a)){return"String.prototype"}else{if(xui.isBool(a)){return"Boolean.prototype"}else{if(xui.isFun(a)){return"Function.prototype"}else{if(xui.isObj(a)){return"Object.prototype"}}}}}}}}}}}}}},_findVars:function(d,a,b){var j=this,m=d.$editor,f=[];if(m&&a){var l=m.win.document,g=function(u){return u.tagName=="BR"||u.tagName=="br"},s=function(u){return u.tagName=="B"||u.tagName=="b"},c=l.body.firstChild,r="",q,e,o=[],n;n=f;n.push(["this",""]);while((c=c.nextSibling)&&c!=a){if(s(c)&&c._uid&&c.id.charAt(0)=="b"){if(!b||b.indexOf(c.id)!==0){c=l.getElementById("e"+c.id.slice(1))}else{r=c._uid;xui.arr.each(o,function(u){u[1]=r});f=f.concat(o)}o=[];n=f}q=j.__trim(c.className);e=j.__trim(c.currentText);if(q=="js-keyword"&&e=="function"){while((c=c.nextSibling)&&c!=a&&(g(c)||j.__trim(c.className)=="whitespace"||j.__trim(c.className)=="js-comment")){}q=j.__trim(c.className);e=j.__trim(c.currentText);if(q=="js-variabledef"){n.push([e,r])}n=o;n.push(["this",r])}if(q=="js-variabledef"){n.push([e,r])}}}return f},_$key:function(a){ns=this;list=[ns._buildItem("$currPerson",0,0,0,"$currPerson","$currPerson",5),ns._buildItem("$currPerson.name",0,0,0,"name","name",5)];if(a=="$"){xui.Ajax("/admin/el/searchKey",{projectName:SPA.curProjectName},function(b){var c=b;if(!c||c.error){xui.message("No module in this project!")}else{xui.arr.each(c.data,function(e){var d=ns._buildItem(e.id,0,0,0,e.desc,e.expression,5);list.push(d)})}},null,null,{method:"post",asy:false}).start()}if(xui.str.startWith(a,"$")&&xui.str.endWith(a,".")){xui.Ajax("/admin/el/searchMethod",{projectName:SPA.curProjectName,key:a},function(b){var c=b;if(!c||c.error){xui.message("No module in this project!")}else{xui.arr.each(c.data,function(e){var d=ns._buildItem(e.id,0,0,0,e.desc,e.lastStr,5);list.push(d)})}},null,null,{method:"post",asy:false}).start()}return list},_getIntellisense:function(d,D,g,A){var E=this,s=RAD.ClassTool._this;if(xui.str.startWith(D,"$")){type="$"}else{if(D.indexOf("new ")==0){type="new"}else{if(D.charAt(D.length-1)=="."){type="properties";D=D.slice(0,-1)}else{if(D.indexOf(".")!=-1){type="properties";D=D.slice(0,D.lastIndexOf("."))}else{type="var"}}}if(type=="properties"){if(D.indexOf("(")!=-1){type="function"}}}var C,a,B=[],r,j,u=[];switch(type){case"new":r=type;break;case"$":B=this._$key(D);break;case"function":type=E._getFromFunctionExp(D);if(type){r=type;break}case"properties":if(D=="arguments"||D=="arguments.callee"){r=D;break}else{var c=[],l=[],a=d.$cm.getValue(),q=RAD.ClassTool.getContextAssignments(a,g),n=RAD.ClassTool.getClassStructWithScope(a,g,E.$temppool,d.$xid);c.push("(function(){try{\n");c.push("var "+s+"=window;\n");l.push(s);var f=false,e=false,x=q.vars.length;for(var w=0;w<x;w++){c.push("var "+q.vars[w]+"=undefined;\n");l.push(q.vars[w])}for(var w=-1;w<x;w++){if(q.scopeS==-1||w>=q.scopeS){if(!f){f=true;var m;if(q.secondKey&&q.secondType=="function"){m=xui.get(n,["sub",q.firstKey,"sub",q.secondKey])}else{if(q.firstKey&&q.firstType=="function"){m=xui.get(n,["sub",q.firstKey])}}if(m){c.push("try{"+s+"="+m._this+"}catch(e){};\n");xui.arr.each(m.argsv,function(o,F){if(!m.args||!m.args[F]){return false}if(o.code){c.push("try{"+m.args[F]+"="+o.code+"}catch(e){};\n");l.push(m.args[F])}else{if(/\.prototype$/.test(o.type)){c.push("try{"+m.args[F]+"="+o.type.replace(/(.+)(\.prototype)$/,"new $1();")+"}catch(e){};\n");l.push(m.args[F])}else{c.push("try{"+m.args[F]+"="+o.type+"}catch(e){};\n");l.push(m.args[F])}}})}}}if(q.scopeS!=-1&&w>=q.scopeE){if(!e){e=true;c.push("try{"+s+"=window;}catch(e){};\n")}}if(w>=0){c.push("try{"+q.vars[w]+"="+q.code[w]+";}catch(e){};\n");l.push(q.vars[w])}}if(q.scopeS!=-1&&q.outscope){if(!e){c.push("try{"+s+"={};}catch(e){};\n")}}c.push("return ("+D+");\n}catch(e){}finally{\n");xui.arr.removeValue(l,D);c.push(l.join("=")+"=null;\n");c.push("}\n}).call({});\n");j=c.join("").replace(/\bthis\b/g,s)}break;case"var":r=" variables ";var b=RAD.ClassTool.getContextVars_fast(d.$cm,g);if(b["this"]){u.push(E._buildItem("this",0,0,0,0,0,1,"color:#ff0000;"));delete b["this"]}if(b["arguments"]){u.push(E._buildItem("arguments",0,0,0,0,0,1,"color:#ff0000;"));delete b["arguments"]}xui.each(b,function(G,F){u.push(E._buildItem(F,"var",0,0,0,0,1,"color:#666;"))});break}if(u&&u.length){if(!A){Array.prototype.push.apply(B,u)}}if(j){result=E.evalInSandbox(j,false,null,d.$xid);if(xui.isSet(result.ok)){if(result.type){r=result.type}else{r=E._getFromObject(result.ok);if(!A){Array.prototype.push.apply(B,E._enumKeys(result.ok,r,true,true))}}}}if(r){if(!A){Array.prototype.push.apply(B,E._getIntellisenseList(r))}}if(B.length){B=xui.arr.removeDuplicate(B,"id");xui.arr.stableSort(B,function(o,F){return o.tag>F.tag?1:o.tag==F.tag?0:-1})}return[r,B,D]},_loadEditor:function(l){var O=this,F=RAD.ClassTool._this;var B=false,u=null,g=null,n="CodeEditor.showSuggetion.resetRun",o="CodeEditor.adjustSuggetion.resetRun",b="",N=false,L;var P=function(V){var Q=/\s+/g,U=[],T="",Y=l.$cm,W=Y.doc.posFromIndex(V),aa=W.line,R=Y.getTokenAt(W),S=function(ac){if(ac.start===0){W.line--;if(W.line===0){return null}var ab=Y.doc.getLine(W.line);if(ab){W.ch=ab.length}else{return null}}else{W.ch=ac.start}return Y.getTokenAt(W)};if(!(R.type===null&&R.string==".")){T=O.__trim(R.string);R=S(R)}if(R&&(R.type===null&&R.string==".")){do{if(R.type===null&&R.string=="."){while(R=S(R)){if(!(!R||R.type=="comment"||R.type=="tab"||(R.type===null&&/^\s+$/.test(R.string)))){break}}if(R){var Z="";if(R.type===null&&R.string===")"){var X=0;do{if(R.type===null&&R.string===")"){X++}if(R.type===null&&R.string==="("){X--}if(R.string){Z=R.string+Z}}while((R=S(R))&&X!==0)}if(R){if(R.type=="property"||R.type=="variable"||R.type=="variable-2"||R.type=="xuiglobal"||(R.type=="keyword"&&R.string=="this")){U.push(R.string.replace(Q,"")+Z)}else{if(Z){U.push(Z)}else{break}}}}}else{break}}while(R=S(R))}else{if(R&&(R.type==null&&R.string===" ")){while(R=S(R)){if(!(!R||R.type=="comment"||(R.type==null&&R.string===" "))){break}}if(R.type=="keyword"&&R.string=="new"){T="new "+T}}}return(U.length?(U.reverse().join(".")+"."):"")+T};var e=function(){var S=this,R=[],Q=function(T){R.push(T.get(0))};Q((new xui.UI.Pane).setHost(S,"$popList").setLeft(10).setTop(10).setWidth(300).setHeight(180));S.$popList.append((new xui.UI.List).setHost(S,"$lstsug").setTheme("codemirror").setDirtyMark(false).setTop(18).setWidth(300).setHeight(162).setItemRow(true).setDisableHoverEffect(true));S.$popList.append((new xui.UI.Block).setHost(S,"block1").setLeft(0).setTop(0).setWidth(300).setHeight(24).setBorderType("flat"));S.block1.append((new xui.UI.Label).setHost(S,"$objType").setLeft(6).setTop(2).setWidth(252).setCaption("").setHAlign("left").setCustomStyle({KEY:"font-weight:bold;"}));Q((new xui.UI.Block).setHost(S,"$popHelp").setLeft(410).setTop(10).setWidth(300).setHeight(180).setBorderType("flat").setOverflow("hidden").setBackground("#FFF8DC"));S.$popHelp.append((new xui.UI.Div).setHost(S,"$divhelp").setTheme("codemirror").setLeft(-1).setTop(19).setWidth(300).setHeight(160).setCustomStyle({KEY:"overflow:auto; padding:4px;"}));S.$popHelp.append((new xui.UI.Block).setHost(S,"block3").setLeft(-1).setTop(-1).setWidth(300).setHeight(20).setBorderType("flat"));S.block3.append((new xui.UI.Link).setHost(S,"$linkAPI").setLeft("auto").setRight(2).setTop(1).setCaption("$RAD.JSEditor.clickapi"));S.block3.append((new xui.UI.Label).setHost(S,"$lblTips").setLeft(6).setTop(2).setWidth(133).setCaption("").setHAlign("left"));return R};var K={moveFocus:function(T){var V=l.$lstsug,Q=V.get(0).properties.items,S=Q.length,U=V.getUIValue(),R=xui.arr.subIndexOf(Q,"id",U);if(T===true){R=0}else{if(T===false){R=S-1}else{R+=T;if(R<0){R=0}if(R>S-1){R=S-1}}}if(Q[R]){V.setUIValue(Q[R].id,true)}},close:function(){f()},pick:function(){var U=l.$lstsug,Q=U.get(0).properties.items,S=Q.length,T=U.getUIValue(),R=xui.arr.subIndexOf(Q,"id",T);if(Q[R]){a(Q[R].value||Q[R].caption)}f()}};var C={Up:function(){K.moveFocus(-1)},Down:function(){K.moveFocus(1)},PageUp:function(){K.moveFocus(-8,true)},PageDown:function(){K.moveFocus(8,true)},Home:function(){K.moveFocus(true)},End:function(){K.moveFocus(false)},Enter:function(){K.pick()},Tab:function(){K.pick()},Esc:function(){K.close()}};var c=function(af,V,S,Q){var X=l.box._getIntellisense(l,af,V),W=X[0],ac=this,Y=X[1];Q=Q||af||"";if(!W&&!(Y&&Y.length)){f();return}if(!S){var ag=false,aa=Q.toLowerCase();xui.arr.each(Y,function(ah){if(xui.str.startWith(ah.id.toLowerCase(),aa)){ag=true;return false}});if(!ag){return}}var ad=r.cursorCoords(true,"page"),R=ad.left,ab=ad.top;if(!l.$popList){e.call(l);xui("body").append(l.$popList.setDisplay("none"));xui("body").append(l.$popHelp.setDisplay("none"));l.$divhelp.getRoot().setSelectable(true);l.$linkAPI.onClick(function(ah){CONF.openAPI(ah.properties.tag)});var T=true,U=function(){xui.resetRun("codemirror:aaa",function(){if(T&&l.$popCustom){l.$popCustom.setDisplay("none")}})};l.$lstsug.afterUIValueSet(function(aj,ai,ah){D(aj.getItemByItemId(ah))}).onClick(function(ah,ai){a(ai.value||ai.caption);f()})}if((Y&&Y.length)||S){B=S?1:true;if(Y&&Y.length){l.$lstsug.setItems(Y)}var Z=function(){f()},ae=xui([l.$popList.getRootNode(),l.$popHelp.getRootNode(),l.getSubNode("BOX").get(0)]);l.$popList.getRoot().popToTop({region:{left:R,top:ab,width:2,height:16}},1).setBlurTrigger(n,Z,ae);xui.Event.keyboardHook("esc",0,0,0,Z);l.$popList.setDisplay("");L=X[2]||null;if(Y&&Y.length){d(R,ab,Q,"",true,true)}}l.$objType.setCaption(W||"none");l.$cm.removeKeyMap(C);l.$cm.addKeyMap(C)};var f=function(){xui.Event.keyboardHook("esc",0,0,0);l.$cm.removeKeyMap(C);xui.resetRun(n);xui.resetRun(o);u=null;g=null;B=false;N=false;if(l.$popList){l.$objType.setCaption("");l.$lstsug.setItems([]).setUIValue(null);l.$popList.setDisplay("none");l.$lblTips.setCaption("");l.$divhelp.setHtml("");l.$popHelp.setDisplay("none");if(l.$popCustom){l.$popCustom.setDisplay("none")}b=null}};var d=function(S,Y,V,U,R,Q){if(!l.$lstsug){return}var T=l.$lstsug.get(0),X=T.properties.items,W=function(){if(R&&!B){return}var Z;if(U){V+=U}if(!xui.isSet(b)||V!==b){b=V;xui.arr.each(X,function(aa){if(xui.str.startWith(aa.id.toLowerCase(),b.toLowerCase())){Z=aa.id;return false}});while(!Z&&V.length){V=V.substring(0,V.length-1);if(!V){break}xui.arr.each(X,function(aa){if(xui.str.startWith(aa.id.toLowerCase(),V.toLowerCase())){Z=aa.id;return false}})}if(!Z){Z=X[0].id}}if(!T.properties.$UIvalue&&!Z&&T.properties.items&&T.properties.items.length){Z=T.properties.items[0].id}if(Z){T.boxing().setUIValue(Z)}else{f();return}l.$popList.getRoot().popToTop({region:{left:S,top:Y,width:2,height:16}},1);if(l.$popHelp&&l.$popHelp.getDisplay()!="none"){l.$popHelp.getRoot().popToTop(l.$popList.getRoot(),2)}};if(!Q){W()}else{xui.resetRun(o,W,100)}};var A=function(Q,R){if(!l.$popHelp){return}if(l.$popList.getDisplay()!="none"){l.$linkAPI.setTag(Q);l.$lblTips.setCaption(Q);l.$divhelp.setHtml(R);l.$popHelp.getRoot().popToTop(l.$popList.getRoot(),2);l.$popHelp.setDisplay("")}};var M=function(Q,R){if(!l.$popHelp){return}l.$linkAPI.setTag(null);l.$lblTips.setCaption("");l.$divhelp.setHtml("");l.$popHelp.setDisplay("none")};var E=function(R){if(!l.$popHelp){return}var Q=P(R);var S=l.onGetHelpInfo&&l.boxing().onGetHelpInfo(l,Q.key);if(S){A(Q.key,S)}else{M()}};var D=function(Q){if(!l.$popHelp){return}if(!Q){return}var R=l.onGetHelpInfo&&l.boxing().onGetHelpInfo(l,Q.path);if(R){A(Q.path,R)}else{M()}};var s=function(R,S,T,Q){u=g=null;N=true;xui.resetRun(n,function(){var U=P(R);if(!U){f()}else{N=false;if(U!=T){c(U,R,true,T)}}},100);u=S;g=Q};var H=function(R,Q,S){xui.resetRun(n,function(){c(R,Q)});u=S};var q=function(R,Q,S){var W=g||u;if(W&&W.line==S.line&&W.start==S.start){var V=r.cursorCoords(true,"page"),U=V.left,T=V.top;d(U,T,R,"",true)}u=S};var a=function(S){var R=l.$cm,T=u;R.replaceRange(S,{line:T.line,ch:T.start},{line:T.line,ch:T.end});var Q=T.line,U;S.replace(/\n/g,function(){R.indentLine(++Q);U=1});R.setCursor({line:T.line+(U?1:0),ch:T.start+S.length});R.execCommand("indentAuto")};var G=l.properties.codeType,x=CONF.getRenderMode(l.properties.codeType);if(!x){x=CONF.getRenderMode("txt")}var m={value:l.properties.value||"",smartIndent:true,indentUnit:4,tabSize:4,indentWithTabs:false,mode:x.mime,keyMap:"sublime",matchBrackets:true,continueComments:"Enter",autoCloseBrackets:true,lineNumbers:true,lint:(G=="js"||G=="json"||G=="css"||G=="html")?true:false,readOnly:l.properties.readonly,styleActiveLine:true,lineWrapping:false,flattenSpans:false,highlightSelectionMatches:{showToken:/^[$\w]\w*/},foldGutter:true,gutters:["CodeMirror-lint-markers","CodeMirror-linenumbers","CodeMirror-foldgutter"],extraKeys:{Ctrl:function(){f()},"Ctrl-Q":function(Q){Q.foldCode(Q.getCursor())},"Ctrl-S":function(){f();if(l.onSaveCommand){l.boxing().onSaveCommand(l)}},"Ctrl-F":function(Q){f();RAD.EditorTool.showFindWnd(l.boxing(),{left:0,top:0},Q.getSelection())},Tab:function(Q){if(Q.doc.somethingSelected()){return CodeMirror.Pass}var R=Array(Q.getOption("indentUnit")+1).join(" ");Q.replaceSelection(R,"end","+input")},"Ctrl-D":function(Q){Q.execCommand("deleteLine")}}};var w=CONF.getStatus(),I=w.editorTheme,j=w.editorFontSize,J=w.lineWrapping;if(I){l.boxing().addCMTheme(I);m.theme=I}if(xui.isSet(J)){m.lineWrapping=!!J}var r=l.$cm=new CodeMirror(function(Q){l.getSubNode("BOX").append(Q);if(j){Q.style.fontSize=j+"px"}},m);CodeMirror.modeURL="/plugins/codemirror5/mode/%N/%N.js";CodeMirror.autoLoadMode(r,x.mode);if(l.onCodeModeSet){xui.asyRun(function(){if(!l.box){return}l.boxing().onCodeModeSet(l,x)})}if(x.mode=="null"){if(!l.$initialized){l.$initialized=true}if(l.onRendered){l.boxing().onRendered(l,true)}}else{r.on("rendered",function(Q,R){if(!l.$initialized){l.$initialized=true}if(l.onRendered){l.boxing().onRendered(l,R)}})}r.on("change",function(Q,V){if(l.$initialized&&l.onValueChanged){l.boxing().onValueChanged(l,Q.doc.getValue()!=l.properties.value)}if(G!="js"&&G!="html"){return}var U;if(V.origin=="+input"){if(V.text[0]){if(V.text[0]=="."){if(G!="js"){return}V.to.ch++;var R=Q.getTokenAt(V.to),T=R.type;if(T!==null){return}var X=Q.getCursor();s(Q.doc.indexFromPos(X),{start:++R.start,end:++R.end,line:X.line});U=true}else{if(V.text[0]!==" "){V.to.ch++;var R=Q.getTokenAt(V.to),T=R.type;if(T=="variable"||T=="variable-2"||T=="keyword"||T=="property"){var X=Q.getCursor();if(X.line==V.to.line&&X.ch>=R.start&&X.ch<=R.end){if(B){q(R.string,Q.doc.indexFromPos(X),{start:R.start,end:R.end,line:X.line})}else{if(T=="property"){if(G!="js"){return}var S=Q.getTokenAt({line:V.to.line,ch:V.to.ch-R.string.length});if(S.type!==null||S.string!=="."){return}s(Q.doc.indexFromPos(X)-V.text.length-1,null,R.string,{start:++S.start,end:++S.end,line:X.line})}else{H(R.string,Q.doc.indexFromPos(X),{start:R.start,end:R.end,line:X.line})}}U=true}}}}}}else{if(V.origin=="+delete"){if(B){var R=Q.getTokenAt(V.to),T=R.type,W=R.string;if(B===true){if(T=="variable"||T=="variable-2"||T=="keyword"){var X=Q.getCursor();if(X.line==V.to.line&&X.ch>=R.start&&X.ch<=R.end){q(R.string,Q.doc.indexFromPos(X),{start:R.start,end:R.end,line:X.line});U=true}}}else{if(B===1){if(T=="property"){var X=Q.getCursor();q(R.string,Q.doc.indexFromPos(X),{start:R.start,end:R.end,line:X.line});U=true}else{if(T===null&&W=="."){var X=Q.getCursor();s(Q.doc.indexFromPos(X),{start:++R.start,end:++R.end,line:X.line});U=true}}}}}}}if(!U){f()}});r.on("blur",function(){});r.on("keypress",function(Q,R){if(G!="js"&&G!="html"){return}if(N&&xui.Event.getKey(R)[0]!="."){f()}});r.on("keydown",function(Q,R){if(G!="js"&&G!="html"){return}if(N&&xui.Event.getKey(R)[0]!="."){f()}});r.on("cursorActivity",function(Q){if(!Q.hasFocus()){return}if(G!="js"&&G!="html"){return}if(u){var S=Q.getCursor(),R=u;if(S.line!==R.line||S.ch<R.start||S.ch>R.end){f()}}xui.resetRun("cm_showtips",function(){var V=Q.state.matchHighlighter;if(V){if(V.overlay&&V.style=="matchhighlight"&&Q.doc.somethingSelected()){var W=Q.getCursor(),U=Q.doc.getSelection(),T=Q.getTokenAt(W);if(U===T.string){s(Q.doc.indexFromPos(W),{start:T.start,end:T.end,line:W.line},T.string)}}}},200)})},_onresize:function(d,c,a){var b=arguments.callee.upper.apply(this,arguments);d.getSubNode("BOX").cssSize(b);if(d.$cm){d.$cm.setSize(d.$px(b.width),d.$px(b.height))}}}});xui.Class("RAD.expression.ExpressionTemp","xui.Module",{Instance:{initialize:function(){},Dependencies:[],Required:[],properties:{path:"form/myspace/versionspace/projectManager/0/RAD/expression/ExpressionTemp.cls",personId:"devdev",personName:"devdev",projectName:"projectManager"},events:{afterShow:"_page_onrender"},functions:{},iniComponents:function(){var d=this,c=[],b={},a=function(e){c.push(e.get(0))};xui.merge(b,this.properties);a(xui.create("xui.APICaller").setHost(d,"loadapi").setName("loadapi").setAutoRun(true).setQueryURL("/admin/el/getServcieByType").setQueryMethod("POST").setRequestDataSource([{name:"xui_ui_dialog9",path:"",type:"form"}]).setResponseDataTarget([{name:"xui_ui_treeview19",path:"data",type:"treeview"}]).setResponseCallback([]));a(xui.create("xui.UI.Dialog").setHost(d,"xui_ui_dialog9").setLeft("1.6666666666666667em").setTop("3.3333333333333335em").setWidth("84.16666666666667em").setHeight("50.833333333333336em").setCaption("MIX代码编辑器").setImageClass("spafont spa-icon-function"));d.xui_ui_dialog9.append(xui.create("xui.UI.HiddenInput").setHost(d,"className").setName("className").setValue(""));d.xui_ui_dialog9.append(xui.create("xui.UI.Block").setHost(d,"xui_ui_block49").setName("buttongroup").setDock("bottom").setLeft("0em").setTop("0em").setHeight("3.5em"));d.xui_ui_block49.append(xui.create("xui.UI.Button").setHost(d,"savebutton").setName("savebutton").setLeft("32.416666666666664em").setTop("0.75em").setCaption("$RAD.widgets.esd.buttonsave").setImageClass("xui-icon-right"));d.xui_ui_block49.append(xui.create("xui.UI.Button").setHost(d,"closebutton").setName("closebutton").setLeft("42.416666666666664em").setTop("0.75em").setCaption("$RAD.widgets.esd.buttonclose").setImageClass("fa fa-lg fa-close").onChange([{args:[],desc:"动作 1",method:"destroy",target:"RAD.expression.ExpressionTemp",type:"page"}]));d.xui_ui_dialog9.append(xui.create("xui.UI.Block").setHost(d,"resourcemain").setName("resourcemain").setDock("fill").setLeft("0em").setTop("0em"));d.resourcemain.append(xui.create("xui.UI.Layout").setHost(d,"resourcelayout").setName("resourcelayout").setItems([{cmd:true,folded:false,id:"left",locked:false,min:10,pos:"before",size:200,hidden:false},{id:"main",min:10,size:80}]).setLeft("0em").setTop("0em").setType("horizontal"));d.resourcelayout.append(xui.create("xui.UI.Block").setHost(d,"content").setName("content").setBorderType("none").setDock("fill").setLeft("15.833333333333334em").setTop("13.333333333333334em"),"main");d.resourcelayout.append(xui.create("xui.UI.Block").setHost(d,"xui_ui_block60").setDock("fill").setLeft("0em").setTop("0em"),"left");d.xui_ui_block60.append(xui.create("xui.UI.HiddenInput").setHost(d,"projectName").setName("projectName").setValue(""));d.xui_ui_block60.append(xui.create("xui.UI.ComboInput").setHost(d,"pattern").setName("pattern").setDock("top").setLeft("3.6666666666666665em").setTop("2em").setWidth("18em").setLabelSize("6em").setLabelCaption("Expression:").setType("helpinput").setImageClass("xui-icon-code").onChange([{args:["{page.loadapi.setQueryData()}",null,null,"{args[2]}","pattern"],desc:"动作 1",method:"setQueryData",redirection:"other:callback:call",target:"loadapi",type:"control"},{args:["{page.loadapi.invoke()}",null,null,null,null,""],desc:"动作 2",koFlag:"_DI_fail",method:"invoke",okFlag:"_DI_succeed",redirection:"other:callback:call",target:"loadapi",type:"control"}]));d.xui_ui_block60.append(xui.create("xui.UI.ToolBar").setHost(d,"servicetool").setItems([{caption:"any",hidden:false,id:"any",sub:[{caption:"",hidden:false,iconFontSize:"",id:"refresh",imageClass:"xui-refresh",position:"absolute",tips:"$RAD.tool2.refresh"},{caption:"",hidden:false,iconFontSize:"",id:"import",imageClass:"xui-uicmd-add",position:"absolute",tips:"$RAD.toolbox.importapi"}]}]).onClick(["_toolbar_onclick"]).setCustomStyle({ITEMS:{"border-top":"0","border-bottom":"0"}}));d.xui_ui_block60.append(xui.create("xui.UI.TreeBar").setHost(d,"treebarCom").setSelMode("none").onChange(["_xui_ui_treeview19_onchange"]).onGetContent(["_treebarcom_ongetcontent"]).onItemSelected(["_xui_ui_treeview19_onitemselected"]).setCustomStyle({KEY:{"background-color":"#FFFFFF"}}));return c},customAppend:function(b,a,d,c){return false},_reload:function(a,b){ns=this;ns.treebarCom.setItems(ns._buildItems(this.topNodes));ns.treebarCom.fireItemClickEvent("pageService")},_xui_ui_treeview19_onitemselected:function(c,m,d,a,f){var g=this,j=c.boxing(),b=g.properties,l=function(){};xui.getModule("RAD.expression.ExpressionEditor").setDataToEditor(g.$host,g.$cls,m)},_treebarcom_ongetcontent:function(b,c,d){var a=this;if(c.key=="jds.localService"){xui.Ajax(CONF.getLocalServiceToolBoxService,{projectName:SPA.curProjectName,pattern:a.pattern.getUIValue()},function(e){var f=e;if(!f||f.error){xui.message("No module in this project!");d(false)}else{d(a._buildItems(f.data))}},function(e){d(false)},null,{method:"post"}).start()}else{if(c.key=="jds.getPageServiceToolBoxService"){xui.Ajax(CONF.getPageServiceToolBoxService,{projectName:SPA.curProjectName,className:SPA.currentClassName,pattern:a.pattern.getUIValue()},function(e){var f=e;if(!f||f.error){xui.message("No module in this project!");d(false)}else{d(a._buildItems(f.data))}},function(e){d(false)},null,{method:"post"}).start()}else{if(c.key=="jds.getProjectServiceToolBoxService"){xui.Ajax(CONF.getProjectServiceToolBoxService,{projectName:SPA.curProjectName,pattern:a.pattern.getUIValue()},function(e){var g=e;if(!g||g.error){xui.message("No module in this project!");d(false)}else{var f=[];d(a._buildItems(g.data))}},function(e){d(false)},null,{method:"post"}).start()}else{if(c.key=="jds.Server"){xui.Ajax(CONF.getRemoteServiceByKeyService,{projectName:SPA.curProjectName,pattern:a.pattern.getUIValue(),serverId:c.id},function(e){var g=e;if(!g||g.error){xui.message("No service in this project!");d(false)}else{var f=[];d(g.data)}},function(e){d(false)},null,{method:"post"}).start()}}}}},_toolbar_onclick:function(b,c,f,d,g){var a=this;switch(c.id){case"refresh":a.treebarCom.setItems(a._buildItems(this.topNodes));break;case"import":xui.getModule("RAD.api.APITree",function(){this.setData({projectName:SPA.curProjectName});var j=this;var e=function(){j.initData();j._fireEvent("afterShow")};this.show(e)});break}},_buildItems:function(a){var b=[],c=this;xui.each(a,function(d){if(d.key&&CONF.mapWidgets[d.key]){var e=CONF.mapWidgets[d.key];d.imageClass=CONF.mapWidgets[d.key].imageClass}d.children=d.sub;d.properties=d.iniProp;if(d.sub){d.sub=c._buildItems(d.sub)}d.getProperties=function(){return this.properties}});return a},_xui_ui_treeview19_onchange:function(e,b,g,f,a){var d=this,c=e.boxing();xui.echo(xui.getModule("RAD.api.URLConfig").getDataFromEditor())},setDataToEditor:function(c,a,b){this.$cls=a;this.$host=c;this.$api=b;this.treebarCom.setItems(this._buildItems(this.topNodes))},_page_onrender:function(a,c){var b=this;xui.showModule3("RAD.expression.ExpressionEditor","content",null,function(){this.setDataToEditor(b.$host,b.$cls,b.$api);this.setEvents("onValueChanged",function(d,e){b.$api.queryArgs.expression=e;b.fireEvent("onchange",[this,e])})})},topNodes:[{id:"pageService",key:"jds.getPageServiceToolBoxService",caption:"$RAD.toolbox.pageService",group:true,iniFold:false,imageClass:"spafont spa-icon-action1",sub:true},{id:"projectService",key:"jds.getProjectServiceToolBoxService",caption:"$RAD.toolbox.projectService",group:true,iniFold:false,imageClass:"fa fa-cubes",sub:true},{id:"localService",key:"jds.localService",caption:"$RAD.toolbox.cls",group:true,iniFold:true,imageClass:"spafont spa-icon-options",sub:true}]},Static:{designViewConf:{height:1024,mobileFrame:false,width:1280}}});xui.Class("RAD.expression.ExpressionEditor","xui.Module",{Instance:{initialize:function(){},Dependencies:[],Required:["xui.Module.JSONEditor"],properties:{path:"form/myspace/versionspace/projectManager/0/RAD/expression/ExpressionEditor.cls",personId:"devdev",personName:"devdev",projectName:"projectManager"},events:{onRender:{actions:[{args:[],desc:"函数",script:"_page_onrender",type:"page"}]}},functions:{},iniComponents:function(){var d=this,c=[],b={},a=function(e){c.push(e.get(0))};xui.merge(b,this.properties);a(xui.create("xui.UI.Block").setHost(d,"content").setDock("fill").setBorderType("none"));d.content.append(xui.create("xui.UI.Layout").setHost(d,"xui_ui_layout19").setItems([{cmd:true,folded:false,id:"before",locked:false,min:300,pos:"before",size:350,hidden:false},{id:"main",min:10,size:200}]).setLeft("0em").setTop("0em"));d.xui_ui_layout19.append(xui.create("xui.UI.Tabs").setHost(d,"xui_ui_tabs11").setName("centerdown").setItems([{caption:"结果",hidden:false,id:"result",imageClass:"spafont spa-icon-designview"},{caption:"动态参数",hidden:false,id:"params",imageClass:"spafont spa-icon-c-dateinput"},{caption:"绑定视图",hidden:false,id:"viewbind",imageClass:"spafont spa-icon-c-treeview"},{caption:"日志",hidden:false,id:"log",imageClass:"spafont spa-icon-coin"}]).setLeft("0em").setTop("0em").setValue("params"),"main");d.xui_ui_tabs11.append(xui.create("xui.UI.Block").setHost(d,"xui_ui_group13").setDock("fill").setConLayoutColumns(2),"params");d.xui_ui_group13.append(xui.create("xui.UI.Panel").setHost(d,"xui_ui_panel37").setLeft("19.58334em").setWidth("45.75em").setHeight("17.083333333333332em").setCaption("参数编码").setBorderType("none"));d.xui_ui_panel37.append(xui.create("xui.UI.Input").setHost(d,"xui_reqtext").setName("xui_reqtext").setDisabled(true).setDock("fill").setLeft("6.667em").setTop("4.1667em").setHeight("10em").setMultiLines(true));d.xui_ui_group13.append(xui.create("xui.UI.Div").setHost(d,"xui_ui_div117").setDock("left").setTop("0.8334em").setWidth("30.75em").setHeight("8.334em"));d.xui_ui_div117.append(xui.create("xui.UI.Stacks").setHost(d,"xui_ui_stacks17").setItems([{caption:"动态参数",hidden:false,id:"b"},{caption:"固定参数",hidden:false,id:"c",imageClass:""}]).setLeft("9.58334em").setTop("0em").setWidth("45.75em").setHeight("21em").setValue("b"));d.xui_ui_stacks17.append(xui.create("xui.UI.TreeGrid").setHost(d,"xui_reqds").setName("xui_reqds").setLeft("0em").setTop("0em").setSelMode("multibycheckbox").setEditable(true).setRowHandlerWidth("4em").setHeader([{caption:"$(RAD.api_dlg.Datasource)",colResizer:true,editable:false,flexSize:false,hidden:false,id:"source",readonly:true,type:"label",width:"6.666666666666667em"},{caption:"$(RAD.api_dlg.To Data Path)",colResizer:true,editable:true,flexSize:true,hidden:false,id:"path",readonly:true,type:"input",width:"6.666666666666667em"},{caption:"参数用途",colResizer:true,editable:false,flexSize:true,hidden:false,id:"desc",readonly:true,type:"input",width:"6.666666666666667em"}]).setTreeMode("none").setValue("").onChange(["_xui_reqds_onchange"]).onRowSelected(["_ontrows"]).beforeRowActive(["_tg_beforerowactive"]).beforeCellUpdated(["_acu"]).afterCellUpdated(["_xui_reqds_bcellupdated"]),"b");d.xui_ui_stacks17.append(xui.create("xui.Module.JSONEditor","xui.Module").setHost(d,"m_reqparams").setProperties({className:"xui.Module.JSONEditor"}).setEvents({onchange:["_m_reqparams_onchange"]}),"c");d.xui_ui_tabs11.append(xui.create("xui.UI.Block").setHost(d,"xui_ui_group23").setDock("fill").setLeft("7.5em").setWidth("8.334em").setHeight("19.1667em"),"viewbind");d.xui_ui_group23.append(xui.create("xui.UI.Panel").setHost(d,"xui_ui_panel50").setDock("left").setTop("1.667em").setWidth("26em").setHeight("17.08333em").setCaption("视图").setBorderType("flat"));d.xui_ui_panel50.append(xui.create("xui.UI.TreeGrid").setHost(d,"xui_rsptarget").setName("xui_rsptarget").setLeft("0em").setTop("0em").setSelMode("multibycheckbox").setEditable(true).setRowHandlerWidth("4em").setHeader([{caption:"$(RAD.api_dlg.Data Path)",colResizer:true,editable:true,flexSize:true,hidden:false,id:"path",readonly:true,type:"input",width:"6em"},{caption:"$(RAD.api_dlg.Target)",colResizer:true,editable:false,flexSize:true,hidden:false,id:"source",readonly:true,type:"label",width:"10em"},{caption:"参数用途",colResizer:true,editable:false,flexSize:true,hidden:false,id:"desc",readonly:true,type:"label",width:"10em"}]).setTreeMode("none").setValue("").onRowSelected(["_ontrows2"]).beforeRowActive(["_tg_beforerowactive"]).beforeCellUpdated(["_acu"]));d.xui_ui_group23.append(xui.create("xui.UI.Panel").setHost(d,"xui_ui_panel49").setLeft("20.41667em").setTop("1.667em").setWidth("24.5em").setHeight("17.08333em").setCaption("$(RAD.api_dlg.Response Callback)"));d.xui_ui_panel49.append(xui.create("xui.UI.TreeGrid").setHost(d,"xui_rspfun").setName("xui_rspfun").setLeft("0em").setTop("0em").setSelMode("multibycheckbox").setEditable(true).setRowHandlerWidth("2em").setHeader([{caption:"$(RAD.api_dlg.Callback Type)",colResizer:true,editable:false,flexSize:true,hidden:false,id:"type",readonly:true,type:"label",width:"6em"},{caption:"$(RAD.api_dlg.Callback)",colResizer:true,editable:false,flexSize:true,hidden:false,id:"source",readonly:true,type:"label",width:"12em"}]).setTreeMode("none").setValue("").onRowSelected(["_ontrows"]).beforeRowActive(["_tg_beforerowactive"]));d.xui_ui_tabs11.append(xui.create("xui.UI.Block").setHost(d,"resultgrid").setName("resultgrid").setDock("fill").setLeft("15em").setTop("10em"),"result");d.resultgrid.append(xui.create("xui.UI.Block").setHost(d,"xui_ui_block47").setDock("fill").setLeft("0em").setTop("0em"));d.xui_ui_block47.append(xui.create("xui.UI.Block").setHost(d,"xui_ui_block48").setDock("bottom").setHeight("2.5em"));d.xui_ui_block48.append(xui.create("xui.UI.PageBar").setHost(d,"xui_ui_pagebar1").setCaption(""));d.xui_ui_block47.append(xui.create("xui.UI.TreeGrid").setHost(d,"result").setName("result").setLeft("0em").setTop("0em").setRowNumbered(true).setHeader([{caption:"col1",colResizer:true,editable:false,flexSize:false,hidden:false,id:"a",readonly:true,type:"input",width:"8em"},{caption:"col2",colResizer:false,editable:false,flexSize:false,hidden:false,id:"b",readonly:true,type:"input",width:"8em"},{caption:"col3",colResizer:false,editable:false,flexSize:false,hidden:false,id:"c",readonly:true,type:"input",width:"8em"},{caption:"col4",colResizer:false,editable:false,flexSize:true,hidden:false,id:"d",readonly:true,type:"input",width:"8em"}]));d.xui_ui_block47.append(xui.create("xui.UI.ToolBar").setHost(d,"xui_ui_toolbar16").setItems([{caption:"common",hidden:false,id:"common",sub:[{caption:"$RAD.widgets.esd.buttonnew",hidden:false,iconFontSize:"",id:"new",imageClass:"fa fa-lg fa-calendar-plus-o",position:"absolute"},{caption:"$RAD.widgets.esd.buttondelete",hidden:false,iconFontSize:"",id:"delete",imageClass:"fa fa-lg fa-close",position:"absolute"},{caption:"$RAD.widgets.esd.buttonreload",hidden:false,iconFontSize:"",id:"reload",imageClass:"fa fa-lg fa-circle-o-notch",position:"absolute"}]}]));d.xui_ui_layout19.append(xui.create("xui.UI.Block").setHost(d,"xui_ui_block63").setDock("fill").setLeft("13.333333333333334em").setTop("5.833333333333333em"),"before");d.xui_ui_block63.append(xui.create("xui.UI.Block").setHost(d,"editor").setName("editor").setDock("fill").setLeft("2.5em").setTop("12.5em"));d.editor.append(xui.create("xui.UI.MenuBar").setHost(d,"xui_ui_menubar2").setItems([{caption:"数据源",disabled:false,hidden:false,id:"data",sub:[{caption:"JSON文件",disabled:false,hidden:false,id:"loadJson"},{caption:"Execl文件",disabled:false,hidden:false,id:"loadExecl"},{caption:"数据库",disabled:false,hidden:false,id:"loadDb"},]},{caption:"公式",disabled:false,hidden:false,id:"editor"},{caption:"模板",disabled:false,hidden:false,id:"temp"},{caption:"工具",disabled:false,hidden:false,id:"tool"}]).setTop("2.5em"));return c},customAppend:function(b,a,d,c){return false},setDataToEditor:function(l,n,d){var e=this,a=d,c,f,g,j,b;this.$cls=n;this.$host=l;this.$api=d;e._oldprop=a;e._host=l;(function(){c=[];f={};g=[];xui.arr.each(a.requestDataSource,function(m){f[m.type+"-"+m.name]=m.path});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.DataBinder"]){return}j=m.getName();b="databinder-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"databinder",cells:[j,f[b]||"","自定义"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.UI.PageBar"]){return}j=m.getAlias();b="pagebar-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"pagebar",cells:[j,f[b]||"","分页参数"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.UI.TreeView"]){return}j=m.getAlias();b="treeview-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"treeview",cells:[j,f[b]||"","当前选中行"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.UI.Gallery"]){return}j=m.getAlias();b="gallery-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"gallery",cells:[j,f[b]||"","当前选中"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.Module"]){return}j=m.getName();b="module-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"module",cells:[j,f[b]||j,"子模块"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.UI.TreeGrid"]){return}j=m.getAlias();b="treegrid-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"treegrid",cells:[j,f[b]||"","当前选中行"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.absContainer"]||m.getFormElements().isEmpty()){return}j=m.getAlias();b="form-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"form",cells:[j,f[b]||"","表单数据"]})});e.xui_reqds.setRows(c).setValue(g.join(";"))}());(function(){c=[];f={};g=[];xui.arr.each(a.responseDataTarget,function(m){f[m.type+"-"+(m.name||"")]=m.path});if(b in f){g.push(b)}xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.DataBinder"]){return}j=m.getName();b="databinder-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"databinder",cells:[f[b]||"",j,"数据绑定"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.UI.TreeGrid"]){return}j=m.getAlias();b="treegrid-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"treegrid",cells:[f[b]||"data",j,"填充行数据"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.UI.Dialog"]){return}j=m.getAlias();b="component-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"component",cells:[f[b]||"data",j,"动态装载"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.UI.Block"]){return}j=m.getAlias();b="component-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"component",cells:[f[b]||"data",j,"动态装载"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.UI.TreeView"]){return}j=m.getAlias();b="treeview-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"treeview",cells:[f[b]||"data",j,"装载树节点"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.UI.Gallery"]){return}j=m.getAlias();b="gallery-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"gallery",cells:[f[b]||"data",j,"装载数据"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.UI.SVGPaper"]){return}j=m.getAlias();b="svgpagper-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"svgpaper",cells:[f[b]||"data",j,"填充图形"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.UI.PageBar"]){return}j=m.getAlias();b="pagebar-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"pagebar",cells:[f[b]||"size",j,"设置最大记录数"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.Module"]){return}j=m.getName();b="module-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"module",cells:[f[b]||"data."+j,j,"填充子组件数据"]})});xui.each(l,function(m){if(!m||!m.Class||!m.Class["xui.absContainer"]||m.getFormElements().isEmpty()){return}j=m.getAlias();b="form-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"form",cells:[f[b]||"data",j,"填充表单数据"]})});b="log-console.log";c.push({id:b,bindertype:"log",cells:[f[b]||"","console.log"]});if(b in f){g.push(b)}b="alert-alert";c.push({id:b,bindertype:"alert",cells:[f[b]||"","alert"]});e.xui_rsptarget.setRows(c).setValue(g.join(";"))}());(function(){c=[];f={};g=[];xui.arr.each(a.responseCallback,function(m){f[m.type+"-"+(m.name||"")]=m.type});if(n&&n.Instance&&n.Instance.functions){xui.each(n.Instance.functions,function(m,o){j=o;b="host-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"host",cells:["page",j]})})}xui.each(SPA.curProjectConfig.$GlobalFunctions,function(m,o){j=o;b="global-"+j;if(b in f){g.push(b)}c.push({id:b,bindertype:"global",cells:["global",j]})});e.xui_rspfun.setRows(c).setValue(g.join(";"))}());e.m_reqparams.setProperties("value",a.queryArgs);e.updateRequestData(a.queryArgs,a.requestDataSource)},getExpression:function(){var a=this;return a.editor.getValue()},_ontrows2:function(b,f,c,d,a){this.updateRequestData()},setResult:function(b){var a=this;a.xui_ui_tabs11.fireItemClickEvent("result");a.resultgrid.setChildren([b])},updateRequestData:function(c,f){var g=this;c=c?xui.clone(c):g.m_reqparams.getValue(true);f=f||[];if(!f.length){xui.arr.each(g.xui_reqds.getRows(),function(n){if(n._selected){f.push({type:n.bindertype,name:n.cells[0].value,path:n.cells[1].value})}})}if(f&&f.length){for(var d in f){var b=f[d],l,j,m;switch(b.type){case"databinder":if((l=g._host[b.name])&&l.Class["xui.DataBinder"]){if(!l.updateDataFromUI()){return}else{m=(b.path||"").split(".");if(xui.isHash(j=xui.get(c,m))){xui.merge(j,l.getData())}else{xui.set(c,b.path.split("."),l.getData())}}}break;case"pagebar":if(l=g._host[b.name]){var e={pageSize:l.getPageCount(),pageIndex:l.getPage()};if(xui.isHash(j=xui.get(c,m))){xui.merge(j,e)}else{xui.set(c,m,e)}}break;case"treegrid":if(l=g._host[b.name]){m=(b.path||l.getUidColumn()).split(".");xui.set(c,m,l.getUIValue())}break;case"treeview":if(l=g._host[b.name]){m=(b.path||"").split(".");xui.set(c,m,l.getUIValue())}break;case"form":if((l=g._host[b.name])&&l.Class["xui.absContainer"]&&l.getFormElements().size()&&l.getRootNode()){m=(b.path||"").split(".");if(xui.isHash(j=xui.get(c,m))){xui.merge(j,l.getFormValues())}else{xui.set(c,m,l.getFormValues())}}break;case"module":if((l=g._host[b.name])&&l.Class["xui.Module"]){m=(b.path||b.name).split(".");xui.set(c,m,l.getValue(true))}break}}}var a=xui.stringify(c);if(xui.Coder){a=xui.Coder.formatText(a)}g.xui_reqtext.setValue(a)},getDataFromEditor:function(){var d=this,c=d._oldprop,e={requestDataSource:c.requestDataSource,responseDataTarget:c.responseDataTarget,responseCallback:c.responseCallback},a,b;e.queryAsync=d.xui_asyn.getValue();e.autoRun=d.autoRun.getValue();e.isAllform=d.isAllform.getValue();if(d.xui_reqds.getRootNode()){a=[];xui.arr.each(d.xui_reqds.getRows(),function(f){if(f._selected){a.push({type:f.bindertype,name:f.cells[0].value,path:f.cells[1].value})}});e.requestDataSource=a}if(d.xui_rsptarget.getRootNode()){a=[];xui.arr.each(d.xui_rsptarget.getRows(),function(f){if(f._selected){a.push({type:f.bindertype,name:f.cells[1].value,path:f.bindertype=="log"||f.bindertype=="alert"?"":f.cells[0].value})}});e.responseDataTarget=a}if(d.xui_rspfun.getRootNode()){a=[];xui.arr.each(d.xui_rspfun.getRows(),function(f){if(f._selected){a.push({type:f.bindertype,name:f.cells[1].value})}});e.responseCallback=a}b=d.m_reqparams.getValue(true);e.queryArgs=b||{};return e},_acu:function(e,b,d){if(!b._row._selected&&d.value){var c=e.boxing();var a=c.getValue(true);a.push(b._row.id);xui.arr.removeDuplicate(a);xui.arr.removeValue(a,"");c.setValue((a&&a.length)?a.join(";"):null)}this.updateRequestData()},_page_onrender:function(a,c){var b=this;xui.showModule3("RAD.expression.PageEditor","editor",null,function(){this.setEvents("onRunExpression",function(d,f){var e=xui.execGrid(f,{},false);b.setResult(e)});this.setEvents("onValueChanged",function(){})})},_ontrows:function(b,f,c,d,a){this.updateRequestData()},_tg_beforerowactive:function(){return false},_callCmd:function(a){return xui.execGrid(a,{},false)}},Static:{designViewConf:{height:1024,mobileFrame:false,width:1280},viewStyles:{}}});xui.Class("RAD.expression.PageEditor","xui.Module",{Instance:{Initialize:function(){var a=this;a._ovalue="";a._dirty=false},resetEditorStyle:function(c,a,b){this.codeeditor.resetEditorStyle(c,a,b)},setType:function(a){if(this.codeeditor){this.codeeditor.setCodeType(a,true)}this._codetype=a&&a.split(".")[0];if(this.toolbar4){this.toolbar4.updateItem("jsoneditor",{hidden:a!="json"})}},activate:function(){this.codeeditor.activate()},getValue:function(){var a=this;return a._dirty?a.codeeditor.getUIValue():a._ovalue},_refreshCM:function(){if(this.codeeditor){this.codeeditor._refreshCM()}},setValue:function(b){b=(b||"").replace(/\t/g,"    ").replace(/\u00A0/g," ").replace(/\r\n?/g,"\n");var a=this;if(a._ovalue!=b){a._ovalue=b;a._dirty=false;if(a.codeeditor){a.codeeditor.setValue(a._ovalue)}}return a},reindent:function(){this.codeeditor.reindent()},setReadonlyLines:function(b,a){this.codeeditor.setReadonlyLines(b,a)},iniComponents:function(b,e){var d=this,c=[],a=function(f){c.push(f.get(0))};a((new xui.UI.ToolBar).setHost(d,"toolbar4").setItems([{id:"fun",sub:[{id:"searchreplace",caption:"$RAD.pageEditor.searchreplace",imageClass:"spafont spa-icon-searchreplace",type:"button",tips:"$RAD.pageEditor.replacetips"},{id:"jumpto",caption:"$RAD.pageEditor.jumpto",imageClass:"spafont spa-icon-jumpto",type:"button",tips:"$RAD.pageEditor.jumptotips"},{id:"indentall",caption:"$RAD.pageEditor.indentall",imageClass:"spafont spa-icon-indent",type:"button",tips:"$RAD.pageEditor.indentalltips"},{id:"rendermode",caption:"mode",imageClass:"spafont spa-icon-rendermode"},{id:"debug",caption:"调试",imageClass:"spafont spa-icon-debug"},{id:"jsoneditor",hidden:false,caption:"$RAD.spabuilder.menubar.jsoneditor",imageClass:"spafont spa-icon-hash",type:"button",tips:"$(RAD.pageEditor.Edit in JSON Editor)"},{id:"progress",object:(new xui.UI.Image({src:CONF.img_progress})).setHost(d,"imgProgress")}]}]).onClick("_toolbar_onclick"));a((new RAD.expression.CodeEditor).setHost(d,"codeeditor").setDock("fill").setValue(d._ovalue||"").onValueChanged("_codeeditor_onChange").onSaveCommand("_codeeditor_onsave").onGetHelpInfo("_codeeditor_ongett").onRendered("_codeeditor_onrender").onCodeModeSet("_codeeditor_oncodemodeset"));return c},events:{onReady:"_onready"},_onready:function(a){if(a._codetype){a.codeeditor.setCodeType(a._codetype,true)}},setDataToEditor:function(d,a,c){var b=this;this.$cls=a;this.$host=d;this.$api=c;if(xui.isStr(c)){b.boxing().setValue(c)}else{if(c.queryArgs&&c.queryArgs.expression){b.boxing().setValue(c.queryArgs.expression)}}},_codeeditor_onrender:function(b,d){var a=this;if(!a.codeeditor){return}var c=a.KEY+":"+a.$xid+":progress";if(d){xui.resetRun(c);a.toolbar4.setDisabled(false);a.codeeditor.setReadonly(false);a.imgProgress.setDisplay("none");if(!a.$initializd){a.$initializd=true;a.fireEvent("afterRendered")}}else{xui.resetRun(c,function(){if(!a.destroyed){a.toolbar4.setDisabled(true);a.codeeditor.setReadonly(true);a.imgProgress.setDisplay("")}})}},_codeeditor_ongett:function(b,a){xui.asyRun(function(){xui.Coder.applyById("doc:code",true)});return RAD.EditorTool.getDoc(a)},_codeeditor_oncodemodeset:function(a,b){if(b){this.toolbar4.updateItem("rendermode",{caption:"&nbsp;"+b.name,mime:b.mime,mode:b.mode,tips:"Code was rendered as ["+b.name+"]"})}},_codeeditor_onChange:function(b,a){this._dirty=true;this.fireEvent("onValueChanged",[this,this.getValue()])},_codeeditor_onsave:function(b){var a=this;a.fireEvent("onCommandSave",[a])},_toolbar_onclick:function(b,m,j,d,a){var g=this,c=this.codeeditor,f=xui.use(a).offset();switch(m.id){case"indentall":c.reindent();break;case"debug":this.fireEvent("onRunExpression",[this,this.getValue()]);break;case"searchreplace":RAD.EditorTool.showFindWnd(c,f,c.getCM().getSelection());break;case"jumpto":RAD.EditorTool.showJumpToWnd(c,f);break;case"rendermode":c.showModeSelDlg(m);break;case"jsoneditor":var l=g.getValue();try{xui.unserialize(l)}catch(d){xui.alert(d);return}if(window.SPA&&false===SPA.fe("beforeObjectEditorPop",["jsonEditor",null,l,function(e){g.setValue(typeof(e)=="string"?e:xui.stringify(e))},"RAD.PageEditor",g,xui(a).get(0),null,c])){return}xui.ModuleFactory.getCom("jsonEditor",function(){this.setProperties({caption:"$RAD.spabuilder.menubar.jsoneditor",imageClass:"spafont spa-icon-hash",text:l,onOK:function(n,e){g.setValue(e)}});this.show()});break}}}});(function(b,a){typeof exports==="object"&&typeof module!=="undefined"?module.exports=a():typeof define==="function"&&define.amd?define(a):(b.CodeMirror=a())}(this,(function(){var eG=navigator.userAgent;var eR=navigator.platform;var cV=/gecko\/\d/i.test(eG);var fz=/MSIE \d/.test(eG);var b8=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(eG);var c9=/Edge\/(\d+)/.exec(eG);var em=fz||b8||c9;var o=em&&(fz?document.documentMode||6:+(c9||b8)[1]);var dz=!c9&&/WebKit\//.test(eG);var ep=dz&&/Qt\/\d+\.\d+/.test(eG);var dP=!c9&&/Chrome\//.test(eG);var eI=/Opera\//.test(eG);var aR=/Apple Computer/.test(navigator.vendor);var dH=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(eG);var gl=/PhantomJS/.test(eG);var fT=!c9&&/AppleWebKit/.test(eG)&&/Mobile\/\w+/.test(eG);var a3=/Android/.test(eG);var eX=fT||a3||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(eG);var cy=fT||/Mac/.test(eR);var gE=/\bCrOS\b/.test(eG);var a6=/win/i.test(eR);var bg=eI&&eG.match(/Version\/(\d*\.\d*)/);if(bg){bg=Number(bg[1])}if(bg&&bg>=15){eI=false;dz=true}var cg=cy&&(ep||eI&&(bg==null||bg<12.11));var hg=cV||(em&&o>=9);function ad(hr){return new RegExp("(^|\\s)"+hr+"(?:$|\\s)\\s*")}var j=function(ht,hr){var hu=ht.className;var hs=ad(hr).exec(hu);if(hs){var hv=hu.slice(hs.index+hs[0].length);ht.className=hu.slice(0,hs.index)+(hv?hs[1]+hv:"")}};function eH(hs){for(var hr=hs.childNodes.length;hr>0;--hr){hs.removeChild(hs.firstChild)}return hs}function ci(hr,hs){return eH(hr).appendChild(hs)}function g7(hr,hv,hu,ht){var hw=document.createElement(hr);if(hu){hw.className=hu}if(ht){hw.style.cssText=ht}if(typeof hv=="string"){hw.appendChild(document.createTextNode(hv))}else{if(hv){for(var hs=0;hs<hv.length;++hs){hw.appendChild(hv[hs])}}}return hw}function hd(hr,hu,ht,hs){var hv=g7(hr,hu,ht,hs);hv.setAttribute("role","presentation");return hv}var cS;if(document.createRange){cS=function(hu,hv,hs,hr){var ht=document.createRange();ht.setEnd(hr||hu,hs);ht.setStart(hu,hv);return ht}}else{cS=function(ht,hv,hr){var hs=document.body.createTextRange();try{hs.moveToElementText(ht.parentNode)}catch(hu){return hs}hs.collapse(true);hs.moveEnd("character",hr);hs.moveStart("character",hv);return hs}}function hh(hr,hs){if(hs.nodeType==3){hs=hs.parentNode}if(hr.contains){return hr.contains(hs)}do{if(hs.nodeType==11){hs=hs.host}if(hs==hr){return true}}while(hs=hs.parentNode)}function eq(){var hr;try{hr=document.activeElement}catch(hs){hr=document.body||null}while(hr&&hr.shadowRoot&&hr.shadowRoot.activeElement){hr=hr.shadowRoot.activeElement}return hr}function gu(hs,hr){var ht=hs.className;if(!ad(hr).test(ht)){hs.className+=(ht?" ":"")+hr}}function gU(ht,hr){var hs=ht.split(" ");for(var hu=0;hu<hs.length;hu++){if(hs[hu]&&!ad(hs[hu]).test(hr)){hr+=" "+hs[hu]}}return hr}var en=function(hr){hr.select()};if(fT){en=function(hr){hr.selectionStart=0;hr.selectionEnd=hr.value.length}}else{if(em){en=function(hs){try{hs.select()}catch(hr){}}}}function c2(hs){var hr=Array.prototype.slice.call(arguments,1);return function(){return hs.apply(null,hr)}}function a4(ht,hs,hr){if(!hs){hs={}}for(var hu in ht){if(ht.hasOwnProperty(hu)&&(hr!==false||!hs.hasOwnProperty(hu))){hs[hu]=ht[hu]}}return hs}function ch(hu,hs,hw,hx,ht){if(hs==null){hs=hu.search(/[^\s\u00a0]/);if(hs==-1){hs=hu.length}}for(var hv=hx||0,hy=ht||0;;){var hr=hu.indexOf("\t",hv);if(hr<0||hr>=hs){return hy+(hs-hv)}hy+=hr-hv;hy+=hw-(hy%hw);hv=hr+1}}var hq=function(){this.id=null};hq.prototype.set=function(hr,hs){clearTimeout(this.id);this.id=setTimeout(hs,hr)};function dV(ht,hr){for(var hs=0;hs<ht.length;++hs){if(ht[hs]==hr){return hs}}return -1}var ek=30;var cD={toString:function(){return"CodeMirror.Pass"}};var am={scroll:false},X={origin:"*mouse"},dv={origin:"+move"};function e9(hv,hu,hw){for(var hx=0,ht=0;;){var hs=hv.indexOf("\t",hx);if(hs==-1){hs=hv.length}var hr=hs-hx;if(hs==hv.length||ht+hr>=hu){return hx+Math.min(hr,hu-ht)}ht+=hs-hx;ht+=hw-(ht%hw);hx=hs+1;if(ht>=hu){return hx}}}var bh=[""];function cW(hr){while(bh.length<=hr){bh.push(gA(bh)+" ")}return bh[hr]}function gA(hr){return hr[hr.length-1]}function cj(hu,ht){var hr=[];for(var hs=0;hs<hu.length;hs++){hr[hs]=ht(hu[hs],hs)}return hr}function cB(hv,hs,ht){var hu=0,hr=ht(hs);while(hu<hv.length&&ht(hv[hu])<=hr){hu++}hv.splice(hu,0,hs)}function gV(){}function cQ(ht,hr){var hs;if(Object.create){hs=Object.create(ht)}else{gV.prototype=ht;hs=new gV()}if(hr){a4(hr,hs)}return hs}var bt=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function gx(hr){return/\w/.test(hr)||hr>"\x80"&&(hr.toUpperCase()!=hr.toLowerCase()||bt.test(hr))}function c7(hr,hs){if(!hs){return gx(hr)}if(hs.source.indexOf("\\w")>-1&&gx(hr)){return true}return hs.test(hr)}function fL(hr){for(var hs in hr){if(hr.hasOwnProperty(hs)&&hr[hs]){return false}}return true}var fy=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function gg(hr){return hr.charCodeAt(0)>=768&&fy.test(hr)}function e1(hs,ht,hr){while((hr<0?ht>0:ht<hs.length)&&gg(hs.charAt(ht))){ht+=hr}return ht}function cT(hr,hw,hv){var ht=hw>hv?-1:1;for(;;){if(hw==hv){return hw}var hu=(hw+hv)/2,hs=ht<0?Math.ceil(hu):Math.floor(hu);if(hs==hw){return hr(hs)?hw:hv}if(hr(hs)){hv=hs}else{hw=hs+ht}}}function fw(hs,hu,ht){var hv=this;this.input=ht;hv.scrollbarFiller=g7("div",null,"CodeMirror-scrollbar-filler");hv.scrollbarFiller.setAttribute("cm-not-content","true");hv.gutterFiller=g7("div",null,"CodeMirror-gutter-filler");hv.gutterFiller.setAttribute("cm-not-content","true");hv.lineDiv=hd("div",null,"CodeMirror-code");hv.selectionDiv=g7("div",null,null,"position: relative; z-index: 1");hv.cursorDiv=g7("div",null,"CodeMirror-cursors");hv.measure=g7("div",null,"CodeMirror-measure");hv.lineMeasure=g7("div",null,"CodeMirror-measure");hv.lineSpace=hd("div",[hv.measure,hv.lineMeasure,hv.selectionDiv,hv.cursorDiv,hv.lineDiv],null,"position: relative; outline: none");var hr=hd("div",[hv.lineSpace],"CodeMirror-lines");hv.mover=g7("div",[hr],null,"position: relative");hv.sizer=g7("div",[hv.mover],"CodeMirror-sizer");hv.sizerWidth=null;hv.heightForcer=g7("div",null,null,"position: absolute; height: "+ek+"px; width: 1px;");hv.gutters=g7("div",null,"CodeMirror-gutters");hv.lineGutter=null;hv.scroller=g7("div",[hv.sizer,hv.heightForcer,hv.gutters],"CodeMirror-scroll");hv.scroller.setAttribute("tabIndex","-1");hv.wrapper=g7("div",[hv.scrollbarFiller,hv.gutterFiller,hv.scroller],"CodeMirror");if(em&&o<8){hv.gutters.style.zIndex=-1;hv.scroller.style.paddingRight=0}if(!dz&&!(cV&&eX)){hv.scroller.draggable=true}if(hs){if(hs.appendChild){hs.appendChild(hv.wrapper)}else{hs(hv.wrapper)}}hv.viewFrom=hv.viewTo=hu.first;hv.reportedViewFrom=hv.reportedViewTo=hu.first;hv.view=[];hv.renderedView=null;hv.externalMeasured=null;hv.viewOffset=0;hv.lastWrapHeight=hv.lastWrapWidth=0;hv.updateLineNumbers=null;hv.nativeBarWidth=hv.barHeight=hv.barWidth=0;hv.scrollbarsClipped=false;hv.lineNumWidth=hv.lineNumInnerWidth=hv.lineNumChars=null;hv.alignWidgets=false;hv.cachedCharWidth=hv.cachedTextHeight=hv.cachedPaddingH=null;hv.maxLine=null;hv.maxLineLength=0;hv.maxLineChanged=false;hv.wheelDX=hv.wheelDY=hv.wheelStartX=hv.wheelStartY=null;hv.shift=false;hv.selForContextMenu=null;hv.activeTouch=null;ht.init(hv)}function f7(hu,hw){hw-=hu.first;if(hw<0||hw>=hu.size){throw new Error("There is no line "+(hw+hu.first)+" in the document.")}var hr=hu;while(!hr.lines){for(var hs=0;;++hs){var hv=hr.children[hs],ht=hv.chunkSize();if(hw<ht){hr=hv;break}hw-=ht}}return hr.lines[hw]}function g9(ht,hv,hr){var hs=[],hu=hv.line;ht.iter(hv.line,hr.line+1,function(hw){var hx=hw.text;if(hu==hr.line){hx=hx.slice(0,hr.ch)}if(hu==hv.line){hx=hx.slice(hv.ch)}hs.push(hx);++hu});return hs}function bj(hs,hu,ht){var hr=[];hs.iter(hu,ht,function(hv){hr.push(hv.text)});return hr}function hc(hs,hr){var ht=hr-hs.height;if(ht){for(var hu=hs;hu;hu=hu.parent){hu.height+=ht}}}function cc(hr){if(hr.parent==null){return null}var hv=hr.parent,hu=dV(hv.lines,hr);for(var hs=hv.parent;hs;hv=hs,hs=hs.parent){for(var ht=0;;++ht){if(hs.children[ht]==hv){break}hu+=hs.children[ht].chunkSize()}}return hu+hv.first}function b5(hx,hw){var hu=hx.first;outer:do{for(var ht=0;ht<hx.children.length;++ht){var hs=hx.children[ht],hr=hs.height;if(hw<hr){hx=hs;continue outer}hw-=hr;hu+=hs.chunkSize()}return hu}while(!hx.lines);var hv=0;for(;hv<hx.lines.length;++hv){var hz=hx.lines[hv],hy=hz.height;if(hw<hy){break}hw-=hy}return hu+hv}function cA(hs,hr){return hr>=hs.first&&hr<hs.first+hs.size}function fc(hr,hs){return String(hr.lineNumberFormatter(hs+hr.firstLineNumber))}function ah(hr,hs,ht){if(ht===void 0){ht=null}if(!(this instanceof ah)){return new ah(hr,hs,ht)}this.line=hr;this.ch=hs;this.sticky=ht}function cJ(hs,hr){return hs.line-hr.line||hs.ch-hr.ch}function ai(hs,hr){return hs.sticky==hr.sticky&&cJ(hs,hr)==0}function cM(hr){return ah(hr.line,hr.ch)}function bV(hs,hr){return cJ(hs,hr)<0?hr:hs}function aG(hs,hr){return cJ(hs,hr)<0?hs:hr}function dE(hr,hs){return Math.max(hr.first,Math.min(hs,hr.first+hr.size-1))}function gF(hs,ht){if(ht.line<hs.first){return ah(hs.first,0)}var hr=hs.first+hs.size-1;if(ht.line>hr){return ah(hr,f7(hs,hr).text.length)}return gj(ht,f7(hs,ht.line).text.length)}function gj(ht,hs){var hr=ht.ch;if(hr==null||hr>hs){return ah(ht.line,hs)}else{if(hr<0){return ah(ht.line,0)}else{return ht}}}function eF(ht,hu){var hr=[];for(var hs=0;hs<hu.length;hs++){hr[hs]=gF(ht,hu[hs])}return hr}var hl=false,bo=false;function gs(){hl=true}function bU(){bo=true}function e0(hr,ht,hs){this.marker=hr;this.from=ht;this.to=hs}function f2(ht,hr){if(ht){for(var hs=0;hs<ht.length;++hs){var hu=ht[hs];if(hu.marker==hr){return hu}}}}function fv(hs,ht){var hu;for(var hr=0;hr<hs.length;++hr){if(hs[hr]!=ht){(hu||(hu=[])).push(hs[hr])}}return hu}function cG(hr,hs){hr.markedSpans=hr.markedSpans?hr.markedSpans.concat([hs]):[hs];hs.marker.attachLine(hr)}function a7(hs,ht,hx){var hy;if(hs){for(var hv=0;hv<hs.length;++hv){var hz=hs[hv],hw=hz.marker;var hr=hz.from==null||(hw.inclusiveLeft?hz.from<=ht:hz.from<ht);if(hr||hz.from==ht&&hw.type=="bookmark"&&(!hx||!hz.marker.insertLeft)){var hu=hz.to==null||(hw.inclusiveRight?hz.to>=ht:hz.to>ht);(hy||(hy=[])).push(new e0(hw,hz.from,hu?null:hz.to))}}}return hy}function aQ(hs,hu,hx){var hy;if(hs){for(var hv=0;hv<hs.length;++hv){var hz=hs[hv],hw=hz.marker;var ht=hz.to==null||(hw.inclusiveRight?hz.to>=hu:hz.to>hu);if(ht||hz.from==hu&&hw.type=="bookmark"&&(!hx||hz.marker.insertLeft)){var hr=hz.from==null||(hw.inclusiveLeft?hz.from<=hu:hz.from<hu);(hy||(hy=[])).push(new e0(hw,hr?null:hz.from-hu,hz.to==null?null:hz.to-hu))}}}return hy}function e2(hM,hC){if(hC.full){return null}var ht=cA(hM,hC.from.line)&&f7(hM,hC.from.line).markedSpans;var hA=cA(hM,hC.to.line)&&f7(hM,hC.to.line).markedSpans;if(!ht&&!hA){return null}var hz=hC.from.ch,hH=hC.to.ch,hE=cJ(hC.from,hC.to)==0;var hy=a7(ht,hz,hE);var hB=aQ(hA,hH,hE);var hF=hC.text.length==1,hw=gA(hC.text).length+(hF?hz:0);if(hy){for(var hK=0;hK<hy.length;++hK){var hJ=hy[hK];if(hJ.to==null){var hD=f2(hB,hJ.marker);if(!hD){hJ.to=hz}else{if(hF){hJ.to=hD.to==null?null:hD.to+hw}}}}}if(hB){for(var hx=0;hx<hB.length;++hx){var hI=hB[hx];if(hI.to!=null){hI.to+=hw}if(hI.from==null){var hs=f2(hy,hI.marker);if(!hs){hI.from=hw;if(hF){(hy||(hy=[])).push(hI)}}}else{hI.from+=hw;if(hF){(hy||(hy=[])).push(hI)}}}}if(hy){hy=x(hy)}if(hB&&hB!=hy){hB=x(hB)}var hL=[hy];if(!hF){var hG=hC.text.length-2,hr;if(hG>0&&hy){for(var hv=0;hv<hy.length;++hv){if(hy[hv].to==null){(hr||(hr=[])).push(new e0(hy[hv].marker,null,null))}}}for(var hu=0;hu<hG;++hu){hL.push(hr)}hL.push(hB)}return hL}function x(hs){for(var hr=0;hr<hs.length;++hr){var ht=hs[hr];if(ht.from!=null&&ht.from==ht.to&&ht.marker.clearWhenEmpty!==false){hs.splice(hr--,1)}}if(!hs.length){return null}return hs}function dg(hD,hB,hC){var hv=null;hD.iter(hB.line,hC.line+1,function(hE){if(hE.markedSpans){for(var hF=0;hF<hE.markedSpans.length;++hF){var hG=hE.markedSpans[hF].marker;if(hG.readOnly&&(!hv||dV(hv,hG)==-1)){(hv||(hv=[])).push(hG)}}}});if(!hv){return null}var hw=[{from:hB,to:hC}];for(var hx=0;hx<hv.length;++hx){var hy=hv[hx],ht=hy.find(0);for(var hu=0;hu<hw.length;++hu){var hs=hw[hu];if(cJ(hs.to,ht.from)<0||cJ(hs.from,ht.to)>0){continue}var hA=[hu,1],hr=cJ(hs.from,ht.from),hz=cJ(hs.to,ht.to);if(hr<0||!hy.inclusiveLeft&&!hr){hA.push({from:hs.from,to:ht.from})}if(hz>0||!hy.inclusiveRight&&!hz){hA.push({from:ht.to,to:hs.to})}hw.splice.apply(hw,hA);hu+=hA.length-3}}return hw}function hf(hr){var ht=hr.markedSpans;if(!ht){return}for(var hs=0;hs<ht.length;++hs){ht[hs].marker.detachLine(hr)}hr.markedSpans=null}function dC(hr,ht){if(!ht){return}for(var hs=0;hs<ht.length;++hs){ht[hs].marker.attachLine(hr)}hr.markedSpans=ht}function D(hr){return hr.inclusiveLeft?-1:0}function cm(hr){return hr.inclusiveRight?1:0}function eu(hu,hs){var hw=hu.lines.length-hs.lines.length;if(hw!=0){return hw}var ht=hu.find(),hx=hs.find();var hr=cJ(ht.from,hx.from)||D(hu)-D(hs);if(hr){return -hr}var hv=cJ(ht.to,hx.to)||cm(hu)-cm(hs);if(hv){return hv}return hs.id-hu.id}function bn(hs,hw){var hr=bo&&hs.markedSpans,hv;if(hr){for(var hu=(void 0),ht=0;ht<hr.length;++ht){hu=hr[ht];if(hu.marker.collapsed&&(hw?hu.from:hu.to)==null&&(!hv||eu(hv,hu.marker)<0)){hv=hu.marker}}}return hv}function fF(hr){return bn(hr,true)}function fg(hr){return bn(hr,false)}function cI(hs,hu){var hr=bo&&hs.markedSpans,hw;if(hr){for(var ht=0;ht<hr.length;++ht){var hv=hr[ht];if(hv.marker.collapsed&&(hv.from==null||hv.from<hu)&&(hv.to==null||hv.to>hu)&&(!hw||eu(hw,hv.marker)<0)){hw=hv.marker}}}return hw}function H(hz,hr,hx,hy,hv){var hC=f7(hz,hr);var hs=bo&&hC.markedSpans;if(hs){for(var hu=0;hu<hs.length;++hu){var ht=hs[hu];if(!ht.marker.collapsed){continue}var hB=ht.marker.find(0);var hA=cJ(hB.from,hx)||D(ht.marker)-D(hv);var hw=cJ(hB.to,hy)||cm(ht.marker)-cm(hv);if(hA>=0&&hw<=0||hA<=0&&hw>=0){continue}if(hA<=0&&(ht.marker.inclusiveRight&&hv.inclusiveLeft?cJ(hB.to,hx)>=0:cJ(hB.to,hx)>0)||hA>=0&&(ht.marker.inclusiveRight&&hv.inclusiveLeft?cJ(hB.from,hy)<=0:cJ(hB.from,hy)<0)){return true}}}}function G(hs){var hr;while(hr=fF(hs)){hs=hr.find(-1,true).line}return hs}function cP(hs){var hr;while(hr=fg(hs)){hs=hr.find(1,true).line}return hs}function g(ht){var hr,hs;while(hr=fg(ht)){ht=hr.find(1,true).line;(hs||(hs=[])).push(ht)}return hs}function bd(hu,hs){var hr=f7(hu,hs),ht=G(hr);if(hr==ht){return hs}return cc(ht)}function eJ(hu,ht){if(ht>hu.lastLine()){return ht}var hs=f7(hu,ht),hr;if(!gn(hu,hs)){return ht}while(hr=fg(hs)){hs=hr.find(1,true).line}return cc(hs)+1}function gn(hv,hs){var hr=bo&&hs.markedSpans;if(hr){for(var hu=(void 0),ht=0;ht<hr.length;++ht){hu=hr[ht];if(!hu.marker.collapsed){continue}if(hu.from==null){return true}if(hu.marker.widgetNode){continue}if(hu.from==0&&hu.marker.inclusiveLeft&&ae(hv,hs,hu)){return true}}}}function ae(hw,hs,hu){if(hu.to==null){var hr=hu.marker.find(1,true);return ae(hw,hr.line,f2(hr.line.markedSpans,hu.marker))}if(hu.marker.inclusiveRight&&hu.to==hs.text.length){return true}for(var hv=(void 0),ht=0;ht<hs.markedSpans.length;++ht){hv=hs.markedSpans[ht];if(hv.marker.collapsed&&!hv.marker.widgetNode&&hv.from==hu.to&&(hv.to==null||hv.to!=hu.from)&&(hv.marker.inclusiveLeft||hu.marker.inclusiveRight)&&ae(hw,hs,hv)){return true}}}function cb(ht){ht=G(ht);var hv=0,hs=ht.parent;for(var hu=0;hu<hs.lines.length;++hu){var hr=hs.lines[hu];if(hr==ht){break}else{hv+=hr.height}}for(var hw=hs.parent;hw;hs=hw,hw=hs.parent){for(var hy=0;hy<hw.children.length;++hy){var hx=hw.children[hy];if(hx==hs){break}else{hv+=hx.height}}}return hv}function e5(ht){if(ht.height==0){return 0}var hs=ht.text.length,hr,hw=ht;while(hr=fF(hw)){var hu=hr.find(0,true);hw=hu.from.line;hs+=hu.from.ch-hu.to.ch}hw=ht;while(hr=fg(hw)){var hv=hr.find(0,true);hs-=hw.text.length-hv.from.ch;hw=hv.to.line;hs+=hw.text.length-hv.to.ch}return hs}function f(hr){var ht=hr.display,hs=hr.doc;ht.maxLine=f7(hs,hs.first);ht.maxLineLength=e5(ht.maxLine);ht.maxLineChanged=true;hs.iter(function(hv){var hu=e5(hv);if(hu>ht.maxLineLength){ht.maxLineLength=hu;ht.maxLine=hv}})}function eK(hr,hx,hw,hv){if(!hr){return hv(hx,hw,"ltr",0)}var hu=false;for(var ht=0;ht<hr.length;++ht){var hs=hr[ht];if(hs.from<hw&&hs.to>hx||hx==hw&&hs.to==hx){hv(Math.max(hs.from,hx),Math.min(hs.to,hw),hs.level==1?"rtl":"ltr",ht);hu=true}}if(!hu){hv(hx,hw,"ltr")}}var fV=null;function aX(hr,ht,hv){var hu;fV=null;for(var hs=0;hs<hr.length;++hs){var hw=hr[hs];if(hw.from<ht&&hw.to>ht){return hs}if(hw.to==ht){if(hw.from!=hw.to&&hv=="before"){hu=hs}else{fV=hs}}if(hw.from==ht){if(hw.from!=hw.to&&hv!="before"){hu=hs}else{fV=hs}}}return hu!=null?hu:fV}var bz=(function(){var hx="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN";var hv="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function hu(hA){if(hA<=247){return hx.charAt(hA)}else{if(1424<=hA&&hA<=1524){return"R"}else{if(1536<=hA&&hA<=1785){return hv.charAt(hA-1536)}else{if(1774<=hA&&hA<=2220){return"r"}else{if(8192<=hA&&hA<=8203){return"w"}else{if(hA==8204){return"b"}else{return"L"}}}}}}}var hr=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;var hz=/[stwN]/,ht=/[LRr]/,hs=/[Lb1n]/,hw=/[1n]/;function hy(hC,hB,hA){this.level=hC;this.from=hB;this.to=hA}return function(hX,hD){var hM=hD=="ltr"?"L":"R";if(hX.length==0||hD=="ltr"&&!hr.test(hX)){return false}var hG=hX.length,h6=[];for(var h9=0;h9<hG;++h9){h6.push(hu(hX.charCodeAt(h9)))}for(var hU=0,hT=hM;hU<hG;++hU){var ia=h6[hU];if(ia=="m"){h6[hU]=hT}else{hT=ia}}for(var hS=0,hC=hM;hS<hG;++hS){var h5=h6[hS];if(h5=="1"&&hC=="r"){h6[hS]="n"}else{if(ht.test(h5)){hC=h5;if(h5=="r"){h6[hS]="R"}}}}for(var hR=1,hB=h6[0];hR<hG-1;++hR){var h4=h6[hR];if(h4=="+"&&hB=="1"&&h6[hR+1]=="1"){h6[hR]="1"}else{if(h4==","&&hB==h6[hR+1]&&(hB=="1"||hB=="n")){h6[hR]=hB}}hB=h4}for(var hQ=0;hQ<hG;++hQ){var h3=h6[hQ];if(h3==","){h6[hQ]="N"}else{if(h3=="%"){var hF=(void 0);for(hF=hQ+1;hF<hG&&h6[hF]=="%";++hF){}var hK=(hQ&&h6[hQ-1]=="!")||(hF<hG&&h6[hF]=="1")?"1":"N";for(var h8=hQ;h8<hF;++h8){h6[h8]=hK}hQ=hF-1}}}for(var hP=0,hJ=hM;hP<hG;++hP){var h1=h6[hP];if(hJ=="L"&&h1=="1"){h6[hP]="L"}else{if(ht.test(h1)){hJ=h1}}}for(var hO=0;hO<hG;++hO){if(hz.test(h6[hO])){var hY=(void 0);for(hY=hO+1;hY<hG&&hz.test(h6[hY]);++hY){}var h0=(hO?h6[hO-1]:hM)=="L";var h2=(hY<hG?h6[hY]:hM)=="L";var hW=h0==h2?(h0?"L":"R"):hM;for(var hI=hO;hI<hY;++hI){h6[hI]=hW}hO=hY-1}}var hZ=[],h7;for(var hN=0;hN<hG;){if(hs.test(h6[hN])){var hL=hN;for(++hN;hN<hG&&hs.test(h6[hN]);++hN){}hZ.push(new hy(0,hL,hN))}else{var hV=hN,hA=hZ.length;for(++hN;hN<hG&&h6[hN]!="L";++hN){}for(var hH=hV;hH<hN;){if(hw.test(h6[hH])){if(hV<hH){hZ.splice(hA,0,new hy(1,hV,hH))}var hE=hH;for(++hH;hH<hN&&hw.test(h6[hH]);++hH){}hZ.splice(hA,0,new hy(2,hE,hH));hV=hH}else{++hH}}if(hV<hN){hZ.splice(hA,0,new hy(1,hV,hN))}}}if(hD=="ltr"){if(hZ[0].level==1&&(h7=hX.match(/^\s+/))){hZ[0].from=h7[0].length;hZ.unshift(new hy(0,0,h7[0].length))}if(gA(hZ).level==1&&(h7=hX.match(/\s+$/))){gA(hZ).to-=h7[0].length;hZ.push(new hy(0,hG-h7[0].length,hG))}}return hD=="rtl"?hZ.reverse():hZ}})();function a(hs,ht){var hr=hs.order;if(hr==null){hr=hs.order=bz(hs.text,ht)}return hr}var fY=[];var cn=function(hu,hr,ht){if(hu.addEventListener){hu.addEventListener(hr,ht,false)}else{if(hu.attachEvent){hu.attachEvent("on"+hr,ht)}else{var hs=hu._handlers||(hu._handlers={});hs[hr]=(hs[hr]||fY).concat(ht)}}};function e3(hs,hr){return hs._handlers&&hs._handlers[hr]||fY}function eW(hw,ht,hv){if(hw.removeEventListener){hw.removeEventListener(ht,hv,false)}else{if(hw.detachEvent){hw.detachEvent("on"+ht,hv)}else{var hu=hw._handlers,hr=hu&&hu[ht];if(hr){var hs=dV(hr,hv);if(hs>-1){hu[ht]=hr.slice(0,hs).concat(hr.slice(hs+1))}}}}}function aT(hv,hu){var hr=e3(hv,hu);if(!hr.length){return}var hs=Array.prototype.slice.call(arguments,2);for(var ht=0;ht<hr.length;++ht){hr[ht].apply(null,hs)}}function a8(hr,ht,hs){if(typeof ht=="string"){ht={type:ht,preventDefault:function(){this.defaultPrevented=true}}}aT(hr,hs||ht.type,hr,ht);return ca(ht)||ht.codemirrorIgnore}function ag(hs){var hr=hs._handlers&&hs._handlers.cursorActivity;if(!hr){return}var hu=hs.curOp.cursorActivityHandlers||(hs.curOp.cursorActivityHandlers=[]);for(var ht=0;ht<hr.length;++ht){if(dV(hu,hr[ht])==-1){hu.push(hr[ht])}}}function gc(hs,hr){return e3(hs,hr).length>0}function bX(hr){hr.prototype.on=function(hs,ht){cn(this,hs,ht)};hr.prototype.off=function(hs,ht){eW(this,hs,ht)}}function dd(hr){if(hr.preventDefault){hr.preventDefault()}else{hr.returnValue=false}}function d3(hr){if(hr.stopPropagation){hr.stopPropagation()}else{hr.cancelBubble=true}}function ca(hr){return hr.defaultPrevented!=null?hr.defaultPrevented:hr.returnValue==false}function fa(hr){dd(hr);d3(hr)}function W(hr){return hr.target||hr.srcElement}function gL(hs){var hr=hs.which;if(hr==null){if(hs.button&1){hr=1}else{if(hs.button&2){hr=3}else{if(hs.button&4){hr=2}}}}if(cy&&hs.ctrlKey&&hr==1){hr=3}return hr}var fA=function(){if(em&&o<9){return false}var hr=g7("div");return"draggable" in hr||"dragDrop" in hr}();var gJ;function bJ(hr){if(gJ==null){var ht=g7("span","\u200b");ci(hr,g7("span",[ht,document.createTextNode("x")]));if(hr.firstChild.offsetHeight!=0){gJ=ht.offsetWidth<=1&&ht.offsetHeight>2&&!(em&&o<8)}}var hs=gJ?g7("span","\u200b"):g7("span","\u00a0",null,"display: inline-block; width: 1px; margin-right: -1px");hs.setAttribute("cm-text","");return hs}var gK;function cd(hu){if(gK!=null){return gK}var hr=ci(hu,document.createTextNode("A\u062eA"));var ht=cS(hr,0,1).getBoundingClientRect();var hs=cS(hr,1,2).getBoundingClientRect();eH(hu);if(!ht||ht.left==ht.right){return false}return gK=(hs.right-ht.right<3)}var gQ="\n\nb".split(/\n/).length!=3?function(hw){var hx=0,hr=[],hv=hw.length;while(hx<=hv){var hu=hw.indexOf("\n",hx);if(hu==-1){hu=hw.length}var ht=hw.slice(hx,hw.charAt(hu-1)=="\r"?hu-1:hu);var hs=ht.indexOf("\r");if(hs!=-1){hr.push(ht.slice(0,hs));hx+=hs+1}else{hr.push(ht);hx=hu+1}}return hr}:function(hr){return hr.split(/\r\n?|\n/)};var bP=window.getSelection?function(hs){try{return hs.selectionStart!=hs.selectionEnd}catch(hr){return false}}:function(ht){var hs;try{hs=ht.ownerDocument.selection.createRange()}catch(hr){}if(!hs||hs.parentElement()!=ht){return false}return hs.compareEndPoints("StartToEnd",hs)!=0};var dM=(function(){var hr=g7("div");if("oncopy" in hr){return true}hr.setAttribute("oncopy","return;");return typeof hr.oncopy=="function"})();var fZ=null;function a1(hs){if(fZ!=null){return fZ}var ht=ci(hs,g7("span","x"));var hu=ht.getBoundingClientRect();var hr=cS(ht,0,1).getBoundingClientRect();return fZ=Math.abs(hu.left-hr.left)>1}var d5={},a9={};function fd(hr,hs){if(arguments.length>2){hs.dependencies=Array.prototype.slice.call(arguments,2)}d5[hr]=hs}function bI(hs,hr){a9[hs]=hr}function hi(hr){if(typeof hr=="string"&&a9.hasOwnProperty(hr)){hr=a9[hr]}else{if(hr&&typeof hr.name=="string"&&a9.hasOwnProperty(hr.name)){var hs=a9[hr.name];if(typeof hs=="string"){hs={name:hs}}hr=cQ(hs,hr);hr.name=hs.name}else{if(typeof hr=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(hr)){return hi("application/xml")}else{if(typeof hr=="string"&&/^[\w\-]+\/[\w\-]+\+json$/.test(hr)){return hi("application/json")}}}}if(typeof hr=="string"){return{name:hr}}else{return hr||{name:"null"}}}function gt(ht,hs){hs=hi(hs);var hv=d5[hs.name];if(!hv){return gt(ht,"text/plain")}var hw=hv(ht,hs);if(d2.hasOwnProperty(hs.name)){var hu=d2[hs.name];for(var hx in hu){if(!hu.hasOwnProperty(hx)){continue}if(hw.hasOwnProperty(hx)){hw["_"+hx]=hw[hx]}hw[hx]=hu[hx]}}hw.name=hs.name;if(hs.helperType){hw.helperType=hs.helperType}if(hs.modeProps){for(var hr in hs.modeProps){hw[hr]=hs.modeProps[hr]}}return hw}var d2={};function fq(ht,hs){var hr=d2.hasOwnProperty(ht)?d2[ht]:(d2[ht]={});a4(hs,hr)}function cu(hu,hr){if(hr===true){return hr}if(hu.copyState){return hu.copyState(hr)}var ht={};for(var hv in hr){var hs=hr[hv];if(hs instanceof Array){hs=hs.concat([])}ht[hv]=hs}return ht}function he(ht,hr){var hs;while(ht.innerMode){hs=ht.innerMode(hr);if(!hs||hs.mode==ht){break}hr=hs.state;ht=hs.mode}return hs||{mode:ht,state:hr}}function cr(ht,hs,hr){return ht.startState?ht.startState(hs,hr):true}var fK=function(hr,ht,hs){this.pos=this.start=0;this.string=hr;this.tabSize=ht||8;this.lastColumnPos=this.lastColumnValue=0;this.lineStart=0;this.lineOracle=hs};fK.prototype.eol=function(){return this.pos>=this.string.length};fK.prototype.sol=function(){return this.pos==this.lineStart};fK.prototype.peek=function(){return this.string.charAt(this.pos)||undefined};fK.prototype.next=function(){if(this.pos<this.string.length){return this.string.charAt(this.pos++)}};fK.prototype.eat=function(hr){var ht=this.string.charAt(this.pos);var hs;if(typeof hr=="string"){hs=ht==hr}else{hs=ht&&(hr.test?hr.test(ht):hr(ht))}if(hs){++this.pos;return ht}};fK.prototype.eatWhile=function(hr){var hs=this.pos;while(this.eat(hr)){}return this.pos>hs};fK.prototype.eatSpace=function(){var hs=this;var hr=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos))){++hs.pos}return this.pos>hr};fK.prototype.skipToEnd=function(){this.pos=this.string.length};fK.prototype.skipTo=function(hr){var hs=this.string.indexOf(hr,this.pos);if(hs>-1){this.pos=hs;return true}};fK.prototype.backUp=function(hr){this.pos-=hr};fK.prototype.column=function(){if(this.lastColumnPos<this.start){this.lastColumnValue=ch(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start}return this.lastColumnValue-(this.lineStart?ch(this.string,this.lineStart,this.tabSize):0)};fK.prototype.indentation=function(){return ch(this.string,null,this.tabSize)-(this.lineStart?ch(this.string,this.lineStart,this.tabSize):0)};fK.prototype.match=function(hv,hs,hr){if(typeof hv=="string"){var hw=function(hx){return hr?hx.toLowerCase():hx};var hu=this.string.substr(this.pos,hv.length);if(hw(hu)==hw(hv)){if(hs!==false){this.pos+=hv.length}return true}}else{var ht=this.string.slice(this.pos).match(hv);if(ht&&ht.index>0){return null}if(ht&&hs!==false){this.pos+=ht[0].length}return ht}};fK.prototype.current=function(){return this.string.slice(this.start,this.pos)};fK.prototype.hideFirstChars=function(hs,hr){this.lineStart+=hs;try{return hr()}finally{this.lineStart-=hs}};fK.prototype.lookAhead=function(hs){var hr=this.lineOracle;return hr&&hr.lookAhead(hs)};fK.prototype.baseToken=function(){var hr=this.lineOracle;return hr&&hr.baseToken(this.pos)};var aV=function(hs,hr){this.state=hs;this.lookAhead=hr};var al=function(hu,ht,hr,hs){this.state=ht;this.doc=hu;this.line=hr;this.maxLookAhead=hs||0;this.baseTokens=null;this.baseTokenPos=1};al.prototype.lookAhead=function(hs){var hr=this.doc.getLine(this.line+hs);if(hr!=null&&hs>this.maxLookAhead){this.maxLookAhead=hs}return hr};al.prototype.baseToken=function(ht){var hs=this;if(!this.baseTokens){return null}while(this.baseTokens[this.baseTokenPos]<=ht){hs.baseTokenPos+=2}var hr=this.baseTokens[this.baseTokenPos+1];return{type:hr&&hr.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-ht}};al.prototype.nextLine=function(){this.line++;if(this.maxLookAhead>0){this.maxLookAhead--}};al.fromSaved=function(ht,hs,hr){if(hs instanceof aV){return new al(ht,cu(ht.mode,hs.state),hr,hs.lookAhead)}else{return new al(ht,cu(ht.mode,hs),hr)}};al.prototype.save=function(hs){var hr=hs!==false?cu(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new aV(hr,this.maxLookAhead):hr};function gr(hx,hz,hs,hv){var hy=[hx.state.modeGen],hu={};E(hx,hz.text,hx.doc.mode,hs,function(hA,hB){return hy.push(hA,hB)},hu,hv);var hr=hs.state;var hw=function(hD){hs.baseTokens=hy;var hB=hx.state.overlays[hD],hC=1,hA=0;hs.state=true;E(hx,hz.text,hB.mode,hs,function(hE,hG){var hI=hC;while(hA<hE){var hF=hy[hC];if(hF>hE){hy.splice(hC,1,hE,hy[hC+1],hF)}hC+=2;hA=Math.min(hE,hF)}if(!hG){return}if(hB.opaque){hy.splice(hI,hC-hI,hE,"overlay "+hG);hC=hI+2}else{for(;hI<hC;hI+=2){var hH=hy[hI+1];hy[hI+1]=(hH?hH+" ":"")+"overlay "+hG}}},hu);hs.state=hr;hs.baseTokens=null;hs.baseTokenPos=1};for(var ht=0;ht<hx.state.overlays.length;++ht){hw(ht)}return{styles:hy,classes:hu.bgClass||hu.textClass?hu:null}}function dI(hs,hu,hw){if(!hu.styles||hu.styles[0]!=hs.state.modeGen){var hv=fO(hs,cc(hu));var ht=hu.text.length>hs.options.maxHighlightLength&&cu(hs.doc.mode,hv.state);var hr=gr(hs,hu,hv);if(ht){hv.state=ht}hu.stateAfter=hv.save(!ht);hu.styles=hr.styles;if(hr.classes){hu.styleClasses=hr.classes}else{if(hu.styleClasses){hu.styleClasses=null}}if(hw===hs.doc.highlightFrontier){hs.doc.modeFrontier=Math.max(hs.doc.modeFrontier,++hs.doc.highlightFrontier)}}return hu.styles}function fO(hr,hy,hs){var hw=hr.doc,hv=hr.display;if(!hw.mode.startState){return new al(hw,true,hy)}var hx=c5(hr,hy,hs);var hu=hx>hw.first&&f7(hw,hx-1).stateAfter;var ht=hu?al.fromSaved(hw,hu,hx):new al(hw,cr(hw.mode),hx);hw.iter(hx,hy,function(hz){ea(hr,hz.text,ht);var hA=ht.line;hz.stateAfter=hA==hy-1||hA%5==0||hA>=hv.viewFrom&&hA<hv.viewTo?ht.save():null;ht.nextLine()});if(hs){hw.modeFrontier=ht.line}return ht}function ea(hr,hw,ht,hs){var hv=hr.doc.mode;var hu=new fK(hw,hr.options.tabSize,ht);hu.start=hu.pos=hs||0;if(hw==""){gh(hv,ht.state)}while(!hu.eol()){fo(hv,hu,ht.state);hu.start=hu.pos}}function gh(ht,hs){if(ht.blankLine){return ht.blankLine(hs)}if(!ht.innerMode){return}var hr=he(ht,hs);if(hr.mode.blankLine){return hr.mode.blankLine(hr.state)}}function fo(hw,hv,hu,hr){for(var hs=0;hs<10;hs++){if(hr){hr[0]=he(hw,hu).mode}var ht=hw.token(hv,hu);if(hv.pos>hv.start){return ht}}throw new Error("Mode "+hw.name+" failed to advance stream.")}var dL=function(ht,hr,hs){this.start=ht.start;this.end=ht.pos;this.string=ht.current();this.type=hr||null;this.state=hs};function cX(hz,hx,hu,ht){var hy=hz.doc,hv=hy.mode,hr;hx=gF(hy,hx);var hB=f7(hy,hx.line),hs=fO(hz,hx.line,hu);var hA=new fK(hB.text,hz.options.tabSize,hs),hw;if(ht){hw=[]}while((ht||hA.pos<hx.ch)&&!hA.eol()){hA.start=hA.pos;hr=fo(hv,hA,hs.state);if(ht){hw.push(new dL(hA,hr,cu(hy.mode,hs.state)))}}return ht?hw:new dL(hA,hr,hs.state)}function dW(ht,hs){if(ht){for(;;){var hr=ht.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!hr){break}ht=ht.slice(0,hr.index)+ht.slice(hr.index+hr[0].length);var hu=hr[1]?"bgClass":"textClass";if(hs[hu]==null){hs[hu]=hr[2]}else{if(!(new RegExp("(?:^|s)"+hr[2]+"(?:$|s)")).test(hs[hu])){hs[hu]+=" "+hr[2]}}}}return ht}function E(hB,hD,hw,ht,hx,hu,hv){var hs=hw.flattenSpans;if(hs==null){hs=hB.options.flattenSpans}var hz=0,hy=null;var hC=new fK(hD,hB.options.tabSize,ht),hr;var hF=hB.options.addModeClass&&[null];if(hD==""){dW(gh(hw,ht.state),hu)}while(!hC.eol()){if(hC.pos>hB.options.maxHighlightLength){hs=false;if(hv){ea(hB,hD,ht,hC.pos)}hC.pos=hD.length;hr=null}else{hr=dW(fo(hw,hC,ht.state,hF),hu)}if(hF){var hE=hF[0].name;if(hE){hr="m-"+(hr?hE+" "+hr:hE)}}if(!hs||hy!=hr){while(hz<hC.start){hz=Math.min(hC.start,hz+5000);hx(hz,hy)}hy=hr}hC.start=hC.pos}while(hz<hC.pos){var hA=Math.min(hC.pos,hz+5000);hx(hA,hy);hz=hA}}function c5(hy,hs,hv){var ht,hw,hx=hy.doc;var hu=hv?-1:hs-(hy.doc.mode.innerMode?1000:100);for(var hB=hs;hB>hu;--hB){if(hB<=hx.first){return hx.first}var hA=f7(hx,hB-1),hr=hA.stateAfter;if(hr&&(!hv||hB+(hr instanceof aV?hr.lookAhead:0)<=hx.modeFrontier)){return hB}var hz=ch(hA.text,null,hy.options.tabSize);if(hw==null||ht>hz){hw=hB-1;ht=hz}}return hw}function hk(ht,hv){ht.modeFrontier=Math.min(ht.modeFrontier,hv);if(ht.highlightFrontier<hv-10){return}var hu=ht.first;for(var hr=hv-1;hr>hu;hr--){var hs=f7(ht,hr).stateAfter;if(hs&&(!(hs instanceof aV)||hr+hs.lookAhead<hv)){hu=hr+1;break}}ht.highlightFrontier=Math.min(ht.highlightFrontier,hu)}var hb=function(ht,hs,hr){this.text=ht;dC(this,hs);this.height=hr?hr(this):1};hb.prototype.lineNo=function(){return cc(this)};bX(hb);function e6(hs,hv,ht,hr){hs.text=hv;if(hs.stateAfter){hs.stateAfter=null}if(hs.styles){hs.styles=null}if(hs.order!=null){hs.order=null}hf(hs);dC(hs,ht);var hu=hr?hr(hs):1;if(hu!=hs.height){hc(hs,hu)}}function bZ(hr){hr.parent=null;hf(hr)}var eA={},ct={};function fN(ht,hs){if(!ht||/^\s*$/.test(ht)){return null}var hr=hs.addModeClass?ct:eA;return hr[ht]||(hr[ht]=ht.replace(/\S+/g,"cm-$&"))}function fI(hx,hw){var hv=hd("span",null,null,dz?"padding-right: .1px":null);var hu={pre:hd("pre",[hv],"CodeMirror-line"),content:hv,col:0,pos:0,cm:hx,trailingSpace:false,splitSpaces:hx.getOption("lineWrapping")};hw.measure={};for(var ht=0;ht<=(hw.rest?hw.rest.length:0);ht++){var hz=ht?hw.rest[ht-1]:hw.line,hs=(void 0);hu.pos=0;hu.addToken=B;if(cd(hx.display.measure)&&(hs=a(hz,hx.doc.direction))){hu.addToken=af(hu.addToken,hs)}hu.map=[];var hr=hw!=hx.display.externalMeasured&&cc(hz);bK(hz,hu,dI(hx,hz,hr));if(hz.styleClasses){if(hz.styleClasses.bgClass){hu.bgClass=gU(hz.styleClasses.bgClass,hu.bgClass||"")}if(hz.styleClasses.textClass){hu.textClass=gU(hz.styleClasses.textClass,hu.textClass||"")}}if(hu.map.length==0){hu.map.push(0,0,hu.content.appendChild(bJ(hx.display.measure)))}if(ht==0){hw.measure.map=hu.map;hw.measure.cache={}}else{(hw.measure.maps||(hw.measure.maps=[])).push(hu.map);(hw.measure.caches||(hw.measure.caches=[])).push({})}}if(dz){var hy=hu.content.lastChild;if(/\bcm-tab\b/.test(hy.className)||(hy.querySelector&&hy.querySelector(".cm-tab"))){hu.content.className="cm-tab-wrap-hack"}}aT(hx,"renderLine",hx,hw.line,hu.pre);if(hu.pre.className){hu.textClass=gU(hu.pre.className,hu.textClass||"")}return hu}function f6(hs){var hr=g7("span","\u2022","cm-invalidchar");hr.title="\\u"+hs.charCodeAt(0).toString(16);hr.setAttribute("aria-label",hr.title);return hr}function B(hE,hy,hJ,hG,hB,hx,hw){if(!hy){return}var hI=hE.splitSpaces?dc(hy,hE.trailingSpace):hy;var hr=hE.cm.state.specialChars,hs=false;var hH;if(!hr.test(hy)){hE.col+=hy.length;hH=document.createTextNode(hI);hE.map.push(hE.pos,hE.pos+hy.length,hH);if(em&&o<9){hs=true}hE.pos+=hy.length}else{hH=document.createDocumentFragment();var hu=0;while(true){hr.lastIndex=hu;var hF=hr.exec(hy);var hL=hF?hF.index-hu:hy.length-hu;if(hL){var hA=document.createTextNode(hI.slice(hu,hu+hL));if(em&&o<9){hH.appendChild(g7("span",[hA]))}else{hH.appendChild(hA)}hE.map.push(hE.pos,hE.pos+hL,hA);hE.col+=hL;hE.pos+=hL}if(!hF){break}hu+=hL+1;var hK=(void 0);if(hF[0]=="\t"){var hC=hE.cm.options.tabSize,hz=hC-hE.col%hC;hK=hH.appendChild(g7("span",cW(hz),"cm-tab"));hK.setAttribute("role","presentation");hK.setAttribute("cm-text","\t");hE.col+=hz}else{if(hF[0]=="\r"||hF[0]=="\n"){hK=hH.appendChild(g7("span",hF[0]=="\r"?"\u240d":"\u2424","cm-invalidchar"));hK.setAttribute("cm-text",hF[0]);hE.col+=1}else{hK=hE.cm.options.specialCharPlaceholder(hF[0]);hK.setAttribute("cm-text",hF[0]);if(em&&o<9){hH.appendChild(g7("span",[hK]))}else{hH.appendChild(hK)}hE.col+=1}}hE.map.push(hE.pos,hE.pos+1,hK);hE.pos++}}hE.trailingSpace=hI.charCodeAt(hy.length-1)==32;if(hJ||hG||hB||hs||hx){var ht=hJ||"";if(hG){ht+=hG}if(hB){ht+=hB}var hv=g7("span",[hH],ht,hx);if(hw){for(var hD in hw){if(hw.hasOwnProperty(hD)&&hD!="style"&&hD!="class"){hv.setAttribute(hD,hw[hD])}}}return hE.content.appendChild(hv)}hE.content.appendChild(hH)}function dc(hw,hv){if(hw.length>1&&!/  /.test(hw)){return hw}var hs=hv,hr="";for(var ht=0;ht<hw.length;ht++){var hu=hw.charAt(ht);if(hu==" "&&hs&&(ht==hw.length-1||hw.charCodeAt(ht+1)==32)){hu="\u00a0"}hr+=hu;hs=hu==" "}return hr}function af(hs,hr){return function(hB,hC,ht,hy,hD,hA,hx){ht=ht?ht+" cm-force-border":"cm-force-border";var hu=hB.pos,hw=hu+hC.length;for(;;){var hv=(void 0);for(var hz=0;hz<hr.length;hz++){hv=hr[hz];if(hv.to>hu&&hv.from<=hu){break}}if(hv.to>=hw){return hs(hB,hC,ht,hy,hD,hA,hx)}hs(hB,hC.slice(0,hv.to-hu),ht,hy,null,hA,hx);hy=null;hC=hC.slice(hv.to-hu);hu=hv.to}}}function aq(hs,hu,hr,ht){var hv=!ht&&hr.widgetNode;if(hv){hs.map.push(hs.pos,hs.pos+hu,hv)}if(!ht&&hs.cm.display.input.needsContentAttribute){if(!hv){hv=hs.content.appendChild(document.createElement("span"))}hv.setAttribute("cm-marker",hr.id)}if(hv){hs.cm.display.input.setUneditable(hv);hs.content.appendChild(hv)}hs.pos+=hu;hs.trailingSpace=false}function bK(hD,hL,hC){var hw=hD.markedSpans,hA=hD.text,hI=0;if(!hw){for(var hx=1;hx<hC.length;hx+=2){hL.addToken(hL,hA.slice(hI,hI=hC[hx]),fN(hC[hx+1],hL.cm.options))}return}var hP=hA.length,hv=0,hO=1,hG="",hQ,hE;var hU=0,hr,hT,hH,ht,hz;for(;;){if(hU==hv){hr=hT=hH=hE="";hz=null;ht=null;hU=Infinity;var hy=[],hB=(void 0);for(var hM=0;hM<hw.length;++hM){var hN=hw[hM],hK=hN.marker;if(hK.type=="bookmark"&&hN.from==hv&&hK.widgetNode){hy.push(hK)}else{if(hN.from<=hv&&(hN.to==null||hN.to>hv||hK.collapsed&&hN.to==hv&&hN.from==hv)){if(hN.to!=null&&hN.to!=hv&&hU>hN.to){hU=hN.to;hT=""}if(hK.className){hr+=" "+hK.className}if(hK.css){hE=(hE?hE+";":"")+hK.css}if(hK.startStyle&&hN.from==hv){hH+=" "+hK.startStyle}if(hK.endStyle&&hN.to==hU){(hB||(hB=[])).push(hK.endStyle,hN.to)}if(hK.title){(hz||(hz={})).title=hK.title}if(hK.attributes){for(var hJ in hK.attributes){(hz||(hz={}))[hJ]=hK.attributes[hJ]}}if(hK.collapsed&&(!ht||eu(ht.marker,hK)<0)){ht=hN}}else{if(hN.from>hv&&hU>hN.from){hU=hN.from}}}}if(hB){for(var hS=0;hS<hB.length;hS+=2){if(hB[hS+1]==hU){hT+=" "+hB[hS]}}}if(!ht||ht.from==hv){for(var hR=0;hR<hy.length;++hR){aq(hL,0,hy[hR])}}if(ht&&(ht.from||0)==hv){aq(hL,(ht.to==null?hP+1:ht.to)-hv,ht.marker,ht.from==null);if(ht.to==null){return}if(ht.to==hv){ht=false}}}if(hv>=hP){break}var hF=Math.min(hP,hU);while(true){if(hG){var hs=hv+hG.length;if(!ht){var hu=hs>hF?hG.slice(0,hF-hv):hG;hL.addToken(hL,hu,hQ?hQ+hr:hr,hH,hv+hu.length==hU?hT:"",hE,hz)}if(hs>=hF){hG=hG.slice(hF-hv);hv=hF;break}hv=hs;hH=""}hG=hA.slice(hI,hI=hC[hO++]);hQ=fN(hC[hO++],hL.cm.options)}}}function bS(ht,hr,hs){this.line=hr;this.rest=g(hr);this.size=this.rest?cc(gA(this.rest))-hs+1:1;this.node=this.text=null;this.hidden=gn(ht,hr)}function fM(hr,hx,hw){var hv=[],ht;for(var hu=hx;hu<hw;hu=ht){var hs=new bS(hr.doc,f7(hr.doc,hu),hu);ht=hu+hs.size;hv.push(hs)}return hv}var bM=null;function fj(hr){if(bM){bM.ops.push(hr)}else{hr.ownsGroup=bM={ops:[hr],delayedCallbacks:[]}}}function dt(hu){var ht=hu.delayedCallbacks,hs=0;do{for(;hs<ht.length;hs++){ht[hs].call(null)}for(var hr=0;hr<hu.ops.length;hr++){var hv=hu.ops[hr];if(hv.cursorActivityHandlers){while(hv.cursorActivityCalled<hv.cursorActivityHandlers.length){hv.cursorActivityHandlers[hv.cursorActivityCalled++].call(null,hv.cm)}}}}while(hs<ht.length)}function co(ht,hs){var hr=ht.ownsGroup;if(!hr){return}try{dt(hr)}finally{bM=null;hs(hr)}}var bW=null;function ar(hx,hv){var hr=e3(hx,hv);if(!hr.length){return}var ht=Array.prototype.slice.call(arguments,2),hw;if(bM){hw=bM.delayedCallbacks}else{if(bW){hw=bW}else{hw=bW=[];setTimeout(a2,0)}}var hs=function(hy){hw.push(function(){return hr[hy].apply(null,ht)})};for(var hu=0;hu<hr.length;++hu){hs(hu)}}function a2(){var hr=bW;bW=null;for(var hs=0;hs<hr.length;++hs){hr[hs]()}}function ao(hr,ht,hv,hw){for(var hs=0;hs<ht.changes.length;hs++){var hu=ht.changes[hs];if(hu=="text"){gd(hr,ht)}else{if(hu=="gutter"){dS(hr,ht,hv,hw)}else{if(hu=="class"){eh(hr,ht)}else{if(hu=="widget"){aC(hr,ht,hw)}}}}}ht.changes=null}function gC(hr){if(hr.node==hr.text){hr.node=g7("div",null,null,"position: relative");if(hr.text.parentNode){hr.text.parentNode.replaceChild(hr.node,hr.text)}hr.node.appendChild(hr.text);if(em&&o<8){hr.node.style.zIndex=2}}return hr.node}function ff(hr,ht){var hs=ht.bgClass?ht.bgClass+" "+(ht.line.bgClass||""):ht.line.bgClass;if(hs){hs+=" CodeMirror-linebackground"}if(ht.background){if(hs){ht.background.className=hs}else{ht.background.parentNode.removeChild(ht.background);ht.background=null}}else{if(hs){var hu=gC(ht);ht.background=hu.insertBefore(g7("div",null,hs),hu.firstChild);hr.display.input.setUneditable(ht.background)}}}function ez(hr,hs){var ht=hr.display.externalMeasured;if(ht&&ht.line==hs.line){hr.display.externalMeasured=null;hs.measure=ht.measure;return ht.built}return fI(hr,hs)}function gd(hr,hu){var hs=hu.text.className;var ht=ez(hr,hu);if(hu.text==hu.node){hu.node=ht.pre}hu.text.parentNode.replaceChild(ht.pre,hu.text);hu.text=ht.pre;if(ht.bgClass!=hu.bgClass||ht.textClass!=hu.textClass){hu.bgClass=ht.bgClass;hu.textClass=ht.textClass;eh(hr,hu)}else{if(hs){hu.text.className=hs}}}function eh(hs,ht){ff(hs,ht);if(ht.line.wrapClass){gC(ht).className=ht.line.wrapClass}else{if(ht.node!=ht.text){ht.node.className=""}}var hr=ht.textClass?ht.textClass+" "+(ht.line.textClass||""):ht.line.textClass;ht.text.className=hr||""}function dS(hz,hx,hw,hy){if(hx.gutter){hx.node.removeChild(hx.gutter);hx.gutter=null}if(hx.gutterBackground){hx.node.removeChild(hx.gutterBackground);hx.gutterBackground=null}if(hx.line.gutterClass){var hs=gC(hx);hx.gutterBackground=g7("div",null,"CodeMirror-gutter-background "+hx.line.gutterClass,("left: "+(hz.options.fixedGutter?hy.fixedPos:-hy.gutterTotalWidth)+"px; width: "+(hy.gutterTotalWidth)+"px"));hz.display.input.setUneditable(hx.gutterBackground);hs.insertBefore(hx.gutterBackground,hx.text)}var hu=hx.line.gutterMarkers;if(hz.options.lineNumbers||hu){var hA=gC(hx);var hv=hx.gutter=g7("div",null,"CodeMirror-gutter-wrapper",("left: "+(hz.options.fixedGutter?hy.fixedPos:-hy.gutterTotalWidth)+"px"));hz.display.input.setUneditable(hv);hA.insertBefore(hv,hx.text);if(hx.line.gutterClass){hv.className+=" "+hx.line.gutterClass}if(hz.options.lineNumbers&&(!hu||!hu["CodeMirror-linenumbers"])){hx.lineNumber=hv.appendChild(g7("div",fc(hz.options,hw),"CodeMirror-linenumber CodeMirror-gutter-elt",("left: "+(hy.gutterLeft["CodeMirror-linenumbers"])+"px; width: "+(hz.display.lineNumInnerWidth)+"px")))}if(hu){for(var ht=0;ht<hz.options.gutters.length;++ht){var hr=hz.options.gutters[ht],hB=hu.hasOwnProperty(hr)&&hu[hr];if(hB){hv.appendChild(g7("div",[hB],"CodeMirror-gutter-elt",("left: "+(hy.gutterLeft[hr])+"px; width: "+(hy.gutterWidth[hr])+"px")))}}}}}function aC(hr,hs,hv){if(hs.alignable){hs.alignable=null}for(var hu=hs.node.firstChild,ht=(void 0);hu;hu=ht){ht=hu.nextSibling;if(hu.className=="CodeMirror-linewidget"){hs.node.removeChild(hu)}}gk(hr,hs,hv)}function aU(hr,ht,hu,hv){var hs=ez(hr,ht);ht.text=ht.node=hs.pre;if(hs.bgClass){ht.bgClass=hs.bgClass}if(hs.textClass){ht.textClass=hs.textClass}eh(hr,ht);dS(hr,ht,hu,hv);gk(hr,ht,hv);return ht.node}function gk(hr,ht,hu){ha(hr,ht.line,ht,hu,true);if(ht.rest){for(var hs=0;hs<ht.rest.length;hs++){ha(hr,ht.rest[hs],ht,hu,false)}}}function ha(hz,hA,hw,hy,hu){if(!hA.widgets){return}var hr=gC(hw);for(var ht=0,hx=hA.widgets;ht<hx.length;++ht){var hv=hx[ht],hs=g7("div",[hv.node],"CodeMirror-linewidget");if(!hv.handleMouseEvents){hs.setAttribute("cm-ignore-events","true")}b3(hv,hs,hw,hy);hz.display.input.setUneditable(hs);if(hu&&hv.above){hr.insertBefore(hs,hw.gutter||hw.text)}else{hr.appendChild(hs)}ar(hv,"redraw")}}function b3(hu,ht,hr,hv){if(hu.noHScroll){(hr.alignable||(hr.alignable=[])).push(ht);var hs=hv.wrapperWidth;ht.style.left=hv.fixedPos+"px";if(!hu.coverGutter){hs-=hv.gutterTotalWidth;ht.style.paddingLeft=hv.gutterTotalWidth+"px"}ht.style.width=hs+"px"}if(hu.coverGutter){ht.style.zIndex=5;ht.style.position="relative";if(!hu.noHScroll){ht.style.marginLeft=-hv.gutterTotalWidth+"px"}}}function dx(ht){if(ht.height!=null){return ht.height}var hr=ht.doc.cm;if(!hr){return 0}if(!hh(document.body,ht.node)){var hs="position: relative;";if(ht.coverGutter){hs+="margin-left: -"+hr.display.gutters.offsetWidth+"px;"}if(ht.noHScroll){hs+="width: "+hr.display.wrapper.clientWidth+"px;"}ci(hr.display.measure,g7("div",[ht.node],null,hs))}return ht.height=ht.node.parentNode.offsetHeight}function bs(hs,hr){for(var ht=W(hr);ht!=hs.wrapper;ht=ht.parentNode){if(!ht||(ht.nodeType==1&&ht.getAttribute("cm-ignore-events")=="true")||(ht.parentNode==hs.sizer&&ht!=hs.mover)){return true}}}function f1(hr){return hr.lineSpace.offsetTop}function b6(hr){return hr.mover.offsetHeight-hr.lineSpace.offsetHeight}function fX(hu){if(hu.cachedPaddingH){return hu.cachedPaddingH}var ht=ci(hu.measure,g7("pre","x"));var hr=window.getComputedStyle?window.getComputedStyle(ht):ht.currentStyle;var hs={left:parseInt(hr.paddingLeft),right:parseInt(hr.paddingRight)};if(!isNaN(hs.left)&&!isNaN(hs.right)){hu.cachedPaddingH=hs}return hs}function ds(hr){return ek-hr.display.nativeBarWidth}function dY(hr){return hr.display.scroller.clientWidth-ds(hr)-hr.display.barWidth}function du(hr){return hr.display.scroller.clientHeight-ds(hr)-hr.display.barHeight}function cL(hy,hu,hx){var ht=hy.options.lineWrapping;var hv=ht&&dY(hy);if(!hu.measure.heights||ht&&hu.measure.width!=hv){var hw=hu.measure.heights=[];if(ht){hu.measure.width=hv;var hA=hu.text.firstChild.getClientRects();for(var hr=0;hr<hA.length-1;hr++){var hz=hA[hr],hs=hA[hr+1];if(Math.abs(hz.bottom-hs.bottom)>2){hw.push((hz.bottom+hs.top)/2-hx.top)}}}hw.push(hx.bottom-hx.top)}}function c0(ht,hr,hu){if(ht.line==hr){return{map:ht.measure.map,cache:ht.measure.cache}}for(var hs=0;hs<ht.rest.length;hs++){if(ht.rest[hs]==hr){return{map:ht.measure.maps[hs],cache:ht.measure.caches[hs]}}}for(var hv=0;hv<ht.rest.length;hv++){if(cc(ht.rest[hv])>hu){return{map:ht.measure.maps[hv],cache:ht.measure.caches[hv],before:true}}}}function dB(hr,ht){ht=G(ht);var hv=cc(ht);var hs=hr.display.externalMeasured=new bS(hr.doc,ht,hv);hs.lineN=hv;var hu=hs.built=fI(hr,hs);hs.text=hu.pre;ci(hr.display.lineMeasure,hu.pre);return hs}function eY(hr,hs,hu,ht){return M(hr,bm(hr,hs),hu,ht)}function f4(hr,ht){if(ht>=hr.display.viewFrom&&ht<hr.display.viewTo){return hr.display.view[d4(hr,ht)]}var hs=hr.display.externalMeasured;if(hs&&ht>=hs.lineN&&ht<hs.lineN+hs.size){return hs}}function bm(hr,ht){var hu=cc(ht);var hs=f4(hr,hu);if(hs&&!hs.text){hs=null}else{if(hs&&hs.changes){ao(hr,hs,hu,f5(hr));hr.curOp.forceUpdate=true}}if(!hs){hs=dB(hr,ht)}var hv=c0(hs,ht,hu);return{line:ht,view:hs,rect:null,map:hv.map,cache:hv.cache,before:hv.before,hasHeights:false}}function M(hr,hx,hv,hs,hu){if(hx.before){hv=-1}var ht=hv+(hs||""),hw;if(hx.cache.hasOwnProperty(ht)){hw=hx.cache[ht]}else{if(!hx.rect){hx.rect=hx.view.text.getBoundingClientRect()}if(!hx.hasHeights){cL(hr,hx.view,hx.rect);hx.hasHeights=true}hw=n(hr,hx,hv,hs);if(!hw.bogus){hx.cache[ht]=hw}}return{left:hw.left,right:hw.right,top:hu?hw.rtop:hw.top,bottom:hu?hw.rbottom:hw.bottom}}var fn={left:0,right:0,top:0,bottom:0};function a0(hA,hr,hx){var ht,hs,hv,hy,hu,hz;for(var hw=0;hw<hA.length;hw+=3){hu=hA[hw];hz=hA[hw+1];if(hr<hu){hs=0;hv=1;hy="left"}else{if(hr<hz){hs=hr-hu;hv=hs+1}else{if(hw==hA.length-3||hr==hz&&hA[hw+3]>hr){hv=hz-hu;hs=hv-1;if(hr>=hz){hy="right"}}}}if(hs!=null){ht=hA[hw+2];if(hu==hz&&hx==(ht.insertLeft?"left":"right")){hy=hx}if(hx=="left"&&hs==0){while(hw&&hA[hw-2]==hA[hw-3]&&hA[hw-1].insertLeft){ht=hA[(hw-=3)+2];hy="left"}}if(hx=="right"&&hs==hz-hu){while(hw<hA.length-3&&hA[hw+3]==hA[hw+4]&&!hA[hw+5].insertLeft){ht=hA[(hw+=3)+2];hy="right"}}break}}return{node:ht,start:hs,end:hv,collapse:hy,coverStart:hu,coverEnd:hz}}function fJ(hs,hr){var hu=fn;if(hr=="left"){for(var ht=0;ht<hs.length;ht++){if((hu=hs[ht]).left!=hu.right){break}}}else{for(var hv=hs.length-1;hv>=0;hv--){if((hu=hs[hv]).left!=hu.right){break}}}return hu}function n(hz,hJ,hC,hw){var hA=a0(hJ.map,hC,hw);var hH=hA.node,hv=hA.start,hu=hA.end,hr=hA.collapse;var hs;if(hH.nodeType==3){for(var hx=0;hx<4;hx++){while(hv&&gg(hJ.line.text.charAt(hA.coverStart+hv))){--hv}while(hA.coverStart+hu<hA.coverEnd&&gg(hJ.line.text.charAt(hA.coverStart+hu))){++hu}if(em&&o<9&&hv==0&&hu==hA.coverEnd-hA.coverStart){hs=hH.parentNode.getBoundingClientRect()}else{hs=fJ(cS(hH,hv,hu).getClientRects(),hw)}if(hs.left||hs.right||hv==0){break}hu=hv;hv=hv-1;hr="right"}if(em&&o<11){hs=fD(hz.display.measure,hs)}}else{if(hv>0){hr=hw="right"}var ht;if(hz.options.lineWrapping&&(ht=hH.getClientRects()).length>1){hs=ht[hw=="right"?ht.length-1:0]}else{hs=hH.getBoundingClientRect()}}if(em&&o<9&&!hv&&(!hs||!hs.left&&!hs.right)){var hy=hH.parentNode.getClientRects()[0];if(hy){hs={left:hy.left,right:hy.left+ee(hz.display),top:hy.top,bottom:hy.bottom}}else{hs=fn}}var hF=hs.top-hJ.rect.top,hD=hs.bottom-hJ.rect.top;var hL=(hF+hD)/2;var hK=hJ.view.measure.heights;var hI=0;for(;hI<hK.length-1;hI++){if(hL<hK[hI]){break}}var hG=hI?hK[hI-1]:0,hE=hK[hI];var hB={left:(hr=="right"?hs.right:hs.left)-hJ.rect.left,right:(hr=="left"?hs.left:hs.right)-hJ.rect.left,top:hG,bottom:hE};if(!hs.left&&!hs.right){hB.bogus=true}if(!hz.options.singleCursorHeightPerLine){hB.rtop=hF;hB.rbottom=hD}return hB}function fD(ht,hu){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!a1(ht)){return hu}var hs=screen.logicalXDPI/screen.deviceXDPI;var hr=screen.logicalYDPI/screen.deviceYDPI;return{left:hu.left*hs,right:hu.right*hs,top:hu.top*hr,bottom:hu.bottom*hr}}function aJ(hs){if(hs.measure){hs.measure.cache={};hs.measure.heights=null;if(hs.rest){for(var hr=0;hr<hs.rest.length;hr++){hs.measure.caches[hr]={}}}}}function a5(hr){hr.display.externalMeasure=null;eH(hr.display.lineMeasure);for(var hs=0;hs<hr.display.view.length;hs++){aJ(hr.display.view[hs])}}function ax(hr){a5(hr);hr.display.cachedCharWidth=hr.display.cachedTextHeight=hr.display.cachedPaddingH=null;if(!hr.options.lineWrapping){hr.display.maxLineChanged=true}hr.display.lineNumChars=null}function c1(){if(dP&&a3){return -(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft))}return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function cZ(){if(dP&&a3){return -(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop))}return window.pageYOffset||(document.documentElement||document.body).scrollTop}function el(hs){var hr=0;if(hs.widgets){for(var ht=0;ht<hs.widgets.length;++ht){if(hs.widgets[ht].above){hr+=dx(hs.widgets[ht])}}}return hr}function fG(hx,hu,hw,hs,ht){if(!ht){var hy=el(hu);hw.top+=hy;hw.bottom+=hy}if(hs=="line"){return hw}if(!hs){hs="local"}var hv=cb(hu);if(hs=="local"){hv+=f1(hx.display)}else{hv-=hx.display.viewOffset}if(hs=="page"||hs=="window"){var hr=hx.display.lineSpace.getBoundingClientRect();hv+=hr.top+(hs=="window"?0:cZ());var hz=hr.left+(hs=="window"?0:c1());hw.left+=hz;hw.right+=hz}hw.top+=hv;hw.bottom+=hv;return hw}function hm(hs,hv,ht){if(ht=="div"){return hv}var hx=hv.left,hw=hv.top;if(ht=="page"){hx-=c1();hw-=cZ()}else{if(ht=="local"||!ht){var hu=hs.display.sizer.getBoundingClientRect();hx+=hu.left;hw+=hu.top}}var hr=hs.display.lineSpace.getBoundingClientRect();return{left:hx-hr.left,top:hw-hr.top}}function di(hr,hv,hu,ht,hs){if(!ht){ht=f7(hr.doc,hv.line)}return fG(hr,ht,eY(hr,ht,hv.ch,hs),hu)}function ey(hC,hA,ht,hx,hE,hy){hx=hx||f7(hC.doc,hA.line);if(!hE){hE=bm(hC,hx)}function hv(hH,hG){var hF=M(hC,hE,hH,hG?"right":"left",hy);if(hG){hF.left=hF.right}else{hF.right=hF.left}return fG(hC,hx,hF,ht)}var hw=a(hx,hC.doc.direction),hr=hA.ch,hB=hA.sticky;if(hr>=hx.text.length){hr=hx.text.length;hB="before"}else{if(hr<=0){hr=0;hB="after"}}if(!hw){return hv(hB=="before"?hr-1:hr,hB=="before")}function hD(hI,hF,hJ){var hG=hw[hF],hH=hG.level==1;return hv(hJ?hI-1:hI,hH!=hJ)}var hs=aX(hw,hr,hB);var hz=fV;var hu=hD(hr,hs,hB=="before");if(hz!=null){hu.other=hD(hr,hz,hB!="before")}return hu}function ei(hr,hv){var hu=0;hv=gF(hr.doc,hv);if(!hr.options.lineWrapping){hu=ee(hr.display)*hv.ch}var hs=f7(hr.doc,hv.line);var ht=cb(hs)+f1(hr.display);return{left:hu,right:hu,top:ht,bottom:ht+hs.height}}function g5(hr,hs,hu,ht,hw){var hv=ah(hr,hs,hu);hv.xRel=hw;if(ht){hv.outside=true}return hv}function gN(hy,hw,hv){var hx=hy.doc;hv+=hy.display.viewOffset;if(hv<0){return g5(hx.first,0,null,true,-1)}var hu=b5(hx,hv),hz=hx.first+hx.size-1;if(hu>hz){return g5(hx.first+hx.size-1,f7(hx,hz).text.length,null,true,1)}if(hw<0){hw=0}var ht=f7(hx,hu);for(;;){var hA=dy(hy,ht,hu,hw,hv);var hs=cI(ht,hA.ch+(hA.xRel>0?1:0));if(!hs){return hA}var hr=hs.find(1);if(hr.line==hu){return hr}ht=f7(hx,hu=hr.line)}}function bH(hr,ht,hv,hw){hw-=el(ht);var hs=ht.text.length;var hu=cT(function(hx){return M(hr,hv,hx-1).bottom<=hw},hs,0);hs=cT(function(hx){return M(hr,hv,hx).top>hw},hu,hs);return{begin:hu,end:hs}}function bF(hr,hs,hu,hv){if(!hu){hu=bm(hr,hs)}var ht=fG(hr,hs,M(hr,hu,hv),"line").top;return bH(hr,hs,hu,ht)}function aF(hs,hr,hu,ht){return hs.bottom<=hu?false:hs.top>hu?true:(ht?hs.left:hs.right)>hr}function dy(hu,hs,hJ,hx,hw){hw-=cb(hs);var hB=bm(hu,hs);var hL=el(hs);var hI=0,ht=hs.text.length,hF=true;var hD=a(hs,hu.doc.direction);if(hD){var hC=(hu.options.lineWrapping?g2:gH)(hu,hs,hJ,hB,hD,hx,hw);hF=hC.level!=1;hI=hF?hC.from:hC.to-1;ht=hF?hC.to:hC.from-1}var hv=null,hz=null;var hA=cT(function(hM){var hN=M(hu,hB,hM);hN.top+=hL;hN.bottom+=hL;if(!aF(hN,hx,hw,false)){return false}if(hN.top<=hw&&hN.left<=hx){hv=hM;hz=hN}return true},hI,ht);var hr,hK,hH=false;if(hz){var hG=hx-hz.left<hz.right-hx,hy=hG==hF;hA=hv+(hy?0:1);hK=hy?"after":"before";hr=hG?hz.left:hz.right}else{if(!hF&&(hA==ht||hA==hI)){hA++}hK=hA==0?"after":hA==hs.text.length?"before":(M(hu,hB,hA-(hF?1:0)).bottom+hL<=hw)==hF?"after":"before";var hE=ey(hu,ah(hJ,hA,hK),"line",hs,hB);hr=hE.left;hH=hw<hE.top||hw>=hE.bottom}hA=e1(hs.text,hA,1);return g5(hJ,hA,hK,hH,hx-hr)}function gH(hA,hw,hr,hB,hv,hz,hy){var hx=cT(function(hE){var hC=hv[hE],hD=hC.level!=1;return aF(ey(hA,ah(hr,hD?hC.to:hC.from,hD?"before":"after"),"line",hw,hB),hz,hy,true)},0,hv.length-1);var hu=hv[hx];if(hx>0){var ht=hu.level!=1;var hs=ey(hA,ah(hr,ht?hu.from:hu.to,ht?"after":"before"),"line",hw,hB);if(aF(hs,hz,hy,true)&&hs.top>hy){hu=hv[hx-1]}}return hu}function g2(hE,hz,hC,hH,hw,hD,hB){var hv=bH(hE,hz,hH,hB);var hu=hv.begin;var hx=hv.end;if(/\s/.test(hz.text.charAt(hx-1))){hx--}var ht=null,hF=null;for(var hy=0;hy<hw.length;hy++){var hr=hw[hy];if(hr.from>=hx||hr.to<=hu){continue}var hs=hr.level!=1;var hG=M(hE,hH,hs?Math.min(hx,hr.to)-1:Math.max(hu,hr.from)).right;var hA=hG<hD?hD-hG+1000000000:hG-hD;if(!ht||hF>hA){ht=hr;hF=hA}}if(!ht){ht=hw[hw.length-1]}if(ht.from<hu){ht={from:hu,to:ht.to,level:ht.level}}if(ht.to>hx){ht={from:ht.from,to:hx,level:ht.level}}return ht}var aW;function bf(ht){if(ht.cachedTextHeight!=null){return ht.cachedTextHeight}if(aW==null){aW=g7("pre");for(var hs=0;hs<49;++hs){aW.appendChild(document.createTextNode("x"));aW.appendChild(g7("br"))}aW.appendChild(document.createTextNode("x"))}ci(ht.measure,aW);var hr=aW.offsetHeight/50;if(hr>3){ht.cachedTextHeight=hr}eH(ht.measure);return hr||1}function ee(hv){if(hv.cachedCharWidth!=null){return hv.cachedCharWidth}var hr=g7("span","xxxxxxxxxx");var hu=g7("pre",[hr]);ci(hv.measure,hu);var ht=hr.getBoundingClientRect(),hs=(ht.right-ht.left)/10;if(hs>2){hv.cachedCharWidth=hs}return hs||10}function f5(hr){var hw=hr.display,hu={},ht={};var hv=hw.gutters.clientLeft;for(var hx=hw.gutters.firstChild,hs=0;hx;hx=hx.nextSibling,++hs){hu[hr.options.gutters[hs]]=hx.offsetLeft+hx.clientLeft+hv;ht[hr.options.gutters[hs]]=hx.clientWidth}return{fixedPos:eC(hw),gutterTotalWidth:hw.gutters.offsetWidth,gutterLeft:hu,gutterWidth:ht,wrapperWidth:hw.wrapper.clientWidth}}function eC(hr){return hr.scroller.getBoundingClientRect().left-hr.sizer.getBoundingClientRect().left}function bv(hr){var ht=bf(hr.display),hs=hr.options.lineWrapping;var hu=hs&&Math.max(5,hr.display.scroller.clientWidth/ee(hr.display)-3);return function(hw){if(gn(hr.doc,hw)){return 0}var hv=0;if(hw.widgets){for(var hx=0;hx<hw.widgets.length;hx++){if(hw.widgets[hx].height){hv+=hw.widgets[hx].height}}}if(hs){return hv+(Math.ceil(hw.text.length/hu)||1)*ht}else{return hv+ht}}}function ak(hr){var ht=hr.doc,hs=bv(hr);ht.iter(function(hu){var hv=hs(hu);if(hv!=hu.height){hc(hu,hv)}})}function cU(hA,hv,hs,ht){var hw=hA.display;if(!hs&&W(hv).getAttribute("cm-not-content")=="true"){return null}var hz,hx,hr=hw.lineSpace.getBoundingClientRect();try{hz=hv.clientX-hr.left;hx=hv.clientY-hr.top}catch(hv){return null}var hy=gN(hA,hz,hx),hB;if(ht&&hy.xRel==1&&(hB=f7(hA.doc,hy.line).text).length==hy.ch){var hu=ch(hB,hB.length,hA.options.tabSize)-hB.length;hy=ah(hy.line,Math.max(0,Math.round((hz-fX(hA.display).left)/ee(hA.display))-hu))}return hy}function d4(hr,hu){if(hu>=hr.display.viewTo){return null}hu-=hr.display.viewFrom;if(hu<0){return null}var hs=hr.display.view;for(var ht=0;ht<hs.length;ht++){hu-=hs[ht].size;if(hu<0){return ht}}}function b0(hr){hr.display.input.showSelection(hr.display.input.prepareSelection())}function gD(hx,hr){if(hr===void 0){hr=true}var hw=hx.doc,hz={};var hv=hz.cursors=document.createDocumentFragment();var hs=hz.selection=document.createDocumentFragment();for(var hu=0;hu<hw.sel.ranges.length;hu++){if(!hr&&hu==hw.sel.primIndex){continue}var hy=hw.sel.ranges[hu];if(hy.from().line>=hx.display.viewTo||hy.to().line<hx.display.viewFrom){continue}var ht=hy.empty();if(ht||hx.options.showCursorWhenSelecting){J(hx,hy.head,hv)}if(!ht){b1(hx,hy,hs)}}return hz}function J(hr,hu,ht){var hw=ey(hr,hu,"div",null,null,!hr.options.singleCursorHeightPerLine);var hv=ht.appendChild(g7("div","\u00a0","CodeMirror-cursor"));hv.style.left=hw.left+"px";hv.style.top=hw.top+"px";hv.style.height=Math.max(0,hw.bottom-hw.top)*hr.options.cursorHeight+"px";if(hw.other){var hs=ht.appendChild(g7("div","\u00a0","CodeMirror-cursor CodeMirror-secondarycursor"));hs.style.display="";hs.style.left=hw.other.left+"px";hs.style.top=hw.other.top+"px";hs.style.height=(hw.other.bottom-hw.other.top)*0.85+"px"}}function gX(hs,hr){return hs.top-hr.top||hs.left-hr.left}function b1(hx,hw,hy){var hF=hx.display,hJ=hx.doc;var hr=document.createDocumentFragment();var hC=fX(hx.display),hu=hC.left;var hG=Math.max(hF.sizerWidth,dY(hx)-hF.sizer.offsetLeft)-hC.right;var hv=hJ.direction=="ltr";function hD(hN,hM,hL,hK){if(hM<0){hM=0}hM=Math.round(hM);hK=Math.round(hK);hr.appendChild(g7("div",null,"CodeMirror-selected",("position: absolute; left: "+hN+"px;\n                             top: "+hM+"px; width: "+(hL==null?hG-hN:hL)+"px;\n                             height: "+(hK-hM)+"px")))}function hs(hT,hL,hS){var hP=f7(hJ,hT);var hQ=hP.text.length;var hK,hO;function hR(hV,hU){return di(hx,ah(hT,hV),"div",hP,hU)}function hM(hZ,hU,hV){var hX=bF(hx,hP,null,hZ);var hY=(hU=="ltr")==(hV=="after")?"left":"right";var hW=hV=="after"?hX.begin:hX.end-(/\s/.test(hP.text.charAt(hX.end-1))?2:1);return hR(hW,hY)[hY]}var hN=a(hP,hJ.direction);eK(hN,hL||0,hS==null?hQ:hS,function(h5,hU,h0,h8){var ib=h0=="ltr";var h6=hR(h5,ib?"left":"right");var h4=hR(hU-1,ib?"right":"left");var ia=hL==null&&h5==0,h7=hS==null&&hU==hQ;var hW=h8==0,hY=!hN||h8==hN.length-1;if(h4.top-h6.top<=3){var hX=(hv?ia:h7)&&hW;var hZ=(hv?h7:ia)&&hY;var hV=hX?hu:(ib?h6:h4).left;var ic=hZ?hG:(ib?h4:h6).right;hD(hV,h6.top,ic-hV,h6.bottom)}else{var h2,h1,h9,h3;if(ib){h2=hv&&ia&&hW?hu:h6.left;h1=hv?hG:hM(h5,h0,"before");h9=hv?hu:hM(hU,h0,"after");h3=hv&&h7&&hY?hG:h4.right}else{h2=!hv?hu:hM(h5,h0,"before");h1=!hv&&ia&&hW?hG:h6.right;h9=!hv&&h7&&hY?hu:h4.left;h3=!hv?hG:hM(hU,h0,"after")}hD(h2,h6.top,h1-h2,h6.bottom);if(h6.bottom<h4.top){hD(hu,h6.bottom,null,h4.top)}hD(h9,h4.top,h3-h9,h4.bottom)}if(!hK||gX(h6,hK)<0){hK=h6}if(gX(h4,hK)<0){hK=h4}if(!hO||gX(h6,hO)<0){hO=h6}if(gX(h4,hO)<0){hO=h4}});return{start:hK,end:hO}}var hI=hw.from(),hH=hw.to();if(hI.line==hH.line){hs(hI.line,hI.ch,hH.ch)}else{var ht=f7(hJ,hI.line),hA=f7(hJ,hH.line);var hz=G(ht)==G(hA);var hB=hs(hI.line,hI.ch,hz?ht.text.length+1:null).end;var hE=hs(hH.line,hz?0:null,hH.ch).start;if(hz){if(hB.top<hE.top-2){hD(hB.right,hB.top,null,hB.bottom);hD(hu,hE.top,hE.left,hE.bottom)}else{hD(hB.right,hB.top,hE.left-hB.right,hB.bottom)}}if(hB.bottom<hE.top){hD(hu,hB.bottom,null,hE.top)}}hy.appendChild(hr)}function u(hr){if(!hr.state.focused){return}var ht=hr.display;clearInterval(ht.blinker);var hs=true;ht.cursorDiv.style.visibility="";if(hr.options.cursorBlinkRate>0){ht.blinker=setInterval(function(){return ht.cursorDiv.style.visibility=(hs=!hs)?"":"hidden"},hr.options.cursorBlinkRate)}else{if(hr.options.cursorBlinkRate<0){ht.cursorDiv.style.visibility="hidden"}}}function A(hr){if(!hr.state.focused){hr.display.input.focus();c8(hr)}}function ay(hr){hr.state.delayingBlurEvent=true;setTimeout(function(){if(hr.state.delayingBlurEvent){hr.state.delayingBlurEvent=false;bc(hr)}},100)}function c8(hr,hs){if(hr.state.delayingBlurEvent){hr.state.delayingBlurEvent=false}if(hr.options.readOnly=="nocursor"){return}if(!hr.state.focused){aT(hr,"focus",hr,hs);hr.state.focused=true;gu(hr.display.wrapper,"CodeMirror-focused");if(!hr.curOp&&hr.display.selForContextMenu!=hr.doc.sel){hr.display.input.reset();if(dz){setTimeout(function(){return hr.display.input.reset(true)},20)}}hr.display.input.receivedFocus()}u(hr)}function bc(hr,hs){if(hr.state.delayingBlurEvent){return}if(hr.state.focused){aT(hr,"blur",hr,hs);hr.state.focused=false;j(hr.display.wrapper,"CodeMirror-focused")}clearInterval(hr.display.blinker);setTimeout(function(){if(!hr.state.focused){hr.display.shift=false}},150)}function bq(hB){var hz=hB.display;var ht=hz.lineDiv.offsetTop;for(var hu=0;hu<hz.view.length;hu++){var hC=hz.view[hu],hw=hB.options.lineWrapping;var hD=(void 0),hr=0;if(hC.hidden){continue}if(em&&o<8){var hy=hC.node.offsetTop+hC.node.offsetHeight;hD=hy-ht;ht=hy}else{var hv=hC.node.getBoundingClientRect();hD=hv.bottom-hv.top;if(!hw&&hC.text.firstChild){hr=hC.text.firstChild.getBoundingClientRect().right-hv.left-1}}var hA=hC.line.height-hD;if(hA>0.005||hA<-0.005){hc(hC.line,hD);cC(hC.line);if(hC.rest){for(var hs=0;hs<hC.rest.length;hs++){cC(hC.rest[hs])}}}if(hr>hB.display.sizerWidth){var hx=Math.ceil(hr/ee(hB.display));if(hx>hB.display.maxLineLength){hB.display.maxLineLength=hx;hB.display.maxLine=hC.line;hB.display.maxLineChanged=true}}}}function cC(hs){if(hs.widgets){for(var ht=0;ht<hs.widgets.length;++ht){var hr=hs.widgets[ht],hu=hr.node.parentNode;if(hu){hr.height=hu.offsetHeight}}}}function cx(hu,hy,ht){var hv=ht&&ht.top!=null?Math.max(0,ht.top):hu.scroller.scrollTop;hv=Math.floor(hv-f1(hu));var hr=ht&&ht.bottom!=null?ht.bottom:hv+hu.wrapper.clientHeight;var hw=b5(hy,hv),hx=b5(hy,hr);if(ht&&ht.ensure){var hs=ht.ensure.from.line,hz=ht.ensure.to.line;if(hs<hw){hw=hs;hx=b5(hy,cb(f7(hy,hs))+hu.wrapper.clientHeight)}else{if(Math.min(hz,hy.lastLine())>=hx){hw=b5(hy,cb(f7(hy,hz))-hu.wrapper.clientHeight);hx=hz}}}return{from:hw,to:Math.max(hx,hw+1)}}function fr(hz){var hx=hz.display,hy=hx.view;if(!hx.alignWidgets&&(!hx.gutters.firstChild||!hz.options.fixedGutter)){return}var hv=eC(hx)-hx.scroller.scrollLeft+hz.doc.scrollLeft;var hr=hx.gutters.offsetWidth,hs=hv+"px";for(var hu=0;hu<hy.length;hu++){if(!hy[hu].hidden){if(hz.options.fixedGutter){if(hy[hu].gutter){hy[hu].gutter.style.left=hs}if(hy[hu].gutterBackground){hy[hu].gutterBackground.style.left=hs}}var hw=hy[hu].alignable;if(hw){for(var ht=0;ht<hw.length;ht++){hw[ht].style.left=hs}}}}if(hz.options.fixedGutter){hx.gutters.style.left=(hv+hr)+"px"}}function eL(hr){if(!hr.options.lineNumbers){return false}var hw=hr.doc,hs=fc(hr.options,hw.first+hw.size-1),hv=hr.display;if(hs.length!=hv.lineNumChars){var hx=hv.measure.appendChild(g7("div",[g7("div",hs)],"CodeMirror-linenumber CodeMirror-gutter-elt"));var ht=hx.firstChild.offsetWidth,hu=hx.offsetWidth-ht;hv.lineGutter.style.width="";hv.lineNumInnerWidth=Math.max(ht,hv.lineGutter.offsetWidth-hu)+1;hv.lineNumWidth=hv.lineNumInnerWidth+hu;hv.lineNumChars=hv.lineNumInnerWidth?hs.length:-1;hv.lineGutter.style.width=hv.lineNumWidth+"px";dD(hr);return true}return false}function eM(hs,hu){if(a8(hs,"scrollCursorIntoView")){return}var hw=hs.display,ht=hw.sizer.getBoundingClientRect(),hr=null;if(hu.top+ht.top<0){hr=true}else{if(hu.bottom+ht.top>(window.innerHeight||document.documentElement.clientHeight)){hr=false}}if(hr!=null&&!gl){var hv=g7("div","\u200b",null,("position: absolute;\n                         top: "+(hu.top-hw.viewOffset-f1(hs.display))+"px;\n                         height: "+(hu.bottom-hu.top+ds(hs)+hw.barHeight)+"px;\n                         left: "+(hu.left)+"px; width: "+(Math.max(2,hu.right-hu.left))+"px;"));hs.display.lineSpace.appendChild(hv);hv.scrollIntoView(hr);hs.display.lineSpace.removeChild(hv)}}function N(hC,hz,hv,hu){if(hu==null){hu=0}var hA;if(!hC.options.lineWrapping&&hz==hv){hz=hz.ch?ah(hz.line,hz.sticky=="before"?hz.ch-1:hz.ch,"after"):hz;hv=hz.sticky=="before"?ah(hz.line,hz.ch+1,"before"):hz}for(var hw=0;hw<5;hw++){var hx=false;var hB=ey(hC,hz);var hr=!hv||hv==hz?hB:ey(hC,hv);hA={left:Math.min(hB.left,hr.left),top:Math.min(hB.top,hr.top)-hu,right:Math.max(hB.left,hr.left),bottom:Math.max(hB.bottom,hr.bottom)+hu};var ht=S(hC,hA);var hy=hC.doc.scrollTop,hs=hC.doc.scrollLeft;if(ht.scrollTop!=null){I(hC,ht.scrollTop);if(Math.abs(hC.doc.scrollTop-hy)>1){hx=true}}if(ht.scrollLeft!=null){b2(hC,ht.scrollLeft);if(Math.abs(hC.doc.scrollLeft-hs)>1){hx=true}}if(!hx){break}}return hA}function O(hr,hs){var ht=S(hr,hs);if(ht.scrollTop!=null){I(hr,ht.scrollTop)}if(ht.scrollLeft!=null){b2(hr,ht.scrollLeft)}}function S(hA,hz){var hx=hA.display,hv=bf(hA.display);if(hz.top<0){hz.top=0}var ht=hA.curOp&&hA.curOp.scrollTop!=null?hA.curOp.scrollTop:hx.scroller.scrollTop;var hC=du(hA),hE={};if(hz.bottom-hz.top>hC){hz.bottom=hz.top+hC}var hs=hA.doc.height+b6(hx);var hr=hz.top<hv,hw=hz.bottom>hs-hv;if(hz.top<ht){hE.scrollTop=hr?0:hz.top}else{if(hz.bottom>ht+hC){var hy=Math.min(hz.top,(hw?hs:hz.bottom)-hC);if(hy!=ht){hE.scrollTop=hy}}}var hD=hA.curOp&&hA.curOp.scrollLeft!=null?hA.curOp.scrollLeft:hx.scroller.scrollLeft;var hB=dY(hA)-(hA.options.fixedGutter?hx.gutters.offsetWidth:0);var hu=hz.right-hz.left>hB;if(hu){hz.right=hz.left+hB}if(hz.left<10){hE.scrollLeft=0}else{if(hz.left<hD){hE.scrollLeft=Math.max(0,hz.left-(hu?0:10))}else{if(hz.right>hB+hD-3){hE.scrollLeft=hz.right+(hu?0:10)-hB}}}return hE}function df(hr,hs){if(hs==null){return}gw(hr);hr.curOp.scrollTop=(hr.curOp.scrollTop==null?hr.doc.scrollTop:hr.curOp.scrollTop)+hs}function gz(hr){gw(hr);var hs=hr.getCursor();hr.curOp.scrollToPos={from:hs,to:hs,margin:hr.options.cursorScrollMargin}}function fB(hs,hr,ht){if(hr!=null||ht!=null){gw(hs)}if(hr!=null){hs.curOp.scrollLeft=hr}if(ht!=null){hs.curOp.scrollTop=ht}}function cF(hr,hs){gw(hr);hr.curOp.scrollToPos=hs}function gw(hr){var hs=hr.curOp.scrollToPos;if(hs){hr.curOp.scrollToPos=null;var hu=ei(hr,hs.from),ht=ei(hr,hs.to);cf(hr,hu,ht,hs.margin)}}function cf(hr,hv,hu,ht){var hs=S(hr,{left:Math.min(hv.left,hu.left),top:Math.min(hv.top,hu.top)-ht,right:Math.max(hv.right,hu.right),bottom:Math.max(hv.bottom,hu.bottom)+ht});fB(hr,hs.scrollLeft,hs.scrollTop)}function I(hr,hs){if(Math.abs(hr.doc.scrollTop-hs)<2){return}if(!cV){ex(hr,{top:hs})}Z(hr,hs,true);if(cV){ex(hr)}eV(hr,100)}function Z(hr,ht,hs){ht=Math.min(hr.display.scroller.scrollHeight-hr.display.scroller.clientHeight,ht);if(hr.display.scroller.scrollTop==ht&&!hs){return}hr.doc.scrollTop=ht;hr.display.scrollbars.setScrollTop(ht);if(hr.display.scroller.scrollTop!=ht){hr.display.scroller.scrollTop=ht}}function b2(hr,hu,ht,hs){hu=Math.min(hu,hr.display.scroller.scrollWidth-hr.display.scroller.clientWidth);if((ht?hu==hr.doc.scrollLeft:Math.abs(hr.doc.scrollLeft-hu)<2)&&!hs){return}hr.doc.scrollLeft=hu;fr(hr);if(hr.display.scroller.scrollLeft!=hu){hr.display.scroller.scrollLeft=hu}hr.display.scrollbars.setScrollLeft(hu)}function ec(hr){var hu=hr.display,ht=hu.gutters.offsetWidth;var hs=Math.round(hr.doc.height+b6(hr.display));return{clientHeight:hu.scroller.clientHeight,viewHeight:hu.wrapper.clientHeight,scrollWidth:hu.scroller.scrollWidth,clientWidth:hu.scroller.clientWidth,viewWidth:hu.wrapper.clientWidth,barLeft:hr.options.fixedGutter?ht:0,docHeight:hs,scrollHeight:hs+ds(hr)+hu.barHeight,nativeBarWidth:hu.nativeBarWidth,gutterWidth:ht}}var dX=function(ht,hs,hr){this.cm=hr;var hu=this.vert=g7("div",[g7("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar");var hv=this.horiz=g7("div",[g7("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");hu.tabIndex=hv.tabIndex=-1;ht(hu);ht(hv);cn(hu,"scroll",function(){if(hu.clientHeight){hs(hu.scrollTop,"vertical")}});cn(hv,"scroll",function(){if(hv.clientWidth){hs(hv.scrollLeft,"horizontal")}});this.checkedZeroWidth=false;if(em&&o<8){this.horiz.style.minHeight=this.vert.style.minWidth="18px"}};dX.prototype.update=function(hu){var hv=hu.scrollWidth>hu.clientWidth+1;var ht=hu.scrollHeight>hu.clientHeight+1;var hw=hu.nativeBarWidth;if(ht){this.vert.style.display="block";this.vert.style.bottom=hv?hw+"px":"0";var hs=hu.viewHeight-(hv?hw:0);this.vert.firstChild.style.height=Math.max(0,hu.scrollHeight-hu.clientHeight+hs)+"px"}else{this.vert.style.display="";this.vert.firstChild.style.height="0"}if(hv){this.horiz.style.display="block";this.horiz.style.right=ht?hw+"px":"0";this.horiz.style.left=hu.barLeft+"px";var hr=hu.viewWidth-hu.barLeft-(ht?hw:0);this.horiz.firstChild.style.width=Math.max(0,hu.scrollWidth-hu.clientWidth+hr)+"px"}else{this.horiz.style.display="";this.horiz.firstChild.style.width="0"}if(!this.checkedZeroWidth&&hu.clientHeight>0){if(hw==0){this.zeroWidthHack()}this.checkedZeroWidth=true}return{right:ht?hw:0,bottom:hv?hw:0}};dX.prototype.setScrollLeft=function(hr){if(this.horiz.scrollLeft!=hr){this.horiz.scrollLeft=hr}if(this.disableHoriz){this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")}};dX.prototype.setScrollTop=function(hr){if(this.vert.scrollTop!=hr){this.vert.scrollTop=hr}if(this.disableVert){this.enableZeroWidthBar(this.vert,this.disableVert,"vert")}};dX.prototype.zeroWidthHack=function(){var hr=cy&&!dH?"12px":"18px";this.horiz.style.height=this.vert.style.width=hr;this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none";this.disableHoriz=new hq;this.disableVert=new hq};dX.prototype.enableZeroWidthBar=function(ht,hr,hs){ht.style.pointerEvents="auto";function hu(){var hw=ht.getBoundingClientRect();var hv=hs=="vert"?document.elementFromPoint(hw.right-1,(hw.top+hw.bottom)/2):document.elementFromPoint((hw.right+hw.left)/2,hw.bottom-1);if(hv!=ht){ht.style.pointerEvents="none"}else{hr.set(1000,hu)}}hr.set(1000,hu)};dX.prototype.clear=function(){var hr=this.horiz.parentNode;hr.removeChild(this.horiz);hr.removeChild(this.vert)};var fW=function(){};fW.prototype.update=function(){return{bottom:0,right:0}};fW.prototype.setScrollLeft=function(){};fW.prototype.setScrollTop=function(){};fW.prototype.clear=function(){};function fQ(ht,hv){if(!hv){hv=ec(ht)}var hs=ht.display.barWidth,hr=ht.display.barHeight;bb(ht,hv);for(var hu=0;hu<4&&hs!=ht.display.barWidth||hr!=ht.display.barHeight;hu++){if(hs!=ht.display.barWidth&&ht.options.lineWrapping){bq(ht)}bb(ht,ec(ht));hs=ht.display.barWidth;hr=ht.display.barHeight}}function bb(hr,hs){var hu=hr.display;var ht=hu.scrollbars.update(hs);hu.sizer.style.paddingRight=(hu.barWidth=ht.right)+"px";hu.sizer.style.paddingBottom=(hu.barHeight=ht.bottom)+"px";hu.heightForcer.style.borderBottom=ht.bottom+"px solid transparent";if(ht.right&&ht.bottom){hu.scrollbarFiller.style.display="block";hu.scrollbarFiller.style.height=ht.bottom+"px";hu.scrollbarFiller.style.width=ht.right+"px"}else{hu.scrollbarFiller.style.display=""}if(ht.bottom&&hr.options.coverGutterNextToScrollbar&&hr.options.fixedGutter){hu.gutterFiller.style.display="block";hu.gutterFiller.style.height=ht.bottom+"px";hu.gutterFiller.style.width=hs.gutterWidth+"px"}else{hu.gutterFiller.style.display=""}}var bE={"native":dX,"null":fW};function aS(hr){if(hr.display.scrollbars){hr.display.scrollbars.clear();if(hr.display.scrollbars.addClass){j(hr.display.wrapper,hr.display.scrollbars.addClass)}}hr.display.scrollbars=new bE[hr.options.scrollbarStyle](function(hs){hr.display.wrapper.insertBefore(hs,hr.display.scrollbarFiller);cn(hs,"mousedown",function(){if(hr.state.focused){setTimeout(function(){return hr.display.input.focus()},0)}});hs.setAttribute("cm-not-content","true")},function(ht,hs){if(hs=="horizontal"){b2(hr,ht)}else{I(hr,ht)}},hr);if(hr.display.scrollbars.addClass){gu(hr.display.wrapper,hr.display.scrollbars.addClass)}}var eQ=0;function dh(hr){hr.curOp={cm:hr,viewChanged:false,startHeight:hr.doc.height,forceUpdate:false,updateInput:0,typing:false,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:false,updateMaxLine:false,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:false,id:++eQ};fj(hr.curOp)}function aB(hr){var hs=hr.curOp;if(hs){co(hs,function(hu){for(var ht=0;ht<hu.ops.length;ht++){hu.ops[ht].cm.curOp=null}dk(hu)})}}function dk(hw){var hs=hw.ops;for(var hr=0;hr<hs.length;hr++){cw(hs[hr])}for(var hx=0;hx<hs.length;hx++){aE(hs[hx])}for(var hv=0;hv<hs.length;hv++){cs(hs[hv])}for(var hu=0;hu<hs.length;hu++){aD(hs[hu])}for(var ht=0;ht<hs.length;ht++){fS(hs[ht])}}function cw(ht){var hr=ht.cm,hs=hr.display;U(hr);if(ht.updateMaxLine){f(hr)}ht.mustUpdate=ht.viewChanged||ht.forceUpdate||ht.scrollTop!=null||ht.scrollToPos&&(ht.scrollToPos.from.line<hs.viewFrom||ht.scrollToPos.to.line>=hs.viewTo)||hs.maxLineChanged&&hr.options.lineWrapping;ht.update=ht.mustUpdate&&new aZ(hr,ht.mustUpdate&&{top:ht.scrollTop,ensure:ht.scrollToPos},ht.forceUpdate)}function aE(hr){hr.updatedDisplay=hr.mustUpdate&&L(hr.cm,hr.update)}function cs(ht){var hr=ht.cm,hs=hr.display;if(ht.updatedDisplay){bq(hr)}ht.barMeasure=ec(hr);if(hs.maxLineChanged&&!hr.options.lineWrapping){ht.adjustWidthTo=eY(hr,hs.maxLine,hs.maxLine.text.length).left+3;hr.display.sizerWidth=ht.adjustWidthTo;ht.barMeasure.scrollWidth=Math.max(hs.scroller.clientWidth,hs.sizer.offsetLeft+ht.adjustWidthTo+ds(hr)+hr.display.barWidth);ht.maxScrollLeft=Math.max(0,hs.sizer.offsetLeft+ht.adjustWidthTo-dY(hr))}if(ht.updatedDisplay||ht.selectionChanged){ht.preparedSelection=hs.input.prepareSelection()}}function aD(ht){var hr=ht.cm;if(ht.adjustWidthTo!=null){hr.display.sizer.style.minWidth=ht.adjustWidthTo+"px";if(ht.maxScrollLeft<hr.doc.scrollLeft){b2(hr,Math.min(hr.display.scroller.scrollLeft,ht.maxScrollLeft),true)}hr.display.maxLineChanged=false}var hs=ht.focus&&ht.focus==eq();if(ht.preparedSelection){hr.display.input.showSelection(ht.preparedSelection,hs)}if(ht.updatedDisplay||ht.startHeight!=hr.doc.height){fQ(hr,ht.barMeasure)}if(ht.updatedDisplay){eb(hr,ht.barMeasure)}if(ht.selectionChanged){u(hr)}if(hr.state.focused&&ht.updateInput){hr.display.input.reset(ht.typing)}if(hs){A(ht.cm)}}function fS(hu){var hz=hu.cm,hw=hz.display,hy=hz.doc;if(hu.updatedDisplay){cO(hz,hu.update)}if(hw.wheelStartX!=null&&(hu.scrollTop!=null||hu.scrollLeft!=null||hu.scrollToPos)){hw.wheelStartX=hw.wheelStartY=null}if(hu.scrollTop!=null){Z(hz,hu.scrollTop,hu.forceScroll)}if(hu.scrollLeft!=null){b2(hz,hu.scrollLeft,true,true)}if(hu.scrollToPos){var hx=N(hz,gF(hy,hu.scrollToPos.from),gF(hy,hu.scrollToPos.to),hu.scrollToPos.margin);eM(hz,hx)}var hv=hu.maybeHiddenMarkers,hr=hu.maybeUnhiddenMarkers;if(hv){for(var ht=0;ht<hv.length;++ht){if(!hv[ht].lines.length){aT(hv[ht],"hide")}}}if(hr){for(var hs=0;hs<hr.length;++hs){if(hr[hs].lines.length){aT(hr[hs],"unhide")}}}if(hw.wrapper.offsetHeight){hy.scrollTop=hz.display.scroller.scrollTop}if(hu.changeObjs){aT(hz,"changes",hz,hu.changeObjs)}if(hu.update){hu.update.finish()}}function dl(hr,hs,hu){if(hr.curOp){return hs()}dh(hr);try{return hs()}catch(ht){if(typeof(hu)=="function"){errhandler()}}finally{aB(hr)}}function dA(hr,hs){return function(){if(hr.curOp){return hs.apply(hr,arguments)}dh(hr);try{return hs.apply(hr,arguments)}finally{aB(hr)}}}function dK(hr){return function(){if(this.curOp){return hr.apply(this,arguments)}dh(this);try{return hr.apply(this,arguments)}finally{aB(this)}}}function db(hr){return function(){var hs=this.cm;if(!hs||hs.curOp){return hr.apply(this,arguments)}dh(hs);try{return hr.apply(this,arguments)}finally{aB(hs)}}}function av(hz,hx,hy,hA){if(hx==null){hx=hz.doc.first}if(hy==null){hy=hz.doc.first+hz.doc.size}if(!hA){hA=0}var hu=hz.display;if(hA&&hy<hu.viewTo&&(hu.updateLineNumbers==null||hu.updateLineNumbers>hx)){hu.updateLineNumbers=hx}hz.curOp.viewChanged=true;if(hx>=hu.viewTo){if(bo&&bd(hz.doc,hx)<hu.viewTo){fh(hz)}}else{if(hy<=hu.viewFrom){if(bo&&eJ(hz.doc,hy+hA)>hu.viewFrom){fh(hz)}else{hu.viewFrom+=hA;hu.viewTo+=hA}}else{if(hx<=hu.viewFrom&&hy>=hu.viewTo){fh(hz)}else{if(hx<=hu.viewFrom){var hw=dR(hz,hy,hy+hA,1);if(hw){hu.view=hu.view.slice(hw.index);hu.viewFrom=hw.lineN;hu.viewTo+=hA}else{fh(hz)}}else{if(hy>=hu.viewTo){var hs=dR(hz,hx,hx,-1);if(hs){hu.view=hu.view.slice(0,hs.index);hu.viewTo=hs.lineN}else{fh(hz)}}else{var hv=dR(hz,hx,hx,-1);var ht=dR(hz,hy,hy+hA,1);if(hv&&ht){hu.view=hu.view.slice(0,hv.index).concat(fM(hz,hv.lineN,ht.lineN)).concat(hu.view.slice(ht.index));hu.viewTo+=hA}else{fh(hz)}}}}}}var hr=hu.externalMeasured;if(hr){if(hy<hr.lineN){hr.lineN+=hA}else{if(hx<hr.lineN+hr.size){hu.externalMeasured=null}}}}function ac(hs,ht,hw){hs.curOp.viewChanged=true;var hx=hs.display,hv=hs.display.externalMeasured;if(hv&&ht>=hv.lineN&&ht<hv.lineN+hv.size){hx.externalMeasured=null}if(ht<hx.viewFrom||ht>=hx.viewTo){return}var hu=hx.view[d4(hs,ht)];if(hu.node==null){return}var hr=hu.changes||(hu.changes=[]);if(dV(hr,hw)==-1){hr.push(hw)}}function fh(hr){hr.display.viewFrom=hr.display.viewTo=hr.doc.first;hr.display.view=[];hr.display.viewOffset=0}function dR(hz,ht,hv,hs){var hw=d4(hz,ht),hy,hx=hz.display.view;if(!bo||hv==hz.doc.first+hz.doc.size){return{index:hw,lineN:hv}}var hr=hz.display.viewFrom;for(var hu=0;hu<hw;hu++){hr+=hx[hu].size}if(hr!=ht){if(hs>0){if(hw==hx.length-1){return null}hy=(hr+hx[hw].size)-ht;hw++}else{hy=hr-ht}ht+=hy;hv+=hy}while(bd(hz.doc,hv)!=hv){if(hw==(hs<0?0:hx.length-1)){return null}hv+=hs*hx[hw-(hs<0?1:0)].size;hw+=hs}return{index:hw,lineN:hv}}function dr(hr,hv,hu){var ht=hr.display,hs=ht.view;if(hs.length==0||hv>=ht.viewTo||hu<=ht.viewFrom){ht.view=fM(hr,hv,hu);ht.viewFrom=hv}else{if(ht.viewFrom>hv){ht.view=fM(hr,hv,ht.viewFrom).concat(ht.view)}else{if(ht.viewFrom<hv){ht.view=ht.view.slice(d4(hr,hv))}}ht.viewFrom=hv;if(ht.viewTo<hu){ht.view=ht.view.concat(fM(hr,ht.viewTo,hu))}else{if(ht.viewTo>hu){ht.view=ht.view.slice(0,d4(hr,hu))}}}ht.viewTo=hu}function dO(hr){var hs=hr.display.view,hv=0;for(var hu=0;hu<hs.length;hu++){var ht=hs[hu];if(!ht.hidden&&(!ht.node||ht.changes)){++hv}}return hv}function eV(hr,hs){if(hr.doc.highlightFrontier<=hr.display.viewTo){hr.state.highlight.set(hs,c2(dq,hr))}}function dq(hr){var hw=hr.doc;if(hw.highlightFrontier>=hr.display.viewTo){aT(hr,"rendered",hr,true);return}var hu=true;var ht=+new Date+hr.options.workTime;var hv=fO(hr,hw.highlightFrontier);var hs=[];hw.iter(hv.line,Math.min(hw.first+hw.size,hr.display.viewTo+500),function(hy){if(hv.line>=hr.display.viewFrom){var hB=hy.styles;var hx=hy.text.length>hr.options.maxHighlightLength?cu(hw.mode,hv.state):null;var hD=gr(hr,hy,hv,true);if(hx){hv.state=hx}hy.styles=hD.styles;var hA=hy.styleClasses,hC=hD.classes;if(hC){hy.styleClasses=hC}else{if(hA){hy.styleClasses=null}}var hE=!hB||hB.length!=hy.styles.length||hA!=hC&&(!hA||!hC||hA.bgClass!=hC.bgClass||hA.textClass!=hC.textClass);for(var hz=0;!hE&&hz<hB.length;++hz){hE=hB[hz]!=hy.styles[hz]}if(hE){hs.push(hv.line)}hy.stateAfter=hv.save();hv.nextLine()}else{if(hy.text.length<=hr.options.maxHighlightLength){ea(hr,hy.text,hv)}hy.stateAfter=hv.line%5==0?hv.save():null;hv.nextLine()}if(+new Date>ht){eV(hr,hr.options.workDelay);if(hr.doc.mode.startState&&hr.doc.highlightFrontier<hr.display.viewTo){aT(hr,"rendered",hr,hu=false);eV(hr,hr.options.workDelay)}return true}});hw.highlightFrontier=hv.line;hw.modeFrontier=Math.max(hw.modeFrontier,hv.line);if(hs.length){dl(hr,function(){for(var hx=0;hx<hs.length;hx++){ac(hr,hs[hx],"text")}},function(){aT(hr,"rendered",hr,true)})}if(hu){aT(hr,"rendered",hr,true)}}var aZ=function(hs,hr,ht){var hu=hs.display;this.viewport=hr;this.visible=cx(hu,hs.doc,hr);this.editorIsHidden=!hu.wrapper.offsetWidth;this.wrapperHeight=hu.wrapper.clientHeight;this.wrapperWidth=hu.wrapper.clientWidth;this.oldDisplayWidth=dY(hs);this.force=ht;this.dims=f5(hs);this.events=[]};aZ.prototype.signal=function(hs,hr){if(gc(hs,hr)){this.events.push(arguments)}};aZ.prototype.finish=function(){var hs=this;for(var hr=0;hr<this.events.length;hr++){aT.apply(null,hs.events[hr])}};function U(hr){var hs=hr.display;if(!hs.scrollbarsClipped&&hs.scroller.offsetWidth){hs.nativeBarWidth=hs.scroller.offsetWidth-hs.scroller.clientWidth;hs.heightForcer.style.height=ds(hr)+"px";hs.sizer.style.marginBottom=-hs.nativeBarWidth+"px";hs.sizer.style.borderRightWidth=ds(hr)+"px";hs.scrollbarsClipped=true}}function bG(hs){if(hs.hasFocus()){return null}var hu=eq();if(!hu||!hh(hs.display.lineDiv,hu)){return null}var hr={activeElt:hu};if(window.getSelection){var ht=window.getSelection();if(ht.anchorNode&&ht.extend&&hh(hs.display.lineDiv,ht.anchorNode)){hr.anchorNode=ht.anchorNode;hr.anchorOffset=ht.anchorOffset;hr.focusNode=ht.focusNode;hr.focusOffset=ht.focusOffset}}return hr}function l(hr){if(!hr||!hr.activeElt||hr.activeElt==eq()){return}hr.activeElt.focus();if(hr.anchorNode&&hh(document.body,hr.anchorNode)&&hh(document.body,hr.focusNode)){var hs=window.getSelection(),ht=document.createRange();ht.setEnd(hr.anchorNode,hr.anchorOffset);ht.collapse(false);hs.removeAllRanges();hs.addRange(ht);hs.extend(hr.focusNode,hr.focusOffset)}}function L(hA,hu){var hv=hA.display,hz=hA.doc;if(hu.editorIsHidden){fh(hA);return false}if(!hu.force&&hu.visible.from>=hv.viewFrom&&hu.visible.to<=hv.viewTo&&(hv.updateLineNumbers==null||hv.updateLineNumbers>=hv.viewTo)&&hv.renderedView==hv.view&&dO(hA)==0){return false}if(eL(hA)){fh(hA);hu.dims=f5(hA)}var ht=hz.first+hz.size;var hx=Math.max(hu.visible.from-hA.options.viewportMargin,hz.first);var hy=Math.min(ht,hu.visible.to+hA.options.viewportMargin);if(hv.viewFrom<hx&&hx-hv.viewFrom<20){hx=Math.max(hz.first,hv.viewFrom)}if(hv.viewTo>hy&&hv.viewTo-hy<20){hy=Math.min(ht,hv.viewTo)}if(bo){hx=bd(hA.doc,hx);hy=eJ(hA.doc,hy)}var hs=hx!=hv.viewFrom||hy!=hv.viewTo||hv.lastWrapHeight!=hu.wrapperHeight||hv.lastWrapWidth!=hu.wrapperWidth;dr(hA,hx,hy);hv.viewOffset=cb(f7(hA.doc,hv.viewFrom));hA.display.mover.style.top=hv.viewOffset+"px";var hr=dO(hA);if(!hs&&hr==0&&!hu.force&&hv.renderedView==hv.view&&(hv.updateLineNumbers==null||hv.updateLineNumbers>=hv.viewTo)){return false}var hw=bG(hA);if(hr>4){hv.lineDiv.style.display="none"}cR(hA,hv.updateLineNumbers,hu.dims);if(hr>4){hv.lineDiv.style.display=""}hv.renderedView=hv.view;l(hw);eH(hv.cursorDiv);eH(hv.selectionDiv);hv.gutters.style.height=hv.sizer.style.minHeight=0;if(hs){hv.lastWrapHeight=hu.wrapperHeight;hv.lastWrapWidth=hu.wrapperWidth;eV(hA,400)}hv.updateLineNumbers=null;return true}function cO(hs,hv){var hr=hv.viewport;for(var hu=true;;hu=false){if(!hu||!hs.options.lineWrapping||hv.oldDisplayWidth==dY(hs)){if(hr&&hr.top!=null){hr={top:Math.min(hs.doc.height+b6(hs.display)-du(hs),hr.top)}}hv.visible=cx(hs.display,hs.doc,hr);if(hv.visible.from>=hs.display.viewFrom&&hv.visible.to<=hs.display.viewTo){break}}if(!L(hs,hv)){break}bq(hs);var ht=ec(hs);b0(hs);fQ(hs,ht);eb(hs,ht);hv.force=false}hv.signal(hs,"update",hs);if(hs.display.viewFrom!=hs.display.reportedViewFrom||hs.display.viewTo!=hs.display.reportedViewTo){hv.signal(hs,"viewportChange",hs,hs.display.viewFrom,hs.display.viewTo);hs.display.reportedViewFrom=hs.display.viewFrom;hs.display.reportedViewTo=hs.display.viewTo}}function ex(hs,hr){var hu=new aZ(hs,hr);if(L(hs,hu)){bq(hs);cO(hs,hu);var ht=ec(hs);b0(hs);fQ(hs,ht);eb(hs,ht);hu.finish()}}function cR(hC,ht,hB){var hy=hC.display,hE=hC.options.lineNumbers;var hr=hy.lineDiv,hD=hr.firstChild;function hx(hG){var hF=hG.nextSibling;if(dz&&cy&&hC.display.currentWheelTarget==hG){hG.style.display="none"}else{hG.parentNode.removeChild(hG)}return hF}var hz=hy.view,hw=hy.viewFrom;for(var hu=0;hu<hz.length;hu++){var hv=hz[hu];if(hv.hidden){}else{if(!hv.node||hv.node.parentNode!=hr){var hs=aU(hC,hv,hw,hB);hr.insertBefore(hs,hD)}else{while(hD!=hv.node){hD=hx(hD)}var hA=hE&&ht!=null&&ht<=hw&&hv.lineNumber;if(hv.changes){if(dV(hv.changes,"gutter")>-1){hA=false}ao(hC,hv,hw,hB)}if(hA){eH(hv.lineNumber);hv.lineNumber.appendChild(document.createTextNode(fc(hC.options,hw)))}hD=hv.node.nextSibling}}hw+=hv.size}while(hD){hD=hx(hD)}}function dD(hr){var hs=hr.display.gutters.offsetWidth;hr.display.sizer.style.marginLeft=hs+"px"}function eb(hr,hs){hr.display.sizer.style.minHeight=hs.docHeight+"px";hr.display.heightForcer.style.top=hs.docHeight+"px";hr.display.gutters.style.height=(hs.docHeight+hr.display.barHeight+ds(hr))+"px"}function eT(hr){var hs=hr.display.gutters,hw=hr.options.gutters;eH(hs);var ht=0;for(;ht<hw.length;++ht){var hu=hw[ht];var hv=hs.appendChild(g7("div",null,"CodeMirror-gutter "+hu));if(hu=="CodeMirror-linenumbers"){hr.display.lineGutter=hv;hv.style.width=(hr.display.lineNumWidth||1)+"px"}}hs.style.display=ht?"":"none";dD(hr)}function cH(hr){var hs=dV(hr.gutters,"CodeMirror-linenumbers");if(hs==-1&&hr.lineNumbers){hr.gutters=hr.gutters.concat(["CodeMirror-linenumbers"])}else{if(hs>-1&&!hr.lineNumbers){hr.gutters=hr.gutters.slice(0);hr.gutters.splice(hs,1)}}}var ge=0,cK=null;if(em){cK=-0.53}else{if(cV){cK=15}else{if(dP){cK=-0.7}else{if(aR){cK=-1/3}}}}function dp(ht){var hs=ht.wheelDeltaX,hr=ht.wheelDeltaY;if(hs==null&&ht.detail&&ht.axis==ht.HORIZONTAL_AXIS){hs=ht.detail}if(hr==null&&ht.detail&&ht.axis==ht.VERTICAL_AXIS){hr=ht.detail}else{if(hr==null){hr=ht.wheelDelta}}return{x:hs,y:hr}}function aO(hr){var hs=dp(hr);hs.x*=cK;hs.y*=cK;return hs}function c(hB,hv){var hD=dp(hv),hF=hD.x,hE=hD.y;var hx=hB.display,hA=hx.scroller;var hu=hA.scrollWidth>hA.clientWidth;var ht=hA.scrollHeight>hA.clientHeight;if(!(hF&&hu||hE&&ht)){return}if(hE&&cy&&dz){outer:for(var hC=hv.target,hz=hx.view;hC!=hA;hC=hC.parentNode){for(var hs=0;hs<hz.length;hs++){if(hz[hs].node==hC){hB.display.currentWheelTarget=hC;break outer}}}}if(hF&&!cV&&!eI&&cK!=null){if(hE&&ht){I(hB,Math.max(0,hA.scrollTop+hE*cK))}b2(hB,Math.max(0,hA.scrollLeft+hF*cK));if(!hE||(hE&&ht)){dd(hv)}hx.wheelStartX=null;return}if(hE&&cK!=null){var hr=hE*cK;var hy=hB.doc.scrollTop,hw=hy+hx.wrapper.clientHeight;if(hr<0){hy=Math.max(0,hy+hr-50)}else{hw=Math.min(hB.doc.height,hw+hr+50)}ex(hB,{top:hy,bottom:hw})}if(ge<20){if(hx.wheelStartX==null){hx.wheelStartX=hA.scrollLeft;hx.wheelStartY=hA.scrollTop;hx.wheelDX=hF;hx.wheelDY=hE;setTimeout(function(){if(hx.wheelStartX==null){return}var hG=hA.scrollLeft-hx.wheelStartX;var hI=hA.scrollTop-hx.wheelStartY;var hH=(hI&&hx.wheelDY&&hI/hx.wheelDY)||(hG&&hx.wheelDX&&hG/hx.wheelDX);hx.wheelStartX=hx.wheelStartY=null;if(!hH){return}cK=(cK*ge+hH)/(ge+1);++ge},200)}else{hx.wheelDX+=hF;hx.wheelDY+=hE}}}var g6=function(hr,hs){this.ranges=hr;this.primIndex=hs};g6.prototype.primary=function(){return this.ranges[this.primIndex]};g6.prototype.equals=function(hr){var hv=this;if(hr==this){return true}if(hr.primIndex!=this.primIndex||hr.ranges.length!=this.ranges.length){return false}for(var ht=0;ht<this.ranges.length;ht++){var hs=hv.ranges[ht],hu=hr.ranges[ht];if(!ai(hs.anchor,hu.anchor)||!ai(hs.head,hu.head)){return false}}return true};g6.prototype.deepCopy=function(){var ht=this;var hr=[];for(var hs=0;hs<this.ranges.length;hs++){hr[hs]=new eB(cM(ht.ranges[hs].anchor),cM(ht.ranges[hs].head))}return new g6(hr,this.primIndex)};g6.prototype.somethingSelected=function(){var hs=this;for(var hr=0;hr<this.ranges.length;hr++){if(!hs.ranges[hr].empty()){return true}}return false};g6.prototype.contains=function(hv,hr){var hu=this;if(!hr){hr=hv}for(var ht=0;ht<this.ranges.length;ht++){var hs=hu.ranges[ht];if(cJ(hr,hs.from())>=0&&cJ(hv,hs.to())<=0){return ht}}return -1};var eB=function(hr,hs){this.anchor=hr;this.head=hs};eB.prototype.from=function(){return aG(this.anchor,this.head)};eB.prototype.to=function(){return bV(this.anchor,this.head)};eB.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch};function c3(hB,hr,hA){var hw=hB&&hB.options.selectionsMayTouch;var ht=hr[hA];hr.sort(function(hE,hD){return cJ(hE.from(),hD.from())});hA=dV(hr,ht);for(var hv=1;hv<hr.length;hv++){var hC=hr[hv],hs=hr[hv-1];var hz=cJ(hs.to(),hC.from());if(hw&&!hC.empty()?hz>0:hz>=0){var hy=aG(hs.from(),hC.from()),hx=bV(hs.to(),hC.to());var hu=hs.empty()?hC.from()==hC.head:hs.from()==hs.head;if(hv<=hA){--hA}hr.splice(--hv,2,new eB(hu?hx:hy,hu?hy:hx))}}return new g6(hr,hA)}function fH(hr,hs){return new g6([new eB(hr,hs||hr)],0)}function dw(hr){if(!hr.text){return hr.to}return ah(hr.from.line+hr.text.length-1,gA(hr.text).length+(hr.text.length==1?hr.from.ch:0))}function cq(hu,ht){if(cJ(hu,ht.from)<0){return hu}if(cJ(hu,ht.to)<=0){return dw(ht)}var hr=hu.line+ht.text.length-(ht.to.line-ht.from.line)-1,hs=hu.ch;if(hu.line==ht.to.line){hs+=dw(ht).ch-ht.to.ch}return ah(hr,hs)}function gb(hu,hv){var hs=[];for(var ht=0;ht<hu.sel.ranges.length;ht++){var hr=hu.sel.ranges[ht];hs.push(new eB(cq(hr.anchor,hv),cq(hr.head,hv)))}return c3(hu.cm,hs,hu.sel.primIndex)}function bR(ht,hs,hr){if(ht.line==hs.line){return ah(hr.line,ht.ch-hs.ch+hr.ch)}else{return ah(hr.line+(ht.line-hs.line),ht.ch)}}function at(hB,hy,hs){var ht=[];var hr=ah(hB.first,0),hC=hr;for(var hv=0;hv<hy.length;hv++){var hx=hy[hv];var hA=bR(hx.from,hr,hC);var hz=bR(dw(hx),hr,hC);hr=hx.to;hC=hz;if(hs=="around"){var hw=hB.sel.ranges[hv],hu=cJ(hw.head,hw.anchor)<0;ht[hv]=new eB(hu?hz:hA,hu?hA:hz)}else{ht[hv]=new eB(hA,hA)}}return new g6(ht,hB.sel.primIndex)}function bO(hr){hr.doc.mode=gt(hr.options,hr.doc.modeOption);e4(hr)}function e4(hr){hr.doc.iter(function(hs){if(hs.stateAfter){hs.stateAfter=null}if(hs.styles){hs.styles=null}});hr.doc.modeFrontier=hr.doc.highlightFrontier=hr.doc.first;eV(hr,100);hr.state.modeGen++;if(hr.curOp){av(hr)}}function ev(hr,hs){return hs.from.ch==0&&hs.to.ch==0&&gA(hs.text)==""&&(!hr.cm||hr.cm.options.wholeLineUpdateBefore)}function gq(hI,hB,hv,hA){function hu(hJ){return hv?hv[hJ]:null}function hz(hJ,hL,hK){e6(hJ,hL,hK,hA);ar(hJ,"change",hJ,hB)}function hF(hM,hK){var hJ=[];for(var hL=hM;hL<hK;++hL){hJ.push(new hb(hD[hL],hu(hL),hA))}return hJ}var hG=hB.from,hs=hB.to,hD=hB.text;var hC=f7(hI,hG.line),hr=f7(hI,hs.line);var ht=gA(hD),hH=hu(hD.length-1),hE=hs.line-hG.line;if(hB.full){hI.insert(0,hF(0,hD.length));hI.remove(hD.length,hI.size-hD.length)}else{if(ev(hI,hB)){var hy=hF(0,hD.length-1);hz(hr,hr.text,hH);if(hE){hI.remove(hG.line,hE)}if(hy.length){hI.insert(hG.line,hy)}}else{if(hC==hr){if(hD.length==1){hz(hC,hC.text.slice(0,hG.ch)+ht+hC.text.slice(hs.ch),hH)}else{var hx=hF(1,hD.length-1);hx.push(new hb(ht+hC.text.slice(hs.ch),hH,hA));hz(hC,hC.text.slice(0,hG.ch)+hD[0],hu(0));hI.insert(hG.line+1,hx)}}else{if(hD.length==1){hz(hC,hC.text.slice(0,hG.ch)+hD[0]+hr.text.slice(hs.ch),hu(0));hI.remove(hG.line+1,hE)}else{hz(hC,hC.text.slice(0,hG.ch)+hD[0],hu(0));hz(hr,ht+hr.text.slice(hs.ch),hH);var hw=hF(1,hD.length-1);if(hE>1){hI.remove(hG.line+1,hE-1)}hI.insert(hG.line+1,hw)}}}}ar(hI,"change",hI,hB)}function eN(hu,ht,hs){function hr(hA,hy,hw){if(hA.linked){for(var hx=0;hx<hA.linked.length;++hx){var hv=hA.linked[hx];if(hv.doc==hy){continue}var hz=hw&&hv.sharedHist;if(hs&&!hz){continue}ht(hv.doc,hz);hr(hv.doc,hA,hz)}}}hr(hu,null,true)}function eS(hr,hs){if(hs.cm){throw new Error("This document is already in use.")}hr.doc=hs;hs.cm=hr;ak(hr);bO(hr);K(hr);if(!hr.options.lineWrapping){f(hr)}hr.options.mode=hs.modeOption;av(hr)}function K(hr){(hr.doc.direction=="rtl"?gu:j)(hr.display.lineDiv,"CodeMirror-rtl")}function eE(hr){dl(hr,function(){K(hr);av(hr)})}function gT(hr){this.done=[];this.undone=[];this.undoDepth=Infinity;this.lastModTime=this.lastSelTime=0;this.lastOp=this.lastSelOp=null;this.lastOrigin=this.lastSelOrigin=null;this.generation=this.maxGeneration=hr||1}function d8(hr,ht){var hs={from:cM(ht.from),to:dw(ht),text:g9(hr,ht.from,ht.to)};cp(hr,hs,ht.from.line,ht.to.line+1);eN(hr,function(hu){return cp(hu,hs,ht.from.line,ht.to.line+1)},true);return hs}function gv(hs){while(hs.length){var hr=gA(hs);if(hr.ranges){hs.pop()}else{break}}}function fC(hs,hr){if(hr){gv(hs.done);return gA(hs.done)}else{if(hs.done.length&&!gA(hs.done).ranges){return gA(hs.done)}else{if(hs.done.length>1&&!hs.done[hs.done.length-2].ranges){hs.done.pop();return gA(hs.done)}}}}function gI(hx,hv,hr,hu){var ht=hx.history;ht.undone.length=0;var hs=+new Date,hy;var hz;if((ht.lastOp==hu||ht.lastOrigin==hv.origin&&hv.origin&&((hv.origin.charAt(0)=="+"&&ht.lastModTime>hs-(hx.cm?hx.cm.options.historyEventDelay:500))||hv.origin.charAt(0)=="*"))&&(hy=fC(ht,ht.lastOp==hu))){hz=gA(hy.changes);if(cJ(hv.from,hv.to)==0&&cJ(hv.from,hz.to)==0){hz.to=dw(hv)}else{hy.changes.push(d8(hx,hv))}}else{var hw=gA(ht.done);if(!hw||!hw.ranges){dn(hx.sel,ht.done)}hy={changes:[d8(hx,hv)],generation:ht.generation};ht.done.push(hy);while(ht.done.length>ht.undoDepth){ht.done.shift();if(!ht.done[0].ranges){ht.done.shift()}}}ht.done.push(hr);ht.generation=++ht.maxGeneration;ht.lastModTime=ht.lastSelTime=hs;ht.lastOp=ht.lastSelOp=hu;ht.lastOrigin=ht.lastSelOrigin=hv.origin;if(!hz){aT(hx,"historyAdded")}}function bY(hv,hr,ht,hu){var hs=hr.charAt(0);return hs=="*"||hs=="+"&&ht.ranges.length==hu.ranges.length&&ht.somethingSelected()==hu.somethingSelected()&&new Date-hv.history.lastSelTime<=(hv.cm?hv.cm.options.historyEventDelay:500)}function hj(hw,hu,hr,ht){var hv=hw.history,hs=ht&&ht.origin;if(hr==hv.lastSelOp||(hs&&hv.lastSelOrigin==hs&&(hv.lastModTime==hv.lastSelTime&&hv.lastOrigin==hs||bY(hw,hs,gA(hv.done),hu)))){hv.done[hv.done.length-1]=hu}else{dn(hu,hv.done)}hv.lastSelTime=+new Date;hv.lastSelOrigin=hs;hv.lastSelOp=hr;if(ht&&ht.clearRedo!==false){gv(hv.undone)}}function dn(hs,hr){var ht=gA(hr);if(!(ht&&ht.ranges&&ht.equals(hs))){hr.push(hs)}}function cp(hs,hw,hv,hu){var hr=hw["spans_"+hs.id],ht=0;hs.iter(Math.max(hs.first,hv),Math.min(hs.first+hs.size,hu),function(hx){if(hx.markedSpans){(hr||(hr=hw["spans_"+hs.id]={}))[ht]=hx.markedSpans}++ht})}function bC(ht){if(!ht){return null}var hr;for(var hs=0;hs<ht.length;++hs){if(ht[hs].marker.explicitlyCleared){if(!hr){hr=ht.slice(0,hs)}}else{if(hr){hr.push(ht[hs])}}}return !hr?ht:hr.length?hr:null}function cv(hu,hv){var ht=hv["spans_"+hu.id];if(!ht){return null}var hr=[];for(var hs=0;hs<hv.text.length;++hs){hr.push(bC(ht[hs]))}return hr}function eP(hz,hx){var hr=cv(hz,hx);var hA=e2(hz,hx);if(!hr){return hA}if(!hA){return hr}for(var hu=0;hu<hr.length;++hu){var hv=hr[hu],hw=hA[hu];if(hv&&hw){spans:for(var ht=0;ht<hw.length;++ht){var hy=hw[ht];for(var hs=0;hs<hv.length;++hs){if(hv[hs].marker==hy.marker){continue spans}}hv.push(hy)}}else{if(hw){hr[hu]=hw}}}return hr}function ce(hC,hu,hB){var hs=[];for(var hx=0;hx<hC.length;++hx){var ht=hC[hx];if(ht.ranges){hs.push(hB?g6.prototype.deepCopy.call(ht):ht);continue}var hz=ht.changes,hA=[];hs.push({changes:hA});for(var hw=0;hw<hz.length;++hw){var hy=hz[hw],hv=(void 0);hA.push({from:hy.from,to:hy.to,text:hy.text});if(hu){for(var hr in hy){if(hv=hr.match(/^spans_(\d+)$/)){if(dV(hu,Number(hv[1]))>-1){gA(hA)[hr]=hy[hr];delete hy[hr]}}}}}}return hs}function gm(hs,hv,hr,hw){if(hw){var hu=hs.anchor;if(hr){var ht=cJ(hv,hu)<0;if(ht!=(cJ(hr,hu)<0)){hu=hv;hv=hr}else{if(ht!=(cJ(hv,hr)<0)){hv=hr}}}return new eB(hu,hv)}else{return new eB(hr||hv,hv)}}function gZ(hu,ht,hr,hs,hv){if(hv==null){hv=hu.cm&&(hu.cm.display.shift||hu.extend)}ck(hu,new g6([gm(hu.sel.primary(),ht,hr,hv)],0),hs)}function aK(hw,hv,ht){var hs=[];var hx=hw.cm&&(hw.cm.display.shift||hw.extend);for(var hu=0;hu<hw.sel.ranges.length;hu++){hs[hu]=gm(hw.sel.ranges[hu],hv[hu],null,hx)}var hr=c3(hw.cm,hs,hw.sel.primIndex);ck(hw,hr,ht)}function e(hv,hu,hs,ht){var hr=hv.sel.ranges.slice(0);hr[hu]=hs;ck(hv,c3(hv.cm,hr,hv.sel.primIndex),ht)}function Q(hu,hs,ht,hr){ck(hu,fH(hs,ht),hr)}function b(hu,hs,hr){var ht={ranges:hs.ranges,update:function(hv){var hx=this;this.ranges=[];for(var hw=0;hw<hv.length;hw++){hx.ranges[hw]=new eB(gF(hu,hv[hw].anchor),gF(hu,hv[hw].head))}},origin:hr&&hr.origin};aT(hu,"beforeSelectionChange",hu,ht);if(hu.cm){aT(hu.cm,"beforeSelectionChange",hu.cm,ht)}if(ht.ranges!=hs.ranges){return c3(hu.cm,ht.ranges,ht.ranges.length-1)}else{return hs}}function f0(hv,hu,hs){var hr=hv.history.done,ht=gA(hr);if(ht&&ht.ranges){hr[hr.length-1]=hu;e8(hv,hu,hs)}else{ck(hv,hu,hs)}}function ck(ht,hs,hr){e8(ht,hs,hr);hj(ht,ht.sel,ht.cm?ht.cm.curOp.id:NaN,hr)}function e8(hu,ht,hs){if(gc(hu,"beforeSelectionChange")||hu.cm&&gc(hu.cm,"beforeSelectionChange")){ht=b(hu,ht,hs)}var hr=hs&&hs.bias||(cJ(ht.primary().head,hu.sel.primary().head)<0?-1:1);dJ(hu,s(hu,ht,hr,true));if(!(hs&&hs.scroll===false)&&hu.cm){gz(hu.cm)}}function dJ(hs,hr){if(hr.equals(hs.sel)){return}hs.sel=hr;if(hs.cm){hs.cm.curOp.updateInput=1;hs.cm.curOp.selectionChanged=true;ag(hs.cm)}ar(hs,"cursorActivity",hs)}function fi(hr){dJ(hr,s(hr,hr.sel,null,false))}function s(hA,hr,hx,hy){var hu;for(var hv=0;hv<hr.ranges.length;hv++){var hw=hr.ranges[hv];var hs=hr.ranges.length==hA.sel.ranges.length&&hA.sel.ranges[hv];var hz=cl(hA,hw.anchor,hs&&hs.anchor,hx,hy);var ht=cl(hA,hw.head,hs&&hs.head,hx,hy);if(hu||hz!=hw.anchor||ht!=hw.head){if(!hu){hu=hr.ranges.slice(0,hv)}hu[hv]=new eB(hz,ht)}}return hu?c3(hA.cm,hu,hr.primIndex):hr}function fx(hB,hz,hu,ht,hx){var hC=f7(hB,hz.line);if(hC.markedSpans){for(var hv=0;hv<hC.markedSpans.length;++hv){var hr=hC.markedSpans[hv],hs=hr.marker;if((hr.from==null||(hs.inclusiveLeft?hr.from<=hz.ch:hr.from<hz.ch))&&(hr.to==null||(hs.inclusiveRight?hr.to>=hz.ch:hr.to>hz.ch))){if(hx){aT(hs,"beforeCursorEnter");if(hs.explicitlyCleared){if(!hC.markedSpans){break}else{--hv;continue}}}if(!hs.atomic){continue}if(hu){var hy=hs.find(ht<0?1:-1),hA=(void 0);if(ht<0?hs.inclusiveRight:hs.inclusiveLeft){hy=hn(hB,hy,-ht,hy&&hy.line==hz.line?hC:null)}if(hy&&hy.line==hz.line&&(hA=cJ(hy,hu))&&(ht<0?hA<0:hA>0)){return fx(hB,hy,hz,ht,hx)}}var hw=hs.find(ht<0?-1:1);if(ht<0?hs.inclusiveLeft:hs.inclusiveRight){hw=hn(hB,hw,ht,hw.line==hz.line?hC:null)}return hw?fx(hB,hw,hz,ht,hx):null}}}return hz}function cl(hw,hx,hu,hs,hr){var ht=hs||1;var hv=fx(hw,hx,hu,ht,hr)||(!hr&&fx(hw,hx,hu,ht,true))||fx(hw,hx,hu,-ht,hr)||(!hr&&fx(hw,hx,hu,-ht,true));if(!hv){hw.cantEdit=true;return ah(hw.first,0)}return hv}function hn(ht,hu,hs,hr){if(hs<0&&hu.ch==0){if(hu.line>ht.first){return gF(ht,ah(hu.line-1))}else{return null}}else{if(hs>0&&hu.ch==(hr||f7(ht,hu.line)).text.length){if(hu.line<ht.first+ht.size-1){return ah(hu.line+1,0)}else{return null}}else{return new ah(hu.line,hu.ch+hs)}}}function aA(hr){hr.setSelection(ah(hr.firstLine(),0),ah(hr.lastLine()),am)}function et(hs,hu,ht){var hr={canceled:false,from:hu.from,to:hu.to,text:hu.text,origin:hu.origin,cancel:function(){return hr.canceled=true}};if(ht){hr.update=function(hy,hx,hw,hv){if(hy){hr.from=gF(hs,hy)}if(hx){hr.to=gF(hs,hx)}if(hw){hr.text=hw}if(hv!==undefined){hr.origin=hv}}}aT(hs,"beforeChange",hs,hr);if(hs.cm){aT(hs.cm,"beforeChange",hs.cm,hr)}if(hr.canceled){if(hs.cm){hs.cm.curOp.updateInput=2}return null}return{from:hr.from,to:hr.to,text:hr.text,origin:hr.origin}}function bx(hu,hv,ht){if(hu.cm){if(!hu.cm.curOp){return dA(hu.cm,bx)(hu,hv,ht)}if(hu.cm.state.suppressEdits){return}}if(gc(hu,"beforeChange")||hu.cm&&gc(hu.cm,"beforeChange")){hv=et(hu,hv,true);if(!hv){return}}var hs=hl&&!ht&&dg(hu,hv.from,hv.to);if(hs){for(var hr=hs.length-1;hr>=0;--hr){V(hu,{from:hs[hr].from,to:hs[hr].to,text:hr?[""]:hv.text,origin:hv.origin})}}else{V(hu,hv)}}function V(ht,hu){if(hu.text.length==1&&hu.text[0]==""&&cJ(hu.from,hu.to)==0){return}var hs=gb(ht,hu);gI(ht,hu,hs,ht.cm?ht.cm.curOp.id:NaN);eU(ht,hu,hs,e2(ht,hu));var hr=[];eN(ht,function(hw,hv){if(!hv&&dV(hr,hw.history)==-1){ef(hw.history,hu);hr.push(hw.history)}eU(hw,hu,null,e2(hw,hu))})}function cz(hE,hB,hF){var hC=hE.cm&&hE.cm.state.suppressEdits;if(hC&&!hF){return}var hA=hE.history,hs,hu=hE.sel;var hr=hB=="undo"?hA.done:hA.undone,hD=hB=="undo"?hA.undone:hA.done;var hx=0;for(;hx<hr.length;hx++){hs=hr[hx];if(hF?hs.ranges&&!hs.equals(hE.sel):!hs.ranges){break}}if(hx==hr.length){return}hA.lastOrigin=hA.lastSelOrigin=null;for(;;){hs=hr.pop();if(hs.ranges){dn(hs,hD);if(hF&&!hs.equals(hE.sel)){ck(hE,hs,{clearRedo:false});return}hu=hs}else{if(hC){hr.push(hs);return}else{break}}}var hz=[];dn(hu,hD);hD.push({changes:hz,generation:hA.generation});hA.generation=hs.generation||++hA.maxGeneration;var ht=gc(hE,"beforeChange")||hE.cm&&gc(hE.cm,"beforeChange");var hy=function(hG){var hJ=hs.changes[hG];hJ.origin=hB;if(ht&&!et(hE,hJ,false)){hr.length=0;return{}}hz.push(d8(hE,hJ));var hI=hG?gb(hE,hJ):gA(hr);eU(hE,hJ,hI,eP(hE,hJ));if(!hG&&hE.cm){hE.cm.scrollIntoView({from:hJ.from,to:dw(hJ)})}var hH=[];eN(hE,function(hL,hK){if(!hK&&dV(hH,hL.history)==-1){ef(hL.history,hJ);hH.push(hL.history)}eU(hL,hJ,null,eP(hL,hJ))})};for(var hv=hs.changes.length-1;hv>=0;--hv){var hw=hy(hv);if(hw){return hw.v}}}function gf(hs,hu){if(hu==0){return}hs.first+=hu;hs.sel=new g6(cj(hs.sel.ranges,function(hv){return new eB(ah(hv.anchor.line+hu,hv.anchor.ch),ah(hv.head.line+hu,hv.head.ch))}),hs.sel.primIndex);if(hs.cm){av(hs.cm,hs.first,hs.first-hu,hu);for(var ht=hs.cm.display,hr=ht.viewFrom;hr<ht.viewTo;hr++){ac(hs.cm,hr,"gutter")}}}function eU(hv,hw,hu,hs){if(hv.cm&&!hv.cm.curOp){return dA(hv.cm,eU)(hv,hw,hu,hs)}if(hw.to.line<hv.first){gf(hv,hw.text.length-1-(hw.to.line-hw.from.line));return}if(hw.from.line>hv.lastLine()){return}if(hw.from.line<hv.first){var hr=hw.text.length-1-(hv.first-hw.from.line);gf(hv,hr);hw={from:ah(hv.first,0),to:ah(hw.to.line+hr,hw.to.ch),text:[gA(hw.text)],origin:hw.origin}}var ht=hv.lastLine();if(hw.to.line>ht){hw={from:hw.from,to:ah(ht,f7(hv,ht).text.length),text:[hw.text[0]],origin:hw.origin}}hw.removed=g9(hv,hw.from,hw.to);if(!hu){hu=gb(hv,hw)}if(hv.cm){aY(hv.cm,hw,hs)}else{gq(hv,hw,hs)}e8(hv,hu,am)}function aY(hC,hy,hw){var hB=hC.doc,hx=hC.display,hz=hy.from,hA=hy.to;var hr=false,hv=hz.line;if(!hC.options.lineWrapping){hv=cc(G(f7(hB,hz.line)));hB.iter(hv,hA.line+1,function(hE){if(hE==hx.maxLine){hr=true;return true}})}if(hB.sel.contains(hy.from,hy.to)>-1){ag(hC)}gq(hB,hy,hw,bv(hC));if(!hC.options.lineWrapping){hB.iter(hv,hz.line+hy.text.length,function(hF){var hE=e5(hF);if(hE>hx.maxLineLength){hx.maxLine=hF;hx.maxLineLength=hE;hx.maxLineChanged=true;hr=false}});if(hr){hC.curOp.updateMaxLine=true}}hk(hB,hz.line);eV(hC,400);var hD=hy.text.length-(hA.line-hz.line)-1;if(hy.full){av(hC)}else{if(hz.line==hA.line&&hy.text.length==1&&!ev(hC.doc,hy)){ac(hC,hz.line,"text")}else{av(hC,hz.line,hA.line+1,hD)}}var ht=gc(hC,"changes"),hu=gc(hC,"change");if(hu||ht){var hs={from:hz,to:hA,text:hy.text,removed:hy.removed,origin:hy.origin};if(hu){ar(hC,"change",hC,hs)}if(ht){(hC.curOp.changeObjs||(hC.curOp.changeObjs=[])).push(hs)}}hC.display.selForContextMenu=null}function bi(hu,ht,hw,hv,hs){var hr;if(!hv){hv=hw}if(cJ(hv,hw)<0){(hr=[hv,hw],hw=hr[0],hv=hr[1])}if(typeof ht=="string"){ht=hu.splitLines(ht)}bx(hu,{from:hw,to:hv,text:ht,origin:hs})}function T(hu,ht,hs,hr){if(hs<hu.line){hu.line+=hr}else{if(ht<hu.line){hu.line=ht;hu.ch=0}}}function f9(hv,hx,hy,hz){for(var hu=0;hu<hv.length;++hu){var hr=hv[hu],hw=true;if(hr.ranges){if(!hr.copied){hr=hv[hu]=hr.deepCopy();hr.copied=true}for(var ht=0;ht<hr.ranges.length;ht++){T(hr.ranges[ht].anchor,hx,hy,hz);T(hr.ranges[ht].head,hx,hy,hz)}continue}for(var hs=0;hs<hr.changes.length;++hs){var hA=hr.changes[hs];if(hy<hA.from.line){hA.from=ah(hA.from.line+hz,hA.from.ch);hA.to=ah(hA.to.line+hz,hA.to.ch)}else{if(hx<=hA.to.line){hw=false;break}}}if(!hw){hv.splice(0,hu+1);hu=0}}}function ef(hs,hv){var hu=hv.from.line,ht=hv.to.line,hr=hv.text.length-(ht-hu)-1;f9(hs.done,hu,ht,hr);f9(hs.undone,hu,ht,hr)}function fl(hu,ht,hr,hw){var hv=ht,hs=ht;if(typeof ht=="number"){hs=f7(hu,dE(hu,ht))}else{hv=cc(ht)}if(hv==null){return null}if(hw(hs,hv)&&hu.cm){ac(hu.cm,hv,hr)}return hs}function fR(hs){var hu=this;this.lines=hs;this.parent=null;var hr=0;for(var ht=0;ht<hs.length;++ht){hs[ht].parent=hu;hr+=hs[ht].height}this.height=hr}fR.prototype={chunkSize:function(){return this.lines.length},removeInner:function(hr,hw){var hv=this;for(var ht=hr,hu=hr+hw;ht<hu;++ht){var hs=hv.lines[ht];hv.height-=hs.height;bZ(hs);ar(hs,"delete")}this.lines.splice(hr,hw)},collapse:function(hr){hr.push.apply(hr,this.lines)},insertInner:function(hs,ht,hr){var hv=this;this.height+=hr;this.lines=this.lines.slice(0,hs).concat(ht).concat(this.lines.slice(hs));for(var hu=0;hu<ht.length;++hu){ht[hu].parent=hv}},iterN:function(hr,hv,hu){var ht=this;for(var hs=hr+hv;hr<hs;++hr){if(hu(ht.lines[hr])){return true}}}};function gp(hu){var hw=this;this.children=hu;var ht=0,hr=0;for(var hs=0;hs<hu.length;++hs){var hv=hu[hs];ht+=hv.chunkSize();hr+=hv.height;hv.parent=hw}this.size=ht;this.height=hr;this.parent=null}gp.prototype={chunkSize:function(){return this.size},removeInner:function(ht,hs){var hv=this;this.size-=hs;for(var hu=0;hu<this.children.length;++hu){var hr=hv.children[hu],hx=hr.chunkSize();if(ht<hx){var hw=Math.min(hs,hx-ht),hy=hr.height;hr.removeInner(ht,hw);hv.height-=hy-hr.height;if(hx==hw){hv.children.splice(hu--,1);hr.parent=null}if((hs-=hw)==0){break}ht=0}else{ht-=hx}}if(this.size-hs<25&&(this.children.length>1||!(this.children[0] instanceof fR))){var hz=[];this.collapse(hz);this.children=[new fR(hz)];this.children[0].parent=this}},collapse:function(hr){var ht=this;for(var hs=0;hs<this.children.length;++hs){ht.children[hs].collapse(hr)}},insertInner:function(hs,hA,hz){var hv=this;this.size+=hA.length;this.height+=hz;for(var hu=0;hu<this.children.length;++hu){var hr=hv.children[hu],hx=hr.chunkSize();if(hs<=hx){hr.insertInner(hs,hA,hz);if(hr.lines&&hr.lines.length>50){var ht=hr.lines.length%25+25;for(var hy=ht;hy<hr.lines.length;){var hw=new fR(hr.lines.slice(hy,hy+=25));hr.height-=hw.height;hv.children.splice(++hu,0,hw);hw.parent=hv}hr.lines=hr.lines.slice(0,ht);hv.maybeSpill()}break}hs-=hx}},maybeSpill:function(){if(this.children.length<=10){return}var hu=this;do{var hs=hu.children.splice(hu.children.length-5,5);var ht=new gp(hs);if(!hu.parent){var hv=new gp(hu.children);hv.parent=hu;hu.children=[hv,ht];hu=hv}else{hu.size-=ht.size;hu.height-=ht.height;var hr=dV(hu.parent.children,hu);hu.parent.children.splice(hr+1,0,ht)}ht.parent=hu.parent}while(hu.children.length>10);hu.parent.maybeSpill()},iterN:function(hr,hy,hx){var hw=this;for(var hs=0;hs<this.children.length;++hs){var hv=hw.children[hs],hu=hv.chunkSize();if(hr<hu){var ht=Math.min(hy,hu-hr);if(hv.iterN(hr,ht,hx)){return true}if((hy-=ht)==0){break}hr=0}else{hr-=hu}}}};var ed=function(hu,ht,hr){var hv=this;if(hr){for(var hs in hr){if(hr.hasOwnProperty(hs)){hv[hs]=hr[hs]}}}this.doc=hu;this.node=ht};ed.prototype.clear=function(){var hx=this;var hs=this.doc.cm,hu=this.line.widgets,ht=this.line,hw=cc(ht);if(hw==null||!hu){return}for(var hv=0;hv<hu.length;++hv){if(hu[hv]==hx){hu.splice(hv--,1)}}if(!hu.length){ht.widgets=null}var hr=dx(this);hc(ht,Math.max(0,ht.height-hr));if(hs){dl(hs,function(){eD(hs,ht,-hr);ac(hs,hw,"widget")});ar(hs,"lineWidgetCleared",hs,this,hw)}};ed.prototype.changed=function(){var hv=this;var hs=this.height,hr=this.doc.cm,ht=this.line;this.height=null;var hu=dx(this)-hs;if(!hu){return}if(!gn(this.doc,ht)){hc(ht,ht.height+hu)}if(hr){dl(hr,function(){hr.curOp.forceUpdate=true;eD(hr,ht,hu);ar(hr,"lineWidgetChanged",hr,hv,cc(ht))})}};bX(ed);function eD(hr,hs,ht){if(cb(hs)<((hr.curOp&&hr.curOp.scrollTop)||hr.doc.scrollTop)){df(hr,ht)}}function b4(hw,hv,ht,hs){var hu=new ed(hw,ht,hs);var hr=hw.cm;if(hr&&hu.noHScroll){hr.display.alignWidgets=true}fl(hw,hv,"widget",function(hy){var hz=hy.widgets||(hy.widgets=[]);if(hu.insertAt==null){hz.push(hu)}else{hz.splice(Math.min(hz.length-1,Math.max(0,hu.insertAt)),0,hu)}hu.line=hy;if(hr&&!gn(hw,hy)){var hx=cb(hy)<hw.scrollTop;hc(hy,hy.height+dx(hu));if(hx){df(hr,hu.height)}hr.curOp.forceUpdate=true}return true});if(hr){ar(hr,"lineWidgetAdded",hr,hu,typeof hv=="number"?hv:cc(hv))}return hu}var bl=0;var ab=function(hs,hr){this.lines=[];this.type=hr;this.doc=hs;this.id=++bl};ab.prototype.clear=function(){var hw=this;if(this.explicitlyCleared){return}var hA=this.doc.cm,ht=hA&&!hA.curOp;if(ht){dh(hA)}if(gc(this,"clear")){var hB=this.find();if(hB){ar(this,"clear",hB.from,hB.to)}}var hu=null,hy=null;for(var hv=0;hv<this.lines.length;++hv){var hC=hw.lines[hv];var hz=f2(hC.markedSpans,hw);if(hA&&!hw.collapsed){ac(hA,cc(hC),"text")}else{if(hA){if(hz.to!=null){hy=cc(hC)}if(hz.from!=null){hu=cc(hC)}}}hC.markedSpans=fv(hC.markedSpans,hz);if(hz.from==null&&hw.collapsed&&!gn(hw.doc,hC)&&hA){hc(hC,bf(hA.display))}}if(hA&&this.collapsed&&!hA.options.lineWrapping){for(var hs=0;hs<this.lines.length;++hs){var hr=G(hw.lines[hs]),hx=e5(hr);if(hx>hA.display.maxLineLength){hA.display.maxLine=hr;hA.display.maxLineLength=hx;hA.display.maxLineChanged=true}}}if(hu!=null&&hA&&this.collapsed){av(hA,hu,hy+1)}this.lines.length=0;this.explicitlyCleared=true;if(this.atomic&&this.doc.cantEdit){this.doc.cantEdit=false;if(hA){fi(hA.doc)}}if(hA){ar(hA,"markerCleared",hA,this,hu,hy)}if(ht){aB(hA)}if(this.parent){this.parent.clear()}};ab.prototype.find=function(hu,hs){var hy=this;if(hu==null&&this.type=="bookmark"){hu=1}var hx,hw;for(var ht=0;ht<this.lines.length;++ht){var hr=hy.lines[ht];var hv=f2(hr.markedSpans,hy);if(hv.from!=null){hx=ah(hs?hr:cc(hr),hv.from);if(hu==-1){return hx}}if(hv.to!=null){hw=ah(hs?hr:cc(hr),hv.to);if(hu==1){return hw}}}return hx&&{from:hx,to:hw}};ab.prototype.changed=function(){var hu=this;var ht=this.find(-1,true),hs=this,hr=this.doc.cm;if(!ht||!hr){return}dl(hr,function(){var hw=ht.line,hx=cc(ht.line);var hv=f4(hr,hx);if(hv){aJ(hv);hr.curOp.selectionChanged=hr.curOp.forceUpdate=true}hr.curOp.updateMaxLine=true;if(!gn(hs.doc,hw)&&hs.height!=null){var hz=hs.height;hs.height=null;var hy=dx(hs)-hz;if(hy){hc(hw,hw.height+hy)}}ar(hr,"markerChanged",hr,hu)})};ab.prototype.attachLine=function(hr){if(!this.lines.length&&this.doc.cm){var hs=this.doc.cm.curOp;if(!hs.maybeHiddenMarkers||dV(hs.maybeHiddenMarkers,this)==-1){(hs.maybeUnhiddenMarkers||(hs.maybeUnhiddenMarkers=[])).push(this)}}this.lines.push(hr)};ab.prototype.detachLine=function(hr){this.lines.splice(dV(this.lines,hr),1);if(!this.lines.length&&this.doc.cm){var hs=this.doc.cm.curOp;(hs.maybeHiddenMarkers||(hs.maybeHiddenMarkers=[])).push(this)}};bX(ab);function fs(hz,hx,hy,hB,hv){if(hB&&hB.shared){return Y(hz,hx,hy,hB,hv)}if(hz.cm&&!hz.cm.curOp){return dA(hz.cm,fs)(hz,hx,hy,hB,hv)}var hu=new ab(hz,hv),hA=cJ(hx,hy);if(hB){a4(hB,hu,false)}if(hA>0||hA==0&&hu.clearWhenEmpty!==false){return hu}if(hu.replacedWith){hu.collapsed=true;hu.widgetNode=hd("span",[hu.replacedWith],"CodeMirror-widget");if(!hB.handleMouseEvents){hu.widgetNode.setAttribute("cm-ignore-events","true")}if(hB.insertLeft){hu.widgetNode.insertLeft=true}}if(hu.collapsed){if(H(hz,hx.line,hx,hy,hu)||hx.line!=hy.line&&H(hz,hy.line,hx,hy,hu)){throw new Error("Inserting collapsed marker partially overlapping an existing one")}bU()}if(hu.addToHistory){gI(hz,{from:hx,to:hy,origin:"markText"},hz.sel,NaN)}var hs=hx.line,hw=hz.cm,hr;hz.iter(hs,hy.line+1,function(hC){if(hw&&hu.collapsed&&!hw.options.lineWrapping&&G(hC)==hw.display.maxLine){hr=true}if(hu.collapsed&&hs!=hx.line){hc(hC,0)}cG(hC,new e0(hu,hs==hx.line?hx.ch:null,hs==hy.line?hy.ch:null));++hs});if(hu.collapsed){hz.iter(hx.line,hy.line+1,function(hC){if(gn(hz,hC)){hc(hC,0)}})}if(hu.clearOnEnter){cn(hu,"beforeCursorEnter",function(){return hu.clear()})}if(hu.readOnly){gs();if(hz.history.done.length||hz.history.undone.length){hz.clearHistory()}}if(hu.collapsed){hu.id=++bl;hu.atomic=true}if(hw){if(hr){hw.curOp.updateMaxLine=true}if(hu.collapsed){av(hw,hx.line,hy.line+1)}else{if(hu.className||hu.startStyle||hu.endStyle||hu.css||hu.attributes||hu.title){for(var ht=hx.line;ht<=hy.line;ht++){ac(hw,ht,"text")}}}if(hu.atomic){fi(hw.doc)}ar(hw,"markerAdded",hw,hu)}return hu}var F=function(ht,hs){var hu=this;this.markers=ht;this.primary=hs;for(var hr=0;hr<ht.length;++hr){ht[hr].parent=hu}};F.prototype.clear=function(){var hs=this;if(this.explicitlyCleared){return}this.explicitlyCleared=true;for(var hr=0;hr<this.markers.length;++hr){hs.markers[hr].clear()}ar(this,"clear")};F.prototype.find=function(hs,hr){return this.primary.find(hs,hr)};bX(F);function Y(hv,hy,hx,hr,ht){hr=a4(hr);hr.shared=false;var hw=[fs(hv,hy,hx,hr,ht)],hs=hw[0];var hu=hr.widgetNode;eN(hv,function(hA){if(hu){hr.widgetNode=hu.cloneNode(true)}hw.push(fs(hA,gF(hA,hy),gF(hA,hx),hr,ht));for(var hz=0;hz<hA.linked.length;++hz){if(hA.linked[hz].isParent){return}}hs=gA(hw)});return new F(hw,hs)}function fE(hr){return hr.findMarks(ah(hr.first,0),hr.clipPos(ah(hr.lastLine())),function(hs){return hs.parent})}function eg(hw,hx){for(var hu=0;hu<hx.length;hu++){var hs=hx[hu],hy=hs.find();var hr=hw.clipPos(hy.from),hv=hw.clipPos(hy.to);if(cJ(hr,hv)){var ht=fs(hw,hr,hv,hs.primary,hs.primary.type);hs.markers.push(ht);ht.parent=hs}}}function e7(ht){var hr=function(hw){var hu=ht[hw],hy=[hu.primary.doc];eN(hu.primary.doc,function(hz){return hy.push(hz)});for(var hv=0;hv<hu.markers.length;hv++){var hx=hu.markers[hv];if(dV(hy,hx.doc)==-1){hx.parent=null;hu.markers.splice(hv--,1)}}};for(var hs=0;hs<ht.length;hs++){hr(hs)}}var cY=0;var aI=function(hv,hu,hr,ht,hs){if(!(this instanceof aI)){return new aI(hv,hu,hr,ht,hs)}if(hr==null){hr=0}gp.call(this,[new fR([new hb("",null)])]);this.first=hr;this.scrollTop=this.scrollLeft=0;this.cantEdit=false;this.cleanGeneration=1;this.modeFrontier=this.highlightFrontier=hr;var hw=ah(hr,0);this.sel=fH(hw);this.history=new gT(null);this.id=++cY;this.modeOption=hu;this.lineSep=ht;this.direction=(hs=="rtl")?"rtl":"ltr";this.extend=false;if(typeof hv=="string"){hv=this.splitLines(hv)}gq(this,{from:hw,to:hw,text:hv});ck(this,fH(hw),am)};aI.prototype=cQ(gp.prototype,{constructor:aI,iter:function(ht,hs,hr){if(hr){this.iterN(ht-this.first,hs-ht,hr)}else{this.iterN(this.first,this.first+this.size,ht)}},insert:function(hs,ht){var hr=0;for(var hu=0;hu<ht.length;++hu){hr+=ht[hu].height}this.insertInner(hs-this.first,ht,hr)},remove:function(hr,hs){this.removeInner(hr-this.first,hs)},getValue:function(hs){var hr=bj(this,this.first,this.first+this.size);if(hs===false){return hr}return hr.join(hs||this.lineSeparator())},setValue:db(function(hs){var ht=ah(this.first,0),hr=this.first+this.size-1;bx(this,{from:ht,to:ah(hr,f7(this,hr).text.length),text:this.splitLines(hs),origin:"setValue",full:true},true);if(this.cm){fB(this.cm,0,0)}ck(this,fH(ht),am)}),replaceRange:function(hs,hu,ht,hr){hu=gF(this,hu);ht=ht?gF(this,ht):hu;bi(this,hs,hu,ht,hr)},getRange:function(hu,ht,hs){var hr=g9(this,gF(this,hu),gF(this,ht));if(hs===false){return hr}return hr.join(hs||this.lineSeparator())},getLine:function(hs){var hr=this.getLineHandle(hs);return hr&&hr.text},getLineHandle:function(hr){if(cA(this,hr)){return f7(this,hr)}},getLineNumber:function(hr){return cc(hr)},getLineHandleVisualStart:function(hr){if(typeof hr=="number"){hr=f7(this,hr)}return G(hr)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(hr){return gF(this,hr)},getCursor:function(ht){var hr=this.sel.primary(),hs;if(ht==null||ht=="head"){hs=hr.head}else{if(ht=="anchor"){hs=hr.anchor}else{if(ht=="end"||ht=="to"||ht===false){hs=hr.to()}else{hs=hr.from()}}}return hs},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:db(function(hr,ht,hs){Q(this,gF(this,typeof hr=="number"?ah(hr,ht||0):hr),null,hs)}),setSelection:db(function(hs,ht,hr){Q(this,gF(this,hs),gF(this,ht||hs),hr)}),extendSelection:db(function(ht,hr,hs){gZ(this,gF(this,ht),hr&&gF(this,hr),hs)}),extendSelections:db(function(hs,hr){aK(this,eF(this,hs),hr)}),extendSelectionsBy:db(function(ht,hr){var hs=cj(this.sel.ranges,ht);aK(this,eF(this,hs),hr)}),setSelections:db(function(hr,hv,ht){var hw=this;if(!hr.length){return}var hs=[];for(var hu=0;hu<hr.length;hu++){hs[hu]=new eB(gF(hw,hr[hu].anchor),gF(hw,hr[hu].head))}if(hv==null){hv=Math.min(hr.length-1,this.sel.primIndex)}ck(this,c3(this.cm,hs,hv),ht)}),addSelection:db(function(ht,hu,hs){var hr=this.sel.ranges.slice(0);hr.push(new eB(gF(this,ht),gF(this,hu||ht)));ck(this,c3(this.cm,hr,hr.length-1),hs)}),getSelection:function(hv){var hw=this;var hs=this.sel.ranges,hr;for(var ht=0;ht<hs.length;ht++){var hu=g9(hw,hs[ht].from(),hs[ht].to());hr=hr?hr.concat(hu):hu}if(hv===false){return hr}else{return hr.join(hv||this.lineSeparator())}},getSelections:function(hv){var hw=this;var hu=[],hr=this.sel.ranges;for(var hs=0;hs<hr.length;hs++){var ht=g9(hw,hr[hs].from(),hr[hs].to());if(hv!==false){ht=ht.join(hv||hw.lineSeparator())}hu[hs]=ht}return hu},replaceSelection:function(ht,hv,hr){var hu=[];for(var hs=0;hs<this.sel.ranges.length;hs++){hu[hs]=ht}this.replaceSelections(hu,hv,hr||"+input")},replaceSelections:db(function(hs,hx,hz){var hw=this;var hy=[],hu=this.sel;for(var hv=0;hv<hu.ranges.length;hv++){var hA=hu.ranges[hv];hy[hv]={from:hA.from(),to:hA.to(),text:hw.splitLines(hs[hv]),origin:hz}}var hr=hx&&hx!="end"&&at(this,hy,hx);for(var ht=hy.length-1;ht>=0;ht--){bx(hw,hy[ht])}if(hr){f0(this,hr)}else{if(this.cm){gz(this.cm)}}}),undo:db(function(){cz(this,"undo")}),redo:db(function(){cz(this,"redo")}),undoSelection:db(function(){cz(this,"undo",true)}),redoSelection:db(function(){cz(this,"redo",true)}),setExtending:function(hr){this.extend=hr},getExtending:function(){return this.extend},historySize:function(){var hu=this.history,hr=0,ht=0;for(var hs=0;hs<hu.done.length;hs++){if(!hu.done[hs].ranges){++hr}}for(var hv=0;hv<hu.undone.length;hv++){if(!hu.undone[hv].ranges){++ht}}return{undo:hr,redo:ht}},clearHistory:function(){this.history=new gT(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(true)},changeGeneration:function(hr){if(hr){this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null}return this.history.generation},isClean:function(hr){return this.history.generation==(hr||this.cleanGeneration)},getHistory:function(){return{done:ce(this.history.done),undone:ce(this.history.undone)}},setHistory:function(hs){var hr=this.history=new gT(this.history.maxGeneration);hr.done=ce(hs.done.slice(0),null,true);hr.undone=ce(hs.undone.slice(0),null,true)},setGutterMarker:db(function(hr,hs,ht){return fl(this,hr,"gutter",function(hu){var hv=hu.gutterMarkers||(hu.gutterMarkers={});hv[hs]=ht;if(!ht&&fL(hv)){hu.gutterMarkers=null}return true})}),clearGutter:db(function(hr){var hs=this;this.iter(function(ht){if(ht.gutterMarkers&&ht.gutterMarkers[hr]){fl(hs,ht,"gutter",function(){ht.gutterMarkers[hr]=null;if(fL(ht.gutterMarkers)){ht.gutterMarkers=null}return true})}})}),lineInfo:function(hr){var hs;if(typeof hr=="number"){if(!cA(this,hr)){return null}hs=hr;hr=f7(this,hr);if(!hr){return null}}else{hs=cc(hr);if(hs==null){return null}}return{line:hs,handle:hr,text:hr.text,gutterMarkers:hr.gutterMarkers,textClass:hr.textClass,bgClass:hr.bgClass,wrapClass:hr.wrapClass,widgets:hr.widgets}},addLineClass:db(function(ht,hs,hr){return fl(this,ht,hs=="gutter"?"gutter":"class",function(hu){var hv=hs=="text"?"textClass":hs=="background"?"bgClass":hs=="gutter"?"gutterClass":"wrapClass";if(!hu[hv]){hu[hv]=hr}else{if(ad(hr).test(hu[hv])){return false}else{hu[hv]+=" "+hr}}return true})}),removeLineClass:db(function(ht,hs,hr){return fl(this,ht,hs=="gutter"?"gutter":"class",function(hv){var hy=hs=="text"?"textClass":hs=="background"?"bgClass":hs=="gutter"?"gutterClass":"wrapClass";var hx=hv[hy];if(!hx){return false}else{if(hr==null){hv[hy]=null}else{var hw=hx.match(ad(hr));if(!hw){return false}var hu=hw.index+hw[0].length;hv[hy]=hx.slice(0,hw.index)+(!hw.index||hu==hx.length?"":" ")+hx.slice(hu)||null}}return true})}),addLineWidget:db(function(ht,hs,hr){return b4(this,ht,hs,hr)}),removeLineWidget:function(hr){hr.clear()},markText:function(ht,hs,hr){return fs(this,gF(this,ht),gF(this,hs),hr,hr&&hr.type||"range")},setBookmark:function(ht,hr){var hs={replacedWith:hr&&(hr.nodeType==null?hr.widget:hr),insertLeft:hr&&hr.insertLeft,clearWhenEmpty:false,shared:hr&&hr.shared,handleMouseEvents:hr&&hr.handleMouseEvents};ht=gF(this,ht);return fs(this,ht,ht,hs,"bookmark")},findMarksAt:function(hv){hv=gF(this,hv);var hu=[],hs=f7(this,hv.line).markedSpans;if(hs){for(var hr=0;hr<hs.length;++hr){var ht=hs[hr];if((ht.from==null||ht.from<=hv.ch)&&(ht.to==null||ht.to>=hv.ch)){hu.push(ht.marker.parent||ht.marker)}}}return hu},findMarks:function(hv,hu,hs){hv=gF(this,hv);hu=gF(this,hu);var ht=[],hr=hv.line;this.iter(hv.line,hu.line+1,function(hw){var hy=hw.markedSpans;if(hy){for(var hx=0;hx<hy.length;hx++){var hz=hy[hx];if(!(hz.to!=null&&hr==hv.line&&hv.ch>=hz.to||hz.from==null&&hr!=hv.line||hz.from!=null&&hr==hu.line&&hz.from>=hu.ch)&&(!hs||hs(hz.marker))){ht.push(hz.marker.parent||hz.marker)}}}++hr});return ht},getAllMarks:function(){var hr=[];this.iter(function(ht){var hs=ht.markedSpans;if(hs){for(var hu=0;hu<hs.length;++hu){if(hs[hu].from!=null){hr.push(hs[hu].marker)}}}});return hr},posFromIndex:function(hu){var hs,hr=this.first,ht=this.lineSeparator().length;this.iter(function(hv){var hw=hv.text.length+ht;if(hw>hu){hs=hu;return true}hu-=hw;++hr});return gF(this,ah(hr,hs))},indexFromPos:function(ht){ht=gF(this,ht);var hr=ht.ch;if(ht.line<this.first||ht.ch<0){return 0}var hs=this.lineSeparator().length;this.iter(this.first,ht.line,function(hu){hr+=hu.text.length+hs});return hr},copy:function(hr){var hs=new aI(bj(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);hs.scrollTop=this.scrollTop;hs.scrollLeft=this.scrollLeft;hs.sel=this.sel;hs.extend=false;if(hr){hs.history.undoDepth=this.history.undoDepth;hs.setHistory(this.getHistory())}return hs},linkedDoc:function(hr){if(!hr){hr={}}var hu=this.first,ht=this.first+this.size;if(hr.from!=null&&hr.from>hu){hu=hr.from}if(hr.to!=null&&hr.to<ht){ht=hr.to}var hs=new aI(bj(this,hu,ht),hr.mode||this.modeOption,hu,this.lineSep,this.direction);if(hr.sharedHist){hs.history=this.history}(this.linked||(this.linked=[])).push({doc:hs,sharedHist:hr.sharedHist});hs.linked=[{doc:this,isParent:true,sharedHist:hr.sharedHist}];eg(hs,fE(this));return hs},unlinkDoc:function(hs){var hv=this;if(hs instanceof R){hs=hs.doc}if(this.linked){for(var ht=0;ht<this.linked.length;++ht){var hu=hv.linked[ht];if(hu.doc!=hs){continue}hv.linked.splice(ht,1);hs.unlinkDoc(hv);e7(fE(hv));break}}if(hs.history==this.history){var hr=[hs.id];eN(hs,function(hw){return hr.push(hw.id)},true);hs.history=new gT(null);hs.history.done=ce(this.history.done,hr);hs.history.undone=ce(this.history.undone,hr)}},iterLinkedDocs:function(hr){eN(this,hr)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(hr){if(this.lineSep){return hr.split(this.lineSep)}return gQ(hr)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:db(function(hr){if(hr!="rtl"){hr="ltr"}if(hr==this.direction){return}this.direction=hr;this.iter(function(hs){return hs.order=null});if(this.cm){eE(this.cm)}})});aI.prototype.eachLine=aI.prototype.iter;var au=0;function bB(hz){var hB=this;dN(hB);if(a8(hB,hz)||bs(hB.display,hz)){return}dd(hz);if(em){au=+new Date}var hA=cU(hB,hz,true),hs=hz.dataTransfer.files;if(!hA||hB.isReadOnly()){return}if(hs&&hs.length&&window.FileReader&&window.File){var hv=hs.length,hC=Array(hv),ht=0;var hx=function(hF,hE){if(hB.options.allowDropFileTypes&&dV(hB.options.allowDropFileTypes,hF.type)==-1){return}var hD=new FileReader;hD.onload=dA(hB,function(){var hG=hD.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(hG)){hG=""}hC[hE]=hG;if(++ht==hv){hA=gF(hB.doc,hA);var hH={from:hA,to:hA,text:hB.doc.splitLines(hC.join(hB.doc.lineSeparator())),origin:"paste"};bx(hB.doc,hH);f0(hB.doc,fH(hA,dw(hH)))}});hD.readAsText(hF)};for(var hy=0;hy<hv;++hy){hx(hs[hy],hy)}}else{if(hB.state.draggingText&&hB.doc.sel.contains(hA)>-1){hB.state.draggingText(hz);setTimeout(function(){return hB.display.input.focus()},20);return}try{var hr=hz.dataTransfer.getData("Text");if(hr){var hw;if(hB.state.draggingText&&!hB.state.draggingText.copy){hw=hB.listSelections()}e8(hB.doc,fH(hA,hA));if(hw){for(var hu=0;hu<hw.length;++hu){bi(hB.doc,"",hw[hu].anchor,hw[hu].head,"drag")}}hB.replaceSelection(hr,"around","paste");hB.display.input.focus()}}catch(hz){}}}function aa(hr,ht){if(em&&(!hr.state.draggingText||+new Date-au<100)){fa(ht);return}if(a8(hr,ht)||bs(hr.display,ht)){return}ht.dataTransfer.setData("Text",hr.getSelection());ht.dataTransfer.effectAllowed="copyMove";if(ht.dataTransfer.setDragImage&&!aR){var hs=g7("img",null,null,"position: fixed; left: 0; top: 0;");hs.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if(eI){hs.width=hs.height=1;hr.display.wrapper.appendChild(hs);hs._top=hs.offsetTop}ht.dataTransfer.setDragImage(hs,0,0);if(eI){hs.parentNode.removeChild(hs)}}}function ho(hr,hs){var hu=cU(hr,hs);if(!hu){return}var ht=document.createDocumentFragment();J(hr,hu,ht);if(!hr.display.dragCursor){hr.display.dragCursor=g7("div",null,"CodeMirror-cursors CodeMirror-dragcursors");hr.display.lineSpace.insertBefore(hr.display.dragCursor,hr.display.cursorDiv)}ci(hr.display.dragCursor,ht)}function dN(hr){if(hr.display.dragCursor){hr.display.lineSpace.removeChild(hr.display.dragCursor);hr.display.dragCursor=null}}function aP(hv){if(!document.getElementsByClassName){return}var hu=document.getElementsByClassName("CodeMirror"),ht=[];for(var hs=0;hs<hu.length;hs++){var hr=hu[hs].CodeMirror;if(hr){ht.push(hr)}}if(ht.length){ht[0].operation(function(){for(var hw=0;hw<ht.length;hw++){hv(ht[hw])}})}}var da=false;function bA(){if(da){return}gy();da=true}function gy(){var hr;cn(window,"resize",function(){if(hr==null){hr=setTimeout(function(){hr=null;aP(ba)},100)}});cn(window,"blur",function(){return aP(bc)})}function ba(hr){var hs=hr.display;hs.cachedCharWidth=hs.cachedTextHeight=hs.cachedPaddingH=null;hs.scrollbarsClipped=false;hr.setSize()}var f8={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};for(var go=0;go<10;go++){f8[go+48]=f8[go+96]=String(go)}for(var gS=65;gS<=90;gS++){f8[gS]=String.fromCharCode(gS)}for(var gR=1;gR<=12;gR++){f8[gR+111]=f8[gR+63235]="F"+gR}var f3={};f3.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"};f3.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"};f3.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"};f3.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]};f3["default"]=cy?f3.macDefault:f3.pcDefault;function d6(hs){var hy=hs.split(/-(?!$)/);hs=hy[hy.length-1];var hx,hw,hr,hv;for(var hu=0;hu<hy.length-1;hu++){var ht=hy[hu];if(/^(cmd|meta|m)$/i.test(ht)){hv=true}else{if(/^a(lt)?$/i.test(ht)){hx=true}else{if(/^(c|ctrl|control)$/i.test(ht)){hw=true}else{if(/^s(hift)?$/i.test(ht)){hr=true}else{throw new Error("Unrecognized modifier name: "+ht)}}}}}if(hx){hs="Alt-"+hs}if(hw){hs="Ctrl-"+hs}if(hv){hs="Cmd-"+hs}if(hr){hs="Shift-"+hs}return hs}function de(hy){var hs={};for(var hx in hy){if(hy.hasOwnProperty(hx)){var hz=hy[hx];if(/^(name|fallthrough|(de|at)tach)$/.test(hx)){continue}if(hz=="..."){delete hy[hx];continue}var hA=cj(hx.split(" "),d6);for(var hw=0;hw<hA.length;hw++){var hu=(void 0),ht=(void 0);if(hw==hA.length-1){ht=hA.join(" ");hu=hz}else{ht=hA.slice(0,hw+1).join(" ");hu="..."}var hv=hs[ht];if(!hv){hs[ht]=hu}else{if(hv!=hu){throw new Error("Inconsistent bindings for "+ht)}}}delete hy[hx]}}for(var hr in hs){hy[hr]=hs[hr]}return hy}function m(hu,hv,hx,ht){hv=gY(hv);var hw=hv.call?hv.call(hu,ht):hv[hu];if(hw===false){return"nothing"}if(hw==="..."){return"multi"}if(hw!=null&&hx(hw)){return"handled"}if(hv.fallthrough){if(Object.prototype.toString.call(hv.fallthrough)!="[object Array]"){return m(hu,hv.fallthrough,hx,ht)}for(var hs=0;hs<hv.fallthrough.length;hs++){var hr=m(hu,hv.fallthrough[hs],hx,ht);if(hr){return hr}}}}function fm(hs){var hr=typeof hs=="string"?hs:f8[hs.keyCode];return hr=="Ctrl"||hr=="Alt"||hr=="Shift"||hr=="Mod"}function g1(hr,hs,hu){var ht=hr;if(hs.altKey&&ht!="Alt"){hr="Alt-"+hr}if((cg?hs.metaKey:hs.ctrlKey)&&ht!="Ctrl"){hr="Ctrl-"+hr}if((cg?hs.ctrlKey:hs.metaKey)&&ht!="Cmd"){hr="Cmd-"+hr}if(!hu&&hs.shiftKey&&ht!="Shift"){hr="Shift-"+hr}return hr}function gi(hs,ht){if(eI&&hs.keyCode==34&&hs["char"]){return false}var hr=f8[hs.keyCode];if(hr==null||hs.altGraphKey){return false}if(hs.keyCode==3&&hs.code){hr=hs.code}return g1(hr,hs,ht)}function gY(hr){return typeof hr=="string"?f3[hr]:hr}function fP(hr,hx){var hs=hr.doc.sel.ranges,hv=[];for(var hu=0;hu<hs.length;hu++){var ht=hx(hs[hu]);while(hv.length&&cJ(ht.from,gA(hv).to)<=0){var hw=hv.pop();if(cJ(hw.from,ht.from)<0){ht.from=hw.from;break}}hv.push(ht)}dl(hr,function(){for(var hy=hv.length-1;hy>=0;hy--){bi(hr.doc,"",hv[hy].from,hv[hy].to,"+delete")}gz(hr)})}function bL(hr,ht,hs){var hu=e1(hr.text,ht+hs,hs);return hu<0||hu>hr.text.length?null:hu}function aw(hr,hu,hs){var ht=bL(hr,hu.ch,hs);return ht==null?null:new ah(hu.line,ht,hs<0?"after":"before")}function fk(hs,hA,hx,hw,hu){if(hs){var hv=a(hx,hA.doc.direction);if(hv){var ht=hu<0?gA(hv):hv[0];var hC=(hu<0)==(ht.level==1);var hz=hC?"after":"before";var hr;if(ht.level>0||hA.doc.direction=="rtl"){var hy=bm(hA,hx);hr=hu<0?hx.text.length-1:0;var hB=M(hA,hy,hr).top;hr=cT(function(hD){return M(hA,hy,hD).top==hB},(hu<0)==(ht.level==1)?ht.from:ht.to-1,hr);if(hz=="before"){hr=bL(hx,hr,1)}}else{hr=hu<0?ht.to:ht.from}return new ah(hw,hr,hz)}}return new ah(hw,hu<0?hx.text.length:0,hu<0?"before":"after")}function C(hC,hH,hv,hy){var hE=a(hH,hC.doc.direction);if(!hE){return aw(hH,hv,hy)}if(hv.ch>=hH.text.length){hv.ch=hH.text.length;hv.sticky="before"}else{if(hv.ch<=0){hv.ch=0;hv.sticky="after"}}var hu=aX(hE,hv.ch,hv.sticky),hw=hE[hu];if(hC.doc.direction=="ltr"&&hw.level%2==0&&(hy>0?hw.to>hv.ch:hw.from<hv.ch)){return aw(hH,hv,hy)}var hF=function(hJ,hI){return bL(hH,hJ instanceof ah?hJ.ch:hJ,hI)};var hz;var hD=function(hI){if(!hC.options.lineWrapping){return{begin:0,end:hH.text.length}}hz=hz||bm(hC,hH);return bF(hC,hH,hz,hI)};var hx=hD(hv.sticky=="before"?hF(hv,-1):hv.ch);if(hC.doc.direction=="rtl"||hw.level==1){var hG=(hw.level==1)==(hy<0);var hs=hF(hv,hG?1:-1);if(hs!=null&&(!hG?hs>=hw.from&&hs>=hx.begin:hs<=hw.to&&hs<=hx.end)){var hB=hG?"before":"after";return new ah(hv.line,hs,hB)}}var ht=function(hI,hL,hO){var hK=function(hQ,hP){return hP?new ah(hv.line,hF(hQ,1),"before"):new ah(hv.line,hQ,"after")};for(;hI>=0&&hI<hE.length;hI+=hL){var hJ=hE[hI];var hM=(hL>0)==(hJ.level!=1);var hN=hM?hO.begin:hF(hO.end,-1);if(hJ.from<=hN&&hN<hJ.to){return hK(hN,hM)}hN=hM?hJ.from:hF(hJ.to,-1);if(hO.begin<=hN&&hN<hO.end){return hK(hN,hM)}}};var hA=ht(hu+hy,hy,hx);if(hA){return hA}var hr=hy>0?hx.end:hF(hx.begin,-1);if(hr!=null&&!(hy>0&&hr==hH.text.length)){hA=ht(hy>0?0:hE.length-1,hy,hD(hr));if(hA){return hA}}return null}var fp={selectAll:aA,singleSelection:function(hr){return hr.setSelection(hr.getCursor("anchor"),hr.getCursor("head"),am)},killLine:function(hr){return fP(hr,function(ht){if(ht.empty()){var hs=f7(hr.doc,ht.head.line).text.length;if(ht.head.ch==hs&&ht.head.line<hr.lastLine()){return{from:ht.head,to:ah(ht.head.line+1,0)}}else{return{from:ht.head,to:ah(ht.head.line,hs)}}}else{return{from:ht.from(),to:ht.to()}}})},deleteLine:function(hr){return fP(hr,function(hs){return({from:ah(hs.from().line,0),to:gF(hr.doc,ah(hs.to().line+1,0))})})},delLineLeft:function(hr){return fP(hr,function(hs){return({from:ah(hs.from().line,0),to:hs.from()})})},delWrappedLineLeft:function(hr){return fP(hr,function(hs){var hu=hr.charCoords(hs.head,"div").top+5;var ht=hr.coordsChar({left:0,top:hu},"div");return{from:ht,to:hs.from()}})},delWrappedLineRight:function(hr){return fP(hr,function(hs){var hu=hr.charCoords(hs.head,"div").top+5;var ht=hr.coordsChar({left:hr.display.lineDiv.offsetWidth+100,top:hu},"div");return{from:hs.from(),to:ht}})},undo:function(hr){return hr.undo()},redo:function(hr){return hr.redo()},undoSelection:function(hr){return hr.undoSelection()},redoSelection:function(hr){return hr.redoSelection()},goDocStart:function(hr){return hr.extendSelection(ah(hr.firstLine(),0))},goDocEnd:function(hr){return hr.extendSelection(ah(hr.lastLine()))},goLineStart:function(hr){return hr.extendSelectionsBy(function(hs){return bQ(hr,hs.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(hr){return hr.extendSelectionsBy(function(hs){return ej(hr,hs.head)},{origin:"+move",bias:1})},goLineEnd:function(hr){return hr.extendSelectionsBy(function(hs){return es(hr,hs.head.line)},{origin:"+move",bias:-1})},goLineRight:function(hr){return hr.extendSelectionsBy(function(hs){var ht=hr.cursorCoords(hs.head,"div").top+5;return hr.coordsChar({left:hr.display.lineDiv.offsetWidth+100,top:ht},"div")},dv)},goLineLeft:function(hr){return hr.extendSelectionsBy(function(hs){var ht=hr.cursorCoords(hs.head,"div").top+5;return hr.coordsChar({left:0,top:ht},"div")},dv)},goLineLeftSmart:function(hr){return hr.extendSelectionsBy(function(hs){var ht=hr.cursorCoords(hs.head,"div").top+5;var hu=hr.coordsChar({left:0,top:ht},"div");if(hu.ch<hr.getLine(hu.line).search(/\S/)){return ej(hr,hs.head)}return hu},dv)},goLineUp:function(hr){return hr.moveV(-1,"line")},goLineDown:function(hr){return hr.moveV(1,"line")},goPageUp:function(hr){return hr.moveV(-1,"page")},goPageDown:function(hr){return hr.moveV(1,"page")},goCharLeft:function(hr){return hr.moveH(-1,"char")},goCharRight:function(hr){return hr.moveH(1,"char")},goColumnLeft:function(hr){return hr.moveH(-1,"column")},goColumnRight:function(hr){return hr.moveH(1,"column")},goWordLeft:function(hr){return hr.moveH(-1,"word")},goGroupRight:function(hr){return hr.moveH(1,"group")},goGroupLeft:function(hr){return hr.moveH(-1,"group")},goWordRight:function(hr){return hr.moveH(1,"word")},delCharBefore:function(hr){return hr.deleteH(-1,"char")},delCharAfter:function(hr){return hr.deleteH(1,"char")},delWordBefore:function(hr){return hr.deleteH(-1,"word")},delWordAfter:function(hr){return hr.deleteH(1,"word")},delGroupBefore:function(hr){return hr.deleteH(-1,"group")},delGroupAfter:function(hr){return hr.deleteH(1,"group")},indentAuto:function(hr){return hr.indentSelection("smart")},indentMore:function(hr){return hr.indentSelection("add")},indentLess:function(hr){return hr.indentSelection("subtract")},insertTab:function(hr){return hr.replaceSelection("\t")},insertSoftTab:function(hr){var ht=[],hs=hr.listSelections(),hw=hr.options.tabSize;for(var hv=0;hv<hs.length;hv++){var hx=hs[hv].from();var hu=ch(hr.getLine(hx.line),hx.ch,hw);ht.push(cW(hw-hu%hw))}hr.replaceSelections(ht)},defaultTab:function(hr){if(hr.somethingSelected()){hr.indentSelection("add")}else{hr.execCommand("insertTab")}},transposeChars:function(hr){return dl(hr,function(){var hu=hr.listSelections(),ht=[];for(var hv=0;hv<hu.length;hv++){if(!hu[hv].empty()){continue}var hx=hu[hv].head,hs=f7(hr.doc,hx.line).text;if(hs){if(hx.ch==hs.length){hx=new ah(hx.line,hx.ch-1)}if(hx.ch>0){hx=new ah(hx.line,hx.ch+1);hr.replaceRange(hs.charAt(hx.ch-1)+hs.charAt(hx.ch-2),ah(hx.line,hx.ch-2),hx,"+transpose")}else{if(hx.line>hr.doc.first){var hw=f7(hr.doc,hx.line-1).text;if(hw){hx=new ah(hx.line,1);hr.replaceRange(hs.charAt(0)+hr.doc.lineSeparator()+hw.charAt(hw.length-1),ah(hx.line-1,hw.length-1),hx,"+transpose")}}}}ht.push(new eB(hx,hx))}hr.setSelections(ht)})},newlineAndIndent:function(hr){return dl(hr,function(){var hs=hr.listSelections();for(var ht=hs.length-1;ht>=0;ht--){hr.replaceRange(hr.doc.lineSeparator(),hs[ht].anchor,hs[ht].head,"+input")}hs=hr.listSelections();for(var hu=0;hu<hs.length;hu++){hr.indentLine(hs[hu].from().line,null,true)}gz(hr)})},openLine:function(hr){return hr.replaceSelection("\n","start")},toggleOverwrite:function(hr){return hr.toggleOverwrite()}};function bQ(hr,ht){var hs=f7(hr.doc,ht);var hu=G(hs);if(hu!=hs){ht=cc(hu)}return fk(true,hr,hu,ht,1)}function es(hr,ht){var hs=f7(hr.doc,ht);var hu=cP(hs);if(hu!=hs){ht=cc(hu)}return fk(true,hr,hs,ht,-1)}function ej(hs,hx){var hw=bQ(hs,hx.line);var ht=f7(hs.doc,hw.line);var hr=a(ht,hs.doc.direction);if(!hr||hr[0].level==0){var hv=Math.max(0,ht.text.search(/\S/));var hu=hx.line==hw.line&&hx.ch<=hv&&hx.ch;return ah(hw.line,hu?0:hv,hw.sticky)}return hw}function gP(hs,hv,hr){if(typeof hv=="string"){hv=fp[hv];if(!hv){return false}}hs.display.input.ensurePolled();var hu=hs.display.shift,ht=false;try{if(hs.isReadOnly()){hs.state.suppressEdits=true}if(hr){hs.display.shift=false}ht=hv(hs)!=cD}finally{hs.display.shift=hu;hs.state.suppressEdits=false}return ht}function eO(hs,ht,hv){for(var hu=0;hu<hs.state.keyMaps.length;hu++){var hr=m(ht,hs.state.keyMaps[hu],hv,hs);if(hr){return hr}}return(hs.options.extraKeys&&m(ht,hs.options.extraKeys,hv,hs))||m(ht,hs.options.keyMap,hv,hs)}var eo=new hq;function bu(hr,ht,hv,hu){var hs=hr.state.keySeq;if(hs){if(fm(ht)){return"handled"}if(/\'$/.test(ht)){hr.state.keySeq=null}else{eo.set(50,function(){if(hr.state.keySeq==hs){hr.state.keySeq=null;hr.display.input.reset()}})}if(cN(hr,hs+" "+ht,hv,hu)){return true}}return cN(hr,ht,hv,hu)}function cN(hs,ht,hv,hu){var hr=eO(hs,ht,hu);if(hr=="multi"){hs.state.keySeq=ht}if(hr=="handled"){ar(hs,"keyHandled",hs,ht,hv)}if(hr=="handled"||hr=="multi"){dd(hv);u(hs)}return !!hr}function ga(hr,ht){var hs=gi(ht,true);if(!hs){return false}if(ht.shiftKey&&!hr.state.keySeq){return bu(hr,"Shift-"+hs,ht,function(hu){return gP(hr,hu,true)})||bu(hr,hs,ht,function(hu){if(typeof hu=="string"?/^go[A-Z]/.test(hu):hu.motion){return gP(hr,hu)}})}else{return bu(hr,hs,ht,function(hu){return gP(hr,hu)})}}function eZ(hr,ht,hs){return bu(hr,"'"+hs+"'",ht,function(hu){return gP(hr,hu,true)})}var d1=null;function w(hu){var hr=this;hr.curOp.focus=eq();if(a8(hr,hu)){return}if(em&&o<11&&hu.keyCode==27){hu.returnValue=false}var hs=hu.keyCode;hr.display.shift=hs==16||hu.shiftKey;var ht=ga(hr,hu);if(eI){d1=ht?hs:null;if(!ht&&hs==88&&!dM&&(cy?hu.metaKey:hu.ctrlKey)){hr.replaceSelection("",null,"cut")}}if(hs==18&&!/\bCodeMirror-crosshair\b/.test(hr.display.lineDiv.className)){aH(hr)}}function aH(hs){var ht=hs.display.lineDiv;gu(ht,"CodeMirror-crosshair");function hr(hu){if(hu.keyCode==18||!hu.altKey){j(ht,"CodeMirror-crosshair");eW(document,"keyup",hr);eW(document,"mouseover",hr)}}cn(document,"keyup",hr);cn(document,"mouseover",hr)}function by(hr){if(hr.keyCode==16){this.doc.sel.shift=false}a8(this,hr)}function c4(hv){var hr=this;if(bs(hr.display,hv)||a8(hr,hv)||hv.ctrlKey&&!hv.altKey||cy&&hv.metaKey){return}var hu=hv.keyCode,hs=hv.charCode;if(eI&&hu==d1){d1=null;dd(hv);return}if((eI&&(!hv.which||hv.which<10))&&ga(hr,hv)){return}var ht=String.fromCharCode(hs==null?hu:hs);if(ht=="\x08"){return}if(eZ(hr,hv,ht)){return}hr.display.input.onKeyPress(hv)}var dF=400;var dZ=function(hs,ht,hr){this.time=hs;this.pos=ht;this.button=hr};dZ.prototype.compare=function(hs,ht,hr){return this.time+dF>hs&&cJ(ht,this.pos)==0&&hr==this.button};var d0,dQ;function P(ht,hs){var hr=+new Date;if(dQ&&dQ.compare(hr,ht,hs)){d0=dQ=null;return"triple"}else{if(d0&&d0.compare(hr,ht,hs)){dQ=new dZ(hr,ht,hs);d0=null;return"double"}else{d0=new dZ(hr,ht,hs);dQ=null;return"single"}}}function fe(hv){var hr=this,hu=hr.display;if(a8(hr,hv)||hu.activeTouch&&hu.input.supportsTouch()){return}hu.input.ensurePolled();hu.shift=hv.shiftKey;if(bs(hu,hv)){if(!dz){hu.scroller.draggable=false;setTimeout(function(){return hu.scroller.draggable=true},100)}return}if(q(hr,hv)){return}var hw=cU(hr,hv),hs=gL(hv),ht=hw?P(hw,hs):"single";window.focus();if(hs==1&&hr.state.selectingText){hr.state.selectingText(hv)}if(hw&&dj(hr,hs,hw,ht,hv)){return}if(hs==1){if(hw){aL(hr,hw,ht,hv)}else{if(W(hv)==hu.scroller){dd(hv)}}}else{if(hs==2){if(hw){gZ(hr.doc,hw)}setTimeout(function(){return hu.input.focus()},20)}else{if(hs==3){if(hg){hr.display.input.onContextMenu(hv)}else{ay(hr)}}}}}function dj(hr,ht,hw,hv,hu){var hs="Click";if(hv=="double"){hs="Double"+hs}else{if(hv=="triple"){hs="Triple"+hs}}hs=(ht==1?"Left":ht==2?"Middle":"Right")+hs;return bu(hr,g1(hs,hu),hu,function(hy){if(typeof hy=="string"){hy=fp[hy]}if(!hy){return false}var hx=false;try{if(hr.isReadOnly()){hr.state.suppressEdits=true}hx=hy(hr,hw)!=cD}finally{hr.state.suppressEdits=false}return hx})}function b7(hr,hw,hu){var hs=hr.getOption("configureMouse");var hv=hs?hs(hr,hw,hu):{};if(hv.unit==null){var ht=gE?hu.shiftKey&&hu.metaKey:hu.altKey;hv.unit=ht?"rectangle":hw=="single"?"char":hw=="double"?"word":"line"}if(hv.extend==null||hr.doc.extend){hv.extend=hr.doc.extend||hu.shiftKey}if(hv.addNew==null){hv.addNew=cy?hu.metaKey:hu.ctrlKey}if(hv.moveOnDrag==null){hv.moveOnDrag=!(cy?hu.altKey:hu.ctrlKey)}return hv}function aL(hr,hx,hw,hu){if(em){setTimeout(c2(A,hr),0)}else{hr.curOp.focus=eq()}var ht=b7(hr,hw,hu);var hv=hr.doc.sel,hs;if(hr.options.dragDrop&&fA&&!hr.isReadOnly()&&hw=="single"&&(hs=hv.contains(hx))>-1&&(cJ((hs=hv.ranges[hs]).from(),hx)<0||hx.xRel>0)&&(cJ(hs.to(),hx)>0||hx.xRel<0)){bk(hr,hu,hx,ht)}else{r(hr,hu,hx,ht)}}function bk(hy,hr,hv,hs){var hu=hy.display,hw=false;var ht=dA(hy,function(hA){if(dz){hu.scroller.draggable=false}hy.state.draggingText=false;eW(hu.wrapper.ownerDocument,"mouseup",ht);eW(hu.wrapper.ownerDocument,"mousemove",hz);eW(hu.scroller,"dragstart",hx);eW(hu.scroller,"drop",ht);if(!hw){dd(hA);if(!hs.addNew){gZ(hy.doc,hv,null,null,hs.extend)}if(dz||em&&o==9){setTimeout(function(){hu.wrapper.ownerDocument.body.focus();hu.input.focus()},20)}else{hu.input.focus()}}});var hz=function(hA){hw=hw||Math.abs(hr.clientX-hA.clientX)+Math.abs(hr.clientY-hA.clientY)>=10};var hx=function(){return hw=true};if(dz){hu.scroller.draggable=true}hy.state.draggingText=ht;ht.copy=!hs.moveOnDrag;if(hu.scroller.dragDrop){hu.scroller.dragDrop()}cn(hu.wrapper.ownerDocument,"mouseup",ht);cn(hu.wrapper.ownerDocument,"mousemove",hz);cn(hu.scroller,"dragstart",hx);cn(hu.scroller,"drop",ht);ay(hy);setTimeout(function(){return hu.input.focus()},20)}function ew(hs,hu,ht){if(ht=="char"){return new eB(hu,hu)}if(ht=="word"){return hs.findWordAt(hu)}if(ht=="line"){return new eB(ah(hu.line,0),gF(hs.doc,ah(hu.line+1,0)))}var hr=ht(hs,hu);return new eB(hr.from,hr.to)}function r(hv,hG,ht,hz){var hF=hv.display,hJ=hv.doc;dd(hG);var hs,hI,hw=hJ.sel,hr=hw.ranges;if(hz.addNew&&!hz.extend){hI=hJ.sel.contains(ht);if(hI>-1){hs=hr[hI]}else{hs=new eB(ht,ht)}}else{hs=hJ.sel.primary();hI=hJ.sel.primIndex}if(hz.unit=="rectangle"){if(!hz.addNew){hs=new eB(ht,ht)}ht=cU(hv,hG,true,true);hI=-1}else{var hu=ew(hv,ht,hz.unit);if(hz.extend){hs=gm(hs,hu.anchor,hu.head,hz.extend)}else{hs=hu}}if(!hz.addNew){hI=0;ck(hJ,new g6([hs],0),X);hw=hJ.sel}else{if(hI==-1){hI=hr.length;ck(hJ,c3(hv,hr.concat([hs]),hI),{scroll:false,origin:"*mouse"})}else{if(hr.length>1&&hr[hI].empty()&&hz.unit=="char"&&!hz.extend){ck(hJ,c3(hv,hr.slice(0,hI).concat(hr.slice(hI+1)),0),{scroll:false,origin:"*mouse"});hw=hJ.sel}else{e(hJ,hI,hs,X)}}}var hE=ht;function hD(hU){if(cJ(hE,hU)==0){return}hE=hU;if(hz.unit=="rectangle"){var hM=[],hR=hv.options.tabSize;var hL=ch(f7(hJ,ht.line).text,ht.ch,hR);var hY=ch(f7(hJ,hU.line).text,hU.ch,hR);var hN=Math.min(hL,hY),hW=Math.max(hL,hY);for(var hZ=Math.min(ht.line,hU.line),hP=Math.min(hv.lastLine(),Math.max(ht.line,hU.line));hZ<=hP;hZ++){var hX=f7(hJ,hZ).text,hO=e9(hX,hN,hR);if(hN==hW){hM.push(new eB(ah(hZ,hO),ah(hZ,hO)))}else{if(hX.length>hO){hM.push(new eB(ah(hZ,hO),ah(hZ,e9(hX,hW,hR))))}}}if(!hM.length){hM.push(new eB(ht,ht))}ck(hJ,c3(hv,hw.ranges.slice(0,hI).concat(hM),hI),{origin:"*mouse",scroll:false});hv.scrollIntoView(hU)}else{var hS=hs;var hV=ew(hv,hU,hz.unit);var hQ=hS.anchor,hT;if(cJ(hV.anchor,hQ)>0){hT=hV.head;hQ=aG(hS.from(),hV.anchor)}else{hT=hV.anchor;hQ=bV(hS.to(),hV.head)}var hK=hw.ranges.slice(0);hK[hI]=az(hv,new eB(gF(hJ,hQ),hT));ck(hJ,c3(hv,hK,hI),X)}}var hB=hF.wrapper.getBoundingClientRect();var hx=0;function hH(hM){var hK=++hx;var hO=cU(hv,hM,true,hz.unit=="rectangle");if(!hO){return}if(cJ(hO,hE)!=0){hv.curOp.focus=eq();hD(hO);var hN=cx(hF,hJ);if(hO.line>=hN.to||hO.line<hN.from){setTimeout(dA(hv,function(){if(hx==hK){hH(hM)}}),150)}}else{var hL=hM.clientY<hB.top?-20:hM.clientY>hB.bottom?20:0;if(hL){setTimeout(dA(hv,function(){if(hx!=hK){return}hF.scroller.scrollTop+=hL;hH(hM)}),50)}}}function hA(hK){hv.state.selectingText=false;hx=Infinity;dd(hK);hF.input.focus();eW(hF.wrapper.ownerDocument,"mousemove",hC);eW(hF.wrapper.ownerDocument,"mouseup",hy);hJ.history.lastSelOrigin=null}var hC=dA(hv,function(hK){if(hK.buttons===0||!gL(hK)){hA(hK)}else{hH(hK)}});var hy=dA(hv,hA);hv.state.selectingText=hy;cn(hF.wrapper.ownerDocument,"mousemove",hC);cn(hF.wrapper.ownerDocument,"mouseup",hy)}function az(hF,hG){var hy=hG.anchor;var hC=hG.head;var hB=f7(hF.doc,hy.line);if(cJ(hy,hC)==0&&hy.sticky==hC.sticky){return hG}var hv=a(hB);if(!hv){return hG}var hA=aX(hv,hy.ch,hy.sticky),ht=hv[hA];if(ht.from!=hy.ch&&ht.to!=hy.ch){return hG}var hs=hA+((ht.from==hy.ch)==(ht.level!=1)?0:1);if(hs==0||hs==hv.length){return hG}var hz;if(hC.line!=hy.line){hz=(hC.line-hy.line)*(hF.doc.direction=="ltr"?1:-1)>0}else{var hx=aX(hv,hC.ch,hC.sticky);var hu=hx-hA||(hC.ch-hy.ch)*(ht.level==1?-1:1);if(hx==hs-1||hx==hs){hz=hu<0}else{hz=hu>0}}var hw=hv[hs+(hz?-1:0)];var hE=hz==(hw.level==1);var hr=hE?hw.from:hw.to,hD=hE?"after":"before";return hy.ch==hr&&hy.sticky==hD?hG:new eB(new ah(hy.line,hr,hD),hC)}function hp(hB,hx,hz,hA){var hs,hr;if(hx.touches){hs=hx.touches[0].clientX;hr=hx.touches[0].clientY}else{try{hs=hx.clientX;hr=hx.clientY}catch(hx){return false}}if(hs>=Math.floor(hB.display.gutters.getBoundingClientRect().right)){return false}if(hA){dd(hx)}var hy=hB.display;var hw=hy.lineDiv.getBoundingClientRect();if(hr>hw.bottom||!gc(hB,hz)){return ca(hx)}hr-=hw.top-hy.viewOffset;for(var hu=0;hu<hB.options.gutters.length;++hu){var hv=hy.gutters.childNodes[hu];if(hv&&hv.getBoundingClientRect().right>=hs){var hC=b5(hB.doc,hr);var ht=hB.options.gutters[hu];aT(hB,hz,hB,hC,ht,hx);return ca(hx)}}}function q(hr,hs){return hp(hr,hs,"gutterClick",true)}function aM(hr,hs){if(bs(hr.display,hs)||dT(hr,hs)){return}if(a8(hr,hs,"contextmenu")){return}if(!hg){hr.display.input.onContextMenu(hs)}}function dT(hr,hs){if(!gc(hr,"gutterContextMenu")){return false}return hp(hr,hs,"gutterContextMenu",false)}function dm(hr){hr.display.wrapper.className=hr.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+hr.options.theme.replace(/(^|\s)\s*/g," cm-s-");ax(hr)}var cE={toString:function(){return"CodeMirror.Init"}};var fU={};var bw={};function fu(hr){var ht=hr.optionHandlers;function hs(hu,hx,hw,hv){hr.defaults[hu]=hx;if(hw){ht[hu]=hv?function(hy,hA,hz){if(hz!=cE){hw(hy,hA,hz)}}:hw}}hr.defineOption=hs;hr.Init=cE;hs("value","",function(hu,hv){return hu.setValue(hv)},true);hs("mode",null,function(hu,hv){hu.doc.modeOption=hv;bO(hu)},true);hs("indentUnit",2,bO,true);hs("indentWithTabs",false);hs("smartIndent",true);hs("tabSize",4,function(hu){e4(hu);ax(hu);av(hu)},true);hs("lineSeparator",null,function(hu,hx){hu.doc.lineSep=hx;if(!hx){return}var hw=[],hy=hu.doc.first;hu.doc.iter(function(hz){for(var hB=0;;){var hA=hz.text.indexOf(hx,hB);if(hA==-1){break}hB=hA+hx.length;hw.push(ah(hy,hA))}hy++});for(var hv=hw.length-1;hv>=0;hv--){bi(hu.doc,hx,hw[hv],ah(hw[hv].line,hw[hv].ch+hx.length))}});hs("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff]/g,function(hu,hw,hv){hu.state.specialChars=new RegExp(hw.source+(hw.test("\t")?"":"|\t"),"g");if(hv!=cE){hu.refresh()}});hs("specialCharPlaceholder",f6,function(hu){return hu.refresh()},true);hs("electricChars",true);hs("inputStyle",eX?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},true);hs("spellcheck",false,function(hu,hv){return hu.getInputField().spellcheck=hv},true);hs("autocorrect",false,function(hu,hv){return hu.getInputField().autocorrect=hv},true);hs("autocapitalize",false,function(hu,hv){return hu.getInputField().autocapitalize=hv},true);hs("rtlMoveVisually",!a6);hs("wholeLineUpdateBefore",true);hs("theme","default",function(hu){dm(hu);d9(hu)},true);hs("keyMap","default",function(hu,hy,hv){var hw=gY(hy);var hx=hv!=cE&&gY(hv);if(hx&&hx.detach){hx.detach(hu,hw)}if(hw.attach){hw.attach(hu,hx||null)}});hs("extraKeys",null);hs("configureMouse",null);hs("lineWrapping",false,ft,true);hs("gutters",[],function(hu){cH(hu.options);d9(hu)},true);hs("fixedGutter",true,function(hu,hv){hu.display.gutters.style.left=hv?eC(hu.display)+"px":"0";hu.refresh()},true);hs("coverGutterNextToScrollbar",false,function(hu){return fQ(hu)},true);hs("scrollbarStyle","native",function(hu){aS(hu);fQ(hu);hu.display.scrollbars.setScrollTop(hu.doc.scrollTop);hu.display.scrollbars.setScrollLeft(hu.doc.scrollLeft)},true);hs("lineNumbers",false,function(hu){cH(hu.options);d9(hu)},true);hs("firstLineNumber",1,d9,true);hs("lineNumberFormatter",function(hu){return hu},d9,true);hs("showCursorWhenSelecting",false,b0,true);hs("resetSelectionOnContextMenu",true);hs("lineWiseCopyCut",true);hs("pasteLinesPerSelection",true);hs("selectionsMayTouch",false);hs("readOnly",false,function(hu,hv){if(hv=="nocursor"){bc(hu);hu.display.input.blur()}hu.display.input.readOnlyChanged(hv)});hs("disableInput",false,function(hu,hv){if(!hv){hu.display.input.reset()}},true);hs("dragDrop",true,g4);hs("allowDropFileTypes",null);hs("cursorBlinkRate",530);hs("cursorScrollMargin",0);hs("cursorHeight",1,b0,true);hs("singleCursorHeightPerLine",true,b0,true);hs("workTime",100);hs("workDelay",100);hs("flattenSpans",true,e4,true);hs("addModeClass",false,e4,true);hs("pollInterval",100);hs("undoDepth",200,function(hu,hv){return hu.doc.history.undoDepth=hv});hs("historyEventDelay",1250);hs("viewportMargin",10,function(hu){return hu.refresh()},true);hs("maxHighlightLength",10000,e4,true);hs("moveInputWithCursor",true,function(hu,hv){if(!hv){hu.display.input.resetPosition()}});hs("tabindex",null,function(hu,hv){return hu.display.input.getField().tabIndex=hv||""});hs("autofocus",null);hs("direction","ltr",function(hu,hv){return hu.doc.setDirection(hv)},true);hs("phrases",null)}function d9(hr){eT(hr);av(hr);fr(hr)}function g4(hs,hv,ht){var hw=ht&&ht!=cE;if(!hv!=!hw){var hu=hs.display.dragFunctions;var hr=hv?cn:eW;hr(hs.display.scroller,"dragstart",hu.start);hr(hs.display.scroller,"dragenter",hu.enter);hr(hs.display.scroller,"dragover",hu.over);hr(hs.display.scroller,"dragleave",hu.leave);hr(hs.display.scroller,"drop",hu.drop)}}function ft(hr){if(hr.options.lineWrapping){gu(hr.display.wrapper,"CodeMirror-wrap");hr.display.sizer.style.minWidth="";hr.display.sizerWidth=null}else{j(hr.display.wrapper,"CodeMirror-wrap");f(hr)}ak(hr);av(hr);ax(hr);setTimeout(function(){return fQ(hr)},100)}function R(hr,ht){var hy=this;if(!(this instanceof R)){return new R(hr,ht)}this.options=ht=ht?a4(ht):{};a4(fU,ht,false);cH(ht);var hx=ht.value;if(typeof hx=="string"){hx=new aI(hx,ht.mode,null,ht.lineSeparator,ht.direction)}else{if(ht.mode){hx.modeOption=ht.mode}}this.doc=hx;var hs=new R.inputStyles[ht.inputStyle](this);var hw=this.display=new fw(hr,hx,hs);hw.wrapper.CodeMirror=this;eT(this);dm(this);if(ht.lineWrapping){this.display.wrapper.className+=" CodeMirror-wrap"}aS(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:false,delayingBlurEvent:false,focused:false,suppressEdits:false,pasteIncoming:-1,cutIncoming:-1,selectingText:false,draggingText:false,highlight:new hq(),keySeq:null,specialChars:null};if(ht.autofocus&&!eX){hw.input.focus()}if(em&&o<11){setTimeout(function(){return hy.display.input.reset(true)},20)}gO(this);bA();dh(this);this.curOp.forceUpdate=true;eS(this,hx);if((ht.autofocus&&!eX)||this.hasFocus()){setTimeout(c2(c8,this),20)}else{bc(this)}for(var hv in bw){if(bw.hasOwnProperty(hv)){bw[hv](hy,ht[hv],cE)}}eL(this);if(ht.finishInit){ht.finishInit(this)}for(var hu=0;hu<bp.length;++hu){bp[hu](hy)}aB(this);if(dz&&ht.lineWrapping&&getComputedStyle(hw.lineDiv).textRendering=="optimizelegibility"){hw.lineDiv.style.textRendering="auto"}}R.defaults=fU;R.optionHandlers=bw;function gO(hs){var hw=hs.display;cn(hw.scroller,"mousedown",dA(hs,fe));if(em&&o<11){cn(hw.scroller,"dblclick",dA(hs,function(hA){if(a8(hs,hA)){return}var hB=cU(hs,hA);if(!hB||q(hs,hA)||bs(hs.display,hA)){return}dd(hA);var hz=hs.findWordAt(hB);gZ(hs.doc,hz.anchor,hz.head)}))}else{cn(hw.scroller,"dblclick",function(hz){return a8(hs,hz)||dd(hz)})}cn(hw.scroller,"contextmenu",function(hz){return aM(hs,hz)});var hy,hr={end:0};function hx(){if(hw.activeTouch){hy=setTimeout(function(){return hw.activeTouch=null},1000);hr=hw.activeTouch;hr.end=+new Date}}function hu(hz){if(hz.touches.length!=1){return false}var hA=hz.touches[0];return hA.radiusX<=1&&hA.radiusY<=1}function ht(hC,hz){if(hz.left==null){return true}var hB=hz.left-hC.left,hA=hz.top-hC.top;return hB*hB+hA*hA>20*20}cn(hw.scroller,"touchstart",function(hA){if(!a8(hs,hA)&&!hu(hA)&&!q(hs,hA)){hw.input.ensurePolled();clearTimeout(hy);var hz=+new Date;hw.activeTouch={start:hz,moved:false,prev:hz-hr.end<=300?hr:null};if(hA.touches.length==1){hw.activeTouch.left=hA.touches[0].pageX;hw.activeTouch.top=hA.touches[0].pageY}}});cn(hw.scroller,"touchmove",function(){if(hw.activeTouch){hw.activeTouch.moved=true}});cn(hw.scroller,"touchend",function(hA){var hC=hw.activeTouch;if(hC&&!bs(hw,hA)&&hC.left!=null&&!hC.moved&&new Date-hC.start<300){var hB=hs.coordsChar(hw.activeTouch,"page"),hz;if(!hC.prev||ht(hC,hC.prev)){hz=new eB(hB,hB)}else{if(!hC.prev.prev||ht(hC,hC.prev.prev)){hz=hs.findWordAt(hB)}else{hz=new eB(ah(hB.line,0),gF(hs.doc,ah(hB.line+1,0)))}}hs.setSelection(hz.anchor,hz.head);hs.focus();dd(hA)}hx()});cn(hw.scroller,"touchcancel",hx);cn(hw.scroller,"scroll",function(){if(hw.scroller.clientHeight){I(hs,hw.scroller.scrollTop);b2(hs,hw.scroller.scrollLeft,true);aT(hs,"scroll",hs)}});cn(hw.scroller,"mousewheel",function(hz){return c(hs,hz)});cn(hw.scroller,"DOMMouseScroll",function(hz){return c(hs,hz)});cn(hw.wrapper,"scroll",function(){return hw.wrapper.scrollTop=hw.wrapper.scrollLeft=0});hw.dragFunctions={enter:function(hz){if(!a8(hs,hz)){fa(hz)}},over:function(hz){if(!a8(hs,hz)){ho(hs,hz);fa(hz)}},start:function(hz){return aa(hs,hz)},drop:dA(hs,bB),leave:function(hz){if(!a8(hs,hz)){dN(hs)}}};var hv=hw.input.getField();cn(hv,"keyup",function(hz){return by.call(hs,hz)});cn(hv,"keydown",dA(hs,w));cn(hv,"keypress",dA(hs,c4));cn(hv,"focus",function(hz){return c8(hs,hz)});cn(hv,"blur",function(hz){return bc(hs,hz)})}var bp=[];R.defineInitHook=function(hr){return bp.push(hr)};function ap(hG,hv,hF,ht){var hE=hG.doc,hs;if(hF==null){hF="add"}if(hF=="smart"){if(!hE.mode.indent){hF="prev"}else{hs=fO(hG,hv).state}}var hz=hG.options.tabSize;var hH=f7(hE,hv),hy=ch(hH.text,null,hz);if(hH.stateAfter){hH.stateAfter=null}var hr=hH.text.match(/^\s*/)[0],hC;if(!ht&&!/\S/.test(hH.text)){hC=0;hF="not"}else{if(hF=="smart"){hC=hE.mode.indent(hs,hH.text.slice(hr.length),hH.text);if(hC==cD||hC>150){if(!ht){return}hF="prev"}}}if(hF=="prev"){if(hv>hE.first){hC=ch(f7(hE,hv-1).text,null,hz)}else{hC=0}}else{if(hF=="add"){hC=hy+hG.options.indentUnit}else{if(hF=="subtract"){hC=hy-hG.options.indentUnit}else{if(typeof hF=="number"){hC=hy+hF}}}}hC=Math.max(0,hC);var hD="",hB=0;if(hG.options.indentWithTabs){for(var hw=Math.floor(hC/hz);hw;--hw){hB+=hz;hD+="\t"}}if(hB<hC){hD+=cW(hC-hB)}if(hD!=hr){bi(hE,hD,ah(hv,0),ah(hv,hr.length),"+input");hH.stateAfter=null;return true}else{for(var hu=0;hu<hE.sel.ranges.length;hu++){var hx=hE.sel.ranges[hu];if(hx.head.line==hv&&hx.head.ch<hr.length){var hA=ah(hv,hr.length);e(hE,hu,new eB(hA,hA));break}}}}var bD=null;function dG(hr){bD=hr}function g0(hF,hw,hu,ht,hE){var hD=hF.doc;hF.display.shift=false;if(!ht){ht=hD.sel}var hH=+new Date-200;var hv=hE=="paste"||hF.state.pasteIncoming>hH;var hy=gQ(hw),hr=null;if(hv&&ht.ranges.length>1){if(bD&&bD.text.join("\n")==hw){if(ht.ranges.length%bD.text.length==0){hr=[];for(var hx=0;hx<bD.text.length;hx++){hr.push(hD.splitLines(bD.text[hx]))}}}else{if(hy.length==ht.ranges.length&&hF.options.pasteLinesPerSelection){hr=cj(hy,function(hI){return[hI]})}}}var hz=hF.curOp.updateInput;for(var hs=ht.ranges.length-1;hs>=0;hs--){var hG=ht.ranges[hs];var hC=hG.from(),hB=hG.to();if(hG.empty()){if(hu&&hu>0){hC=ah(hC.line,hC.ch-hu)}else{if(hF.state.overwrite&&!hv){hB=ah(hB.line,Math.min(f7(hD,hB.line).text.length,hB.ch+gA(hy).length))}else{if(hv&&bD&&bD.lineWise&&bD.text.join("\n")==hw){hC=hB=ah(hC.line,0)}}}}var hA={from:hC,to:hB,text:hr?hr[hs%hr.length]:hy,origin:hE||(hv?"paste":hF.state.cutIncoming>hH?"cut":"+input")};bx(hF.doc,hA);ar(hF,"inputRead",hF,hA)}if(hw&&!hv){gW(hF,hw)}gz(hF);if(hF.curOp.updateInput<2){hF.curOp.updateInput=hz}hF.curOp.typing=true;hF.state.pasteIncoming=hF.state.cutIncoming=-1}function br(ht,hr){var hs=ht.clipboardData&&ht.clipboardData.getData("Text");if(hs){ht.preventDefault();if(!hr.isReadOnly()&&!hr.options.disableInput){dl(hr,function(){return g0(hr,hs,0,null,"paste")})}return true}}function gW(hr,hu){if(!hr.options.electricChars||!hr.options.smartIndent){return}var hv=hr.doc.sel;for(var ht=hv.ranges.length-1;ht>=0;ht--){var hx=hv.ranges[ht];if(hx.head.ch>100||(ht&&hv.ranges[ht-1].head.line==hx.head.line)){continue}var hw=hr.getModeAt(hx.head);var hy=false;if(hw.electricChars){for(var hs=0;hs<hw.electricChars.length;hs++){if(hu.indexOf(hw.electricChars.charAt(hs))>-1){hy=ap(hr,hx.head.line,"smart");break}}}else{if(hw.electricInput){if(hw.electricInput.test(f7(hr.doc,hx.head.line).text.slice(0,hx.head.ch))){hy=ap(hr,hx.head.line,"smart")}}}if(hy){ar(hr,"electricInput",hr,hx.head.line)}}}function dU(hr){var hw=[],ht=[];for(var hu=0;hu<hr.doc.sel.ranges.length;hu++){var hs=hr.doc.sel.ranges[hu].head.line;var hv={anchor:ah(hs,0),head:ah(hs+1,0)};ht.push(hv);hw.push(hr.getRange(hv.anchor,hv.head))}return{text:hw,ranges:ht}}function gM(hu,hs,hr,ht){hu.setAttribute("autocorrect",!!hr);hu.setAttribute("autocapitalize",!!ht);hu.setAttribute("spellcheck",!!hs)}function be(){var hr=g7("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none");var hs=g7("div",[hr],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");if(dz){hr.style.width="1000px"}else{hr.setAttribute("wrap","off")}if(fT){hr.style.border="1px solid black"}gM(hr);return hs}function er(hr){var hs=hr.optionHandlers;var ht=hr.helpers={};hr.prototype={constructor:hr,focus:function(){window.focus();this.display.input.focus()},setOption:function(hw,hx){var hv=this.options,hu=hv[hw];if(hv[hw]==hx&&hw!="mode"){return}hv[hw]=hx;if(hs.hasOwnProperty(hw)){dA(this,hs[hw])(this,hx,hu)}aT(this,"optionChange",this,hw)},getOption:function(hu){return this.options[hu]},getDoc:function(){return this.doc},addKeyMap:function(hv,hu){this.state.keyMaps[hu?"push":"unshift"](gY(hv))},removeKeyMap:function(hv){var hw=this.state.keyMaps;for(var hu=0;hu<hw.length;++hu){if(hw[hu]==hv||hw[hu].name==hv){hw.splice(hu,1);return true}}},addOverlay:dK(function(hu,hv){var hw=hu.token?hu:hr.getMode(this.options,hu);if(hw.startState){throw new Error("Overlays may not be stateful.")}cB(this.state.overlays,{mode:hw,modeSpec:hu,opaque:hv&&hv.opaque,priority:(hv&&hv.priority)||0},function(hx){return hx.priority});this.state.modeGen++;av(this)}),removeOverlay:dK(function(hu){var hy=this;var hw=this.state.overlays;for(var hv=0;hv<hw.length;++hv){var hx=hw[hv].modeSpec;if(hx==hu||typeof hu=="string"&&hx.name==hu){hw.splice(hv,1);hy.state.modeGen++;av(hy);return}}}),indentLine:dK(function(hw,hu,hv){if(typeof hu!="string"&&typeof hu!="number"){if(hu==null){hu=this.options.smartIndent?"smart":"prev"}else{hu=hu?"add":"subtract"}}if(cA(this.doc,hw)){ap(this,hw,hu,hv)}}),indentSelection:dK(function(hD){var hA=this;var hu=this.doc.sel.ranges,hx=-1;for(var hz=0;hz<hu.length;hz++){var hE=hu[hz];if(!hE.empty()){var hB=hE.from(),hC=hE.to();var hv=Math.max(hx,hB.line);hx=Math.min(hA.lastLine(),hC.line-(hC.ch?0:1))+1;for(var hy=hv;hy<hx;++hy){ap(hA,hy,hD)}var hw=hA.doc.sel.ranges;if(hB.ch==0&&hu.length==hw.length&&hw[hz].from().ch>0){e(hA.doc,hz,new eB(hB,hw[hz].to()),am)}}else{if(hE.head.line>hx){ap(hA,hE.head.line,hD,true);hx=hE.head.line;if(hz==hA.doc.sel.primIndex){gz(hA)}}}}}),getTokenAt:function(hv,hu){return cX(this,hv,hu)},getLineTokens:function(hv,hu){return cX(this,ah(hv),hu,true)},getTokenTypeAt:function(hB){hB=gF(this.doc,hB);var hx=dI(this,f7(this.doc,hB.line));var hz=0,hA=(hx.length-1)/2,hw=hB.ch;var hv;if(hw==0){hv=hx[2]}else{for(;;){var hu=(hz+hA)>>1;if((hu?hx[hu*2-1]:0)>=hw){hA=hu}else{if(hx[hu*2+1]<hw){hz=hu+1}else{hv=hx[hu*2+2];break}}}}var hy=hv?hv.indexOf("overlay "):-1;return hy<0?hv:hy==0?null:hv.slice(0,hy-1)},getModeAt:function(hv){var hu=this.doc.mode;if(!hu.innerMode){return hu}return hr.innerMode(hu,this.getTokenAt(hv).state).mode},getHelper:function(hv,hu){return this.getHelpers(hv,hu)[0]},getHelpers:function(hB,hA){var hy=this;var hD=[];if(!ht.hasOwnProperty(hA)){return hD}var hw=ht[hA],hz=this.getModeAt(hB);if(typeof hz[hA]=="string"){if(hw[hz[hA]]){hD.push(hw[hz[hA]])}}else{if(hz[hA]){for(var hx=0;hx<hz[hA].length;hx++){var hv=hw[hz[hA][hx]];if(hv){hD.push(hv)}}}else{if(hz.helperType&&hw[hz.helperType]){hD.push(hw[hz.helperType])}else{if(hw[hz.name]){hD.push(hw[hz.name])}}}}for(var hu=0;hu<hw._global.length;hu++){var hC=hw._global[hu];if(hC.pred(hz,hy)&&dV(hD,hC.val)==-1){hD.push(hC.val)}}return hD},getStateAfter:function(hv,hu){var hw=this.doc;hv=dE(hw,hv==null?hw.first+hw.size-1:hv);return fO(this,hv+1,hu).state},cursorCoords:function(hx,hv){var hw,hu=this.doc.sel.primary();if(hx==null){hw=hu.head}else{if(typeof hx=="object"){hw=gF(this.doc,hx)}else{hw=hx?hu.from():hu.to()}}return ey(this,hw,hv||"page")},charCoords:function(hv,hu){return di(this,gF(this.doc,hv),hu||"page")},coordsChar:function(hu,hv){hu=hm(this,hu,hv||"page");return gN(this,hu.left,hu.top)},lineAtHeight:function(hu,hv){hu=hm(this,{top:hu,left:0},hv||"page").top;return b5(this.doc,hu+this.display.viewOffset)},heightAtLine:function(hv,hz,hy){var hu=false,hw;if(typeof hv=="number"){var hx=this.doc.first+this.doc.size-1;if(hv<this.doc.first){hv=this.doc.first}else{if(hv>hx){hv=hx;hu=true}}hw=f7(this.doc,hv)}else{hw=hv}return fG(this,hw,{top:0,left:0},hz||"page",hy||hu).top+(hu?this.doc.height-cb(hw):0)},defaultTextHeight:function(){return bf(this.display)},defaultCharWidth:function(){return ee(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(hz,hw,hB,hx,hD){var hy=this.display;hz=ey(this,gF(this.doc,hz));var hA=hz.bottom,hv=hz.left;hw.style.position="absolute";hw.setAttribute("cm-ignore-events","true");this.display.input.setUneditable(hw);hy.sizer.appendChild(hw);if(hx=="over"){hA=hz.top}else{if(hx=="above"||hx=="near"){var hu=Math.max(hy.wrapper.clientHeight,this.doc.height),hC=Math.max(hy.sizer.clientWidth,hy.lineSpace.clientWidth);if((hx=="above"||hz.bottom+hw.offsetHeight>hu)&&hz.top>hw.offsetHeight){hA=hz.top-hw.offsetHeight}else{if(hz.bottom+hw.offsetHeight<=hu){hA=hz.bottom}}if(hv+hw.offsetWidth>hC){hv=hC-hw.offsetWidth}}}hw.style.top=hA+"px";hw.style.left=hw.style.right="";if(hD=="right"){hv=hy.sizer.clientWidth-hw.offsetWidth;hw.style.right="0px"}else{if(hD=="left"){hv=0}else{if(hD=="middle"){hv=(hy.sizer.clientWidth-hw.offsetWidth)/2}}hw.style.left=hv+"px"}if(hB){O(this,{left:hv,top:hA,right:hv+hw.offsetWidth,bottom:hA+hw.offsetHeight})}},triggerOnKeyDown:dK(w),triggerOnKeyPress:dK(c4),triggerOnKeyUp:by,triggerOnMouseDown:dK(fe),execCommand:function(hu){if(fp.hasOwnProperty(hu)){return fp[hu].call(null,this)}},triggerElectric:dK(function(hu){gW(this,hu)}),findPosH:function(hB,hx,hy,hv){var hA=this;var hu=1;if(hx<0){hu=-1;hx=-hx}var hz=gF(this.doc,hB);for(var hw=0;hw<hx;++hw){hz=bT(hA.doc,hz,hu,hy,hv);if(hz.hitSide){break}}return hz},moveH:dK(function(hu,hv){var hw=this;this.extendSelectionsBy(function(hx){if(hw.display.shift||hw.doc.extend||hx.empty()){return bT(hw.doc,hx.head,hu,hv,hw.options.rtlMoveVisually)}else{return hu<0?hx.from():hx.to()}},dv)}),deleteH:dK(function(hu,hv){var hw=this.doc.sel,hx=this.doc;if(hw.somethingSelected()){hx.replaceSelection("",null,"+delete")}else{fP(this,function(hz){var hy=bT(hx,hz.head,hu,hv,false);return hu<0?{from:hy,to:hz.head}:{from:hz.head,to:hy}})}}),findPosV:function(hA,hx,hB,hD){var hw=this;var hu=1,hz=hD;if(hx<0){hu=-1;hx=-hx}var hC=gF(this.doc,hA);for(var hv=0;hv<hx;++hv){var hy=ey(hw,hC,"div");if(hz==null){hz=hy.left}else{hy.left=hz}hC=bN(hw,hy,hu,hB);if(hC.hitSide){break}}return hC},moveV:dK(function(hu,hw){var hA=this;var hy=this.doc,hx=[];var hz=!this.display.shift&&!hy.extend&&hy.sel.somethingSelected();hy.extendSelectionsBy(function(hB){if(hz){return hu<0?hB.from():hB.to()}var hD=ey(hA,hB.head,"div");if(hB.goalColumn!=null){hD.left=hB.goalColumn}hx.push(hD.left);var hC=bN(hA,hD,hu,hw);if(hw=="page"&&hB==hy.sel.primary()){df(hA,di(hA,hC,"div").top-hD.top)}return hC},dv);if(hx.length){for(var hv=0;hv<hy.sel.ranges.length;hv++){hy.sel.ranges[hv].goalColumn=hx[hv]}}}),findWordAt:function(hB){var hz=this.doc,hx=f7(hz,hB.line).text;var hA=hB.ch,hw=hB.ch;if(hx){var hy=this.getHelper(hB,"wordChars");if((hB.sticky=="before"||hw==hx.length)&&hA){--hA}else{++hw}var hv=hx.charAt(hA);var hu=c7(hv,hy)?function(hC){return c7(hC,hy)}:/\s/.test(hv)?function(hC){return/\s/.test(hC)}:function(hC){return(!/\s/.test(hC)&&!c7(hC))};while(hA>0&&hu(hx.charAt(hA-1))){--hA}while(hw<hx.length&&hu(hx.charAt(hw))){++hw}}return new eB(ah(hB.line,hA),ah(hB.line,hw))},toggleOverwrite:function(hu){if(hu!=null&&hu==this.state.overwrite){return}if(this.state.overwrite=!this.state.overwrite){gu(this.display.cursorDiv,"CodeMirror-overwrite")}else{j(this.display.cursorDiv,"CodeMirror-overwrite")}aT(this,"overwriteToggle",this,this.state.overwrite)},hasFocus:function(){return this.display.input.getField()==eq()},isReadOnly:function(){return !!(this.options.readOnly||this.doc.cantEdit)},scrollTo:dK(function(hu,hv){fB(this,hu,hv)}),getScrollInfo:function(){var hu=this.display.scroller;return{left:hu.scrollLeft,top:hu.scrollTop,height:hu.scrollHeight-ds(this)-this.display.barHeight,width:hu.scrollWidth-ds(this)-this.display.barWidth,clientHeight:du(this),clientWidth:dY(this)}},scrollIntoView:dK(function(hv,hu){if(hv==null){hv={from:this.doc.sel.primary().head,to:null};if(hu==null){hu=this.options.cursorScrollMargin}}else{if(typeof hv=="number"){hv={from:ah(hv,0),to:null}}else{if(hv.from==null){hv={from:hv,to:null}}}}if(!hv.to){hv.to=hv.from}hv.margin=hu||0;if(hv.from.line!=null){cF(this,hv)}else{cf(this,hv.from,hv.to,hv.margin)}}),setSize:dK(function(hx,hu){var hy=this;var hw=function(hz){return typeof hz=="number"||/^\d+$/.test(String(hz))?hz+"px":hz};if(hx!=null){this.display.wrapper.style.width=hw(hx)}if(hu!=null){this.display.wrapper.style.height=hw(hu)}if(this.options.lineWrapping){a5(this)}var hv=this.display.viewFrom;this.doc.iter(hv,this.display.viewTo,function(hz){if(hz.widgets){for(var hA=0;hA<hz.widgets.length;hA++){if(hz.widgets[hA].noHScroll){ac(hy,hv,"widget");break}}}++hv});this.curOp.forceUpdate=true;aT(this,"refresh",this)}),operation:function(hu){return dl(this,hu)},startOperation:function(){return dh(this)},endOperation:function(){return aB(this)},refresh:dK(function(){var hu=this.display.cachedTextHeight;av(this);this.curOp.forceUpdate=true;ax(this);fB(this,this.doc.scrollLeft,this.doc.scrollTop);dD(this);if(hu==null||Math.abs(hu-bf(this.display))>0.5){ak(this)}aT(this,"refresh",this)}),swapDoc:dK(function(hv){var hu=this.doc;hu.cm=null;eS(this,hv);ax(this);this.display.input.reset();fB(this,hv.scrollLeft,hv.scrollTop);this.curOp.forceScroll=true;ar(this,"swapDoc",this,hu);return hu}),phrase:function(hv){var hu=this.options.phrases;return hu&&Object.prototype.hasOwnProperty.call(hu,hv)?hu[hv]:hv},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};bX(hr);hr.registerHelper=function(hv,hu,hw){if(!ht.hasOwnProperty(hv)){ht[hv]=hr[hv]={_global:[]}}ht[hv][hu]=hw};hr.registerGlobalHelper=function(hw,hv,hu,hx){hr.registerHelper(hw,hv,hx);ht[hw]._global.push({pred:hu,val:hx})}}function bT(hD,hC,hu,hE,hs){var hv=hC;var hz=hu;var hy=f7(hD,hC.line);function hr(){var hI=hC.line+hu;if(hI<hD.first||hI>=hD.first+hD.size){return false}hC=new ah(hI,hC.ch,hC.sticky);return hy=f7(hD,hI)}function hw(hJ){var hI;if(hs){hI=C(hD.cm,hy,hC,hu)}else{hI=aw(hy,hC,hu)}if(hI==null){if(!hJ&&hr()){hC=fk(hs,hD.cm,hy,hC.line,hu)}else{return false}}else{hC=hI}return true}if(hE=="char"){hw()}else{if(hE=="column"){hw(true)}else{if(hE=="word"||hE=="group"){var hB=null,hG=hE=="group";var ht=hD.cm&&hD.cm.getHelper(hC,"wordChars");for(var hx=true;;hx=false){if(hu<0&&!hw(!hx)){break}var hF=hy.text.charAt(hC.ch)||"\n";var hA=c7(hF,ht)?"w":hG&&hF=="\n"?"n":!hG||/\s/.test(hF)?null:"p";if(hG&&!hx&&!hA){hA="s"}if(hB&&hB!=hA){if(hu<0){hu=1;hw();hC.sticky="after"}break}if(hA){hB=hA}if(hu>0&&!hw(!hx)){break}}}}}var hH=cl(hD,hC,hv,hz,true);if(ai(hv,hH)){hH.hitSide=true}return hH}function bN(hA,hv,hs,hz){var hy=hA.doc,hx=hv.left,hw;if(hz=="page"){var hu=Math.min(hA.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);var hr=Math.max(hu-0.5*bf(hA.display),3);hw=(hs>0?hv.bottom:hv.top)+hs*hr}else{if(hz=="line"){hw=hs>0?hv.bottom+3:hv.top-3}}var ht;for(;;){ht=gN(hA,hx,hw);if(!ht.outside){break}if(hs<0?hw<=0:hw>=hy.height){ht.hitSide=true;break}hw+=hs*5}return ht}var d7=function(hr){this.cm=hr;this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null;this.polling=new hq();this.composing=null;this.gracePeriod=false;this.readDOMTimeout=null};d7.prototype.init=function(hu){var hw=this;var ht=this,hr=ht.cm;var hv=ht.div=hu.lineDiv;gM(hv,hr.options.spellcheck,hr.options.autocorrect,hr.options.autocapitalize);cn(hv,"paste",function(hx){if(a8(hr,hx)||br(hx,hr)){return}if(o<=11){setTimeout(dA(hr,function(){return hw.updateFromDOM()}),20)}});cn(hv,"compositionstart",function(hx){hw.composing={data:hx.data,done:false}});cn(hv,"compositionupdate",function(hx){if(!hw.composing){hw.composing={data:hx.data,done:false}}});cn(hv,"compositionend",function(hx){if(hw.composing){if(hx.data!=hw.composing.data){hw.readFromDOMSoon()}hw.composing.done=true}});cn(hv,"touchstart",function(){return ht.forceCompositionEnd()});cn(hv,"input",function(){if(!hw.composing){hw.readFromDOMSoon()}});function hs(hB){if(a8(hr,hB)){return}if(hr.somethingSelected()){dG({lineWise:false,text:hr.getSelections()});if(hB.type=="cut"){hr.replaceSelection("",null,"cut")}}else{if(!hr.options.lineWiseCopyCut){return}else{var hy=dU(hr);dG({lineWise:true,text:hy.text});if(hB.type=="cut"){hr.operation(function(){hr.setSelections(hy.ranges,0,am);hr.replaceSelection("",null,"cut")})}}}if(hB.clipboardData){hB.clipboardData.clearData();var hA=bD.text.join("\n");hB.clipboardData.setData("Text",hA);if(hB.clipboardData.getData("Text")==hA){hB.preventDefault();return}}var hz=be(),hC=hz.firstChild;hr.display.lineSpace.insertBefore(hz,hr.display.lineSpace.firstChild);hC.value=bD.text.join("\n");var hx=document.activeElement;en(hC);setTimeout(function(){hr.display.lineSpace.removeChild(hz);hx.focus();if(hx==hv){ht.showPrimarySelection()}},50)}cn(hv,"copy",hs);cn(hv,"cut",hs)};d7.prototype.prepareSelection=function(){var hr=gD(this.cm,false);hr.focus=this.cm.state.focused;return hr};d7.prototype.showSelection=function(hs,hr){if(!hs||!this.cm.display.view.length){return}if(hs.focus||hr){this.showPrimarySelection()}this.showMultipleSelections(hs)};d7.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()};d7.prototype.showPrimarySelection=function(){var hu=this.getSelection(),hE=this.cm,hx=hE.doc.sel.primary();var hC=hx.from(),hD=hx.to();if(hE.display.viewTo==hE.display.viewFrom||hC.line>=hE.display.viewTo||hD.line<hE.display.viewFrom){hu.removeAllRanges();return}var hv=aN(hE,hu.anchorNode,hu.anchorOffset);var hz=aN(hE,hu.focusNode,hu.focusOffset);if(hv&&!hv.bad&&hz&&!hz.bad&&cJ(aG(hv,hz),hC)==0&&cJ(bV(hv,hz),hD)==0){return}var hB=hE.display.view;var ht=(hC.line>=hE.display.viewFrom&&c6(hE,hC))||{node:hB[0].measure.map[2],offset:0};var hy=hD.line<hE.display.viewTo&&c6(hE,hD);if(!hy){var hs=hB[hB.length-1].measure;var hF=hs.maps?hs.maps[hs.maps.length-1]:hs.map;hy={node:hF[hF.length-1],offset:hF[hF.length-2]-hF[hF.length-3]}}if(!ht||!hy){hu.removeAllRanges();return}var hw=hu.rangeCount&&hu.getRangeAt(0),hr;try{hr=cS(ht.node,ht.offset,hy.offset,hy.node)}catch(hA){}if(hr){if(!cV&&hE.state.focused){hu.collapse(ht.node,ht.offset);if(!hr.collapsed){hu.removeAllRanges();hu.addRange(hr)}}else{hu.removeAllRanges();hu.addRange(hr)}if(hw&&hu.anchorNode==null){hu.addRange(hw)}else{if(cV){this.startGracePeriod()}}}this.rememberSelection()};d7.prototype.startGracePeriod=function(){var hr=this;clearTimeout(this.gracePeriod);this.gracePeriod=setTimeout(function(){hr.gracePeriod=false;if(hr.selectionChanged()){hr.cm.operation(function(){return hr.cm.curOp.selectionChanged=true})}},20)};d7.prototype.showMultipleSelections=function(hr){ci(this.cm.display.cursorDiv,hr.cursors);ci(this.cm.display.selectionDiv,hr.selection)};d7.prototype.rememberSelection=function(){var hr=this.getSelection();this.lastAnchorNode=hr.anchorNode;this.lastAnchorOffset=hr.anchorOffset;this.lastFocusNode=hr.focusNode;this.lastFocusOffset=hr.focusOffset};d7.prototype.selectionInEditor=function(){var hs=this.getSelection();if(!hs.rangeCount){return false}var hr=hs.getRangeAt(0).commonAncestorContainer;return hh(this.div,hr)};d7.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"){if(!this.selectionInEditor()){this.showSelection(this.prepareSelection(),true)}this.div.focus()}};d7.prototype.blur=function(){this.div.blur()};d7.prototype.getField=function(){return this.div};d7.prototype.supportsTouch=function(){return true};d7.prototype.receivedFocus=function(){var hr=this;if(this.selectionInEditor()){this.pollSelection()}else{dl(this.cm,function(){return hr.cm.curOp.selectionChanged=true})}function hs(){if(hr.cm.state.focused){hr.pollSelection();hr.polling.set(hr.cm.options.pollInterval,hs)}}this.polling.set(this.cm.options.pollInterval,hs)};d7.prototype.selectionChanged=function(){var hr=this.getSelection();return hr.anchorNode!=this.lastAnchorNode||hr.anchorOffset!=this.lastAnchorOffset||hr.focusNode!=this.lastFocusNode||hr.focusOffset!=this.lastFocusOffset};d7.prototype.pollSelection=function(){if(this.readDOMTimeout!=null||this.gracePeriod||!this.selectionChanged()){return}var hu=this.getSelection(),hr=this.cm;if(a3&&dP&&this.cm.options.gutters.length&&g8(hu.anchorNode)){this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs});this.blur();this.focus();return}if(this.composing){return}this.rememberSelection();var hs=aN(hr,hu.anchorNode,hu.anchorOffset);var ht=aN(hr,hu.focusNode,hu.focusOffset);if(hs&&ht){dl(hr,function(){ck(hr.doc,fH(hs,ht),am);if(hs.bad||ht.bad){hr.curOp.selectionChanged=true}})}};d7.prototype.pollContent=function(){if(this.readDOMTimeout!=null){clearTimeout(this.readDOMTimeout);this.readDOMTimeout=null}var hB=this.cm,hL=hB.display,hJ=hB.doc.sel.primary();var hK=hJ.from(),hv=hJ.to();if(hK.ch==0&&hK.line>hB.firstLine()){hK=ah(hK.line-1,f7(hB.doc,hK.line-1).length)}if(hv.ch==f7(hB.doc,hv.line).text.length&&hv.line<hB.lastLine()){hv=ah(hv.line+1,0)}if(hK.line<hL.viewFrom||hv.line>hL.viewTo-1){return false}var hy,hw,hA;if(hK.line==hL.viewFrom||(hy=d4(hB,hK.line))==0){hw=cc(hL.view[0].line);hA=hL.view[0].node}else{hw=cc(hL.view[hy].line);hA=hL.view[hy-1].node.nextSibling}var hI=d4(hB,hv.line);var hD,hG;if(hI==hL.view.length-1){hD=hL.viewTo-1;hG=hL.lineDiv.lastChild}else{hD=cc(hL.view[hI+1].line)-1;hG=hL.view[hI+1].node.previousSibling}if(!hA){return false}var hM=hB.doc.splitLines(g3(hB,hA,hG,hw,hD));var hF=g9(hB.doc,ah(hw,0),ah(hD,f7(hB.doc,hD).text.length));while(hM.length>1&&hF.length>1){if(gA(hM)==gA(hF)){hM.pop();hF.pop();hD--}else{if(hM[0]==hF[0]){hM.shift();hF.shift();hw++}else{break}}}var hH=0,ht=0;var hC=hM[0],hs=hF[0],hr=Math.min(hC.length,hs.length);while(hH<hr&&hC.charCodeAt(hH)==hs.charCodeAt(hH)){++hH}var hz=gA(hM),hN=gA(hF);var hu=Math.min(hz.length-(hM.length==1?hH:0),hN.length-(hF.length==1?hH:0));while(ht<hu&&hz.charCodeAt(hz.length-ht-1)==hN.charCodeAt(hN.length-ht-1)){++ht}if(hM.length==1&&hF.length==1&&hw==hK.line){while(hH&&hH>hK.ch&&hz.charCodeAt(hz.length-ht-1)==hN.charCodeAt(hN.length-ht-1)){hH--;ht++}}hM[hM.length-1]=hz.slice(0,hz.length-ht).replace(/^\u200b+/,"");hM[0]=hM[0].slice(hH).replace(/\u200b+$/,"");var hx=ah(hw,hH);var hE=ah(hD,hF.length?gA(hF).length-ht:0);if(hM.length>1||hM[0]||cJ(hx,hE)){bi(hB.doc,hM,hx,hE,"+input");return true}};d7.prototype.ensurePolled=function(){this.forceCompositionEnd()};d7.prototype.reset=function(){this.forceCompositionEnd()};d7.prototype.forceCompositionEnd=function(){if(!this.composing){return}clearTimeout(this.readDOMTimeout);this.composing=null;this.updateFromDOM();this.div.blur();this.div.focus()};d7.prototype.readFromDOMSoon=function(){var hr=this;if(this.readDOMTimeout!=null){return}this.readDOMTimeout=setTimeout(function(){hr.readDOMTimeout=null;if(hr.composing){if(hr.composing.done){hr.composing=null}else{return}}hr.updateFromDOM()},80)};d7.prototype.updateFromDOM=function(){var hr=this;if(this.cm.isReadOnly()||!this.pollContent()){dl(this.cm,function(){return av(hr.cm)})}};d7.prototype.setUneditable=function(hr){hr.contentEditable="false"};d7.prototype.onKeyPress=function(hr){if(hr.charCode==0||this.composing){return}hr.preventDefault();if(!this.cm.isReadOnly()){dA(this.cm,g0)(this.cm,String.fromCharCode(hr.charCode==null?hr.keyCode:hr.charCode),0)}};d7.prototype.readOnlyChanged=function(hr){this.div.contentEditable=String(hr!="nocursor")};d7.prototype.onContextMenu=function(){};d7.prototype.resetPosition=function(){};d7.prototype.needsContentAttribute=true;function c6(hx,hv){var hw=f4(hx,hv.line);if(!hw||hw.hidden){return null}var hz=f7(hx.doc,hv.line);var hs=c0(hw,hz,hv.line);var ht=a(hz,hx.doc.direction),hu="left";if(ht){var hr=aX(ht,hv.ch);hu=hr%2?"right":"left"}var hy=a0(hs.map,hv.ch,hu);hy.offset=hy.collapse=="right"?hy.end:hy.start;return hy}function g8(hs){for(var hr=hs;hr;hr=hr.parentNode){if(/CodeMirror-gutter-wrapper/.test(hr.className)){return true}}return false}function fb(hs,hr){if(hr){hs.bad=true}return hs}function g3(hA,hy,hz,hu,hs){var hC="",ht=false,hr=hA.doc.lineSeparator(),hv=false;function hw(hE){return function(hF){return hF.id==hE}}function hD(){if(ht){hC+=hr;if(hv){hC+=hr}ht=hv=false}}function hB(hE){if(hE){hD();hC+=hE}}function hx(hI){if(hI.nodeType==1){var hF=hI.getAttribute("cm-text");if(hF){hB(hF);return}var hH=hI.getAttribute("cm-marker"),hK;if(hH){var hJ=hA.findMarks(ah(hu,0),ah(hs+1,0),hw(+hH));if(hJ.length&&(hK=hJ[0].find(0))){hB(g9(hA.doc,hK.from,hK.to).join(hr))}return}if(hI.getAttribute("contenteditable")=="false"){return}var hE=/^(pre|div|p|li|table|br)$/i.test(hI.nodeName);if(!/^br$/i.test(hI.nodeName)&&hI.textContent.length==0){return}if(hE){hD()}for(var hG=0;hG<hI.childNodes.length;hG++){hx(hI.childNodes[hG])}if(/^(pre|p)$/i.test(hI.nodeName)){hv=true}if(hE){ht=true}}else{if(hI.nodeType==3){hB(hI.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}}}for(;;){hx(hy);if(hy==hz){break}hy=hy.nextSibling;hv=false}return hC}function aN(hr,hu,hw){var hv;if(hu==hr.display.lineDiv){hv=hr.display.lineDiv.childNodes[hw];if(!hv){return fb(hr.clipPos(ah(hr.display.viewTo-1)),true)}hu=null;hw=0}else{for(hv=hu;;hv=hv.parentNode){if(!hv||hv==hr.display.lineDiv){return null}if(hv.parentNode&&hv.parentNode==hr.display.lineDiv){break}}}for(var ht=0;ht<hr.display.view.length;ht++){var hs=hr.display.view[ht];if(hs.node==hv){return an(hs,hu,hw)}}}function an(hA,hw,hy){var ht=hA.text.firstChild,hv=false;if(!hw||!hh(ht,hw)){return fb(ah(cc(hA.line),0),true)}if(hw==ht){hv=true;hw=ht.childNodes[hy];hy=0;if(!hw){var hG=hA.rest?gA(hA.rest):hA.line;return fb(ah(cc(hG),hG.text.length),hv)}}var hx=hw.nodeType==3?hw:null,hE=hw;if(!hx&&hw.childNodes.length==1&&hw.firstChild.nodeType==3){hx=hw.firstChild;if(hy){hy=hx.nodeValue.length}}while(hE.parentNode!=ht){hE=hE.parentNode}var hs=hA.measure,hC=hs.maps;function hz(hI,hN,hK){for(var hM=-1;hM<(hC?hC.length:0);hM++){var hO=hM<0?hs.map:hC[hM];for(var hL=0;hL<hO.length;hL+=3){var hJ=hO[hL+2];if(hJ==hI||hJ==hN){var hP=cc(hM<0?hA.line:hA.rest[hM]);var hH=hO[hL]+hK;if(hK<0||hJ!=hI){hH=hO[hL+(hK?1:0)]}return ah(hP,hH)}}}}var hF=hz(hx,hE,hy);if(hF){return fb(hF,hv)}for(var hr=hE.nextSibling,hB=hx?hx.nodeValue.length-hy:0;hr;hr=hr.nextSibling){hF=hz(hr,hr.firstChild,0);if(hF){return fb(ah(hF.line,hF.ch-hB),hv)}else{hB+=hr.textContent.length}}for(var hD=hE.previousSibling,hu=hy;hD;hD=hD.previousSibling){hF=hz(hD,hD.firstChild,-1);if(hF){return fb(ah(hF.line,hF.ch+hu),hv)}else{hu+=hD.textContent.length}}}var aj=function(hr){this.cm=hr;this.prevInput="";this.pollingFast=false;this.polling=new hq();this.hasSelection=false;this.composing=null};aj.prototype.init=function(ht){var hw=this;var hs=this,hr=this.cm;this.createField(ht);var hu=this.textarea;ht.wrapper.insertBefore(this.wrapper,ht.wrapper.firstChild);if(fT){hu.style.width="0px"}cn(hu,"input",function(){if(em&&o>=9&&hw.hasSelection){hw.hasSelection=null}hs.poll()});cn(hu,"paste",function(hx){if(a8(hr,hx)||br(hx,hr)){return}hr.state.pasteIncoming=+new Date;hs.fastPoll()});function hv(hy){if(a8(hr,hy)){return}if(hr.somethingSelected()){dG({lineWise:false,text:hr.getSelections()})}else{if(!hr.options.lineWiseCopyCut){return}else{var hx=dU(hr);dG({lineWise:true,text:hx.text});if(hy.type=="cut"){hr.setSelections(hx.ranges,null,am)}else{hs.prevInput="";hu.value=hx.text.join("\n");en(hu)}}}if(hy.type=="cut"){hr.state.cutIncoming=+new Date}}cn(hu,"cut",hv);cn(hu,"copy",hv);cn(ht.scroller,"paste",function(hy){if(bs(ht,hy)||a8(hr,hy)){return}if(!hu.dispatchEvent){hr.state.pasteIncoming=+new Date;hs.focus();return}var hx=new Event("paste");hx.clipboardData=hy.clipboardData;hu.dispatchEvent(hx)});cn(ht.lineSpace,"selectstart",function(hx){if(!bs(ht,hx)){dd(hx)}});cn(hu,"compositionstart",function(){var hx=hr.getCursor("from");if(hs.composing){hs.composing.range.clear()}hs.composing={start:hx,range:hr.markText(hx,hr.getCursor("to"),{className:"CodeMirror-composing"})}});cn(hu,"compositionend",function(){if(hs.composing){hs.poll();hs.composing.range.clear();hs.composing=null}})};aj.prototype.createField=function(hr){this.wrapper=be();this.textarea=this.wrapper.firstChild};aj.prototype.prepareSelection=function(){var hs=this.cm,hw=hs.display,hv=hs.doc;var hr=gD(hs);if(hs.options.moveInputWithCursor){var hx=ey(hs,hv.sel.primary().head,"div");var ht=hw.wrapper.getBoundingClientRect(),hu=hw.lineDiv.getBoundingClientRect();hr.teTop=Math.max(0,Math.min(hw.wrapper.clientHeight-10,hx.top+hu.top-ht.top));hr.teLeft=Math.max(0,Math.min(hw.wrapper.clientWidth-10,hx.left+hu.left-ht.left))}return hr};aj.prototype.showSelection=function(ht){var hr=this.cm,hs=hr.display;ci(hs.cursorDiv,ht.cursors);ci(hs.selectionDiv,ht.selection);if(ht.teTop!=null){this.wrapper.style.top=ht.teTop+"px";this.wrapper.style.left=ht.teLeft+"px"}};aj.prototype.reset=function(hs){if(this.contextMenuPending||this.composing){return}var hr=this.cm;if(hr.somethingSelected()){this.prevInput="";var ht=hr.getSelection();this.textarea.value=ht;if(hr.state.focused){en(this.textarea)}if(em&&o>=9){this.hasSelection=ht}}else{if(!hs){this.prevInput=this.textarea.value="";if(em&&o>=9){this.hasSelection=null}}}};aj.prototype.getField=function(){return this.textarea};aj.prototype.supportsTouch=function(){return false};aj.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"&&(!eX||eq()!=this.textarea)){try{this.textarea.focus()}catch(hr){}}};aj.prototype.blur=function(){this.textarea.blur()};aj.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0};aj.prototype.receivedFocus=function(){this.slowPoll()};aj.prototype.slowPoll=function(){var hr=this;if(this.pollingFast){return}this.polling.set(this.cm.options.pollInterval,function(){hr.poll();if(hr.cm.state.focused){hr.slowPoll()}})};aj.prototype.fastPoll=function(){var hs=false,hr=this;hr.pollingFast=true;function ht(){var hu=hr.poll();if(!hu&&!hs){hs=true;hr.polling.set(60,ht)}else{hr.pollingFast=false;hr.slowPoll()}}hr.polling.set(20,ht)};aj.prototype.poll=function(){var hy=this;var hr=this.cm,ht=this.textarea,hu=this.prevInput;if(this.contextMenuPending||!hr.state.focused||(bP(ht)&&!hu&&!this.composing)||hr.isReadOnly()||hr.options.disableInput||hr.state.keySeq){return false}var hw=ht.value;if(hw==hu&&!hr.somethingSelected()){return false}if(em&&o>=9&&this.hasSelection===hw||cy&&/[\uf700-\uf7ff]/.test(hw)){hr.display.input.reset();return false}if(hr.doc.sel==hr.display.selForContextMenu){var hv=hw.charCodeAt(0);if(hv==8203&&!hu){hu="\u200b"}if(hv==8666){this.reset();return this.cm.execCommand("undo")}}var hx=0,hs=Math.min(hu.length,hw.length);while(hx<hs&&hu.charCodeAt(hx)==hw.charCodeAt(hx)){++hx}dl(hr,function(){g0(hr,hw.slice(hx),hu.length-hx,null,hy.composing?"*compose":null);if(hw.length>1000||hw.indexOf("\n")>-1){ht.value=hy.prevInput=""}else{hy.prevInput=hw}if(hy.composing){hy.composing.range.clear();hy.composing.range=hr.markText(hy.composing.start,hr.getCursor("to"),{className:"CodeMirror-composing"})}});return true};aj.prototype.ensurePolled=function(){if(this.pollingFast&&this.poll()){this.pollingFast=false}};aj.prototype.onKeyPress=function(){if(em&&o>=9){this.hasSelection=null}this.fastPoll()};aj.prototype.onContextMenu=function(hw){var hB=this,hC=hB.cm,hy=hC.display,hs=hB.textarea;if(hB.contextMenuPending){hB.contextMenuPending()}var hA=cU(hC,hw),hr=hy.scroller.scrollTop;if(!hA||eI){return}var hv=hC.options.resetSelectionOnContextMenu;if(hv&&hC.doc.sel.contains(hA)==-1){dA(hC,ck)(hC.doc,fH(hA),am)}var hx=hs.style.cssText,hF=hB.wrapper.style.cssText;var hE=hB.wrapper.offsetParent.getBoundingClientRect();hB.wrapper.style.cssText="position: static";hs.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(hw.clientY-hE.top-5)+"px; left: "+(hw.clientX-hE.left-5)+"px;\n      z-index: 1000; background: "+(em?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";var hD;if(dz){hD=window.scrollY}hy.input.focus();if(dz){window.scrollTo(null,hD)}hy.input.reset();if(!hC.somethingSelected()){hs.value=hB.prevInput=" "}hB.contextMenuPending=hz;hy.selForContextMenu=hC.doc.sel;clearTimeout(hy.detectingSelectAll);function hu(){if(hs.selectionStart!=null){var hG=hC.somethingSelected();var hH="\u200b"+(hG?hs.value:"");hs.value="\u21da";hs.value=hH;hB.prevInput=hG?"":"\u200b";hs.selectionStart=1;hs.selectionEnd=hH.length;hy.selForContextMenu=hC.doc.sel}}function hz(){if(hB.contextMenuPending!=hz){return}hB.contextMenuPending=false;hB.wrapper.style.cssText=hF;hs.style.cssText=hx;if(em&&o<9){hy.scrollbars.setScrollTop(hy.scroller.scrollTop=hr)}if(hs.selectionStart!=null){if(!em||(em&&o<9)){hu()}var hG=0,hH=function(){if(hy.selForContextMenu==hC.doc.sel&&hs.selectionStart==0&&hs.selectionEnd>0&&hB.prevInput=="\u200b"){dA(hC,aA)(hC)}else{if(hG++<10){hy.detectingSelectAll=setTimeout(hH,500)}else{hy.selForContextMenu=null;hy.input.reset()}}};hy.detectingSelectAll=setTimeout(hH,200)}}if(em&&o>=9){hu()}if(hg){fa(hw);var ht=function(){eW(window,"mouseup",ht);setTimeout(hz,20)};cn(window,"mouseup",ht)}else{setTimeout(hz,50)}};aj.prototype.readOnlyChanged=function(hr){if(!hr){this.reset()}this.textarea.disabled=hr=="nocursor"};aj.prototype.setUneditable=function(){};aj.prototype.needsContentAttribute=false;function gB(hy,hz){hz=hz?a4(hz):{};hz.value=hy.value;if(!hz.tabindex&&hy.tabIndex){hz.tabindex=hy.tabIndex}if(!hz.placeholder&&hy.placeholder){hz.placeholder=hy.placeholder}if(hz.autofocus==null){var hr=eq();hz.autofocus=hr==hy||hy.getAttribute("autofocus")!=null&&hr==document.body}function hv(){hy.value=hx.getValue()}var hw;if(hy.form){cn(hy.form,"submit",hv);if(!hz.leaveSubmitMethodAlone){var hs=hy.form;hw=hs.submit;try{var hu=hs.submit=function(){hv();hs.submit=hw;hs.submit();hs.submit=hu}}catch(ht){}}}hz.finishInit=function(hA){hA.save=hv;hA.getTextArea=function(){return hy};hA.toTextArea=function(){hA.toTextArea=isNaN;hv();hy.parentNode.removeChild(hA.getWrapperElement());hy.style.display="";if(hy.form){eW(hy.form,"submit",hv);if(typeof hy.form.submit=="function"){hy.form.submit=hw}}}};hy.style.display="none";var hx=R(function(hA){return hy.parentNode.insertBefore(hA,hy.nextSibling)},hz);return hx}function gG(hr){hr.off=eW;hr.on=cn;hr.wheelEventPixels=aO;hr.Doc=aI;hr.splitLines=gQ;hr.countColumn=ch;hr.findColumn=e9;hr.isWordChar=gx;hr.Pass=cD;hr.signal=aT;hr.Line=hb;hr.changeEnd=dw;hr.scrollbarModel=bE;hr.Pos=ah;hr.cmpPos=cJ;hr.modes=d5;hr.mimeModes=a9;hr.resolveMode=hi;hr.getMode=gt;hr.modeExtensions=d2;hr.extendMode=fq;hr.copyState=cu;hr.startState=cr;hr.innerMode=he;hr.commands=fp;hr.keyMap=f3;hr.keyName=gi;hr.isModifierKey=fm;hr.lookupKey=m;hr.normalizeKeyMap=de;hr.StringStream=fK;hr.SharedTextMarker=F;hr.TextMarker=ab;hr.LineWidget=ed;hr.e_preventDefault=dd;hr.e_stopPropagation=d3;hr.e_stop=fa;hr.addClass=gu;hr.contains=hh;hr.rmClass=j;hr.keyNames=f8}fu(R);er(R);var d="iter insert remove copy getEditor constructor".split(" ");for(var b9 in aI.prototype){if(aI.prototype.hasOwnProperty(b9)&&dV(d,b9)<0){R.prototype[b9]=(function(hr){return function(){return hr.apply(this.doc,arguments)}})(aI.prototype[b9])}}bX(aI);R.inputStyles={textarea:aj,contenteditable:d7};R.defineMode=function(hr){if(!R.defaults.mode&&hr!="null"){R.defaults.mode=hr}fd.apply(this,arguments)};R.defineMIME=bI;R.defineMode("null",function(){return({token:function(hr){return hr.skipToEnd()}})});R.defineMIME("text/plain","null");R.defineExtension=function(hr,hs){R.prototype[hr]=hs};R.defineDocExtension=function(hr,hs){aI.prototype[hr]=hs};R.fromTextArea=gB;gG(R);R.version="5.45.0";return R})));(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/edit/matchbrackets"))}else{if(typeof define=="function"&&define.amd){define(["../lib/codemirror","../addon/search/searchcursor","../addon/edit/matchbrackets"],a)}else{a(CodeMirror)}}})(function(g){var c=g.commands;var s=g.Pos;function b(I,A,B){if(B<0&&A.ch==0){return I.clipPos(s(A.line-1))}var J=I.getLine(A.line);if(B>0&&A.ch>=J.length){return I.clipPos(s(A.line+1,0))}var x="start",F;for(var H=A.ch,E=B<0?0:J.length,C=0;H!=E;H+=B,C++){var D=J.charAt(B<0?H-1:H);var G=D!="_"&&g.isWordChar(D)?"w":"o";if(G=="w"&&D.toUpperCase()==D){G="W"}if(x=="start"){if(G!="o"){x="in";F=G}}else{if(x=="in"){if(F!=G){if(F=="w"&&G=="W"&&B<0){H--}if(F=="W"&&G=="w"&&B>0){F="w";continue}break}}}}return s(A.line,H)}function m(x,A){x.extendSelectionsBy(function(B){if(x.display.shift||x.doc.extend||B.empty()){return b(x.doc,B.head,A)}else{return A<0?B.from():B.to()}})}c.goSubwordLeft=function(x){m(x,-1)};c.goSubwordRight=function(x){m(x,1)};c.scrollLineUp=function(x){var B=x.getScrollInfo();if(!x.somethingSelected()){var A=x.lineAtHeight(B.top+B.clientHeight,"local");if(x.getCursor().line>=A){x.execCommand("goLineUp")}}x.scrollTo(null,B.top-x.defaultTextHeight())};c.scrollLineDown=function(x){var B=x.getScrollInfo();if(!x.somethingSelected()){var A=x.lineAtHeight(B.top,"local")+1;if(x.getCursor().line<=A){x.execCommand("goLineDown")}}x.scrollTo(null,B.top+x.defaultTextHeight())};c.splitSelectionByLine=function(x){var B=x.listSelections(),D=[];for(var C=0;C<B.length;C++){var F=B[C].from(),E=B[C].to();for(var A=F.line;A<=E.line;++A){if(!(E.line>F.line&&A==E.line&&E.ch==0)){D.push({anchor:A==F.line?F:s(A,0),head:A==E.line?E:s(A)})}}}x.setSelections(D,0)};c.singleSelectionTop=function(x){var A=x.listSelections()[0];x.setSelection(A.anchor,A.head,{scroll:false})};c.selectLine=function(A){var B=A.listSelections(),x=[];for(var D=0;D<B.length;D++){var C=B[D];x.push({anchor:s(C.from().line,0),head:s(C.to().line+1,0)})}A.setSelections(x)};function d(A,x){if(A.isReadOnly()){return g.Pass}A.operation(function(){var D=A.listSelections().length,C=[],G=-1;for(var F=0;F<D;F++){var E=A.listSelections()[F].head;if(E.line<=G){continue}var B=s(E.line+(x?0:1),0);A.replaceRange("\n",B,null,"+insertLine");A.indentLine(B.line,null,true);C.push({head:B,anchor:B});G=E.line+1}A.setSelections(C)});A.execCommand("indentAuto")}c.insertLineAfter=function(x){return d(x,false)};c.insertLineBefore=function(x){return d(x,true)};function f(x,D){var C=D.ch,B=C,A=x.getLine(D.line);while(C&&g.isWordChar(A.charAt(C-1))){--C}while(B<A.length&&g.isWordChar(A.charAt(B))){++B}return{from:s(D.line,C),to:s(D.line,B),word:A.slice(C,B)}}c.selectNextOccurrence=function(E){var C=E.getCursor("from"),D=E.getCursor("to");var A=E.state.sublimeFindFullWord==E.doc.sel;if(g.cmpPos(C,D)==0){var x=f(E,C);if(!x.word){return}E.setSelection(x.from,x.to);A=true}else{var G=E.getRange(C,D);var B=A?new RegExp("\\b"+G+"\\b"):G;var F=E.getSearchCursor(B,D);var H=F.findNext();if(!H){F=E.getSearchCursor(B,s(E.firstLine(),0));H=F.findNext()}if(!H||j(E.listSelections(),F.from(),F.to())){return g.Pass}E.addSelection(F.from(),F.to())}if(A){E.state.sublimeFindFullWord=E.doc.sel}};function a(H,B){var x=H.listSelections(),A=[];for(var D=0;D<x.length;D++){var E=x[D];var F=H.findPosV(E.anchor,B,"line",E.anchor.goalColumn);var C=H.findPosV(E.head,B,"line",E.head.goalColumn);F.goalColumn=E.anchor.goalColumn!=null?E.anchor.goalColumn:H.cursorCoords(E.anchor,"div").left;C.goalColumn=E.head.goalColumn!=null?E.head.goalColumn:H.cursorCoords(E.head,"div").left;var G={anchor:F,head:C};A.push(E);A.push(G)}H.setSelections(A)}c.addCursorToPrevLine=function(x){a(x,-1)};c.addCursorToNextLine=function(x){a(x,1)};function j(x,C,B){for(var A=0;A<x.length;A++){if(x[A].from()==C&&x[A].to()==B){return true}}return false}var r="(){}[]";function q(H){var x=H.listSelections(),A=[];for(var D=0;D<x.length;D++){var E=x[D],G=E.head,B=H.scanForBracket(G,-1);if(!B){return false}for(;;){var C=H.scanForBracket(G,1);if(!C){return false}if(C.ch==r.charAt(r.indexOf(B.ch)+1)){var F=s(B.pos.line,B.pos.ch+1);if(g.cmpPos(F,E.from())==0&&g.cmpPos(C.pos,E.to())==0){B=H.scanForBracket(B.pos,-1);if(!B){return false}}else{A.push({anchor:F,head:C.pos});break}}G=s(C.pos.line,C.pos.ch+1)}}H.setSelections(A);return true}c.selectScope=function(x){q(x)||x.execCommand("selectAll")};c.selectBetweenBrackets=function(x){if(!q(x)){return g.Pass}};c.goToBracket=function(x){x.extendSelectionsBy(function(A){var B=x.scanForBracket(A.head,1);if(B&&g.cmpPos(B.pos,A.head)!=0){return B.pos}var C=x.scanForBracket(A.head,-1);return C&&s(C.pos.line,C.pos.ch+1)||A.head})};c.swapLineUp=function(G){if(G.isReadOnly()){return g.Pass}var x=G.listSelections(),D=[],A=G.firstLine()-1,H=[];for(var B=0;B<x.length;B++){var C=x[B],F=C.from().line-1,E=C.to().line;H.push({anchor:s(C.anchor.line-1,C.anchor.ch),head:s(C.head.line-1,C.head.ch)});if(C.to().ch==0&&!C.empty()){--E}if(F>A){D.push(F,E)}else{if(D.length){D[D.length-1]=E}}A=E}G.operation(function(){for(var J=0;J<D.length;J+=2){var L=D[J],K=D[J+1];var I=G.getLine(L);G.replaceRange("",s(L,0),s(L+1,0),"+swapLine");if(K>G.lastLine()){G.replaceRange("\n"+I,s(G.lastLine()),null,"+swapLine")}else{G.replaceRange(I+"\n",s(K,0),null,"+swapLine")}}G.setSelections(H);G.scrollIntoView()})};c.swapLineDown=function(A){if(A.isReadOnly()){return g.Pass}var B=A.listSelections(),E=[],x=A.lastLine()+1;for(var D=B.length-1;D>=0;D--){var C=B[D],G=C.to().line+1,F=C.from().line;if(C.to().ch==0&&!C.empty()){G--}if(G<x){E.push(G,F)}else{if(E.length){E[E.length-1]=F}}x=F}A.operation(function(){for(var I=E.length-2;I>=0;I-=2){var K=E[I],J=E[I+1];var H=A.getLine(K);if(K==A.lastLine()){A.replaceRange("",s(K-1),s(K),"+swapLine")}else{A.replaceRange("",s(K,0),s(K+1,0),"+swapLine")}A.replaceRange(H+"\n",s(J,0),null,"+swapLine")}A.scrollIntoView()})};c.toggleCommentIndented=function(x){x.toggleComment({indent:true})};c.joinLines=function(x){var B=x.listSelections(),E=[];for(var D=0;D<B.length;D++){var C=B[D],G=C.from();var F=G.line,A=C.to().line;while(D<B.length-1&&B[D+1].from().line==A){A=B[++D].to().line}E.push({start:F,end:A,anchor:!C.empty()&&G})}x.operation(function(){var N=0,I=[];for(var L=0;L<E.length;L++){var M=E[L];var J=M.anchor&&s(M.anchor.line-N,M.anchor.ch),K;for(var H=M.start;H<=M.end;H++){var O=H-N;if(H==M.end){K=s(O,x.getLine(O).length+1)}if(O<x.lastLine()){x.replaceRange(" ",s(O),s(O+1,/^\s*/.exec(x.getLine(O+1))[0].length));++N}}I.push({anchor:J||K,head:K})}x.setSelections(I,0)})};c.duplicateLine=function(x){x.operation(function(){var B=x.listSelections().length;for(var C=0;C<B;C++){var A=x.listSelections()[C];if(A.empty()){x.replaceRange(x.getLine(A.head.line)+"\n",s(A.head.line,0))}else{x.replaceRange(x.getRange(A.from(),A.to()),A.from())}}x.scrollIntoView()})};function w(H,E){if(H.isReadOnly()){return g.Pass}var x=H.listSelections(),D=[],A;for(var B=0;B<x.length;B++){var C=x[B];if(C.empty()){continue}var G=C.from().line,F=C.to().line;while(B<x.length-1&&x[B+1].from().line==F){F=x[++B].to().line}if(!x[B].to().ch){F--}D.push(G,F)}if(D.length){A=true}else{D.push(H.firstLine(),H.lastLine())}H.operation(function(){var K=[];for(var L=0;L<D.length;L+=2){var O=D[L],N=D[L+1];var M=s(O,0),J=s(N);var I=H.getRange(M,J,false);if(E){I.sort()}else{I.sort(function(R,P){var S=R.toUpperCase(),Q=P.toUpperCase();if(S!=Q){R=S;P=Q}return R<P?-1:R==P?0:1})}H.replaceRange(I,M,J);if(A){K.push({anchor:M,head:s(N+1,0)})}}if(A){H.setSelections(K,0)}})}c.sortLines=function(x){w(x,true)};c.sortLinesInsensitive=function(x){w(x,false)};c.nextBookmark=function(x){var A=x.state.sublimeBookmarks;if(A){while(A.length){var C=A.shift();var B=C.find();if(B){A.push(C);return x.setSelection(B.from,B.to)}}}};c.prevBookmark=function(x){var A=x.state.sublimeBookmarks;if(A){while(A.length){A.unshift(A.pop());var B=A[A.length-1].find();if(!B){A.pop()}else{return x.setSelection(B.from,B.to)}}}};c.toggleBookmark=function(G){var x=G.listSelections();var D=G.state.sublimeBookmarks||(G.state.sublimeBookmarks=[]);for(var C=0;C<x.length;C++){var E=x[C].from(),F=x[C].to();var H=x[C].empty()?G.findMarksAt(E):G.findMarks(E,F);for(var B=0;B<H.length;B++){if(H[B].sublimeBookmark){H[B].clear();for(var A=0;A<D.length;A++){if(D[A]==H[B]){D.splice(A--,1)}}break}}if(B==H.length){D.push(G.markText(E,F,{sublimeBookmark:true,clearWhenEmpty:false}))}}};c.clearBookmarks=function(x){var B=x.state.sublimeBookmarks;if(B){for(var A=0;A<B.length;A++){B[A].clear()}}B.length=0};c.selectBookmarks=function(x){var C=x.state.sublimeBookmarks,A=[];if(C){for(var B=0;B<C.length;B++){var D=C[B].find();if(!D){C.splice(B--,0)}else{A.push({anchor:D.from,head:D.to})}}}if(A.length){x.setSelections(A,0)}};function l(x,A){x.operation(function(){var C=x.listSelections(),H=[],F=[];for(var E=0;E<C.length;E++){var D=C[E];if(D.empty()){H.push(E);F.push("")}else{F.push(A(x.getRange(D.from(),D.to())))}}x.replaceSelections(F,"around","case");for(var E=H.length-1,B;E>=0;E--){var D=C[H[E]];if(B&&g.cmpPos(D.head,B)>0){continue}var G=f(x,D.head);B=G.from;x.replaceRange(A(G.word),G.from,G.to)}})}c.smartBackspace=function(x){if(x.somethingSelected()){return g.Pass}x.operation(function(){var F=x.listSelections();var B=x.getOption("indentUnit");for(var C=F.length-1;C>=0;C--){var G=F[C].head;var E=x.getRange({line:G.line,ch:0},G);var D=g.countColumn(E,null,x.getOption("tabSize"));var A=x.findPosH(G,-1,"char",false);if(E&&!/\S/.test(E)&&D%B==0){var H=new s(G.line,g.findColumn(E,D-B,B));if(H.ch!=G.ch){A=H}}x.replaceRange("",A,G,"+delete")}})};c.delLineRight=function(x){x.operation(function(){var A=x.listSelections();for(var B=A.length-1;B>=0;B--){x.replaceRange("",A[B].anchor,s(A[B].to().line),"+delete")}x.scrollIntoView()})};c.upcaseAtCursor=function(x){l(x,function(A){return A.toUpperCase()})};c.downcaseAtCursor=function(x){l(x,function(A){return A.toLowerCase()})};c.setSublimeMark=function(x){if(x.state.sublimeMark){x.state.sublimeMark.clear()}x.state.sublimeMark=x.setBookmark(x.getCursor())};c.selectToSublimeMark=function(x){var A=x.state.sublimeMark&&x.state.sublimeMark.find();if(A){x.setSelection(x.getCursor(),A)}};c.deleteToSublimeMark=function(x){var B=x.state.sublimeMark&&x.state.sublimeMark.find();if(B){var D=x.getCursor(),C=B;if(g.cmpPos(D,C)>0){var A=C;C=D;D=A}x.state.sublimeKilled=x.getRange(D,C);x.replaceRange("",D,C)}};c.swapWithSublimeMark=function(x){var A=x.state.sublimeMark&&x.state.sublimeMark.find();if(A){x.state.sublimeMark.clear();x.state.sublimeMark=x.setBookmark(x.getCursor());x.setCursor(A)}};c.sublimeYank=function(x){if(x.state.sublimeKilled!=null){x.replaceSelection(x.state.sublimeKilled,null,"paste")}};c.showInCenter=function(x){var A=x.cursorCoords(null,"local");x.scrollTo(null,(A.top+A.bottom)/2-x.getScrollInfo().clientHeight/2)};function e(x){var C=x.getCursor("from"),B=x.getCursor("to");if(g.cmpPos(C,B)==0){var A=f(x,C);if(!A.word){return}C=A.from;B=A.to}return{from:C,to:B,query:x.getRange(C,B),word:A}}function u(x,A){var C=e(x);if(!C){return}var B=C.query;var D=x.getSearchCursor(B,A?C.to:C.from);if(A?D.findNext():D.findPrevious()){x.setSelection(D.from(),D.to())}else{D=x.getSearchCursor(B,A?s(x.firstLine(),0):x.clipPos(s(x.lastLine())));if(A?D.findNext():D.findPrevious()){x.setSelection(D.from(),D.to())}else{if(C.word){x.setSelection(C.from,C.to)}}}}c.findUnder=function(x){u(x,true)};c.findUnderPrevious=function(x){u(x,false)};c.findAllUnder=function(x){var C=e(x);if(!C){return}var D=x.getSearchCursor(C.query);var B=[];var A=-1;while(D.findNext()){B.push({anchor:D.from(),head:D.to()});if(D.from().line<=C.from.line&&D.from().ch<=C.from.ch){A++}}x.setSelections(B,A)};var n=g.keyMap;n.macSublime={"Cmd-Left":"goLineStartSmart","Shift-Tab":"indentLess","Shift-Ctrl-K":"deleteLine","Alt-Q":"wrapLines","Ctrl-Left":"goSubwordLeft","Ctrl-Right":"goSubwordRight","Ctrl-Alt-Up":"scrollLineUp","Ctrl-Alt-Down":"scrollLineDown","Cmd-L":"selectLine","Shift-Cmd-L":"splitSelectionByLine",Esc:"singleSelectionTop","Cmd-Enter":"insertLineAfter","Shift-Cmd-Enter":"insertLineBefore","Cmd-D":"selectNextOccurrence","Shift-Cmd-Space":"selectScope","Shift-Cmd-M":"selectBetweenBrackets","Cmd-M":"goToBracket","Cmd-Ctrl-Up":"swapLineUp","Cmd-Ctrl-Down":"swapLineDown","Cmd-/":"toggleCommentIndented","Cmd-J":"joinLines","Shift-Cmd-D":"duplicateLine",F5:"sortLines","Cmd-F5":"sortLinesInsensitive",F2:"nextBookmark","Shift-F2":"prevBookmark","Cmd-F2":"toggleBookmark","Shift-Cmd-F2":"clearBookmarks","Alt-F2":"selectBookmarks",Backspace:"smartBackspace","Cmd-K Cmd-K":"delLineRight","Cmd-K Cmd-U":"upcaseAtCursor","Cmd-K Cmd-L":"downcaseAtCursor","Cmd-K Cmd-Space":"setSublimeMark","Cmd-K Cmd-A":"selectToSublimeMark","Cmd-K Cmd-W":"deleteToSublimeMark","Cmd-K Cmd-X":"swapWithSublimeMark","Cmd-K Cmd-Y":"sublimeYank","Cmd-K Cmd-C":"showInCenter","Cmd-K Cmd-G":"clearBookmarks","Cmd-K Cmd-Backspace":"delLineLeft","Cmd-K Cmd-0":"unfoldAll","Cmd-K Cmd-J":"unfoldAll","Ctrl-Shift-Up":"addCursorToPrevLine","Ctrl-Shift-Down":"addCursorToNextLine","Cmd-F3":"findUnder","Shift-Cmd-F3":"findUnderPrevious","Alt-F3":"findAllUnder","Shift-Cmd-[":"fold","Shift-Cmd-]":"unfold","Cmd-I":"findIncremental","Shift-Cmd-I":"findIncrementalReverse","Cmd-H":"replace",F3:"findNext","Shift-F3":"findPrev",fallthrough:"macDefault"};g.normalizeKeyMap(n.macSublime);n.pcSublime={"Shift-Tab":"indentLess","Shift-Ctrl-K":"deleteLine","Alt-Q":"wrapLines","Ctrl-T":"transposeChars","Alt-Left":"goSubwordLeft","Alt-Right":"goSubwordRight","Ctrl-Up":"scrollLineUp","Ctrl-Down":"scrollLineDown","Ctrl-L":"selectLine","Shift-Ctrl-L":"splitSelectionByLine",Esc:"singleSelectionTop","Ctrl-Enter":"insertLineAfter","Shift-Ctrl-Enter":"insertLineBefore","Ctrl-D":"selectNextOccurrence","Shift-Ctrl-Space":"selectScope","Shift-Ctrl-M":"selectBetweenBrackets","Ctrl-M":"goToBracket","Shift-Ctrl-Up":"swapLineUp","Shift-Ctrl-Down":"swapLineDown","Ctrl-/":"toggleCommentIndented","Ctrl-J":"joinLines","Shift-Ctrl-D":"duplicateLine",F9:"sortLines","Ctrl-F9":"sortLinesInsensitive",F2:"nextBookmark","Shift-F2":"prevBookmark","Ctrl-F2":"toggleBookmark","Shift-Ctrl-F2":"clearBookmarks","Alt-F2":"selectBookmarks",Backspace:"smartBackspace","Ctrl-K Ctrl-K":"delLineRight","Ctrl-K Ctrl-U":"upcaseAtCursor","Ctrl-K Ctrl-L":"downcaseAtCursor","Ctrl-K Ctrl-Space":"setSublimeMark","Ctrl-K Ctrl-A":"selectToSublimeMark","Ctrl-K Ctrl-W":"deleteToSublimeMark","Ctrl-K Ctrl-X":"swapWithSublimeMark","Ctrl-K Ctrl-Y":"sublimeYank","Ctrl-K Ctrl-C":"showInCenter","Ctrl-K Ctrl-G":"clearBookmarks","Ctrl-K Ctrl-Backspace":"delLineLeft","Ctrl-K Ctrl-0":"unfoldAll","Ctrl-K Ctrl-J":"unfoldAll","Ctrl-Alt-Up":"addCursorToPrevLine","Ctrl-Alt-Down":"addCursorToNextLine","Ctrl-F3":"findUnder","Shift-Ctrl-F3":"findUnderPrevious","Alt-F3":"findAllUnder","Shift-Ctrl-[":"fold","Shift-Ctrl-]":"unfold","Ctrl-I":"findIncremental","Shift-Ctrl-I":"findIncrementalReverse","Ctrl-H":"replace",F3:"findNext","Shift-F3":"findPrev",fallthrough:"pcDefault"};g.normalizeKeyMap(n.pcSublime);var o=n["default"]==n.macDefault;n.sublime=o?n.macSublime:n.pcSublime});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"),"cjs")}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],function(b){a(b,"amd")})}else{a(CodeMirror,"plain")}}})(function(a,c){if(!a.modeURL){a.modeURL="../mode/%N/%N.js"}var e={};function d(f,j){var g=j;return function(){if(--g==0){f()}}}function b(n,f){var m=a.modes[n].dependencies;if(!m){return f()}var l=[];for(var j=0;j<m.length;++j){if(!a.modes.hasOwnProperty(m[j])){l.push(m[j])}}if(!l.length){return f()}var g=d(f,l.length);for(var j=0;j<l.length;++j){a.requireMode(l[j],g)}}a.requireMode=function(n,f){if(typeof n!="string"){n=n.name}if(a.modes.hasOwnProperty(n)){return b(n,f)}if(e.hasOwnProperty(n)){return e[n].push(f)}var j=a.modeURL.replace(/%N/g,n);if(c=="plain"){var g=document.createElement("script");g.src=j;var l=document.getElementsByTagName("script")[0];var m=e[n]=[f];a.on(g,"load",function(){b(n,function(){for(var o=0;o<m.length;++o){m[o]()}})});l.parentNode.insertBefore(g,l)}else{if(c=="cjs"){require(j);f()}else{if(c=="amd"){requirejs([j],f)}}}};a.autoLoadMode=function(f,g){if(!a.modes.hasOwnProperty(g)){a.requireMode(g,function(){f.setOption("mode",f.getOption("mode"))})}}});var JSHINT=(function(){var a4,A={"<":true,"<=":true,"==":true,"===":true,"!==":true,"!=":true,">":true,">=":true,"+":true,"-":true,"*":true,"/":true,"%":true},r={asi:true,bitwise:true,boss:true,browser:true,couch:true,curly:true,debug:true,devel:true,dojo:true,eqeqeq:true,eqnull:true,es5:true,esnext:true,evil:true,expr:true,forin:true,funcscope:true,globalstrict:true,immed:true,iterator:true,jquery:true,lastsemic:true,latedef:true,laxbreak:true,laxcomma:true,loopfunc:true,mootools:true,multistr:true,newcap:true,noarg:true,node:true,noempty:true,nonew:true,nonstandard:true,nomen:true,onevar:true,onecase:true,passfail:true,plusplus:true,proto:true,prototypejs:true,regexdash:true,regexp:true,rhino:true,undef:true,scripturl:true,shadow:true,smarttabs:true,strict:true,sub:true,supernew:true,trailing:true,validthis:true,withstmt:true,white:true,wsh:true},aq={maxlen:false,indent:false,maxerr:false,predef:false},aM={bitwise:true,forin:true,newcap:true,nomen:true,plusplus:true,regexp:true,undef:true,white:true,eqeqeq:true,onevar:true},x={eqeq:"eqeqeq",vars:"onevar",windows:"wsh"},a0={ArrayBuffer:false,ArrayBufferView:false,Audio:false,addEventListener:false,applicationCache:false,atob:false,blur:false,btoa:false,clearInterval:false,clearTimeout:false,close:false,closed:false,DataView:false,DOMParser:false,defaultStatus:false,document:false,event:false,FileReader:false,Float32Array:false,Float64Array:false,FormData:false,focus:false,frames:false,getComputedStyle:false,HTMLElement:false,HTMLAnchorElement:false,HTMLBaseElement:false,HTMLBlockquoteElement:false,HTMLBodyElement:false,HTMLBRElement:false,HTMLButtonElement:false,HTMLCanvasElement:false,HTMLDirectoryElement:false,HTMLDivElement:false,HTMLDListElement:false,HTMLFieldSetElement:false,HTMLFontElement:false,HTMLFormElement:false,HTMLFrameElement:false,HTMLFrameSetElement:false,HTMLHeadElement:false,HTMLHeadingElement:false,HTMLHRElement:false,HTMLHtmlElement:false,HTMLIFrameElement:false,HTMLImageElement:false,HTMLInputElement:false,HTMLIsIndexElement:false,HTMLLabelElement:false,HTMLLayerElement:false,HTMLLegendElement:false,HTMLLIElement:false,HTMLLinkElement:false,HTMLMapElement:false,HTMLMenuElement:false,HTMLMetaElement:false,HTMLModElement:false,HTMLObjectElement:false,HTMLOListElement:false,HTMLOptGroupElement:false,HTMLOptionElement:false,HTMLParagraphElement:false,HTMLParamElement:false,HTMLPreElement:false,HTMLQuoteElement:false,HTMLScriptElement:false,HTMLSelectElement:false,HTMLStyleElement:false,HTMLTableCaptionElement:false,HTMLTableCellElement:false,HTMLTableColElement:false,HTMLTableElement:false,HTMLTableRowElement:false,HTMLTableSectionElement:false,HTMLTextAreaElement:false,HTMLTitleElement:false,HTMLUListElement:false,HTMLVideoElement:false,history:false,Int16Array:false,Int32Array:false,Int8Array:false,Image:false,length:false,localStorage:false,location:false,MessageChannel:false,MessageEvent:false,MessagePort:false,moveBy:false,moveTo:false,name:false,navigator:false,onbeforeunload:true,onblur:true,onerror:true,onfocus:true,onload:true,onresize:true,onunload:true,open:false,openDatabase:false,opener:false,Option:false,parent:false,print:false,removeEventListener:false,resizeBy:false,resizeTo:false,screen:false,scroll:false,scrollBy:false,scrollTo:false,sessionStorage:false,setInterval:false,setTimeout:false,SharedWorker:false,status:false,top:false,Uint16Array:false,Uint32Array:false,Uint8Array:false,WebSocket:false,window:false,Worker:false,XMLHttpRequest:false,XMLSerializer:false,XPathEvaluator:false,XPathException:false,XPathExpression:false,XPathNamespace:false,XPathNSResolver:false,XPathResult:false},be={require:false,respond:false,getRow:false,emit:false,send:false,start:false,sum:false,log:false,exports:false,module:false,provides:false},B={alert:false,confirm:false,console:false,Debug:false,opera:false,prompt:false},X={dojo:false,dijit:false,dojox:false,define:false,require:false},N={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"/":"\\/","\\":"\\\\"},aH,aS=["closure","exception","global","label","outer","unused","var"],I,J,aY,aI,av,m,bi={"$":false,jQuery:false},bc,S,aN,aZ,a2={"$":false,"$$":false,Assets:false,Browser:false,Chain:false,Class:false,Color:false,Cookie:false,Core:false,Document:false,DomReady:false,DOMReady:false,Drag:false,Element:false,Elements:false,Event:false,Events:false,Fx:false,Group:false,Hash:false,HtmlTable:false,Iframe:false,IframeShim:false,InputValidator:false,instanceOf:false,Keyboard:false,Locale:false,Mask:false,MooTools:false,Native:false,Options:false,OverText:false,Request:false,Scroller:false,Slick:false,Slider:false,Sortables:false,Spinner:false,Swiff:false,Tips:false,Type:false,typeOf:false,URI:false,Window:false},n,ay={__filename:false,__dirname:false,Buffer:false,console:false,exports:false,GLOBAL:false,global:false,module:false,process:false,require:false,setTimeout:false,clearTimeout:false,setInterval:false,clearInterval:false},L,ab,a7,w,aU,d={"$":false,"$$":false,"$A":false,"$F":false,"$H":false,"$R":false,"$break":false,"$continue":false,"$w":false,Abstract:false,Ajax:false,Class:false,Enumerable:false,Element:false,Event:false,Field:false,Form:false,Hash:false,Insertion:false,ObjectRange:false,PeriodicalExecuter:false,Position:false,Prototype:false,Selector:false,Template:false,Toggle:false,Try:false,Autocompleter:false,Builder:false,Control:false,Draggable:false,Draggables:false,Droppables:false,Effect:false,Sortable:false,SortableObserver:false,Sound:false,Scriptaculous:false},af={defineClass:false,deserialize:false,gc:false,help:false,importPackage:false,java:false,load:false,loadClass:false,print:false,quit:false,readFile:false,readUrl:false,runCommand:false,seal:false,serialize:false,spawn:false,sync:false,toint32:false,version:false},aK,aD,bb={Array:false,Boolean:false,Date:false,decodeURI:false,decodeURIComponent:false,encodeURI:false,encodeURIComponent:false,Error:false,"eval":false,EvalError:false,Function:false,hasOwnProperty:false,isFinite:false,isNaN:false,JSON:false,Math:false,Number:false,Object:false,parseInt:false,parseFloat:false,RangeError:false,ReferenceError:false,RegExp:false,String:false,SyntaxError:false,TypeError:false,URIError:false},aC={escape:false,unescape:false},O={E:true,LN2:true,LN10:true,LOG2E:true,LOG10E:true,MAX_VALUE:true,MIN_VALUE:true,NEGATIVE_INFINITY:true,PI:true,POSITIVE_INFINITY:true,SQRT1_2:true,SQRT2:true},aF,a={},q,aJ,aa,U,H,e={ActiveXObject:true,Enumerator:true,GetObject:true,ScriptEngine:true,ScriptEngineBuildVersion:true,ScriptEngineMajorVersion:true,ScriptEngineMinorVersion:true,VBArray:true,WSH:true,WScript:true,XDomainRequest:true};var aw,R,al,ag,aj,a3,T,D,a1;(function(){aw=/@cc|<\/?|script|\]\s*\]|<\s*!|&lt/i;R=/[\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/;al=/^\s*([(){}\[.,:;'"~\?\]#@]|==?=?|\/(\*(jshint|jslint|members?|global)?|=|\/)?|\*[\/=]?|\+(?:=|\++)?|-(?:=|-+)?|%=?|&[&=]?|\|[|=]?|>>?>?=?|<([\/=!]|\!(\[|--)?|<=?)?|\^=?|\!=?=?|[a-zA-Z_$][a-zA-Z0-9_$]*|[0-9]+([xX][0-9a-fA-F]+|\.[0-9]*)?([eE][+\-]?[0-9]+)?)/;ag=/[\u0000-\u001f&<"\/\\\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/;aj=/[\u0000-\u001f&<"\/\\\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;a3=/\*\/|\/\*/;T=/^([a-zA-Z_$][a-zA-Z0-9_$]*)$/;D=/^(?:javascript|jscript|ecmascript|vbscript|mocha|livescript)\s*:/i;a1=/^\s*\/\*\s*falls\sthrough\s*\*\/\s*$/}());function aA(){}function aX(ax,F){return Object.prototype.hasOwnProperty.call(ax,F)}function a9(F,ax){if(aq[F]===undefined&&r[F]===undefined){at("Bad option: '"+F+"'.",ax)}}if(typeof Array.isArray!=="function"){Array.isArray=function(F){return Object.prototype.toString.apply(F)==="[object Array]"}}if(typeof Object.create!=="function"){Object.create=function(F){aA.prototype=F;return new aA()}}if(typeof Object.keys!=="function"){Object.keys=function(bj){var F=[],ax;for(ax in bj){if(aX(bj,ax)){F.push(ax)}}return F}}if(typeof String.prototype.entityify!=="function"){String.prototype.entityify=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}}if(typeof String.prototype.isAlpha!=="function"){String.prototype.isAlpha=function(){return(this>="a"&&this<="z\uffff")||(this>="A"&&this<="Z\uffff")}}if(typeof String.prototype.isDigit!=="function"){String.prototype.isDigit=function(){return(this>="0"&&this<="9")}}if(typeof String.prototype.supplant!=="function"){String.prototype.supplant=function(F){return this.replace(/\{([^{}]*)\}/g,function(bj,ax){var bk=F[ax];return typeof bk==="string"||typeof bk==="number"?bk:bj})}}if(typeof String.prototype.name!=="function"){String.prototype.name=function(){if(T.test(this)){return this}if(ag.test(this)){return'"'+this.replace(aj,function(F){var ax=N[F];if(ax){return ax}return"\\u"+("0000"+F.charCodeAt().toString(16)).slice(-4)})+'"'}return'"'+this+'"'}}function bg(F,ax){var bj;for(bj in ax){if(aX(ax,bj)){F[bj]=ax[bj]}}}function an(){if(ab.couch){bg(a7,be)}if(ab.rhino){bg(a7,af)}if(ab.prototypejs){bg(a7,d)}if(ab.node){bg(a7,ay);ab.globalstrict=true}if(ab.devel){bg(a7,B)}if(ab.dojo){bg(a7,X)}if(ab.browser){bg(a7,a0)}if(ab.nonstandard){bg(a7,aC)}if(ab.jquery){bg(a7,bi)}if(ab.mootools){bg(a7,a2)}if(ab.wsh){bg(a7,e)}if(ab.esnext){U()}if(ab.globalstrict&&ab.strict!==false){ab.strict=true}}function az(bk,ax,bj){var F=Math.floor((ax/bc.length)*100);throw {name:"JSHintError",line:ax,character:bj,message:bk+" ("+F+"% scanned).",raw:bk}}function c(bk,F,bj,ax){return JSHINT.undefs.push([bk,F,bj,ax])}function at(ax,bp,bn,bm,bl,bk){var F,bj,bo;bp=bp||n;if(bp.id==="(end)"){bp=aJ}bj=bp.line||0;F=bp.from||0;bo={id:"(error)",raw:ax,evidence:bc[bj-1]||"",line:bj,character:F,a:bn,b:bm,c:bl,d:bk};bo.reason=ax.supplant(bo);JSHINT.errors.push(bo);if(ab.passfail){az("Stopping. ",bj,F)}H+=1;if(H>=ab.maxerr){az("Too many errors.",bj,F)}return bo}function ah(ax,bk,bl,bj,F,bn,bm){return at(ax,{line:bk,from:bl},bj,F,bn,bm)}function aO(ax,bl,bk,F,bn,bm){var bj=at(ax,bl,bk,F,bn,bm)}function ad(ax,bk,bl,bj,F,bn,bm){return aO(ax,{line:bk,from:bl},bj,F,bn,bm)}var ar=(function ar(){var bl,bm,F,bj;function bk(){var bn,bo;if(F>=bc.length){return false}bl=1;bj=bc[F];F+=1;if(ab.smarttabs){bn=bj.search(/ \t/)}else{bn=bj.search(/ \t|\t /)}if(bn>=0){ah("Mixed spaces and tabs.",F,bn+1)}bj=bj.replace(/\t/g,q);bn=bj.search(R);if(bn>=0){ah("Unsafe character.",F,bn)}if(ab.maxlen&&ab.maxlen<bj.length){ah("Line too long.",F,bj.length)}bo=ab.trailing&&bj.match(/^(.*?)\s+$/);if(bo&&!/^\s+$/.test(bj)){ah("Trailing whitespace.",F,bo[1].length+1)}return true}function ax(bp,bq){var bo,bn;if(bp==="(color)"||bp==="(range)"){bn={type:bp}}else{if(bp==="(punctuator)"||(bp==="(identifier)"&&aX(a,bq))){bn=a[bq]||a["(error)"]}else{bn=a[bp]}}bn=Object.create(bn);if(bp==="(string)"||bp==="(range)"){if(!ab.scripturl&&D.test(bq)){ah("Script URL.",F,bm)}}if(bp==="(identifier)"){bn.identifier=true;if(bq==="__proto__"&&!ab.proto){ah("The '{a}' property is deprecated.",F,bm,bq)}else{if(bq==="__iterator__"&&!ab.iterator){ah("'{a}' is only available in JavaScript 1.7.",F,bm,bq)}else{if(ab.nomen&&(bq.charAt(0)==="_"||bq.charAt(bq.length-1)==="_")){if(!ab.node||aJ.id==="."||(bq!=="__dirname"&&bq!=="__filename")){ah("Unexpected {a} in '{b}'.",F,bm,"dangling '_'",bq)}}}}}bn.value=bq;bn.line=F;bn.character=bl;bn.from=bm;bo=bn.id;if(bo!=="(endline)"){w=bo&&(("(,=:[!&|?{};".indexOf(bo.charAt(bo.length-1))>=0)||bo==="return"||bo==="case")}return bn}return{init:function(bn){if(typeof bn==="string"){bc=bn.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split("\n")}else{bc=bn}if(bc[0]&&bc[0].substr(0,2)==="#!"){bc[0]=""}F=0;bk();bm=1},range:function(bo,bn){var bq,bp="";bm=bl;if(bj.charAt(0)!==bo){ad("Expected '{a}' and instead saw '{b}'.",F,bl,bo,bj.charAt(0))}for(;;){bj=bj.slice(1);bl+=1;bq=bj.charAt(0);switch(bq){case"":ad("Missing '{a}'.",F,bl,bq);break;case bn:bj=bj.slice(1);bl+=1;return ax("(range)",bp);case"\\":ah("Unexpected '{a}'.",F,bl,bq)}bp+=bq}},token:function(){var bB,bA,bp,by,bu,bt,bv,br,bz,bo,bC,bn,bs,bq;function bw(bD){var bF=bD.exec(bj),bE;if(bF){br=bF[0].length;bE=bF[1];bA=bE.charAt(0);bj=bj.substr(br);bm=bl+br-bE.length;bl+=br;return bE}}function bx(bD){var bK,bG,bH="",bJ=false;if(m&&bD!=='"'){ah("Strings must use doublequote.",F,bl)}function bF(bM){var bL=parseInt(bj.substr(bG+1,bM),16);bG+=bM;if(bL>=32&&bL<=126&&bL!==34&&bL!==92&&bL!==39){ah("Unnecessary escapement.",F,bl)}bl+=bM;bK=String.fromCharCode(bL)}bG=0;unclosedString:for(;;){while(bG>=bj.length){bG=0;var bE=F,bI=bm;if(!bk()){ad("Unclosed string.",bE,bI);break unclosedString}if(bJ){bJ=false}else{ah("Unclosed string.",bE,bI)}}bK=bj.charAt(bG);if(bK===bD){bl+=1;bj=bj.substr(bG+1);return ax("(string)",bH,bD)}if(bK<" "){if(bK==="\n"||bK==="\r"){break}ah("Control character in string: {a}.",F,bl+bG,bj.slice(0,bG))}else{if(bK==="\\"){bG+=1;bl+=1;bK=bj.charAt(bG);bq=bj.charAt(bG+1);switch(bK){case"\\":case'"':case"/":break;case"'":if(m){ah("Avoid \\'.",F,bl)}break;case"b":bK="\b";break;case"f":bK="\f";break;case"n":bK="\n";break;case"r":bK="\r";break;case"t":bK="\t";break;case"0":bK="\0";if(bq>=0&&bq<=7&&aF["use strict"]){ah("Octal literals are not allowed in strict mode.",F,bl)}break;case"u":bF(4);break;case"v":if(m){ah("Avoid \\v.",F,bl)}bK="\v";break;case"x":if(m){ah("Avoid \\x-.",F,bl)}bF(2);break;case"":bJ=true;if(ab.multistr){if(m){ah("Avoid EOL escapement.",F,bl)}bK="";bl-=1;break}ah("Bad escapement of EOL. Use option multistr if needed.",F,bl);break;default:ah("Bad escapement.",F,bl)}}}bH+=bK;bl+=1;bG+=1}}for(;;){if(!bj){return ax(bk()?"(endline)":"(end)","")}bC=bw(al);if(!bC){bC="";bA="";while(bj&&bj<"!"){bj=bj.substr(1)}if(bj){ad("Unexpected '{a}'.",F,bl,bj.substr(0,1));bj=""}}else{if(bA.isAlpha()||bA==="_"||bA==="$"){return ax("(identifier)",bC)}if(bA.isDigit()){if(!isFinite(Number(bC))){ah("Bad number '{a}'.",F,bl,bC)}if(bj.substr(0,1).isAlpha()){ah("Missing space after '{a}'.",F,bl,bC)}if(bA==="0"){by=bC.substr(1,1);if(by.isDigit()){if(aJ.id!=="."){ah("Don't use extra leading zeros '{a}'.",F,bl,bC)}}else{if(m&&(by==="x"||by==="X")){ah("Avoid 0x-. '{a}'.",F,bl,bC)}}}if(bC.substr(bC.length-1)==="."){ah("A trailing decimal point can be confused with a dot '{a}'.",F,bl,bC)}return ax("(number)",bC)}switch(bC){case'"':case"'":return bx(bC);case"//":bj="";aJ.comment=true;break;case"/*":for(;;){bv=bj.search(a3);if(bv>=0){break}if(!bk()){ad("Unclosed comment.",F,bl)}}bl+=bv+2;if(bj.substr(bv,1)==="/"){ad("Nested comment.",F,bl)}bj=bj.substr(bv+2);aJ.comment=true;break;case"/*members":case"/*member":case"/*jshint":case"/*jslint":case"/*global":case"*/":return{value:bC,type:"special",line:F,character:bl,from:bm};case"":break;case"/":if(aJ.id==="/="){ad("A regular expression literal can be confused with '/='.",F,bm)}if(w){bu=0;bp=0;br=0;for(;;){bB=true;bA=bj.charAt(br);br+=1;switch(bA){case"":ad("Unclosed regular expression.",F,bm);return az("Stopping.",F,bm);case"/":if(bu>0){ah("{a} unterminated regular expression group(s).",F,bm+br,bu)}bA=bj.substr(0,br-1);bo={g:true,i:true,m:true};while(bo[bj.charAt(br)]===true){bo[bj.charAt(br)]=false;br+=1}bl+=br;bj=bj.substr(br);bo=bj.charAt(0);if(bo==="/"||bo==="*"){ad("Confusing regular expression.",F,bm)}return ax("(regexp)",bA);case"\\":bA=bj.charAt(br);if(bA<" "){ah("Unexpected control character in regular expression.",F,bm+br)}else{if(bA==="<"){ah("Unexpected escaped character '{a}' in regular expression.",F,bm+br,bA)}}br+=1;break;case"(":bu+=1;bB=false;if(bj.charAt(br)==="?"){br+=1;switch(bj.charAt(br)){case":":case"=":case"!":br+=1;break;default:ah("Expected '{a}' and instead saw '{b}'.",F,bm+br,":",bj.charAt(br))}}else{bp+=1}break;case"|":bB=false;break;case")":if(bu===0){ah("Unescaped '{a}'.",F,bm+br,")")}else{bu-=1}break;case" ":bo=1;while(bj.charAt(br)===" "){br+=1;bo+=1}if(bo>1){ah("Spaces are hard to count. Use {{a}}.",F,bm+br,bo)}break;case"[":bA=bj.charAt(br);if(bA==="^"){br+=1;if(ab.regexp){ah("Insecure '{a}'.",F,bm+br,bA)}else{if(bj.charAt(br)==="]"){ad("Unescaped '{a}'.",F,bm+br,"^")}}}if(bA==="]"){ah("Empty class.",F,bm+br-1)}bn=false;bs=false;klass:do{bA=bj.charAt(br);br+=1;switch(bA){case"[":case"^":ah("Unescaped '{a}'.",F,bm+br,bA);if(bs){bs=false}else{bn=true}break;case"-":if(bn&&!bs){bn=false;bs=true}else{if(bs){bs=false}else{if(bj.charAt(br)==="]"){bs=true}else{if(ab.regexdash!==(br===2||(br===3&&bj.charAt(1)==="^"))){ah("Unescaped '{a}'.",F,bm+br-1,"-")}bn=true}}}break;case"]":if(bs&&!ab.regexdash){ah("Unescaped '{a}'.",F,bm+br-1,"-")}break klass;case"\\":bA=bj.charAt(br);if(bA<" "){ah("Unexpected control character in regular expression.",F,bm+br)}else{if(bA==="<"){ah("Unexpected escaped character '{a}' in regular expression.",F,bm+br,bA)}}br+=1;if(/[wsd]/i.test(bA)){if(bs){ah("Unescaped '{a}'.",F,bm+br,"-");bs=false}bn=false}else{if(bs){bs=false}else{bn=true}}break;case"/":ah("Unescaped '{a}'.",F,bm+br-1,"/");if(bs){bs=false}else{bn=true}break;case"<":if(bs){bs=false}else{bn=true}break;default:if(bs){bs=false}else{bn=true}}}while(bA);break;case".":if(ab.regexp){ah("Insecure '{a}'.",F,bm+br,bA)}break;case"]":case"?":case"{":case"}":case"+":case"*":ah("Unescaped '{a}'.",F,bm+br,bA)}if(bB){switch(bj.charAt(br)){case"?":case"+":case"*":br+=1;if(bj.charAt(br)==="?"){br+=1}break;case"{":br+=1;bA=bj.charAt(br);if(bA<"0"||bA>"9"){ah("Expected a number and instead saw '{a}'.",F,bm+br,bA)}br+=1;bz=+bA;for(;;){bA=bj.charAt(br);if(bA<"0"||bA>"9"){break}br+=1;bz=+bA+(bz*10)}bt=bz;if(bA===","){br+=1;bt=Infinity;bA=bj.charAt(br);if(bA>="0"&&bA<="9"){br+=1;bt=+bA;for(;;){bA=bj.charAt(br);if(bA<"0"||bA>"9"){break}br+=1;bt=+bA+(bt*10)}}}if(bj.charAt(br)!=="}"){ah("Expected '{a}' and instead saw '{b}'.",F,bm+br,"}",bA)}else{br+=1}if(bj.charAt(br)==="?"){br+=1}if(bz>bt){ah("'{a}' should not be greater than '{b}'.",F,bm+br,bz,bt)}}}}bA=bj.substr(0,br-1);bl+=br;bj=bj.substr(br);return ax("(regexp)",bA)}return ax("(punctuator)",bC);case"#":return ax("(punctuator)",bC);default:return ax("(punctuator)",bC)}}}}}}());function C(F,ax){if(F==="hasOwnProperty"){at("'hasOwnProperty' is a really bad name.")}if(aX(aH,F)&&!aH["(global)"]){if(aH[F]===true){if(ab.latedef){at("'{a}' was used before it was defined.",n,F)}}else{if(!ab.shadow&&ax!=="exception"){at("'{a}' is already defined.",n,F)}}}aH[F]=ax;if(aH["(global)"]){J[F]=aH;if(aX(aY,F)){if(ab.latedef){at("'{a}' was used before it was defined.",n,F)}delete aY[F]}}else{aK[F]=aH}}function E(){var ax,bm,bl,bn=n.value,bk,F,bj;switch(bn){case"*/":aO("Unbegun comment.");break;case"/*members":case"/*member":bn="/*members";if(!aZ){aZ={}}bm=aZ;break;case"/*jshint":case"/*jslint":bm=ab;bl=r;break;case"/*global":bm=a7;break;default:aO("What?")}bk=ar.token();loop:for(;;){for(;;){if(bk.type==="special"&&bk.value==="*/"){break loop}if(bk.id!=="(endline)"&&bk.id!==","){break}bk=ar.token()}if(bk.type!=="(string)"&&bk.type!=="(identifier)"&&bn!=="/*members"){aO("Bad option.",bk)}bj=ar.token();if(bj.id===":"){bj=ar.token();if(bm===aZ){aO("Expected '{a}' and instead saw '{b}'.",bk,"*/",":")}if(bn==="/*jshint"){a9(bk.value,bk)}if(bk.value==="indent"&&(bn==="/*jshint"||bn==="/*jslint")){ax=+bj.value;if(typeof ax!=="number"||!isFinite(ax)||ax<=0||Math.floor(ax)!==ax){aO("Expected a small integer and instead saw '{a}'.",bj,bj.value)}bm.white=true;bm.indent=ax}else{if(bk.value==="maxerr"&&(bn==="/*jshint"||bn==="/*jslint")){ax=+bj.value;if(typeof ax!=="number"||!isFinite(ax)||ax<=0||Math.floor(ax)!==ax){aO("Expected a small integer and instead saw '{a}'.",bj,bj.value)}bm.maxerr=ax}else{if(bk.value==="maxlen"&&(bn==="/*jshint"||bn==="/*jslint")){ax=+bj.value;if(typeof ax!=="number"||!isFinite(ax)||ax<=0||Math.floor(ax)!==ax){aO("Expected a small integer and instead saw '{a}'.",bj,bj.value)}bm.maxlen=ax}else{if(bk.value==="validthis"){if(aH["(global)"]){aO("Option 'validthis' can't be used in a global scope.")}else{if(bj.value==="true"||bj.value==="false"){bm[bk.value]=bj.value==="true"}else{aO("Bad option value.",bj)}}}else{if(bj.value==="true"||bj.value==="false"){if(bn==="/*jslint"){F=x[bk.value]||bk.value;bm[F]=bj.value==="true";if(aM[F]!==undefined){bm[F]=!bm[F]}}else{bm[bk.value]=bj.value==="true"}}else{aO("Bad option value.",bj)}}}}}bk=ar.token()}else{if(bn==="/*jshint"||bn==="/*jslint"){aO("Missing option value.",bk)}bm[bk.value]=false;bk=bj}}if(bl){an()}}function aV(bk){var bj=bk||0,F=0,ax;while(F<=bj){ax=S[F];if(!ax){ax=S[F]=ar.token()}F+=1}return ax}function ak(ax,F){switch(aJ.id){case"(number)":if(n.id==="."){at("A dot following a number can be confused with a decimal point.",aJ)}break;case"-":if(n.id==="-"||n.id==="--"){at("Confusing minusses.")}break;case"+":if(n.id==="+"||n.id==="++"){at("Confusing plusses.")}break}if(aJ.type==="(string)"||aJ.identifier){a4=aJ.value}if(ax&&n.id!==ax){if(F){if(n.id==="(end)"){at("Unmatched '{a}'.",F,F.id)}else{at("Expected '{a}' to match '{b}' from line {c} and instead saw '{d}'.",n,ax,F.id,F.line,n.value)}}else{if(n.type!=="(identifier)"||n.value!==ax){at("Expected '{a}' and instead saw '{b}'.",n,ax,n.value)}}}aU=aJ;aJ=n;for(;;){n=S.shift()||ar.token();if(n.id==="(end)"||n.id==="(error)"){return}if(n.type==="special"){E()}else{if(n.id!=="(endline)"){break}}}}function aL(bj,bk){var bl,ax=false,F=false;if(n.id==="(end)"){aO("Unexpected early end of program.",aJ)}ak();if(bk){a4="anonymous";aH["(verb)"]=aJ.value}if(bk===true&&aJ.fud){bl=aJ.fud()}else{if(aJ.nud){bl=aJ.nud()}else{if(n.type==="(number)"&&aJ.id==="."){at("A leading decimal point can be confused with a dot: '.{a}'.",aJ,n.value);ak();return aJ}else{aO("Expected an identifier and instead saw '{a}'.",aJ,aJ.id)}}while(bj<n.lbp){ax=aJ.value==="Array";F=aJ.value==="Object";if(bl&&(bl.value||(bl.first&&bl.first.value))){if(bl.value!=="new"||(bl.first&&bl.first.value&&bl.first.value===".")){ax=false;if(bl.value!==aJ.value){F=false}}}ak();if(ax&&aJ.id==="("&&n.id===")"){at("Use the array literal notation [].",aJ)}if(F&&aJ.id==="("&&n.id===")"){at("Use the object literal notation {}.",aJ)}if(aJ.led){bl=aJ.led(bl)}else{aO("Expected an operator and instead saw '{a}'.",aJ,aJ.id)}}}return bl}function aB(ax,F){ax=ax||aJ;F=F||n;if(ab.white){if(ax.character!==F.from&&ax.line===F.line){ax.from+=(ax.character-ax.from);at("Unexpected space after '{a}'.",ax,ax.value)}}}function aR(ax,F){ax=ax||aJ;F=F||n;if(ab.white&&(ax.character!==F.from||ax.line!==F.line)){at("Unexpected space before '{a}'.",F,F.value)}}function Z(ax,F){ax=ax||aJ;F=F||n;if(ab.white&&!ax.comment){if(ax.line===F.line){aB(ax,F)}}}function Y(ax,F){if(ab.white){ax=ax||aJ;F=F||n;if(ax.line===F.line&&ax.character===F.from){ax.from+=(ax.character-ax.from);at("Missing space after '{a}'.",ax,ax.value)}}}function ap(ax,F){ax=ax||aJ;F=F||n;if(!ab.laxbreak&&ax.line!==F.line){at("Bad line breaking before '{a}'.",F,F.id)}else{if(ab.white){ax=ax||aJ;F=F||n;if(ax.character===F.from){ax.from+=(ax.character-ax.from);at("Missing space after '{a}'.",ax,ax.value)}}}}function b(F){var ax;if(ab.white&&n.id!=="(end)"){ax=av+(F||0);if(n.from!==ax){at("Expected '{a}' to have an indentation at {b} instead at {c}.",n,n.value,ax,n.from)}}}function bf(F){F=F||aJ;if(F.line!==n.line){at("Line breaking error '{a}'.",F,F.value)}}function au(){if(aJ.line!==n.line){if(!ab.laxcomma){if(au.first){at("Comma warnings can be turned off with 'laxcomma'");au.first=false}at("Bad line breaking before '{a}'.",aJ,n.id)}}else{if(!aJ.comment&&aJ.character!==n.from&&ab.white){aJ.from+=(aJ.character-aJ.from);at("Unexpected space after '{a}'.",aJ,aJ.value)}}ak(",");Y(aJ,n)}function W(ax,bj){var F=a[ax];if(!F||typeof F!=="object"){a[ax]=F={id:ax,lbp:bj,value:ax}}return F}function aT(F){return W(F,0)}function g(ax,bj){var F=aT(ax);F.identifier=F.reserved=true;F.fud=bj;return F}function a6(ax,bj){var F=g(ax,bj);F.block=true;return F}function K(F){var ax=F.id.charAt(0);if((ax>="a"&&ax<="z")||(ax>="A"&&ax<="Z")){F.identifier=F.reserved=true}return F}function aP(ax,bj){var F=W(ax,150);K(F);F.nud=(typeof bj==="function")?bj:function(){this.right=aL(150);this.arity="unary";if(this.id==="++"||this.id==="--"){if(ab.plusplus){at("Unexpected use of '{a}'.",this,this.id)}else{if((!this.right.identifier||this.right.reserved)&&this.right.id!=="."&&this.right.id!=="["){at("Bad operand.",this)}}}return this};return F}function ai(ax,bj){var F=aT(ax);F.type=ax;F.nud=bj;return F}function u(ax,bj){var F=ai(ax,bj);F.identifier=F.reserved=true;return F}function ac(ax,F){return u(ax,function(){if(typeof F==="function"){F(this)}return this})}function G(bj,bk,bl,ax){var F=W(bj,bl);K(F);F.led=function(bm){if(!ax){ap(aU,aJ);Y(aJ,n)}if(bj==="in"&&bm.id==="!"){at("Confusing use of '{a}'.",bm,"!")}if(typeof bk==="function"){return bk(bm,this)}else{this.left=bm;this.right=aL(bl);return this}};return F}function ba(ax,bj){var F=W(ax,100);F.led=function(bl){ap(aU,aJ);Y(aJ,n);var bk=aL(100);if((bl&&bl.id==="NaN")||(bk&&bk.id==="NaN")){at("Use the isNaN function to compare with NaN.",this)}else{if(bj){bj.apply(this,[bl,bk])}}if(bl.id==="!"){at("Confusing use of '{a}'.",bl,"!")}if(bk.id==="!"){at("Confusing use of '{a}'.",bk,"!")}this.left=bl;this.right=bk;return this};return F}function bh(F){return F&&((F.type==="(number)"&&+F.value===0)||(F.type==="(string)"&&F.value==="")||(F.type==="null"&&!ab.eqnull)||F.type==="true"||F.type==="false"||F.type==="undefined")}function ao(F,ax){W(F,20).exps=true;return G(F,function(bl,bk){var bj;bk.left=bl;if(a7[bl.value]===false&&aK[bl.value]["(global)"]===true){at("Read only.",bl)}else{if(bl["function"]){at("'{a}' is a function.",bl,bl.value)}}if(bl){if(ab.esnext&&aH[bl.value]==="const"){at("Attempting to override '{a}' which is a constant",bl,bl.value)}if(bl.id==="."||bl.id==="["){if(!bl.left||bl.left.value==="arguments"){at("Bad assignment.",bk)}bk.right=aL(19);return bk}else{if(bl.identifier&&!bl.reserved){if(aH[bl.value]==="exception"){at("Do not assign to the exception parameter.",bl)}bk.right=aL(19);return bk}}if(bl===a["function"]){at("Expected an identifier in an assignment and instead saw a function invocation.",aJ)}}aO("Bad assignment.",bk)},20)}function aG(ax,bj,bk){var F=W(ax,bk);K(F);F.led=(typeof bj==="function")?bj:function(bl){if(ab.bitwise){at("Unexpected use of '{a}'.",this,this.id)}this.left=bl;this.right=aL(bk);return this};return F}function l(F){W(F,20).exps=true;return G(F,function(bj,ax){if(ab.bitwise){at("Unexpected use of '{a}'.",ax,ax.id)}Y(aU,aJ);Y(aJ,n);if(bj){if(bj.id==="."||bj.id==="["||(bj.identifier&&!bj.reserved)){aL(19);return ax}if(bj===a["function"]){at("Expected an identifier in an assignment, and instead saw a function invocation.",aJ)}return ax}aO("Bad assignment.",ax)},20)}function aE(ax,bj){var F=W(ax,150);F.led=function(bk){if(ab.plusplus){at("Unexpected use of '{a}'.",this,this.id)}else{if((!bk.identifier||bk.reserved)&&bk.id!=="."&&bk.id!=="["){at("Bad operand.",this)}}this.left=bk;return this};return F}function o(F){if(n.identifier){ak();if(aJ.reserved&&!ab.es5){if(!F||aJ.value!=="undefined"){at("Expected an identifier and instead saw '{a}' (a reserved word).",aJ,aJ.id)}}return aJ.value}}function am(F){var ax=o(F);if(ax){return ax}if(aJ.id==="function"&&n.id==="("){}else{aO("Expected an identifier and instead saw '{a}'.",n,n.value)}}function ae(bj){var ax=0,F;if(n.id!==";"||L){return}for(;;){F=aV(ax);if(F.reach){return}if(F.id!=="(endline)"){if(F.id==="function"){if(!ab.latedef){break}at("Inner functions should be listed at the top of the outer function.",F);break}at("Unreachable '{a}' after '{b}'.",F,F.value,bj);break}ax+=1}}function bd(bl){var ax=av,bk,bj=aK,F=n;if(F.id===";"){ak(";");return}if(F.identifier&&!F.reserved&&aV().id===":"){ak();ak(":");aK=Object.create(bj);C(F.value,"label");if(!n.labelled){at("Label '{a}' on {b} statement.",n,F.value,n.value)}if(D.test(F.value+":")){at("Label '{a}' looks like a javascript url.",F,F.value)}n.label=F.value;F=n}if(!bl){b()}bk=aL(0,true);if(!F.block){if(!ab.expr&&(!bk||!bk.exps)){at("Expected an assignment or function call and instead saw an expression.",aJ)}else{if(ab.nonew&&bk.id==="("&&bk.left.id==="new"){at("Do not use 'new' for side effects.")}}if(n.id===","){return au()}if(n.id!==";"){if(!ab.asi){if(!ab.lastsemic||n.id!=="}"||n.line!==aJ.line){ah("Missing semicolon.",aJ.line,aJ.character)}}}else{aB(aJ,n);ak(";");Y(aJ,n)}}av=ax;aK=bj;return bk}function aQ(bk){var F=[],ax,bj;while(!n.reach&&n.id!=="(end)"){if(n.id===";"){bj=aV();if(!bj||bj.id!=="("){at("Unnecessary semicolon.")}ak(";")}else{F.push(bd(bk===n.line))}}return F}function a5(){var ax,bj,F;for(;;){if(n.id==="(string)"){bj=aV(0);if(bj.id==="(endline)"){ax=1;do{F=aV(ax);ax=ax+1}while(F.id==="(endline)");if(F.id!==";"){if(F.id!=="(string)"&&F.id!=="(number)"&&F.id!=="(regexp)"&&F.identifier!==true&&F.id!=="}"){break}at("Missing semicolon.",n)}else{bj=F}}else{if(bj.id==="}"){at("Missing semicolon.",bj)}else{if(bj.id!==";"){break}}}b();ak();if(aF[aJ.value]){at('Unnecessary directive "{a}".',aJ,aJ.value)}if(aJ.value==="use strict"){ab.newcap=true;ab.undef=true}aF[aJ.value]=true;if(bj.id===";"){ak(";")}continue}break}}function M(bo,ax,bk){var bn,bm=aI,F=av,bj,br=aK,bp,bq,bl;aI=bo;if(!bo||!ab.funcscope){aK=Object.create(aK)}Y(aJ,n);bp=n;if(n.id==="{"){ak("{");bq=aJ.line;if(n.id!=="}"){av+=ab.indent;while(!bo&&n.from>av){av+=ab.indent}if(bk){bj={};for(bl in aF){if(aX(aF,bl)){bj[bl]=aF[bl]}}a5();if(ab.strict&&aH["(context)"]["(global)"]){if(!bj["use strict"]&&!aF["use strict"]){at('Missing "use strict" statement.')}}}bn=aQ(bq);if(bk){aF=bj}av-=ab.indent;if(bq!==n.line){b()}}else{if(bq!==n.line){b()}}ak("}",bp);av=F}else{if(!bo){aO("Expected '{a}' and instead saw '{b}'.",n,"{",n.value)}else{if(!ax||ab.curly){at("Expected '{a}' and instead saw '{b}'.",n,"{",n.value)}L=true;av+=ab.indent;bn=[bd(n.line===aJ.line)];av-=ab.indent;L=false}}aH["(verb)"]=null;if(!bo||!ab.funcscope){aK=br}aI=bm;if(bo&&ab.noempty&&(!bn||bn.length===0)){at("Empty block.")}return bn}function j(F){if(aZ&&typeof aZ[F]!=="boolean"){at("Unexpected /*member '{a}'.",aJ,F)}if(typeof aN[F]==="number"){aN[F]+=1}else{aN[F]=1}}function a8(bk){var bj=bk.value,ax=bk.line,F=aY[bj];if(typeof F==="function"){F=false}if(!F){F=[ax];aY[bj]=F}else{if(F[F.length-1]!==ax){F.push(ax)}}}ai("(number)",function(){return this});ai("(string)",function(){return this});a["(identifier)"]={type:"(identifier)",lbp:0,identifier:true,nud:function(){var F=this.value,ax=aK[F],bj;if(typeof ax==="function"){ax=undefined}else{if(typeof ax==="boolean"){bj=aH;aH=I[0];C(F,"var");ax=aH;aH=bj}}if(aH===ax){switch(aH[F]){case"unused":aH[F]="var";break;case"unction":aH[F]="function";this["function"]=true;break;case"function":this["function"]=true;break;case"label":at("'{a}' is a statement label.",aJ,F);break}}else{if(aH["(global)"]){if(ab.undef&&typeof a7[F]!=="boolean"){if(!(a4==="typeof"||a4==="delete")||(n&&(n.value==="."||n.value==="["))){c(aH,"'{a}' is not defined.",aJ,F)}}a8(aJ)}else{switch(aH[F]){case"closure":case"function":case"var":case"unused":at("'{a}' used out of scope.",aJ,F);break;case"label":at("'{a}' is a statement label.",aJ,F);break;case"outer":case"global":break;default:if(ax===true){aH[F]=true}else{if(ax===null){at("'{a}' is not allowed.",aJ,F);a8(aJ)}else{if(typeof ax!=="object"){if(ab.undef){if(!(a4==="typeof"||a4==="delete")||(n&&(n.value==="."||n.value==="["))){c(aH,"'{a}' is not defined.",aJ,F)}}aH[F]=true;a8(aJ)}else{switch(ax[F]){case"function":case"unction":this["function"]=true;ax[F]="closure";aH[F]=ax["(global)"]?"global":"outer";break;case"var":case"unused":ax[F]="closure";aH[F]=ax["(global)"]?"global":"outer";break;case"closure":case"parameter":aH[F]=ax["(global)"]?"global":"outer";break;case"label":at("'{a}' is a statement label.",aJ,F)}}}}}}}return this},led:function(){aO("Expected an operator and instead saw '{a}'.",n,n.value)}};ai("(regexp)",function(){return this});aT("(endline)");aT("(begin)");aT("(end)").reach=true;aT("</").reach=true;aT("<!");aT("<!--");aT("-->");aT("(error)").reach=true;aT("}").reach=true;aT(")");aT("]");aT('"').reach=true;aT("'").reach=true;aT(";");aT(":").reach=true;aT(",");aT("#");aT("@");u("else");u("case").reach=true;u("catch");u("default").reach=true;u("finally");ac("arguments",function(F){if(aF["use strict"]&&aH["(global)"]){at("Strict violation.",F)}});ac("eval");ac("false");ac("Infinity");ac("NaN");ac("null");ac("this",function(F){if(aF["use strict"]&&!ab.validthis&&((aH["(statement)"]&&aH["(name)"].charAt(0)>"Z")||aH["(global)"])){at("Possible strict violation.",F)}});ac("true");ac("undefined");ao("=","assign",20);ao("+=","assignadd",20);ao("-=","assignsub",20);ao("*=","assignmult",20);ao("/=","assigndiv",20).nud=function(){aO("A regular expression literal can be confused with '/='.")};ao("%=","assignmod",20);l("&=","assignbitand",20);l("|=","assignbitor",20);l("^=","assignbitxor",20);l("<<=","assignshiftleft",20);l(">>=","assignshiftright",20);l(">>>=","assignshiftrightunsigned",20);G("?",function(ax,F){F.left=ax;F.right=aL(10);ak(":");F["else"]=aL(10);return F},30);G("||","or",40);G("&&","and",50);aG("|","bitor",70);aG("^","bitxor",80);aG("&","bitand",90);ba("==",function(ax,F){var bj=ab.eqnull&&(ax.value==="null"||F.value==="null");if(!bj&&ab.eqeqeq){at("Expected '{a}' and instead saw '{b}'.",this,"===","==")}else{if(bh(ax)){at("Use '{a}' to compare with '{b}'.",this,"===",ax.value)}else{if(bh(F)){at("Use '{a}' to compare with '{b}'.",this,"===",F.value)}}}return this});ba("===");ba("!=",function(ax,F){var bj=ab.eqnull&&(ax.value==="null"||F.value==="null");if(!bj&&ab.eqeqeq){at("Expected '{a}' and instead saw '{b}'.",this,"!==","!=")}else{if(bh(ax)){at("Use '{a}' to compare with '{b}'.",this,"!==",ax.value)}else{if(bh(F)){at("Use '{a}' to compare with '{b}'.",this,"!==",F.value)}}}return this});ba("!==");ba("<");ba(">");ba("<=");ba(">=");aG("<<","shiftleft",120);aG(">>","shiftright",120);aG(">>>","shiftrightunsigned",120);G("in","in",120);G("instanceof","instanceof",120);G("+",function(bj,ax){var F=aL(130);if(bj&&F&&bj.id==="(string)"&&F.id==="(string)"){bj.value+=F.value;bj.character=F.character;if(!ab.scripturl&&D.test(bj.value)){at("JavaScript URL.",bj)}return bj}ax.left=bj;ax.right=F;return ax},130);aP("+","num");aP("+++",function(){at("Confusing pluses.");this.right=aL(150);this.arity="unary";return this});G("+++",function(F){at("Confusing pluses.");this.left=F;this.right=aL(130);return this},130);G("-","sub",130);aP("-","neg");aP("---",function(){at("Confusing minuses.");this.right=aL(150);this.arity="unary";return this});G("---",function(F){at("Confusing minuses.");this.left=F;this.right=aL(130);return this},130);G("*","mult",140);G("/","div",140);G("%","mod",140);aE("++","postinc");aP("++","preinc");a["++"].exps=true;aE("--","postdec");aP("--","predec");a["--"].exps=true;aP("delete",function(){var F=aL(0);if(!F||(F.id!=="."&&F.id!=="[")){at("Variables should not be deleted.")}this.first=F;return this}).exps=true;aP("~",function(){if(ab.bitwise){at("Unexpected '{a}'.",this,"~")}aL(150);return this});aP("!",function(){this.right=aL(150);this.arity="unary";if(A[this.right.id]===true){at("Confusing use of '{a}'.",this,"!")}return this});aP("typeof","typeof");aP("new",function(){var ax=aL(155),F;if(ax&&ax.id!=="function"){if(ax.identifier){ax["new"]=true;switch(ax.value){case"Number":case"String":case"Boolean":case"Math":case"JSON":at("Do not use {a} as a constructor.",aJ,ax.value);break;case"Function":if(!ab.evil){at("The Function constructor is eval.")}break;case"Date":case"RegExp":break;default:if(ax.id!=="function"){F=ax.value.substr(0,1);if(ab.newcap&&(F<"A"||F>"Z")){at("A constructor name should start with an uppercase letter.",aJ)}}}}else{if(ax.id!=="."&&ax.id!=="["&&ax.id!=="("){at("Bad constructor.",aJ)}}}else{if(!ab.supernew){at("Weird construction. Delete 'new'.",this)}}aB(aJ,n);if(n.id!=="("&&!ab.supernew){at("Missing '()' invoking a constructor.")}this.first=ax;return this});a["new"].exps=true;aP("void").exps=true;G(".",function(bj,ax){aB(aU,aJ);aR();var F=am();if(typeof F==="string"){j(F)}ax.left=bj;ax.right=F;if(bj&&bj.value==="arguments"&&(F==="callee"||F==="caller")){if(ab.noarg){at("Avoid arguments.{a}.",bj,F)}else{if(aF["use strict"]){aO("Strict violation.")}}}else{if(!ab.evil&&bj&&bj.value==="document"&&(F==="write"||F==="writeln")){at("document.write can be a form of eval.",bj)}}if(!ab.evil&&(F==="eval"||F==="execScript")){at("eval is evil.")}return ax},160,true);G("(",function(bj,F){if(aU.id!=="}"&&aU.id!==")"){aR(aU,aJ)}Z();if(ab.immed&&!bj.immed&&bj.id==="function"){at("Wrap an immediate function invocation in parentheses to assist the reader in understanding that the expression is the result of a function, and not the function itself.")}var bk=0,ax=[];if(bj){if(bj.type==="(identifier)"){if(bj.value.match(/^[A-Z]([A-Z0-9_$]*[a-z][A-Za-z0-9_$]*)?$/)){if(bj.value!=="Number"&&bj.value!=="String"&&bj.value!=="Boolean"&&bj.value!=="Date"){if(bj.value==="Math"){at("Math is not a function.",bj)}else{if(ab.newcap){at("Missing 'new' prefix when invoking a constructor.",bj)}}}}}}if(n.id!==")"){for(;;){ax[ax.length]=aL(10);bk+=1;if(n.id!==","){break}au()}}ak(")");Z(aU,aJ);if(typeof bj==="object"){if(bj.value==="parseInt"&&bk===1){at("Missing radix parameter.",bj)}if(!ab.evil){if(bj.value==="eval"||bj.value==="Function"||bj.value==="execScript"){at("eval is evil.",bj)}else{if(ax[0]&&ax[0].id==="(string)"&&(bj.value==="setTimeout"||bj.value==="setInterval")){at("Implied eval is evil. Pass a function instead of a string.",bj)}}}if(!bj.identifier&&bj.id!=="."&&bj.id!=="["&&bj.id!=="("&&bj.id!=="&&"&&bj.id!=="||"&&bj.id!=="?"){at("Bad invocation.",bj)}}F.left=bj;return F},155,true).exps=true;aP("(",function(){Z();if(n.id==="function"){n.immed=true}var F=aL(0);ak(")",this);Z(aU,aJ);if(ab.immed&&F.id==="function"){if(n.id==="("||(n.id==="."&&(aV().value==="call"||aV().value==="apply"))){at("Move the invocation into the parens that contain the function.",n)}else{at("Do not wrap function literals in parens unless they are to be immediately invoked.",this)}}return F});G("[",function(bk,ax){aR(aU,aJ);Z();var bj=aL(0),F;if(bj&&bj.type==="(string)"){if(!ab.evil&&(bj.value==="eval"||bj.value==="execScript")){at("eval is evil.",ax)}j(bj.value);if(!ab.sub&&T.test(bj.value)){F=a[bj.value];if(!F||!F.reserved){at("['{a}'] is better written in dot notation.",bj,bj.value)}}}ak("]",ax);Z(aU,aJ);ax.left=bk;ax.right=bj;return ax},160,true);aP("[",function(){var F=aJ.line!==n.line;this.first=[];if(F){av+=ab.indent;if(n.from===av+ab.indent){av+=ab.indent}}while(n.id!=="(end)"){while(n.id===","){at("Extra comma.");ak(",")}if(n.id==="]"){break}if(F&&aJ.line!==n.line){b()}this.first.push(aL(10));if(n.id===","){au();if(n.id==="]"&&!ab.es5){at("Extra comma.",aJ);break}}else{break}}if(F){av-=ab.indent;b()}ak("]",this);return this},160);function f(){var F=o(true);if(!F){if(n.id==="(string)"){F=n.value;ak()}else{if(n.id==="(number)"){F=n.value.toString();ak()}}}return F}function V(){var ax,F=n,bj=[];ak("(");Z();if(n.id===")"){ak(")");return}for(;;){ax=am(true);bj.push(ax);C(ax,"parameter");if(n.id===","){au()}else{ak(")",F);Z(aU,aJ);return bj}}}function Q(bj,bk){var bl,ax=ab,F=aK;ab=Object.create(ab);aK=Object.create(aK);aH={"(name)":bj||'"'+a4+'"',"(line)":n.line,"(context)":aH,"(breakage)":0,"(loopage)":0,"(scope)":aK,"(statement)":bk};bl=aH;aJ.funct=aH;I.push(aH);if(bj){C(bj,"function")}aH["(params)"]=V();M(false,false,true);aK=F;ab=ax;aH["(last)"]=aJ.line;aH=aH["(context)"];return bl}(function(F){F.nud=function(){var br,bo,bn,bm,bj,bs;var bq={};function bk(bt,bu){if(bq[bt]&&aX(bq,bt)){at("Duplicate member '{a}'.",n,bn)}else{bq[bt]={}}bq[bt].basic=true;bq[bt].basicToken=bu}function bl(bt,bu){if(bq[bt]&&aX(bq,bt)){if(bq[bt].basic||bq[bt].setter){at("Duplicate member '{a}'.",n,bn)}}else{bq[bt]={}}bq[bt].setter=true;bq[bt].setterToken=bu}function bp(bt){if(bq[bt]&&aX(bq,bt)){if(bq[bt].basic||bq[bt].getter){at("Duplicate member '{a}'.",n,bn)}}else{bq[bt]={}}bq[bt].getter=true;bq[bt].getterToken=aJ}br=aJ.line!==n.line;if(br){av+=ab.indent;if(n.from===av+ab.indent){av+=ab.indent}}for(;;){if(n.id==="}"){break}if(br){b()}if(n.value==="get"&&aV().id!==":"){ak("get");if(!ab.es5){aO("get/set are ES5 features.")}bn=f();if(!bn){aO("Missing property name.")}bp(bn);bs=n;aB(aJ,n);bo=Q();bj=bo["(params)"];if(bj){at("Unexpected parameter '{a}' in get {b} function.",bs,bj[0],bn)}aB(aJ,n)}else{if(n.value==="set"&&aV().id!==":"){ak("set");if(!ab.es5){aO("get/set are ES5 features.")}bn=f();if(!bn){aO("Missing property name.")}bl(bn,n);bs=n;aB(aJ,n);bo=Q();bj=bo["(params)"];if(!bj||bj.length!==1){at("Expected a single parameter in set {a} function.",bs,bn)}}else{bn=f();bk(bn,n);if(typeof bn!=="string"){break}ak(":");Y(aJ,n);aL(10)}}j(bn);if(n.id===","){au();if(n.id===","){at("Extra comma.",aJ)}else{if(n.id==="}"&&!ab.es5){at("Extra comma.",aJ)}}}else{break}}if(br){av-=ab.indent;b()}ak("}",this);if(ab.es5){for(var ax in bq){if(aX(bq,ax)&&bq[ax].setter&&!bq[ax].getter){at("Setter is defined without getter.",bq[ax].setterToken)}}}return this};F.fud=function(){aO("Expected to see a statement and instead saw a block.",aJ)}}(aT("{")));U=function(){var F=g("const",function(bk){var bl,ax,bj;this.first=[];for(;;){Y(aJ,n);bl=am();if(aH[bl]==="const"){at("const '"+bl+"' has already been declared")}if(aH["(global)"]&&a7[bl]===false){at("Redefinition of '{a}'.",aJ,bl)}C(bl,"const");if(bk){break}ax=aJ;this.first.push(aJ);if(n.id!=="="){at("const '{a}' is initialized to 'undefined'.",aJ,bl)}if(n.id==="="){Y(aJ,n);ak("=");Y(aJ,n);if(n.id==="undefined"){at("It is not necessary to initialize '{a}' to 'undefined'.",aJ,bl)}if(aV(0).id==="="&&n.identifier){aO("Constant {a} was not declared correctly.",n,n.value)}bj=aL(0);ax.first=bj}if(n.id!==","){break}au()}return this});F.exps=true};var aW=g("var",function(bj){var bk,F,ax;if(aH["(onevar)"]&&ab.onevar){at("Too many var statements.")}else{if(!aH["(global)"]){aH["(onevar)"]=true}}this.first=[];for(;;){Y(aJ,n);bk=am();if(ab.esnext&&aH[bk]==="const"){at("const '"+bk+"' has already been declared")}if(aH["(global)"]&&a7[bk]===false){at("Redefinition of '{a}'.",aJ,bk)}C(bk,"unused");if(bj){break}F=aJ;this.first.push(aJ);if(n.id==="="){Y(aJ,n);ak("=");Y(aJ,n);if(n.id==="undefined"){at("It is not necessary to initialize '{a}' to 'undefined'.",aJ,bk)}if(aV(0).id==="="&&n.identifier){aO("Variable {a} was not declared correctly.",n,n.value)}ax=aL(0);F.first=ax}if(n.id!==","){break}au()}return this});aW.exps=true;a6("function",function(){if(aI){at("Function declarations should not be placed in blocks. Use a function expression or move the statement to the top of the outer function.",aJ)}var F=am();if(ab.esnext&&aH[F]==="const"){at("const '"+F+"' has already been declared")}aB(aJ,n);C(F,"unction");Q(F,true);if(n.id==="("&&n.line===aJ.line){aO("Function declarations are not invocable. Wrap the whole function invocation in parens.")}return this});aP("function",function(){var F=o();if(F){aB(aJ,n)}else{Y(aJ,n)}Q(F);if(!ab.loopfunc&&aH["(loopage)"]){at("Don't make functions within a loop.")}return this});a6("if",function(){var F=n;ak("(");Y(this,F);Z();aL(20);if(n.id==="="){if(!ab.boss){at("Expected a conditional expression and instead saw an assignment.")}ak("=");aL(20)}ak(")",F);Z(aU,aJ);M(true,true);if(n.id==="else"){Y(aJ,n);ak("else");if(n.id==="if"||n.id==="switch"){bd(true)}else{M(true,true)}}return this});a6("try",function(){var F,bj,ax;M(false);if(n.id==="catch"){ak("catch");Y(aJ,n);ak("(");ax=aK;aK=Object.create(ax);bj=n.value;if(n.type!=="(identifier)"){at("Expected an identifier and instead saw '{a}'.",n,bj)}else{C(bj,"exception")}ak();ak(")");M(false);F=true;aK=ax}if(n.id==="finally"){ak("finally");M(false);return}else{if(!F){aO("Expected '{a}' and instead saw '{b}'.",n,"catch",n.value)}}return this});a6("while",function(){var F=n;aH["(breakage)"]+=1;aH["(loopage)"]+=1;ak("(");Y(this,F);Z();aL(20);if(n.id==="="){if(!ab.boss){at("Expected a conditional expression and instead saw an assignment.")}ak("=");aL(20)}ak(")",F);Z(aU,aJ);M(true,true);aH["(breakage)"]-=1;aH["(loopage)"]-=1;return this}).labelled=true;a6("with",function(){var F=n;if(aF["use strict"]){aO("'with' is not allowed in strict mode.",aJ)}else{if(!ab.withstmt){at("Don't use 'with'.",aJ)}}ak("(");Y(this,F);Z();aL(0);ak(")",F);Z(aU,aJ);M(true,true);return this});a6("switch",function(){var F=n,ax=false;aH["(breakage)"]+=1;ak("(");Y(this,F);Z();this.condition=aL(20);ak(")",F);Z(aU,aJ);Y(aJ,n);F=n;ak("{");Y(aJ,n);av+=ab.indent;this.cases=[];for(;;){switch(n.id){case"case":switch(aH["(verb)"]){case"break":case"case":case"continue":case"return":case"switch":case"throw":break;default:if(!a1.test(bc[n.line-2])){at("Expected a 'break' statement before 'case'.",aJ)}}b(-ab.indent);ak("case");this.cases.push(aL(20));ax=true;ak(":");aH["(verb)"]="case";break;case"default":switch(aH["(verb)"]){case"break":case"continue":case"return":case"throw":break;default:if(!a1.test(bc[n.line-2])){at("Expected a 'break' statement before 'default'.",aJ)}}b(-ab.indent);ak("default");ax=true;ak(":");break;case"}":av-=ab.indent;b();ak("}",F);if(this.cases.length===1||this.condition.id==="true"||this.condition.id==="false"){if(!ab.onecase){at("This 'switch' should be an 'if'.",this)}}aH["(breakage)"]-=1;aH["(verb)"]=undefined;return;case"(end)":aO("Missing '{a}'.",n,"}");return;default:if(ax){switch(aJ.id){case",":aO("Each value should have its own case label.");return;case":":ax=false;aQ();break;default:aO("Missing ':' on a case clause.",aJ);return}}else{if(aJ.id===":"){ak(":");aO("Unexpected '{a}'.",aJ,":");aQ()}else{aO("Expected '{a}' and instead saw '{b}'.",n,"case",n.value);return}}}}}).labelled=true;g("debugger",function(){if(!ab.debug){at("All 'debugger' statements should be removed.")}return this}).exps=true;(function(){var F=g("do",function(){aH["(breakage)"]+=1;aH["(loopage)"]+=1;this.first=M(true);ak("while");var ax=n;Y(aJ,ax);ak("(");Z();aL(20);if(n.id==="="){if(!ab.boss){at("Expected a conditional expression and instead saw an assignment.")}ak("=");aL(20)}ak(")",ax);Z(aU,aJ);aH["(breakage)"]-=1;aH["(loopage)"]-=1;return this});F.labelled=true;F.exps=true}());a6("for",function(){var ax,F=n;aH["(breakage)"]+=1;aH["(loopage)"]+=1;ak("(");Y(this,F);Z();if(aV(n.id==="var"?1:0).id==="in"){if(n.id==="var"){ak("var");aW.fud.call(aW,true)}else{switch(aH[n.value]){case"unused":aH[n.value]="var";break;case"var":break;default:at("Bad for in variable '{a}'.",n,n.value)}ak()}ak("in");aL(20);ak(")",F);ax=M(true,true);if(ab.forin&&ax&&(ax.length>1||typeof ax[0]!=="object"||ax[0].value!=="if")){at("The body of a for in should be wrapped in an if statement to filter unwanted properties from the prototype.",this)}aH["(breakage)"]-=1;aH["(loopage)"]-=1;return this}else{if(n.id!==";"){if(n.id==="var"){ak("var");aW.fud.call(aW)}else{for(;;){aL(0,"for");if(n.id!==","){break}au()}}}bf(aJ);ak(";");if(n.id!==";"){aL(20);if(n.id==="="){if(!ab.boss){at("Expected a conditional expression and instead saw an assignment.")}ak("=");aL(20)}}bf(aJ);ak(";");if(n.id===";"){aO("Expected '{a}' and instead saw '{b}'.",n,")",";")}if(n.id!==")"){for(;;){aL(0,"for");if(n.id!==","){break}au()}}ak(")",F);Z(aU,aJ);M(true,true);aH["(breakage)"]-=1;aH["(loopage)"]-=1;return this}}).labelled=true;g("break",function(){var F=n.value;if(aH["(breakage)"]===0){at("Unexpected '{a}'.",n,this.value)}if(!ab.asi){bf(this)}if(n.id!==";"){if(aJ.line===n.line){if(aH[F]!=="label"){at("'{a}' is not a statement label.",n,F)}else{if(aK[F]!==aH){at("'{a}' is out of scope.",n,F)}}this.first=n;ak()}}ae("break");return this}).exps=true;g("continue",function(){var F=n.value;if(aH["(breakage)"]===0){at("Unexpected '{a}'.",n,this.value)}if(!ab.asi){bf(this)}if(n.id!==";"){if(aJ.line===n.line){if(aH[F]!=="label"){at("'{a}' is not a statement label.",n,F)}else{if(aK[F]!==aH){at("'{a}' is out of scope.",n,F)}}this.first=n;ak()}}else{if(!aH["(loopage)"]){at("Unexpected '{a}'.",n,this.value)}}ae("continue");return this}).exps=true;g("return",function(){if(this.line===n.line){if(n.id==="(regexp)"){at("Wrap the /regexp/ literal in parens to disambiguate the slash operator.")}if(n.id!==";"&&!n.reach){Y(aJ,n);if(aV().value==="="&&!ab.boss){ah("Did you mean to return a conditional instead of an assignment?",aJ.line,aJ.character+1)}this.first=aL(0)}}else{if(!ab.asi){bf(this)}}ae("return");return this}).exps=true;g("throw",function(){bf(this);Y(aJ,n);this.first=aL(20);ae("throw");return this}).exps=true;u("class");u("const");u("enum");u("export");u("extends");u("import");u("super");u("let");u("yield");u("implements");u("interface");u("package");u("private");u("protected");u("public");u("static");function s(){function F(){var bk={},bj=n;ak("{");if(n.id!=="}"){for(;;){if(n.id==="(end)"){aO("Missing '}' to match '{' from line {a}.",n,bj.line)}else{if(n.id==="}"){at("Unexpected comma.",aJ);break}else{if(n.id===","){aO("Unexpected comma.",n)}else{if(n.id!=="(string)"){at("Expected a string and instead saw {a}.",n,n.value)}}}}if(bk[n.value]===true){at("Duplicate key '{a}'.",n,n.value)}else{if((n.value==="__proto__"&&!ab.proto)||(n.value==="__iterator__"&&!ab.iterator)){at("The '{a}' key may produce unexpected results.",n,n.value)}else{bk[n.value]=true}}ak();ak(":");s();if(n.id!==","){break}ak(",")}}ak("}")}function ax(){var bj=n;ak("[");if(n.id!=="]"){for(;;){if(n.id==="(end)"){aO("Missing ']' to match '[' from line {a}.",n,bj.line)}else{if(n.id==="]"){at("Unexpected comma.",aJ);break}else{if(n.id===","){aO("Unexpected comma.",n)}}}s();if(n.id!==","){break}ak(",")}}ak("]")}switch(n.id){case"{":F();break;case"[":ax();break;case"true":case"false":case"null":case"(number)":case"(string)":ak();break;case"-":ak("-");if(aJ.character!==n.from){at("Unexpected space after '-'.",aJ)}aB(aJ,n);ak("(number)");break;default:aO("Expected a JSON value.",n)}}var P=function(bu,ax,bn){var br,bl,bk,bs,bt,bj={};JSHINT.errors=[];JSHINT.undefs=[];a7=Object.create(bb);bg(a7,bn||{});if(ax){br=ax.predef;if(br){if(Array.isArray(br)){for(bl=0;bl<br.length;bl+=1){a7[br[bl]]=true}}else{if(typeof br==="object"){bk=Object.keys(br);for(bl=0;bl<bk.length;bl+=1){a7[bk[bl]]=!!br[bk[bl]]}}}}bt=Object.keys(ax);for(bs=0;bs<bt.length;bs++){bj[bt[bs]]=ax[bt[bs]]}}ab=bj;ab.indent=ab.indent||4;ab.maxerr=ab.maxerr||50;q="";for(bl=0;bl<ab.indent;bl+=1){q+=" "}av=1;J=Object.create(a7);aK=J;aH={"(global)":true,"(name)":"(global)","(scope)":aK,"(breakage)":0,"(loopage)":0};I=[aH];aa=[];aD=null;aN={};aZ=null;aY={};aI=false;S=[];m=false;H=0;ar.init(bu);w=true;aF={};aU=aJ=n=a["(begin)"];for(var F in ax){if(aX(ax,F)){a9(F,aJ)}}an();bg(a7,bn||{});au.first=true;try{ak();switch(n.id){case"{":case"[":ab.laxbreak=true;m=true;s();break;default:a5();if(aF["use strict"]&&!ab.globalstrict){at('Use the function form of "use strict".',aU)}aQ()}ak("(end)");var bm=function(bv,bw){do{if(typeof bw[bv]==="string"){if(bw[bv]==="unused"){bw[bv]="var"}else{if(bw[bv]==="unction"){bw[bv]="closure"}}return true}bw=bw["(context)"]}while(bw);return false};var bq=function(bw,bv){if(!aY[bw]){return}var by=[];for(var bx=0;bx<aY[bw].length;bx+=1){if(aY[bw][bx]!==bv){by.push(aY[bw][bx])}}if(by.length===0){delete aY[bw]}else{aY[bw]=by}};for(bl=0;bl<JSHINT.undefs.length;bl+=1){bk=JSHINT.undefs[bl].slice(0);if(bm(bk[2].value,bk[0])){bq(bk[2].value,bk[2].line)}else{at.apply(at,bk.slice(1))}}}catch(bo){if(bo){var bp=n||{};JSHINT.errors.push({raw:bo.raw,reason:bo.message,line:bo.line||bp.line,character:bo.character||bp.from},null)}}return JSHINT.errors.length===0};P.data=function(){var bm={functions:[],options:ab},bl,bn,br=[],bp,bo,bj,bk=[],F,ax=[],bq;if(P.errors.length){bm.errors=P.errors}if(m){bm.json=true}for(F in aY){if(aX(aY,F)){br.push({name:F,line:aY[F]})}}if(br.length>0){bm.implieds=br}if(aa.length>0){bm.urls=aa}bn=Object.keys(aK);if(bn.length>0){bm.globals=bn}for(bo=1;bo<I.length;bo+=1){bp=I[bo];bl={};for(bj=0;bj<aS.length;bj+=1){bl[aS[bj]]=[]}for(F in bp){if(aX(bp,F)&&F.charAt(0)!=="("){bq=bp[F];if(bq==="unction"){bq="unused"}if(Array.isArray(bl[bq])){bl[bq].push(F);if(bq==="unused"){ax.push({name:F,line:bp["(line)"],"function":bp["(name)"]})}}}}for(bj=0;bj<aS.length;bj+=1){if(bl[aS[bj]].length===0){delete bl[aS[bj]]}}bl.name=bp["(name)"];bl.param=bp["(params)"];bl.line=bp["(line)"];bl.last=bp["(last)"];bm.functions.push(bl)}if(ax.length>0){bm.unused=ax}bk=[];for(F in aN){if(typeof aN[F]==="number"){bm.member=aN;break}}return bm};P.report=function(bp){var bn=P.data();var bu=[],bt,bs,bm,br,bo,bl,bk,bj="",ax,F=[],bv;function bq(bz,bA){var bw,by,bx;if(bA){F.push("<div><i>"+bz+"</i> ");bA=bA.sort();for(by=0;by<bA.length;by+=1){if(bA[by]!==bx){bx=bA[by];F.push((bw?", ":"")+bx);bw=true}}F.push("</div>")}}if(bn.errors||bn.implieds||bn.unused){bm=true;F.push("<div id=errors><i>Error:</i>");if(bn.errors){for(bo=0;bo<bn.errors.length;bo+=1){bt=bn.errors[bo];if(bt){bs=bt.evidence||"";F.push("<p>Problem"+(isFinite(bt.line)?" at line "+bt.line+" character "+bt.character:"")+": "+bt.reason.entityify()+"</p><p class=evidence>"+(bs&&(bs.length>80?bs.slice(0,77)+"...":bs).entityify())+"</p>")}}}if(bn.implieds){bv=[];for(bo=0;bo<bn.implieds.length;bo+=1){bv[bo]="<code>"+bn.implieds[bo].name+"</code>&nbsp;<i>"+bn.implieds[bo].line+"</i>"}F.push("<p><i>Implied global:</i> "+bv.join(", ")+"</p>")}if(bn.unused){bv=[];for(bo=0;bo<bn.unused.length;bo+=1){bv[bo]="<code><u>"+bn.unused[bo].name+"</u></code>&nbsp;<i>"+bn.unused[bo].line+"</i> <code>"+bn.unused[bo]["function"]+"</code>"}F.push("<p><i>Unused variable:</i> "+bv.join(", ")+"</p>")}if(bn.json){F.push("<p>JSON: bad.</p>")}F.push("</div>")}if(!bp){F.push("<br><div id=functions>");if(bn.urls){bq("URLs<br>",bn.urls,"<br>")}if(bn.json&&!bm){F.push("<p>JSON: good.</p>")}else{if(bn.globals){F.push("<div><i>Global</i> "+bn.globals.sort().join(", ")+"</div>")}else{F.push("<div><i>No new global variables introduced.</i></div>")}}for(bo=0;bo<bn.functions.length;bo+=1){br=bn.functions[bo];F.push("<br><div class=function><i>"+br.line+"-"+br.last+"</i> "+(br.name||"")+"("+(br.param?br.param.join(", "):"")+")</div>");bq("<big><b>Unused</b></big>",br.unused);bq("Closure",br.closure);bq("Variable",br["var"]);bq("Exception",br.exception);bq("Outer",br.outer);bq("Global",br.global);bq("Label",br.label)}if(bn.member){bu=Object.keys(bn.member);if(bu.length){bu=bu.sort();bj="<br><pre id=members>/*members ";bk=10;for(bo=0;bo<bu.length;bo+=1){bl=bu[bo];ax=bl.name();if(bk+ax.length>72){F.push(bj+"<br>");bj="    ";bk=1}bk+=ax.length+2;if(bn.member[bl]===1){ax="<i>"+ax+"</i>"}if(bo<bu.length-1){ax+=", "}bj+=ax}F.push(bj+"<br>*/</pre>")}F.push("</div>")}}return F.join("")};P.jshint=P;return P}());if(typeof exports==="object"&&exports){exports.JSHINT=JSHINT}var jsonlint=function(){var f=!0,e=!1,j={},g=function(){var d={trace:function(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,$accept:0,$end:1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function(a,s,r,q,o,n,m){var l=n.length-1;switch(o){case 1:this.$=a.replace(/\\(\\|")/g,"$1").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\v/g,"").replace(/\\f/g,"\f").replace(/\\b/g,"\b");break;case 2:this.$=Number(a);break;case 3:this.$=null;break;case 4:this.$=!0;break;case 5:this.$=!1;break;case 6:return this.$=n[l-1];case 13:this.$={};break;case 14:this.$=n[l-1];break;case 15:this.$=[n[l-2],n[l]];break;case 16:this.$={},this.$[n[l][0]]=n[l][1];break;case 17:this.$=n[l-2],n[l-2][n[l][0]]=n[l][1];break;case 18:this.$=[];break;case 19:this.$=n[l-1];break;case 20:this.$=[n[l]];break;case 21:this.$=n[l-2],n[l-2].push(n[l])}},table:[{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],12:1,13:2,15:7,16:8,17:[1,14],23:[1,15]},{1:[3]},{14:[1,16]},{14:[2,7],18:[2,7],22:[2,7],24:[2,7]},{14:[2,8],18:[2,8],22:[2,8],24:[2,8]},{14:[2,9],18:[2,9],22:[2,9],24:[2,9]},{14:[2,10],18:[2,10],22:[2,10],24:[2,10]},{14:[2,11],18:[2,11],22:[2,11],24:[2,11]},{14:[2,12],18:[2,12],22:[2,12],24:[2,12]},{14:[2,3],18:[2,3],22:[2,3],24:[2,3]},{14:[2,4],18:[2,4],22:[2,4],24:[2,4]},{14:[2,5],18:[2,5],22:[2,5],24:[2,5]},{14:[2,1],18:[2,1],21:[2,1],22:[2,1],24:[2,1]},{14:[2,2],18:[2,2],22:[2,2],24:[2,2]},{3:20,4:[1,12],18:[1,17],19:18,20:19},{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],13:23,15:7,16:8,17:[1,14],23:[1,15],24:[1,21],25:22},{1:[2,6]},{14:[2,13],18:[2,13],22:[2,13],24:[2,13]},{18:[1,24],22:[1,25]},{18:[2,16],22:[2,16]},{21:[1,26]},{14:[2,18],18:[2,18],22:[2,18],24:[2,18]},{22:[1,28],24:[1,27]},{22:[2,20],24:[2,20]},{14:[2,14],18:[2,14],22:[2,14],24:[2,14]},{3:20,4:[1,12],20:29},{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],13:30,15:7,16:8,17:[1,14],23:[1,15]},{14:[2,19],18:[2,19],22:[2,19],24:[2,19]},{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],13:31,15:7,16:8,17:[1,14],23:[1,15]},{18:[2,17],22:[2,17]},{18:[2,15],22:[2,15]},{22:[2,21],24:[2,21]}],defaultActions:{16:[2,6]},parseError:function(a,l){throw new Error(a)},parse:function(ab){function O(b){Z.length=Z.length-2*b,Y.length=Y.length-b,X.length=X.length-b}function N(){var b;return b=aa.lexer.lex()||1,typeof b!="number"&&(b=aa.symbols_[b]||b),b}var aa=this,Z=[0],Y=[null],X=[],W=this.table,V="",U=0,T=0,S=0,R=2,Q=1;this.lexer.setInput(ab),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,typeof this.lexer.yylloc=="undefined"&&(this.lexer.yylloc={});var P=this.lexer.yylloc;X.push(P),typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);var L,J,I,H,G,F,E={},D,C,a,M;for(;;){I=Z[Z.length-1],this.defaultActions[I]?H=this.defaultActions[I]:(L==null&&(L=N()),H=W[I]&&W[I][L]);if(typeof H=="undefined"||!H.length||!H[0]){if(!S){M=[];for(D in W[I]){this.terminals_[D]&&D>2&&M.push("'"+this.terminals_[D]+"'")}var K="";this.lexer.showPosition?K="Parse error on line "+(U+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+M.join(", ")+", got '"+this.terminals_[L]+"'":K="Parse error on line "+(U+1)+": Unexpected "+(L==1?"end of input":"'"+(this.terminals_[L]||L)+"'"),this.parseError(K,{text:this.lexer.match,token:this.terminals_[L]||L,line:this.lexer.yylineno,loc:P,expected:M})}if(S==3){if(L==Q){throw new Error(K||"Parsing halted.")}T=this.lexer.yyleng,V=this.lexer.yytext,U=this.lexer.yylineno,P=this.lexer.yylloc,L=N()}for(;;){if(R.toString() in W[I]){break}if(I==0){throw new Error(K||"Parsing halted.")}O(1),I=Z[Z.length-1]}J=L,L=R,I=Z[Z.length-1],H=W[I]&&W[I][R],S=3}if(H[0] instanceof Array&&H.length>1){throw new Error("Parse Error: multiple actions possible at state: "+I+", token: "+L)}switch(H[0]){case 1:Z.push(L),Y.push(this.lexer.yytext),X.push(this.lexer.yylloc),Z.push(H[1]),L=null,J?(L=J,J=null):(T=this.lexer.yyleng,V=this.lexer.yytext,U=this.lexer.yylineno,P=this.lexer.yylloc,S>0&&S--);break;case 2:C=this.productions_[H[1]][1],E.$=Y[Y.length-C],E._$={first_line:X[X.length-(C||1)].first_line,last_line:X[X.length-1].last_line,first_column:X[X.length-(C||1)].first_column,last_column:X[X.length-1].last_column},F=this.performAction.call(E,V,T,U,this.yy,H[1],Y,X);if(typeof F!="undefined"){return F}C&&(Z=Z.slice(0,-1*C*2),Y=Y.slice(0,-1*C),X=X.slice(0,-1*C)),Z.push(this.productions_[H[1]][0]),Y.push(E.$),X.push(E._$),a=W[Z[Z.length-2]][Z[Z.length-1]],Z.push(a);break;case 3:return !0}}return !0}},c=function(){var b={EOF:1,parseError:function(a,l){if(!this.yy.parseError){throw new Error(a)}this.yy.parseError(a,l)},setInput:function(l){return this._input=l,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this},input:function(){var m=this._input[0];this.yytext+=m,this.yyleng++,this.match+=m,this.matched+=m;var l=m.match(/\n/);return l&&this.yylineno++,this._input=this._input.slice(1),m},unput:function(l){return this._input=l+this._input,this},more:function(){return this._more=!0,this},less:function(l){this._input=this.match.slice(l)+this._input},pastInput:function(){var l=this.matched.substr(0,this.matched.length-this.match.length);return(l.length>20?"...":"")+l.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var l=this.match;return l.length<20&&(l+=this._input.substr(0,20-l.length)),(l.substr(0,20)+(l.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var m=this.pastInput(),l=(new Array(m.length+1)).join("-");return m+this.upcomingInput()+"\n"+l+"^"},next:function(){if(this.done){return this.EOF}this._input||(this.done=!0);var m,l,u,s,r,q;this._more||(this.yytext="",this.match="");var o=this._currentRules();for(var n=0;n<o.length;n++){u=this._input.match(this.rules[o[n]]);if(u&&(!l||u[0].length>l[0].length)){l=u,s=n;if(!this.options.flex){break}}}if(l){q=l[0].match(/\n.*/g),q&&(this.yylineno+=q.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:q?q[q.length-1].length-1:this.yylloc.last_column+l[0].length},this.yytext+=l[0],this.match+=l[0],this.yyleng=this.yytext.length,this._more=!1,this._input=this._input.slice(l[0].length),this.matched+=l[0],m=this.performAction.call(this,this.yy,this,o[s],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1);if(m){return m}return}if(this._input===""){return this.EOF}this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var a=this.next();return typeof a!="undefined"?a:this.lex()},begin:function(a){this.conditionStack.push(a)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(a){this.begin(a)}};return b.options={},b.performAction=function(a,o,n,m){var l=m;switch(n){case 0:break;case 1:return 6;case 2:return o.yytext=o.yytext.substr(1,o.yyleng-2),4;case 3:return 17;case 4:return 18;case 5:return 23;case 6:return 24;case 7:return 22;case 8:return 21;case 9:return 10;case 10:return 11;case 11:return 8;case 12:return 14;case 13:return"INVALID"}},b.rules=[/^(?:\s+)/,/^(?:(-?([0-9]|[1-9][0-9]+))(\.[0-9]+)?([eE][-+]?[0-9]+)?\b)/,/^(?:"(?:\\[\\"bfnrt/]|\\u[a-fA-F0-9]{4}|[^\\\0-\x09\x0a-\x1f"])*")/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?::)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:$)/,/^(?:.)/],b.conditions={INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}},b}();return d.lexer=c,d}();return typeof f!="undefined"&&typeof j!="undefined"&&(j.parser=g,j.parse=function(){return g.parse.apply(g,arguments)},j.main=function(c){if(!c[1]){throw new Error("Usage: "+c[0]+" FILE")}if(typeof process!="undefined"){var b=f("fs").readFileSync(f("path").join(process.cwd(),c[1]),"utf8")}else{var a=f("file").path(f("file").cwd()),b=a.join(c[1]).read({charset:"utf-8"})}return j.parser.parse(b)},typeof e!="undefined"&&f.main===e&&j.main(typeof process!="undefined"?process.argv.slice(1):f("system").args)),j}();
/*
CSSLint v1.0.5
Copyright (c) 2017 Nicole Sullivan and Nicholas C. Zakas. All rights reserved.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the 'Software'), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

*/
var CSSLint=(function(){var c=c||{},a=a||{};
/*
Parser-Lib
Copyright (c) 2009-2016 Nicholas C. Zakas. All rights reserved.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/
var e=(function(){var g;g=(function j(m,x,u){function q(B,s){if(!x[B]){if(!m[B]){var r=typeof g=="function"&&g;if(!s&&r){return r(B,!0)}if(l){return l(B,!0)}var A=new Error("Cannot find module '"+B+"'");throw A.code="MODULE_NOT_FOUND",A}var n=x[B]={exports:{}};m[B][0].call(n.exports,function(o){var C=m[B][1][o];return q(C?C:o)},n,n.exports,j,m,x,u)}return x[B].exports}var l=typeof g=="function"&&g;for(var w=0;w<u.length;w++){q(u[w])}return q})({1:[function(m,n,l){var o=n.exports={__proto__:null,aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",currentColor:"The value of the 'color' property.",activeBorder:"Active window border.",activecaption:"Active window caption.",appworkspace:"Background color of multiple document interface.",background:"Desktop background.",buttonface:"The face background color for 3-D elements that appear 3-D due to one layer of surrounding border.",buttonhighlight:"The color of the border facing the light source for 3-D elements that appear 3-D due to one layer of surrounding border.",buttonshadow:"The color of the border away from the light source for 3-D elements that appear 3-D due to one layer of surrounding border.",buttontext:"Text on push buttons.",captiontext:"Text in caption, size box, and scrollbar arrow box.",graytext:"Grayed (disabled) text. This color is set to #000 if the current display driver does not support a solid gray color.",greytext:"Greyed (disabled) text. This color is set to #000 if the current display driver does not support a solid grey color.",highlight:"Item(s) selected in a control.",highlighttext:"Text of item(s) selected in a control.",inactiveborder:"Inactive window border.",inactivecaption:"Inactive window caption.",inactivecaptiontext:"Color of text in an inactive caption.",infobackground:"Background color for tooltip controls.",infotext:"Text color for tooltip controls.",menu:"Menu background.",menutext:"Text in menus.",scrollbar:"Scroll bar gray area.",threeddarkshadow:"The color of the darker (generally outer) of the two borders away from the light source for 3-D elements that appear 3-D due to two concentric layers of surrounding border.",threedface:"The face background color for 3-D elements that appear 3-D due to two concentric layers of surrounding border.",threedhighlight:"The color of the lighter (generally outer) of the two borders facing the light source for 3-D elements that appear 3-D due to two concentric layers of surrounding border.",threedlightshadow:"The color of the darker (generally inner) of the two borders facing the light source for 3-D elements that appear 3-D due to two concentric layers of surrounding border.",threedshadow:"The color of the lighter (generally inner) of the two borders away from the light source for 3-D elements that appear 3-D due to two concentric layers of surrounding border.",window:"Window background.",windowframe:"Window frame.",windowtext:"Text in windows."}},{}],2:[function(n,o,m){o.exports=l;var r=n("../util/SyntaxUnit");var q=n("./Parser");function l(w,s,u){r.call(this,w,s,u,q.COMBINATOR_TYPE);this.type="unknown";if(/^\s+$/.test(w)){this.type="descendant"}else{if(w===">"){this.type="child"}else{if(w==="+"){this.type="adjacent-sibling"}else{if(w==="~"){this.type="sibling"}}}}}l.prototype=new r();l.prototype.constructor=l},{"../util/SyntaxUnit":26,"./Parser":6}],3:[function(n,o,l){o.exports=q;var r=n("../util/StringReader");var m=n("../util/SyntaxError");function q(u,s){this.match=function(x){var w;x.mark();w=u(x);if(w){x.drop()}else{x.restore()}return w};this.toString=typeof s==="function"?s:function(){return s}}q.prec={MOD:5,SEQ:4,ANDAND:3,OROR:2,ALT:1};q.parse=function(B){var x,s,D,u,A,E,C,w,F;x=new r(B);s=function(H){var G=x.readMatch(H);if(G===null){throw new m("Expected "+H,x.getLine(),x.getCol())}return G};D=function(){var G=[u()];while(x.readMatch(" | ")!==null){G.push(u())}return G.length===1?G[0]:q.alt.apply(q,G)};u=function(){var G=[A()];while(x.readMatch(" || ")!==null){G.push(A())}return G.length===1?G[0]:q.oror.apply(q,G)};A=function(){var G=[E()];while(x.readMatch(" && ")!==null){G.push(E())}return G.length===1?G[0]:q.andand.apply(q,G)};E=function(){var G=[C()];while(x.readMatch(/^ (?![&|\]])/)!==null){G.push(C())}return G.length===1?G[0]:q.seq.apply(q,G)};C=function(){var H=w();if(x.readMatch("?")!==null){return H.question()}else{if(x.readMatch("*")!==null){return H.star()}else{if(x.readMatch("+")!==null){return H.plus()}else{if(x.readMatch("#")!==null){return H.hash()}else{if(x.readMatch(/^\{\s*/)!==null){var I=s(/^\d+/);s(/^\s*,\s*/);var G=s(/^\d+/);s(/^\s*\}/);return H.braces(+I,+G)}}}}}return H};w=function(){if(x.readMatch("[ ")!==null){var G=D();s(" ]");return G}return q.fromType(s(/^[^ ?*+#{]+/))};F=D();if(!x.eof()){throw new m("Expected end of string",x.getLine(),x.getCol())}return F};q.cast=function(s){if(s instanceof q){return s}return q.parse(s)};q.fromType=function(u){var s=n("./ValidationTypes");return new q(function(w){return w.hasNext()&&s.isType(w,u)},u)};q.seq=function(){var s=Array.prototype.slice.call(arguments).map(q.cast);if(s.length===1){return s[0]}return new q(function(x){var w,u=true;for(w=0;u&&w<s.length;w++){u=s[w].match(x)}return u},function(u){var x=q.prec.SEQ;var w=s.map(function(A){return A.toString(x)}).join(" ");if(u>x){w="[ "+w+" ]"}return w})};q.alt=function(){var s=Array.prototype.slice.call(arguments).map(q.cast);if(s.length===1){return s[0]}return new q(function(x){var w,u=false;for(w=0;!u&&w<s.length;w++){u=s[w].match(x)}return u},function(u){var x=q.prec.ALT;var w=s.map(function(A){return A.toString(x)}).join(" | ");if(u>x){w="[ "+w+" ]"}return w})};q.many=function(w){var u=Array.prototype.slice.call(arguments,1).reduce(function(B,x){if(x.expand){var A=n("./ValidationTypes");B.push.apply(B,A.complex[x.expand].options)}else{B.push(q.cast(x))}return B},[]);if(w===true){w=u.map(function(){return true})}var s=new q(function(F){var A=[],x=0,D=0;var E=function(G){if(D===0){x=Math.max(G,x);return G===u.length}else{return G===x}};var B=function(G){for(var H=0;H<u.length;H++){if(A[H]){continue}F.mark();if(u[H].match(F)){A[H]=true;if(B(G+((w===false||w[H])?1:0))){F.drop();return true}F.restore();A[H]=false}else{F.drop()}}return E(G)};if(!B(0)){D++;B(0)}if(w===false){return x>0}for(var C=0;C<u.length;C++){if(w[C]&&!A[C]){return false}}return true},function(x){var B=w===false?q.prec.OROR:q.prec.ANDAND;var A=u.map(function(C,D){if(w!==false&&!w[D]){return C.toString(q.prec.MOD)+"?"}return C.toString(B)}).join(w===false?" || ":" && ");if(x>B){A="[ "+A+" ]"}return A});s.options=u;return s};q.andand=function(){var s=Array.prototype.slice.call(arguments);s.unshift(true);return q.many.apply(q,s)};q.oror=function(){var s=Array.prototype.slice.call(arguments);s.unshift(false);return q.many.apply(q,s)};q.prototype={constructor:q,match:function(){throw new Error("unimplemented")},toString:function(){throw new Error("unimplemented")},func:function(){return this.match.bind(this)},then:function(s){return q.seq(this,s)},or:function(s){return q.alt(this,s)},andand:function(s){return q.many(true,this,s)},oror:function(s){return q.many(false,this,s)},star:function(){return this.braces(0,Infinity,"*")},plus:function(){return this.braces(1,Infinity,"+")},question:function(){return this.braces(0,1,"?")},hash:function(){return this.braces(1,Infinity,"#",q.cast(","))},braces:function(A,s,u,B){var x=this,w=B?B.then(this):this;if(!u){u="{"+A+","+s+"}"}return new q(function(E){var C=true,D;for(D=0;D<s;D++){if(D>0&&B){C=w.match(E)}else{C=x.match(E)}if(!C){break}}return D>=A},function(){return x.toString(q.prec.MOD)+u})}}},{"../util/StringReader":24,"../util/SyntaxError":25,"./ValidationTypes":21}],4:[function(n,o,m){o.exports=l;var r=n("../util/SyntaxUnit");var q=n("./Parser");function l(s,u){r.call(this,"("+s+(u!==null?":"+u:"")+")",s.startLine,s.startCol,q.MEDIA_FEATURE_TYPE);this.name=s;this.value=u}l.prototype=new r();l.prototype.constructor=l},{"../util/SyntaxUnit":26,"./Parser":6}],5:[function(m,n,l){n.exports=o;var r=m("../util/SyntaxUnit");var q=m("./Parser");function o(s,w,A,u,x){r.call(this,(s?s+" ":"")+(w?w:"")+(w&&A.length>0?" and ":"")+A.join(" and "),u,x,q.MEDIA_QUERY_TYPE);this.modifier=s;this.mediaType=w;this.features=A}o.prototype=new r();o.prototype.constructor=o},{"../util/SyntaxUnit":26,"./Parser":6}],6:[function(A,n,H){n.exports=m;var w=A("../util/EventTarget");var I=A("../util/SyntaxError");var D=A("../util/SyntaxUnit");var q=A("./Combinator");var l=A("./MediaFeature");var o=A("./MediaQuery");var r=A("./PropertyName");var s=A("./PropertyValue");var F=A("./PropertyValuePart");var E=A("./Selector");var B=A("./SelectorPart");var x=A("./SelectorSubPart");var u=A("./TokenStream");var C=A("./Tokens");var G=A("./Validation");function m(J){w.call(this);this.options=J||{};this._tokenStream=null}m.DEFAULT_TYPE=0;m.COMBINATOR_TYPE=1;m.MEDIA_FEATURE_TYPE=2;m.MEDIA_QUERY_TYPE=3;m.PROPERTY_NAME_TYPE=4;m.PROPERTY_VALUE_TYPE=5;m.PROPERTY_VALUE_PART_TYPE=6;m.SELECTOR_TYPE=7;m.SELECTOR_PART_TYPE=8;m.SELECTOR_SUB_PART_TYPE=9;m.prototype=function(){var J=new w(),L,K={__proto__:null,constructor:m,DEFAULT_TYPE:0,COMBINATOR_TYPE:1,MEDIA_FEATURE_TYPE:2,MEDIA_QUERY_TYPE:3,PROPERTY_NAME_TYPE:4,PROPERTY_VALUE_TYPE:5,PROPERTY_VALUE_PART_TYPE:6,SELECTOR_TYPE:7,SELECTOR_PART_TYPE:8,SELECTOR_SUB_PART_TYPE:9,_stylesheet:function(){var M=this._tokenStream,Q,O,P;this.fire("startstylesheet");this._charset();this._skipCruft();while(M.peek()===C.IMPORT_SYM){this._import();this._skipCruft()}while(M.peek()===C.NAMESPACE_SYM){this._namespace();this._skipCruft()}P=M.peek();while(P>C.EOF){try{switch(P){case C.MEDIA_SYM:this._media();this._skipCruft();break;case C.PAGE_SYM:this._page();this._skipCruft();break;case C.FONT_FACE_SYM:this._font_face();this._skipCruft();break;case C.KEYFRAMES_SYM:this._keyframes();this._skipCruft();break;case C.VIEWPORT_SYM:this._viewport();this._skipCruft();break;case C.DOCUMENT_SYM:this._document();this._skipCruft();break;case C.SUPPORTS_SYM:this._supports();this._skipCruft();break;case C.UNKNOWN_SYM:M.get();if(!this.options.strict){this.fire({type:"error",error:null,message:"Unknown @ rule: "+M.LT(0).value+".",line:M.LT(0).startLine,col:M.LT(0).startCol});Q=0;while(M.advance([C.LBRACE,C.RBRACE])===C.LBRACE){Q++}while(Q){M.advance([C.RBRACE]);Q--}}else{throw new I("Unknown @ rule.",M.LT(0).startLine,M.LT(0).startCol)}break;case C.S:this._readWhitespace();break;default:if(!this._ruleset()){switch(P){case C.CHARSET_SYM:O=M.LT(1);this._charset(false);throw new I("@charset not allowed here.",O.startLine,O.startCol);case C.IMPORT_SYM:O=M.LT(1);this._import(false);throw new I("@import not allowed here.",O.startLine,O.startCol);case C.NAMESPACE_SYM:O=M.LT(1);this._namespace(false);throw new I("@namespace not allowed here.",O.startLine,O.startCol);default:M.get();this._unexpectedToken(M.token())}}}}catch(N){if(N instanceof I&&!this.options.strict){this.fire({type:"error",error:N,message:N.message,line:N.line,col:N.col})}else{throw N}}P=M.peek()}if(P!==C.EOF){this._unexpectedToken(M.token())}this.fire("endstylesheet")},_charset:function(P){var N=this._tokenStream,R,Q,M,O;if(N.match(C.CHARSET_SYM)){M=N.token().startLine;O=N.token().startCol;this._readWhitespace();N.mustMatch(C.STRING);Q=N.token();R=Q.value;this._readWhitespace();N.mustMatch(C.SEMICOLON);if(P!==false){this.fire({type:"charset",charset:R,line:M,col:O})}}},_import:function(O){var M=this._tokenStream,P,Q,N=[];M.mustMatch(C.IMPORT_SYM);Q=M.token();this._readWhitespace();M.mustMatch([C.STRING,C.URI]);P=M.token().value.replace(/^(?:url\()?["']?([^"']+?)["']?\)?$/,"$1");this._readWhitespace();N=this._media_query_list();M.mustMatch(C.SEMICOLON);this._readWhitespace();if(O!==false){this.fire({type:"import",uri:P,media:N,line:Q.startLine,col:Q.startCol})}},_namespace:function(P){var N=this._tokenStream,M,O,R,Q;N.mustMatch(C.NAMESPACE_SYM);M=N.token().startLine;O=N.token().startCol;this._readWhitespace();if(N.match(C.IDENT)){R=N.token().value;this._readWhitespace()}N.mustMatch([C.STRING,C.URI]);Q=N.token().value.replace(/(?:url\()?["']([^"']+)["']\)?/,"$1");this._readWhitespace();N.mustMatch(C.SEMICOLON);this._readWhitespace();if(P!==false){this.fire({type:"namespace",prefix:R,uri:Q,line:M,col:O})}},_supports:function(P){var N=this._tokenStream,M,O;if(N.match(C.SUPPORTS_SYM)){M=N.token().startLine;O=N.token().startCol;this._readWhitespace();this._supports_condition();this._readWhitespace();N.mustMatch(C.LBRACE);this._readWhitespace();if(P!==false){this.fire({type:"startsupports",line:M,col:O})}while(true){if(!this._ruleset()){break}}N.mustMatch(C.RBRACE);this._readWhitespace();this.fire({type:"endsupports",line:M,col:O})}},_supports_condition:function(){var M=this._tokenStream,N;if(M.match(C.IDENT)){N=M.token().value.toLowerCase();if(N==="not"){M.mustMatch(C.S);this._supports_condition_in_parens()}else{M.unget()}}else{this._supports_condition_in_parens();this._readWhitespace();while(M.peek()===C.IDENT){N=M.LT(1).value.toLowerCase();if(N==="and"||N==="or"){M.mustMatch(C.IDENT);this._readWhitespace();this._supports_condition_in_parens();this._readWhitespace()}}}},_supports_condition_in_parens:function(){var M=this._tokenStream,N;if(M.match(C.LPAREN)){this._readWhitespace();if(M.match(C.IDENT)){N=M.token().value.toLowerCase();if(N==="not"){this._readWhitespace();this._supports_condition();this._readWhitespace();M.mustMatch(C.RPAREN)}else{M.unget();this._supports_declaration_condition(false)}}else{this._supports_condition();this._readWhitespace();M.mustMatch(C.RPAREN)}}else{this._supports_declaration_condition()}},_supports_declaration_condition:function(N){var M=this._tokenStream;if(N!==false){M.mustMatch(C.LPAREN)}this._readWhitespace();this._declaration();M.mustMatch(C.RPAREN)},_media:function(){var N=this._tokenStream,M,P,O;N.mustMatch(C.MEDIA_SYM);M=N.token().startLine;P=N.token().startCol;this._readWhitespace();O=this._media_query_list();N.mustMatch(C.LBRACE);this._readWhitespace();this.fire({type:"startmedia",media:O,line:M,col:P});while(true){if(N.peek()===C.PAGE_SYM){this._page()}else{if(N.peek()===C.FONT_FACE_SYM){this._font_face()}else{if(N.peek()===C.VIEWPORT_SYM){this._viewport()}else{if(N.peek()===C.DOCUMENT_SYM){this._document()}else{if(N.peek()===C.SUPPORTS_SYM){this._supports()}else{if(N.peek()===C.MEDIA_SYM){this._media()}else{if(!this._ruleset()){break}}}}}}}}N.mustMatch(C.RBRACE);this._readWhitespace();this.fire({type:"endmedia",media:O,line:M,col:P})},_media_query_list:function(){var M=this._tokenStream,N=[];this._readWhitespace();if(M.peek()===C.IDENT||M.peek()===C.LPAREN){N.push(this._media_query())}while(M.match(C.COMMA)){this._readWhitespace();N.push(this._media_query())}return N},_media_query:function(){var M=this._tokenStream,O=null,Q=null,N=null,P=[];if(M.match(C.IDENT)){Q=M.token().value.toLowerCase();if(Q!=="only"&&Q!=="not"){M.unget();Q=null}else{N=M.token()}}this._readWhitespace();if(M.peek()===C.IDENT){O=this._media_type();if(N===null){N=M.token()}}else{if(M.peek()===C.LPAREN){if(N===null){N=M.LT(1)}P.push(this._media_expression())}}if(O===null&&P.length===0){return null}else{this._readWhitespace();while(M.match(C.IDENT)){if(M.token().value.toLowerCase()!=="and"){this._unexpectedToken(M.token())}this._readWhitespace();P.push(this._media_expression())}}return new o(Q,O,P,N.startLine,N.startCol)},_media_type:function(){return this._media_feature()},_media_expression:function(){var M=this._tokenStream,O=null,N,P=null;M.mustMatch(C.LPAREN);O=this._media_feature();this._readWhitespace();if(M.match(C.COLON)){this._readWhitespace();N=M.LT(1);P=this._expression()}M.mustMatch(C.RPAREN);this._readWhitespace();return new l(O,P?new D(P,N.startLine,N.startCol):null)},_media_feature:function(){var M=this._tokenStream;this._readWhitespace();M.mustMatch(C.IDENT);return D.fromToken(M.token())},_page:function(){var N=this._tokenStream,M,P,O=null,Q=null;N.mustMatch(C.PAGE_SYM);M=N.token().startLine;P=N.token().startCol;this._readWhitespace();if(N.match(C.IDENT)){O=N.token().value;if(O.toLowerCase()==="auto"){this._unexpectedToken(N.token())}}if(N.peek()===C.COLON){Q=this._pseudo_page()}this._readWhitespace();this.fire({type:"startpage",id:O,pseudo:Q,line:M,col:P});this._readDeclarations(true,true);this.fire({type:"endpage",id:O,pseudo:Q,line:M,col:P})},_margin:function(){var O=this._tokenStream,N,P,M=this._margin_sym();if(M){N=O.token().startLine;P=O.token().startCol;this.fire({type:"startpagemargin",margin:M,line:N,col:P});this._readDeclarations(true);this.fire({type:"endpagemargin",margin:M,line:N,col:P});return true}else{return false}},_margin_sym:function(){var M=this._tokenStream;if(M.match([C.TOPLEFTCORNER_SYM,C.TOPLEFT_SYM,C.TOPCENTER_SYM,C.TOPRIGHT_SYM,C.TOPRIGHTCORNER_SYM,C.BOTTOMLEFTCORNER_SYM,C.BOTTOMLEFT_SYM,C.BOTTOMCENTER_SYM,C.BOTTOMRIGHT_SYM,C.BOTTOMRIGHTCORNER_SYM,C.LEFTTOP_SYM,C.LEFTMIDDLE_SYM,C.LEFTBOTTOM_SYM,C.RIGHTTOP_SYM,C.RIGHTMIDDLE_SYM,C.RIGHTBOTTOM_SYM])){return D.fromToken(M.token())}else{return null}},_pseudo_page:function(){var M=this._tokenStream;M.mustMatch(C.COLON);M.mustMatch(C.IDENT);return M.token().value},_font_face:function(){var N=this._tokenStream,M,O;N.mustMatch(C.FONT_FACE_SYM);M=N.token().startLine;O=N.token().startCol;this._readWhitespace();this.fire({type:"startfontface",line:M,col:O});this._readDeclarations(true);this.fire({type:"endfontface",line:M,col:O})},_viewport:function(){var N=this._tokenStream,M,O;N.mustMatch(C.VIEWPORT_SYM);M=N.token().startLine;O=N.token().startCol;this._readWhitespace();this.fire({type:"startviewport",line:M,col:O});this._readDeclarations(true);this.fire({type:"endviewport",line:M,col:O})},_document:function(){var M=this._tokenStream,O,Q=[],P="";M.mustMatch(C.DOCUMENT_SYM);O=M.token();if(/^@\-([^\-]+)\-/.test(O.value)){P=RegExp.$1}this._readWhitespace();Q.push(this._document_function());while(M.match(C.COMMA)){this._readWhitespace();Q.push(this._document_function())}M.mustMatch(C.LBRACE);this._readWhitespace();this.fire({type:"startdocument",functions:Q,prefix:P,line:O.startLine,col:O.startCol});var N=true;while(N){switch(M.peek()){case C.PAGE_SYM:this._page();break;case C.FONT_FACE_SYM:this._font_face();break;case C.VIEWPORT_SYM:this._viewport();break;case C.MEDIA_SYM:this._media();break;case C.KEYFRAMES_SYM:this._keyframes();break;case C.DOCUMENT_SYM:this._document();break;default:N=Boolean(this._ruleset())}}M.mustMatch(C.RBRACE);O=M.token();this._readWhitespace();this.fire({type:"enddocument",functions:Q,prefix:P,line:O.startLine,col:O.startCol})},_document_function:function(){var M=this._tokenStream,N;if(M.match(C.URI)){N=M.token().value;this._readWhitespace()}else{N=this._function()}return N},_operator:function(M){var N=this._tokenStream,O=null;if(N.match([C.SLASH,C.COMMA])||(M&&N.match([C.PLUS,C.STAR,C.MINUS]))){O=N.token();this._readWhitespace()}return O?F.fromToken(O):null},_combinator:function(){var M=this._tokenStream,O=null,N;if(M.match([C.PLUS,C.GREATER,C.TILDE])){N=M.token();O=new q(N.value,N.startLine,N.startCol);this._readWhitespace()}return O},_unary_operator:function(){var M=this._tokenStream;if(M.match([C.MINUS,C.PLUS])){return M.token().value}else{return null}},_property:function(){var N=this._tokenStream,S=null,R=null,Q,P,M,O;if(N.peek()===C.STAR&&this.options.starHack){N.get();P=N.token();R=P.value;M=P.startLine;O=P.startCol}if(N.match(C.IDENT)){P=N.token();Q=P.value;if(Q.charAt(0)==="_"&&this.options.underscoreHack){R="_";Q=Q.substring(1)}S=new r(Q,R,(M||P.startLine),(O||P.startCol));this._readWhitespace()}return S},_ruleset:function(){var M=this._tokenStream,P,O;try{O=this._selectors_group()}catch(N){if(N instanceof I&&!this.options.strict){this.fire({type:"error",error:N,message:N.message,line:N.line,col:N.col});P=M.advance([C.RBRACE]);if(P===C.RBRACE){}else{throw N}}else{throw N}return true}if(O){this.fire({type:"startrule",selectors:O,line:O[0].line,col:O[0].col});this._readDeclarations(true);this.fire({type:"endrule",selectors:O,line:O[0].line,col:O[0].col})}return O},_selectors_group:function(){var N=this._tokenStream,O=[],M;M=this._selector();if(M!==null){O.push(M);while(N.match(C.COMMA)){this._readWhitespace();M=this._selector();if(M!==null){O.push(M)}else{this._unexpectedToken(N.LT(1))}}}return O.length?O:null},_selector:function(){var O=this._tokenStream,M=[],Q=null,P=null,N=null;Q=this._simple_selector_sequence();if(Q===null){return null}M.push(Q);do{P=this._combinator();if(P!==null){M.push(P);Q=this._simple_selector_sequence();if(Q===null){this._unexpectedToken(O.LT(1))}else{M.push(Q)}}else{if(this._readWhitespace()){N=new q(O.token().value,O.token().startLine,O.token().startCol);P=this._combinator();Q=this._simple_selector_sequence();if(Q===null){if(P!==null){this._unexpectedToken(O.LT(1))}}else{if(P!==null){M.push(P)}else{M.push(N)}M.push(Q)}}else{break}}}while(true);return new E(M,M[0].line,M[0].col)},_simple_selector_sequence:function(){var O=this._tokenStream,V=null,T=[],M="",Q=[function(){return O.match(C.HASH)?new x(O.token().value,"id",O.token().startLine,O.token().startCol):null},this._class,this._attrib,this._pseudo,this._negation],P=0,R=Q.length,S=null,U,N;U=O.LT(1).startLine;N=O.LT(1).startCol;V=this._type_selector();if(!V){V=this._universal()}if(V!==null){M+=V}while(true){if(O.peek()===C.S){break}while(P<R&&S===null){S=Q[P++].call(this)}if(S===null){if(M===""){return null}else{break}}else{P=0;T.push(S);M+=S.toString();S=null}}return M!==""?new B(V,T,M,U,N):null},_type_selector:function(){var N=this._tokenStream,O=this._namespace_prefix(),M=this._element_name();if(!M){if(O){N.unget();if(O.length>1){N.unget()}}return null}else{if(O){M.text=O+M.text;M.col-=O.length}return M}},_class:function(){var M=this._tokenStream,N;if(M.match(C.DOT)){M.mustMatch(C.IDENT);N=M.token();return new x("."+N.value,"class",N.startLine,N.startCol-1)}else{return null}},_element_name:function(){var M=this._tokenStream,N;if(M.match(C.IDENT)){N=M.token();return new x(N.value,"elementName",N.startLine,N.startCol)}else{return null}},_namespace_prefix:function(){var M=this._tokenStream,N="";if(M.LA(1)===C.PIPE||M.LA(2)===C.PIPE){if(M.match([C.IDENT,C.STAR])){N+=M.token().value}M.mustMatch(C.PIPE);N+="|"}return N.length?N:null},_universal:function(){var M=this._tokenStream,O="",N;N=this._namespace_prefix();if(N){O+=N}if(M.match(C.STAR)){O+="*"}return O.length?O:null},_attrib:function(){var M=this._tokenStream,P=null,O,N;if(M.match(C.LBRACKET)){N=M.token();P=N.value;P+=this._readWhitespace();O=this._namespace_prefix();if(O){P+=O}M.mustMatch(C.IDENT);P+=M.token().value;P+=this._readWhitespace();if(M.match([C.PREFIXMATCH,C.SUFFIXMATCH,C.SUBSTRINGMATCH,C.EQUALS,C.INCLUDES,C.DASHMATCH])){P+=M.token().value;P+=this._readWhitespace();M.mustMatch([C.IDENT,C.STRING]);P+=M.token().value;P+=this._readWhitespace()}M.mustMatch(C.RBRACKET);return new x(P+"]","attribute",N.startLine,N.startCol)}else{return null}},_pseudo:function(){var N=this._tokenStream,R=null,P=":",M,O;if(N.match(C.COLON)){if(N.match(C.COLON)){P+=":"}if(N.match(C.IDENT)){R=N.token().value;M=N.token().startLine;O=N.token().startCol-P.length}else{if(N.peek()===C.FUNCTION){M=N.LT(1).startLine;O=N.LT(1).startCol-P.length;R=this._functional_pseudo()}}if(R){R=new x(P+R,"pseudo",M,O)}else{var S=N.LT(1).startLine,Q=N.LT(0).startCol;throw new I("Expected a `FUNCTION` or `IDENT` after colon at line "+S+", col "+Q+".",S,Q)}}return R},_functional_pseudo:function(){var M=this._tokenStream,N=null;if(M.match(C.FUNCTION)){N=M.token().value;N+=this._readWhitespace();N+=this._expression();M.mustMatch(C.RPAREN);N+=")"}return N},_expression:function(){var M=this._tokenStream,N="";while(M.match([C.PLUS,C.MINUS,C.DIMENSION,C.NUMBER,C.STRING,C.IDENT,C.LENGTH,C.FREQ,C.ANGLE,C.TIME,C.RESOLUTION,C.SLASH])){N+=M.token().value;N+=this._readWhitespace()}return N.length?N:null},_negation:function(){var O=this._tokenStream,N,P,Q="",M,R=null;if(O.match(C.NOT)){Q=O.token().value;N=O.token().startLine;P=O.token().startCol;Q+=this._readWhitespace();M=this._negation_arg();Q+=M;Q+=this._readWhitespace();O.match(C.RPAREN);Q+=O.token().value;R=new x(Q,"not",N,P);R.args.push(M)}return R},_negation_arg:function(){var P=this._tokenStream,S=[this._type_selector,this._universal,function(){return P.match(C.HASH)?new x(P.token().value,"id",P.token().startLine,P.token().startCol):null},this._class,this._attrib,this._pseudo],N=null,T=0,M=S.length,O,R,Q;O=P.LT(1).startLine;R=P.LT(1).startCol;while(T<M&&N===null){N=S[T].call(this);T++}if(N===null){this._unexpectedToken(P.LT(1))}if(N.type==="elementName"){Q=new B(N,[],N.toString(),O,R)}else{Q=new B(null,[N],N.toString(),O,R)}return Q},_declaration:function(){var N=this._tokenStream,Q=null,R=null,S=null,P=null,M="";Q=this._property();if(Q!==null){N.mustMatch(C.COLON);this._readWhitespace();R=this._expr();if(!R||R.length===0){this._unexpectedToken(N.LT(1))}S=this._prio();M=Q.toString();if(this.options.starHack&&Q.hack==="*"||this.options.underscoreHack&&Q.hack==="_"){M=Q.text}try{this._validateProperty(M,R)}catch(O){P=O}this.fire({type:"property",property:Q,value:R,important:S,line:Q.line,col:Q.col,invalid:P});return true}else{return false}},_prio:function(){var N=this._tokenStream,M=N.match(C.IMPORTANT_SYM);this._readWhitespace();return M},_expr:function(M){var O=[],P=null,N=null;P=this._term(M);if(P!==null){O.push(P);do{N=this._operator(M);if(N){O.push(N)}P=this._term(M);if(P===null){break}else{O.push(P)}}while(true)}return O.length>0?new s(O,O[0].line,O[0].col):null},_term:function(T){var O=this._tokenStream,Q=null,S=null,R=null,M=null,P,U,N;Q=this._unary_operator();if(Q!==null){U=O.token().startLine;N=O.token().startCol}if(O.peek()===C.IE_FUNCTION&&this.options.ieFilters){S=this._ie_function();if(Q===null){U=O.token().startLine;N=O.token().startCol}}else{if(T&&O.match([C.LPAREN,C.LBRACE,C.LBRACKET])){P=O.token();R=P.endChar;S=P.value+this._expr(T).text;if(Q===null){U=O.token().startLine;N=O.token().startCol}O.mustMatch(C.type(R));S+=R;this._readWhitespace()}else{if(O.match([C.NUMBER,C.PERCENTAGE,C.LENGTH,C.ANGLE,C.TIME,C.FREQ,C.STRING,C.IDENT,C.URI,C.UNICODE_RANGE])){S=O.token().value;if(Q===null){U=O.token().startLine;N=O.token().startCol;M=F.fromToken(O.token())}this._readWhitespace()}else{P=this._hexcolor();if(P===null){if(Q===null){U=O.LT(1).startLine;N=O.LT(1).startCol}if(S===null){if(O.LA(3)===C.EQUALS&&this.options.ieFilters){S=this._ie_function()}else{S=this._function()}}}else{S=P.value;if(Q===null){U=P.startLine;N=P.startCol}}}}}return M!==null?M:S!==null?new F(Q!==null?Q+S:S,U,N):null},_function:function(){var O=this._tokenStream,N=null,P=null,M;if(O.match(C.FUNCTION)){N=O.token().value;this._readWhitespace();P=this._expr(true);N+=P;if(this.options.ieFilters&&O.peek()===C.EQUALS){do{if(this._readWhitespace()){N+=O.token().value}if(O.LA(0)===C.COMMA){N+=O.token().value}O.match(C.IDENT);N+=O.token().value;O.match(C.EQUALS);N+=O.token().value;M=O.peek();while(M!==C.COMMA&&M!==C.S&&M!==C.RPAREN){O.get();N+=O.token().value;M=O.peek()}}while(O.match([C.COMMA,C.S]))}O.match(C.RPAREN);N+=")";this._readWhitespace()}return N},_ie_function:function(){var O=this._tokenStream,N=null,M;if(O.match([C.IE_FUNCTION,C.FUNCTION])){N=O.token().value;do{if(this._readWhitespace()){N+=O.token().value}if(O.LA(0)===C.COMMA){N+=O.token().value}O.match(C.IDENT);N+=O.token().value;O.match(C.EQUALS);N+=O.token().value;M=O.peek();while(M!==C.COMMA&&M!==C.S&&M!==C.RPAREN){O.get();N+=O.token().value;M=O.peek()}}while(O.match([C.COMMA,C.S]));O.match(C.RPAREN);N+=")";this._readWhitespace()}return N},_hexcolor:function(){var N=this._tokenStream,O=null,M;if(N.match(C.HASH)){O=N.token();M=O.value;if(!/#[a-f0-9]{3,6}/i.test(M)){throw new I("Expected a hex color but found '"+M+"' at line "+O.startLine+", col "+O.startCol+".",O.startLine,O.startCol)}this._readWhitespace()}return O},_keyframes:function(){var M=this._tokenStream,O,P,N,Q="";M.mustMatch(C.KEYFRAMES_SYM);O=M.token();if(/^@\-([^\-]+)\-/.test(O.value)){Q=RegExp.$1}this._readWhitespace();N=this._keyframe_name();this._readWhitespace();M.mustMatch(C.LBRACE);this.fire({type:"startkeyframes",name:N,prefix:Q,line:O.startLine,col:O.startCol});this._readWhitespace();P=M.peek();while(P===C.IDENT||P===C.PERCENTAGE){this._keyframe_rule();this._readWhitespace();P=M.peek()}this.fire({type:"endkeyframes",name:N,prefix:Q,line:O.startLine,col:O.startCol});this._readWhitespace();M.mustMatch(C.RBRACE);this._readWhitespace()},_keyframe_name:function(){var M=this._tokenStream;M.mustMatch([C.IDENT,C.STRING]);return D.fromToken(M.token())},_keyframe_rule:function(){var M=this._key_list();this.fire({type:"startkeyframerule",keys:M,line:M[0].line,col:M[0].col});this._readDeclarations(true);this.fire({type:"endkeyframerule",keys:M,line:M[0].line,col:M[0].col})},_key_list:function(){var M=this._tokenStream,N=[];N.push(this._key());this._readWhitespace();while(M.match(C.COMMA)){this._readWhitespace();N.push(this._key());this._readWhitespace()}return N},_key:function(){var M=this._tokenStream,N;if(M.match(C.PERCENTAGE)){return D.fromToken(M.token())}else{if(M.match(C.IDENT)){N=M.token();if(/from|to/i.test(N.value)){return D.fromToken(N)}M.unget()}}this._unexpectedToken(M.LT(1))},_skipCruft:function(){while(this._tokenStream.match([C.S,C.CDO,C.CDC])){}},_readDeclarations:function(Q,M){var N=this._tokenStream,P;this._readWhitespace();if(Q){N.mustMatch(C.LBRACE)}this._readWhitespace();try{while(true){if(N.match(C.SEMICOLON)||(M&&this._margin())){}else{if(this._declaration()){if(!N.match(C.SEMICOLON)){break}}else{break}}this._readWhitespace()}N.mustMatch(C.RBRACE);this._readWhitespace()}catch(O){if(O instanceof I&&!this.options.strict){this.fire({type:"error",error:O,message:O.message,line:O.line,col:O.col});P=N.advance([C.SEMICOLON,C.RBRACE]);if(P===C.SEMICOLON){this._readDeclarations(false,M)}else{if(P!==C.RBRACE){throw O}}}else{throw O}}},_readWhitespace:function(){var N=this._tokenStream,M="";while(N.match(C.S)){M+=N.token().value}return M},_unexpectedToken:function(M){throw new I("Unexpected token '"+M.value+"' at line "+M.startLine+", col "+M.startCol+".",M.startLine,M.startCol)},_verifyEnd:function(){if(this._tokenStream.LA(1)!==C.EOF){this._unexpectedToken(this._tokenStream.LT(1))}},_validateProperty:function(N,M){G.validate(N,M)},parse:function(M){this._tokenStream=new u(M,C);this._stylesheet()},parseStyleSheet:function(M){return this.parse(M)},parseMediaQuery:function(N){this._tokenStream=new u(N,C);var M=this._media_query();this._verifyEnd();return M},parsePropertyValue:function(N){this._tokenStream=new u(N,C);this._readWhitespace();var M=this._expr();this._readWhitespace();this._verifyEnd();return M},parseRule:function(N){this._tokenStream=new u(N,C);this._readWhitespace();var M=this._ruleset();this._readWhitespace();this._verifyEnd();return M},parseSelector:function(N){this._tokenStream=new u(N,C);this._readWhitespace();var M=this._selector();this._readWhitespace();this._verifyEnd();return M},parseStyleAttribute:function(M){M+="}";this._tokenStream=new u(M,C);this._readDeclarations()}};for(L in K){if(Object.prototype.hasOwnProperty.call(K,L)){J[L]=K[L]}}return J}()},{"../util/EventTarget":23,"../util/SyntaxError":25,"../util/SyntaxUnit":26,"./Combinator":2,"./MediaFeature":4,"./MediaQuery":5,"./PropertyName":8,"./PropertyValue":9,"./PropertyValuePart":11,"./Selector":13,"./SelectorPart":14,"./SelectorSubPart":15,"./TokenStream":17,"./Tokens":18,"./Validation":19}],7:[function(n,o,m){var l=o.exports={__proto__:null,"align-items":"flex-start | flex-end | center | baseline | stretch","align-content":"flex-start | flex-end | center | space-between | space-around | stretch","align-self":"auto | flex-start | flex-end | center | baseline | stretch",all:"initial | inherit | unset","-webkit-align-items":"flex-start | flex-end | center | baseline | stretch","-webkit-align-content":"flex-start | flex-end | center | space-between | space-around | stretch","-webkit-align-self":"auto | flex-start | flex-end | center | baseline | stretch","alignment-adjust":"auto | baseline | before-edge | text-before-edge | middle | central | after-edge | text-after-edge | ideographic | alphabetic | hanging | mathematical | <percentage> | <length>","alignment-baseline":"auto | baseline | use-script | before-edge | text-before-edge | after-edge | text-after-edge | central | middle | ideographic | alphabetic | hanging | mathematical",animation:1,"animation-delay":"<time>#","animation-direction":"<single-animation-direction>#","animation-duration":"<time>#","animation-fill-mode":"[ none | forwards | backwards | both ]#","animation-iteration-count":"[ <number> | infinite ]#","animation-name":"[ none | <single-animation-name> ]#","animation-play-state":"[ running | paused ]#","animation-timing-function":1,"-moz-animation-delay":"<time>#","-moz-animation-direction":"[ normal | alternate ]#","-moz-animation-duration":"<time>#","-moz-animation-iteration-count":"[ <number> | infinite ]#","-moz-animation-name":"[ none | <single-animation-name> ]#","-moz-animation-play-state":"[ running | paused ]#","-ms-animation-delay":"<time>#","-ms-animation-direction":"[ normal | alternate ]#","-ms-animation-duration":"<time>#","-ms-animation-iteration-count":"[ <number> | infinite ]#","-ms-animation-name":"[ none | <single-animation-name> ]#","-ms-animation-play-state":"[ running | paused ]#","-webkit-animation-delay":"<time>#","-webkit-animation-direction":"[ normal | alternate ]#","-webkit-animation-duration":"<time>#","-webkit-animation-fill-mode":"[ none | forwards | backwards | both ]#","-webkit-animation-iteration-count":"[ <number> | infinite ]#","-webkit-animation-name":"[ none | <single-animation-name> ]#","-webkit-animation-play-state":"[ running | paused ]#","-o-animation-delay":"<time>#","-o-animation-direction":"[ normal | alternate ]#","-o-animation-duration":"<time>#","-o-animation-iteration-count":"[ <number> | infinite ]#","-o-animation-name":"[ none | <single-animation-name> ]#","-o-animation-play-state":"[ running | paused ]#",appearance:"none | auto","-moz-appearance":"none | button | button-arrow-down | button-arrow-next | button-arrow-previous | button-arrow-up | button-bevel | button-focus | caret | checkbox | checkbox-container | checkbox-label | checkmenuitem | dualbutton | groupbox | listbox | listitem | menuarrow | menubar | menucheckbox | menuimage | menuitem | menuitemtext | menulist | menulist-button | menulist-text | menulist-textfield | menupopup | menuradio | menuseparator | meterbar | meterchunk | progressbar | progressbar-vertical | progresschunk | progresschunk-vertical | radio | radio-container | radio-label | radiomenuitem | range | range-thumb | resizer | resizerpanel | scale-horizontal | scalethumbend | scalethumb-horizontal | scalethumbstart | scalethumbtick | scalethumb-vertical | scale-vertical | scrollbarbutton-down | scrollbarbutton-left | scrollbarbutton-right | scrollbarbutton-up | scrollbarthumb-horizontal | scrollbarthumb-vertical | scrollbartrack-horizontal | scrollbartrack-vertical | searchfield | separator | sheet | spinner | spinner-downbutton | spinner-textfield | spinner-upbutton | splitter | statusbar | statusbarpanel | tab | tabpanel | tabpanels | tab-scroll-arrow-back | tab-scroll-arrow-forward | textfield | textfield-multiline | toolbar | toolbarbutton | toolbarbutton-dropdown | toolbargripper | toolbox | tooltip | treeheader | treeheadercell | treeheadersortarrow | treeitem | treeline | treetwisty | treetwistyopen | treeview | -moz-mac-unified-toolbar | -moz-win-borderless-glass | -moz-win-browsertabbar-toolbox | -moz-win-communicationstext | -moz-win-communications-toolbox | -moz-win-exclude-glass | -moz-win-glass | -moz-win-mediatext | -moz-win-media-toolbox | -moz-window-button-box | -moz-window-button-box-maximized | -moz-window-button-close | -moz-window-button-maximize | -moz-window-button-minimize | -moz-window-button-restore | -moz-window-frame-bottom | -moz-window-frame-left | -moz-window-frame-right | -moz-window-titlebar | -moz-window-titlebar-maximized","-ms-appearance":"none | icon | window | desktop | workspace | document | tooltip | dialog | button | push-button | hyperlink | radio | radio-button | checkbox | menu-item | tab | menu | menubar | pull-down-menu | pop-up-menu | list-menu | radio-group | checkbox-group | outline-tree | range | field | combo-box | signature | password | normal","-webkit-appearance":"none | button | button-bevel | caps-lock-indicator | caret | checkbox | default-button | listbox	| listitem | media-fullscreen-button | media-mute-button | media-play-button | media-seek-back-button	| media-seek-forward-button	| media-slider | media-sliderthumb | menulist	| menulist-button	| menulist-text	| menulist-textfield | push-button	| radio	| searchfield	| searchfield-cancel-button	| searchfield-decoration | searchfield-results-button | searchfield-results-decoration | slider-horizontal | slider-vertical | sliderthumb-horizontal | sliderthumb-vertical	| square-button	| textarea	| textfield	| scrollbarbutton-down | scrollbarbutton-left | scrollbarbutton-right | scrollbarbutton-up | scrollbargripper-horizontal | scrollbargripper-vertical | scrollbarthumb-horizontal | scrollbarthumb-vertical | scrollbartrack-horizontal | scrollbartrack-vertical","-o-appearance":"none | window | desktop | workspace | document | tooltip | dialog | button | push-button | hyperlink | radio | radio-button | checkbox | menu-item | tab | menu | menubar | pull-down-menu | pop-up-menu | list-menu | radio-group | checkbox-group | outline-tree | range | field | combo-box | signature | password | normal",azimuth:"<azimuth>","backface-visibility":"visible | hidden",background:1,"background-attachment":"<attachment>#","background-clip":"<box>#","background-color":"<color>","background-image":"<bg-image>#","background-origin":"<box>#","background-position":"<bg-position>","background-repeat":"<repeat-style>#","background-size":"<bg-size>#","baseline-shift":"baseline | sub | super | <percentage> | <length>",behavior:1,binding:1,bleed:"<length>","bookmark-label":"<content> | <attr> | <string>","bookmark-level":"none | <integer>","bookmark-state":"open | closed","bookmark-target":"none | <uri> | <attr>",border:"<border-width> || <border-style> || <color>","border-bottom":"<border-width> || <border-style> || <color>","border-bottom-color":"<color>","border-bottom-left-radius":"<x-one-radius>","border-bottom-right-radius":"<x-one-radius>","border-bottom-style":"<border-style>","border-bottom-width":"<border-width>","border-collapse":"collapse | separate","border-color":"<color>{1,4}","border-image":1,"border-image-outset":"[ <length> | <number> ]{1,4}","border-image-repeat":"[ stretch | repeat | round ]{1,2}","border-image-slice":"<border-image-slice>","border-image-source":"<image> | none","border-image-width":"[ <length> | <percentage> | <number> | auto ]{1,4}","border-left":"<border-width> || <border-style> || <color>","border-left-color":"<color>","border-left-style":"<border-style>","border-left-width":"<border-width>","border-radius":"<border-radius>","border-right":"<border-width> || <border-style> || <color>","border-right-color":"<color>","border-right-style":"<border-style>","border-right-width":"<border-width>","border-spacing":"<length>{1,2}","border-style":"<border-style>{1,4}","border-top":"<border-width> || <border-style> || <color>","border-top-color":"<color>","border-top-left-radius":"<x-one-radius>","border-top-right-radius":"<x-one-radius>","border-top-style":"<border-style>","border-top-width":"<border-width>","border-width":"<border-width>{1,4}",bottom:"<margin-width>","-moz-box-align":"start | end | center | baseline | stretch","-moz-box-decoration-break":"slice | clone","-moz-box-direction":"normal | reverse","-moz-box-flex":"<number>","-moz-box-flex-group":"<integer>","-moz-box-lines":"single | multiple","-moz-box-ordinal-group":"<integer>","-moz-box-orient":"horizontal | vertical | inline-axis | block-axis","-moz-box-pack":"start | end | center | justify","-o-box-decoration-break":"slice | clone","-webkit-box-align":"start | end | center | baseline | stretch","-webkit-box-decoration-break":"slice | clone","-webkit-box-direction":"normal | reverse","-webkit-box-flex":"<number>","-webkit-box-flex-group":"<integer>","-webkit-box-lines":"single | multiple","-webkit-box-ordinal-group":"<integer>","-webkit-box-orient":"horizontal | vertical | inline-axis | block-axis","-webkit-box-pack":"start | end | center | justify","box-decoration-break":"slice | clone","box-shadow":"<box-shadow>","box-sizing":"content-box | border-box","break-after":"auto | always | avoid | left | right | page | column | avoid-page | avoid-column","break-before":"auto | always | avoid | left | right | page | column | avoid-page | avoid-column","break-inside":"auto | avoid | avoid-page | avoid-column","caption-side":"top | bottom",clear:"none | right | left | both",clip:"<shape> | auto","-webkit-clip-path":"<clip-source> | <clip-path> | none","clip-path":"<clip-source> | <clip-path> | none","clip-rule":"nonzero | evenodd",color:"<color>","color-interpolation":"auto | sRGB | linearRGB","color-interpolation-filters":"auto | sRGB | linearRGB","color-profile":1,"color-rendering":"auto | optimizeSpeed | optimizeQuality","column-count":"<integer> | auto","column-fill":"auto | balance","column-gap":"<length> | normal","column-rule":"<border-width> || <border-style> || <color>","column-rule-color":"<color>","column-rule-style":"<border-style>","column-rule-width":"<border-width>","column-span":"none | all","column-width":"<length> | auto",columns:1,content:1,"counter-increment":1,"counter-reset":1,crop:"<shape> | auto",cue:"cue-after | cue-before","cue-after":1,"cue-before":1,cursor:1,direction:"ltr | rtl",display:"inline | block | list-item | inline-block | table | inline-table | table-row-group | table-header-group | table-footer-group | table-row | table-column-group | table-column | table-cell | table-caption | grid | inline-grid | run-in | ruby | ruby-base | ruby-text | ruby-base-container | ruby-text-container | contents | none | -moz-box | -moz-inline-block | -moz-inline-box | -moz-inline-grid | -moz-inline-stack | -moz-inline-table | -moz-grid | -moz-grid-group | -moz-grid-line | -moz-groupbox | -moz-deck | -moz-popup | -moz-stack | -moz-marker | -webkit-box | -webkit-inline-box | -ms-flexbox | -ms-inline-flexbox | flex | -webkit-flex | inline-flex | -webkit-inline-flex","dominant-baseline":"auto | use-script | no-change | reset-size | ideographic | alphabetic | hanging | mathematical | central | middle | text-after-edge | text-before-edge","drop-initial-after-adjust":"central | middle | after-edge | text-after-edge | ideographic | alphabetic | mathematical | <percentage> | <length>","drop-initial-after-align":"baseline | use-script | before-edge | text-before-edge | after-edge | text-after-edge | central | middle | ideographic | alphabetic | hanging | mathematical","drop-initial-before-adjust":"before-edge | text-before-edge | central | middle | hanging | mathematical | <percentage> | <length>","drop-initial-before-align":"caps-height | baseline | use-script | before-edge | text-before-edge | after-edge | text-after-edge | central | middle | ideographic | alphabetic | hanging | mathematical","drop-initial-size":"auto | line | <length> | <percentage>","drop-initial-value":"<integer>",elevation:"<angle> | below | level | above | higher | lower","empty-cells":"show | hide","enable-background":1,fill:"<paint>","fill-opacity":"<opacity-value>","fill-rule":"nonzero | evenodd",filter:"<filter-function-list> | none",fit:"fill | hidden | meet | slice","fit-position":1,flex:"<flex>","flex-basis":"<width>","flex-direction":"row | row-reverse | column | column-reverse","flex-flow":"<flex-direction> || <flex-wrap>","flex-grow":"<number>","flex-shrink":"<number>","flex-wrap":"nowrap | wrap | wrap-reverse","-webkit-flex":"<flex>","-webkit-flex-basis":"<width>","-webkit-flex-direction":"row | row-reverse | column | column-reverse","-webkit-flex-flow":"<flex-direction> || <flex-wrap>","-webkit-flex-grow":"<number>","-webkit-flex-shrink":"<number>","-webkit-flex-wrap":"nowrap | wrap | wrap-reverse","-ms-flex":"<flex>","-ms-flex-align":"start | end | center | stretch | baseline","-ms-flex-direction":"row | row-reverse | column | column-reverse","-ms-flex-order":"<number>","-ms-flex-pack":"start | end | center | justify","-ms-flex-wrap":"nowrap | wrap | wrap-reverse","float":"left | right | none","float-offset":1,"flood-color":1,"flood-opacity":"<opacity-value>",font:"<font-shorthand> | caption | icon | menu | message-box | small-caption | status-bar","font-family":"<font-family>","font-feature-settings":"<feature-tag-value> | normal","font-kerning":"auto | normal | none","font-size":"<font-size>","font-size-adjust":"<number> | none","font-stretch":"<font-stretch>","font-style":"<font-style>","font-variant":"<font-variant> | normal | none","font-variant-alternates":"<font-variant-alternates> | normal","font-variant-caps":"<font-variant-caps> | normal","font-variant-east-asian":"<font-variant-east-asian> | normal","font-variant-ligatures":"<font-variant-ligatures> | normal | none","font-variant-numeric":"<font-variant-numeric> | normal","font-variant-position":"normal | sub | super","font-weight":"<font-weight>","glyph-orientation-horizontal":"<glyph-angle>","glyph-orientation-vertical":"auto | <glyph-angle>",grid:1,"grid-area":1,"grid-auto-columns":1,"grid-auto-flow":1,"grid-auto-position":1,"grid-auto-rows":1,"grid-cell-stacking":"columns | rows | layer","grid-column":1,"grid-columns":1,"grid-column-align":"start | end | center | stretch","grid-column-sizing":1,"grid-column-start":1,"grid-column-end":1,"grid-column-span":"<integer>","grid-flow":"none | rows | columns","grid-layer":"<integer>","grid-row":1,"grid-rows":1,"grid-row-align":"start | end | center | stretch","grid-row-start":1,"grid-row-end":1,"grid-row-span":"<integer>","grid-row-sizing":1,"grid-template":1,"grid-template-areas":1,"grid-template-columns":1,"grid-template-rows":1,"hanging-punctuation":1,height:"<margin-width> | <content-sizing>","hyphenate-after":"<integer> | auto","hyphenate-before":"<integer> | auto","hyphenate-character":"<string> | auto","hyphenate-lines":"no-limit | <integer>","hyphenate-resource":1,hyphens:"none | manual | auto",icon:1,"image-orientation":"angle | auto","image-rendering":"auto | optimizeSpeed | optimizeQuality","image-resolution":1,"ime-mode":"auto | normal | active | inactive | disabled","inline-box-align":"last | <integer>","justify-content":"flex-start | flex-end | center | space-between | space-around","-webkit-justify-content":"flex-start | flex-end | center | space-between | space-around",kerning:"auto | <length>",left:"<margin-width>","letter-spacing":"<length> | normal","line-height":"<line-height>","line-break":"auto | loose | normal | strict","line-stacking":1,"line-stacking-ruby":"exclude-ruby | include-ruby","line-stacking-shift":"consider-shifts | disregard-shifts","line-stacking-strategy":"inline-line-height | block-line-height | max-height | grid-height","list-style":1,"list-style-image":"<uri> | none","list-style-position":"inside | outside","list-style-type":"disc | circle | square | decimal | decimal-leading-zero | lower-roman | upper-roman | lower-greek | lower-latin | upper-latin | armenian | georgian | lower-alpha | upper-alpha | none",margin:"<margin-width>{1,4}","margin-bottom":"<margin-width>","margin-left":"<margin-width>","margin-right":"<margin-width>","margin-top":"<margin-width>",mark:1,"mark-after":1,"mark-before":1,marker:1,"marker-end":1,"marker-mid":1,"marker-start":1,marks:1,"marquee-direction":1,"marquee-play-count":1,"marquee-speed":1,"marquee-style":1,mask:1,"max-height":"<length> | <percentage> | <content-sizing> | none","max-width":"<length> | <percentage> | <content-sizing> | none","min-height":"<length> | <percentage> | <content-sizing> | contain-floats | -moz-contain-floats | -webkit-contain-floats","min-width":"<length> | <percentage> | <content-sizing> | contain-floats | -moz-contain-floats | -webkit-contain-floats","move-to":1,"nav-down":1,"nav-index":1,"nav-left":1,"nav-right":1,"nav-up":1,"object-fit":"fill | contain | cover | none | scale-down","object-position":"<position>",opacity:"<opacity-value>",order:"<integer>","-webkit-order":"<integer>",orphans:"<integer>",outline:1,"outline-color":"<color> | invert","outline-offset":1,"outline-style":"<border-style>","outline-width":"<border-width>",overflow:"visible | hidden | scroll | auto","overflow-style":1,"overflow-wrap":"normal | break-word","overflow-x":1,"overflow-y":1,padding:"<padding-width>{1,4}","padding-bottom":"<padding-width>","padding-left":"<padding-width>","padding-right":"<padding-width>","padding-top":"<padding-width>",page:1,"page-break-after":"auto | always | avoid | left | right","page-break-before":"auto | always | avoid | left | right","page-break-inside":"auto | avoid","page-policy":1,pause:1,"pause-after":1,"pause-before":1,perspective:1,"perspective-origin":1,phonemes:1,pitch:1,"pitch-range":1,"play-during":1,"pointer-events":"auto | none | visiblePainted | visibleFill | visibleStroke | visible | painted | fill | stroke | all",position:"static | relative | absolute | fixed","presentation-level":1,"punctuation-trim":1,quotes:1,"rendering-intent":1,resize:1,rest:1,"rest-after":1,"rest-before":1,richness:1,right:"<margin-width>",rotation:1,"rotation-point":1,"ruby-align":1,"ruby-overhang":1,"ruby-position":1,"ruby-span":1,"shape-rendering":"auto | optimizeSpeed | crispEdges | geometricPrecision",size:1,speak:"normal | none | spell-out","speak-header":"once | always","speak-numeral":"digits | continuous","speak-punctuation":"code | none","speech-rate":1,src:1,"stop-color":1,"stop-opacity":"<opacity-value>",stress:1,"string-set":1,stroke:"<paint>","stroke-dasharray":"none | <dasharray>","stroke-dashoffset":"<percentage> | <length>","stroke-linecap":"butt | round | square","stroke-linejoin":"miter | round | bevel","stroke-miterlimit":"<miterlimit>","stroke-opacity":"<opacity-value>","stroke-width":"<percentage> | <length>","table-layout":"auto | fixed","tab-size":"<integer> | <length>",target:1,"target-name":1,"target-new":1,"target-position":1,"text-align":"left | right | center | justify | match-parent | start | end","text-align-last":1,"text-anchor":"start | middle | end","text-decoration":"<text-decoration-line> || <text-decoration-style> || <text-decoration-color>","text-decoration-color":"<text-decoration-color>","text-decoration-line":"<text-decoration-line>","text-decoration-style":"<text-decoration-style>","text-emphasis":1,"text-height":1,"text-indent":"<length> | <percentage>","text-justify":"auto | none | inter-word | inter-ideograph | inter-cluster | distribute | kashida","text-outline":1,"text-overflow":1,"text-rendering":"auto | optimizeSpeed | optimizeLegibility | geometricPrecision","text-shadow":1,"text-transform":"capitalize | uppercase | lowercase | none","text-wrap":"normal | none | avoid",top:"<margin-width>","-ms-touch-action":"auto | none | pan-x | pan-y | pan-left | pan-right | pan-up | pan-down | manipulation","touch-action":"auto | none | pan-x | pan-y | pan-left | pan-right | pan-up | pan-down | manipulation",transform:1,"transform-origin":1,"transform-style":1,transition:1,"transition-delay":1,"transition-duration":1,"transition-property":1,"transition-timing-function":1,"unicode-bidi":"normal | embed | isolate | bidi-override | isolate-override | plaintext","user-modify":"read-only | read-write | write-only","user-select":"none | text | toggle | element | elements | all","vertical-align":"auto | use-script | baseline | sub | super | top | text-top | central | middle | bottom | text-bottom | <percentage> | <length>",visibility:"visible | hidden | collapse","voice-balance":1,"voice-duration":1,"voice-family":1,"voice-pitch":1,"voice-pitch-range":1,"voice-rate":1,"voice-stress":1,"voice-volume":1,volume:1,"white-space":"normal | pre | nowrap | pre-wrap | pre-line | -pre-wrap | -o-pre-wrap | -moz-pre-wrap | -hp-pre-wrap","white-space-collapse":1,widows:"<integer>",width:"<length> | <percentage> | <content-sizing> | auto","will-change":"<will-change>","word-break":"normal | keep-all | break-all","word-spacing":"<length> | normal","word-wrap":"normal | break-word","writing-mode":"horizontal-tb | vertical-rl | vertical-lr | lr-tb | rl-tb | tb-rl | bt-rl | tb-lr | bt-lr | lr-bt | rl-bt | lr | rl | tb","z-index":"<integer> | auto",zoom:"<number> | <percentage> | normal"}},{}],8:[function(n,o,m){o.exports=l;var r=n("../util/SyntaxUnit");var q=n("./Parser");function l(x,w,s,u){r.call(this,x,s,u,q.PROPERTY_NAME_TYPE);this.hack=w}l.prototype=new r();l.prototype.constructor=l;l.prototype.toString=function(){return(this.hack?this.hack:"")+this.text}},{"../util/SyntaxUnit":26,"./Parser":6}],9:[function(m,n,l){n.exports=o;var r=m("../util/SyntaxUnit");var q=m("./Parser");function o(w,s,u){r.call(this,w.join(" "),s,u,q.PROPERTY_VALUE_TYPE);this.parts=w}o.prototype=new r();o.prototype.constructor=o},{"../util/SyntaxUnit":26,"./Parser":6}],10:[function(n,o,m){o.exports=l;function l(q){this._i=0;this._parts=q.parts;this._marks=[];this.value=q}l.prototype.count=function(){return this._parts.length};l.prototype.isFirst=function(){return this._i===0};l.prototype.hasNext=function(){return this._i<this._parts.length};l.prototype.mark=function(){this._marks.push(this._i)};l.prototype.peek=function(q){return this.hasNext()?this._parts[this._i+(q||0)]:null};l.prototype.next=function(){return this.hasNext()?this._parts[this._i++]:null};l.prototype.previous=function(){return this._i>0?this._parts[--this._i]:null};l.prototype.restore=function(){if(this._marks.length){this._i=this._marks.pop()}};l.prototype.drop=function(){this._marks.pop()}},{}],11:[function(n,o,l){o.exports=m;var u=n("../util/SyntaxUnit");var s=n("./Colors");var r=n("./Parser");var q=n("./Tokens");function m(D,w,A,B){var C=B||{};u.call(this,D,w,A,r.PROPERTY_VALUE_PART_TYPE);this.type="unknown";var x;if(/^([+\-]?[\d\.]+)([a-z]+)$/i.test(D)){this.type="dimension";this.value=+RegExp.$1;this.units=RegExp.$2;switch(this.units.toLowerCase()){case"em":case"rem":case"ex":case"px":case"cm":case"mm":case"in":case"pt":case"pc":case"ch":case"vh":case"vw":case"vmax":case"vmin":this.type="length";break;case"fr":this.type="grid";break;case"deg":case"rad":case"grad":case"turn":this.type="angle";break;case"ms":case"s":this.type="time";break;case"hz":case"khz":this.type="frequency";break;case"dpi":case"dpcm":this.type="resolution";break}}else{if(/^([+\-]?[\d\.]+)%$/i.test(D)){this.type="percentage";this.value=+RegExp.$1}else{if(/^([+\-]?\d+)$/i.test(D)){this.type="integer";this.value=+RegExp.$1}else{if(/^([+\-]?[\d\.]+)$/i.test(D)){this.type="number";this.value=+RegExp.$1}else{if(/^#([a-f0-9]{3,6})/i.test(D)){this.type="color";x=RegExp.$1;if(x.length===3){this.red=parseInt(x.charAt(0)+x.charAt(0),16);this.green=parseInt(x.charAt(1)+x.charAt(1),16);this.blue=parseInt(x.charAt(2)+x.charAt(2),16)}else{this.red=parseInt(x.substring(0,2),16);this.green=parseInt(x.substring(2,4),16);this.blue=parseInt(x.substring(4,6),16)}}else{if(/^rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/i.test(D)){this.type="color";this.red=+RegExp.$1;this.green=+RegExp.$2;this.blue=+RegExp.$3}else{if(/^rgb\(\s*(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*\)/i.test(D)){this.type="color";this.red=+RegExp.$1*255/100;this.green=+RegExp.$2*255/100;this.blue=+RegExp.$3*255/100}else{if(/^rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d\.]+)\s*\)/i.test(D)){this.type="color";this.red=+RegExp.$1;this.green=+RegExp.$2;this.blue=+RegExp.$3;this.alpha=+RegExp.$4}else{if(/^rgba\(\s*(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*,\s*([\d\.]+)\s*\)/i.test(D)){this.type="color";this.red=+RegExp.$1*255/100;this.green=+RegExp.$2*255/100;this.blue=+RegExp.$3*255/100;this.alpha=+RegExp.$4}else{if(/^hsl\(\s*(\d+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*\)/i.test(D)){this.type="color";this.hue=+RegExp.$1;this.saturation=+RegExp.$2/100;this.lightness=+RegExp.$3/100}else{if(/^hsla\(\s*(\d+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*,\s*([\d\.]+)\s*\)/i.test(D)){this.type="color";this.hue=+RegExp.$1;this.saturation=+RegExp.$2/100;this.lightness=+RegExp.$3/100;this.alpha=+RegExp.$4}else{if(/^url\(("([^\\"]|\\.)*")\)/i.test(D)){this.type="uri";this.uri=m.parseString(RegExp.$1)}else{if(/^([^\(]+)\(/i.test(D)){this.type="function";this.name=RegExp.$1;this.value=D}else{if(/^"([^\n\r\f\\"]|\\\r\n|\\[^\r0-9a-f]|\\[0-9a-f]{1,6}(\r\n|[ \n\r\t\f])?)*"/i.test(D)){this.type="string";this.value=m.parseString(D)}else{if(/^'([^\n\r\f\\']|\\\r\n|\\[^\r0-9a-f]|\\[0-9a-f]{1,6}(\r\n|[ \n\r\t\f])?)*'/i.test(D)){this.type="string";this.value=m.parseString(D)}else{if(s[D.toLowerCase()]){this.type="color";x=s[D.toLowerCase()].substring(1);this.red=parseInt(x.substring(0,2),16);this.green=parseInt(x.substring(2,4),16);this.blue=parseInt(x.substring(4,6),16)}else{if(/^[,\/]$/.test(D)){this.type="operator";this.value=D}else{if(/^-?[a-z_\u00A0-\uFFFF][a-z0-9\-_\u00A0-\uFFFF]*$/i.test(D)){this.type="identifier";this.value=D}}}}}}}}}}}}}}}}}}this.wasIdent=Boolean(C.ident)}m.prototype=new u();m.prototype.constructor=m;m.parseString=function(x){x=x.slice(1,-1);var w=function(D,B){if(/^(\n|\r\n|\r|\f)$/.test(B)){return""}var A=/^[0-9a-f]{1,6}/i.exec(B);if(A){var C=parseInt(A[0],16);if(String.fromCodePoint){return String.fromCodePoint(C)}else{return String.fromCharCode(C)}}return B};return x.replace(/\\(\r\n|[^\r0-9a-f]|[0-9a-f]{1,6}(\r\n|[ \n\r\t\f])?)/ig,w)};m.serializeString=function(x){var w=function(A,C){if(C==='"'){return"\\"+C}var B=String.codePointAt?String.codePointAt(0):String.charCodeAt(0);return"\\"+B.toString(16)+" "};return'"'+x.replace(/["\r\n\f]/g,w)+'"'};m.fromToken=function(x){var w=new m(x.value,x.startLine,x.startCol,{ident:x.type===q.IDENT});return w}},{"../util/SyntaxUnit":26,"./Colors":1,"./Parser":6,"./Tokens":18}],12:[function(m,n,l){var o=n.exports={__proto__:null,":first-letter":1,":first-line":1,":before":1,":after":1};o.ELEMENT=1;o.CLASS=2;o.isElement=function(q){return q.indexOf("::")===0||o[q.toLowerCase()]===o.ELEMENT}},{}],13:[function(n,o,m){o.exports=l;var s=n("../util/SyntaxUnit");var r=n("./Parser");var q=n("./Specificity");function l(x,u,w){s.call(this,x.join(" "),u,w,r.SELECTOR_TYPE);this.parts=x;this.specificity=q.calculate(this)}l.prototype=new s();l.prototype.constructor=l},{"../util/SyntaxUnit":26,"./Parser":6,"./Specificity":16}],14:[function(n,o,m){o.exports=l;var r=n("../util/SyntaxUnit");var q=n("./Parser");function l(s,x,A,u,w){r.call(this,A,u,w,q.SELECTOR_PART_TYPE);this.elementName=s;this.modifiers=x}l.prototype=new r();l.prototype.constructor=l},{"../util/SyntaxUnit":26,"./Parser":6}],15:[function(m,n,l){n.exports=o;var r=m("../util/SyntaxUnit");var q=m("./Parser");function o(x,w,s,u){r.call(this,x,s,u,q.SELECTOR_SUB_PART_TYPE);this.type=w;this.args=[]}o.prototype=new r();o.prototype.constructor=o},{"../util/SyntaxUnit":26,"./Parser":6}],16:[function(n,o,m){o.exports=q;var r=n("./Pseudos");var l=n("./SelectorPart");function q(u,s,x,w){this.a=u;this.b=s;this.c=x;this.d=w}q.prototype={constructor:q,compare:function(u){var x=["a","b","c","d"],w,s;for(w=0,s=x.length;w<s;w++){if(this[x[w]]<u[x[w]]){return -1}else{if(this[x[w]]>u[x[w]]){return 1}}}return 0},valueOf:function(){return(this.a*1000)+(this.b*100)+(this.c*10)+this.d},toString:function(){return this.a+","+this.b+","+this.c+","+this.d}};q.calculate=function(w){var B,u,A,s=0,D=0,C=0;function x(J){var K,I,G,H,F=J.elementName?J.elementName.text:"",E;if(F&&F.charAt(F.length-1)!=="*"){C++}for(K=0,G=J.modifiers.length;K<G;K++){E=J.modifiers[K];switch(E.type){case"class":case"attribute":D++;break;case"id":s++;break;case"pseudo":if(r.isElement(E.text)){C++}else{D++}break;case"not":for(I=0,H=E.args.length;I<H;I++){x(E.args[I])}}}}for(B=0,u=w.parts.length;B<u;B++){A=w.parts[B];if(A instanceof l){x(A)}}return new q(0,s,D,C)}},{"./Pseudos":12,"./SelectorPart":14}],17:[function(s,n,H){n.exports=q;var E=s("../util/TokenStreamBase");var B=s("./PropertyValuePart");var u=s("./Tokens");var C=/^[0-9a-fA-F]$/,l=/^[\u00A0-\uFFFF]$/,o=/\n|\r\n|\r|\f/,F=/\u0009|\u000a|\u000c|\u000d|\u0020/;function D(J){return J!==null&&C.test(J)}function x(J){return J!==null&&/\d/.test(J)}function r(J){return J!==null&&F.test(J)}function G(J){return J!==null&&o.test(J)}function I(J){return J!==null&&/[a-z_\u00A0-\uFFFF\\]/i.test(J)}function A(J){return J!==null&&(I(J)||/[0-9\-\\]/.test(J))}function m(J){return J!==null&&(I(J)||/\-\\/.test(J))}function w(K,J){for(var L in J){if(Object.prototype.hasOwnProperty.call(J,L)){K[L]=J[L]}}return K}function q(J){E.call(this,J,u)}q.prototype=w(new E(),{_getToken:function(){var N,J=this._reader,K=null,M=J.getLine(),L=J.getCol();N=J.read();while(N){switch(N){case"/":if(J.peek()==="*"){K=this.commentToken(N,M,L)}else{K=this.charToken(N,M,L)}break;case"|":case"~":case"^":case"$":case"*":if(J.peek()==="="){K=this.comparisonToken(N,M,L)}else{K=this.charToken(N,M,L)}break;case'"':case"'":K=this.stringToken(N,M,L);break;case"#":if(A(J.peek())){K=this.hashToken(N,M,L)}else{K=this.charToken(N,M,L)}break;case".":if(x(J.peek())){K=this.numberToken(N,M,L)}else{K=this.charToken(N,M,L)}break;case"-":if(J.peek()==="-"){K=this.htmlCommentEndToken(N,M,L)}else{if(I(J.peek())){K=this.identOrFunctionToken(N,M,L)}else{K=this.charToken(N,M,L)}}break;case"!":K=this.importantToken(N,M,L);break;case"@":K=this.atRuleToken(N,M,L);break;case":":K=this.notToken(N,M,L);break;case"<":K=this.htmlCommentStartToken(N,M,L);break;case"\\":if(/[^\r\n\f]/.test(J.peek())){K=this.identOrFunctionToken(this.readEscape(N,true),M,L)}else{K=this.charToken(N,M,L)}break;case"U":case"u":if(J.peek()==="+"){K=this.unicodeRangeToken(N,M,L);break}default:if(x(N)){K=this.numberToken(N,M,L)}else{if(r(N)){K=this.whitespaceToken(N,M,L)}else{if(m(N)){K=this.identOrFunctionToken(N,M,L)}else{K=this.charToken(N,M,L)}}}}break}if(!K&&N===null){K=this.createToken(u.EOF,null,M,L)}return K},createToken:function(L,N,O,M,K){var J=this._reader;K=K||{};return{value:N,type:L,channel:K.channel,endChar:K.endChar,hide:K.hide||false,startLine:O,startCol:M,endLine:J.getLine(),endCol:J.getCol()}},atRuleToken:function(P,O,M){var N=P,J=this._reader,K=u.CHAR,L;J.mark();L=this.readName();N=P+L;K=u.type(N.toLowerCase());if(K===u.CHAR||K===u.UNKNOWN){if(N.length>1){K=u.UNKNOWN_SYM}else{K=u.CHAR;N=P;J.reset()}}return this.createToken(K,N,O,M)},charToken:function(N,M,L){var J=u.type(N);var K={};if(J===-1){J=u.CHAR}else{K.endChar=u[J].endChar}return this.createToken(J,N,M,L,K)},commentToken:function(L,K,J){var M=this.readComment(L);return this.createToken(u.COMMENT,M,K,J)},comparisonToken:function(O,N,M){var J=this._reader,L=O+J.read(),K=u.type(L)||u.CHAR;return this.createToken(K,L,N,M)},hashToken:function(M,L,K){var J=this.readName(M);return this.createToken(u.HASH,J,L,K)},htmlCommentStartToken:function(N,M,K){var J=this._reader,L=N;J.mark();L+=J.readCount(3);if(L==="<!--"){return this.createToken(u.CDO,L,M,K)}else{J.reset();return this.charToken(N,M,K)}},htmlCommentEndToken:function(N,M,K){var J=this._reader,L=N;J.mark();L+=J.readCount(2);if(L==="-->"){return this.createToken(u.CDC,L,M,K)}else{J.reset();return this.charToken(N,M,K)}},identOrFunctionToken:function(Q,P,O){var J=this._reader,N=this.readName(Q),L=u.IDENT,K=["url(","url-prefix(","domain("],M;if(J.peek()==="("){N+=J.read();if(K.indexOf(N.toLowerCase())>-1){J.mark();M=this.readURI(N);if(M===null){J.reset();L=u.FUNCTION}else{L=u.URI;N=M}}else{L=u.FUNCTION}}else{if(J.peek()===":"){if(N.toLowerCase()==="progid"){N+=J.readTo("(");L=u.IE_FUNCTION}}}return this.createToken(L,N,P,O)},importantToken:function(P,O,N){var J=this._reader,L=P,M=u.CHAR,K,Q;J.mark();Q=J.read();while(Q){if(Q==="/"){if(J.peek()!=="*"){break}else{K=this.readComment(Q);if(K===""){break}}}else{if(r(Q)){L+=Q+this.readWhitespace()}else{if(/i/i.test(Q)){K=J.readCount(8);if(/mportant/i.test(K)){L+=Q+K;M=u.IMPORTANT_SYM}break}else{break}}}Q=J.read()}if(M===u.CHAR){J.reset();return this.charToken(P,O,N)}else{return this.createToken(M,L,O,N)}},notToken:function(N,M,K){var J=this._reader,L=N;J.mark();L+=J.readCount(4);if(L.toLowerCase()===":not("){return this.createToken(u.NOT,L,M,K)}else{J.reset();return this.charToken(N,M,K)}},numberToken:function(P,O,N){var J=this._reader,M=this.readNumber(P),L,K=u.NUMBER,Q=J.peek();if(m(Q)){L=this.readName(J.read());M+=L;if(/^em$|^ex$|^px$|^gd$|^rem$|^vw$|^vh$|^vmax$|^vmin$|^ch$|^cm$|^mm$|^in$|^pt$|^pc$/i.test(L)){K=u.LENGTH}else{if(/^deg|^rad$|^grad$|^turn$/i.test(L)){K=u.ANGLE}else{if(/^ms$|^s$/i.test(L)){K=u.TIME}else{if(/^hz$|^khz$/i.test(L)){K=u.FREQ}else{if(/^dpi$|^dpcm$/i.test(L)){K=u.RESOLUTION}else{K=u.DIMENSION}}}}}}else{if(Q==="%"){M+=J.read();K=u.PERCENTAGE}}return this.createToken(K,M,O,N)},stringToken:function(M,R,J){var K=M,N=M,O=this._reader,P=u.STRING,Q=O.read(),L;while(Q){N+=Q;if(Q==="\\"){Q=O.read();if(Q===null){break}else{if(/[^\r\n\f0-9a-f]/i.test(Q)){N+=Q}else{for(L=0;D(Q)&&L<6;L++){N+=Q;Q=O.read()}if(Q==="\r"&&O.peek()==="\n"){N+=Q;Q=O.read()}if(r(Q)){N+=Q}else{continue}}}}else{if(Q===K){break}else{if(G(O.peek())){P=u.INVALID;break}}}Q=O.read()}if(Q===null){P=u.INVALID}return this.createToken(P,N,R,J)},unicodeRangeToken:function(P,O,N){var J=this._reader,M=P,K,L=u.CHAR;if(J.peek()==="+"){J.mark();M+=J.read();M+=this.readUnicodeRangePart(true);if(M.length===2){J.reset()}else{L=u.UNICODE_RANGE;if(M.indexOf("?")===-1){if(J.peek()==="-"){J.mark();K=J.read();K+=this.readUnicodeRangePart(false);if(K.length===1){J.reset()}else{M+=K}}}}}return this.createToken(L,M,O,N)},whitespaceToken:function(M,L,K){var J=M+this.readWhitespace();return this.createToken(u.S,J,L,K)},readUnicodeRangePart:function(L){var J=this._reader,K="",M=J.peek();while(D(M)&&K.length<6){J.read();K+=M;M=J.peek()}if(L){while(M==="?"&&K.length<6){J.read();K+=M;M=J.peek()}}return K},readWhitespace:function(){var J=this._reader,K="",L=J.peek();while(r(L)){J.read();K+=L;L=J.peek()}return K},readNumber:function(M){var J=this._reader,L=M,K=(M==="."),N=J.peek();while(N){if(x(N)){L+=J.read()}else{if(N==="."){if(K){break}else{K=true;L+=J.read()}}else{break}}N=J.peek()}return L},readString:function(){var J=this.stringToken(this._reader.read(),0,0);return J.type===u.INVALID?null:J.value},readURI:function(M){var J=this._reader,L=M,K="",N=J.peek();while(N&&r(N)){J.read();N=J.peek()}if(N==="'"||N==='"'){K=this.readString();if(K!==null){K=B.parseString(K)}}else{K=this.readUnquotedURL()}N=J.peek();while(N&&r(N)){J.read();N=J.peek()}if(K===null||N!==")"){L=null}else{L+=B.serializeString(K)+J.read()}return L},readUnquotedURL:function(L){var J=this._reader,K=L||"",M;for(M=J.peek();M;M=J.peek()){if(l.test(M)||/^[\-!#$%&*-\[\]-~]$/.test(M)){K+=M;J.read()}else{if(M==="\\"){if(/^[^\r\n\f]$/.test(J.peek(2))){K+=this.readEscape(J.read(),true)}else{break}}else{break}}}return K},readName:function(L){var J=this._reader,K=L||"",M;for(M=J.peek();M;M=J.peek()){if(M==="\\"){if(/^[^\r\n\f]$/.test(J.peek(2))){K+=this.readEscape(J.read(),true)}else{break}}else{if(A(M)){K+=J.read()}else{break}}}return K},readEscape:function(O,M){var J=this._reader,N=O||"",K=0,P=J.peek();if(D(P)){do{N+=J.read();P=J.peek()}while(P&&D(P)&&++K<6)}if(N.length===1){if(/^[^\r\n\f0-9a-f]$/.test(P)){J.read();if(M){return P}}else{throw new Error("Bad escape sequence.")}}else{if(P==="\r"){J.read();if(J.peek()==="\n"){P+=J.read()}}else{if(/^[ \t\n\f]$/.test(P)){J.read()}else{P=""}}}if(M){var L=parseInt(N.slice(O.length),16);return String.fromCodePoint?String.fromCodePoint(L):String.fromCharCode(L)}return N+P},readComment:function(K){var J=this._reader,M=K||"",L=J.read();if(L==="*"){while(L){M+=L;if(M.length>2&&L==="*"&&J.peek()==="/"){M+=J.read();break}L=J.read()}return M}else{return""}}})},{"../util/TokenStreamBase":27,"./PropertyValuePart":11,"./Tokens":18}],18:[function(m,n,l){var o=n.exports=[{name:"CDO"},{name:"CDC"},{name:"S",whitespace:true},{name:"COMMENT",comment:true,hide:true,channel:"comment"},{name:"INCLUDES",text:"~="},{name:"DASHMATCH",text:"|="},{name:"PREFIXMATCH",text:"^="},{name:"SUFFIXMATCH",text:"$="},{name:"SUBSTRINGMATCH",text:"*="},{name:"STRING"},{name:"IDENT"},{name:"HASH"},{name:"IMPORT_SYM",text:"@import"},{name:"PAGE_SYM",text:"@page"},{name:"MEDIA_SYM",text:"@media"},{name:"FONT_FACE_SYM",text:"@font-face"},{name:"CHARSET_SYM",text:"@charset"},{name:"NAMESPACE_SYM",text:"@namespace"},{name:"SUPPORTS_SYM",text:"@supports"},{name:"VIEWPORT_SYM",text:["@viewport","@-ms-viewport","@-o-viewport"]},{name:"DOCUMENT_SYM",text:["@document","@-moz-document"]},{name:"UNKNOWN_SYM"},{name:"KEYFRAMES_SYM",text:["@keyframes","@-webkit-keyframes","@-moz-keyframes","@-o-keyframes"]},{name:"IMPORTANT_SYM"},{name:"LENGTH"},{name:"ANGLE"},{name:"TIME"},{name:"FREQ"},{name:"DIMENSION"},{name:"PERCENTAGE"},{name:"NUMBER"},{name:"URI"},{name:"FUNCTION"},{name:"UNICODE_RANGE"},{name:"INVALID"},{name:"PLUS",text:"+"},{name:"GREATER",text:">"},{name:"COMMA",text:","},{name:"TILDE",text:"~"},{name:"NOT"},{name:"TOPLEFTCORNER_SYM",text:"@top-left-corner"},{name:"TOPLEFT_SYM",text:"@top-left"},{name:"TOPCENTER_SYM",text:"@top-center"},{name:"TOPRIGHT_SYM",text:"@top-right"},{name:"TOPRIGHTCORNER_SYM",text:"@top-right-corner"},{name:"BOTTOMLEFTCORNER_SYM",text:"@bottom-left-corner"},{name:"BOTTOMLEFT_SYM",text:"@bottom-left"},{name:"BOTTOMCENTER_SYM",text:"@bottom-center"},{name:"BOTTOMRIGHT_SYM",text:"@bottom-right"},{name:"BOTTOMRIGHTCORNER_SYM",text:"@bottom-right-corner"},{name:"LEFTTOP_SYM",text:"@left-top"},{name:"LEFTMIDDLE_SYM",text:"@left-middle"},{name:"LEFTBOTTOM_SYM",text:"@left-bottom"},{name:"RIGHTTOP_SYM",text:"@right-top"},{name:"RIGHTMIDDLE_SYM",text:"@right-middle"},{name:"RIGHTBOTTOM_SYM",text:"@right-bottom"},{name:"RESOLUTION",state:"media"},{name:"IE_FUNCTION"},{name:"CHAR"},{name:"PIPE",text:"|"},{name:"SLASH",text:"/"},{name:"MINUS",text:"-"},{name:"STAR",text:"*"},{name:"LBRACE",endChar:"}",text:"{"},{name:"RBRACE",text:"}"},{name:"LBRACKET",endChar:"]",text:"["},{name:"RBRACKET",text:"]"},{name:"EQUALS",text:"="},{name:"COLON",text:":"},{name:"SEMICOLON",text:";"},{name:"LPAREN",endChar:")",text:"("},{name:"RPAREN",text:")"},{name:"DOT",text:"."}];(function(){var u=[],w=Object.create(null);o.UNKNOWN=-1;o.unshift({name:"EOF"});for(var s=0,q=o.length;s<q;s++){u.push(o[s].name);o[o[s].name]=s;if(o[s].text){if(o[s].text instanceof Array){for(var r=0;r<o[s].text.length;r++){w[o[s].text[r]]=s}}else{w[o[s].text]=s}}}o.name=function(x){return u[x]};o.type=function(x){return w[x]||-1}})()},{}],19:[function(q,m,r){var n=q("./Matcher");var s=q("./Properties");var u=q("./ValidationTypes");var w=q("./ValidationError");var o=q("./PropertyValueIterator");var l=m.exports={validate:function(D,C){var B=D.toString().toLowerCase(),E=new o(C),x=s[B],A;if(!x){if(B.indexOf("-")!==0){throw new w("Unknown property '"+D+"'.",D.line,D.col)}}else{if(typeof x!=="number"){if(u.isAny(E,"inherit | initial | unset")){if(E.hasNext()){A=E.next();throw new w("Expected end of value but found '"+A+"'.",A.line,A.col)}return}this.singleProperty(x,E)}}},singleProperty:function(B,D){var x=false,C=D.value,A;x=n.parse(B).match(D);if(!x){if(D.hasNext()&&!D.isFirst()){A=D.peek();throw new w("Expected end of value but found '"+A+"'.",A.line,A.col)}else{throw new w("Expected ("+u.describe(B)+") but found '"+C+"'.",C.line,C.col)}}else{if(D.hasNext()){A=D.next();throw new w("Expected end of value but found '"+A+"'.",A.line,A.col)}}}}},{"./Matcher":3,"./Properties":7,"./PropertyValueIterator":10,"./ValidationError":20,"./ValidationTypes":21}],20:[function(n,o,l){o.exports=m;function m(s,q,r){this.col=r;this.line=q;this.message=s}m.prototype=new Error()},{}],21:[function(m,o,l){var n=o.exports;var q=m("./Matcher");function r(u,s){Object.keys(s).forEach(function(w){u[w]=s[w]})}r(n,{isLiteral:function(w,B){var C=w.text.toString().toLowerCase(),u=B.split(" | "),x,s,A=false;for(x=0,s=u.length;x<s&&!A;x++){if(u[x].charAt(0)==="<"){A=this.simple[u[x]](w)}else{if(u[x].slice(-2)==="()"){A=(w.type==="function"&&w.name===u[x].slice(0,-2))}else{if(C===u[x].toLowerCase()){A=true}}}}return A},isSimple:function(s){return Boolean(this.simple[s])},isComplex:function(s){return Boolean(this.complex[s])},describe:function(s){if(this.complex[s] instanceof q){return this.complex[s].toString(0)}return s},isAny:function(B,x){var u=x.split(" | "),w,s,A=false;for(w=0,s=u.length;w<s&&!A&&B.hasNext();w++){A=this.isType(B,u[w])}return A},isAnyOfGroup:function(B,x){var u=x.split(" || "),w,s,A=false;for(w=0,s=u.length;w<s&&!A;w++){A=this.isType(B,u[w])}return A?u[w-1]:false},isType:function(x,w){var u=x.peek(),s=false;if(w.charAt(0)!=="<"){s=this.isLiteral(u,w);if(s){x.next()}}else{if(this.simple[w]){s=this.simple[w](u);if(s){x.next()}}else{if(this.complex[w] instanceof q){s=this.complex[w].match(x)}else{s=this.complex[w](x)}}}return s},simple:{__proto__:null,"<absolute-size>":"xx-small | x-small | small | medium | large | x-large | xx-large","<animateable-feature>":"scroll-position | contents | <animateable-feature-name>","<animateable-feature-name>":function(s){return this["<ident>"](s)&&!/^(unset|initial|inherit|will-change|auto|scroll-position|contents)$/i.test(s)},"<angle>":function(s){return s.type==="angle"},"<attachment>":"scroll | fixed | local","<attr>":"attr()","<basic-shape>":"inset() | circle() | ellipse() | polygon()","<bg-image>":"<image> | <gradient> | none","<border-style>":"none | hidden | dotted | dashed | solid | double | groove | ridge | inset | outset","<border-width>":"<length> | thin | medium | thick","<box>":"padding-box | border-box | content-box","<clip-source>":"<uri>","<color>":function(s){return s.type==="color"||String(s)==="transparent"||String(s)==="currentColor"},"<color-svg>":function(s){return s.type==="color"},"<content>":"content()","<content-sizing>":"fill-available | -moz-available | -webkit-fill-available | max-content | -moz-max-content | -webkit-max-content | min-content | -moz-min-content | -webkit-min-content | fit-content | -moz-fit-content | -webkit-fit-content","<feature-tag-value>":function(s){return s.type==="function"&&/^[A-Z0-9]{4}$/i.test(s)},"<filter-function>":"blur() | brightness() | contrast() | custom() | drop-shadow() | grayscale() | hue-rotate() | invert() | opacity() | saturate() | sepia()","<flex-basis>":"<width>","<flex-direction>":"row | row-reverse | column | column-reverse","<flex-grow>":"<number>","<flex-shrink>":"<number>","<flex-wrap>":"nowrap | wrap | wrap-reverse","<font-size>":"<absolute-size> | <relative-size> | <length> | <percentage>","<font-stretch>":"normal | ultra-condensed | extra-condensed | condensed | semi-condensed | semi-expanded | expanded | extra-expanded | ultra-expanded","<font-style>":"normal | italic | oblique","<font-variant-caps>":"small-caps | all-small-caps | petite-caps | all-petite-caps | unicase | titling-caps","<font-variant-css21>":"normal | small-caps","<font-weight>":"normal | bold | bolder | lighter | 100 | 200 | 300 | 400 | 500 | 600 | 700 | 800 | 900","<generic-family>":"serif | sans-serif | cursive | fantasy | monospace","<geometry-box>":"<shape-box> | fill-box | stroke-box | view-box","<glyph-angle>":function(s){return s.type==="angle"&&s.units==="deg"},"<gradient>":function(s){return s.type==="function"&&/^(?:\-(?:ms|moz|o|webkit)\-)?(?:repeating\-)?(?:radial\-|linear\-)?gradient/i.test(s)},"<icccolor>":"cielab() | cielch() | cielchab() | icc-color() | icc-named-color()","<ident>":function(s){return s.type==="identifier"||s.wasIdent},"<ident-not-generic-family>":function(s){return this["<ident>"](s)&&!this["<generic-family>"](s)},"<image>":"<uri>","<integer>":function(s){return s.type==="integer"},"<length>":function(s){if(s.type==="function"&&/^(?:\-(?:ms|moz|o|webkit)\-)?calc/i.test(s)){return true}else{return s.type==="length"||s.type==="number"||s.type==="integer"||String(s)==="0"}},"<line>":function(s){return s.type==="integer"},"<line-height>":"<number> | <length> | <percentage> | normal","<margin-width>":"<length> | <percentage> | auto","<miterlimit>":function(s){return this["<number>"](s)&&s.value>=1},"<nonnegative-length-or-percentage>":function(s){return(this["<length>"](s)||this["<percentage>"](s))&&(String(s)==="0"||s.type==="function"||(s.value)>=0)},"<nonnegative-number-or-percentage>":function(s){return(this["<number>"](s)||this["<percentage>"](s))&&(String(s)==="0"||s.type==="function"||(s.value)>=0)},"<number>":function(s){return s.type==="number"||this["<integer>"](s)},"<opacity-value>":function(s){return this["<number>"](s)&&s.value>=0&&s.value<=1},"<padding-width>":"<nonnegative-length-or-percentage>","<percentage>":function(s){return s.type==="percentage"||String(s)==="0"},"<relative-size>":"smaller | larger","<shape>":"rect() | inset-rect()","<shape-box>":"<box> | margin-box","<single-animation-direction>":"normal | reverse | alternate | alternate-reverse","<single-animation-name>":function(s){return this["<ident>"](s)&&/^-?[a-z_][-a-z0-9_]+$/i.test(s)&&!/^(none|unset|initial|inherit)$/i.test(s)},"<string>":function(s){return s.type==="string"},"<time>":function(s){return s.type==="time"},"<uri>":function(s){return s.type==="uri"},"<width>":"<margin-width>"},complex:{__proto__:null,"<azimuth>":"<angle> | [ [ left-side | far-left | left | center-left | center | center-right | right | far-right | right-side ] || behind ] | leftwards | rightwards","<bg-position>":"<position>#","<bg-size>":"[ <length> | <percentage> | auto ]{1,2} | cover | contain","<border-image-slice>":q.many([true],q.cast("<nonnegative-number-or-percentage>"),q.cast("<nonnegative-number-or-percentage>"),q.cast("<nonnegative-number-or-percentage>"),q.cast("<nonnegative-number-or-percentage>"),"fill"),"<border-radius>":"<nonnegative-length-or-percentage>{1,4} [ / <nonnegative-length-or-percentage>{1,4} ]?","<box-shadow>":"none | <shadow>#","<clip-path>":"<basic-shape> || <geometry-box>","<dasharray>":q.cast("<nonnegative-length-or-percentage>").braces(1,Infinity,"#",q.cast(",").question()),"<family-name>":"<string> | <ident-not-generic-family> <ident>*","<filter-function-list>":"[ <filter-function> | <uri> ]+","<flex>":"none | [ <flex-grow> <flex-shrink>? || <flex-basis> ]","<font-family>":"[ <generic-family> | <family-name> ]#","<font-shorthand>":"[ <font-style> || <font-variant-css21> || <font-weight> || <font-stretch> ]? <font-size> [ / <line-height> ]? <font-family>","<font-variant-alternates>":"stylistic() || historical-forms || styleset() || character-variant() || swash() || ornaments() || annotation()","<font-variant-ligatures>":"[ common-ligatures | no-common-ligatures ] || [ discretionary-ligatures | no-discretionary-ligatures ] || [ historical-ligatures | no-historical-ligatures ] || [ contextual | no-contextual ]","<font-variant-numeric>":"[ lining-nums | oldstyle-nums ] || [ proportional-nums | tabular-nums ] || [ diagonal-fractions | stacked-fractions ] || ordinal || slashed-zero","<font-variant-east-asian>":"[ jis78 | jis83 | jis90 | jis04 | simplified | traditional ] || [ full-width | proportional-width ] || ruby","<paint>":"<paint-basic> | <uri> <paint-basic>?","<paint-basic>":"none | currentColor | <color-svg> <icccolor>?","<position>":"[ center | [ left | right ] [ <percentage> | <length> ]? ] && [ center | [ top | bottom ] [ <percentage> | <length> ]? ] | [ left | center | right | <percentage> | <length> ] [ top | center | bottom | <percentage> | <length> ] | [ left | center | right | top | bottom | <percentage> | <length> ]","<repeat-style>":"repeat-x | repeat-y | [ repeat | space | round | no-repeat ]{1,2}","<shadow>":q.many([true],q.cast("<length>").braces(2,4),"inset","<color>"),"<text-decoration-color>":"<color>","<text-decoration-line>":"none | [ underline || overline || line-through || blink ]","<text-decoration-style>":"solid | double | dotted | dashed | wavy","<will-change>":"auto | <animateable-feature>#","<x-one-radius>":"[ <length> | <percentage> ]{1,2}"}});Object.keys(n.simple).forEach(function(s){var u=n.simple[s];if(typeof u==="string"){n.simple[s]=function(w){return n.isLiteral(w,u)}}});Object.keys(n.complex).forEach(function(s){var u=n.complex[s];if(typeof u==="string"){n.complex[s]=q.parse(u)}});n.complex["<font-variant>"]=q.oror({expand:"<font-variant-ligatures>"},{expand:"<font-variant-alternates>"},"<font-variant-caps>",{expand:"<font-variant-numeric>"},{expand:"<font-variant-east-asian>"})},{"./Matcher":3}],22:[function(m,n,l){n.exports={Colors:m("./Colors"),Combinator:m("./Combinator"),Parser:m("./Parser"),PropertyName:m("./PropertyName"),PropertyValue:m("./PropertyValue"),PropertyValuePart:m("./PropertyValuePart"),Matcher:m("./Matcher"),MediaFeature:m("./MediaFeature"),MediaQuery:m("./MediaQuery"),Selector:m("./Selector"),SelectorPart:m("./SelectorPart"),SelectorSubPart:m("./SelectorSubPart"),Specificity:m("./Specificity"),TokenStream:m("./TokenStream"),Tokens:m("./Tokens"),ValidationError:m("./ValidationError")}},{"./Colors":1,"./Combinator":2,"./Matcher":3,"./MediaFeature":4,"./MediaQuery":5,"./Parser":6,"./PropertyName":8,"./PropertyValue":9,"./PropertyValuePart":11,"./Selector":13,"./SelectorPart":14,"./SelectorSubPart":15,"./Specificity":16,"./TokenStream":17,"./Tokens":18,"./ValidationError":20}],23:[function(m,n,l){n.exports=o;function o(){this._listeners=Object.create(null)}o.prototype={constructor:o,addListener:function(q,r){if(!this._listeners[q]){this._listeners[q]=[]}this._listeners[q].push(r)},fire:function(u){if(typeof u==="string"){u={type:u}}if(typeof u.target!=="undefined"){u.target=this}if(typeof u.type==="undefined"){throw new Error("Event object missing 'type' property.")}if(this._listeners[u.type]){var s=this._listeners[u.type].concat();for(var r=0,q=s.length;r<q;r++){s[r].call(this,u)}}},removeListener:function(u,w){if(this._listeners[u]){var s=this._listeners[u];for(var r=0,q=s.length;r<q;r++){if(s[r]===w){s.splice(r,1);break}}}}}},{}],24:[function(m,n,l){n.exports=o;function o(q){this._input=q.replace(/(\r\n?|\n)/g,"\n");this._line=1;this._col=1;this._cursor=0}o.prototype={constructor:o,getCol:function(){return this._col},getLine:function(){return this._line},eof:function(){return this._cursor===this._input.length},peek:function(q){var r=null;q=typeof q==="undefined"?1:q;if(this._cursor<this._input.length){r=this._input.charAt(this._cursor+q-1)}return r},read:function(){var q=null;if(this._cursor<this._input.length){if(this._input.charAt(this._cursor)==="\n"){this._line++;this._col=1}else{this._col++}q=this._input.charAt(this._cursor++)}return q},mark:function(){this._bookmark={cursor:this._cursor,line:this._line,col:this._col}},reset:function(){if(this._bookmark){this._cursor=this._bookmark.cursor;this._line=this._bookmark.line;this._col=this._bookmark.col;delete this._bookmark}},readTo:function(r){var q="",s;while(q.length<r.length||q.lastIndexOf(r)!==q.length-r.length){s=this.read();if(s){q+=s}else{throw new Error('Expected "'+r+'" at line '+this._line+", col "+this._col+".")}}return q},readWhile:function(r){var q="",s=this.peek();while(s!==null&&r(s)){q+=this.read();s=this.peek()}return q},readMatch:function(s){var r=this._input.substring(this._cursor),q=null;if(typeof s==="string"){if(r.slice(0,s.length)===s){q=this.readCount(s.length)}}else{if(s instanceof RegExp){if(s.test(r)){q=this.readCount(RegExp.lastMatch.length)}}}return q},readCount:function(r){var q="";while(r--){q+=this.read()}return q}}},{}],25:[function(n,o,l){o.exports=m;function m(s,q,r){Error.call(this);this.name=this.constructor.name;this.col=r;this.line=q;this.message=s}m.prototype=Object.create(Error.prototype);m.prototype.constructor=m},{}],26:[function(m,n,l){n.exports=o;function o(u,q,r,s){this.col=r;this.line=q;this.text=u;this.type=s}o.fromToken=function(q){return new o(q.value,q.startLine,q.startCol)};o.prototype={constructor:o,valueOf:function(){return this.toString()},toString:function(){return this.text}}},{}],27:[function(n,o,l){o.exports=q;var r=n("./StringReader");var m=n("./SyntaxError");function q(s,u){this._reader=new r(s?s.toString():"");this._token=null;this._tokenData=u;this._lt=[];this._ltIndex=0;this._ltIndexCache=[]}q.createTokenData=function(w){var x=[],B=Object.create(null),A=w.concat([]),u=0,s=A.length+1;A.UNKNOWN=-1;A.unshift({name:"EOF"});for(;u<s;u++){x.push(A[u].name);A[A[u].name]=u;if(A[u].text){B[A[u].text]=u}}A.name=function(C){return x[C]};A.type=function(C){return B[C]};return A};q.prototype={constructor:q,match:function(u,A){if(!(u instanceof Array)){u=[u]}var x=this.get(A),w=0,s=u.length;while(w<s){if(x===u[w++]){return true}}this.unget();return false},mustMatch:function(s){var u;if(!(s instanceof Array)){s=[s]}if(!this.match.apply(this,arguments)){u=this.LT(1);throw new m("Expected "+this._tokenData[s[0]].name+" at line "+u.startLine+", col "+u.startCol+".",u.startLine,u.startCol)}},advance:function(s,u){while(this.LA(0)!==0&&!this.match(s,u)){this.get()}return this.LA(0)},get:function(x){var s=this._tokenData,w=0,u,A;if(this._lt.length&&this._ltIndex>=0&&this._ltIndex<this._lt.length){w++;this._token=this._lt[this._ltIndex++];A=s[this._token.type];while((A.channel!==undefined&&x!==A.channel)&&this._ltIndex<this._lt.length){this._token=this._lt[this._ltIndex++];A=s[this._token.type];w++}if((A.channel===undefined||x===A.channel)&&this._ltIndex<=this._lt.length){this._ltIndexCache.push(w);return this._token.type}}u=this._getToken();if(u.type>-1&&!s[u.type].hide){u.channel=s[u.type].channel;this._token=u;this._lt.push(u);this._ltIndexCache.push(this._lt.length-this._ltIndex+w);if(this._lt.length>5){this._lt.shift()}if(this._ltIndexCache.length>5){this._ltIndexCache.shift()}this._ltIndex=this._lt.length}A=s[u.type];if(A&&(A.hide||(A.channel!==undefined&&x!==A.channel))){return this.get(x)}else{return u.type}},LA:function(s){var w=s,u;if(s>0){if(s>5){throw new Error("Too much lookahead.")}while(w){u=this.get();w--}while(w<s){this.unget();w++}}else{if(s<0){if(this._lt[this._ltIndex+s]){u=this._lt[this._ltIndex+s].type}else{throw new Error("Too much lookbehind.")}}else{u=this._token.type}}return u},LT:function(s){this.LA(s);return this._lt[this._ltIndex+s-1]},peek:function(){return this.LA(1)},token:function(){return this._token},tokenName:function(s){if(s<0||s>this._tokenData.length){return"UNKNOWN_TOKEN"}else{return this._tokenData[s].name}},tokenType:function(s){return this._tokenData[s]||-1},unget:function(){if(this._ltIndexCache.length){this._ltIndex-=this._ltIndexCache.pop();this._token=this._lt[this._ltIndex-1]}else{throw new Error("Too much lookahead.")}}}},{"./StringReader":24,"./SyntaxError":25}],28:[function(m,n,l){n.exports={StringReader:m("./StringReader"),SyntaxError:m("./SyntaxError"),SyntaxUnit:m("./SyntaxUnit"),EventTarget:m("./EventTarget"),TokenStreamBase:m("./TokenStreamBase")}},{"./EventTarget":23,"./StringReader":24,"./SyntaxError":25,"./SyntaxUnit":26,"./TokenStreamBase":27}],parserlib:[function(m,n,l){n.exports={css:m("./css"),util:m("./util")}},{"./css":22,"./util":28}]},{},[]);return g("parserlib")})();var f=(function(){function l(B,A){return A!=null&&B instanceof A}var u;try{u=Map}catch(w){u=function(){}}var n;try{n=Set}catch(w){n=function(){}}var x;try{x=Promise}catch(w){x=function(){}}function q(G,I,B,F,E){if(typeof I==="object"){B=I.depth;F=I.prototype;E=I.includeNonEnumerable;I=I.circular}var D=[];var C=[];var A=typeof Buffer!="undefined";if(typeof I=="undefined"){I=true}if(typeof B=="undefined"){B=Infinity}function H(T,O){if(T===null){return null}if(O===0){return T}var L;var Q;if(typeof T!="object"){return T}if(l(T,u)){L=new u()}else{if(l(T,n)){L=new n()}else{if(l(T,x)){L=new x(function(W,V){T.then(function(X){W(H(X,O-1))},function(X){V(H(X,O-1))})})}else{if(q.__isArray(T)){L=[]}else{if(q.__isRegExp(T)){L=new RegExp(T.source,r(T));if(T.lastIndex){L.lastIndex=T.lastIndex}}else{if(q.__isDate(T)){L=new Date(T.getTime())}else{if(A&&Buffer.isBuffer(T)){L=new Buffer(T.length);T.copy(L);return L}else{if(l(T,Error)){L=Object.create(T)}else{if(typeof F=="undefined"){Q=Object.getPrototypeOf(T);L=Object.create(Q)}else{L=Object.create(F);Q=F}}}}}}}}}if(I){var S=D.indexOf(T);if(S!=-1){return C[S]}D.push(T);C.push(L)}if(l(T,u)){T.forEach(function(Y,W){var V=H(W,O-1);var X=H(Y,O-1);L.set(V,X)})}if(l(T,n)){T.forEach(function(V){var W=H(V,O-1);L.add(W)})}for(var P in T){var U;if(Q){U=Object.getOwnPropertyDescriptor(Q,P)}if(U&&U.set==null){continue}L[P]=H(T[P],O-1)}if(Object.getOwnPropertySymbols){var K=Object.getOwnPropertySymbols(T);for(var P=0;P<K.length;P++){var N=K[P];var J=Object.getOwnPropertyDescriptor(T,N);if(J&&!J.enumerable&&!E){continue}L[N]=H(T[N],O-1);if(!J.enumerable){Object.defineProperty(L,N,{enumerable:false})}}}if(E){var M=Object.getOwnPropertyNames(T);for(var P=0;P<M.length;P++){var R=M[P];var J=Object.getOwnPropertyDescriptor(T,R);if(J&&J.enumerable){continue}L[R]=H(T[R],O-1);Object.defineProperty(L,R,{enumerable:false})}}return L}return H(G,B)}q.clonePrototype=function g(A){if(A===null){return null}var B=function(){};B.prototype=A;return new B()};function m(A){return Object.prototype.toString.call(A)}q.__objToStr=m;function j(A){return typeof A==="object"&&m(A)==="[object Date]"}q.__isDate=j;function s(A){return typeof A==="object"&&m(A)==="[object Array]"}q.__isArray=s;function o(A){return typeof A==="object"&&m(A)==="[object RegExp]"}q.__isRegExp=o;function r(B){var A="";if(B.global){A+="g"}if(B.ignoreCase){A+="i"}if(B.multiline){A+="m"}return A}q.__getRegExpFlags=r;return q})();if(typeof c==="object"&&c.exports){c.exports=f}var d=(function(){var m=[],g=[],n=/\/\*\s*csslint([^\*]*)\*\//,j=new e.util.EventTarget();j.version="1.0.5";j.addRule=function(o){m.push(o);m[o.id]=o};j.clearRules=function(){m=[]};j.getRules=function(){return[].concat(m).sort(function(q,o){return q.id>o.id?1:0})};j.getRuleset=function(){var q={},r=0,o=m.length;while(r<o){q[m[r++].id]=1}return q};function l(s,o){var u,q=s&&s.match(n),r=q&&q[1];if(r){u={"true":2,"":1,"false":0,"2":2,"1":1,"0":0};r.toLowerCase().split(",").forEach(function(A){var B=A.split(":"),x=B[0]||"",w=B[1]||"";o[x.trim()]=u[w.trim()]})}return o}j.addFormatter=function(o){g[o.id]=o};j.getFormatter=function(o){return g[o]};j.format=function(u,q,w,r){var s=j.getFormatter(w),o=null;if(s){o=s.startFormat();o+=s.formatResults(u,q,r||{});o+=s.endFormat()}return o};j.hasFormat=function(o){return g.hasOwnProperty(o)};j.verify=function(D,B){var w=0,s,E,q={},A=[],u,o=new e.css.Parser({starHack:true,ieFilters:true,underscoreHack:true,strict:false});E=D.replace(/\n\r?/g,"$split$").split("$split$");d.Util.forEach(E,function(H,I){var J=H&&H.match(/\/\*[ \t]*csslint[ \t]+allow:[ \t]*([^\*]*)\*\//i),G=J&&J[1],F={};if(G){G.toLowerCase().split(",").forEach(function(K){F[K.trim()]=true});if(Object.keys(F).length>0){q[I+1]=F}}});var r=null,C=null;d.Util.forEach(E,function(F,G){if(r===null&&F.match(/\/\*[ \t]*csslint[ \t]+ignore:start[ \t]*\*\//i)){r=G}if(F.match(/\/\*[ \t]*csslint[ \t]+ignore:end[ \t]*\*\//i)){C=G}if(r!==null&&C!==null){A.push([r,C]);r=C=null}});if(r!==null){A.push([r,E.length])}if(!B){B=j.getRuleset()}if(n.test(D)){B=f(B);B=l(D,B)}s=new b(E,B,q,A);B.errors=2;for(w in B){if(B.hasOwnProperty(w)&&B[w]){if(m[w]){m[w].init(o,s)}}}try{o.parse(D)}catch(x){s.error("Fatal error, cannot continue: "+x.message,x.line,x.col,{})}u={messages:s.messages,stats:s.stats,ruleset:s.ruleset,allow:s.allow,ignore:s.ignore};u.messages.sort(function(G,F){if(G.rollup&&!F.rollup){return 1}else{if(!G.rollup&&F.rollup){return -1}else{return G.line-F.line}}});return u};return j})();function b(j,g,l,m){this.messages=[];this.stats=[];this.lines=j;this.ruleset=g;this.allow=l;if(!this.allow){this.allow={}}this.ignore=m;if(!this.ignore){this.ignore=[]}}b.prototype={constructor:b,error:function(l,g,j,m){this.messages.push({type:"error",line:g,col:j,message:l,evidence:this.lines[g-1],rule:m||{}})},warn:function(l,g,j,m){this.report(l,g,j,m)},report:function(l,g,j,m){if(this.allow.hasOwnProperty(g)&&this.allow[g].hasOwnProperty(m.id)){return}var n=false;d.Util.forEach(this.ignore,function(o){if(o[0]<=g&&g<=o[1]){n=true}});if(n){return}this.messages.push({type:this.ruleset[m.id]===2?"error":"warning",line:g,col:j,message:l,evidence:this.lines[g-1],rule:m})},info:function(l,g,j,m){this.messages.push({type:"info",line:g,col:j,message:l,evidence:this.lines[g-1],rule:m})},rollupError:function(g,j){this.messages.push({type:"error",rollup:true,message:g,rule:j})},rollupWarn:function(g,j){this.messages.push({type:"warning",rollup:true,message:g,rule:j})},stat:function(g,j){this.stats[g]=j}};d._Reporter=b;d.Util={mix:function(j,g){var l;for(l in g){if(g.hasOwnProperty(l)){j[l]=g[l]}}return l},indexOf:function(j,m){if(j.indexOf){return j.indexOf(m)}else{for(var l=0,g=j.length;l<g;l++){if(j[l]===m){return l}}return -1}},forEach:function(j,m){if(j.forEach){return j.forEach(m)}else{for(var l=0,g=j.length;l<g;l++){m(j[l],l,j)}}}};d.addRule({id:"adjoining-classes",name:"Disallow adjoining classes",desc:"Don't use adjoining classes.",url:"https://github.com/CSSLint/csslint/wiki/Disallow-adjoining-classes",browsers:"IE6",init:function(l,g){var j=this;l.addListener("startrule",function(m){var w=m.selectors,q,n,o,x,u,s,r;for(u=0;u<w.length;u++){q=w[u];for(s=0;s<q.parts.length;s++){n=q.parts[s];if(n.type===l.SELECTOR_PART_TYPE){x=0;for(r=0;r<n.modifiers.length;r++){o=n.modifiers[r];if(o.type==="class"){x++}if(x>1){g.report("Adjoining classes: "+w[u].text,n.line,n.col,j)}}}}}})}});d.addRule({id:"box-model",name:"Beware of broken box size",desc:"Don't use width or height when using padding or border.",url:"https://github.com/CSSLint/csslint/wiki/Beware-of-box-model-size",browsers:"All",init:function(g,l){var q=this,m={border:1,"border-left":1,"border-right":1,padding:1,"padding-left":1,"padding-right":1},r={border:1,"border-bottom":1,"border-top":1,padding:1,"padding-bottom":1,"padding-top":1},o,j=false;function n(){o={};j=false}function s(){var w,u;if(!j){if(o.height){for(w in r){if(r.hasOwnProperty(w)&&o[w]){u=o[w].value;if(!(w==="padding"&&u.parts.length===2&&u.parts[0].value===0)){l.report("Using height with "+w+" can sometimes make elements larger than you expect.",o[w].line,o[w].col,q)}}}}if(o.width){for(w in m){if(m.hasOwnProperty(w)&&o[w]){u=o[w].value;if(!(w==="padding"&&u.parts.length===2&&u.parts[1].value===0)){l.report("Using width with "+w+" can sometimes make elements larger than you expect.",o[w].line,o[w].col,q)}}}}}}g.addListener("startrule",n);g.addListener("startfontface",n);g.addListener("startpage",n);g.addListener("startpagemargin",n);g.addListener("startkeyframerule",n);g.addListener("startviewport",n);g.addListener("property",function(w){var u=w.property.text.toLowerCase();if(r[u]||m[u]){if(!/^0\S*$/.test(w.value)&&!(u==="border"&&w.value.toString()==="none")){o[u]={line:w.property.line,col:w.property.col,value:w.value}}}else{if(/^(width|height)/i.test(u)&&/^(length|percentage)/.test(w.value.parts[0].type)){o[u]=1}else{if(u==="box-sizing"){j=true}}}});g.addListener("endrule",s);g.addListener("endfontface",s);g.addListener("endpage",s);g.addListener("endpagemargin",s);g.addListener("endkeyframerule",s);g.addListener("endviewport",s)}});d.addRule({id:"box-sizing",name:"Disallow use of box-sizing",desc:"The box-sizing properties isn't supported in IE6 and IE7.",url:"https://github.com/CSSLint/csslint/wiki/Disallow-box-sizing",browsers:"IE6, IE7",tags:["Compatibility"],init:function(l,g){var j=this;l.addListener("property",function(n){var m=n.property.text.toLowerCase();if(m==="box-sizing"){g.report("The box-sizing property isn't supported in IE6 and IE7.",n.line,n.col,j)}})}});d.addRule({id:"bulletproof-font-face",name:"Use the bulletproof @font-face syntax",desc:"Use the bulletproof @font-face syntax to avoid 404's in old IE (http://www.fontspring.com/blog/the-new-bulletproof-font-face-syntax).",url:"https://github.com/CSSLint/csslint/wiki/Bulletproof-font-face",browsers:"All",init:function(r,j){var n=this,q=false,o=true,m=false,g,l;r.addListener("startfontface",function(){q=true});r.addListener("property",function(w){if(!q){return}var s=w.property.toString().toLowerCase(),x=w.value.toString();g=w.line;l=w.col;if(s==="src"){var u=/^\s?url\(['"].+\.eot\?.*['"]\)\s*format\(['"]embedded-opentype['"]\).*$/i;if(!x.match(u)&&o){m=true;o=false}else{if(x.match(u)&&!o){m=false}}}});r.addListener("endfontface",function(){q=false;if(m){j.report("@font-face declaration doesn't follow the fontspring bulletproof syntax.",g,l,n)}})}});d.addRule({id:"compatible-vendor-prefixes",name:"Require compatible vendor prefixes",desc:"Include all compatible vendor prefixes to reach a wider range of users.",url:"https://github.com/CSSLint/csslint/wiki/Require-compatible-vendor-prefixes",browsers:"All",init:function(g,o){var x=this,w,u,j,A,l,q,r,m=false,s=Array.prototype.push,n=[];w={animation:"webkit","animation-delay":"webkit","animation-direction":"webkit","animation-duration":"webkit","animation-fill-mode":"webkit","animation-iteration-count":"webkit","animation-name":"webkit","animation-play-state":"webkit","animation-timing-function":"webkit",appearance:"webkit moz","border-end":"webkit moz","border-end-color":"webkit moz","border-end-style":"webkit moz","border-end-width":"webkit moz","border-image":"webkit moz o","border-radius":"webkit","border-start":"webkit moz","border-start-color":"webkit moz","border-start-style":"webkit moz","border-start-width":"webkit moz","box-align":"webkit moz","box-direction":"webkit moz","box-flex":"webkit moz","box-lines":"webkit","box-ordinal-group":"webkit moz","box-orient":"webkit moz","box-pack":"webkit moz","box-sizing":"","box-shadow":"","column-count":"webkit moz ms","column-gap":"webkit moz ms","column-rule":"webkit moz ms","column-rule-color":"webkit moz ms","column-rule-style":"webkit moz ms","column-rule-width":"webkit moz ms","column-width":"webkit moz ms",flex:"webkit ms","flex-basis":"webkit","flex-direction":"webkit ms","flex-flow":"webkit","flex-grow":"webkit","flex-shrink":"webkit",hyphens:"epub moz","line-break":"webkit ms","margin-end":"webkit moz","margin-start":"webkit moz","marquee-speed":"webkit wap","marquee-style":"webkit wap","padding-end":"webkit moz","padding-start":"webkit moz","tab-size":"moz o","text-size-adjust":"webkit ms",transform:"webkit ms","transform-origin":"webkit ms",transition:"","transition-delay":"","transition-duration":"","transition-property":"","transition-timing-function":"","user-modify":"webkit moz","user-select":"webkit moz ms","word-break":"epub ms","writing-mode":"epub ms"};for(j in w){if(w.hasOwnProperty(j)){A=[];l=w[j].split(" ");for(q=0,r=l.length;q<r;q++){A.push("-"+l[q]+"-"+j)}w[j]=A;s.apply(n,A)}}g.addListener("startrule",function(){u=[]});g.addListener("startkeyframes",function(B){m=B.prefix||true});g.addListener("endkeyframes",function(){m=false});g.addListener("property",function(C){var B=C.property;if(d.Util.indexOf(n,B.text)>-1){if(!m||typeof m!=="string"||B.text.indexOf("-"+m+"-")!==0){u.push(B)}}});g.addListener("endrule",function(){if(!u.length){return}var B={},E,G,D,C,L,I,F,J,K,H;for(E=0,G=u.length;E<G;E++){D=u[E];for(C in w){if(w.hasOwnProperty(C)){L=w[C];if(d.Util.indexOf(L,D.text)>-1){if(!B[C]){B[C]={full:L.slice(0),actual:[],actualNodes:[]}}if(d.Util.indexOf(B[C].actual,D.text)===-1){B[C].actual.push(D.text);B[C].actualNodes.push(D)}}}}}for(C in B){if(B.hasOwnProperty(C)){I=B[C];F=I.full;J=I.actual;if(F.length>J.length){for(E=0,G=F.length;E<G;E++){K=F[E];if(d.Util.indexOf(J,K)===-1){H=(J.length===1)?J[0]:(J.length===2)?J.join(" and "):J.join(", ");o.report("The property "+K+" is compatible with "+H+" and should be included as well.",I.actualNodes[0].line,I.actualNodes[0].col,x)}}}}}})}});d.addRule({id:"display-property-grouping",name:"Require properties appropriate for display",desc:"Certain properties shouldn't be used with certain display property values.",url:"https://github.com/CSSLint/csslint/wiki/Require-properties-appropriate-for-display",browsers:"All",init:function(r,j){var q=this;var l={display:1,"float":"none",height:1,width:1,margin:1,"margin-left":1,"margin-right":1,"margin-bottom":1,"margin-top":1,padding:1,"padding-left":1,"padding-right":1,"padding-bottom":1,"padding-top":1,"vertical-align":1},n;function m(s,u,w){if(n[s]){if(typeof l[s]!=="string"||n[s].value.toLowerCase()!==l[s]){j.report(w||s+" can't be used with display: "+u+".",n[s].line,n[s].col,q)}}}function o(){n={}}function g(){var s=n.display?n.display.value:null;if(s){switch(s){case"inline":m("height",s);m("width",s);m("margin",s);m("margin-top",s);m("margin-bottom",s);m("float",s,"display:inline has no effect on floated elements (but may be used to fix the IE6 double-margin bug).");break;case"block":m("vertical-align",s);break;case"inline-block":m("float",s);break;default:if(s.indexOf("table-")===0){m("margin",s);m("margin-left",s);m("margin-right",s);m("margin-top",s);m("margin-bottom",s);m("float",s)}}}}r.addListener("startrule",o);r.addListener("startfontface",o);r.addListener("startkeyframerule",o);r.addListener("startpagemargin",o);r.addListener("startpage",o);r.addListener("startviewport",o);r.addListener("property",function(u){var s=u.property.text.toLowerCase();if(l[s]){n[s]={value:u.value.text,line:u.property.line,col:u.property.col}}});r.addListener("endrule",g);r.addListener("endfontface",g);r.addListener("endkeyframerule",g);r.addListener("endpagemargin",g);r.addListener("endpage",g);r.addListener("endviewport",g)}});d.addRule({id:"duplicate-background-images",name:"Disallow duplicate background images",desc:"Every background-image should be unique. Use a common class for e.g. sprites.",url:"https://github.com/CSSLint/csslint/wiki/Disallow-duplicate-background-images",browsers:"All",init:function(m,j){var l=this,g={};m.addListener("property",function(r){var o=r.property.text,s=r.value,q,n;if(o.match(/background/i)){for(q=0,n=s.parts.length;q<n;q++){if(s.parts[q].type==="uri"){if(typeof g[s.parts[q].uri]==="undefined"){g[s.parts[q].uri]=r}else{j.report("Background image '"+s.parts[q].uri+"' was used multiple times, first declared at line "+g[s.parts[q].uri].line+", col "+g[s.parts[q].uri].col+".",r.line,r.col,l)}}}}})}});d.addRule({id:"duplicate-properties",name:"Disallow duplicate properties",desc:"Duplicate properties must appear one after the other.",url:"https://github.com/CSSLint/csslint/wiki/Disallow-duplicate-properties",browsers:"All",init:function(o,g){var m=this,j,n;function l(){j={}}o.addListener("startrule",l);o.addListener("startfontface",l);o.addListener("startpage",l);o.addListener("startpagemargin",l);o.addListener("startkeyframerule",l);o.addListener("startviewport",l);o.addListener("property",function(r){var s=r.property,q=s.text.toLowerCase();if(j[q]&&(n!==q||j[q]===r.value.text)){g.report("Duplicate property '"+r.property+"' found.",r.line,r.col,m)}j[q]=r.value.text;n=q})}});d.addRule({id:"empty-rules",name:"Disallow empty rules",desc:"Rules without any properties specified should be removed.",url:"https://github.com/CSSLint/csslint/wiki/Disallow-empty-rules",browsers:"All",init:function(m,g){var l=this,j=0;m.addListener("startrule",function(){j=0});m.addListener("property",function(){j++});m.addListener("endrule",function(o){var n=o.selectors;if(j===0){g.report("Rule is empty.",n[0].line,n[0].col,l)}})}});d.addRule({id:"errors",name:"Parsing Errors",desc:"This rule looks for recoverable syntax errors.",browsers:"All",init:function(l,g){var j=this;l.addListener("error",function(m){g.error(m.message,m.line,m.col,j)})}});d.addRule({id:"fallback-colors",name:"Require fallback colors",desc:"For older browsers that don't support RGBA, HSL, or HSLA, provide a fallback color.",url:"https://github.com/CSSLint/csslint/wiki/Require-fallback-colors",browsers:"IE6,IE7,IE8",init:function(o,g){var m=this,n,j={color:1,background:1,"border-color":1,"border-top-color":1,"border-right-color":1,"border-bottom-color":1,"border-left-color":1,border:1,"border-top":1,"border-right":1,"border-bottom":1,"border-left":1,"background-color":1};function l(){n=null}o.addListener("startrule",l);o.addListener("startfontface",l);o.addListener("startpage",l);o.addListener("startpagemargin",l);o.addListener("startkeyframerule",l);o.addListener("startviewport",l);o.addListener("property",function(w){var x=w.property,s=x.text.toLowerCase(),A=w.value.parts,u=0,r="",q=A.length;if(j[s]){while(u<q){if(A[u].type==="color"){if("alpha" in A[u]||"hue" in A[u]){if(/([^\)]+)\(/.test(A[u])){r=RegExp.$1.toUpperCase()}if(!n||(n.property.text.toLowerCase()!==s||n.colorType!=="compat")){g.report("Fallback "+s+" (hex or RGB) should precede "+r+" "+s+".",w.line,w.col,m)}}else{w.colorType="compat"}}u++}}n=w})}});d.addRule({id:"floats",name:"Disallow too many floats",desc:"This rule tests if the float property is used too many times",url:"https://github.com/CSSLint/csslint/wiki/Disallow-too-many-floats",browsers:"All",init:function(m,g){var l=this;var j=0;m.addListener("property",function(n){if(n.property.text.toLowerCase()==="float"&&n.value.text.toLowerCase()!=="none"){j++}});m.addListener("endstylesheet",function(){g.stat("floats",j);if(j>=10){g.rollupWarn("Too many floats ("+j+"), you're probably using them for layout. Consider using a grid system instead.",l)}})}});d.addRule({id:"font-faces",name:"Don't use too many web fonts",desc:"Too many different web fonts in the same stylesheet.",url:"https://github.com/CSSLint/csslint/wiki/Don%27t-use-too-many-web-fonts",browsers:"All",init:function(m,g){var l=this,j=0;m.addListener("startfontface",function(){j++});m.addListener("endstylesheet",function(){if(j>5){g.rollupWarn("Too many @font-face declarations ("+j+").",l)}})}});d.addRule({id:"font-sizes",name:"Disallow too many font sizes",desc:"Checks the number of font-size declarations.",url:"https://github.com/CSSLint/csslint/wiki/Don%27t-use-too-many-font-size-declarations",browsers:"All",init:function(m,g){var l=this,j=0;m.addListener("property",function(n){if(n.property.toString()==="font-size"){j++}});m.addListener("endstylesheet",function(){g.stat("font-sizes",j);if(j>=10){g.rollupWarn("Too many font-size declarations ("+j+"), abstraction needed.",l)}})}});d.addRule({id:"gradients",name:"Require all gradient definitions",desc:"When using a vendor-prefixed gradient, make sure to use them all.",url:"https://github.com/CSSLint/csslint/wiki/Require-all-gradient-definitions",browsers:"All",init:function(m,j){var l=this,g;m.addListener("startrule",function(){g={moz:0,webkit:0,oldWebkit:0,o:0}});m.addListener("property",function(n){if(/\-(moz|o|webkit)(?:\-(?:linear|radial))\-gradient/i.test(n.value)){g[RegExp.$1]=1}else{if(/\-webkit\-gradient/i.test(n.value)){g.oldWebkit=1}}});m.addListener("endrule",function(o){var n=[];if(!g.moz){n.push("Firefox 3.6+")}if(!g.webkit){n.push("Webkit (Safari 5+, Chrome)")}if(!g.oldWebkit){n.push("Old Webkit (Safari 4+, Chrome)")}if(!g.o){n.push("Opera 11.1+")}if(n.length&&n.length<4){j.report("Missing vendor-prefixed CSS gradients for "+n.join(", ")+".",o.selectors[0].line,o.selectors[0].col,l)}})}});d.addRule({id:"ids",name:"Disallow IDs in selectors",desc:"Selectors should not contain IDs.",url:"https://github.com/CSSLint/csslint/wiki/Disallow-IDs-in-selectors",browsers:"All",init:function(l,g){var j=this;l.addListener("startrule",function(m){var w=m.selectors,q,n,o,x,u,s,r;for(u=0;u<w.length;u++){q=w[u];x=0;for(s=0;s<q.parts.length;s++){n=q.parts[s];if(n.type===l.SELECTOR_PART_TYPE){for(r=0;r<n.modifiers.length;r++){o=n.modifiers[r];if(o.type==="id"){x++}}}}if(x===1){g.report("Don't use IDs in selectors.",q.line,q.col,j)}else{if(x>1){g.report(x+" IDs in the selector, really?",q.line,q.col,j)}}}})}});d.addRule({id:"import-ie-limit",name:"@import limit on IE6-IE9",desc:"IE6-9 supports up to 31 @import per stylesheet",browsers:"IE6, IE7, IE8, IE9",init:function(o,g){var n=this,j=31,m=0;function l(){m=0}o.addListener("startpage",l);o.addListener("import",function(){m++});o.addListener("endstylesheet",function(){if(m>j){g.rollupError("Too many @import rules ("+m+"). IE6-9 supports up to 31 import per stylesheet.",n)}})}});d.addRule({id:"import",name:"Disallow @import",desc:"Don't use @import, use <link> instead.",url:"https://github.com/CSSLint/csslint/wiki/Disallow-%40import",browsers:"All",init:function(l,g){var j=this;l.addListener("import",function(m){g.report("@import prevents parallel downloads, use <link> instead.",m.line,m.col,j)})}});d.addRule({id:"important",name:"Disallow !important",desc:"Be careful when using !important declaration",url:"https://github.com/CSSLint/csslint/wiki/Disallow-%21important",browsers:"All",init:function(m,g){var l=this,j=0;m.addListener("property",function(n){if(n.important===true){j++;g.report("Use of !important",n.line,n.col,l)}});m.addListener("endstylesheet",function(){g.stat("important",j);if(j>=10){g.rollupWarn("Too many !important declarations ("+j+"), try to use less than 10 to avoid specificity issues.",l)}})}});d.addRule({id:"known-properties",name:"Require use of known properties",desc:"Properties should be known (listed in CSS3 specification) or be a vendor-prefixed property.",url:"https://github.com/CSSLint/csslint/wiki/Require-use-of-known-properties",browsers:"All",init:function(l,g){var j=this;l.addListener("property",function(m){if(m.invalid){g.report(m.invalid.message,m.line,m.col,j)}})}});d.addRule({id:"order-alphabetical",name:"Alphabetical order",desc:"Assure properties are in alphabetical order",browsers:"All",init:function(o,j){var n=this,l;var m=function(){l=[]};var g=function(r){var s=l.join(","),q=l.sort().join(",");if(s!==q){j.report("Rule doesn't have all its properties in alphabetical order.",r.line,r.col,n)}};o.addListener("startrule",m);o.addListener("startfontface",m);o.addListener("startpage",m);o.addListener("startpagemargin",m);o.addListener("startkeyframerule",m);o.addListener("startviewport",m);o.addListener("property",function(s){var r=s.property.text,q=r.toLowerCase().replace(/^-.*?-/,"");l.push(q)});o.addListener("endrule",g);o.addListener("endfontface",g);o.addListener("endpage",g);o.addListener("endpagemargin",g);o.addListener("endkeyframerule",g);o.addListener("endviewport",g)}});d.addRule({id:"outline-none",name:"Disallow outline: none",desc:"Use of outline: none or outline: 0 should be limited to :focus rules.",url:"https://github.com/CSSLint/csslint/wiki/Disallow-outline%3Anone",browsers:"All",tags:["Accessibility"],init:function(o,j){var n=this,m;function l(q){if(q.selectors){m={line:q.line,col:q.col,selectors:q.selectors,propCount:0,outline:false}}else{m=null}}function g(){if(m){if(m.outline){if(m.selectors.toString().toLowerCase().indexOf(":focus")===-1){j.report("Outlines should only be modified using :focus.",m.line,m.col,n)}else{if(m.propCount===1){j.report("Outlines shouldn't be hidden unless other visual changes are made.",m.line,m.col,n)}}}}}o.addListener("startrule",l);o.addListener("startfontface",l);o.addListener("startpage",l);o.addListener("startpagemargin",l);o.addListener("startkeyframerule",l);o.addListener("startviewport",l);o.addListener("property",function(r){var q=r.property.text.toLowerCase(),s=r.value;if(m){m.propCount++;if(q==="outline"&&(s.toString()==="none"||s.toString()==="0")){m.outline=true}}});o.addListener("endrule",g);o.addListener("endfontface",g);o.addListener("endpage",g);o.addListener("endpagemargin",g);o.addListener("endkeyframerule",g);o.addListener("endviewport",g)}});d.addRule({id:"overqualified-elements",name:"Disallow overqualified elements",desc:"Don't use classes or IDs with elements (a.foo or a#foo).",url:"https://github.com/CSSLint/csslint/wiki/Disallow-overqualified-elements",browsers:"All",init:function(m,g){var l=this,j={};m.addListener("startrule",function(x){var w=x.selectors,o,s,n,u,r,q;for(u=0;u<w.length;u++){o=w[u];for(r=0;r<o.parts.length;r++){s=o.parts[r];if(s.type===m.SELECTOR_PART_TYPE){for(q=0;q<s.modifiers.length;q++){n=s.modifiers[q];if(s.elementName&&n.type==="id"){g.report("Element ("+s+") is overqualified, just use "+n+" without element name.",s.line,s.col,l)}else{if(n.type==="class"){if(!j[n]){j[n]=[]}j[n].push({modifier:n,part:s})}}}}}}});m.addListener("endstylesheet",function(){var n;for(n in j){if(j.hasOwnProperty(n)){if(j[n].length===1&&j[n][0].part.elementName){g.report("Element ("+j[n][0].part+") is overqualified, just use "+j[n][0].modifier+" without element name.",j[n][0].part.line,j[n][0].part.col,l)}}}})}});d.addRule({id:"performant-transitions",name:"Allow only performant transisitons",desc:"Only allow transitions that trigger compositing for performant, 60fps transformations.",url:"",browsers:"All",init:function(n,g){var m=this;var j=["transition-property","transition","-webkit-transition","-o-transition"];var l=[/-webkit-transform/g,/-ms-transform/g,/transform/g,/opacity/g];n.addListener("property",function(w){var s=w.property.toString().toLowerCase(),q=w.value.toString(),o=w.line,u=w.col;var r=q.split(",");if(j.indexOf(s)!==-1){var x=r.filter(function(C){var B=[];for(var A=0;A<l.length;A++){if(C.match(l[A])){B.push(A)}}return B.length===0});if(x.length>0){g.report("Unexpected transition property '"+x.join(",").trim()+"'",o,u,m)}}})}});d.addRule({id:"qualified-headings",name:"Disallow qualified headings",desc:"Headings should not be qualified (namespaced).",url:"https://github.com/CSSLint/csslint/wiki/Disallow-qualified-headings",browsers:"All",init:function(l,g){var j=this;l.addListener("startrule",function(s){var r=s.selectors,m,o,q,n;for(q=0;q<r.length;q++){m=r[q];for(n=0;n<m.parts.length;n++){o=m.parts[n];if(o.type===l.SELECTOR_PART_TYPE){if(o.elementName&&/h[1-6]/.test(o.elementName.toString())&&n>0){g.report("Heading ("+o.elementName+") should not be qualified.",o.line,o.col,j)}}}}})}});d.addRule({id:"regex-selectors",name:"Disallow selectors that look like regexs",desc:"Selectors that look like regular expressions are slow and should be avoided.",url:"https://github.com/CSSLint/csslint/wiki/Disallow-selectors-that-look-like-regular-expressions",browsers:"All",init:function(l,g){var j=this;l.addListener("startrule",function(w){var u=w.selectors,n,r,m,s,q,o;for(s=0;s<u.length;s++){n=u[s];for(q=0;q<n.parts.length;q++){r=n.parts[q];if(r.type===l.SELECTOR_PART_TYPE){for(o=0;o<r.modifiers.length;o++){m=r.modifiers[o];if(m.type==="attribute"){if(/([~\|\^\$\*]=)/.test(m)){g.report("Attribute selectors with "+RegExp.$1+" are slow!",m.line,m.col,j)}}}}}}})}});d.addRule({id:"rules-count",name:"Rules Count",desc:"Track how many rules there are.",browsers:"All",init:function(l,g){var j=0;l.addListener("startrule",function(){j++});l.addListener("endstylesheet",function(){g.stat("rule-count",j)})}});d.addRule({id:"selector-max-approaching",name:"Warn when approaching the 4095 selector limit for IE",desc:"Will warn when selector count is >= 3800 selectors.",browsers:"IE",init:function(m,g){var l=this,j=0;m.addListener("startrule",function(n){j+=n.selectors.length});m.addListener("endstylesheet",function(){if(j>=3800){g.report("You have "+j+" selectors. Internet Explorer supports a maximum of 4095 selectors per stylesheet. Consider refactoring.",0,0,l)}})}});d.addRule({id:"selector-max",name:"Error when past the 4095 selector limit for IE",desc:"Will error when selector count is > 4095.",browsers:"IE",init:function(m,g){var l=this,j=0;m.addListener("startrule",function(n){j+=n.selectors.length});m.addListener("endstylesheet",function(){if(j>4095){g.report("You have "+j+" selectors. Internet Explorer supports a maximum of 4095 selectors per stylesheet. Consider refactoring.",0,0,l)}})}});d.addRule({id:"selector-newline",name:"Disallow new-line characters in selectors",desc:"New-line characters in selectors are usually a forgotten comma and not a descendant combinator.",browsers:"All",init:function(m,g){var l=this;function j(q){var B,C,x,r,w,A,s,u,D,F,o,E=q.selectors;for(B=0,C=E.length;B<C;B++){x=E[B];for(r=0,A=x.parts.length;r<A;r++){for(w=r+1;w<A;w++){s=x.parts[r];u=x.parts[w];D=s.type;F=s.line;o=u.line;if(D==="descendant"&&o>F){g.report("newline character found in selector (forgot a comma?)",F,E[B].parts[0].col,l)}}}}}m.addListener("startrule",j)}});d.addRule({id:"shorthand",name:"Require shorthand properties",desc:"Use shorthand properties where possible.",url:"https://github.com/CSSLint/csslint/wiki/Require-shorthand-properties",browsers:"All",init:function(j,m){var u=this,l,n,o,q={},s,g={margin:["margin-top","margin-bottom","margin-left","margin-right"],padding:["padding-top","padding-bottom","padding-left","padding-right"]};for(l in g){if(g.hasOwnProperty(l)){for(n=0,o=g[l].length;n<o;n++){q[g[l][n]]=l}}}function r(){s={}}function w(C){var D,A,x,B;for(D in g){if(g.hasOwnProperty(D)){B=0;for(A=0,x=g[D].length;A<x;A++){B+=s[g[D][A]]?1:0}if(B===g[D].length){m.report("The properties "+g[D].join(", ")+" can be replaced by "+D+".",C.line,C.col,u)}}}}j.addListener("startrule",r);j.addListener("startfontface",r);j.addListener("property",function(A){var x=A.property.toString().toLowerCase();if(q[x]){s[x]=1}});j.addListener("endrule",w);j.addListener("endfontface",w)}});d.addRule({id:"star-property-hack",name:"Disallow properties with a star prefix",desc:"Checks for the star property hack (targets IE6/7)",url:"https://github.com/CSSLint/csslint/wiki/Disallow-star-hack",browsers:"All",init:function(l,g){var j=this;l.addListener("property",function(m){var n=m.property;if(n.hack==="*"){g.report("Property with star prefix found.",m.property.line,m.property.col,j)}})}});d.addRule({id:"text-indent",name:"Disallow negative text-indent",desc:"Checks for text indent less than -99px",url:"https://github.com/CSSLint/csslint/wiki/Disallow-negative-text-indent",browsers:"All",init:function(q,j){var n=this,o,m;function l(){o=false;m="inherit"}function g(){if(o&&m!=="ltr"){j.report("Negative text-indent doesn't work well with RTL. If you use text-indent for image replacement explicitly set direction for that item to ltr.",o.line,o.col,n)}}q.addListener("startrule",l);q.addListener("startfontface",l);q.addListener("property",function(s){var r=s.property.toString().toLowerCase(),u=s.value;if(r==="text-indent"&&u.parts[0].value<-99){o=s.property}else{if(r==="direction"&&u.toString()==="ltr"){m="ltr"}}});q.addListener("endrule",g);q.addListener("endfontface",g)}});d.addRule({id:"underscore-property-hack",name:"Disallow properties with an underscore prefix",desc:"Checks for the underscore property hack (targets IE6)",url:"https://github.com/CSSLint/csslint/wiki/Disallow-underscore-hack",browsers:"All",init:function(l,g){var j=this;l.addListener("property",function(m){var n=m.property;if(n.hack==="_"){g.report("Property with underscore prefix found.",m.property.line,m.property.col,j)}})}});d.addRule({id:"unique-headings",name:"Headings should only be defined once",desc:"Headings should be defined only once.",url:"https://github.com/CSSLint/csslint/wiki/Headings-should-only-be-defined-once",browsers:"All",init:function(m,g){var j=this;var l={h1:0,h2:0,h3:0,h4:0,h5:0,h6:0};m.addListener("startrule",function(u){var s=u.selectors,n,q,w,r,o;for(r=0;r<s.length;r++){n=s[r];q=n.parts[n.parts.length-1];if(q.elementName&&/(h[1-6])/i.test(q.elementName.toString())){for(o=0;o<q.modifiers.length;o++){if(q.modifiers[o].type==="pseudo"){w=true;break}}if(!w){l[RegExp.$1]++;if(l[RegExp.$1]>1){g.report("Heading ("+q.elementName+") has already been defined.",q.line,q.col,j)}}}}});m.addListener("endstylesheet",function(){var o,n=[];for(o in l){if(l.hasOwnProperty(o)){if(l[o]>1){n.push(l[o]+" "+o+"s")}}}if(n.length){g.rollupWarn("You have "+n.join(", ")+" defined in this stylesheet.",j)}})}});d.addRule({id:"universal-selector",name:"Disallow universal selector",desc:"The universal selector (*) is known to be slow.",url:"https://github.com/CSSLint/csslint/wiki/Disallow-universal-selector",browsers:"All",init:function(l,g){var j=this;l.addListener("startrule",function(r){var q=r.selectors,m,n,o;for(o=0;o<q.length;o++){m=q[o];n=m.parts[m.parts.length-1];if(n.elementName==="*"){g.report(j.desc,n.line,n.col,j)}}})}});d.addRule({id:"unqualified-attributes",name:"Disallow unqualified attribute selectors",desc:"Unqualified attribute selectors are known to be slow.",url:"https://github.com/CSSLint/csslint/wiki/Disallow-unqualified-attribute-selectors",browsers:"All",init:function(l,g){var j=this;l.addListener("startrule",function(w){var u=w.selectors,r=false,n,q,m,s,o;for(s=0;s<u.length;s++){n=u[s];q=n.parts[n.parts.length-1];if(q.type===l.SELECTOR_PART_TYPE){for(o=0;o<q.modifiers.length;o++){m=q.modifiers[o];if(m.type==="class"||m.type==="id"){r=true;break}}if(!r){for(o=0;o<q.modifiers.length;o++){m=q.modifiers[o];if(m.type==="attribute"&&(!q.elementName||q.elementName==="*")){g.report(j.desc,q.line,q.col,j)}}}}}})}});d.addRule({id:"vendor-prefix",name:"Require standard property with vendor prefix",desc:"When using a vendor-prefixed property, make sure to include the standard one.",url:"https://github.com/CSSLint/csslint/wiki/Require-standard-property-with-vendor-prefix",browsers:"All",init:function(r,j){var q=this,n,m,l={"-webkit-border-radius":"border-radius","-webkit-border-top-left-radius":"border-top-left-radius","-webkit-border-top-right-radius":"border-top-right-radius","-webkit-border-bottom-left-radius":"border-bottom-left-radius","-webkit-border-bottom-right-radius":"border-bottom-right-radius","-o-border-radius":"border-radius","-o-border-top-left-radius":"border-top-left-radius","-o-border-top-right-radius":"border-top-right-radius","-o-border-bottom-left-radius":"border-bottom-left-radius","-o-border-bottom-right-radius":"border-bottom-right-radius","-moz-border-radius":"border-radius","-moz-border-radius-topleft":"border-top-left-radius","-moz-border-radius-topright":"border-top-right-radius","-moz-border-radius-bottomleft":"border-bottom-left-radius","-moz-border-radius-bottomright":"border-bottom-right-radius","-moz-column-count":"column-count","-webkit-column-count":"column-count","-moz-column-gap":"column-gap","-webkit-column-gap":"column-gap","-moz-column-rule":"column-rule","-webkit-column-rule":"column-rule","-moz-column-rule-style":"column-rule-style","-webkit-column-rule-style":"column-rule-style","-moz-column-rule-color":"column-rule-color","-webkit-column-rule-color":"column-rule-color","-moz-column-rule-width":"column-rule-width","-webkit-column-rule-width":"column-rule-width","-moz-column-width":"column-width","-webkit-column-width":"column-width","-webkit-column-span":"column-span","-webkit-columns":"columns","-moz-box-shadow":"box-shadow","-webkit-box-shadow":"box-shadow","-moz-transform":"transform","-webkit-transform":"transform","-o-transform":"transform","-ms-transform":"transform","-moz-transform-origin":"transform-origin","-webkit-transform-origin":"transform-origin","-o-transform-origin":"transform-origin","-ms-transform-origin":"transform-origin","-moz-box-sizing":"box-sizing","-webkit-box-sizing":"box-sizing"};function o(){n={};m=1}function g(){var B,w,s,x,A,u=[];for(B in n){if(l[B]){u.push({actual:B,needed:l[B]})}}for(w=0,s=u.length;w<s;w++){x=u[w].needed;A=u[w].actual;if(!n[x]){j.report("Missing standard property '"+x+"' to go along with '"+A+"'.",n[A][0].name.line,n[A][0].name.col,q)}else{if(n[x][0].pos<n[A][0].pos){j.report("Standard property '"+x+"' should come after vendor-prefixed property '"+A+"'.",n[A][0].name.line,n[A][0].name.col,q)}}}}r.addListener("startrule",o);r.addListener("startfontface",o);r.addListener("startpage",o);r.addListener("startpagemargin",o);r.addListener("startkeyframerule",o);r.addListener("startviewport",o);r.addListener("property",function(u){var s=u.property.text.toLowerCase();if(!n[s]){n[s]=[]}n[s].push({name:u.property,value:u.value,pos:m++})});r.addListener("endrule",g);r.addListener("endfontface",g);r.addListener("endpage",g);r.addListener("endpagemargin",g);r.addListener("endkeyframerule",g);r.addListener("endviewport",g)}});d.addRule({id:"zero-units",name:"Disallow units for 0 values",desc:"You don't need to specify units when a value is 0.",url:"https://github.com/CSSLint/csslint/wiki/Disallow-units-for-zero-values",browsers:"All",init:function(l,g){var j=this;l.addListener("property",function(o){var q=o.value.parts,n=0,m=q.length;while(n<m){if((q[n].units||q[n].type==="percentage")&&q[n].value===0&&q[n].type!=="time"){g.report("Values of 0 shouldn't have units specified.",q[n].line,q[n].col,j)}n++}})}});(function(){var g=function(j){if(!j||j.constructor!==String){return""}return j.replace(/["&><]/g,function(l){switch(l){case'"':return"&quot;";case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;"}})};d.addFormatter({id:"checkstyle-xml",name:"Checkstyle XML format",startFormat:function(){return'<?xml version="1.0" encoding="utf-8"?><checkstyle>'},endFormat:function(){return"</checkstyle>"},readError:function(j,l){return'<file name="'+g(j)+'"><error line="0" column="0" severty="error" message="'+g(l)+'"></error></file>'},formatResults:function(n,m){var o=n.messages,l=[];var j=function(q){if(!q||!("name" in q)){return""}return"net.csslint."+q.name.replace(/\s/g,"")};if(o.length>0){l.push('<file name="'+m+'">');d.Util.forEach(o,function(q){if(!q.rollup){l.push('<error line="'+q.line+'" column="'+q.col+'" severity="'+q.type+'" message="'+g(q.message)+'" source="'+j(q.rule)+'"/>')}});l.push("</file>")}return l.join("")}})}());d.addFormatter({id:"compact",name:"Compact, 'porcelain' format",startFormat:function(){return""},endFormat:function(){return""},formatResults:function(n,j,l){var o=n.messages,g="";l=l||{};var m=function(q){return q.charAt(0).toUpperCase()+q.slice(1)};if(o.length===0){return l.quiet?"":j+": Lint Free!"}d.Util.forEach(o,function(q){if(q.rollup){g+=j+": "+m(q.type)+" - "+q.message+" ("+q.rule.id+")\n"}else{g+=j+": line "+q.line+", col "+q.col+", "+m(q.type)+" - "+q.message+" ("+q.rule.id+")\n"}});return g}});d.addFormatter({id:"csslint-xml",name:"CSSLint XML format",startFormat:function(){return'<?xml version="1.0" encoding="utf-8"?><csslint>'},endFormat:function(){return"</csslint>"},formatResults:function(l,j){var m=l.messages,g=[];var n=function(o){if(!o||o.constructor!==String){return""}return o.replace(/"/g,"'").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};if(m.length>0){g.push('<file name="'+j+'">');d.Util.forEach(m,function(o){if(o.rollup){g.push('<issue severity="'+o.type+'" reason="'+n(o.message)+'" evidence="'+n(o.evidence)+'"/>')}else{g.push('<issue line="'+o.line+'" char="'+o.col+'" severity="'+o.type+'" reason="'+n(o.message)+'" evidence="'+n(o.evidence)+'"/>')}});g.push("</file>")}return g.join("")}});d.addFormatter({id:"json",name:"JSON",startFormat:function(){this.json=[];return""},endFormat:function(){var g="";if(this.json.length>0){if(this.json.length===1){g=JSON.stringify(this.json[0])}else{g=JSON.stringify(this.json)}}return g},formatResults:function(l,g,j){if(l.messages.length>0||!j.quiet){this.json.push({filename:g,messages:l.messages,stats:l.stats})}return""}});d.addFormatter({id:"junit-xml",name:"JUNIT XML format",startFormat:function(){return'<?xml version="1.0" encoding="utf-8"?><testsuites>'},endFormat:function(){return"</testsuites>"},formatResults:function(m,l){var o=m.messages,j=[],n={error:0,failure:0};var g=function(r){if(!r||!("name" in r)){return""}return"net.csslint."+r.name.replace(/\s/g,"")};var q=function(r){if(!r||r.constructor!==String){return""}return r.replace(/"/g,"'").replace(/</g,"&lt;").replace(/>/g,"&gt;")};if(o.length>0){o.forEach(function(s){var r=s.type==="warning"?"error":s.type;if(!s.rollup){j.push('<testcase time="0" name="'+g(s.rule)+'">');j.push("<"+r+' message="'+q(s.message)+'"><![CDATA['+s.line+":"+s.col+":"+q(s.evidence)+"]]></"+r+">");j.push("</testcase>");n[r]+=1}});j.unshift('<testsuite time="0" tests="'+o.length+'" skipped="0" errors="'+n.error+'" failures="'+n.failure+'" package="net.csslint" name="'+l+'">');j.push("</testsuite>")}return j.join("")}});d.addFormatter({id:"lint-xml",name:"Lint XML format",startFormat:function(){return'<?xml version="1.0" encoding="utf-8"?><lint>'},endFormat:function(){return"</lint>"},formatResults:function(l,j){var m=l.messages,g=[];var n=function(o){if(!o||o.constructor!==String){return""}return o.replace(/"/g,"'").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};if(m.length>0){g.push('<file name="'+j+'">');d.Util.forEach(m,function(o){if(o.rollup){g.push('<issue severity="'+o.type+'" reason="'+n(o.message)+'" evidence="'+n(o.evidence)+'"/>')}else{var q="";if(o.rule&&o.rule.id){q='rule="'+n(o.rule.id)+'" '}g.push("<issue "+q+'line="'+o.line+'" char="'+o.col+'" severity="'+o.type+'" reason="'+n(o.message)+'" evidence="'+n(o.evidence)+'"/>')}});g.push("</file>")}return g.join("")}});d.addFormatter({id:"text",name:"Plain Text",startFormat:function(){return""},endFormat:function(){return""},formatResults:function(m,j,l){var o=m.messages,g="";l=l||{};if(o.length===0){return l.quiet?"":"\n\ncsslint: No errors in "+j+"."}g="\n\ncsslint: There ";if(o.length===1){g+="is 1 problem"}else{g+="are "+o.length+" problems"}g+=" in "+j+".";var q=j.lastIndexOf("/"),n=j;if(q===-1){q=j.lastIndexOf("\\")}if(q>-1){n=j.substring(q+1)}d.Util.forEach(o,function(s,r){g=g+"\n\n"+n;if(s.rollup){g+="\n"+(r+1)+": "+s.type;g+="\n"+s.message}else{g+="\n"+(r+1)+": "+s.type+" at line "+s.line+", col "+s.col;g+="\n"+s.message;g+="\n"+s.evidence}});return g}});return d})();
/*
 * HTMLHint v0.9.12
 * https://github.com/yaniswang/HTMLHint
 *
 * (c) 2014-2015 Yanis Wang <yanis.wang@gmail.com>.
 * MIT Licensed
 */
var HTMLHint=function(d){function c(f,a){return Array(f+1).join(a||" ")}var b={};return b.version="0.9.12",b.release="20151013",b.rules={},b.defaultRuleset={"tagname-lowercase":!0,"attr-lowercase":!0,"attr-value-double-quotes":!0,"doctype-first":!0,"tag-pair":!0,"spec-char-escape":!0,"id-unique":!0,"src-not-empty":!0,"attr-no-duplication":!0,"title-require":!0},b.addRule=function(a){b.rules[a.id]=a},b.verify=function(f,q){f=f.replace(/^\s*<!--\s*htmlhint\s+([^\r\n]+?)\s*-->/i,function(n,l){return q===d&&(q={}),l.replace(/(?:^|,)\s*([^:,]+)\s*(?:\:\s*([^,\s]+))?/g,function(s,o,r){"false"===r?r=!1:"true"===r&&(r=!0),q[o]=r===d?!0:r}),""}),(q===d||0===Object.keys(q).length)&&(q=b.defaultRuleset);var e,j=new HTMLParser,g=new b.Reporter(f.split(/\r?\n/),q),m=b.rules;for(var a in q){e=m[a],e!==d&&q[a]!==!1&&e.init(j,g,q[a])}return j.parse(f),g.messages},b.format=function(l,f){f=f||{};var m=[],g={white:"",grey:"",red:"",reset:""};f.colors&&(g.white="[37m",g.grey="[90m",g.red="[31m",g.reset="[39m");var j=f.indent||0;return l.forEach(function(A){var D=40,F=D+20,n=A.evidence,q=A.line,E=A.col,B=n.length,C=E>D+1?E-D:1,x=n.length>E+F?E+F:B;D+1>E&&(x+=D-E+1),n=n.replace(/\t/g," ").substring(C-1,x),C>1&&(n="..."+n,C-=3),B>x&&(n+="..."),m.push(g.white+c(j)+"L"+q+" |"+g.grey+n+g.reset);var w=E-C,r=n.substring(0,w).match(/[^\u0000-\u00ff]/g);null!==r&&(w+=r.length),m.push(g.white+c(j)+c((q+"").length+3+w)+"^ "+g.red+A.message+" ("+A.rule.id+")"+g.reset)}),m},b}();"object"==typeof exports&&exports&&(exports.HTMLHint=HTMLHint),function(b){var a=function(){var c=this;c._init.apply(c,arguments)};a.prototype={_init:function(f,d){var c=this;c.lines=f,c.ruleset=d,c.messages=[]},error:function(g,f,c,j,d){this.report("error",g,f,c,j,d)},warn:function(g,f,c,j,d){this.report("warning",g,f,c,j,d)},info:function(g,f,c,j,d){this.report("info",g,f,c,j,d)},report:function(l,f,c,m,d,j){var g=this;g.messages.push({type:l,message:f,raw:j,evidence:g.lines[c-1],line:c,col:m,rule:{id:d.id,description:d.description,link:"https://github.com/yaniswang/HTMLHint/wiki/"+d.id}})}},b.Reporter=a}(HTMLHint);var HTMLParser=function(b){var a=function(){var c=this;c._init.apply(c,arguments)};return a.prototype={_init:function(){var c=this;c._listeners={},c._mapCdataTags=c.makeMap("script,style"),c._arrBlocks=[],c.lastEvent=null},makeMap:function(f){for(var d={},c=f.split(","),g=0;c.length>g;g++){d[c[g]]=!0}return d},parse:function(I){function ab(f,c,m,d){var l=m-E+1;d===b&&(d={}),d.raw=c,d.pos=m,d.line=aa,d.col=l,A.push(d),Z.fire(f,d);for(var g;g=R.exec(c);){aa++,E=m+R.lastIndex}}var Q,U,K,J,P,S,G,Y,Z=this,X=Z._mapCdataTags,W=/<(?:\/([^\s>]+)\s*|!--([\s\S]*?)--|!([^>]*?)|([\w\-:]+)((?:\s+[\w\-:]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s"'>]*))?)*?)\s*(\/?))>/g,V=/\s*([\w\-:]+)(?:\s*=\s*(?:(")([^"]*)"|(')([^']*)'|([^\s"'>]*)))?/g,R=/\r?\n/g,O=0,F=0,E=0,aa=1,A=Z._arrBlocks;for(Z.fire("start",{pos:0,line:1,col:1});Q=W.exec(I);){if(U=Q.index,U>O&&(Y=I.substring(O,U),P?G.push(Y):ab("text",Y,O)),O=W.lastIndex,!(K=Q[1])||(P&&K===P&&(Y=G.join(""),ab("cdata",Y,F,{tagName:P,attrs:S}),P=null,S=null,G=null),P)){if(P){G.push(Q[0])}else{if(K=Q[4]){J=[];for(var B,e=Q[5],D=0;B=V.exec(e);){var C=B[1],q=B[2]?B[2]:B[4]?B[4]:"",j=B[3]?B[3]:B[5]?B[5]:B[6]?B[6]:"";J.push({name:C,value:j,quote:q,index:B.index,raw:B[0]}),D+=B[0].length}D===e.length?(ab("tagstart",Q[0],U,{tagName:K,attrs:J,close:Q[6]}),X[K]&&(P=K,S=J.concat(),G=[],F=O)):ab("text",Q[0],U)}else{(Q[2]||Q[3])&&ab("comment",Q[0],U,{content:Q[2]||Q[3],"long":Q[2]?!0:!1})}}}else{ab("tagend",Q[0],U,{tagName:K})}}I.length>O&&(Y=I.substring(O,I.length),ab("text",Y,O)),Z.fire("end",{pos:O,line:aa,col:I.length-E+1})},addListener:function(e,c){for(var l,d=this._listeners,g=e.split(/[,\s]/),f=0,j=g.length;j>f;f++){l=g[f],d[l]===b&&(d[l]=[]),d[l].push(c)}},fire:function(q,j){j===b&&(j={}),j.type=q;var e=this,g=[],c=e._listeners[q],w=e._listeners.all;c!==b&&(g=g.concat(c)),w!==b&&(g=g.concat(w));var d=e.lastEvent;null!==d&&(delete d.lastEvent,j.lastEvent=d),e.lastEvent=j;for(var f=0,m=g.length;m>f;f++){g[f].call(e,j)}},removeListener:function(e,c){var g=this._listeners[e];if(g!==b){for(var d=0,f=g.length;f>d;d++){if(g[d]===c){g.splice(d,1);break}}}},fixPos:function(l,f){var c,m=l.raw.substr(0,f),d=m.split(/\r?\n/),j=d.length-1,g=l.line;return j>0?(g+=j,c=d[j].length+1):c=l.col+f,{line:g,col:c}},getMapAttrs:function(g){for(var f,c={},j=0,d=g.length;d>j;j++){f=g[j],c[f.name]=f.value}return c}},a}();"object"==typeof exports&&exports&&(exports.HTMLParser=HTMLParser),HTMLHint.addRule({id:"alt-require",description:"The alt attribute of an <img> element must be present and alt attribute of area[href] and input[type=image] must have a value.",init:function(d,c){var b=this;d.addListener("tagstart",function(j){var a,f=j.tagName.toLowerCase(),e=d.getMapAttrs(j.attrs),g=j.col+f.length+1;"img"!==f||"alt" in e?("area"===f&&"href" in e||"input"===f&&"image"===e.type)&&("alt" in e&&""!==e.alt||(a="area"===f?"area[href]":"input[type=image]",c.warn("The alt attribute of "+a+" must have a value.",j.line,g,b,j.raw))):c.warn("An alt attribute must be present on <img> elements.",j.line,g,b,j.raw)})}}),HTMLHint.addRule({id:"attr-lowercase",description:"All attribute names must be in lowercase.",init:function(d,c){var b=this;d.addListener("tagstart",function(m){for(var u,f=m.attrs,j=m.col+m.tagName.length+1,g=0,q=f.length;q>g;g++){u=f[g];var a=u.name;a!==a.toLowerCase()&&c.error("The attribute name of [ "+a+" ] must be in lowercase.",m.line,j+u.index,b,u.raw)}})}}),HTMLHint.addRule({id:"attr-no-duplication",description:"Elements cannot have duplicate attributes.",init:function(d,c){var b=this;d.addListener("tagstart",function(q){for(var x,g,m=q.attrs,j=q.col+q.tagName.length+1,w={},a=0,f=m.length;f>a;a++){x=m[a],g=x.name,w[g]===!0&&c.error("Duplicate of attribute name [ "+x.name+" ] was found.",q.line,j+x.index,b,x.raw),w[g]=!0}})}}),HTMLHint.addRule({id:"attr-unsafe-chars",description:"Attribute values cannot contain unsafe chars.",init:function(d,c){var b=this;d.addListener("tagstart",function(q){for(var g,m,a=q.attrs,A=q.col+q.tagName.length+1,f=/[\u0000-\u0008\u000b\u000c\u000e-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/,j=0,x=a.length;x>j;j++){if(g=a[j],m=g.value.match(f),null!==m){var w=escape(m[0]).replace(/%u/,"\\u").replace(/%/,"\\x");c.warn("The value of attribute [ "+g.name+" ] cannot contain an unsafe char [ "+w+" ].",q.line,A+g.index,b,g.raw)}}})}}),HTMLHint.addRule({id:"attr-value-double-quotes",description:"Attribute values must be in double quotes.",init:function(d,c){var b=this;d.addListener("tagstart",function(j){for(var m,a=j.attrs,g=j.col+j.tagName.length+1,f=0,l=a.length;l>f;f++){m=a[f],(""!==m.value&&'"'!==m.quote||""===m.value&&"'"===m.quote)&&c.error("The value of attribute [ "+m.name+" ] must be in double quotes.",j.line,g+m.index,b,m.raw)}})}}),HTMLHint.addRule({id:"attr-value-not-empty",description:"All attributes must have values.",init:function(d,c){var b=this;d.addListener("tagstart",function(j){for(var m,a=j.attrs,g=j.col+j.tagName.length+1,f=0,l=a.length;l>f;f++){m=a[f],""===m.quote&&""===m.value&&c.warn("The attribute [ "+m.name+" ] must have a value.",j.line,g+m.index,b,m.raw)}})}}),HTMLHint.addRule({id:"csslint",description:"Scan css with csslint.",init:function(d,c,b){var f=this;d.addListener("cdata",function(n){if("style"===n.tagName.toLowerCase()){var g;if(g="object"==typeof exports&&require?require("csslint").CSSLint.verify:CSSLint.verify,void 0!==b){var m=n.line-1,j=n.col-1;try{var q=g(n.raw,b).messages;q.forEach(function(o){var l=o.line;c["warning"===o.type?"warn":"error"]("["+o.rule.id+"] "+o.message,m+l,(1===l?j:0)+o.col,f,o.evidence)})}catch(a){}}}})}}),HTMLHint.addRule({id:"doctype-first",description:"Doctype must be declared first.",init:function(d,c){var b=this,f=function(a){"start"===a.type||"text"===a.type&&/^\s*$/.test(a.raw)||(("comment"!==a.type&&a["long"]===!1||/^DOCTYPE\s+/i.test(a.content)===!1)&&c.error("Doctype must be declared first.",a.line,a.col,b,a.raw),d.removeListener("all",f))};d.addListener("all",f)}}),HTMLHint.addRule({id:"doctype-html5",description:'Invalid doctype. Use: "<!DOCTYPE html>"',init:function(f,d){function b(a){a["long"]===!1&&"doctype html"!==a.content.toLowerCase()&&d.warn('Invalid doctype. Use: "<!DOCTYPE html>"',a.line,a.col,c,a.raw)}function g(){f.removeListener("comment",b),f.removeListener("tagstart",g)}var c=this;f.addListener("all",b),f.addListener("tagstart",g)}}),HTMLHint.addRule({id:"head-script-disabled",description:"The <script> tag cannot be used in a <head> tag.",init:function(j,d){function b(m){var r=j.getMapAttrs(m.attrs),q=r.type,e=m.tagName.toLowerCase();"head"===e&&(f=!0),f!==!0||"script"!==e||q&&g.test(q)!==!0||d.warn("The <script> tag cannot be used in a <head> tag.",m.line,m.col,c,m.raw)}function l(a){"head"===a.tagName.toLowerCase()&&(j.removeListener("tagstart",b),j.removeListener("tagend",l))}var c=this,g=/^(text\/javascript|application\/javascript)$/i,f=!1;j.addListener("tagstart",b),j.addListener("tagend",l)}}),HTMLHint.addRule({id:"href-abs-or-rel",description:"An href attribute must be either absolute or relative.",init:function(f,d,b){var g=this,c="abs"===b?"absolute":"relative";f.addListener("tagstart",function(u){for(var m,q=u.attrs,n=u.col+u.tagName.length+1,w=0,j=q.length;j>w;w++){if(m=q[w],"href"===m.name){("absolute"===c&&/^\w+?:/.test(m.value)===!1||"relative"===c&&/^https?:\/\//.test(m.value)===!0)&&d.warn("The value of the href attribute [ "+m.value+" ] must be "+c+".",u.line,n+m.index,g,m.raw);break}}})}}),HTMLHint.addRule({id:"id-class-ad-disabled",description:"The id and class attributes cannot use the ad keyword, it will be blocked by adblock software.",init:function(d,c){var b=this;d.addListener("tagstart",function(m){for(var u,f,j=m.attrs,g=m.col+m.tagName.length+1,q=0,a=j.length;a>q;q++){u=j[q],f=u.name,/^(id|class)$/i.test(f)&&/(^|[-\_])ad([-\_]|$)/i.test(u.value)&&c.warn("The value of attribute "+f+" cannot use the ad keyword.",m.line,g+u.index,b,u.raw)}})}}),HTMLHint.addRule({id:"id-class-value",description:"The id and class attribute values must meet the specified rules.",init:function(j,d,b){var m,c=this,g={underline:{regId:/^[a-z\d]+(_[a-z\d]+)*$/,message:"The id and class attribute values must be in lowercase and split by an underscore."},dash:{regId:/^[a-z\d]+(-[a-z\d]+)*$/,message:"The id and class attribute values must be in lowercase and split by a dash."},hump:{regId:/^[a-z][a-zA-Z\d]*([A-Z][a-zA-Z\d]*)*$/,message:"The id and class attribute values must meet the camelCase style."}};if(m="string"==typeof b?g[b]:b,m&&m.regId){var f=m.regId,l=m.message;j.addListener("tagstart",function(A){for(var D,q=A.attrs,o=A.col+A.tagName.length+1,s=0,E=q.length;E>s;s++){if(D=q[s],"id"===D.name.toLowerCase()&&f.test(D.value)===!1&&d.warn(l,A.line,o+D.index,c,D.raw),"class"===D.name.toLowerCase()){for(var B,C=D.value.split(/\s+/g),x=0,w=C.length;w>x;x++){B=C[x],B&&f.test(B)===!1&&d.warn(l,A.line,o+D.index,c,B)}}}})}}}),HTMLHint.addRule({id:"id-unique",description:"The value of id attributes must be unique.",init:function(d,c){var b=this,f={};d.addListener("tagstart",function(q){for(var j,n,m=q.attrs,w=q.col+q.tagName.length+1,a=0,g=m.length;g>a;a++){if(j=m[a],"id"===j.name.toLowerCase()){n=j.value,n&&(void 0===f[n]?f[n]=1:f[n]++,f[n]>1&&c.error("The id value [ "+n+" ] must be unique.",q.line,w+j.index,b,j.raw));break}}})}}),HTMLHint.addRule({id:"inline-script-disabled",description:"Inline script cannot be use.",init:function(d,c){var b=this;d.addListener("tagstart",function(q){for(var x,g,m=q.attrs,j=q.col+q.tagName.length+1,w=/^on(unload|message|submit|select|scroll|resize|mouseover|mouseout|mousemove|mouseleave|mouseenter|mousedown|load|keyup|keypress|keydown|focus|dblclick|click|change|blur|error)$/i,a=0,f=m.length;f>a;a++){x=m[a],g=x.name.toLowerCase(),w.test(g)===!0?c.warn("Inline script [ "+x.raw+" ] cannot be use.",q.line,j+x.index,b,x.raw):("src"===g||"href"===g)&&/^\s*javascript:/i.test(x.value)&&c.warn("Inline script [ "+x.raw+" ] cannot be use.",q.line,j+x.index,b,x.raw)}})}}),HTMLHint.addRule({id:"inline-style-disabled",description:"Inline style cannot be use.",init:function(d,c){var b=this;d.addListener("tagstart",function(j){for(var m,a=j.attrs,g=j.col+j.tagName.length+1,f=0,l=a.length;l>f;f++){m=a[f],"style"===m.name.toLowerCase()&&c.warn("Inline style [ "+m.raw+" ] cannot be use.",j.line,g+m.index,b,m.raw)}})}}),HTMLHint.addRule({id:"jshint",description:"Scan script with jshint.",init:function(d,c,b){var f=this;d.addListener("cdata",function(j){if("script"===j.tagName.toLowerCase()){var a=d.getMapAttrs(j.attrs),x=a.type;if(void 0!==a.src||x&&/^(text\/javascript)$/i.test(x)===!1){return}var e;if(e="object"==typeof exports&&require?require("jshint").JSHINT:JSHINT,void 0!==b){var g=j.line-1,w=j.col-1,n=j.raw.replace(/\t/g," ");try{var q=e(n,b);q===!1&&e.errors.forEach(function(o){var l=o.line;c.warn(o.reason,g+l,(1===l?w:0)+o.character,f,o.evidence)})}catch(m){}}}})}}),HTMLHint.addRule({id:"space-tab-mixed-disabled",description:"Do not mix tabs and spaces for indentation.",init:function(d,c,b){var f=this;d.addListener("text",function(e){for(var j,g=e.raw,m=/(^|\r?\n)([ \t]+)/g;j=m.exec(g);){var a=d.fixPos(e,j.index+j[1].length);"space"===b&&/^ +$/.test(j[2])===!1?c.warn("Please use space for indentation.",a.line,1,f,e.raw):"tab"===b&&/^\t+$/.test(j[2])===!1?c.warn("Please use tab for indentation.",a.line,1,f,e.raw):/ +\t|\t+ /.test(j[2])===!0&&c.warn("Do not mix tabs and spaces for indentation.",a.line,1,f,e.raw)}})}}),HTMLHint.addRule({id:"spec-char-escape",description:"Special characters must be escaped.",init:function(d,c){var b=this;d.addListener("text",function(j){for(var a,f=j.raw,e=/[<>]/g;a=e.exec(f);){var g=d.fixPos(j,a.index);c.error("Special characters must be escaped : [ "+a[0]+" ].",g.line,g.col,b,j.raw)}})}}),HTMLHint.addRule({id:"src-not-empty",description:"The src attribute of an img(script,link) must have a value.",init:function(d,c){var b=this;d.addListener("tagstart",function(m){for(var u,f=m.tagName,j=m.attrs,g=m.col+f.length+1,q=0,a=j.length;a>q;q++){u=j[q],(/^(img|script|embed|bgsound|iframe)$/.test(f)===!0&&"src"===u.name||"link"===f&&"href"===u.name||"object"===f&&"data"===u.name)&&""===u.value&&c.error("The attribute [ "+u.name+" ] of the tag [ "+f+" ] must have a value.",m.line,g+u.index,b,u.raw)}})}}),HTMLHint.addRule({id:"style-disabled",description:"<style> tags cannot be used.",init:function(d,c){var b=this;d.addListener("tagstart",function(a){"style"===a.tagName.toLowerCase()&&c.warn("The <style> tag cannot be used.",a.line,a.col,b,a.raw)})}}),HTMLHint.addRule({id:"tag-pair",description:"Tag must be paired.",init:function(f,d){var b=this,g=[],c=f.makeMap("area,base,basefont,br,col,embed,frame,hr,img,input,isindex,keygen,link,meta,param,source,track");f.addListener("tagstart",function(j){var a=j.tagName.toLowerCase();void 0!==c[a]||j.close||g.push({tagName:a,line:j.line,raw:j.raw})}),f.addListener("tagend",function(q){for(var j=q.tagName.toLowerCase(),n=g.length-1;n>=0&&g[n].tagName!==j;n--){}if(n>=0){for(var m=[],u=g.length-1;u>n;u--){m.push("</"+g[u].tagName+">")}if(m.length>0){var a=g[g.length-1];d.error("Tag must be paired, missing: [ "+m.join("")+" ], start tag match failed [ "+a.raw+" ] on line "+a.line+".",q.line,q.col,b,q.raw)}g.length=n}else{d.error("Tag must be paired, no start tag: [ "+q.raw+" ]",q.line,q.col,b,q.raw)}}),f.addListener("end",function(m){for(var a=[],l=g.length-1;l>=0;l--){a.push("</"+g[l].tagName+">")}if(a.length>0){var j=g[g.length-1];d.error("Tag must be paired, missing: [ "+a.join("")+" ], open tag match failed [ "+j.raw+" ] on line "+j.line+".",m.line,m.col,b,"")}})}}),HTMLHint.addRule({id:"tag-self-close",description:"Empty tags must be self closed.",init:function(d,c){var b=this,f=d.makeMap("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed");d.addListener("tagstart",function(g){var a=g.tagName.toLowerCase();void 0!==f[a]&&(g.close||c.warn("The empty tag : [ "+a+" ] must be self closed.",g.line,g.col,b,g.raw))})}}),HTMLHint.addRule({id:"tagname-lowercase",description:"All html element names must be in lowercase.",init:function(d,c){var b=this;d.addListener("tagstart,tagend",function(a){var f=a.tagName;f!==f.toLowerCase()&&c.error("The html element name of [ "+f+" ] must be in lowercase.",a.line,a.col,b,a.raw)})}}),HTMLHint.addRule({id:"title-require",description:"<title> must be present in <head> tag.",init:function(j,d){function b(m){var a=m.tagName.toLowerCase();"head"===a?g=!0:"title"===a&&g&&(f=!0)}function l(e){var m=e.tagName.toLowerCase();if(f&&"title"===m){var a=e.lastEvent;("text"!==a.type||"text"===a.type&&/^\s*$/.test(a.raw)===!0)&&d.error("<title></title> must not be empty.",e.line,e.col,c,e.raw)}else{"head"===m&&(f===!1&&d.error("<title> must be present in <head> tag.",e.line,e.col,c,e.raw),j.removeListener("tagstart",b),j.removeListener("tagend",l))}}var c=this,g=!1,f=!1;j.addListener("tagstart",b),j.addListener("tagend",l)}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(s){var b="CodeMirror-lint-markers";function f(E,D){var C=document.createElement("div");C.className="CodeMirror-lint-tooltip";C.appendChild(D.cloneNode(true));document.body.appendChild(C);function B(F){if(!C.parentNode){return s.off(document,"mousemove",B)}C.style.top=Math.max(0,F.clientY-C.offsetHeight-5)+"px";C.style.left=(F.clientX+5)+"px"}s.on(document,"mousemove",B);B(E);if(C.style.opacity!=null){C.style.opacity=1}return C}function m(B){if(B.parentNode){B.parentNode.removeChild(B)}}function l(B){if(!B.parentNode){return}if(B.style.opacity==null){m(B)}B.style.opacity=0;setTimeout(function(){m(B)},600)}function A(F,D,C){var E=f(F,D);function B(){s.off(C,"mouseout",B);if(E){l(E);E=null}}var G=setInterval(function(){if(E){for(var H=C;;H=H.parentNode){if(H&&H.nodeType==11){H=H.host}if(H==document.body){return}if(!H){B();break}}}if(!E){return clearInterval(G)}},400);s.on(C,"mouseout",B)}function q(B,D,C){this.marked=[];this.options=D;this.timeout=null;this.hasGutter=C;this.onMouseOver=function(E){r(B,E)};this.waitingFor=0}function a(C,B){if(B instanceof Function){return{getAnnotations:B}}if(!B||B===true){B={}}return B}function d(B){var D=B.state.lint;if(D.hasGutter){B.clearGutter(b)}for(var C=0;C<D.marked.length;++C){D.marked[C].clear()}D.marked.length=0}function x(G,E,B,F){var C=document.createElement("div"),D=C;C.className="CodeMirror-lint-marker-"+E;if(B){D=C.appendChild(document.createElement("div"));D.className="CodeMirror-lint-marker-multiple"}if(F!=false){s.on(D,"mouseover",function(H){A(H,G,D)})}return C}function g(C,B){if(C=="error"){return C}else{return B}}function j(F){var C=[];for(var D=0;D<F.length;++D){var E=F[D],B=E.from.line;(C[B]||(C[B]=[])).push(E)}return C}function c(D){var B=D.severity;if(!B){B="error"}var C=document.createElement("div");C.className="CodeMirror-lint-message-"+B;if(typeof D.messageHTML!="undefined"){C.innerHTML=D.messageHTML}else{C.appendChild(document.createTextNode(D.message))}return C}function n(B,G,C){var D=B.state.lint;var F=++D.waitingFor;function E(){F=-1;B.off("change",E)}B.on("change",E);G(B.getValue(),function(I,H){B.off("change",E);if(D.waitingFor!=F){return}if(H&&I instanceof s){I=H}B.operation(function(){o(B,I)})},C,B)}function w(B){var E=B.state.lint,D=E.options;var C=D.options||D;var G=D.getAnnotations||B.getHelper(s.Pos(0,0),"lint");if(!G){return}if(D.async||G.async){n(B,G,C)}else{var F=G(B.getValue(),C,B);if(!F){return}if(F.then){F.then(function(H){B.operation(function(){o(B,H)})})}else{B.operation(function(){o(B,F)})}}}function o(I,H){d(I);var C=I.state.lint,K=C.options;var G=j(H);for(var L=0;L<G.length;++L){var E=G[L];if(!E){continue}var M=null;var D=C.hasGutter&&document.createDocumentFragment();for(var F=0;F<E.length;++F){var B=E[F];var J=B.severity;if(!J){J="error"}M=g(M,J);if(K.formatAnnotation){B=K.formatAnnotation(B)}if(C.hasGutter){D.appendChild(c(B))}if(B.to){C.marked.push(I.markText(B.from,B.to,{className:"CodeMirror-lint-mark-"+J,__annotation:B}))}}if(C.hasGutter){I.setGutterMarker(L,b,x(D,M,E.length>1,C.options.tooltips))}}if(K.onUpdateLinting){K.onUpdateLinting(H,G,I)}}function u(B){var C=B.state.lint;if(!C){return}clearTimeout(C.timeout);C.timeout=setTimeout(function(){w(B)},C.options.delay||500)}function e(G,F){var E=F.target||F.srcElement;var D=document.createDocumentFragment();for(var B=0;B<G.length;B++){var C=G[B];D.appendChild(c(C))}A(F,D,E)}function r(K,F){var G=F.target||F.srcElement;if(!/\bCodeMirror-lint-mark-/.test(G.className)){return}var D=G.getBoundingClientRect(),J=(D.left+D.right)/2,I=(D.top+D.bottom)/2;var H=K.findMarksAt(K.coordsChar({left:J,top:I},"client"));var E=[];for(var C=0;C<H.length;++C){var B=H[C].__annotation;if(B){E.push(B)}}if(E.length){e(E,F)}}s.defineOption("lint",false,function(B,H,C){if(C&&C!=s.Init){d(B);if(B.state.lint.options.lintOnChange!==false){B.off("change",u)}s.off(B.getWrapperElement(),"mouseover",B.state.lint.onMouseOver);clearTimeout(B.state.lint.timeout);delete B.state.lint}if(H){var D=B.getOption("gutters"),F=false;for(var E=0;E<D.length;++E){if(D[E]==b){F=true}}var G=B.state.lint=new q(B,a(B,H),F);if(G.options.lintOnChange!==false){B.on("change",u)}if(G.options.tooltips!=false&&G.options.tooltips!="gutter"){s.on(B.getWrapperElement(),"mouseover",G.onMouseOver)}w(B)}});s.defineExtension("performLint",function(){if(this.state.lint){w(this)}})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){function b(f,e){if(!window.JSHINT){if(window.console){window.console.error("Error: window.JSHINT not defined, CodeMirror JavaScript linting cannot run.")}return[]}if(!e.indent){e.indent=1}JSHINT(f,e,e.globals);var g=JSHINT.data().errors,d=[];if(g){c(g,d)}return d}a.registerHelper("lint","javascript",b);function c(n,e){for(var j=0;j<n.length;j++){var g=n[j];if(g){if(g.line<=0){if(window.console){window.console.warn("Cannot display JSHint error (invalid line "+g.line+")",g)}continue}var m=g.character-1,d=m+1;if(g.evidence){var f=g.evidence.substring(m).search(/.\b/);if(f>-1){d+=f}}var l={message:g.reason,severity:g.code?(g.code.startsWith("W")?"warning":"error"):"error",from:a.Pos(g.line-1,m),to:a.Pos(g.line-1,d)};e.push(l)}}}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.registerHelper("lint","json",function(f){var b=[];if(!window.jsonlint){if(window.console){window.console.error("Error: window.jsonlint not defined, CodeMirror JSON linting cannot run.")}return b}var d=window.jsonlint.parser||window.jsonlint;d.parseError=function(j,e){var g=e.loc;b.push({from:a.Pos(g.first_line-1,g.first_column),to:a.Pos(g.last_line-1,g.last_column),message:j})};try{d.parse(f)}catch(c){}return b})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.registerHelper("lint","css",function(j,o){var m=[];if(!window.CSSLint){if(window.console){window.console.error("Error: window.CSSLint not defined, CodeMirror CSS linting cannot run.")}return m}var e=CSSLint.verify(j,o),d=e.messages,n=null;for(var f=0;f<d.length;f++){n=d[f];var l=n.line-1,c=n.line-1,b=n.col-1,g=n.col;m.push({from:a.Pos(l,b),to:a.Pos(c,g),message:n.message,severity:n.type})}return m})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"),require("htmlhint"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","htmlhint"],a)}else{a(CodeMirror,window.HTMLHint)}}})(function(a,c){var b={"tagname-lowercase":true,"attr-lowercase":true,"attr-value-double-quotes":true,"doctype-first":false,"tag-pair":true,"spec-char-escape":true,"id-unique":true,"src-not-empty":true,"attr-no-duplication":true};a.registerHelper("lint","html",function(l,q){var n=[];if(c&&!c.verify){c=c.HTMLHint}if(!c){c=window.HTMLHint}if(!c){if(window.console){window.console.error("Error: HTMLHint not found, not defined on window, or not available through define/require, CodeMirror HTML linting cannot run.")}return n}var f=c.verify(l,q&&q.rules||b);for(var g=0;g<f.length;g++){var o=f[g];var m=o.line-1,e=o.line-1,d=o.col-1,j=o.col;n.push({from:a.Pos(m,d),to:a.Pos(e,j),message:o.message,severity:o.type})}return n})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(b){function d(r,q,s,l){if(s&&s.call){var g=s;s=null}else{var g=c(r,s,"rangeFinder")}if(typeof q=="number"){q=b.Pos(q,0)}var j=c(r,s,"minFoldSize");function f(u){var w=g(r,q);if(!w||w.to.line-w.from.line<j){return null}var A=r.findMarksAt(w.from);for(var x=0;x<A.length;++x){if(A[x].__isFold&&l!=="fold"){if(!u){return null}w.cleared=true;A[x].clear()}}return w}var n=f(true);if(c(r,s,"scanUp")){while(!n&&q.line>r.firstLine()){q=b.Pos(q.line-1,0);n=f(false)}}if(!n||n.cleared||l==="unfold"){return}var o=e(r,s);b.on(o,"mousedown",function(u){m.clear();b.e_preventDefault(u)});var m=r.markText(n.from,n.to,{replacedWith:o,clearOnEnter:c(r,s,"clearOnEnter"),__isFold:true});m.on("clear",function(w,u){b.signal(r,"unfold",r,w,u)});b.signal(r,"fold",r,n.from,n.to)}function e(f,g){var j=c(f,g,"widget");if(typeof j=="string"){var l=document.createTextNode(j);j=document.createElement("span");j.appendChild(l);j.className="CodeMirror-foldmarker"}else{if(j){j=j.cloneNode(true)}}return j}b.newFoldFunction=function(g,f){return function(j,l){d(j,l,{rangeFinder:g,widget:f})}};b.defineExtension("foldCode",function(j,f,g){d(this,j,f,g)});b.defineExtension("isFolded",function(j){var g=this.findMarksAt(j);for(var f=0;f<g.length;++f){if(g[f].__isFold){return true}}});b.commands.toggleFold=function(f){f.foldCode(f.getCursor())};b.commands.fold=function(f){f.foldCode(f.getCursor(),null,"fold")};b.commands.unfold=function(f){f.foldCode(f.getCursor(),null,"unfold")};b.commands.foldAll=function(f){f.operation(function(){for(var g=f.firstLine(),j=f.lastLine();g<=j;g++){f.foldCode(b.Pos(g,0),null,"fold")}})};b.commands.unfoldAll=function(f){f.operation(function(){for(var g=f.firstLine(),j=f.lastLine();g<=j;g++){f.foldCode(b.Pos(g,0),null,"unfold")}})};b.registerHelper("fold","combine",function(){var f=Array.prototype.slice.call(arguments,0);return function(g,m){for(var j=0;j<f.length;++j){var l=f[j](g,m);if(l){return l}}}});b.registerHelper("fold","auto",function(f,m){var j=f.getHelpers(m,"fold");for(var g=0;g<j.length;g++){var l=j[g](f,m);if(l){return l}}});var a={rangeFinder:b.fold.auto,widget:"\u2194",minFoldSize:0,scanUp:false,clearOnEnter:true};b.defineOption("foldOptions",null);function c(f,j,g){if(j&&j[g]!==undefined){return j[g]}var l=f.options.foldOptions;if(l&&l[g]!==undefined){return l[g]}return a[g]}b.defineExtension("foldOption",function(g,f){return c(this,g,f)})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"),require("./foldcode"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","./foldcode"],a)}else{a(CodeMirror)}}})(function(d){d.defineOption("foldGutter",false,function(q,s,r){if(r&&r!=d.Init){q.clearGutter(q.state.foldGutter.options.gutter);q.state.foldGutter=null;q.off("gutterClick",n);q.off("change",g);q.off("viewportChange",o);q.off("fold",e);q.off("unfold",e);q.off("swapDoc",g)}if(s){q.state.foldGutter=new m(l(s));b(q);q.on("gutterClick",n);q.on("change",g);q.on("viewportChange",o);q.on("fold",e);q.on("unfold",e);q.on("swapDoc",g)}});var j=d.Pos;function m(q){this.options=q;this.from=this.to=0}function l(q){if(q===true){q={}}if(q.gutter==null){q.gutter="CodeMirror-foldgutter"}if(q.indicatorOpen==null){q.indicatorOpen="CodeMirror-foldgutter-open"}if(q.indicatorFolded==null){q.indicatorFolded="CodeMirror-foldgutter-folded"}return q}function c(q,r){var u=q.findMarks(j(r,0),j(r+1,0));for(var s=0;s<u.length;++s){if(u[s].__isFold&&u[s].find().from.line==r){return u[s]}}}function f(q){if(typeof q=="string"){var r=document.createElement("div");r.className=q+" CodeMirror-guttermarker-subtle";return r}else{return q.cloneNode(true)}}function a(q,A,x){var s=q.state.foldGutter.options,w=A;var u=q.foldOption(s,"minFoldSize");var r=q.foldOption(s,"rangeFinder");q.eachLine(A,x,function(B){var E=null;if(c(q,w)){E=f(s.indicatorFolded)}else{var D=j(w,0);var C=r&&r(q,D);if(C&&C.to.line-C.from.line>=u){E=f(s.indicatorOpen)}}q.setGutterMarker(B,s.gutter,E);++w})}function b(q){var r=q.getViewport(),s=q.state.foldGutter;if(!s){return}q.operation(function(){a(q,r.from,r.to)});s.from=r.from;s.to=r.to}function n(q,r,w){var u=q.state.foldGutter;if(!u){return}var s=u.options;if(w!=s.gutter){return}var x=c(q,r);if(x){x.clear()}else{q.foldCode(j(r,0),s.rangeFinder)}}function g(q){var s=q.state.foldGutter;if(!s){return}var r=s.options;s.from=s.to=0;clearTimeout(s.changeUpdate);s.changeUpdate=setTimeout(function(){b(q)},r.foldOnChangeTimeSpan||600)}function o(q){var s=q.state.foldGutter;if(!s){return}var r=s.options;clearTimeout(s.changeUpdate);s.changeUpdate=setTimeout(function(){var u=q.getViewport();if(s.from==s.to||u.from-s.to>20||s.from-u.to>20){b(q)}else{q.operation(function(){if(u.from<s.from){a(q,u.from,s.from);s.from=u.from}if(u.to>s.to){a(q,s.to,u.to);s.to=u.to}})}},r.updateViewportTimeSpan||400)}function e(q,u){var s=q.state.foldGutter;if(!s){return}var r=u.line;if(r>=s.from&&r<s.to){a(q,r,r+1)}}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.registerHelper("fold","brace",function(o,j){var r=j.line,g=o.getLine(r);var A;function d(C){for(var B=j.ch,D=0;;){var E=B<=0?-1:g.lastIndexOf(C,B-1);if(E==-1){if(D==1){break}D=1;B=g.length;continue}if(D==1&&E<j.ch){break}A=o.getTokenTypeAt(a.Pos(r,E+1));if(!/^(comment|string)/.test(A)){return E+1}B=E-1}}var l="{",e="}",q=d("{");if(q==null){l="[",e="]";q=d("[")}if(q==null){return}var n=1,c=o.lastLine(),f,u;outer:for(var x=r;x<=c;++x){var s=o.getLine(x),m=x==r?q:0;for(;;){var b=s.indexOf(l,m),w=s.indexOf(e,m);if(b<0){b=s.length}if(w<0){w=s.length}m=Math.min(b,w);if(m==s.length){break}if(o.getTokenTypeAt(a.Pos(x,m+1))==A){if(m==b){++n}else{if(!--n){f=x;u=m;break outer}}}++m}}if(f==null||r==f){return}return{from:a.Pos(r,q),to:a.Pos(f,u)}});a.registerHelper("fold","import",function(b,l){function j(n){if(n<b.firstLine()||n>b.lastLine()){return null}var s=b.getTokenAt(a.Pos(n,1));if(!/\S/.test(s.string)){s=b.getTokenAt(a.Pos(n,s.end+1))}if(s.type!="keyword"||s.string!="import"){return null}for(var o=n,q=Math.min(b.lastLine(),n+10);o<=q;++o){var r=b.getLine(o),m=r.indexOf(";");if(m!=-1){return{startCh:s.end,end:a.Pos(o,m)}}}}var g=l.line,d=j(g),f;if(!d||j(g-1)||((f=j(g-2))&&f.end.line==g-1)){return null}for(var c=d.end;;){var e=j(c.line+1);if(e==null){break}c=e.end}return{from:b.clipPos(a.Pos(g,d.startCh+1)),to:c}});a.registerHelper("fold","include",function(b,j){function f(l){if(l<b.firstLine()||l>b.lastLine()){return null}var m=b.getTokenAt(a.Pos(l,1));if(!/\S/.test(m.string)){m=b.getTokenAt(a.Pos(l,m.end+1))}if(m.type=="meta"&&m.string.slice(0,8)=="#include"){return m.start+8}}var g=j.line,d=f(g);if(d==null||f(g-1)!=null){return null}for(var c=g;;){var e=f(c+1);if(e==null){break}++c}return{from:a.Pos(g,d+1),to:b.clipPos(a.Pos(c))}})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(l){var q=l.Pos;function o(x,w){return x.line-w.line||x.ch-w.ch}var m="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD";var s=m+"-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040";var d=new RegExp("<(/?)(["+m+"]["+s+"]*)","g");function b(w,x,B,A){this.line=x;this.ch=B;this.cm=w;this.text=w.getLine(x);this.min=A?Math.max(A.from,w.firstLine()):w.firstLine();this.max=A?Math.min(A.to-1,w.lastLine()):w.lastLine()}function j(w,A){var x=w.cm.getTokenTypeAt(q(w.line,A));return x&&/\btag\b/.test(x)}function a(w){if(w.line>=w.max){return}w.ch=0;w.text=w.cm.getLine(++w.line);return true}function r(w){if(w.line<=w.min){return}w.text=w.cm.getLine(--w.line);w.ch=w.text.length;return true}function g(A){for(;;){var x=A.text.indexOf(">",A.ch);if(x==-1){if(a(A)){continue}else{return}}if(!j(A,x+1)){A.ch=x+1;continue}var w=A.text.lastIndexOf("/",x);var B=w>-1&&!/\S/.test(A.text.slice(w+1,x));A.ch=x+1;return B?"selfClose":"regular"}}function n(x){for(;;){var w=x.ch?x.text.lastIndexOf("<",x.ch-1):-1;if(w==-1){if(r(x)){continue}else{return}}if(!j(x,w+1)){x.ch=w;continue}d.lastIndex=w;x.ch=w;var A=d.exec(x.text);if(A&&A.index==w){return A}}}function u(w){for(;;){d.lastIndex=w.ch;var x=d.exec(w.text);if(!x){if(a(w)){continue}else{return}}if(!j(w,x.index+1)){w.ch=x.index+1;continue}w.ch=x.index+x[0].length;return x}}function e(A){for(;;){var x=A.ch?A.text.lastIndexOf(">",A.ch-1):-1;if(x==-1){if(r(A)){continue}else{return}}if(!j(A,x+1)){A.ch=x;continue}var w=A.text.lastIndexOf("/",x);var B=w>-1&&!/\S/.test(A.text.slice(w+1,x));A.ch=x+1;return B?"selfClose":"regular"}}function f(B,x){var w=[];for(;;){var D=u(B),A,F=B.line,E=B.ch-(D?D[0].length:0);if(!D||!(A=g(B))){return}if(A=="selfClose"){continue}if(D[1]){for(var C=w.length-1;C>=0;--C){if(w[C]==D[2]){w.length=C;break}}if(C<0&&(!x||x==D[2])){return{tag:D[2],from:q(F,E),to:q(B.line,B.ch)}}}else{w.push(D[2])}}}function c(A,x){var w=[];for(;;){var E=e(A);if(!E){return}if(E=="selfClose"){n(A);continue}var D=A.line,C=A.ch;var F=n(A);if(!F){return}if(F[1]){w.push(F[2])}else{for(var B=w.length-1;B>=0;--B){if(w[B]==F[2]){w.length=B;break}}if(B<0&&(!x||x==F[2])){return{tag:F[2],from:q(A.line,A.ch),to:q(D,C)}}}}}l.registerHelper("fold","xml",function(w,E){var A=new b(w,E.line,0);for(;;){var D=u(A);if(!D||A.line!=E.line){return}var x=g(A);if(!x){return}if(!D[1]&&x!="selfClose"){var C=q(A.line,A.ch);var B=f(A,D[2]);return B&&o(B.from,C)>0?{from:C,to:B.from}:null}}});l.findMatchingTag=function(w,F,B){var A=new b(w,F.line,F.ch,B);if(A.text.indexOf(">")==-1&&A.text.indexOf("<")==-1){return}var x=g(A),E=x&&q(A.line,A.ch);var D=x&&n(A);if(!x||!D||o(A,F)>0){return}var C={from:q(A.line,A.ch),to:E,tag:D[2]};if(x=="selfClose"){return{open:C,close:null,at:"open"}}if(D[1]){return{open:c(A,D[2]),close:C,at:"close"}}else{A=new b(w,E.line,E.ch,B);return{open:C,close:f(A,D[2]),at:"open"}}};l.findEnclosingTag=function(x,F,B,w){var A=new b(x,F.line,F.ch,B);for(;;){var D=c(A,w);if(!D){break}var C=new b(x,F.line,F.ch,B);var E=f(C,D.tag);if(E){return{open:D,close:E}}}};l.scanForClosingTag=function(w,C,B,A){var x=new b(w,C.line,C.ch,A?{from:0,to:A}:null);return f(x,B)}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.registerGlobalHelper("fold","comment",function(b){return b.blockCommentStart&&b.blockCommentEnd},function(n,j){var u=n.getModeAt(j),l=u.blockCommentStart,e=u.blockCommentEnd;if(!l||!e){return}var q=j.line,g=n.getLine(q);var o;for(var w=j.ch,c=0;;){var r=w<=0?-1:g.lastIndexOf(l,w-1);if(r==-1){if(c==1){return}c=1;w=g.length;continue}if(c==1&&r<j.ch){return}if(/comment/.test(n.getTokenTypeAt(a.Pos(q,r+1)))&&(r==0||g.slice(r-e.length,r)==e||!/comment/.test(n.getTokenTypeAt(a.Pos(q,r))))){o=r+l.length;break}w=r-1}var C=1,d=n.lastLine(),f,x;outer:for(var B=q;B<=d;++B){var s=n.getLine(B),m=B==q?o:0;for(;;){var b=s.indexOf(l,m),A=s.indexOf(e,m);if(b<0){b=s.length}if(A<0){A=s.length}m=Math.min(b,A);if(m==s.length){break}if(m==b){++C}else{if(!--C){f=B;x=m;break outer}}++m}}if(f==null||q==f&&x==o){return}return{from:a.Pos(q,o),to:a.Pos(f,x)}})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(c){var j="CodeMirror-activeline";var g="CodeMirror-activeline-background";var f="CodeMirror-activeline-gutter";c.defineOption("styleActiveLine",false,function(l,o,m){var n=m==c.Init?false:m;if(o==n){return}if(n){l.off("beforeSelectionChange",b);d(l);delete l.state.activeLines}if(o){l.state.activeLines=[];e(l,l.listSelections());l.on("beforeSelectionChange",b)}});function d(l){for(var m=0;m<l.state.activeLines.length;m++){l.removeLineClass(l.state.activeLines[m],"wrap",j);l.removeLineClass(l.state.activeLines[m],"background",g);l.removeLineClass(l.state.activeLines[m],"gutter",f)}}function a(m,l){if(m.length!=l.length){return false}for(var n=0;n<m.length;n++){if(m[n]!=l[n]){return false}}return true}function e(l,n){var s=[];for(var q=0;q<n.length;q++){var o=n[q];var r=l.getOption("styleActiveLine");if(typeof r=="object"&&r.nonEmpty?o.anchor.line!=o.head.line:!o.empty()){continue}var m=l.getLineHandleVisualStart(o.head.line);if(s[s.length-1]!=m){s.push(m)}}if(a(l.state.activeLines,s)){return}l.operation(function(){d(l);for(var u=0;u<s.length;u++){l.addLineClass(s[u],"wrap",j);l.addLineClass(s[u],"background",g);l.addLineClass(s[u],"gutter",f)}l.state.activeLines=s})}function b(l,m){e(l,m.ranges)}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(d){var o=d.Pos;function f(x){var w=x.flags;return w!=null?w:(x.ignoreCase?"i":"")+(x.global?"g":"")+(x.multiline?"m":"")}function e(A,w){var C=f(A),B=C;for(var x=0;x<w.length;x++){if(B.indexOf(w.charAt(x))==-1){B+=w.charAt(x)}}return C==B?A:new RegExp(A.source,B)}function s(w){return/\\s|\\n|\n|\\W|\\D|\[\^/.test(w.source)}function r(E,D,F){D=e(D,"g");for(var w=F.line,B=F.ch,C=E.lastLine();w<=C;w++,B=0){D.lastIndex=B;var A=E.getLine(w),x=D.exec(A);if(x){return{from:o(w,x.index),to:o(w,x.index+x[0].length),match:x}}}}function g(I,F,x){if(!s(F)){return r(I,F,x)}F=e(F,"gm");var E,H=1;for(var L=x.line,J=I.lastLine();L<=J;){for(var C=0;C<H;C++){if(L>J){break}var w=I.getLine(L++);E=E==null?w:E+"\n"+w}H=H*2;F.lastIndex=x.ch;var D=F.exec(E);if(D){var G=E.slice(0,D.index).split("\n"),B=D[0].split("\n");var K=x.line+G.length-1,A=G[G.length-1].length;return{from:o(K,A),to:o(K+B.length-1,B.length==1?A+B[0].length:B[B.length-1].length),match:D}}}}function j(x,B){var C=0,w;for(;;){B.lastIndex=C;var A=B.exec(x);if(!A){return w}w=A;C=w.index+(w[0].length||1);if(C==x.length){return w}}}function c(D,C,F){C=e(C,"g");for(var w=F.line,B=F.ch,E=D.firstLine();w>=E;w--,B=-1){var A=D.getLine(w);if(B>-1){A=A.slice(0,B)}var x=j(A,C);if(x){return{from:o(w,x.index),to:o(w,x.index+x[0].length),match:x}}}}function l(J,G,x){G=e(G,"gm");var F,I=1;for(var L=x.line,E=J.firstLine();L>=E;){for(var C=0;C<I;C++){var w=J.getLine(L--);F=F==null?w.slice(0,x.ch):w+"\n"+F}I*=2;var D=j(F,G);if(D){var H=F.slice(0,D.index).split("\n"),B=D[0].split("\n");var K=L+H.length,A=H[H.length-1].length;return{from:o(K,A),to:o(K+B.length-1,B.length==1?A+B[0].length:B[B.length-1].length),match:D}}}}var u,a;if(String.prototype.normalize){u=function(w){return w.normalize("NFD").toLowerCase()};a=function(w){return w.normalize("NFD")}}else{u=function(w){return w.toLowerCase()};a=function(w){return w}}function q(F,D,E,B){if(F.length==D.length){return E}for(var C=0,x=E+Math.max(0,F.length-D.length);;){if(C==x){return C}var A=(C+x)>>1;var w=B(F.slice(0,A)).length;if(w==E){return A}else{if(w>E){x=A}else{C=A+1}}}}function n(K,G,x,C){if(!G.length){return null}var E=C?u:a;var N=E(G).split(/\r|\n\r?/);search:for(var O=x.line,w=x.ch,L=K.lastLine()+1-N.length;O<=L;O++,w=0){var J=K.getLine(O).slice(w),D=E(J);if(N.length==1){var M=D.indexOf(N[0]);if(M==-1){continue search}var x=q(J,D,M,E)+w;return{from:o(O,q(J,D,M,E)+w),to:o(O,q(J,D,M+N[0].length,E)+w)}}else{var F=D.length-N[0].length;if(D.slice(F)!=N[0]){continue search}for(var B=1;B<N.length-1;B++){if(E(K.getLine(O+B))!=N[B]){continue search}}var A=K.getLine(O+N.length-1),I=E(A),H=N[N.length-1];if(I.slice(0,H.length)!=H){continue search}return{from:o(O,q(J,D,F,E)+w),to:o(O+N.length-1,q(A,I,H.length,E))}}}}function b(K,G,x,B){if(!G.length){return null}var F=B?u:a;var M=F(G).split(/\r|\n\r?/);search:for(var N=x.line,w=x.ch,C=K.firstLine()-1+M.length;N>=C;N--,w=-1){var J=K.getLine(N);if(w>-1){J=J.slice(0,w)}var D=F(J);if(M.length==1){var L=D.lastIndexOf(M[0]);if(L==-1){continue search}return{from:o(N,q(J,D,L,F)),to:o(N,q(J,D,L+M[0].length,F))}}else{var I=M[M.length-1];if(D.slice(0,I.length)!=I){continue search}for(var A=1,x=N-M.length+1;A<M.length-1;A++){if(F(K.getLine(x+A))!=M[A]){continue search}}var H=K.getLine(N+1-M.length),E=F(H);if(E.slice(E.length-M[0].length)!=M[0]){continue search}return{from:o(N+1-M.length,q(H,E,H.length-M[0].length,F)),to:o(N,q(J,D,I.length,F))}}}}function m(B,A,C,w){this.atOccurrence=false;this.doc=B;C=C?B.clipPos(C):o(0,0);this.pos={from:C,to:C};var x;if(typeof w=="object"){x=w.caseFold}else{x=w;w=null}if(typeof A=="string"){if(x==null){x=false}this.matches=function(D,E){return(D?b:n)(B,A,E,x)}}else{A=e(A,"gm");if(!w||w.multiline!==false){this.matches=function(D,E){return(D?l:g)(B,A,E)}}else{this.matches=function(D,E){return(D?c:r)(B,A,E)}}}}m.prototype={findNext:function(){return this.find(false)},findPrevious:function(){return this.find(true)},find:function(A){var w=this.matches(A,this.doc.clipPos(A?this.pos.from:this.pos.to));while(w&&d.cmpPos(w.from,w.to)==0){if(A){if(w.from.ch){w.from=o(w.from.line,w.from.ch-1)}else{if(w.from.line==this.doc.firstLine()){w=null}else{w=this.matches(A,this.doc.clipPos(o(w.from.line-1)))}}}else{if(w.to.ch<this.doc.getLine(w.to.line).length){w.to=o(w.to.line,w.to.ch+1)}else{if(w.to.line==this.doc.lastLine()){w=null}else{w=this.matches(A,o(w.to.line+1,0))}}}}if(w){this.pos=w;this.atOccurrence=true;return this.pos.match||true}else{var x=o(A?this.doc.firstLine():this.doc.lastLine()+1,0);this.pos={from:x,to:x};return this.atOccurrence=false}},from:function(){if(this.atOccurrence){return this.pos.from}},to:function(){if(this.atOccurrence){return this.pos.to}},replace:function(A,x){if(!this.atOccurrence){return}var w=d.splitLines(A);this.doc.replaceRange(w,this.pos.from,this.pos.to,x);this.pos.to=o(this.pos.from.line+w.length-1,w[w.length-1].length+(w.length==1?this.pos.from.ch:0))}};d.defineExtension("getSearchCursor",function(x,A,w){return new m(this.doc,x,A,w)});d.defineDocExtension("getSearchCursor",function(x,A,w){return new m(this,x,A,w)});d.defineExtension("selectMatches",function(A,x){var w=[];var B=this.getSearchCursor(A,this.getCursor("from"),x);while(B.findNext()){if(d.cmpPos(B.to(),this.getCursor("to"))>0){break}w.push({anchor:B.from(),head:B.to()})}if(w.length){this.setSelections(w,0)}})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"),require("./matchesonscrollbar"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","./matchesonscrollbar"],a)}else{a(CodeMirror)}}})(function(d){var c={style:"matchhighlight",minChars:2,delay:100,wordsOnly:false,annotateScrollbar:false,showToken:false,trim:true};function m(r){this.options={};for(var q in c){this.options[q]=(r&&r.hasOwnProperty(q)?r:c)[q]}this.overlay=this.timeout=null;this.matchesonscroll=null;this.active=false}d.defineOption("highlightSelectionMatches",false,function(q,u,r){if(r&&r!=d.Init){o(q);clearTimeout(q.state.matchHighlighter.timeout);q.state.matchHighlighter=null;q.off("cursorActivity",l);q.off("focus",j)}if(u){var s=q.state.matchHighlighter=new m(u);if(q.hasFocus()){s.active=true;f(q)}else{q.on("focus",j)}q.on("cursorActivity",l)}});function l(q){var r=q.state.matchHighlighter;if(r.active||q.hasFocus()){a(q,r)}}function j(q){var r=q.state.matchHighlighter;if(!r.active){r.active=true;a(q,r)}}function a(q,r){clearTimeout(r.timeout);r.timeout=setTimeout(function(){f(q)},r.options.delay)}function b(r,x,u,s){var w=r.state.matchHighlighter;r.addOverlay(w.overlay=e(x,u,s));if(w.options.annotateScrollbar&&r.showMatchesOnScrollbar){var q=u?new RegExp("\\b"+x.replace(/[\\\[.+*?(){|^$]/g,"\\$&")+"\\b"):x;w.matchesonscroll=r.showMatchesOnScrollbar(q,false,{className:"CodeMirror-selection-highlight-scrollbar"})}}function o(q){var r=q.state.matchHighlighter;if(r.overlay){q.removeOverlay(r.overlay);r.overlay=null;if(r.matchesonscroll){r.matchesonscroll.clear();r.matchesonscroll=null}}}function f(q){q.operation(function(){var r=q.state.matchHighlighter;o(q);if(!q.somethingSelected()&&r.options.showToken){var C=r.options.showToken===true?/[\w$]/:r.options.showToken;var B=q.getCursor(),D=q.getLine(B.line),s=B.ch,u=s;while(s&&C.test(D.charAt(s-1))){--s}while(u<D.length&&C.test(D.charAt(u))){++u}if(s<u){b(q,D.slice(s,u),C,r.options.style)}return}var x=q.getCursor("from"),A=q.getCursor("to");if(x.line!=A.line){return}if(r.options.wordsOnly&&!g(q,x,A)){return}var w=q.getRange(x,A);if(r.options.trim){w=w.replace(/^\s+|\s+$/g,"")}if(w.length>=r.options.minChars){b(q,w,false,r.options.style)}})}function g(q,x,w){var s=q.getRange(x,w);if(s.match(/^\w+$/)!==null){if(x.ch>0){var u={line:x.line,ch:x.ch-1};var r=q.getRange(u,x);if(r.match(/\W/)===null){return false}}if(w.ch<q.getLine(x.line).length){var u={line:w.line,ch:w.ch+1};var r=q.getRange(w,u);if(r.match(/\W/)===null){return false}}return true}else{return false}}function n(r,q){return(!r.start||!q.test(r.string.charAt(r.start-1)))&&(r.pos==r.string.length||!q.test(r.string.charAt(r.pos)))}function e(s,r,q){return{token:function(u){if(u.match(s)&&(!r||n(u,r))){return q}u.next();u.skipTo(s.charAt(0))||u.skipToEnd()}}}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(e){var c=/MSIE \d/.test(navigator.userAgent)&&(document.documentMode==null||document.documentMode<8);var l=e.Pos;var a={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<","<":">>",">":"<<"};function d(m){return m&&m.bracketRegex||/[(){}[\]]/}function f(w,r,n){var B=w.getLineHandle(r.line),u=r.ch-1;var q=n&&n.afterCursor;if(q==null){q=/(^| )cm-fat-cursor($| )/.test(w.getWrapperElement().className)}var x=d(n);var s=(!q&&u>=0&&x.test(B.text.charAt(u))&&a[B.text.charAt(u)])||x.test(B.text.charAt(u+1))&&a[B.text.charAt(++u)];if(!s){return null}var o=s.charAt(1)==">"?1:-1;if(n&&n.strict&&(o>0)!=(u==r.ch)){return null}var m=w.getTokenTypeAt(l(r.line,u+1));var A=g(w,l(r.line,u+(o>0?1:0)),o,m||null,n);if(A==null){return null}return{from:l(r.line,u),to:A&&A.pos,match:A&&A.ch==s.charAt(0),forward:o>0}}function g(E,x,r,n,q){var o=(q&&q.maxScanLineLength)||10000;var B=(q&&q.maxScanLines)||1000;var D=[];var F=d(q);var w=r>0?Math.min(x.line+B,E.lastLine()+1):Math.max(E.firstLine()-1,x.line-B);for(var s=x.line;s!=w;s+=r){var G=E.getLine(s);if(!G){continue}var C=r>0?0:G.length-1,u=r>0?G.length:-1;if(G.length>o){continue}if(s==x.line){C=x.ch-(r<0?1:0)}for(;C!=u;C+=r){var m=G.charAt(C);if(F.test(m)&&(n===undefined||E.getTokenTypeAt(l(s,C+1))==n)){var A=a[m];if(A&&(A.charAt(1)==">")==(r>0)){D.push(m)}else{if(!D.length){return{pos:l(s,C),ch:m}}else{D.pop()}}}}}return s-r==(r>0?E.lastLine():E.firstLine())?false:null}function b(A,r,q){var n=A.state.matchBrackets.maxHighlightLineLength||1000;var x=[],o=A.listSelections();for(var s=0;s<o.length;s++){var w=o[s].empty()&&f(A,o[s].head,q);if(w&&A.getLine(w.from.line).length<=n){var m=w.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";x.push(A.markText(w.from,l(w.from.line,w.from.ch+1),{className:m}));if(w.to&&A.getLine(w.to.line).length<=n){x.push(A.markText(w.to,l(w.to.line,w.to.ch+1),{className:m}))}}}if(x.length){if(c&&A.state.focused){A.focus()}var u=function(){A.operation(function(){for(var B=0;B<x.length;B++){x[B].clear()}})};if(r){setTimeout(u,800)}else{return u}}}function j(m){m.operation(function(){if(m.state.matchBrackets.currentlyHighlighted){m.state.matchBrackets.currentlyHighlighted();m.state.matchBrackets.currentlyHighlighted=null}m.state.matchBrackets.currentlyHighlighted=b(m,false,m.state.matchBrackets)})}e.defineOption("matchBrackets",false,function(m,o,n){if(n&&n!=e.Init){m.off("cursorActivity",j);if(m.state.matchBrackets&&m.state.matchBrackets.currentlyHighlighted){m.state.matchBrackets.currentlyHighlighted();m.state.matchBrackets.currentlyHighlighted=null}}if(o){m.state.matchBrackets=typeof o=="object"?o:{};m.on("cursorActivity",j)}});e.defineExtension("matchBrackets",function(){b(this,true)});e.defineExtension("findMatchingBracket",function(o,n,m){if(m||typeof n=="boolean"){if(!m){n=n?{strict:true}:null}else{m.strict=n;n=m}}return f(this,o,n)});e.defineExtension("scanForBracket",function(q,n,o,m){return g(this,q,n,o,m)})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(e){var d={pairs:"()[]{}''\"\"",closeBefore:")]}'\":;>",triples:"",explode:"[]{}"};var n=e.Pos;e.defineOption("autoCloseBrackets",false,function(s,w,u){if(u&&u!=e.Init){s.removeKeyMap(m);s.state.closeBrackets=null}if(w){j(a(w,"pairs"));s.state.closeBrackets=w;s.addKeyMap(m)}});function a(u,s){if(s=="pairs"&&typeof u=="string"){return u}if(typeof u=="object"&&u[s]!=null){return u[s]}return d[s]}var m={Backspace:c,Enter:b};function j(x){for(var u=0;u<x.length;u++){var w=x.charAt(u),s="'"+w+"'";if(!m[s]){m[s]=r(w)}}}j(d.pairs+"`");function r(s){return function(u){return q(u,s)}}function o(s){var w=s.state.closeBrackets;if(!w||w.override){return w}var u=s.getModeAt(s.getCursor());return u.closeBrackets||w}function c(s){var w=o(s);if(!w||s.getOption("disableInput")){return e.Pass}var B=a(w,"pairs");var u=s.listSelections();for(var x=0;x<u.length;x++){if(!u[x].empty()){return e.Pass}var A=g(s,u[x].head);if(!A||B.indexOf(A)%2!=0){return e.Pass}}for(var x=u.length-1;x>=0;x--){var C=u[x].head;s.replaceRange("",n(C.line,C.ch-1),n(C.line,C.ch+1),"+delete")}}function b(s){var w=o(s);var A=w&&a(w,"explode");if(!A||s.getOption("disableInput")){return e.Pass}var u=s.listSelections();for(var x=0;x<u.length;x++){if(!u[x].empty()){return e.Pass}var B=g(s,u[x].head);if(!B||A.indexOf(B)%2!=0){return e.Pass}}s.operation(function(){var D=s.lineSeparator()||"\n";s.replaceSelection(D+D,null);s.execCommand("goCharLeft");u=s.listSelections();for(var E=0;E<u.length;E++){var C=u[E].head.line;s.indentLine(C,null,true);s.indentLine(C+1,null,true)}})}function f(u){var s=e.cmpPos(u.anchor,u.head)>0;return{anchor:new n(u.anchor.line,u.anchor.ch+(s?-1:1)),head:new n(u.head.line,u.head.ch+(s?1:-1))}}function q(D,F){var E=o(D);if(!E||D.getOption("disableInput")){return e.Pass}var O=a(E,"pairs");var C=O.indexOf(F);if(C==-1){return e.Pass}var H=a(E,"closeBefore");var L=a(E,"triples");var s=O.charAt(C+1)==F;var u=D.listSelections();var J=C%2==0;var x;for(var M=0;M<u.length;M++){var G=u[M],w=G.head,B;var K=D.getRange(w,n(w.line,w.ch+1));if(J&&!G.empty()){B="surround"}else{if((s||!J)&&K==F){if(s&&l(D,w)){B="both"}else{if(L.indexOf(F)>=0&&D.getRange(w,n(w.line,w.ch+3))==F+F+F){B="skipThree"}else{B="skip"}}}else{if(s&&w.ch>1&&L.indexOf(F)>=0&&D.getRange(n(w.line,w.ch-2),w)==F+F){if(w.ch>2&&/\bstring/.test(D.getTokenTypeAt(n(w.line,w.ch-2)))){return e.Pass}B="addFour"}else{if(s){var I=w.ch==0?" ":D.getRange(n(w.line,w.ch-1),w);if(!e.isWordChar(K)&&I!=F&&!e.isWordChar(I)){B="both"}else{return e.Pass}}else{if(J&&(K.length===0||/\s/.test(K)||H.indexOf(K)>-1)){B="both"}else{return e.Pass}}}}}if(!x){x=B}else{if(x!=B){return e.Pass}}}var A=C%2?O.charAt(C-1):F;var N=C%2?F:O.charAt(C+1);D.operation(function(){if(x=="skip"){D.execCommand("goCharRight")}else{if(x=="skipThree"){for(var Q=0;Q<3;Q++){D.execCommand("goCharRight")}}else{if(x=="surround"){var P=D.getSelections();for(var Q=0;Q<P.length;Q++){P[Q]=A+P[Q]+N}D.replaceSelections(P,"around");P=D.listSelections().slice();for(var Q=0;Q<P.length;Q++){P[Q]=f(P[Q])}D.setSelections(P)}else{if(x=="both"){D.replaceSelection(A+N,null);D.triggerElectric(A+N);D.execCommand("goCharLeft")}else{if(x=="addFour"){D.replaceSelection(A+A+A+A,"before");D.execCommand("goCharRight")}}}}}})}function g(s,w){var u=s.getRange(n(w.line,w.ch-1),n(w.line,w.ch+1));return u.length==2?u:null}function l(s,w){var u=s.getTokenAt(n(w.line,w.ch+1));return/\bstring/.test(u.type)&&u.start==w.ch&&(w.ch==0||!/\bstring/.test(s.getTokenTypeAt(w)))}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(b){var c={};var g=/[^\s\u00a0]/;var e=b.Pos;function f(l){var j=l.search(g);return j==-1?0:j}b.commands.toggleComment=function(j){j.toggleComment()};b.defineExtension("toggleComment",function(m){if(!m){m=c}var j=this;var o=Infinity,l=this.listSelections(),q=null;for(var n=l.length-1;n>=0;n--){var s=l[n].from(),r=l[n].to();if(s.line>=o){continue}if(r.line>=o){r=e(o,0)}o=s.line;if(q==null){if(j.uncomment(s,r,m)){q="un"}else{j.lineComment(s,r,m);q="line"}}else{if(q=="un"){j.uncomment(s,r,m)}else{j.lineComment(s,r,m)}}}});function d(j,m,l){return/\bstring\b/.test(j.getTokenTypeAt(e(m.line,0)))&&!/^[\'\"\`]/.test(l)}function a(j,m){var l=j.getMode();return l.useInnerComments===false||!l.innerMode?l:j.getModeAt(m)}b.defineExtension("lineComment",function(q,r,w){if(!w){w=c}var s=this,m=a(s,q);var o=s.getLine(q.line);if(o==null||d(s,q,o)){return}var u=w.lineComment||m.lineComment;if(!u){if(w.blockCommentStart||m.blockCommentStart){w.fullLines=true;s.blockComment(q,r,w)}return}var l=Math.min(r.ch!=0||r.line==q.line?r.line+1:r.line,s.lastLine()+1);var j=w.padding==null?" ":w.padding;var n=w.commentBlankLines||q.line==r.line;s.operation(function(){if(w.indent){var C=null;for(var B=q.line;B<l;++B){var x=s.getLine(B);var A=x.slice(0,f(x));if(C==null||C.length>A.length){C=A}}for(var B=q.line;B<l;++B){var x=s.getLine(B),D=C.length;if(!n&&!g.test(x)){continue}if(x.slice(0,D)!=C){D=f(x)}s.replaceRange(C+u+j,e(B,0),e(B,D))}}else{for(var B=q.line;B<l;++B){if(n||g.test(s.getLine(B))){s.replaceRange(u+j,e(B,0))}}}})});b.defineExtension("blockComment",function(o,q,u){if(!u){u=c}var s=this,m=a(s,o);var n=u.blockCommentStart||m.blockCommentStart;var r=u.blockCommentEnd||m.blockCommentEnd;if(!n||!r){if((u.lineComment||m.lineComment)&&u.fullLines!=false){s.lineComment(o,q,u)}return}if(/\bcomment\b/.test(s.getTokenTypeAt(e(o.line,0)))){return}var l=Math.min(q.line,s.lastLine());if(l!=o.line&&q.ch==0&&g.test(s.getLine(l))){--l}var j=u.padding==null?" ":u.padding;if(o.line>l){return}s.operation(function(){if(u.fullLines!=false){var A=g.test(s.getLine(l));s.replaceRange(j+r,e(l));s.replaceRange(n+j,e(o.line,0));var w=u.blockCommentLead||m.blockCommentLead;if(w!=null){for(var x=o.line+1;x<=l;++x){if(x!=l||A){s.replaceRange(w+j,e(x,0))}}}}else{s.replaceRange(r,q);s.replaceRange(n,o)}})});b.defineExtension("uncomment",function(J,n,o){if(!o){o=c}var F=this,C=a(F,J);var q=Math.min(n.ch!=0||n.line==J.line?n.line:n.line-1,F.lastLine()),r=Math.min(J.line,q);var E=o.lineComment||C.lineComment,m=[];var N=o.padding==null?" ":o.padding,u;lineComment:{if(!E){break lineComment}for(var K=r;K<=q;++K){var w=F.getLine(K);var x=w.indexOf(E);if(x>-1&&!/comment/.test(F.getTokenTypeAt(e(K,x+1)))){x=-1}if(x==-1&&g.test(w)){break lineComment}if(x>-1&&g.test(w.slice(0,x))){break lineComment}m.push(w)}F.operation(function(){for(var R=r;R<=q;++R){var P=m[R-r];var S=P.indexOf(E),Q=S+E.length;if(S<0){continue}if(P.slice(Q,Q+N.length)==N){Q+=N.length}u=true;F.replaceRange("",e(R,S),e(R,Q))}});if(u){return true}}var A=o.blockCommentStart||C.blockCommentStart;var j=o.blockCommentEnd||C.blockCommentEnd;if(!A||!j){return false}var M=o.blockCommentLead||C.blockCommentLead;var I=F.getLine(r),B=I.indexOf(A);if(B==-1){return false}var s=q==r?I:F.getLine(q);var D=s.indexOf(j,q==r?B+A.length:0);var L=e(r,B+1),G=e(q,D+1);if(D==-1||!/comment/.test(F.getTokenTypeAt(L))||!/comment/.test(F.getTokenTypeAt(G))||F.getRange(L,G,"\n").indexOf(j)>-1){return false}var H=I.lastIndexOf(A,J.ch);var O=H==-1?-1:I.slice(0,J.ch).indexOf(j,H+A.length);if(H!=-1&&O!=-1&&O+j.length!=J.ch){return false}O=s.indexOf(j,n.ch);var l=s.slice(n.ch).lastIndexOf(A,O-n.ch);H=(O==-1||l==-1)?-1:n.ch+l;if(O!=-1&&H!=-1&&H!=n.ch){return false}F.operation(function(){F.replaceRange("",e(q,D-(N&&s.slice(D-N.length,D)==N?N.length:0)),e(q,D+j.length));var S=B+A.length;if(N&&I.slice(S,S+N.length)==N){S+=N.length}F.replaceRange("",e(r,B),e(r,S));if(M){for(var R=r+1;R<=q;++R){var Q=F.getLine(R),T=Q.indexOf(M);if(T==-1||g.test(Q.slice(0,T))){continue}var P=T+M.length;if(N&&Q.slice(P,P+N.length)==N){P+=N.length}F.replaceRange("",e(R,T),e(R,P))}}});return true})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){function b(q){if(q.getOption("disableInput")){return a.Pass}var d=q.listSelections(),l,n=[];for(var g=0;g<d.length;g++){var o=d[g].head;if(!/\bcomment\b/.test(q.getTokenTypeAt(o))){return a.Pass}var m=q.getModeAt(o);if(!l){l=m}else{if(l!=m){return a.Pass}}var r=null;if(l.blockCommentStart&&l.blockCommentContinue){var u=q.getLine(o.line).slice(0,o.ch);var e=u.lastIndexOf(l.blockCommentEnd),s;if(e!=-1&&e==o.ch-l.blockCommentEnd.length){}else{if((s=u.lastIndexOf(l.blockCommentStart))>-1&&s>e){r=u.slice(0,s);if(/\S/.test(r)){r="";for(var f=0;f<s;++f){r+=" "}}}else{if((s=u.indexOf(l.blockCommentContinue))>-1&&!/\S/.test(u.slice(0,s))){r=u.slice(0,s)}}}if(r!=null){r+=l.blockCommentContinue}}if(r==null&&l.lineComment&&c(q)){var u=q.getLine(o.line),s=u.indexOf(l.lineComment);if(s>-1){r=u.slice(0,s);if(/\S/.test(r)){r=null}else{r+=l.lineComment+u.slice(s+l.lineComment.length).match(/^\s*/)[0]}}}if(r==null){return a.Pass}n[g]="\n"+r}q.operation(function(){for(var j=d.length-1;j>=0;j--){q.replaceRange(n[j],d[j].from(),d[j].to(),"+insert")}})}function c(d){var e=d.getOption("continueComments");if(e&&typeof e=="object"){return e.continueLineComment!==false}return true}a.defineOption("continueComments",null,function(d,j,f){if(f&&f!=a.Init){d.removeKeyMap("continueComment")}if(j){var e="Enter";if(typeof j=="string"){e=j}else{if(typeof j=="object"&&j.key){e=j.key}}var g={name:"continueComment"};g[e]=b;d.addKeyMap(g)}})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineMode("javascript",function(aw,aI){var u=aw.indentUnit;var N=aI.statementIndent;var a1=aI.jsonld;var L=aI.json||a1;var j=aI.typescript;var aT=aI.wordCharacters||/[\w$\xa1-\uffff]/;var aR=function(){function bg(bk){return{type:bk,style:"keyword"}}var bd=bg("keyword a"),bj=bg("keyword b"),bi=bg("keyword c"),bh=bg("keyword d");var be=bg("operator"),bf={type:"atom",style:"atom"};return{xui:{type:"variable",style:"xuiglobal"},"if":bg("if"),"while":bd,"with":bd,"else":bj,"do":bj,"try":bj,"finally":bj,"return":bh,"break":bh,"continue":bh,"new":bg("new"),"delete":bi,"void":bi,"throw":bi,"debugger":bg("debugger"),"var":bg("var"),"const":bg("var"),let:bg("var"),"function":bg("function"),"catch":bg("catch"),"for":bg("for"),"switch":bg("switch"),"case":bg("case"),"default":bg("default"),"in":be,"typeof":be,"instanceof":be,"true":bf,"false":bf,"null":bf,"undefined":bf,"NaN":bf,"Infinity":bf,"this":bg("this"),"class":bg("class"),"super":bg("atom"),yield:bi,"export":bg("export"),"import":bg("import"),"extends":bi,await:bi}}();var ag=/[+\-*&%=<>!?|~^@]/;var aQ=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;function R(bg){var be=false,bd,bf=false;while((bd=bg.next())!=null){if(!be){if(bd=="/"&&!bf){return}if(bd=="["){bf=true}else{if(bf&&bd=="]"){bf=false}}}be=!be&&bd=="\\"}}var al,S;function aa(bf,be,bd){al=bf;S=bd;return be}function an(bh,bf){var bd=bh.next();if(bd=='"'||bd=="'"){bf.tokenize=ak(bd);return bf.tokenize(bh,bf)}else{if(bd=="."&&bh.match(/^\d+(?:[eE][+\-]?\d+)?/)){return aa("number","number")}else{if(bd=="."&&bh.match("..")){return aa("spread","meta")}else{if(/[\[\]{}\(\),;\:\.]/.test(bd)){return aa(bd)}else{if(bd=="="&&bh.eat(">")){return aa("=>","operator")}else{if(bd=="0"&&bh.match(/^(?:x[\da-f]+|o[0-7]+|b[01]+)n?/i)){return aa("number","number")}else{if(/\d/.test(bd)){bh.match(/^\d*(?:n|(?:\.\d*)?(?:[eE][+\-]?\d+)?)?/);return aa("number","number")}else{if(bd=="/"){if(bh.eat("*")){bf.tokenize=a0;return a0(bh,bf)}else{if(bh.eat("/")){bh.skipToEnd();return aa("comment","comment")}else{if(a9(bh,bf,1)){R(bh);bh.match(/^\b(([gimyus])(?![gimyus]*\2))+\b/);return aa("regexp","string-2")}else{bh.eat("=");return aa("operator","operator",bh.current())}}}}else{if(bd=="`"){bf.tokenize=a3;return a3(bh,bf)}else{if(bd=="#"){bh.skipToEnd();return aa("error","error")}else{if(ag.test(bd)){if(bd!=">"||!bf.lexical||bf.lexical.type!=">"){if(bh.eat("=")){if(bd=="!"||bd=="="){bh.eat("=")}}else{if(/[<>*+\-]/.test(bd)){bh.eat(bd);if(bd==">"){bh.eat(bd)}}}}return aa("operator","operator",bh.current())}else{if(aT.test(bd)){bh.eatWhile(aT);var bg=bh.current();if(bf.lastType!="."){if(aR.propertyIsEnumerable(bg)){var be=aR[bg];return aa(be.type,be.style,bg)}if(bg=="async"&&bh.match(/^(\s|\/\*.*?\*\/)*[\[\(\w]/,false)){return aa("async","keyword",bg)}}return aa("variable","variable",bg)}}}}}}}}}}}}}function ak(bd){return function(bh,bf){var bg=false,be;if(a1&&bh.peek()=="@"&&bh.match(aQ)){bf.tokenize=an;return aa("jsonld-keyword","meta")}while((be=bh.next())!=null){if(be==bd&&!bg){break}bg=!bg&&be=="\\"}if(!bg){bf.tokenize=an}return aa("string","string")}}function a0(bg,bf){var bd=false,be;while(be=bg.next()){if(be=="/"&&bd){bf.tokenize=an;break}bd=(be=="*")}return aa("comment","comment")}function a3(bg,be){var bf=false,bd;while((bd=bg.next())!=null){if(!bf&&(bd=="`"||bd=="$"&&bg.eat("{"))){be.tokenize=an;break}bf=!bf&&bd=="\\"}return aa("quasi","string-2",bg.current())}var w="([{}])";function aX(bl,bf){if(bf.fatArrowAt){bf.fatArrowAt=null}var bk=bl.string.indexOf("=>",bl.start);if(bk<0){return}if(j){var bh=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(bl.string.slice(bl.start,bk));if(bh){bk=bh.index}}var bi=0,bg=false;for(var bj=bk-1;bj>=0;--bj){var bd=bl.string.charAt(bj);var be=w.indexOf(bd);if(be>=0&&be<3){if(!bi){++bj;break}if(--bi==0){if(bd=="("){bg=true}break}}else{if(be>=3&&be<6){++bi}else{if(aT.test(bd)){bg=true}else{if(/["'\/]/.test(bd)){return}else{if(bg&&!bi){++bj;break}}}}}}if(bg&&!bi){bf.fatArrowAt=bj}}var b={atom:true,number:true,variable:true,string:true,regexp:true,"this":true,"jsonld-keyword":true};function Y(bi,be,bd,bh,bf,bg){this.indented=bi;this.column=be;this.type=bd;this.prev=bf;this.info=bg;if(bh!=null){this.align=bh}}function F(bg,bf){for(var be=bg.localVars;be;be=be.next){if(be.name==bf){return true}}for(var bd=bg.context;bd;bd=bd.prev){for(var be=bd.vars;be;be=be.next){if(be.name==bf){return true}}}}function g(bh,be,bd,bg,bi){var bj=bh.cc;Q.state=bh;Q.stream=bi;Q.marked=null,Q.cc=bj;Q.style=be;if(!bh.lexical.hasOwnProperty("align")){bh.lexical.align=true}while(true){var bf=bj.length?bj.pop():L?aM:a7;if(bf(bd,bg)){while(bj.length&&bj[bj.length-1].lex){bj.pop()()}if(Q.marked){return Q.marked}if(bd=="variable"&&F(bh,bg)){return"variable-2"}return be}}}var Q={state:null,column:null,marked:null,cc:null};function ay(){for(var bd=arguments.length-1;bd>=0;bd--){Q.cc.push(arguments[bd])}}function aD(){ay.apply(null,arguments);return true}function f(be,bf){for(var bd=bf;bd;bd=bd.next){if(bd.name==be){return true}}return false}function aW(bd){var be=Q.state;Q.marked="def";if(be.context){if(be.lexical.info=="var"&&be.context&&be.context.block){var bf=aV(bd,be.context);if(bf!=null){be.context=bf;return}}else{if(!f(bd,be.localVars)){be.localVars=new a8(bd,be.localVars);return}}}if(aI.globalVars&&!f(bd,be.globalVars)){be.globalVars=new a8(bd,be.globalVars)}}function aV(be,bf){if(!bf){return null}else{if(bf.block){var bd=aV(be,bf.prev);if(!bd){return null}if(bd==bf.prev){return bf}return new X(bd,bf.vars,true)}else{if(f(be,bf.vars)){return bf}else{return new X(bf.prev,new a8(be,bf.vars),false)}}}}function aJ(bd){return bd=="public"||bd=="private"||bd=="protected"||bd=="abstract"||bd=="readonly"}function X(bd,be,bf){this.prev=bd;this.vars=be;this.block=bf}function a8(bd,be){this.name=bd;this.next=be}var D=new a8("this",new a8("arguments",null));function I(){Q.state.context=new X(Q.state.context,Q.state.localVars,false);Q.state.localVars=D}function au(){Q.state.context=new X(Q.state.context,Q.state.localVars,true);Q.state.localVars=null}function J(){Q.state.localVars=Q.state.context.vars;Q.state.context=Q.state.context.prev}J.lex=true;function a5(be,bf){var bd=function(){var bi=Q.state,bg=bi.indented;if(bi.lexical.type=="stat"){bg=bi.lexical.indented}else{for(var bh=bi.lexical;bh&&bh.type==")"&&bh.align;bh=bh.prev){bg=bh.indented}}bi.lexical=new Y(bg,Q.stream.column(),be,null,bi.lexical,bf)};bd.lex=true;return bd}function l(){var bd=Q.state;if(bd.lexical.prev){if(bd.lexical.type==")"){bd.indented=bd.lexical.indented}bd.lexical=bd.lexical.prev}}l.lex=true;function E(bd){function be(bf){if(bf==bd){return aD()}else{if(bd==";"||bf=="}"||bf==")"||bf=="]"){return ay()}else{return aD(be)}}}return be}function a7(bd,be){if(bd=="var"){return aD(a5("vardef",be),c,E(";"),l)}if(bd=="keyword a"){return aD(a5("form"),aN,a7,l)}if(bd=="keyword b"){return aD(a5("form"),a7,l)}if(bd=="keyword d"){return Q.stream.match(/^\s*$/,false)?aD():aD(a5("stat"),aH,E(";"),l)}if(bd=="debugger"){return aD(E(";"))}if(bd=="{"){return aD(a5("}"),au,K,l,J)}if(bd==";"){return aD()}if(bd=="if"){if(Q.state.lexical.info=="else"&&Q.state.cc[Q.state.cc.length-1]==l){Q.state.cc.pop()()}return aD(a5("form"),aN,a7,l,d)}if(bd=="function"){return aD(ab)}if(bd=="for"){return aD(a5("form"),H,a7,l)}if(bd=="class"||(j&&be=="interface")){Q.marked="keyword";return aD(a5("form",bd=="class"?bd:be),aq,l)}if(bd=="variable"){if(j&&be=="declare"){Q.marked="keyword";return aD(a7)}else{if(j&&(be=="module"||be=="enum"||be=="type")&&Q.stream.match(/^\s*\w/,false)){Q.marked="keyword";if(be=="enum"){return aD(aU)}else{if(be=="type"){return aD(ax,E("operator"),n,E(";"))}else{return aD(a5("form"),m,E("{"),a5("}"),K,l,l)}}}else{if(j&&be=="namespace"){Q.marked="keyword";return aD(a5("form"),aM,a7,l)}else{if(j&&be=="abstract"){Q.marked="keyword";return aD(a7)}else{return aD(a5("stat"),ba)}}}}}if(bd=="switch"){return aD(a5("form"),aN,E("{"),a5("}","switch"),au,K,l,l,J)}if(bd=="case"){return aD(aM,E(":"))}if(bd=="default"){return aD(E(":"))}if(bd=="catch"){return aD(a5("form"),I,ae,a7,l,J)}if(bd=="export"){return aD(a5("stat"),a6,l)}if(bd=="import"){return aD(a5("stat"),aE,l)}if(bd=="async"){return aD(a7)}if(be=="@"){return aD(aM,a7)}return ay(a5("stat"),aM,E(";"),l)}function ae(bd){if(bd=="("){return aD(aC,E(")"))}}function aM(bd,be){return av(bd,be,false)}function a4(bd,be){return av(bd,be,true)}function aN(bd){if(bd!="("){return ay()}return aD(a5(")"),aM,E(")"),l)}function av(be,bf,bh){if(Q.state.fatArrowAt==Q.stream.start){var bd=bh?ac:ar;if(be=="("){return aD(I,a5(")"),aS(aC,")"),l,E("=>"),bd,J)}else{if(be=="variable"){return ay(I,m,E("=>"),bd,J)}}}var bg=bh?o:aA;if(b.hasOwnProperty(be)){return aD(bg)}if(be=="function"){return aD(ab,bg)}if(be=="class"||(j&&bf=="interface")){Q.marked="keyword";return aD(a5("form"),V,l)}if(be=="keyword c"||be=="async"){return aD(bh?a4:aM)}if(be=="("){return aD(a5(")"),aH,E(")"),l,bg)}if(be=="operator"||be=="spread"){return aD(bh?a4:aM)}if(be=="["){return aD(a5("]"),x,l,bg)}if(be=="{"){return aY(G,"}",null,bg)}if(be=="quasi"){return ay(ah,bg)}if(be=="new"){return aD(U(bh))}if(be=="import"){return aD(aM)}return aD()}function aH(bd){if(bd.match(/[;\}\)\],]/)){return ay()}return ay(aM)}function aA(bd,be){if(bd==","){return aD(aM)}return o(bd,be,false)}function o(bd,bf,bh){var be=bh==false?aA:o;var bg=bh==false?aM:a4;if(bd=="=>"){return aD(I,bh?ac:ar,J)}if(bd=="operator"){if(/\+\+|--/.test(bf)||j&&bf=="!"){return aD(be)}if(j&&bf=="<"&&Q.stream.match(/^([^>]|<.*?>)*>\s*\(/,false)){return aD(a5(">"),aS(n,">"),l,be)}if(bf=="?"){return aD(aM,E(":"),bg)}return aD(bg)}if(bd=="quasi"){return ay(ah,be)}if(bd==";"){return}if(bd=="("){return aY(a4,")","call",be)}if(bd=="."){return aD(aK,be)}if(bd=="["){return aD(a5("]"),aH,E("]"),l,be)}if(j&&bf=="as"){Q.marked="keyword";return aD(n,be)}if(bd=="regexp"){Q.state.lastType=Q.marked="operator";Q.stream.backUp(Q.stream.pos-Q.stream.start-1);return aD(bg)}}function ah(bd,be){if(bd!="quasi"){return ay()}if(be.slice(be.length-2)!="${"){return aD(ah)}return aD(aM,C)}function C(bd){if(bd=="}"){Q.marked="string-2";Q.state.tokenize=a3;return aD(ah)}}function ar(bd){aX(Q.stream,Q.state);return ay(bd=="{"?a7:aM)}function ac(bd){aX(Q.stream,Q.state);return ay(bd=="{"?a7:a4)}function U(bd){return function(be){if(be=="."){return aD(bd?A:ap)}else{if(be=="variable"&&j){return aD(e,bd?o:aA)}else{return ay(bd?a4:aM)}}}}function ap(bd,be){if(be=="target"){Q.marked="keyword";return aD(aA)}}function A(bd,be){if(be=="target"){Q.marked="keyword";return aD(o)}}function ba(bd){if(bd==":"){return aD(l,a7)}return ay(aA,E(";"),l)}function aK(bd){if(bd=="variable"){Q.marked="property";return aD()}}function G(be,bf){if(be=="async"){Q.marked="property";return aD(G)}else{if(be=="variable"||Q.style=="keyword"){Q.marked="property";if(bf=="get"||bf=="set"){return aD(W)}var bd;if(j&&Q.state.fatArrowAt==Q.stream.start&&(bd=Q.stream.match(/^\s*:\s*/,false))){Q.state.fatArrowAt=Q.stream.pos+bd[0].length}return aD(Z)}else{if(be=="number"||be=="string"){Q.marked=a1?"property":(Q.style+" property");return aD(Z)}else{if(be=="jsonld-keyword"){return aD(Z)}else{if(j&&aJ(bf)){Q.marked="keyword";return aD(G)}else{if(be=="["){return aD(aM,am,E("]"),Z)}else{if(be=="spread"){return aD(a4,Z)}else{if(bf=="*"){Q.marked="keyword";return aD(G)}else{if(be==":"){return ay(Z)}}}}}}}}}}function W(bd){if(bd!="variable"){return ay(Z)}Q.marked="property";return aD(ab)}function Z(bd){if(bd==":"){return aD(a4)}if(bd=="("){return ay(ab)}}function aS(bg,bd,be){function bf(bi,bj){if(be?be.indexOf(bi)>-1:bi==","){var bh=Q.state.lexical;if(bh.info=="call"){bh.pos=(bh.pos||0)+1}return aD(function(bk,bl){if(bk==bd||bl==bd){return ay()}return ay(bg)},bf)}if(bi==bd||bj==bd){return aD()}if(be&&be.indexOf(";")>-1){return ay(bg)}return aD(E(bd))}return function(bh,bi){if(bh==bd||bi==bd){return aD()}return ay(bg,bf)}}function aY(bg,bd,bf){for(var be=3;be<arguments.length;be++){Q.cc.push(arguments[be])}return aD(a5(bd,bf),aS(bg,bd),l)}function K(bd){if(bd=="}"){return aD()}return ay(a7,K)}function am(bd,be){if(j){if(bd==":"||be=="in"){return aD(n)}if(be=="?"){return aD(am)}}}function ad(bd){if(j&&bd==":"){if(Q.stream.match(/^\s*\w+\s+is\b/,false)){return aD(aM,ai,n)}else{return aD(n)}}}function ai(bd,be){if(be=="is"){Q.marked="keyword";return aD()}}function n(bd,be){if(be=="keyof"||be=="typeof"||be=="infer"){Q.marked="keyword";return aD(be=="typeof"?a4:n)}if(bd=="variable"||be=="void"){Q.marked="type";return aD(T)}if(be=="|"||be=="&"){return aD(n)}if(bd=="string"||bd=="number"||bd=="atom"){return aD(T)}if(bd=="["){return aD(a5("]"),aS(n,"]",","),l,T)}if(bd=="{"){return aD(a5("}"),aS(aL,"}",",;"),l,T)}if(bd=="("){return aD(aS(az,")"),aj,T)}if(bd=="<"){return aD(aS(n,">"),n)}}function aj(bd){if(bd=="=>"){return aD(n)}}function aL(bd,be){if(bd=="variable"||Q.style=="keyword"){Q.marked="property";return aD(aL)}else{if(be=="?"||bd=="number"||bd=="string"){return aD(aL)}else{if(bd==":"){return aD(n)}else{if(bd=="["){return aD(E("variable"),am,E("]"),aL)}else{if(bd=="("){return ay(bc,aL)}}}}}}function az(bd,be){if(bd=="variable"&&Q.stream.match(/^\s*[?:]/,false)||be=="?"){return aD(az)}if(bd==":"){return aD(n)}if(bd=="spread"){return aD(az)}return ay(n)}function T(bd,be){if(be=="<"){return aD(a5(">"),aS(n,">"),l,T)}if(be=="|"||bd=="."||be=="&"){return aD(n)}if(bd=="["){return aD(n,E("]"),T)}if(be=="extends"||be=="implements"){Q.marked="keyword";return aD(n)}if(be=="?"){return aD(n,E(":"),n)}}function e(bd,be){if(be=="<"){return aD(a5(">"),aS(n,">"),l,T)}}function s(){return ay(n,ao)}function ao(bd,be){if(be=="="){return aD(n)}}function c(bd,be){if(be=="enum"){Q.marked="keyword";return aD(aU)}return ay(m,am,aB,at)}function m(bd,be){if(j&&aJ(be)){Q.marked="keyword";return aD(m)}if(bd=="variable"){aW(be);return aD()}if(bd=="spread"){return aD(m)}if(bd=="["){return aY(M,"]")}if(bd=="{"){return aY(a2,"}")}}function a2(bd,be){if(bd=="variable"&&!Q.stream.match(/^\s*:/,false)){aW(be);return aD(aB)}if(bd=="variable"){Q.marked="property"}if(bd=="spread"){return aD(m)}if(bd=="}"){return ay()}if(bd=="["){return aD(aM,E("]"),E(":"),a2)}return aD(E(":"),m,aB)}function M(){return ay(m,aB)}function aB(bd,be){if(be=="="){return aD(a4)}}function at(bd){if(bd==","){return aD(c)}}function d(bd,be){if(bd=="keyword b"&&be=="else"){return aD(a5("form","else"),a7,l)}}function H(bd,be){if(be=="await"){return aD(H)}if(bd=="("){return aD(a5(")"),P,l)}}function P(bd){if(bd=="var"){return aD(c,O)}if(bd=="variable"){return aD(O)}return ay(O)}function O(bd,be){if(bd==")"){return aD()}if(bd==";"){return aD(O)}if(be=="in"||be=="of"){Q.marked="keyword";return aD(aM,O)}return ay(aM,O)}function ab(bd,be){if(be=="*"){Q.marked="keyword";return aD(ab)}if(bd=="variable"){aW(be);return aD(ab)}if(bd=="("){return aD(I,a5(")"),aS(aC,")"),l,ad,a7,J)}if(j&&be=="<"){return aD(a5(">"),aS(s,">"),l,ab)}}function bc(bd,be){if(be=="*"){Q.marked="keyword";return aD(bc)}if(bd=="variable"){aW(be);return aD(bc)}if(bd=="("){return aD(I,a5(")"),aS(aC,")"),l,ad,J)}if(j&&be=="<"){return aD(a5(">"),aS(s,">"),l,bc)}}function ax(bd,be){if(bd=="keyword"||bd=="variable"){Q.marked="type";return aD(ax)}else{if(be=="<"){return aD(a5(">"),aS(s,">"),l)}}}function aC(bd,be){if(be=="@"){aD(aM,aC)}if(bd=="spread"){return aD(aC)}if(j&&aJ(be)){Q.marked="keyword";return aD(aC)}if(j&&bd=="this"){return aD(am,aB)}return ay(m,am,aB)}function V(bd,be){if(bd=="variable"){return aq(bd,be)}return af(bd,be)}function aq(bd,be){if(bd=="variable"){aW(be);return aD(af)}}function af(bd,be){if(be=="<"){return aD(a5(">"),aS(s,">"),l,af)}if(be=="extends"||be=="implements"||(j&&bd==",")){if(be=="implements"){Q.marked="keyword"}return aD(j?n:aM,af)}if(bd=="{"){return aD(a5("}"),B,l)}}function B(bd,be){if(bd=="async"||(bd=="variable"&&(be=="static"||be=="get"||be=="set"||(j&&aJ(be)))&&Q.stream.match(/^\s+[\w$\xa1-\uffff]/,false))){Q.marked="keyword";return aD(B)}if(bd=="variable"||Q.style=="keyword"){Q.marked="property";return aD(j?bb:ab,B)}if(bd=="number"||bd=="string"){return aD(j?bb:ab,B)}if(bd=="["){return aD(aM,am,E("]"),j?bb:ab,B)}if(be=="*"){Q.marked="keyword";return aD(B)}if(j&&bd=="("){return ay(bc,B)}if(bd==";"||bd==","){return aD(B)}if(bd=="}"){return aD()}if(be=="@"){return aD(aM,B)}}function bb(be,bg){if(bg=="?"){return aD(bb)}if(be==":"){return aD(n,aB)}if(bg=="="){return aD(a4)}var bd=Q.state.lexical.prev,bf=bd&&bd.info=="interface";return ay(bf?bc:ab)}function a6(bd,be){if(be=="*"){Q.marked="keyword";return aD(aG,E(";"))}if(be=="default"){Q.marked="keyword";return aD(aM,E(";"))}if(bd=="{"){return aD(aS(aF,"}"),aG,E(";"))}return ay(a7)}function aF(bd,be){if(be=="as"){Q.marked="keyword";return aD(E("variable"))}if(bd=="variable"){return ay(a4,aF)}}function aE(bd){if(bd=="string"){return aD()}if(bd=="("){return ay(aM)}return ay(aP,r,aG)}function aP(bd,be){if(bd=="{"){return aY(aP,"}")}if(bd=="variable"){aW(be)}if(be=="*"){Q.marked="keyword"}return aD(q)}function r(bd){if(bd==","){return aD(aP,r)}}function q(bd,be){if(be=="as"){Q.marked="keyword";return aD(aP)}}function aG(bd,be){if(be=="from"){Q.marked="keyword";return aD(aM)}}function x(bd){if(bd=="]"){return aD()}return ay(aS(a4,"]"))}function aU(){return ay(a5("form"),m,E("{"),a5("}"),aS(aZ,"}"),l,l)}function aZ(){return ay(m,aB)}function aO(be,bd){return be.lastType=="operator"||be.lastType==","||ag.test(bd.charAt(0))||/[,.]/.test(bd.charAt(0))}function a9(bf,be,bd){return be.tokenize==an&&/^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\[{}\(,;:]|=>)$/.test(be.lastType)||(be.lastType=="quasi"&&/\{\s*$/.test(bf.string.slice(0,bf.pos-(bd||0))))}return{startState:function(be){var bd={tokenize:an,lastType:"sof",cc:[],lexical:new Y((be||0)-u,0,"block",false),localVars:aI.localVars,context:aI.localVars&&new X(null,null,false),indented:be||0};if(aI.globalVars&&typeof aI.globalVars=="object"){bd.globalVars=aI.globalVars}return bd},token:function(bf,be){if(bf.sol()){if(!be.lexical.hasOwnProperty("align")){be.lexical.align=false}be.indented=bf.indentation();aX(bf,be)}if(be.tokenize!=a0&&bf.eatSpace()){return null}var bd=be.tokenize(bf,be);if(al=="comment"){return bd}be.lastType=al=="operator"&&(S=="++"||S=="--")?"incdec":al;return g(be,bd,al,S,bf)},indent:function(bd,bg){if(bd.tokenize==a0){return a.Pass}if(bd.tokenize!=an){return 0}var bk=bg&&bg.charAt(0),bl=bd.lexical,bj;if(!/^\s*else\b/.test(bg)){for(var bf=bd.cc.length-1;bf>=0;--bf){var bh=bd.cc[bf];if(bh==l){bl=bl.prev}else{if(bh!=d){break}}}}while((bl.type=="stat"||bl.type=="form")&&(bk=="}"||((bj=bd.cc[bd.cc.length-1])&&(bj==aA||bj==o)&&!/^[,\.=+\-*:?[\(]/.test(bg)))){bl=bl.prev}if(N&&bl.type==")"&&bl.prev.type=="stat"){bl=bl.prev}var bi=bl.type,be=bk==bi;if(bi=="vardef"){return bl.indented+(bd.lastType=="operator"||bd.lastType==","?bl.info.length+1:0)}else{if(bi=="form"&&bk=="{"){return bl.indented}else{if(bi=="form"){return bl.indented+u}else{if(bi=="stat"){return bl.indented+(aO(bd,bg)?N||u:0)}else{if(bl.info=="switch"&&!be&&aI.doubleIndentSwitch!=false){return bl.indented+(/^(?:case|default)\b/.test(bg)?u:2*u)}else{if(bl.align){return bl.column+(be?0:1)}else{return bl.indented+(be?0:u)}}}}}}},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:L?null:"/*",blockCommentEnd:L?null:"*/",blockCommentContinue:L?null:" * ",lineComment:L?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:L?"json":"javascript",jsonldMode:a1,jsonMode:L,expressionAllowed:a9,skipExpression:function(bd){var be=bd.cc[bd.cc.length-1];if(be==aM||be==a4){bd.cc.pop()}}}});a.registerHelper("wordChars","javascript",/[\w$]/);a.defineMIME("text/javascript","javascript");a.defineMIME("text/ecmascript","javascript");a.defineMIME("application/javascript","javascript");a.defineMIME("application/x-javascript","javascript");a.defineMIME("application/ecmascript","javascript");a.defineMIME("application/json",{name:"javascript",json:true});a.defineMIME("application/x-json",{name:"javascript",json:true});a.defineMIME("application/ld+json",{name:"javascript",jsonld:true});a.defineMIME("text/typescript",{name:"javascript",typescript:true});a.defineMIME("application/typescript",{name:"javascript",typescript:true})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){var b={autoSelfClosers:{area:true,base:true,br:true,col:true,command:true,embed:true,frame:true,hr:true,img:true,input:true,keygen:true,link:true,meta:true,param:true,source:true,track:true,wbr:true,menuitem:true},implicitlyClosed:{dd:true,li:true,optgroup:true,option:true,p:true,rp:true,rt:true,tbody:true,td:true,tfoot:true,th:true,tr:true},contextGrabbers:{dd:{dd:true,dt:true},dt:{dd:true,dt:true},li:{li:true},option:{option:true,optgroup:true},optgroup:{optgroup:true},p:{address:true,article:true,aside:true,blockquote:true,dir:true,div:true,dl:true,fieldset:true,footer:true,form:true,h1:true,h2:true,h3:true,h4:true,h5:true,h6:true,header:true,hgroup:true,hr:true,menu:true,nav:true,ol:true,p:true,pre:true,section:true,table:true,ul:true},rp:{rp:true,rt:true},rt:{rp:true,rt:true},tbody:{tbody:true,tfoot:true},td:{td:true,th:true},tfoot:{tbody:true},th:{td:true,th:true},thead:{tbody:true,tfoot:true},tr:{tr:true}},doNotIndent:{pre:true},allowUnquoted:true,allowMissing:true,caseFold:true};var c={autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:false,allowMissing:false,allowMissingTagName:false,caseFold:false};a.defineMode("xml",function(q,G){var x=q.indentUnit;var H={};var o=G.htmlMode?b:c;for(var f in o){H[f]=o[f]}for(var f in G){H[f]=G[f]}var g,j;function u(O,N){function L(P){N.tokenize=P;return P(O,N)}var M=O.next();if(M=="<"){if(O.eat("!")){if(O.eat("[")){if(O.match("CDATA[")){return L(F("atom","]]>"))}else{return null}}else{if(O.match("--")){return L(F("comment","-->"))}else{if(O.match("DOCTYPE",true,true)){O.eatWhile(/[\w\._\-]/);return L(I(1))}else{return null}}}}else{if(O.eat("?")){O.eatWhile(/[\w\._\-]/);N.tokenize=F("meta","?>");return"meta"}else{g=O.eat("/")?"closeTag":"openTag";N.tokenize=s;return"tag bracket"}}}else{if(M=="&"){var K;if(O.eat("#")){if(O.eat("x")){K=O.eatWhile(/[a-fA-F\d]/)&&O.eat(";")}else{K=O.eatWhile(/[\d]/)&&O.eat(";")}}else{K=O.eatWhile(/[\w\.\-:]/)&&O.eat(";")}return K?"atom":"error"}else{O.eatWhile(/[^&<]/);return null}}}u.isInText=true;function s(N,M){var L=N.next();if(L==">"||(L=="/"&&N.eat(">"))){M.tokenize=u;g=L==">"?"endTag":"selfcloseTag";return"tag bracket"}else{if(L=="="){g="equals";return null}else{if(L=="<"){M.tokenize=u;M.state=r;M.tagName=M.tagStart=null;var K=M.tokenize(N,M);return K?K+" tag error":"tag error"}else{if(/[\'\"]/.test(L)){M.tokenize=n(L);M.stringStartCol=N.column();return M.tokenize(N,M)}else{N.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/);return"word"}}}}}function n(K){var L=function(N,M){while(!N.eol()){if(N.next()==K){M.tokenize=s;break}}return"string"};L.isInAttribute=true;return L}function F(L,K){return function(N,M){while(!N.eol()){if(N.match(K)){M.tokenize=u;break}N.next()}return L}}function I(K){return function(N,M){var L;while((L=N.next())!=null){if(L=="<"){M.tokenize=I(K+1);return M.tokenize(N,M)}else{if(L==">"){if(K==1){M.tokenize=u;break}else{M.tokenize=I(K-1);return M.tokenize(N,M)}}}}return"meta"}}function B(L,K,M){this.prev=L.context;this.tagName=K;this.indent=L.indented;this.startOfLine=M;if(H.doNotIndent.hasOwnProperty(K)||(L.context&&L.context.noIndent)){this.noIndent=true}}function E(K){if(K.context){K.context=K.context.prev}}function A(M,L){var K;while(true){if(!M.context){return}K=M.context.tagName;if(!H.contextGrabbers.hasOwnProperty(K)||!H.contextGrabbers[K].hasOwnProperty(L)){return}E(M)}}function r(K,M,L){if(K=="openTag"){L.tagStart=M.column();return d}else{if(K=="closeTag"){return D}else{return r}}}function d(K,M,L){if(K=="word"){L.tagName=M.current();j="tag";return e}else{if(H.allowMissingTagName&&K=="endTag"){j="tag bracket";return e(K,M,L)}else{j="error";return d}}}function D(L,N,M){if(L=="word"){var K=N.current();if(M.context&&M.context.tagName!=K&&H.implicitlyClosed.hasOwnProperty(M.context.tagName)){E(M)}if((M.context&&M.context.tagName==K)||H.matchClosing===false){j="tag";return C}else{j="tag error";return J}}else{if(H.allowMissingTagName&&L=="endTag"){j="tag bracket";return C(L,N,M)}else{j="error";return J}}}function C(L,K,M){if(L!="endTag"){j="error";return C}E(M);return r}function J(K,M,L){j="error";return C(K,M,L)}function e(N,L,O){if(N=="word"){j="attribute";return m}else{if(N=="endTag"||N=="selfcloseTag"){var M=O.tagName,K=O.tagStart;O.tagName=O.tagStart=null;if(N=="selfcloseTag"||H.autoSelfClosers.hasOwnProperty(M)){A(O,M)}else{A(O,M);O.context=new B(O,M,K==O.indented)}return r}}j="error";return e}function m(K,M,L){if(K=="equals"){return w}if(!H.allowMissing){j="error"}return e(K,M,L)}function w(K,M,L){if(K=="string"){return l}if(K=="word"&&H.allowUnquoted){j="string";return e}j="error";return e(K,M,L)}function l(K,M,L){if(K=="string"){return l}return e(K,M,L)}return{startState:function(K){var L={tokenize:u,state:r,indented:K||0,tagName:null,tagStart:null,context:null};if(K!=null){L.baseIndent=K}return L},token:function(M,L){if(!L.tagName&&M.sol()){L.indented=M.indentation()}if(M.eatSpace()){return null}g=null;var K=L.tokenize(M,L);if((K||g)&&K!="comment"){j=null;L.state=L.state(g||K,M,L);if(j){K=j=="error"?K+" error":j}}return K},indent:function(P,L,O){var N=P.context;if(P.tokenize.isInAttribute){if(P.tagStart==P.indented){return P.stringStartCol+1}else{return P.indented+x}}if(N&&N.noIndent){return a.Pass}if(P.tokenize!=s&&P.tokenize!=u){return O?O.match(/^(\s*)/)[0].length:0}if(P.tagName){if(H.multilineTagIndentPastTag!==false){return P.tagStart+P.tagName.length+2}else{return P.tagStart+x*(H.multilineTagIndentFactor||1)}}if(H.alignCDATA&&/<!\[CDATA\[/.test(L)){return 0}var K=L&&/^<(\/)?([\w_:\.-]*)/.exec(L);if(K&&K[1]){while(N){if(N.tagName==K[2]){N=N.prev;break}else{if(H.implicitlyClosed.hasOwnProperty(N.tagName)){N=N.prev}else{break}}}}else{if(K){while(N){var M=H.contextGrabbers[N.tagName];if(M&&M.hasOwnProperty(K[2])){N=N.prev}else{break}}}}while(N&&N.prev&&!N.startOfLine){N=N.prev}if(N){return N.indent+x}else{return P.baseIndent||0}},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"<!--",blockCommentEnd:"-->",configuration:H.htmlMode?"html":"xml",helperType:H.htmlMode?"html":"xml",skipAttribute:function(K){if(K.state==w){K.state=e}}}});a.defineMIME("text/xml","xml");a.defineMIME("application/xml","xml");if(!a.mimeModes.hasOwnProperty("text/html")){a.defineMIME("text/html",{name:"xml",htmlMode:true})}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(x){x.defineMode("css",function(ah,R){var L=R.inline;if(!R.propertyKeywords){R=x.resolveMode("text/css")}var Y=ah.indentUnit,I=R.tokenHooks,G=R.documentTypes||{},ag=R.mediaTypes||{},T=R.mediaFeatures||{},X=R.mediaValueKeywords||{},Q=R.propertyKeywords||{},J=R.nonStandardPropertyKeywords||{},M=R.fontProperties||{},af=R.counterDescriptors||{},W=R.colorKeywords||{},ab=R.valueKeywords||{},U=R.allowNested,aa=R.lineComment,ad=R.supportsAtComponent===true;var K,V;function ai(al,am){K=am;return al}function ak(ao,an){var am=ao.next();if(I[am]){var al=I[am](ao,an);if(al!==false){return al}}if(am=="@"){ao.eatWhile(/[\w\\\-]/);return ai("def",ao.current())}else{if(am=="="||(am=="~"||am=="|")&&ao.eat("=")){return ai(null,"compare")}else{if(am=='"'||am=="'"){an.tokenize=S(am);return an.tokenize(ao,an)}else{if(am=="#"){ao.eatWhile(/[\w\\\-]/);return ai("atom","hash")}else{if(am=="!"){ao.match(/^\s*\w*/);return ai("keyword","important")}else{if(/\d/.test(am)||am=="."&&ao.eat(/\d/)){ao.eatWhile(/[\w.%]/);return ai("number","unit")}else{if(am==="-"){if(/[\d.]/.test(ao.peek())){ao.eatWhile(/[\w.%]/);return ai("number","unit")}else{if(ao.match(/^-[\w\\\-]*/)){ao.eatWhile(/[\w\\\-]/);if(ao.match(/^\s*:/,false)){return ai("variable-2","variable-definition")}return ai("variable-2","variable")}else{if(ao.match(/^\w+-/)){return ai("meta","meta")}}}}else{if(/[,+>*\/]/.test(am)){return ai(null,"select-op")}else{if(am=="."&&ao.match(/^-?[_a-z][_a-z0-9-]*/i)){return ai("qualifier","qualifier")}else{if(/[:;{}\[\]\(\)]/.test(am)){return ai(null,am)}else{if(ao.match(/[\w-.]+(?=\()/)){if(/^(url(-prefix)?|domain|regexp)$/.test(ao.current().toLowerCase())){an.tokenize=aj}return ai("variable callee","variable")}else{if(/[\w\\\-]/.test(am)){ao.eatWhile(/[\w\\\-]/);return ai("property","word")}else{return ai(null,null)}}}}}}}}}}}}}function S(al){return function(ap,an){var ao=false,am;while((am=ap.next())!=null){if(am==al&&!ao){if(al==")"){ap.backUp(1)}break}ao=!ao&&am=="\\"}if(am==al||!ao&&al!=")"){an.tokenize=null}return ai("string","string")}}function aj(am,al){am.next();if(!am.match(/\s*[\"\')]/,false)){al.tokenize=S(")")}else{al.tokenize=null}return ai(null,"(")}function Z(am,al,an){this.type=am;this.indent=al;this.prev=an}function O(an,ao,am,al){an.context=new Z(am,ao.indentation()+(al===false?0:Y),an.context);return am}function ac(al){if(al.context.prev){al.context=al.context.prev}return al.context.type}function H(al,an,am){return N[am.context.type](al,an,am)}function ae(am,ao,an,ap){for(var al=ap||1;al>0;al--){an.context=an.context.prev}return H(am,ao,an)}function P(am){var al=am.current().toLowerCase();if(ab.hasOwnProperty(al)){V="atom"}else{if(W.hasOwnProperty(al)){V="keyword"}else{V="variable"}}}var N={};N.top=function(al,an,am){if(al=="{"){return O(am,an,"block")}else{if(al=="}"&&am.context.prev){return ac(am)}else{if(ad&&/@component/i.test(al)){return O(am,an,"atComponentBlock")}else{if(/^@(-moz-)?document$/i.test(al)){return O(am,an,"documentTypes")}else{if(/^@(media|supports|(-moz-)?document|import)$/i.test(al)){return O(am,an,"atBlock")}else{if(/^@(font-face|counter-style)/i.test(al)){am.stateArg=al;return"restricted_atBlock_before"}else{if(/^@(-(moz|ms|o|webkit)-)?keyframes$/i.test(al)){return"keyframes"}else{if(al&&al.charAt(0)=="@"){return O(am,an,"at")}else{if(al=="hash"){V="builtin"}else{if(al=="word"){V="tag"}else{if(al=="variable-definition"){return"maybeprop"}else{if(al=="interpolation"){return O(am,an,"interpolation")}else{if(al==":"){return"pseudo"}else{if(U&&al=="("){return O(am,an,"parens")}}}}}}}}}}}}}}return am.context.type};N.block=function(al,ao,am){if(al=="word"){var an=ao.current().toLowerCase();if(Q.hasOwnProperty(an)){V="property";return"maybeprop"}else{if(J.hasOwnProperty(an)){V="string-2";return"maybeprop"}else{if(U){V=ao.match(/^\s*:(?:\s|$)/,false)?"property":"tag";return"block"}else{V+=" error";return"maybeprop"}}}}else{if(al=="meta"){return"block"}else{if(!U&&(al=="hash"||al=="qualifier")){V="error";return"block"}else{return N.top(al,ao,am)}}}};N.maybeprop=function(al,an,am){if(al==":"){return O(am,an,"prop")}return H(al,an,am)};N.prop=function(al,an,am){if(al==";"){return ac(am)}if(al=="{"&&U){return O(am,an,"propBlock")}if(al=="}"||al=="{"){return ae(al,an,am)}if(al=="("){return O(am,an,"parens")}if(al=="hash"&&!/^#([0-9a-fA-f]{3,4}|[0-9a-fA-f]{6}|[0-9a-fA-f]{8})$/.test(an.current())){V+=" error"}else{if(al=="word"){P(an)}else{if(al=="interpolation"){return O(am,an,"interpolation")}}}return"prop"};N.propBlock=function(am,al,an){if(am=="}"){return ac(an)}if(am=="word"){V="property";return"maybeprop"}return an.context.type};N.parens=function(al,an,am){if(al=="{"||al=="}"){return ae(al,an,am)}if(al==")"){return ac(am)}if(al=="("){return O(am,an,"parens")}if(al=="interpolation"){return O(am,an,"interpolation")}if(al=="word"){P(an)}return"parens"};N.pseudo=function(al,an,am){if(al=="meta"){return"pseudo"}if(al=="word"){V="variable-3";return am.context.type}return H(al,an,am)};N.documentTypes=function(al,an,am){if(al=="word"&&G.hasOwnProperty(an.current())){V="tag";return am.context.type}else{return N.atBlock(al,an,am)}};N.atBlock=function(al,ao,am){if(al=="("){return O(am,ao,"atBlock_parens")}if(al=="}"||al==";"){return ae(al,ao,am)}if(al=="{"){return ac(am)&&O(am,ao,U?"block":"top")}if(al=="interpolation"){return O(am,ao,"interpolation")}if(al=="word"){var an=ao.current().toLowerCase();if(an=="only"||an=="not"||an=="and"||an=="or"){V="keyword"}else{if(ag.hasOwnProperty(an)){V="attribute"}else{if(T.hasOwnProperty(an)){V="property"}else{if(X.hasOwnProperty(an)){V="keyword"}else{if(Q.hasOwnProperty(an)){V="property"}else{if(J.hasOwnProperty(an)){V="string-2"}else{if(ab.hasOwnProperty(an)){V="atom"}else{if(W.hasOwnProperty(an)){V="keyword"}else{V="error"}}}}}}}}}return am.context.type};N.atComponentBlock=function(al,an,am){if(al=="}"){return ae(al,an,am)}if(al=="{"){return ac(am)&&O(am,an,U?"block":"top",false)}if(al=="word"){V="error"}return am.context.type};N.atBlock_parens=function(al,an,am){if(al==")"){return ac(am)}if(al=="{"||al=="}"){return ae(al,an,am,2)}return N.atBlock(al,an,am)};N.restricted_atBlock_before=function(al,an,am){if(al=="{"){return O(am,an,"restricted_atBlock")}if(al=="word"&&am.stateArg=="@counter-style"){V="variable";return"restricted_atBlock_before"}return H(al,an,am)};N.restricted_atBlock=function(al,an,am){if(al=="}"){am.stateArg=null;return ac(am)}if(al=="word"){if((am.stateArg=="@font-face"&&!M.hasOwnProperty(an.current().toLowerCase()))||(am.stateArg=="@counter-style"&&!af.hasOwnProperty(an.current().toLowerCase()))){V="error"}else{V="property"}return"maybeprop"}return"restricted_atBlock"};N.keyframes=function(al,an,am){if(al=="word"){V="variable";return"keyframes"}if(al=="{"){return O(am,an,"top")}return H(al,an,am)};N.at=function(al,an,am){if(al==";"){return ac(am)}if(al=="{"||al=="}"){return ae(al,an,am)}if(al=="word"){V="tag"}else{if(al=="hash"){V="builtin"}}return"at"};N.interpolation=function(al,an,am){if(al=="}"){return ac(am)}if(al=="{"||al==";"){return ae(al,an,am)}if(al=="word"){V="variable"}else{if(al!="variable"&&al!="("&&al!=")"){V="error"}}return"interpolation"};return{startState:function(al){return{tokenize:null,state:L?"block":"top",stateArg:null,context:new Z(L?"block":"top",al||0,null)}},token:function(an,am){if(!am.tokenize&&an.eatSpace()){return null}var al=(am.tokenize||ak)(an,am);if(al&&typeof al=="object"){K=al[1];al=al[0]}V=al;if(K!="comment"){am.state=N[am.state](K,an,am)}return V},indent:function(ap,an){var am=ap.context,ao=an&&an.charAt(0);var al=am.indent;if(am.type=="prop"&&(ao=="}"||ao==")")){am=am.prev}if(am.prev){if(ao=="}"&&(am.type=="block"||am.type=="top"||am.type=="interpolation"||am.type=="restricted_atBlock")){am=am.prev;al=am.indent}else{if(ao==")"&&(am.type=="parens"||am.type=="atBlock_parens")||ao=="{"&&(am.type=="at"||am.type=="atBlock")){al=Math.max(0,am.indent-Y)}}}return al},electricChars:"}",blockCommentStart:"/*",blockCommentEnd:"*/",blockCommentContinue:" * ",lineComment:aa,fold:"brace"}});function g(I){var H={};for(var G=0;G<I.length;++G){H[I[G].toLowerCase()]=true}return H}var n=["domain","regexp","url","url-prefix"],a=g(n);var b=["all","aural","braille","handheld","print","projection","screen","tty","tv","embossed"],D=g(b);var F=["width","min-width","max-width","height","min-height","max-height","device-width","min-device-width","max-device-width","device-height","min-device-height","max-device-height","aspect-ratio","min-aspect-ratio","max-aspect-ratio","device-aspect-ratio","min-device-aspect-ratio","max-device-aspect-ratio","color","min-color","max-color","color-index","min-color-index","max-color-index","monochrome","min-monochrome","max-monochrome","resolution","min-resolution","max-resolution","scan","grid","orientation","device-pixel-ratio","min-device-pixel-ratio","max-device-pixel-ratio","pointer","any-pointer","hover","any-hover"],l=g(F);var o=["landscape","portrait","none","coarse","fine","on-demand","hover","interlace","progressive"],u=g(o);var d=["align-content","align-items","align-self","alignment-adjust","alignment-baseline","anchor-point","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","azimuth","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","baseline-shift","binding","bleed","bookmark-label","bookmark-level","bookmark-state","bookmark-target","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","color","color-profile","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","content","counter-increment","counter-reset","crop","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","drop-initial-after-adjust","drop-initial-after-align","drop-initial-before-adjust","drop-initial-before-align","drop-initial-size","drop-initial-value","elevation","empty-cells","fit","fit-position","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","float-offset","flow-from","flow-into","font","font-feature-settings","font-family","font-kerning","font-language-override","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-weight","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-gap","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-gap","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","inline-box-align","justify-content","justify-items","justify-self","left","letter-spacing","line-break","line-height","line-stacking","line-stacking-ruby","line-stacking-shift","line-stacking-strategy","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marks","marquee-direction","marquee-loop","marquee-play-count","marquee-speed","marquee-style","max-height","max-width","min-height","min-width","mix-blend-mode","move-to","nav-down","nav-index","nav-left","nav-right","nav-up","object-fit","object-position","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-style","overflow-wrap","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","page-policy","pause","pause-after","pause-before","perspective","perspective-origin","pitch","pitch-range","place-content","place-items","place-self","play-during","position","presentation-level","punctuation-trim","quotes","region-break-after","region-break-before","region-break-inside","region-fragment","rendering-intent","resize","rest","rest-after","rest-before","richness","right","rotation","rotation-point","ruby-align","ruby-overhang","ruby-position","ruby-span","shape-image-threshold","shape-inside","shape-margin","shape-outside","size","speak","speak-as","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","string-set","tab-size","table-layout","target","target-name","target-new","target-position","text-align","text-align-last","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-height","text-indent","text-justify","text-outline","text-overflow","text-shadow","text-size-adjust","text-space-collapse","text-transform","text-underline-position","text-wrap","top","transform","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","unicode-bidi","user-select","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","volume","white-space","widows","width","will-change","word-break","word-spacing","word-wrap","z-index","clip-path","clip-rule","mask","enable-background","filter","flood-color","flood-opacity","lighting-color","stop-color","stop-opacity","pointer-events","color-interpolation","color-interpolation-filters","color-rendering","fill","fill-opacity","fill-rule","image-rendering","marker","marker-end","marker-mid","marker-start","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-rendering","baseline-shift","dominant-baseline","glyph-orientation-horizontal","glyph-orientation-vertical","text-anchor","writing-mode"],j=g(d);var r=["scrollbar-arrow-color","scrollbar-base-color","scrollbar-dark-shadow-color","scrollbar-face-color","scrollbar-highlight-color","scrollbar-shadow-color","scrollbar-3d-light-color","scrollbar-track-color","shape-inside","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","zoom"],e=g(r);var B=["font-family","src","unicode-range","font-variant","font-feature-settings","font-stretch","font-weight","font-style"],f=g(B);var w=["additive-symbols","fallback","negative","pad","prefix","range","speak-as","suffix","symbols","system"],C=g(w);var c=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],q=g(c);var m=["above","absolute","activeborder","additive","activecaption","afar","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","amharic","amharic-abegede","antialiased","appworkspace","arabic-indic","armenian","asterisks","attr","auto","auto-flow","avoid","avoid-column","avoid-page","avoid-region","background","backwards","baseline","below","bidi-override","binary","bengali","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","cambodian","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","cjk-earthly-branch","cjk-heavenly-stem","cjk-ideographic","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","contain","content","contents","content-box","context-menu","continuous","copy","counter","counters","cover","crop","itjds","itjdshair","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","dense","destination-atop","destination-in","destination-out","destination-over","devanagari","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic","ethiopic-abegede","ethiopic-abegede-am-et","ethiopic-abegede-gez","ethiopic-abegede-ti-er","ethiopic-abegede-ti-et","ethiopic-halehame-aa-er","ethiopic-halehame-aa-et","ethiopic-halehame-am-et","ethiopic-halehame-gez","ethiopic-halehame-om-et","ethiopic-halehame-sid-et","ethiopic-halehame-so-et","ethiopic-halehame-ti-er","ethiopic-halehame-ti-et","ethiopic-halehame-tig","ethiopic-numeric","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","georgian","graytext","grid","groove","gujarati","gurmukhi","hand","hangul","hangul-consonant","hard-light","hebrew","help","hidden","hide","higher","highlight","highlighttext","hiragana","hiragana-iroha","horizontal","hsl","hsla","hue","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-grid","inline-table","inset","inside","intrinsic","invert","italic","japanese-formal","japanese-informal","justify","kannada","katakana","katakana-iroha","keep-all","khmer","korean-hangul-formal","korean-hanja-formal","korean-hanja-informal","landscape","lao","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-alpha","lower-armenian","lower-greek","lower-hexadecimal","lower-latin","lower-norwegian","lower-roman","lowercase","ltr","luminosity","malayalam","match","matrix","matrix3d","media-controls-background","media-current-time-display","media-fullscreen-button","media-mute-button","media-play-button","media-return-to-realtime-button","media-rewind-button","media-seek-back-button","media-seek-forward-button","media-slider","media-sliderthumb","media-time-remaining-display","media-volume-slider","media-volume-slider-container","media-volume-sliderthumb","medium","menu","menulist","menulist-button","menulist-text","menulist-textfield","menutext","message-box","middle","min-intrinsic","mix","mongolian","monospace","move","multiple","multiply","myanmar","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","octal","opacity","open-quote","optimizeLegibility","optimizeSpeed","oriya","oromo","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","persian","perspective","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","scroll-position","se-resize","searchfield","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","self-start","self-end","semi-condensed","semi-expanded","separate","serif","show","sidama","simp-chinese-formal","simp-chinese-informal","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","somali","source-atop","source-in","source-out","source-over","space","space-around","space-between","space-evenly","spell-out","square","square-button","start","static","status-bar","stretch","stroke","sub","subpixel-antialiased","super","sw-resize","symbolic","symbols","system-ui","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","tamil","telugu","text","text-bottom","text-top","textarea","textfield","thai","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","tibetan","tigre","tigrinya-er","tigrinya-er-abegede","tigrinya-et","tigrinya-et-abegede","to","top","trad-chinese-formal","trad-chinese-informal","transform","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","unset","up","upper-alpha","upper-armenian","upper-greek","upper-hexadecimal","upper-latin","upper-norwegian","upper-roman","uppercase","urdu","url","var","vertical","vertical-text","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"],A=g(m);var s=n.concat(b).concat(F).concat(o).concat(d).concat(r).concat(c).concat(m);x.registerHelper("hintWords","css",s);function E(J,I){var G=false,H;while((H=J.next())!=null){if(G&&H=="/"){I.tokenize=null;break}G=(H=="*")}return["comment","comment"]}x.defineMIME("text/css",{documentTypes:a,mediaTypes:D,mediaFeatures:l,mediaValueKeywords:u,propertyKeywords:j,nonStandardPropertyKeywords:e,fontProperties:f,counterDescriptors:C,colorKeywords:q,valueKeywords:A,tokenHooks:{"/":function(H,G){if(!H.eat("*")){return false}G.tokenize=E;return E(H,G)}},name:"css"});x.defineMIME("text/x-scss",{mediaTypes:D,mediaFeatures:l,mediaValueKeywords:u,propertyKeywords:j,nonStandardPropertyKeywords:e,colorKeywords:q,valueKeywords:A,fontProperties:f,allowNested:true,lineComment:"//",tokenHooks:{"/":function(H,G){if(H.eat("/")){H.skipToEnd();return["comment","comment"]}else{if(H.eat("*")){G.tokenize=E;return E(H,G)}else{return["operator","operator"]}}},":":function(G){if(G.match(/\s*\{/,false)){return[null,null]}return false},"$":function(G){G.match(/^[\w-]+/);if(G.match(/^\s*:/,false)){return["variable-2","variable-definition"]}return["variable-2","variable"]},"#":function(G){if(!G.eat("{")){return false}return[null,"interpolation"]}},name:"css",helperType:"scss"});x.defineMIME("text/x-less",{mediaTypes:D,mediaFeatures:l,mediaValueKeywords:u,propertyKeywords:j,nonStandardPropertyKeywords:e,colorKeywords:q,valueKeywords:A,fontProperties:f,allowNested:true,lineComment:"//",tokenHooks:{"/":function(H,G){if(H.eat("/")){H.skipToEnd();return["comment","comment"]}else{if(H.eat("*")){G.tokenize=E;return E(H,G)}else{return["operator","operator"]}}},"@":function(G){if(G.eat("{")){return[null,"interpolation"]}if(G.match(/^(charset|document|font-face|import|(-(moz|ms|o|webkit)-)?keyframes|media|namespace|page|supports)\b/i,false)){return false}G.eatWhile(/[\w\\\-]/);if(G.match(/^\s*:/,false)){return["variable-2","variable-definition"]}return["variable-2","variable"]},"&":function(){return["atom","atom"]}},name:"css",helperType:"less"});x.defineMIME("text/x-gss",{documentTypes:a,mediaTypes:D,mediaFeatures:l,propertyKeywords:j,nonStandardPropertyKeywords:e,fontProperties:f,counterDescriptors:C,colorKeywords:q,valueKeywords:A,supportsAtComponent:true,tokenHooks:{"/":function(H,G){if(!H.eat("*")){return false}G.tokenize=E;return E(H,G)}},name:"css",helperType:"gss"})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript"),require("../css/css"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","../xml/xml","../javascript/javascript","../css/css"],a)}else{a(CodeMirror)}}})(function(d){var g={script:[["lang",/(javascript|babel)/i,"javascript"],["type",/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^module$|^$/i,"javascript"],["type",/./,"text/plain"],[null,null,"javascript"]],style:[["lang",/^css$/i,"css"],["type",/^(text\/)?(x-)?(stylesheet|css)$/i,"css"],["type",/./,"text/plain"],[null,null,"css"]]};function f(r,m,n){var q=r.current(),o=q.search(m);if(o>-1){r.backUp(q.length-o)}else{if(q.match(/<\/?$/)){r.backUp(q.length);if(!r.match(m,false)){r.match(q)}}}return n}var e={};function c(m){var n=e[m];if(n){return n}return e[m]=new RegExp("\\s+"+m+"\\s*=\\s*('|\")?([^'\"]+)('|\")?\\s*")}function a(o,m){var n=o.match(c(m));return n?/^\s*(.*?)\s*$/.exec(n[2])[1]:""}function l(n,m){return new RegExp((m?"^":"")+"</s*"+n+"s*>","i")}function j(s,r){for(var m in s){var n=r[m]||(r[m]=[]);var q=s[m];for(var o=q.length-1;o>=0;o--){n.unshift(q[o])}}}function b(o,q){for(var n=0;n<o.length;n++){var m=o[n];if(!m[0]||m[1].test(a(q,m[0]))){return m[2]}}}d.defineMode("htmlmixed",function(n,s){var w=d.getMode(n,{name:"xml",htmlMode:true,multilineTagIndentFactor:s.multilineTagIndentFactor,multilineTagIndentPastTag:s.multilineTagIndentPastTag});var m={};var u=s&&s.tags,r=s&&s.scriptTypes;j(g,m);if(u){j(u,m)}if(r){for(var q=r.length-1;q>=0;q--){m.script.unshift(["type",r[q].matches,r[q].mode])}}function o(H,x){var A=w.token(H,x.htmlState),I=/\btag\b/.test(A),C;if(I&&!/[<>\s\/]/.test(H.current())&&(C=x.htmlState.tagName&&x.htmlState.tagName.toLowerCase())&&m.hasOwnProperty(C)){x.inTag=C+" "}else{if(x.inTag&&I&&/>$/.test(H.current())){var B=/^([\S]+) (.*)/.exec(x.inTag);x.inTag=null;var G=H.current()==">"&&b(m[B[1]],B[2]);var F=d.getMode(n,G);var E=l(B[1],true),D=l(B[1],false);x.token=function(K,J){if(K.match(E,false)){J.token=o;J.localState=J.localMode=null;return null}return f(K,D,J.localMode.token(K,J.localState))};x.localMode=F;x.localState=d.startState(F,w.indent(x.htmlState,"",""))}else{if(x.inTag){x.inTag+=H.current();if(H.eol()){x.inTag+=" "}}}}return A}return{startState:function(){var x=d.startState(w);return{token:o,inTag:null,localMode:null,localState:null,htmlState:x}},copyState:function(A){var x;if(A.localState){x=d.copyState(A.localMode,A.localState)}return{token:A.token,inTag:A.inTag,localMode:A.localMode,localState:x,htmlState:d.copyState(w,A.htmlState)}},token:function(A,x){return x.token(A,x)},indent:function(B,A,x){if(!B.localMode||/^\s*<\//.test(A)){return w.indent(B.htmlState,A,x)}else{if(B.localMode.indent){return B.localMode.indent(B.localState,A,x)}else{return d.Pass}}},innerMode:function(x){return{state:x.localState||x.htmlState,mode:x.localMode||w}}}},"xml","javascript","css");d.defineMIME("text/html","htmlmixed")});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.modeInfo=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-encrypted","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["asc","pgp","sig"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h","ino"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:["cpp","c++","cc","cxx","hpp","h++","hh","hxx"],alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mimes:["application/vnd.coffeescript","text/coffeescript","text/x-coffeescript"],mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"]},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Esper",mime:"text/x-esper",mode:"sql"},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90","f95"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"EDRScript",mime:"text/x-edrscript",mode:"edrscript",ext:["edrscript"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm","handlebars","hbs"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"javascript",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"text/jinja2",mode:"jinja2",ext:["j2","jinja","jinja2"]},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective-C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mimes:["text/x-php","application/x-httpd-php","application/x-httpd-php-open"],mode:"php",ext:["php","php3","php4","php5","php7","phtml"]},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:["txt","text","conf","def","list","log"]},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mimes:["text/x-sh","application/x-sh"],mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD$/},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"SML",mime:"text/x-sml",mode:"mllike",ext:["sml","sig","fun","smackspec"]},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx","tex"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v","sv","svh"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:["1","2","3","4","5","6","7","8","9"]},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];for(var b=0;b<a.modeInfo.length;b++){var c=a.modeInfo[b];if(c.mimes){c.mime=c.mimes[0]}}a.findModeByMIME=function(f){f=f.toLowerCase();for(var e=0;e<a.modeInfo.length;e++){var g=a.modeInfo[e];if(g.mime==f){return g}if(g.mimes){for(var d=0;d<g.mimes.length;d++){if(g.mimes[d]==f){return g}}}}if(/\+xml$/.test(f)){return a.findModeByMIME("application/xml")}if(/\+json$/.test(f)){return a.findModeByMIME("application/json")}};a.findModeByExtension=function(f){for(var e=0;e<a.modeInfo.length;e++){var g=a.modeInfo[e];if(g.ext){for(var d=0;d<g.ext.length;d++){if(g.ext[d]==f){return g}}}}};a.findModeByFileName=function(e){for(var f=0;f<a.modeInfo.length;f++){var j=a.modeInfo[f];if(j.file&&j.file.test(e)){return j}}var d=e.lastIndexOf(".");var g=d>-1&&e.substring(d+1,e.length);if(g){return a.findModeByExtension(g)}};a.findModeByName=function(e){e=e.toLowerCase();for(var f=0;f<a.modeInfo.length;f++){var g=a.modeInfo[f];if(g.name.toLowerCase()==e){return g}if(g.alias){for(var d=0;d<g.alias.length;d++){if(g.alias[d].toLowerCase()==e){return g}}}}}});